<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-son-forum-de-toutes-pieces.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 09:14:50 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-son-forum-de-toutes-pieces.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:37:58 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Créer son forum de toutes pièces</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/creer-son-forum-de-toutes-pieces.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Créer son forum de toutes pièces</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Crersonforumdetoutespices">Créer son forum de toutes pièces</a><br/><a href="#Avanttout">Avant tout</a><br/><a href="#Prsentation">Présentation</a><br/><a href="#Labasededonnes">La base de données</a><br/><a href="#Ledesign">Le design</a><br/><a href="#Paged039index">Page d&#039;index</a><br/><a href="#Lesfichiersinclus">Les fichiers inclus</a><br/><a href="#Affichonsnotrepage">Affichons notre page</a><br/><a href="#Onteste">On teste !</a><br/><a href="#Inscriptionetconnexion">Inscription et connexion</a><br/><a href="#Connexion">Connexion</a><br/><a href="#Enregistrement">Enregistrement</a><br/><a href="#Amliorations">Améliorations</a><br/><a href="#Lesprofils">Les profils</a><br/><a href="#Voirleprofil">Voir le profil</a><br/><a href="#Modifierleprofil">Modifier le profil</a><br/><a href="#ForumsetTopics">Forums et Topics</a><br/><a href="#Voirunforum">Voir un forum</a><br/><a href="#Voiruntopic">Voir un topic</a><br/><a href="#Poster">Poster</a><br/><a href="#Pagedeformulaire">Page de formulaire</a><br/><a href="#Lebbcode">Le bbcode</a><br/><a href="#Traiterlemessage">Traiter le message</a><br/><a href="#Messagesprivs">Messages privés</a><br/><a href="#Structuredelapage">Structure de la page</a><br/><a href="#Lireunmessage">Lire un message</a><br/><a href="#RpondrePosterSupprimer">Répondre, Poster, Supprimer</a><br/><a href="#LabotedeMp">La boîte de Mp</a><br/><a href="#Autorisationsd039accs">Autorisations d&#039;accès</a><br/><a href="#FaireunforumVIP">Faire un forum VIP</a><br/><a href="#Lebannissement">Le bannissement</a><br/><a href="#Lesannonces">Les annonces</a><br/><a href="#Remarques">Remarques</a><br/><a href="#TPModrerleforum">TP : Modérer le forum</a><br/><a href="#Objectif">Objectif</a><br/><a href="#Conseils">Conseils</a><br/><a href="#Correction">Correction</a><br/><a href="#AdministrationPartieI">Administration Partie I</a><br/><a href="#Structuredelapage">Structure de la page</a><br/><a href="#Configuration">Configuration</a><br/><a href="#Gestiondesforums">Gestion des forums</a><br/><a href="#Gestiondesmembres">Gestion des membres</a><br/><a href="#AdministrationPartieII">Administration Partie II</a><br/><a href="#Configuration">Configuration</a><br/><a href="#Gestiondesforums">Gestion des forums</a><br/><a href="#Gestiondesmembres">Gestion des membres</a><br/><a href="#Quelquesfonctionsenplus">Quelques fonctions en plus</a><br/><a href="#Systmelu_non-lu">Système lu / non-lu</a><br/><a href="#Quiestenligne">Qui est en ligne ?</a><br/><a href="#Etencoretroisautres">Et encore trois autres</a><br/><a href="#Lalistedesmembres">La liste des membres</a><br/><a href="#Gestiondesamis">Gestion des amis</a><br/><a href="#Rponsesautomatiques">Réponses automatiques</a><br/><a href="#Annexe">Annexe</a><br/><a href="#Questionsrcurrentes">Questions récurrentes</a><br/><a href="#Listedeforums">Liste de forums</a><br/></div>
<a name="Crersonforumdetoutespices"></a><h2>Créer son forum de toutes pièces</h2><div class="content" role="article">
<p id="r-616892" data-claire-element-id="616892">Si vous êtes sur cette page, c'est parce que vous avez décidé de laisser tomber <em><strong>phpbb</strong></em>, ou autre, pour vous lancer dans l'aventure qu'est la création d'un forum.<br/> Et ça tombe bien, parce que justement, ici on va voir comment faire ça :p .<br/> Il faut, avant de commencer, que vous sachiez que je vais montrer comment réaliser une base que vous pourrez ensuite faire évoluer comme bon vous semblera. <br/> Sachez aussi que la création d'un forum suppose la connaissance de pas mal de points du php assez divers. Il est donc préférable que vous ayez lu <a href="http://www.siteduzero.com/tuto-3-4-0-un-site-dynamique-avec-php.html">les cours de M@teo21</a>, ça sera largement suffisant.</p><p id="r-616893" data-claire-element-id="616893">Le cours est divisé en deux parties : la première concerne les pages membres, c'est-à-dire celles qui concernent les fonctions communes à tous (poster, lire des messages, etc.). La seconde, vous l'aurez deviné, c'est la partie d'administration.<br/> Il y aura également une troisième partie en annexe, pour ceux qui auront tenu jusqu'au bout ^^ .</p><p id="r-616894" data-claire-element-id="616894">Allez, je ne vous fais pas patienter plus longtemps, on y va ! ^^</p><p id="r-616895" data-claire-element-id="616895"><strong>Remerciements</strong></p><figure id="r-616897" data-claire-element-id="616898"><img id="r-616896" data-claire-element-id="616896" src="medias/uploads.siteduzero.com_files_161001_162000_161423.png" alt="Image utilisateur"/></figure><p id="r-616899" data-claire-element-id="616899"><strong>Un grand merci à Jérémy_B qui m'a aidé à mettre à jour ce tutoriel en améliorant la sécurité.</strong></p><p id="r-616900" data-claire-element-id="616900"><em>Merci à <br/>Nelty pour son soutien<br/>`Haku pour son aide<br/>Caline pour les corrections<br/>Kickoff pour avoir mis le tuto aux normes</em></p>
</div>
<div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script>
</div><a name="Avanttout"></a><h2>Avant tout</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
<span class="next">Présentation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-616902" data-claire-element-id="616902">Comme le titre l'indique, cette partie va tout mettre en place.<br/> Que ce soit dans votre tête, dans la base de données comme dans les dossiers, on va faire en sorte que tout soit prêt pour commencer le reste.<br/> Du coup, on va s'en tenir à la base de la base : donc, <strong>pas de php ici</strong> ; tout ce qu'on va faire, c'est mettre au point ce que nous allons réaliser.</p><aside id="r-616904" data-claire-element-id="616904" data-claire-semantic="warning"><p id="r-616903" data-claire-element-id="616903">Surtout ne faites pas l'erreur de sauter ce chapitre, sans avoir bien pris le temps d'analyser ce que l'on veut faire, on fonce dans le mur et après vous allez être perdu devant les codes qui suivent !</p></aside><p id="r-616905" data-claire-element-id="616905">Allez au boulot ;)</p>
</div><a name="Prsentation"></a><h2>Présentation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">
<span class="arrow"></span>
<span class="next">Avant tout</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
<span class="next">La base de données</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-616906" data-claire-element-id="616906">On ne peut pas vraiment se lancer dans la création d'un forum sans avoir pris le temps d'étudier un peu la question.<br/> Alors, on va voir en détail ce qu'est un forum : ça peut paraître barbant pour certains, mais au moins, ça mettra les choses au clair.</p><h3 id="r-differents-types-de-forums" data-claire-element-id="616915">Différents types de forums</h3><p id="r-616907" data-claire-element-id="616907">Lorsque vous créez un site, vous êtes souvent amenés à vouloir communiquer avec les internautes qui le visitent : c'est là que le forum est utile. Au final, ce n'est pas très différent d'un livre d'or, on va simplement diviser le tout en plusieurs catégories, et utiliser un système de connexion.</p><p id="r-616908" data-claire-element-id="616908">A partir du moment où vous souhaitez installer un forum sur votre site, deux choix s'offrent à vous :</p><ul id="r-616913" data-claire-element-id="616913"><li id="r-616910" data-claire-element-id="616910"><p id="r-616909" data-claire-element-id="616909">Utiliser une plate-forme comme la célèbre phpbb (avantages : c'est facile, gratuit et, quoi qu'on en dise, assez sûr).</p></li><li id="r-616912" data-claire-element-id="616912"><p id="r-616911" data-claire-element-id="616911">Programmer votre propre forum (avantages : vous pouvez modifier ce que vous voulez, l'insérer dans votre design, et puis ça fait plus classe ^^ ).</p></li></ul><p id="r-616914" data-claire-element-id="616914">Comme on n'a rien sans rien, c'est évidemment plus long et plus difficile d'utiliser la deuxième solution, mais pas de panique : on va s'y mettre ensemble :) , et au final, vous serez contents de pouvoir vous plonger dans vos scripts sans choper une migraine, comme c'est le cas avec phpbb.</p><h3 id="r-de-quoi-ai-je-besoin-2" data-claire-element-id="616940">De quoi ai-je besoin ?</h3><p id="r-616916" data-claire-element-id="616916">Pour créer un forum, il ne faut rien d'extraordinaire :</p><ul id="r-616923" data-claire-element-id="616923"><li id="r-616918" data-claire-element-id="616918"><p id="r-616917" data-claire-element-id="616917"><strong>Une base de données</strong> : elle va nous permettre de stocker toutes les informations de notre forum.</p></li><li id="r-616920" data-claire-element-id="616920"><p id="r-616919" data-claire-element-id="616919"><strong>Un programme de traitement de texte </strong> : le mieux est d'utiliser Notepad++, présenté par M@teo21 dans ses cours, mais vous faites comme vous voulez :p .</p></li><li id="r-616922" data-claire-element-id="616922"><p id="r-616921" data-claire-element-id="616921"><strong>Un logiciel FTP </strong> : grâce à lui, on va envoyer le tout sur le site, et voir le résultat.</p></li></ul><p id="r-616924" data-claire-element-id="616924">Bref, l'attirail classique du programmeur PHP ; la seule différence, c'est qu'il va falloir créer un dossier appelé forum, car on va y mettre pas mal de scripts.</p><p id="r-616925" data-claire-element-id="616925">Avant de passer à la base de données, on va voir les fonctionnalités que proposera le forum, une fois terminé :</p><ul id="r-616936" data-claire-element-id="616936"><li id="r-616927" data-claire-element-id="616927"><p id="r-616926" data-claire-element-id="616926">Possibilité de s'inscrire pour avoir un pseudo, et grâce auquel on peut poster de nouveaux topics, ou bien répondre.</p></li><li id="r-616929" data-claire-element-id="616929"><p id="r-616928" data-claire-element-id="616928">Possibilité de modifier ou de supprimer ses propres messages, en cas de fautes d'orthographe.</p></li><li id="r-616931" data-claire-element-id="616931"><p id="r-616930" data-claire-element-id="616930">Possibilité de consulter une page qui affiche des informations sur les membres (profil), et de pouvoir modifier le sien.</p></li><li id="r-616933" data-claire-element-id="616933"><p id="r-616932" data-claire-element-id="616932">Possibilité de recevoir et d'envoyer des messages privés aux autres membres.</p></li><li id="r-616935" data-claire-element-id="616935"><p id="r-616934" data-claire-element-id="616934">Et j'en passe ^^ .</p></li></ul><p id="r-616937" data-claire-element-id="616937">Ça résume un peu les services principaux proposés aux visiteurs de notre forum, et en fait, ça regroupe à peu près toutes les bases. Une fois que ce sera terminé, vous pourrez vous-mêmes ajouter des fonctions, comme une barre de recherche, une liste d'amis, etc.</p><aside id="r-616939" data-claire-element-id="616939" data-claire-semantic="information"><p id="r-616938" data-claire-element-id="616938">Évidemment il faut ajouter à cela toutes les fonctions administration du forum, on les verra en leur temps.</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">
<span class="arrow"></span>
<span class="next">Avant tout</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
<span class="next">La base de données</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Labasededonnes"></a><h2>La base de données</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
<span class="arrow"></span>
<span class="next">Présentation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
<span class="next">Le design</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-616942" data-claire-element-id="616942">On va maintenant passer à la création de notre base de données : elle va être simplifiée par rapport à celle qu'on utilise avec phpbb, car le forum va être un peu plus simple.</p><div id="r-616944" data-claire-element-id="616944" data-claire-semantic="question"><p id="r-616943" data-claire-element-id="616943">Han !! Tu vas nous faire programmer un forum super-simple, alors que t'avais dit que ça serait un beau forum complet ! :colere2:</p></div><p id="r-616945" data-claire-element-id="616945">Pas de panique : en fait, phpbb est une plate-forme qui s'utilise par plusieurs sites ; aussi, il faut prévoir des dizaines de paramètres à modifier facilement par l'administrateur afin d'ajuster son forum à ses goûts. La différence, c'est que nous, on ne veut pas l'exporter, ni proposer à des internautes de le télécharger : on veut simplement l'utiliser pour nous. Forcément, ça simplifie pas mal les choses.</p><aside id="r-616947" data-claire-element-id="616947" data-claire-semantic="warning"><p id="r-616946" data-claire-element-id="616946">Puisqu'on est dans la partie des pages membres, je ne mets pas les tables qui concernent l'administration : on verra ça en détail plus tard. Aussi sachez qu'il y aura plus de tables au final ;) .</p></aside><p id="r-616948" data-claire-element-id="616948">Bref, pour en revenir à nos tables, voici ce qu'on va faire.<br/><strong><br/> Une table forum_categorie</strong> : elle va comporter trois champs, cat_id, cat_nom, cat_ordre.<br/> C'est dans cette table que vont être stockées les différentes catégories du forum ; par exemple, sur le Site du Zér0, il y en a cinq (Site Web, Programmation, Mapping, etc.).<br/><strong><br/> Une table forum_forum</strong> : elle va comporter treize champs, forum_id, cat_id, forum_name, forum_desc, forum_ordre, forum_last_post_id, forum_topic, forum_post, auth_view, auth_post, auth_topic, auth_annonce, auth_modo.<br/> C'est tout simplement la table qui va être utilisée pour écrire le nom de chaque forum, leur description, etc.</p><div id="r-616950" data-claire-element-id="616950" data-claire-semantic="question"><p id="r-616949" data-claire-element-id="616949">Que représentent les champs avec le préfixe <em>auth_</em> ?</p></div><p id="r-616951" data-claire-element-id="616951">Ils vont comporter un numéro qui renseignera sur le niveau qu'il faut avoir pour lire, poster ou créer un nouveau message pour chaque forum (il est possible que vous souhaitiez faire un forum spécial pour les administrateurs ; dans ce cas on mettra un numéro particulier, mais on verra ça plus tard ;) ).</p><p id="r-616952" data-claire-element-id="616952"><strong>Une table forum_topic</strong> : elle va comporter dix champs, topic_id, forum_id, topic_titre, topic_createur, topic_vu, topic_time, topic_genre, topic_last_post, topic_first_post, topic_post.</p><p id="r-616953" data-claire-element-id="616953">Dans l'ordre logique, on est passé de la catégorie au forum, et on arrive aux topics (ou sujets).<br/><strong><br/> Une table forum_post</strong> : elle va comporter six champs, post_id, post_createur, post_texte, post_time, topic_id, post_forum_id. C'est donc la table qui va contenir les informations sur les posts (ou messages).</p><p id="r-616954" data-claire-element-id="616954"><strong>Une table forum_membres</strong> : elle va comporter un grand nombre de champs, mais le nombre exact, c'est à vous de le déterminer. En fait, ça dépend du nombre d'informations que vous voulez connaître sur vos membres.<br/> Toutefois, il faut créer un minimum de champs, à savoir : membre_id, membre_pseudo, membre_mdp, membre_email, membre_avatar, membre_signature, membre_localisation, membre_inscrit, membre_derniere_visite, membre_rang, membre_post.</p><p id="r-616955" data-claire-element-id="616955">Dans ma requête, j'en ai ajouté quelques autres, comme membre_msn, membre_siteweb.</p><p id="r-616956" data-claire-element-id="616956">Voici donc les requêtes à copier :</p><pre id="r-616957" data-claire-element-id="616957"><code data-claire-semantic="sql">-- 
-- Table `forum_categorie`
-- 
 
CREATE TABLE `forum_categorie` (
  `cat_id` int(11) NOT NULL AUTO_INCREMENT,
  `cat_nom` varchar(30) collate latin1_general_ci NOT NULL,
  `cat_ordre` int(11) NOT NULL,
  PRIMARY KEY  (`cat_id`),
  UNIQUE KEY `cat_ordre` (`cat_ordre`)
);
 
-- 
-- Table `forum_forum`
-- 
 
CREATE TABLE `forum_forum` (
  `forum_id` int(11) NOT NULL AUTO_INCREMENT,
  `forum_cat_id` mediumint(8) NOT NULL,
  `forum_name` varchar(30) collate latin1_general_ci NOT NULL,
  `forum_desc` text collate latin1_general_ci NOT NULL,
  `forum_ordre` mediumint(8) NOT NULL,
  `forum_last_post_id` int(11) NOT NULL,
  `forum_topic` mediumint(8) NOT NULL,
  `forum_post` mediumint(8) NOT NULL,
  `auth_view` tinyint(4) NOT NULL,
  `auth_post` tinyint(4) NOT NULL,
  `auth_topic` tinyint(4) NOT NULL,
  `auth_annonce` tinyint(4) NOT NULL,
  `auth_modo` tinyint(4) NOT NULL,
  PRIMARY KEY  (`forum_id`)
); 
 
 
-- 
-- Table `forum_membres`
-- 
 
CREATE TABLE `forum_membres` (
  `membre_id` int(11) NOT NULL AUTO_INCREMENT,
  `membre_pseudo` varchar(30) collate latin1_general_ci NOT NULL,
  `membre_mdp` varchar(32) collate latin1_general_ci NOT NULL,
  `membre_email` varchar(250) collate latin1_general_ci NOT NULL,
  `membre_msn` varchar(250) collate latin1_general_ci NOT NULL,
  `membre_siteweb` varchar(100) collate latin1_general_ci NOT NULL,
  `membre_avatar` varchar(100) collate latin1_general_ci NOT NULL,
  `membre_signature` varchar(200) collate latin1_general_ci NOT NULL,
  `membre_localisation` varchar(100) collate latin1_general_ci NOT NULL,
  `membre_inscrit` int(11) NOT NULL,
  `membre_derniere_visite` int(11) NOT NULL,
  `membre_rang` tinyint (4) DEFAULT 2,
  `membre_post` int(11) NOT NULL,
  PRIMARY KEY  (`membre_id`)
); 
 
 
-- 
-- Table `forum_post`
-- 
 
CREATE TABLE `forum_post` (
  `post_id` int(11) NOT NULL AUTO_INCREMENT,
  `post_createur` int(11) NOT NULL,
  `post_texte` text collate latin1_general_ci NOT NULL,
  `post_time` int(11) NOT NULL,
  `topic_id` int(11) NOT NULL,
  `post_forum_id` int(11) NOT NULL,
  PRIMARY KEY  (`post_id`)
);
 
 
 
-- 
-- Table  `forum_topic`
-- 
 
CREATE TABLE `forum_topic` (
  `topic_id` int(11) NOT NULL AUTO_INCREMENT,
  `forum_id` int(11) NOT NULL,
  `topic_titre` char(60) collate latin1_general_ci NOT NULL,
  `topic_createur` int(11) NOT NULL,
  `topic_vu` mediumint(8) NOT NULL,
  `topic_time` int(11) NOT NULL,
  `topic_genre` varchar(30) collate latin1_general_ci NOT NULL,
  `topic_last_post` int(11) NOT NULL,
  `topic_first_post` int(11) NOT NULL,
  `topic_post` mediumint(8) NOT NULL,
  PRIMARY KEY  (`topic_id`),
  UNIQUE KEY `topic_last_post` (`topic_last_post`)
);</code></pre><aside id="r-616959" data-claire-element-id="616959" data-claire-semantic="information"><p id="r-616958" data-claire-element-id="616958">Il existe également une table forum_message_privee que je n'ajoute pas encore, car on la verra plus tard :) .</p></aside><p id="r-616960" data-claire-element-id="616960">À première vue, le nom de chaque champ est assez explicite, et vous ne devez pas avoir trop de mal à comprendre à quoi ils vont nous servir. <br/> Les seules qui peuvent poser problèmes sont cat_ordre et forum_ordre : il s'agit en fait de nombres entiers (int) qui seront attribués à chaque catégorie ou forum. Ainsi, on pourra afficher la liste des forums dans un ordre précis.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
<span class="arrow"></span>
<span class="next">Présentation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
<span class="next">Le design</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Ledesign"></a><h2>Le design</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
<span class="arrow"></span>
<span class="next">La base de données</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">
<span class="next">Page d&#039;index</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-616962" data-claire-element-id="616962">Voilà la dernière partie avant de passer à la programmation pure et dure. On va ici s'intéresser à l'aspect visuel de notre forum, c'est-à-dire voir ce qu'on peut faire pour éviter d'avoir un simple tableau blanc présentant des messages.</p><h3 id="r-le-css-1" data-claire-element-id="616965">Le CSS</h3><p id="r-616963" data-claire-element-id="616963">Comme pour n'importe quelle page d'un site, on va utiliser le CSS pour améliorer le design ; je vais donc vous demander de créer un fichier appelé <em>design.css</em>, et que vous allez placer dans votre dossier forum (si vous voulez garder le même fichier css que pour le reste de votre site, ça ne pose pas de problème, mais il va falloir prévoir de le modifier).</p><p id="r-616964" data-claire-element-id="616964">Au fur et à mesure qu'on va utiliser des balises, je vous demanderai de temps en temps de modifier ce fichier : donc gardez-le à portée.</p><h3 id="r-les-images-25" data-claire-element-id="616988">Les images</h3><p id="r-616966" data-claire-element-id="616966">Vous l'avez sûrement remarqué, dans un forum, il y a quelques images qui rendent le résultat un peu moins triste que si on touchait à rien. Et comme on ne veut pas que ce soit sobre, on va créer quelques images. <br/> Il va vous falloir :</p><p id="r-616967" data-claire-element-id="616967">- un bouton 'Nouveau Topic'<br/> - un bouton 'Répondre'<br/> - un bouton 'Éditer'<br/> - un bouton 'Supprimer'<br/> - une liste de smilies<br/> - un signal pour montrer qu'un topic est non lu, et un autre pour montrer qu'il est déjà lu<br/> - une petite flèche sur laquelle on va cliquer pour accéder au dernier message de chaque forum.</p><p id="r-616968" data-claire-element-id="616968">Après, c'est à vous de voir pour la réalisation, ça dépend totalement du style général de votre forum :) ; vous pouvez d'ailleurs en mettre davantage si vous le souhaitez (par exemple, un signal spécial pour les topic-annonces) ; à titre d'exemple, je mets ici quelques images utilisées par phpbb dans le template utilisé par défaut : <em>subsilver</em>.</p><figure id="r-616970" data-claire-element-id="616971"><img id="r-616969" data-claire-element-id="616969" src="medias/uploads.siteduzero.com_files_40001_41000_40793.gif" alt="Image utilisateur"/></figure><figure id="r-616973" data-claire-element-id="616974"><img id="r-616972" data-claire-element-id="616972" src="medias/uploads.siteduzero.com_files_40001_41000_40794.gif" alt="Image utilisateur"/></figure><figure id="r-616976" data-claire-element-id="616977"><img id="r-616975" data-claire-element-id="616975" src="medias/uploads.siteduzero.com_files_40001_41000_40791.gif" alt="Image utilisateur"/></figure><figure id="r-616979" data-claire-element-id="616980"><img id="r-616978" data-claire-element-id="616978" src="medias/uploads.siteduzero.com_files_40001_41000_40792.gif" alt="Image utilisateur"/></figure><figure id="r-616982" data-claire-element-id="616983"><img id="r-616981" data-claire-element-id="616981" src="medias/uploads.siteduzero.com_files_40001_41000_40789.gif" alt="Image utilisateur"/></figure><figure id="r-616985" data-claire-element-id="616986"><img id="r-616984" data-claire-element-id="616984" src="medias/uploads.siteduzero.com_files_40001_41000_40790.gif" alt="Image utilisateur"/></figure><p id="r-616987" data-claire-element-id="616987">On arrive à la fin de ce chapitre : même si jusqu'ici vous n'avez pas vraiment l'impression d'avoir fait quoi que ce soit, on a au moins posé les bases. On n'a pas encore utilisé de php, certes, mais si on résume : on a vu ce qu'on voulait faire, on a préparé le terrain en créant nos tables, et on a même nos images.<br/> Sans plus attendre, on va commencer à coder le tout en débutant par la page index.php :pirate: .</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
<span class="arrow"></span>
<span class="next">La base de données</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">
<span class="next">Page d&#039;index</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Paged039index"></a><h2>Page d&#039;index</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
<span class="arrow"></span>
<span class="next">Le design</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
<span class="next">Les fichiers inclus</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-616991" data-claire-element-id="616991">Salutations, amis zéros ! Si ça vous a manqué de pas utiliser un mot de php dans le dernier chapitre, on va pouvoir se rattraper ici ;) . En effet, cette partie est dédiée à la page <strong>index.php</strong>, qui est celle chargée lorsqu'on arrive sur le forum, et qui va donc logiquement présenter les catégories et les forums.</p>
</div><a name="Lesfichiersinclus"></a><h2>Les fichiers inclus</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">
<span class="arrow"></span>
<span class="next">Page d&#039;index</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
<span class="next">Affichons notre page</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-616992" data-claire-element-id="616992">En fait, avant de se lancer dans notre première page, il va falloir créer quelques fichiers à inclure dans notre script. Si je dis &quot;quelques&quot;, c'est parce que le nombre dépend de vous (une fois de plus) ; personnellement, j'aime bien avoir des menus en haut et à gauche de mon forum, ce qui fait que j'en ai déjà deux en plus. Mais si vous voulez garder la même navigation que dans votre site, il est inutile d'en refaire.<br/> Quoi qu'il en soit, pour qu'on soit certains de bien se comprendre, voici les fichiers que je vais inclure dans mes scripts :</p><p id="r-616993" data-claire-element-id="616993"><strong>Page : identifiants.php</strong></p><pre id="r-616994" data-claire-element-id="616994"><code data-claire-semantic="html+php">&lt;?php
try
{
$db = new PDO('mysql:host=localhost;dbname=test', 'root', '');
}
catch (Exception $e)
{
        die('Erreur : ' . $e-&gt;getMessage());
}
?&gt;</code></pre><p id="r-616995" data-claire-element-id="616995">Allez y vous pouvez tester, il s'agit de mes vrais identifiants ;) .<br/> Cette page va permettre de lancer la connexion à la base de données, en utilisant une page à part on évite de réécrire à chaque fois nos identifiants, ce qui n'est pas pratique et pas top niveau sécurité.</p><p id="r-616996" data-claire-element-id="616996"><strong>Page : debut.php</strong></p><pre id="r-616997" data-claire-element-id="616997"><code data-claire-semantic="html+php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
&lt;head&gt;
&lt;?php
//Si le titre est indiqué, on l'affiche entre les balises &lt;title&gt;
echo (!empty($titre))?'&lt;title&gt;'.$titre.'&lt;/title&gt;':'&lt;title&gt; Forum &lt;/title&gt;';
?&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; media=&quot;screen&quot; type=&quot;text/css&quot; title=&quot;Design&quot; href=&quot;./css/design.css&quot; /&gt;
&lt;/head&gt;
&lt;?php

//Attribution des variables de session
$lvl=(isset($_SESSION['level']))?(int) $_SESSION['level']:1;
$id=(isset($_SESSION['id']))?(int) $_SESSION['id']:0;
$pseudo=(isset($_SESSION['pseudo']))?$_SESSION['pseudo']:'';

//On inclue les 2 pages restantes
include(&quot;./includes/functions.php&quot;);
include(&quot;./includes/constants.php&quot;);
?&gt;</code></pre><p id="r-616998" data-claire-element-id="616998">Pour ceux qui s'interroge sur les lignes du type :</p><pre id="r-616999" data-claire-element-id="616999"><code data-claire-semantic="html+php">&lt;?php echo (!empty($titre))?'&lt;title&gt;'.$titre.'&lt;/title&gt;':'&lt;title&gt; Forum &lt;/title&gt;'; ?&gt;</code></pre><p id="r-617000" data-claire-element-id="617000">C'est une façon plus rapide d'écrire une condition, ça revient au même que de faire :</p><pre id="r-617001" data-claire-element-id="617001"><code data-claire-semantic="html+php">&lt;?php
if (!empty($titre)) 
{
    echo '&lt;title&gt; '.$titre.' &lt;/title&gt;';
}
else //Sinon, on écrit forum par défaut
{
    echo '&lt;title&gt; Forum &lt;/title&gt;';
}
?&gt;</code></pre><p id="r-617002" data-claire-element-id="617002">J'utiliserai cette notation souvent par la suite parce qu'elle est quand même beaucoup plus concise comme vous pouvez le voir ici.</p><p id="r-617003" data-claire-element-id="617003">Dans la suite du code, on définit les variables de session qui nous serviront par la suite pour obtenir des informations sur le visiteur (pas de panique tout va s'éclaircir quand on les utilisera !).<br/> Enfin on inclut deux pages dont on va voir l'utilité tout de suite.</p><p id="r-617004" data-claire-element-id="617004"><strong>Page : menu.php</strong></p><pre id="r-617005" data-claire-element-id="617005"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;body&gt;
&lt;div id=&quot;banniere&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu&quot;&gt;        
&lt;div class=&quot;element_menu&quot;&gt;
&lt;h3&gt;Mes options&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Page 1&lt;/li&gt;
&lt;li&gt;Page 2&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;       
&lt;div class=&quot;element_menu&quot;&gt;
&lt;h3&gt;Navigation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Page 1&lt;/li&gt;
&lt;li&gt;Page 2&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;        
&lt;/div&gt;
&lt;div id=&quot;corps_forum&quot;&gt;';
?&gt;</code></pre><p id="r-617006" data-claire-element-id="617006">Ceci est une page qui va gérer le header (la bannière) et les menus, à vous d'en faire ce que vous voulez, ajoutez y des liens, des images... bref faites vous plaisir mais n'oubliez pas d'aller faire les modifications adéquates sur le fichier css, ne vous inquiétez pas on y vient.<br/> Pour info j'ai repris le script de M@ateo21 dans son cours sur le XHTML/CSS.</p><p id="r-617007" data-claire-element-id="617007"><strong>Page : functions.php</strong></p><p id="r-617008" data-claire-element-id="617008">Cette page contiendra à l'avenir toutes les fonctions utilisées régulièrement sur le forum, on va la laisser vide pour l'instant.</p><p id="r-617009" data-claire-element-id="617009"><strong>Page : constants.php</strong></p><p id="r-617010" data-claire-element-id="617010">Cette page contiendra toutes les constantes qu'on va utiliser dans le fourm.<br/> Pour définir une constante, on réalise le code suivant en se servant de la fonction define :</p><pre id="r-617011" data-claire-element-id="617011"><code data-claire-semantic="html+php">&lt;?php
define('VISITEUR',1);
define('INSCRIT',2);
define('MODO',3);
define('ADMIN',4);
?&gt;</code></pre><p id="r-617012" data-claire-element-id="617012">Ici je définis des constantes qui nous serviront pour les niveaux d'accès. Il suffira alors décrire ADMIN pour 4, ce qui est quand même beaucoup plus clair.</p><p id="r-617013" data-claire-element-id="617013">Voilà : c'est tout pour ces fichiers qu'on va donc utiliser grâce à la fonction native <strong>include</strong> de php, que vous connaissez sûrement si vous avez lu les cours du site.</p><aside id="r-617015" data-claire-element-id="617015" data-claire-semantic="warning"><p id="r-617014" data-claire-element-id="617014">J'ai placé tous mes fichiers à inclure dans un dossier <em>includes</em>, lui-même placé dans mon dossier <em>forum</em> ; vous n'êtes pas obligés de faire pareil, mais ne soyez pas surpris si l'adresse est différente lors de l'appel de la fonction include !</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">
<span class="arrow"></span>
<span class="next">Page d&#039;index</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
<span class="next">Affichons notre page</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Affichonsnotrepage"></a><h2>Affichons notre page</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
<span class="arrow"></span>
<span class="next">Les fichiers inclus</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
<span class="next">On teste !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617017" data-claire-element-id="617017">On y arrive, on va pouvoir commencer notre première vraie page ! <br/> Avant tout, voyons comment elle va se présenter :</p><p id="r-617018" data-claire-element-id="617018">Dans un premier temps on va générer la page en incluant les fichiers dont on vient de parler, ensuite on va inscrire le titre du forum. Il suffira alors de faire une requête pour récupérer dans notre base de données tous les forums et créer un tableau pour y présenter les forums par catégorie.<br/> Enfin un pied de page donnera des indications sur le nombre de membres, de messages ou autre.</p><p id="r-617019" data-claire-element-id="617019">Je vous recommande vivement d'utiliser votre fichier menu.php pour y ajouter des liens de navigation : connexion, enregistrement, boite de message privée et autre ce qui nous évitera d'avoir à écrire ses liens sur chaque page !</p><aside id="r-617022" data-claire-element-id="617022" data-claire-semantic="warning"><p id="r-617020" data-claire-element-id="617020">Dans ce cas il faut bien faire attention à distinguer les cas selon que le visiteur est connecté ou non. Pensez donc à inclure la page menu.php après avoir récupéré les variables de session dans debut.php.</p><p id="r-617021" data-claire-element-id="617021">Pour savoir si un visiteur est connecté, il suffira de regarder la valeur stockée par la variable $id elle contient un nombre si c'est un membre, 0 si c'est un invité.</p></aside><h2 id="r-haut-de-page" data-claire-element-id="617032">Haut de page</h2><p id="r-617023" data-claire-element-id="617023"><strong>Page : index.php</strong></p><pre id="r-617024" data-claire-element-id="617024"><code data-claire-semantic="html+php">&lt;?php
//Cette fonction doit être appelée avant tout code html
session_start();

//On donne ensuite un titre à la page, puis on appelle notre fichier debut.php
$titre = &quot;Index du forum&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);</code></pre><p id="r-617025" data-claire-element-id="617025">Cette première partie de code ne doit pas vous poser trop de problèmes de compréhension, normalement : il s'agit juste d'inclure nos deux fichiers.</p><p id="r-617026" data-claire-element-id="617026">Maintenant, si vous le voulez bien, avant de reprendre, on va faire un tour du côté du fichier <strong>design.css</strong> ; il va falloir créer un id corps_forum, un pied de page (footer) et une autre bannière pour nos balises &lt;div&gt;.<br/> Voici à titre indicatif ce que j'ai réalisé: bien sûr, vous faites comme vous voulez, encore une fois :p .</p><pre id="r-617027" data-claire-element-id="617027"><code data-claire-semantic="css">#banniere
{
width: 600px;
height: 150px;
background-position:  center;
margin-bottom: 20px; 
background-image: url('images/banniere.jpg');
}

#corps_forum
{
border: 1px solid black;
width: 90%;
margin-top: 50px;
margin-left: 5%;
margin-bottom: 10Opx;
padding: 5px;
background-color: rgb(237,224,213);
}

#footer
{
border: 1px solid black;
width: 90%;
margin-top: 50px;
margin-left: 5%;
margin-bottom: 10Opx;
padding: 5px;
background-color: rgb(237,224,213);
}</code></pre><p id="r-617028" data-claire-element-id="617028">Rien de bien neuf par rapport à ce que vous avez pu lire dans les cours sur le CSS jusqu'ici. On va pouvoir continuer notre page <strong>index.php</strong>. :)</p><pre id="r-617029" data-claire-element-id="617029"><code data-claire-semantic="html+php">&lt;?php
echo'&lt;i&gt;Vous êtes ici : &lt;/i&gt;&lt;a href =&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt;';
?&gt;</code></pre><p id="r-617030" data-claire-element-id="617030">Vous vous interrogez peut-être sur l'intérêt de cette ligne. Il s'agit simplement d'un outil de navigation (on appelle cela un <em>fil d'Ariane</em> (<a href="http://fr.wikipedia.org/wiki/fil d%27Ariane">Def. fil d'Ariane</a>), comme on en trouve dans beaucoup de forums, et qui nous permet de se repérer et de se déplacer plus rapidement (d'ailleurs, si vous levez les yeux, vous verrez qu'il y en a un sur ce site ^^ ).</p><p id="r-617031" data-claire-element-id="617031">Voilà : on a fini avec le haut de la page, et on va donc pouvoir passer à la partie la plus importante, l'affichage des catégories.</p><h2 id="r-afficher-les-forums" data-claire-element-id="617064">Afficher les forums</h2><p id="r-617033" data-claire-element-id="617033">Ce qu'on va faire ici, ça va être en fait très simple puisqu'on va simplement afficher un tableau à cinq colonnes. La première colonne va afficher une image, la deuxième affichera le titre et la description, la troisième, le nombre de sujets, la quatrième, le nombre de messages, et la dernière donnera des infos sur le dernier message de cette catégorie.</p><p id="r-617034" data-claire-element-id="617034">Pour avoir un tableau un peu plus classe, je suis passé par mon <strong>fichier css</strong>, et je vous recommande d'en faire autant, ne serait-ce que pour fixer la largeur de vos cases.</p><h3 id="r-le-design-2" data-claire-element-id="617037">Le design</h3><pre id="r-617035" data-claire-element-id="617035"><code data-claire-semantic="css">.ico {width:2%}
.titre { width:61%; }
.nombremessages { width:2%; }
.nombrevu { width:4%; }
.nombresujets { width:2%; }
.auteur { width:7%; }
.derniermessage { width:18%; }
.categorie { width:92%; background-color : rgb(244,238,250); }

td { border: 1px solid black; background-color: rgb(253,244,223); vertical-align:top; }
table { background-color: rgb(237,224,213); border: 1px solid black; }
th { background-color: rgb(243,250,223); border: 1px solid black; }</code></pre><p id="r-617036" data-claire-element-id="617036">Dans un premier temps, j'ai créé des classes pour les balises &lt;table&gt;, &lt;th&gt; et &lt;td&gt;. Chaque classe correspond à une colonne ; j'ai donc seulement fixé leur taille. J'ai ensuite modifié un peu ces balises, sans toutefois y apporter de changements majeurs (elles sont simplement entourées de noir, et ont un fond en couleur).<br/> Bien entendu, ce n'est qu'une proposition de design ; en aucun cas la modification de celui-ci posera un problème de fonctionnement. Vous pouvez aussi ajouter un padding pour que les textes ne soient pas collés au bord de leurs cases.</p><h3 id="r-on-reprend-le-php" data-claire-element-id="617042">On reprend le php !</h3><p id="r-617038" data-claire-element-id="617038">Sans plus attendre, voilà la suite :</p><p id="r-617039" data-claire-element-id="617039"><strong>Page : index.php</strong></p><pre id="r-617040" data-claire-element-id="617040"><code data-claire-semantic="html+php">&lt;h1&gt;Mon super forum&lt;/h1&gt;

&lt;?php
//Initialisation de deux variables
$totaldesmessages = 0;
$categorie = NULL;
?&gt;</code></pre><p id="r-617041" data-claire-element-id="617041">Ici, on écrit le titre de la page : comme vous le voyez, dans un grand moment d'inspiration, j'ai mis &quot;Mon super forum&quot;. Ensuite ça devient plus intéressant : je prends deux variables qui ont le même but, <strong>diminuer le nombre de requêtes de cette page</strong>. Si vous voulez tout savoir, ce tutoriel a été refusé une première fois parce que le forum utilisait trop de requêtes. Donc, en initialisant deux variables, croyez-moi ou non, ça les diminue ; la première compte le nombre de messages dans chaque forum pour l'écrire en bas de la page, et la seconde va prendre tout son sens dans le code qui suit.</p><h3 id="r-la-requete" data-claire-element-id="617048">La requête</h3><pre id="r-617043" data-claire-element-id="617043"><code data-claire-semantic="html+php">&lt;?php

//Cette requête permet d'obtenir tout sur le forum
$query=$db-&gt;prepare('SELECT cat_id, cat_nom, 
forum_forum.forum_id, forum_name, forum_desc, forum_post, forum_topic, auth_view, forum_topic.topic_id,  forum_topic.topic_post, post_id, post_time, post_createur, membre_pseudo, 
membre_id 
FROM forum_categorie
LEFT JOIN forum_forum ON forum_categorie.cat_id = forum_forum.forum_cat_id
LEFT JOIN forum_post ON forum_post.post_id = forum_forum.forum_last_post_id
LEFT JOIN forum_topic ON forum_topic.topic_id = forum_post.topic_id
LEFT JOIN forum_membres ON forum_membres.membre_id = forum_post.post_createur
WHERE auth_view &lt;= :lvl 
ORDER BY cat_ordre, forum_ordre DESC');
$query-&gt;bindValue(':lvl',$lvl,PDO::PARAM_INT);
$query-&gt;execute();
?&gt;</code></pre><div id="r-617045" data-claire-element-id="617045" data-claire-semantic="question"><p id="r-617044" data-claire-element-id="617044">C'est une requête, ce truc !? o_O</p></div><p id="r-617046" data-claire-element-id="617046">Oui, et c'est même très pratique ^^ . Les jointures sont expliquées par M@teo21 dans ses cours. Si vous avez un trou de mémoire, je vous conseille de relire son chapitre <em><a href="http://www.siteduzero.com/tutoriel-3-230007-les-jointures-entre-tables.html">Les jointures entre tables</a></em>. En fait, cette requête va mettre à la suite les tables forum_categorie, forum_forum, forum_post, forum_topic et forum_membres en les liant par des champs communs (par exemple, ici le champ cat_id de forum_forum va être lié avec le champ cat_id de forum_categorie).</p><p id="r-617047" data-claire-element-id="617047">Quant à la ligne juste avant, elle détermine le niveau d'accès du visiteur, on verra beaucoup plus tard ce que tout ça signifie, en attendant en utilisant cette méthode la page n'affichera pas les forums qui ne sont pas censés être vus.</p><h3 id="r-categories" data-claire-element-id="617057">Catégories</h3><p id="r-617049" data-claire-element-id="617049">On va commencer par créer notre tableau</p><pre id="r-617050" data-claire-element-id="617050"><code data-claire-semantic="html+php">&lt;table&gt;
&lt;?php
//Début de la boucle
while($data = $query-&gt;fetch())
{
    //On affiche chaque catégorie
    if( $categorie != $data['cat_id'] )
    {
        //Si c'est une nouvelle catégorie on l'affiche
       
        $categorie = $data['cat_id'];
        ?&gt;
        &lt;tr&gt;
        &lt;th&gt;&lt;/th&gt;
        &lt;th class=&quot;titre&quot;&gt;&lt;strong&gt;&lt;?php echo stripslashes(htmlspecialchars($data['cat_nom'])); ?&gt;
        &lt;/strong&gt;&lt;/th&gt;             
        &lt;th class=&quot;nombremessages&quot;&gt;&lt;strong&gt;Sujets&lt;/strong&gt;&lt;/th&gt;       
        &lt;th class=&quot;nombresujets&quot;&gt;&lt;strong&gt;Messages&lt;/strong&gt;&lt;/th&gt;       
        &lt;th class=&quot;derniermessage&quot;&gt;&lt;strong&gt;Dernier message&lt;/strong&gt;&lt;/th&gt;   
        &lt;/tr&gt;
        &lt;?php
               
    }

    //Ici, on met le contenu de chaque catégorie
    ?&gt;</code></pre><p id="r-617051" data-claire-element-id="617051">Avant de poursuivre, faisons une petite pause ^^ . Vous avez vu que je procède comme ceci :</p><ul id="r-617056" data-claire-element-id="617056"><li id="r-617053" data-claire-element-id="617053"><p id="r-617052" data-claire-element-id="617052">On regarde si c'est une nouvelle catégorie : dans ce cas, on l'affiche en faisant un nouveau tableau. C'est là que la variable $categorie prend son sens. Elle est d'abord vide, donc, lorsqu'on va tester si elle a le même id que celle de la requête, ça ne sera bien sûr pas le cas, alors, on affichera un nouveau tableau après avoir actualisé la valeur de la variable.</p></li><li id="r-617055" data-claire-element-id="617055"><p id="r-617054" data-claire-element-id="617054">On affiche tous les forums, et c'est ce qu'on va voir tout de suite ;) .</p></li></ul><h3 id="r-les-forums-3" data-claire-element-id="617063">Les forums</h3><pre id="r-617058" data-claire-element-id="617058"><code data-claire-semantic="html+php">&lt;?php
    // Ce super echo de la mort affiche tous
    // les forums en détail : description, nombre de réponses etc...

    echo'&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;./images/message.gif&quot; alt=&quot;message&quot; /&gt;&lt;/td&gt;
    &lt;td class=&quot;titre&quot;&gt;&lt;strong&gt;
    &lt;a href=&quot;./voirforum.php?f='.$data['forum_id'].'&quot;&gt;
    '.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/a&gt;&lt;/strong&gt;
    &lt;br /&gt;'.nl2br(stripslashes(htmlspecialchars($data['forum_desc']))).'&lt;/td&gt;
    &lt;td class=&quot;nombresujets&quot;&gt;'.$data['forum_topic'].'&lt;/td&gt;
    &lt;td class=&quot;nombremessages&quot;&gt;'.$data['forum_post'].'&lt;/td&gt;';

    // Deux cas possibles :
    // Soit il y a un nouveau message, soit le forum est vide
    if (!empty($data['forum_post']))
    {
         //Selection dernier message
	 $nombreDeMessagesParPage = 15;
         $nbr_post = $data['topic_post'] +1;
	 $page = ceil($nbr_post / $nombreDeMessagesParPage);
		 
         echo'&lt;td class=&quot;derniermessage&quot;&gt;
         '.date('H\hi \l\e d/M/Y',$data['post_time']).'&lt;br /&gt;
         &lt;a href=&quot;./voirprofil.php?m='.stripslashes(htmlspecialchars($data['membre_id'])).'&amp;amp;action=consulter&quot;&gt;'.$data['membre_pseudo'].'  &lt;/a&gt;
         &lt;a href=&quot;./voirtopic.php?t='.$data['topic_id'].'&amp;amp;page='.$page.'#p_'.$data['post_id'].'&quot;&gt;
         &lt;img src=&quot;./images/go.gif&quot; alt=&quot;go&quot; /&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;';

     }
     else
     {
         echo'&lt;td class=&quot;nombremessages&quot;&gt;Pas de message&lt;/td&gt;&lt;/tr&gt;';
     }

     //Cette variable stock le nombre de messages, on la met à jour
     $totaldesmessages += $data['forum_post'];

     //On ferme notre boucle et nos balises
} //fin de la boucle
$query-&gt;CloseCursor();
echo '&lt;/table&gt;&lt;/div&gt;';
?&gt;</code></pre><p id="r-617059" data-claire-element-id="617059">Voilà : on a terminé l'affichage des forums. Bon, en fait, tout se joue sur le gros echo : il remplit simplement les cases du tableau avec les données de la requête. Les liens des images sont bien sûr à modifier en fonction de votre organisation.<br/> Ensuite, on met à jour la variable qui compte le nombre de messages total, et le tour est joué !<br/> J'ai également mis une petite flèche, sobrement appelée go.gif, un lien vers le dernier message de chaque forum.</p><aside id="r-617061" data-claire-element-id="617061" data-claire-semantic="information"><p id="r-617060" data-claire-element-id="617060">Ce code n'est pas tout à fait complet : on n'a pas vu comment utiliser les autorisations (vous vous souvenez les champs auth_machin ?). Ceci sera fait dans une seconde partie avec les pages admin.</p></aside><p id="r-617062" data-claire-element-id="617062">Avant de conclure j'aimerais retourner sur la petite partie concernant le lien vers le dernier message. Pour l'instant c'est surement un peu flou mais en fait il faut calculer la page dans laquelle ce message sera et faire le lien vers cette page, de cette manière vous arriverez directement sur le dernier message posté de chaque forum.</p><h2 id="r-le-pied-de-page-3" data-claire-element-id="617069">Le pied de page</h2><p id="r-617065" data-claire-element-id="617065">Nous y voilà, on passe au bas de la page. Comme sur un forum phpbb, on va simplement y mettre des statistiques sur le forum (nombre de membres, nombre de messages, dernier membre inscrit).</p><pre id="r-617066" data-claire-element-id="617066"><code data-claire-semantic="html+php">&lt;?php
//Le pied de page ici :
echo'&lt;div id=&quot;footer&quot;&gt;
&lt;h2&gt;
Qui est en ligne ?
&lt;/h2&gt;
';

//On compte les membres
$TotalDesMembres = $db-&gt;query('SELECT COUNT(*) FROM forum_membres')-&gt;fetchColumn();
$query-&gt;CloseCursor();	
$query = $db-&gt;query('SELECT membre_pseudo, membre_id FROM forum_membres ORDER BY membre_id DESC LIMIT 0, 1');
$data = $query-&gt;fetch();
$derniermembre = stripslashes(htmlspecialchars($data['membre_pseudo']));

echo'&lt;p&gt;Le total des messages du forum est &lt;strong&gt;'.$totaldesmessages.'&lt;/strong&gt;.&lt;br /&gt;';
echo'Le site et le forum comptent &lt;strong&gt;'.$TotalDesMembres.'&lt;/strong&gt; membres.&lt;br /&gt;';
echo'Le dernier membre est &lt;a href=&quot;./voirprofil.php?m='.$data['membre_id'].'&amp;amp;action=consulter&quot;&gt;'.$derniermembre.'&lt;/a&gt;.&lt;/p&gt;';
$query-&gt;CloseCursor();
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617067" data-claire-element-id="617067">Petite explication sur ce bout de code. Au total, on va donc faire deux requêtes : la première va compter le nombre d'entrées dans la table forum_membres pour retourner le nombre de membres (sans blague ? :lol: ). La deuxième requête va aller chercher le pseudo et l'id du dernier membre inscrit ; comment fait-elle ? Elle regarde toutes les id et retourne la plus grande, tout simplement ^^ .</p><p id="r-617068" data-claire-element-id="617068">On est donc arrivés en bas de notre page index.php, et on va maintenant tester pour voir ce que ça donne.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
<span class="arrow"></span>
<span class="next">Les fichiers inclus</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
<span class="next">On teste !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Onteste"></a><h2>On teste !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
<span class="arrow"></span>
<span class="next">Affichons notre page</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">
<span class="next">Inscription et connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617071" data-claire-element-id="617071">Si vous lancez votre navigateur et que vous allez sur la page index.php, vous voyez normalement une erreur s'afficher.<br/> Ou alors un tableau vide, si vous n'avez pas suivi exactement le code proposé.</p><div id="r-617073" data-claire-element-id="617073" data-claire-semantic="question"><p id="r-617072" data-claire-element-id="617072">Euh ? :euh:</p></div><p id="r-617074" data-claire-element-id="617074">Non, en fait c'est parfaitement normal, dans la mesure où votre base de données est entièrement vide pour l'instant. Dans l'avenir, pour la remplir il suffira de se rendre dans la page d'administration, rajouter des forums ou des catégories, ou bien simplement de s'inscrire... Mais comme on n'a pas encore créé toutes les pages qui vont nous le permettre, il va falloir modifier directement la base de données, histoire de voir un peu ce que ça donne.</p><p id="r-617075" data-claire-element-id="617075">Je vous propose donc les requêtes suivantes, que vous pourrez bien sûr modifier plus tard.</p><pre id="r-617076" data-claire-element-id="617076"><code data-claire-semantic="sql">INSERT INTO `forum_categorie` (`cat_id`, `cat_nom`, `cat_ordre`) VALUES (1, 'Général', 30);
INSERT INTO `forum_categorie` (`cat_id`, `cat_nom`, `cat_ordre`) VALUES (2, 'Jeux-Vidéos', 20);
INSERT INTO `forum_categorie` (`cat_id`, `cat_nom`, `cat_ordre`) VALUES (3, 'Autre', 10);</code></pre><pre id="r-617077" data-claire-element-id="617077"><code data-claire-semantic="sql">INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (1, 1, 'Présentation', 'Nouveau sur le forum? Venez vous présenter ici !', 60, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (2, 1, 'Les News', 'Les news du site sont ici', 50, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (3, 1, 'Discussions générales', 'Ici on peut parler de tout sur tous les sujets', 40, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (4, 2, 'MMORPG', 'Parlez ici des MMORPG', 60, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (5, 2, 'Autres jeux', 'Forum sur les autres jeux', 50, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (6, 3, 'Loisir', 'Vos loisirs', 60, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO `forum_forum` (`forum_id`, `forum_cat_id`, `forum_name`, `forum_desc`, `forum_ordre`, `forum_last_post_id`, `forum_topic`, `forum_post`, `auth_view`, `auth_post`, `auth_topic`, auth_annonce, auth_modo)
VALUES (7, 3, 'Délires', 'Décrivez ici tous vos délires les plus fous', 50, 0, 0, 0, 0, 0, 0, 0, 0);</code></pre><p id="r-617078" data-claire-element-id="617078">Ce code aura pour effet de créer trois catégories, et quelques forums pour chacune d'elles. Vous vous demandez peut-être pourquoi le champ ordre prend des valeurs si espacées (60, 50, 40) ? Ça permet d'éviter d'avoir à modifier toutes les valeurs dans le cas où l'on voudrait ajouter une catégorie, ou un forum, entre deux autres. Avec ce système par exemple, on a juste à mettre 55 pour placer une catégorie entre Général et Jeux Vidéos :) .</p><p id="r-617079" data-claire-element-id="617079">Si vous en êtes arrivés là et que vous êtes toujours en vie, c'est que votre page d'index est terminée. Dans le chapitre suivant, on va s'attaquer à un autre point important des forums : la connexion, et surtout l'enregistrement des membres.</p><p id="r-617080" data-claire-element-id="617080">Si vous êtes prêts, c'est parti ! :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
<span class="arrow"></span>
<span class="next">Affichons notre page</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">
<span class="next">Inscription et connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Inscriptionetconnexion"></a><h2>Inscription et connexion</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
<span class="arrow"></span>
<span class="next">On teste !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
<span class="next">Connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617083" data-claire-element-id="617083">On arrive à ma partie préférée : la création de la page <strong>connexion.php</strong>, et <strong>register.php</strong>. Comme leurs noms l'indiquent bien, elles permettront aux visiteurs soit de se connecter, ou bien, s'il n'est pas inscrit sur le forum, de le faire tout de suite.</p><p id="r-617084" data-claire-element-id="617084">Qu'est-ce qu'on attend ? C'est parti ! :soleil:</p>
</div><a name="Connexion"></a><h2>Connexion</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">
<span class="arrow"></span>
<span class="next">Inscription et connexion</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
<span class="next">Enregistrement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617085" data-claire-element-id="617085">La page qu'on va créer maintenant s'appelle sobrement <strong>connexion.php</strong> ; ce qu'on veut qu'elle fasse est simple, présenter un formulaire avec pseudo et mot de passe, puis envoyer les infos sur une page traitement qui sera en fait la même page.</p><h2 id="r-formulaire-1" data-claire-element-id="617109">Formulaire</h2><p id="r-617086" data-claire-element-id="617086">Je vous avais prévenus que ce tutoriel touchait pas mal d'aspects différents du php : cette fois, on va passer un moment sur les formulaires.</p><p id="r-617087" data-claire-element-id="617087">On commence avec le début de la page, toujours le même :</p><p id="r-617088" data-claire-element-id="617088"><strong>Page : connexion.php</strong></p><pre id="r-617089" data-claire-element-id="617089"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Connexion&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; Connexion';
?&gt;</code></pre><p id="r-617090" data-claire-element-id="617090">Bon : je ne pense pas avoir besoin de m'arrêter longtemps, c'est la même chose que partout ailleurs. On va maintenant afficher le formulaire, mais avant, un peu de sécurité s'impose :</p><pre id="r-617091" data-claire-element-id="617091"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;h1&gt;Connexion&lt;/h1&gt;';
if ($id!=0) erreur(ERR_IS_CO);
?&gt;</code></pre><div id="r-617093" data-claire-element-id="617093" data-claire-semantic="question"><p id="r-617092" data-claire-element-id="617092">Mais qu'est ce que c'est que ce truc !? o_O</p></div><p id="r-617094" data-claire-element-id="617094">Bon pour la première ligne je pense que ça ne pose pas de soucis, voyons un peu la seconde.<br/> Ici on veut s'assurer que le visiteur qui arrive sur cette page n'est pas déjà connecté, c'est pour ça qu'on vérifie la valeur de la variable $id (je rappelle qu'elle contient 0 si le visiteur n'est pas connecté, l'id du membre sinon).<br/> S'il y a un problème, on appelle la fonction erreur, cette fonction il va bien entendu falloir la déclarer quelque part, pour cela on va utiliser la page <strong>functions.php</strong>.</p><pre id="r-617095" data-claire-element-id="617095"><code data-claire-semantic="html+php">&lt;?php
function erreur($err='')
{
   $mess=($err!='')? $err:'Une erreur inconnue s\'est produite';
   exit('&lt;p&gt;'.$mess.'&lt;/p&gt;
   &lt;p&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à la page d\'accueil&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;');
}
?&gt;</code></pre><p id="r-617096" data-claire-element-id="617096">Son fonctionnement est simple, elle arrête le script php en indiquant un message prédéfini, par défaut, le message est <em>Une erreur inconnue s'est produite</em>.<br/> Bien entendu, il serait bon de ne pas oublier de déclarer toutes nos constantes et de créer ainsi autant de messages d'erreur que vous voulez.<br/> Pour cela rendez-vous sur la page <strong>constants.php</strong></p><pre id="r-617097" data-claire-element-id="617097"><code data-claire-semantic="html+php">&lt;?php
define('ERR_IS_CO','Vous ne pouvez pas accéder à cette page si vous n\'êtes pas connecté');
?&gt;</code></pre><div id="r-617099" data-claire-element-id="617099" data-claire-semantic="question"><p id="r-617098" data-claire-element-id="617098">Mais pourquoi tu t'embêtes comme ça ?! Tu peux pas simplement écrire le message dans la page ?</p></div><p id="r-617100" data-claire-element-id="617100">Si mais croyez moi on y gagne avec cette méthode, pas besoin de s'amuser à réécrire 120 fois le même message, parce que des erreurs il va falloir en afficher un bon paquet !<br/> Autre avantage, avec cette méthode vous pouvez facilement personnaliser vos messages, ajouter une image, une couleur de fond etc... Il vous suffira d'écrire dans votre fonction erreur()</p><pre id="r-617101" data-claire-element-id="617101"><code data-claire-semantic="html+php">&lt;?php
exit('&lt;div id=&quot;error&quot;&gt;&lt;p&gt;'.$mess.'&lt;/p&gt;
   &lt;p&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à la page d\'accueil&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;');
?&gt;</code></pre><p id="r-617102" data-claire-element-id="617102">Et d'aller définir error dans votre fichier CSS.</p><p id="r-617103" data-claire-element-id="617103">Voilà, à présent le formulaire (pas besoin de php ici).</p><pre id="r-617104" data-claire-element-id="617104"><code data-claire-semantic="html+php">&lt;?php
if (!isset($_POST['pseudo'])) //On est dans la page de formulaire
{
	echo '&lt;form method=&quot;post&quot; action=&quot;connexion.php&quot;&gt;
	&lt;fieldset&gt;
	&lt;legend&gt;Connexion&lt;/legend&gt;
	&lt;p&gt;
	&lt;label for=&quot;pseudo&quot;&gt;Pseudo :&lt;/label&gt;&lt;input name=&quot;pseudo&quot; type=&quot;text&quot; id=&quot;pseudo&quot; /&gt;&lt;br /&gt;
	&lt;label for=&quot;password&quot;&gt;Mot de Passe :&lt;/label&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; /&gt;
	&lt;/p&gt;
	&lt;/fieldset&gt;
	&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Connexion&quot; /&gt;&lt;/p&gt;&lt;/form&gt;
	&lt;a href=&quot;./register.php&quot;&gt;Pas encore inscrit ?&lt;/a&gt;
	 
	&lt;/div&gt;
	&lt;/body&gt;
	&lt;/html&gt;';
}
?&gt;</code></pre><p id="r-617105" data-claire-element-id="617105">Voilà, c'est tout pour cette partie :) . Si elle est si courte, c'est parce que finalement, on a juste à afficher le formulaire ici.<br/> Voici tout de même quelques explications.<br/> Dans un premier temps, on vérifie donc que le visiteur n'est pas connecté, ensuite on regarde si la variable $_POST['pseudo'] est remplie, si ce n'est pas le cas, c'est que notre visiteur vient d'arriver et on lui affiche le formulaire.</p><p id="r-617106" data-claire-element-id="617106">Un autre point, la balise &lt;label for=&quot;pseudo&quot;&gt; : pour bien comprendre son intérêt, je vous envoie sur le <a href="http://www.siteduzero.com/tuto-3-7596-1-aligner-ses-formulaires-sans-tableaux.html">tuto de Romain128</a>.<br/> Si vous avez la flemme de le lire (ce qui serait dommage, mais bon ... :p ), sachez que cela permet à la fois d'aligner ses champs de texte, et de pouvoir aller directement sur le champ en cliquant sur le nom. Essayez : en cliquant sur pseudo, vous verrez (ça ne marche pas sur IE, apparemment).</p><p id="r-617107" data-claire-element-id="617107">Bref, si vous voulez un effet parfait, lancez <strong>votre fichier css</strong> et ajoutez ceci :</p><pre id="r-617108" data-claire-element-id="617108"><code data-claire-semantic="css">label {
display:block;
width:150px;
float:left;
}</code></pre><h2 id="r-traitement-1" data-claire-element-id="617128">Traitement</h2><p id="r-617110" data-claire-element-id="617110">On passe sans plus attendre à la partie traitement.</p><p id="r-617111" data-claire-element-id="617111">Cette partie va être une succession de vérifications pour savoir si tout a bien été rempli. J'ai répertorié plusieurs erreurs :</p><p id="r-617112" data-claire-element-id="617112">Soit un des champs est vide<br/> Soit le membre est déjà connecté (cas déjà traité)<br/> Soit le mot de passe est incorrect</p><p id="r-617113" data-claire-element-id="617113">Selon le cas, une variable $message contiendra un petit texte qu'on affichera ensuite.</p><p id="r-617114" data-claire-element-id="617114"><strong>Page : connexion.php</strong></p><pre id="r-617115" data-claire-element-id="617115"><code data-claire-semantic="html+php">&lt;?php
//On reprend la suite du code
else
{
    $message='';
    if (empty($_POST['pseudo']) || empty($_POST['password']) ) //Oublie d'un champ
    {
        $message = '&lt;p&gt;une erreur s\'est produite pendant votre identification.
	Vous devez remplir tous les champs&lt;/p&gt;
	&lt;p&gt;Cliquez &lt;a href=&quot;./connexion.php&quot;&gt;ici&lt;/a&gt; pour revenir&lt;/p&gt;';
    }
    else //On check le mot de passe
    {
        $query=$db-&gt;prepare('SELECT membre_mdp, membre_id, membre_rang, membre_pseudo
        FROM forum_membres WHERE membre_pseudo = :pseudo');
        $query-&gt;bindValue(':pseudo',$_POST['pseudo'], PDO::PARAM_STR);
        $query-&gt;execute();
        $data=$query-&gt;fetch();
	if ($data['membre_mdp'] == md5($_POST['password'])) // Acces OK !
	{
	    $_SESSION['pseudo'] = $data['membre_pseudo'];
	    $_SESSION['level'] = $data['membre_rang'];
	    $_SESSION['id'] = $data['membre_id'];
	    $message = '&lt;p&gt;Bienvenue '.$data['membre_pseudo'].', 
			vous êtes maintenant connecté!&lt;/p&gt;
			&lt;p&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; 
			pour revenir à la page d accueil&lt;/p&gt;';  
	}
	else // Acces pas OK !
	{
	    $message = '&lt;p&gt;Une erreur s\'est produite 
	    pendant votre identification.&lt;br /&gt; Le mot de passe ou le pseudo 
            entré n\'est pas correcte.&lt;/p&gt;&lt;p&gt;Cliquez &lt;a href=&quot;./connexion.php&quot;&gt;ici&lt;/a&gt; 
	    pour revenir à la page précédente
	    &lt;br /&gt;&lt;br /&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; 
	    pour revenir à la page d accueil&lt;/p&gt;';
	}
    $query-&gt;CloseCursor();
    }
    echo $message.'&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;';

}
?&gt;</code></pre><p id="r-617116" data-claire-element-id="617116">Terminé :) !<br/> Je pense que le code est assez commenté pour être compris, il n'y a de toute façon rien de dur, ce sont juste des if, tout ce qu'il y a de plus classique ^^ .</p><div id="r-617118" data-claire-element-id="617118" data-claire-semantic="question"><p id="r-617117" data-claire-element-id="617117">Ya un truc moyen, lorsqu'on a terminé la connexion on est redirigé vers la page d'accueil, on peut pas revenir à la page précédente ?</p></div><p id="r-617119" data-claire-element-id="617119">Si mais il faut au préalable ajouter un petit quelque chose sur la page <strong>connexion.php</strong></p><p id="r-617120" data-claire-element-id="617120">En fait il va falloir retenir la page visitée juste avant l'inscription et l'envoyer via un champ hidden avec tout le reste.</p><p id="r-617121" data-claire-element-id="617121"><strong>Page : connexion.php</strong></p><pre id="r-617122" data-claire-element-id="617122"><code data-claire-semantic="html+php">&lt;input type=&quot;hidden&quot; name=&quot;page&quot; value=&quot;&lt;?php echo $_SERVER['HTTP_REFERER']; ?&gt;&quot; /&gt;</code></pre><p id="r-617123" data-claire-element-id="617123">Ainsi il suffira de faire</p><p id="r-617124" data-claire-element-id="617124"><strong>Page : connexion.php</strong></p><pre id="r-617125" data-claire-element-id="617125"><code data-claire-semantic="html+php">&lt;?php
$page = htmlspecialchars($_POST['page']);
echo 'Cliquez &lt;a href=&quot;'.$page.'&quot;&gt;ici&lt;/a&gt; pour revenir à la page précédente';
?&gt;</code></pre><h3 id="r-en-resume-492" data-claire-element-id="617127">En résumé</h3><p id="r-617126" data-claire-element-id="617126">Si on résume ce qu'on vient de faire ici, on a donné la possibilité à n'importe quel visiteur déjà inscrit (on verra plus tard pour les inscriptions) de se connecter. Ainsi, une variable $_SESSION['pseudo'] est créée avec pour valeur... le pseudo du membre ! On a de plus créé d'autres variables de session pour simplifier les codes à venir.<br/> Puisqu'on a utilisé le système de sessions, la variable est détruite à la fin de la visite.</p><h2 id="r-deconnexion-1" data-claire-element-id="617134">Déconnexion</h2><div id="r-617130" data-claire-element-id="617130" data-claire-semantic="question"><p id="r-617129" data-claire-element-id="617129">C'est cool ton truc, mais si j'ai envie de me déconnecter ?</p></div><p id="r-617131" data-claire-element-id="617131">Bah j'y viens justement, on va créer une troisième page (jamais 2 sans 3), appelée <strong>deconnexion.php.</strong><br/> Le code est hyper court :</p><pre id="r-617132" data-claire-element-id="617132"><code data-claire-semantic="html+php">&lt;?php
session_start();
session_destroy();
$titre=&quot;Déconnexion&quot;;
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);

if ($id==0) erreur(ERR_IS_NOT_CO);

echo '&lt;p&gt;Vous êtes à présent déconnecté &lt;br /&gt;
Cliquez &lt;a href=&quot;'.htmlspecialchars($_SERVER['HTTP_REFERER']).'&quot;&gt;ici&lt;/a&gt; 
pour revenir à la page précédente.&lt;br /&gt;
Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à la page principale&lt;/p&gt;';
echo '&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;';
?&gt;</code></pre><p id="r-617133" data-claire-element-id="617133">Voilà, tout ce qu'on fait c'est appeler la fonction session_destroy pour détruire les variables de session.<br/> Bien sur cette fois on vérifie que le visiteur est bien connecté, à vous de créer la constante adéquate.<br/> Pour ne pas se retrouver perdus sur la page, j'ai mis un lien vers la dernière page visitée, c'est à vous de personnaliser le reste comme bon vous semble.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">
<span class="arrow"></span>
<span class="next">Inscription et connexion</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
<span class="next">Enregistrement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Enregistrement"></a><h2>Enregistrement</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
<span class="arrow"></span>
<span class="next">Connexion</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
<span class="next">Améliorations</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617136" data-claire-element-id="617136">On arrive à une partie un peu plus difficile, non pas parce qu'elle demande des connaissances particulières, mais parce que le code de ces deux pages va être plus long. Mais pas de panique : ce n'est pas ça qui va nous effrayer, hein ? ^^ <br/> Allez : on commence !</p><h2 id="r-formulaire-2" data-claire-element-id="617149">Formulaire</h2><p id="r-617137" data-claire-element-id="617137">Comme pour le système de connexion, on va diviser la page en deux parties: une pour le formulaire, et l'autre pour le traitement des données envoyées. Pour le nom, je n'ai rien trouvé de plus glamour que <strong>register.php</strong> on va faire avec pour l'instant :p .</p><p id="r-617138" data-claire-element-id="617138">Comme tout à l'heure, la partie formulaire est vraiment simple et courte, voyons d'abord le début :</p><p id="r-617139" data-claire-element-id="617139"><strong>Page : register.php</strong></p><pre id="r-617140" data-claire-element-id="617140"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Enregistrement&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; Enregistrement';

if ($id!=0) erreur(ERR_IS_CO);
?&gt;</code></pre><p id="r-617141" data-claire-element-id="617141">Vous voyez qu'on retrouve la fonction erreur, on commence à en voir l'utilité, c'est quand même plus rapide que de se farcir le bloc if/then/else plus le message à chaque fois.</p><p id="r-617142" data-claire-element-id="617142">On continue avec l'affichage du formulaire :</p><pre id="r-617143" data-claire-element-id="617143"><code data-claire-semantic="html+php">&lt;?php
if (empty($_POST['pseudo'])) // Si on la variable est vide, on peut considérer qu'on est sur la page de formulaire
{
	echo '&lt;h1&gt;Inscription 1/2&lt;/h1&gt;';
	echo '&lt;form method=&quot;post&quot; action=&quot;register.php&quot; enctype=&quot;multipart/form-data&quot;&gt;
	&lt;fieldset&gt;&lt;legend&gt;Identifiants&lt;/legend&gt;
	&lt;label for=&quot;pseudo&quot;&gt;* Pseudo :&lt;/label&gt;  &lt;input name=&quot;pseudo&quot; type=&quot;text&quot; id=&quot;pseudo&quot; /&gt; (le pseudo doit contenir entre 3 et 15 caractères)&lt;br /&gt;
	&lt;label for=&quot;password&quot;&gt;* Mot de Passe :&lt;/label&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; /&gt;&lt;br /&gt;
	&lt;label for=&quot;confirm&quot;&gt;* Confirmer le mot de passe :&lt;/label&gt;&lt;input type=&quot;password&quot; name=&quot;confirm&quot; id=&quot;confirm&quot; /&gt;
	&lt;/fieldset&gt;
	&lt;fieldset&gt;&lt;legend&gt;Contacts&lt;/legend&gt;
	&lt;label for=&quot;email&quot;&gt;* Votre adresse Mail :&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;email&quot; id=&quot;email&quot; /&gt;&lt;br /&gt;
	&lt;label for=&quot;msn&quot;&gt;Votre adresse MSN :&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;msn&quot; id=&quot;msn&quot; /&gt;&lt;br /&gt;
	&lt;label for=&quot;website&quot;&gt;Votre site web :&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;website&quot; id=&quot;website&quot; /&gt;
	&lt;/fieldset&gt;
	&lt;fieldset&gt;&lt;legend&gt;Informations supplémentaires&lt;/legend&gt;
	&lt;label for=&quot;localisation&quot;&gt;Localisation :&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;localisation&quot; id=&quot;localisation&quot; /&gt;
	&lt;/fieldset&gt;
	&lt;fieldset&gt;&lt;legend&gt;Profil sur le forum&lt;/legend&gt;
	&lt;label for=&quot;avatar&quot;&gt;Choisissez votre avatar :&lt;/label&gt;&lt;input type=&quot;file&quot; name=&quot;avatar&quot; id=&quot;avatar&quot; /&gt;(Taille max : 10Ko&lt;br /&gt;
	&lt;label for=&quot;signature&quot;&gt;Signature :&lt;/label&gt;&lt;textarea cols=&quot;40&quot; rows=&quot;4&quot; name=&quot;signature&quot; id=&quot;signature&quot;&gt;La signature est limitée à 200 caractères&lt;/textarea&gt;
	&lt;/fieldset&gt;
	&lt;p&gt;Les champs précédés d un * sont obligatoires&lt;/p&gt;
	&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;S\'inscrire&quot; /&gt;&lt;/p&gt;&lt;/form&gt;
	&lt;/div&gt;
	&lt;/body&gt;
	&lt;/html&gt;';
	
	
} //Fin de la partie formulaire
?&gt;</code></pre><p id="r-617144" data-claire-element-id="617144">Analysons un peu ce code. Tout à l'heure on s'est assuré que l'utilisateur était bien un simple visiteur, ensuite il faut regarder si on est dans le cas de l'affichage du formulaire ou dans le cas du traitement, pour cela on s'intéresse à la variable $_POST['pseudo']. A priori, si celle-ci est vide, c'est qu'on vient d'arriver sur la page (à moins que le visiteur n'est oublié de renseigner son pseudo ce qui est assez étrange vous me le concèderez...). Si tout va bien, on lance le formulaire avec plusieurs champs à remplir (le nombre des champs et ce que vous voulez en faire dépend totalement de votre table forum_membres ; si vous voulez par exemple demander l'âge du membre, pensez à créer un champ membre_age avant).</p><div id="r-617146" data-claire-element-id="617146" data-claire-semantic="question"><p id="r-617145" data-claire-element-id="617145">Dis-moi bonhomme, pourquoi tu as rajouté enctype=&quot;multipart/form-data&quot; dans ta balise &lt;form&gt; ?</p></div><p id="r-617147" data-claire-element-id="617147">C'est une bonne question... à laquelle je ne vais pas répondre. Non pas par flemme (encore que...), mais parce qu'un tutoriel rédigé par DHKold l'a déjà fait (et sûrement mieux que je ne le ferais). De toute façon, il vous faudra le lire si vous voulez comprendre la suite. Ce tutoriel traite des uploads de fichiers (<a href="http://www.siteduzero.com/tuto-3-1718-1-upload-de-fichiers-par-formulaire.html">lien</a>), et on va s'en servir pour les avatars.</p><p id="r-617148" data-claire-element-id="617148">Bon. Si vous êtes toujours là, on va pouvoir s'attaquer à la deuxième partie de la page :pirate: !</p><h2 id="r-traitement-2" data-claire-element-id="617192">Traitement</h2><p id="r-617150" data-claire-element-id="617150">Exactement comme pour la page connexion.php, on va réaliser une série de tests pour voir si tout concorde. Si ce n'est pas le cas, on affiche un message d'erreur. Mais contrairement au système de connexion, on n'a plus que trois champs à vérifier.</p><p id="r-617151" data-claire-element-id="617151"><strong>Page : register.php</strong></p><pre id="r-617152" data-claire-element-id="617152"><code data-claire-semantic="html+php">&lt;?php
else //On est dans le cas traitement
{
    $pseudo_erreur1 = NULL;
    $pseudo_erreur2 = NULL;
    $mdp_erreur = NULL;
    $email_erreur1 = NULL;
    $email_erreur2 = NULL;
    $msn_erreur = NULL;
    $signature_erreur = NULL;
    $avatar_erreur = NULL;
    $avatar_erreur1 = NULL;
    $avatar_erreur2 = NULL;
    $avatar_erreur3 = NULL;
?&gt;</code></pre><p id="r-617153" data-claire-element-id="617153">On n'oublie pas de déclarer nos variables au début, chez certains ça n'est pas nécessaire mais chez d'autres ça fait tout planter donc autant le faire.</p><h3 id="r-pseudo-et-mot-de-passe" data-claire-element-id="617164">Pseudo et mot de passe</h3><p id="r-617154" data-claire-element-id="617154">Pour la suite, on va commencer par vérifier les champs pseudo et mot de passe : ce sont les deux qui demandent le plus de tests.</p><pre id="r-617155" data-claire-element-id="617155"><code data-claire-semantic="html+php">&lt;?php

    //On récupère les variables
    $i = 0;
    $temps = time(); 
    $pseudo=$_POST['pseudo'];
    $signature = $_POST['signature'];
    $email = $_POST['email'];
    $msn = $_POST['msn'];
    $website = $_POST['website'];
    $localisation = $_POST['localisation'];
    $pass = md5($_POST['password']);
    $confirm = md5($_POST['confirm']);
	
    //Vérification du pseudo
    $query=$db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_membres WHERE membre_pseudo =:pseudo');
    $query-&gt;bindValue(':pseudo',$pseudo, PDO::PARAM_STR);
    $query-&gt;execute();
    $pseudo_free=($query-&gt;fetchColumn()==0)?1:0;
    $query-&gt;CloseCursor();
    if(!$pseudo_free)
    {
        $pseudo_erreur1 = &quot;Votre pseudo est déjà utilisé par un membre&quot;;
        $i++;
    }

    if (strlen($pseudo) &lt; 3 || strlen($pseudo) &gt; 15)
    {
        $pseudo_erreur2 = &quot;Votre pseudo est soit trop grand, soit trop petit&quot;;
        $i++;
    }

    //Vérification du mdp
    if ($pass != $confirm || empty($confirm) || empty($pass))
    {
        $mdp_erreur = &quot;Votre mot de passe et votre confirmation diffèrent, ou sont vides&quot;;
        $i++;
    }
?&gt;</code></pre><p id="r-617156" data-claire-element-id="617156">Voilà, on est arrivés au bout. Je vais détailler ce qui est écrit plus haut.</p><p id="r-617157" data-claire-element-id="617157">Pour commencer, j'initialise une variable $i à 0 : son rôle est de stocker le nombre d'erreurs. Pour ce faire, elle est incrémentée à chaque fois qu'un problème est détecté.</p><p id="r-617158" data-claire-element-id="617158">Ensuite on passe au pseudo. Il y a plusieurs erreurs possibles : soit le pseudo existe déjà, dans ce cas, on fait une requête qui va nous retourner le nombre d'entrées de la table forum_membres ayant le même pseudo que celui qui a été posté. Pour cela j'utilise une 4 lignes de code qui vous ont peut être posé un peu de soucis.</p><pre id="r-617159" data-claire-element-id="617159"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_membres WHERE membre_pseudo =:pseudo');
$query-&gt;bindValue(':pseudo',$pseudo, PDO::PARAM_STR);
$query-&gt;execute();
$pseudo_free=($query-&gt;fetchColumn()==0)?1:0;
?&gt;</code></pre><p id="r-617160" data-claire-element-id="617160">Bon pour les trois premières je pense que ça va, ce n'est qu'une simple requête tout ce qu'il y a de plus inoffensif. Pour la dernière, j'utilise la méthode fetchColumn() de l'objet $query qui va récupérer le nombre d'entrées correspondant à la requête.<br/> Si celle-ci est 0, tout va bien et la variable booléenne $pseudo_free sera mise à vraie (ou 1, le pseudo n'est pas déjà utilisé). Sinon elle vaudra 0 (le pseudo est déjà utilisé). Dans ce dernier cas, il y a un problème : donc, on incrémente $i.</p><p id="r-617161" data-claire-element-id="617161">Par ailleurs, vous avez pu remarquer la présence de la variable $message_pseudo1 : elle va stocker un message, qu'on affichera plus tard pour aider le membre à corriger ses erreurs.</p><p id="r-617162" data-claire-element-id="617162">Bref, continuons : la deuxième erreur concerne la taille du pseudo. En général, on aime qu'il contienne entre 3 et 15 caractères (ne me demandez pas pourquoi, par contre ^^ ) : donc j'ai utilisé la fonction strlen qui retourne le nombre de caractères d'un texte. Encore une fois, s'il y a un problème, on incrémente $i, et on crée le message.</p><p id="r-617163" data-claire-element-id="617163">On arrive maintenant au mot de passe. Pour lui, on a fait d'une pierre deux coups, puisque j'ai vérifié en même temps s'il était identique à la confirmation, et s'il était vide.</p><h3 id="r-e-mail-msn-et-signature" data-claire-element-id="617169">e-mail, MSN et Signature</h3><p id="r-617165" data-claire-element-id="617165">Sans plus attendre, la suite du code :p :</p><pre id="r-617166" data-claire-element-id="617166"><code data-claire-semantic="html+php">&lt;?php
    //Vérification de l'adresse email

    //Il faut que l'adresse email n'ait jamais été utilisée
    $query=$db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_membres WHERE membre_email =:mail');
    $query-&gt;bindValue(':mail',$email, PDO::PARAM_STR);
    $query-&gt;execute();
    $mail_free=($query-&gt;fetchColumn()==0)?1:0;
    $query-&gt;CloseCursor();
    
    if(!$mail_free)
    {
        $email_erreur1 = &quot;Votre adresse email est déjà utilisée par un membre&quot;;
        $i++;
    }
    //On vérifie la forme maintenant
    if (!preg_match(&quot;#^[a-zA-Z0-9._-]+@[a-zA-Z0-9._-]{2,}\.[a-z]{2,4}$#&quot;, $email) || empty($email))
    {
        $email_erreur2 = &quot;Votre adresse E-Mail n'a pas un format valide&quot;;
        $i++;
    }
    //Vérification de l'adresse MSN
    if (!preg_match(&quot;#^[a-zA-Z0-9._-]+@[a-zA-Z0-9._-]{2,}\.[a-z]{2,4}$#&quot;, $msn) &amp;&amp; !empty($msn))
    {
        $msn_erreur = &quot;Votre adresse MSN n'a pas un format valide&quot;;
        $i++;
    }
    //Vérification de la signature
    if (strlen($signature) &gt; 200)
    {
        $signature_erreur = &quot;Votre signature est trop longue&quot;;
        $i++;
    }
?&gt;</code></pre><p id="r-617167" data-claire-element-id="617167">On fait des vérifications sur les adresses e-mail et MSN, qui utilisent les regex, afin d'être sûrs que le visiteur n'a pas entré n'importe quoi.<br/> Remarquez que la regex utilisée pour l'adresse MSN peut être différente si on veut être plus précis et certains qu'elle est bien en .hotmail ou .msn...</p><p id="r-617168" data-claire-element-id="617168">En revanche pour la signature, on n'a pas ce genre de problème : on vérifie alors juste la longueur avec la fonction strlen ; par ailleurs, comme le champ n'était pas obligatoire, il est inutile de vérifier s'il est vide.</p><h3 id="r-l-avatar-2" data-claire-element-id="617178">L'avatar</h3><p id="r-617170" data-claire-element-id="617170">On va s'arrêter un petit moment sur l'avatar, car c'est ce qui demande le plus de vérifications. Vous pouvez facilement comprendre pourquoi on ne peut pas laisser des inconnus envoyer n'importe quoi sur notre serveur. Le tuto que j'ai mentionné plus haut explique ceci en détail.</p><pre id="r-617171" data-claire-element-id="617171"><code data-claire-semantic="html+php">&lt;?php
    //Vérification de l'avatar :
    if (!empty($_FILES['avatar']['size']))
    {
        //On définit les variables :
        $maxsize = 10024; //Poid de l'image
        $maxwidth = 100; //Largeur de l'image
        $maxheight = 100; //Longueur de l'image
        $extensions_valides = array( 'jpg' , 'jpeg' , 'gif' , 'png', 'bmp' ); //Liste des extensions valides
        
        if ($_FILES['avatar']['error'] &gt; 0)
        {
                $avatar_erreur = &quot;Erreur lors du transfert de l'avatar : &quot;;
        }
        if ($_FILES['avatar']['size'] &gt; $maxsize)
        {
                $i++;
                $avatar_erreur1 = &quot;Le fichier est trop gros : (&lt;strong&gt;&quot;.$_FILES['avatar']['size'].&quot; Octets&lt;/strong&gt;    contre &lt;strong&gt;&quot;.$maxsize.&quot; Octets&lt;/strong&gt;)&quot;;
        }

        $image_sizes = getimagesize($_FILES['avatar']['tmp_name']);
        if ($image_sizes[0] &gt; $maxwidth OR $image_sizes[1] &gt; $maxheight)
        {
                $i++;
                $avatar_erreur2 = &quot;Image trop large ou trop longue : 
                (&lt;strong&gt;&quot;.$image_sizes[0].&quot;x&quot;.$image_sizes[1].&quot;&lt;/strong&gt; contre &lt;strong&gt;&quot;.$maxwidth.&quot;x&quot;.$maxheight.&quot;&lt;/strong&gt;)&quot;;
        }
        
        $extension_upload = strtolower(substr(  strrchr($_FILES['avatar']['name'], '.')  ,1));
        if (!in_array($extension_upload,$extensions_valides) )
        {
                $i++;
                $avatar_erreur3 = &quot;Extension de l'avatar incorrecte&quot;;
        }
    }
?&gt;</code></pre><p id="r-617172" data-claire-element-id="617172">Certaines parties de ce code sont assez compliquées, mais elles sont détaillées dans le tutoriel de DHKold. Sachez simplement qu'on utilise le même système que précédemment, avec la variable i qui s'incrémente à chaque erreur.</p><p id="r-617173" data-claire-element-id="617173">Quelques remarques toutefois.<br/> - Les variables $maxsize, $maxwidth... définissent les limites de tailles, de poids et les extensions des avatars. Vous pouvez les modifier comme vous voulez : sachez bien que la partie 2 de ce tutoriel permettra de le faire directement à partir du panneau d'admin (il en va de même pour toutes les données chiffrées de cette page).</p><p id="r-617174" data-claire-element-id="617174">- L'intérêt d'ajouter la fonction <strong>strtolower()</strong> (qui convertit une chaîne en minuscules) est que les extensions de vos fichiers images seront tous en minuscules. Ainsi, une extension .JPG sera quand même reconnue comme valide.</p><div id="r-617176" data-claire-element-id="617176" data-claire-semantic="question"><p id="r-617175" data-claire-element-id="617175">Et on ne vérifie pas la localisation ? :euh:</p></div><p id="r-617177" data-claire-element-id="617177">Bah, en fait, je ne vois pas trop ce qu'on peut vérifier dans ce champ. Aucune regex ne peut vérifier le nom d'une ville, et on peut le laisser vide.</p><h3 id="r-on-affiche-le-message" data-claire-element-id="617183">On affiche le message !</h3><p id="r-617179" data-claire-element-id="617179">Voilà : maintenant qu'on a fait tous nos tests, il reste plus qu'à afficher le message.</p><pre id="r-617180" data-claire-element-id="617180"><code data-claire-semantic="html+php">&lt;?php
   if ($i==0)
   {
	echo'&lt;h1&gt;Inscription terminée&lt;/h1&gt;';
        echo'&lt;p&gt;Bienvenue '.stripslashes(htmlspecialchars($_POST['pseudo'])).' vous êtes maintenant inscrit sur le forum&lt;/p&gt;
	&lt;p&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à la page d accueil&lt;/p&gt;';
	
        //La ligne suivante sera commentée plus bas
	$nomavatar=(!empty($_FILES['avatar']['size']))?move_avatar($_FILES['avatar']):''; 
   
        $query=$db-&gt;prepare('INSERT INTO forum_membres (membre_pseudo, membre_mdp, membre_email,             
        membre_msn, membre_siteweb, membre_avatar,
        membre_signature, membre_localisation, membre_inscrit,   
        membre_derniere_visite)
        VALUES (:pseudo, :pass, :email, :msn, :website, :nomavatar, :signature, :localisation, :temps, :temps)');
	$query-&gt;bindValue(':pseudo', $pseudo, PDO::PARAM_STR);
	$query-&gt;bindValue(':pass', $pass, PDO::PARAM_INT);
	$query-&gt;bindValue(':email', $email, PDO::PARAM_STR);
	$query-&gt;bindValue(':msn', $msn, PDO::PARAM_STR);
	$query-&gt;bindValue(':website', $website, PDO::PARAM_STR);
	$query-&gt;bindValue(':nomavatar', $nomavatar, PDO::PARAM_STR);
	$query-&gt;bindValue(':signature', $signature, PDO::PARAM_STR);
	$query-&gt;bindValue(':localisation', $localisation, PDO::PARAM_STR);
	$query-&gt;bindValue(':temps', $temps, PDO::PARAM_INT);
        $query-&gt;execute();

	//Et on définit les variables de sessions
        $_SESSION['pseudo'] = $pseudo;
        $_SESSION['id'] = $db-&gt;lastInsertId(); ;
        $_SESSION['level'] = 2;
        $query-&gt;CloseCursor();
    }
    else
    {
        echo'&lt;h1&gt;Inscription interrompue&lt;/h1&gt;';
        echo'&lt;p&gt;Une ou plusieurs erreurs se sont produites pendant l incription&lt;/p&gt;';
        echo'&lt;p&gt;'.$i.' erreur(s)&lt;/p&gt;';
        echo'&lt;p&gt;'.$pseudo_erreur1.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$pseudo_erreur2.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$mdp_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$email_erreur1.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$email_erreur2.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$msn_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$signature_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur1.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur2.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur3.'&lt;/p&gt;';
       
        echo'&lt;p&gt;Cliquez &lt;a href=&quot;./register.php&quot;&gt;ici&lt;/a&gt; pour recommencer&lt;/p&gt;';
    }
}
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617181" data-claire-element-id="617181">Comment ça marche, ce code ? Notre variable $i nous indique le nombre d'erreurs, c'est pourquoi on a juste à vérifier qu'elle soit égale à 0 pour savoir si tout colle.<br/> Et si jamais ce n'est pas le cas, on affiche tous les messages d'erreurs qu'on a créés auparavant.</p><p id="r-617182" data-claire-element-id="617182">Une fois que le tout est bouclé, on peut dire qu'on a terminé le système de <em>login</em> et d'inscription du forum. L'avantage par rapport à un forum comme phpbb, c'est que rien ne vous empêche de mettre les champs de connexions dans le menu plutôt que de mettre un lien (bon, c'était possible aussi avec phpbb, mais un peu plus compliqué ; puis là, vous savez comment marche votre système :) ).</p><h3 id="r-retour-sur-l-avatar" data-claire-element-id="617191">Retour sur l'avatar</h3><p id="r-617184" data-claire-element-id="617184">Revenons un peu sur cette ligne :</p><pre id="r-617185" data-claire-element-id="617185"><code data-claire-semantic="html+php">&lt;?php
$nomavatar=(!empty($_FILES['avatar']['size']))?move_avatar($_FILES['avatar']):'';
?&gt;</code></pre><p id="r-617186" data-claire-element-id="617186">On s'occupe ici de déplacer l'avatar qui a été uploadé. Malheureusement pour vous, la fonction move_avatar n'est pas native de php, il va falloir la créer, pour cela, pas de panique, rendez-vous sur le fichier <strong>function.php</strong>.<br/> La fonction move_avatar va prendre en argument la variable de type array $avatar qui contiendra les infos sur le fichier à uploader (je vous renvoie sur le tuto de DHKold pour plus de précisions), elle va renvoyer un message si l'upload s'est bien passé et s'occupera d'enregistrer le fichier.</p><pre id="r-617187" data-claire-element-id="617187"><code data-claire-semantic="html+php">&lt;?php
function move_avatar($avatar)
{
    $extension_upload = strtolower(substr(  strrchr($avatar['name'], '.')  ,1));
    $name = time();
    $nomavatar = str_replace(' ','',$name).&quot;.&quot;.$extension_upload;
    $name = &quot;./images/avatars/&quot;.str_replace(' ','',$name).&quot;.&quot;.$extension_upload;
    move_uploaded_file($avatar['tmp_name'],$name);
    return $nomavatar;
}
?&gt;</code></pre><p id="r-617188" data-claire-element-id="617188">Dans un premier temps, on lui donne le nom du timestamp actuel afin que celui-ci soit unique. Ensuite, on s'occupe d'ajouter l'extension. Le tout, nom de l'image + extension, est envoyé dans la base de données. Enfin, la fonction <strong>move_uploaded_file()</strong> déplace l'image dans le dossier <strong>images/avatars</strong>.</p><aside id="r-617190" data-claire-element-id="617190" data-claire-semantic="information"><p id="r-617189" data-claire-element-id="617189">Il faut donc que vous ayez créé un dossier avatars dans le dossier images. Pensez donc à mettre un CHMOD correct (à priori, sous windows, il est inutile de changer quoi que ce soit).</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
<span class="arrow"></span>
<span class="next">Connexion</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
<span class="next">Améliorations</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Amliorations"></a><h2>Améliorations</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
<span class="arrow"></span>
<span class="next">Enregistrement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">
<span class="next">Les profils</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617194" data-claire-element-id="617194">Maintenant, avant de se lancer dans la suite, je vais donner quelques améliorations que vous pouvez rajouter si vous en avez envie. Cela dit, elles ne sont pas nécessaires au fonctionnement même du forum.</p><h3 id="r-mail" data-claire-element-id="617202">Mail</h3><p id="r-617195" data-claire-element-id="617195"><em><strong>Envoyez un mail au membre qui vient de s'inscrire</strong></em> : pour cela, il suffit d'utiliser la fonction native mail de php. Si vous voulez plus de détails, regardez le code suivant :</p><pre id="r-617196" data-claire-element-id="617196"><code data-claire-semantic="html+php">&lt;?php
//Message
$message = &quot;Bienvenue sur mon super forum !&quot;;
//Titre
$titre = &quot;Inscription à mon super forum !&quot;;

mail($_POST['email'], $titre, $message);
?&gt;</code></pre><p id="r-617197" data-claire-element-id="617197">Vous pouvez rappeler dans ce mail le mot de passe et le pseudo.</p><aside id="r-617199" data-claire-element-id="617199" data-claire-semantic="warning"><p id="r-617198" data-claire-element-id="617198">L'usage de la fonction mail est limité à un nombre d'envois par mois chez certains hébergeurs.</p></aside><p id="r-617200" data-claire-element-id="617200">Vous pouvez également faire un système d'enregistrement avec vérification par email de façon à ce que les membres n'entrent pas n'importe quoi comme adresse.<br/> Un moyen de le faire est de créer au moment de l'inscription un code qu'on envoie ensuite par mail au futur membre, on ajoute du même coup 2 champs à la table forum_membres, un champ verif qui vaut 0 par défaut et qui sera mis à un une fois la vérification faite, et un champ code qui contiendra notre code.<br/> On lui demande alors de se rendre sur une page spéciale du type /forum/verif_inscription.php?code=012457505 puis réaliser la requête suivante :</p><pre id="r-617201" data-claire-element-id="617201"><code data-claire-semantic="html+php">&lt;?php
UPDATE forum_membres SET membre_verif = 1 WHERE membre_code = :code
?&gt;</code></pre><h3 id="r-cookie" data-claire-element-id="617217">cookie</h3><p id="r-617203" data-claire-element-id="617203">Autre amélioration importante : pour l'instant, on utilise les variables de session pour reconnaître le membre ; rien ne vous empêche d'<em><strong>utiliser les cookies</strong></em>. Pour cela, il suffit de rajouter une checkbox en dessous du formulaire d'inscription :</p><pre id="r-617204" data-claire-element-id="617204"><code data-claire-semantic="html">&lt;label&gt;Se souvenir de moi ?&lt;/label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;souvenir&quot; /&gt;&lt;br /&gt;</code></pre><p id="r-617205" data-claire-element-id="617205">Ensuite, vous devez créer un cookie dans la page connexion.php.</p><pre id="r-617206" data-claire-element-id="617206"><code data-claire-semantic="html+php">&lt;?php
if (isset($_POST['souvenir']))
{
$expire = time() + 365*24*3600;
setcookie('pseudo', $_SESSION['pseudo'], $expire); 
}
?&gt;</code></pre><aside id="r-617208" data-claire-element-id="617208" data-claire-semantic="warning"><p id="r-617207" data-claire-element-id="617207">Vérifiez bien que ce bout de code a été placé dans la partie où vous savez que le pseudo et le mot de passe entrés sont les bons !</p></aside><p id="r-617209" data-claire-element-id="617209">Ensuite, si l'utilisateur a bien coché l'option <em>Se souvenir de moi</em>, il sera automatiquement connecté en arrivant sur le site. Il faut donc rajouter dans toutes les pages (utiliser la page debut.php pour ça) ce bout de code :</p><pre id="r-617210" data-claire-element-id="617210"><code data-claire-semantic="html+php">&lt;?php
if (isset ($_COOKIE['pseudo']) &amp;&amp; empty($id))
{
$_SESSION['pseudo'] = $_COOKIE['pseudo']; 

/* On créé la variable de session à partir du cookie pour ne pas avoir à vérifier 2 fois sur les pages qu'un membre est connecté. */

}
if (isset ($_COOKIE['pseudo']) &amp;&amp; !empty($id))
{
//On est connecté
}
if (!isset ($_COOKIE['pseudo']) &amp;&amp; empty($id))
{
//On n'est pas connecté
}
?&gt;</code></pre><p id="r-617211" data-claire-element-id="617211">Ça vous évitera d'avoir à modifier tous vos codes ^^ .</p><p id="r-617212" data-claire-element-id="617212">Et pour la déconnexion, il faut penser à supprimer aussi le cookie (sinon, on resterait connecté).</p><pre id="r-617213" data-claire-element-id="617213"><code data-claire-semantic="html+php">&lt;?php
session_start();
if (isset ($_COOKIE['pseudo']))
{
setcookie('pseudo', '', -1);
}
session_destroy();
?&gt;</code></pre><p id="r-617214" data-claire-element-id="617214">Comme cela, on met une date d'expiration négative au cookie, et ça marche !</p><aside id="r-617216" data-claire-element-id="617216" data-claire-semantic="error"><p id="r-617215" data-claire-element-id="617215">Il faut également entrer le mot de passe dans le cookie afin d'éviter qu'une personne mal intentionnée modifie son cookie en y inscrivant le pseudo d'un autre membre.</p></aside><h3 id="r-signature-4" data-claire-element-id="617219">Signature</h3><p id="r-617218" data-claire-element-id="617218">Vous pouvez également <em><strong>autoriser les balises de mise en forme du texte</strong></em> (l'équivalent du bbcode) et <em><strong>les smilies dans la signature</strong></em>. Toutefois, vous n'allez pas pouvoir le faire avant d'avoir créé ce &quot;code&quot;. Donc, patience ;) .</p><h3 id="r-systeme-anti-bot" data-claire-element-id="617225">Système anti-bot</h3><p id="r-617220" data-claire-element-id="617220">Les <em>bots</em> sont des petits programmes qui peuvent s'inscrire en remplissant des formulaires relativement simples. Afin d'éviter cela, certains forums proposent une image sur laquelle est écrit un code, composé de lettres et de chiffres qu'on vous demande de recopier. Pour savoir comment réaliser cette option, vous pouvez aller lire <a href="http://www.siteduzero.com/tuto-3-8426-1-faire-une-image-anti-bots-facilement.html">ce tuto</a> sur ce site.</p><p id="r-617221" data-claire-element-id="617221">Voilà : je pense que c'est à peu près tout pour les améliorations qui peuvent être apportées à ce système de Connexion / Enregistrement.</p><p id="r-617222" data-claire-element-id="617222">Ah si, dernière chose : vous avez remarqué que le système de connexion / déconnexion utilise 2 pages... pas très pratique :( donc : si vous voulez éviter ça, vous pouvez très bien passer la valeur de la commande dans l'url de la page connexion.php et la récupérer avec $_GET.<br/> Par exemple : connexion.php?action=déconnexion</p><p id="r-617223" data-claire-element-id="617223">A partir de maintenant, vous pouvez vous inscrire sur votre propre forum (pratique, hein ? :p ). Et les futurs visiteurs de ces pages pourront le faire aussi.</p><p id="r-617224" data-claire-element-id="617224">Le prochain chapitre est la suite logique de celui-ci, dans le sens où l'on va y traiter de l'affichage et de la modification du profil de chaque membre. Si vous gardez bien en tête ce qu'on vient de faire, ça devrait vraiment passer tout seul :) .</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
<span class="arrow"></span>
<span class="next">Enregistrement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">
<span class="next">Les profils</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesprofils"></a><h2>Les profils</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
<span class="arrow"></span>
<span class="next">Améliorations</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
<span class="next">Voir le profil</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617228" data-claire-element-id="617228">On en arrive au chapitre 4, et l'air de rien, notre forum commence à prendre forme. Bien sûr, pour l'instant on ne peut pas l'utiliser : mais bon, on peut déjà s'y inscrire. Et d'ailleurs, lorsqu'un membre s'inscrit, un formulaire lui demande de renseigner pas mal de choses, comme son adresse MSN ou sa localisation ; on ne fait pas vraiment ça juste pour lui faire remplir plus de champs, mais pour pouvoir créer une fiche de renseignements à son sujet. Cette fiche (ou profil), on va voir en détail comment la faire.</p><p id="r-617229" data-claire-element-id="617229">Allez, au boulot :p .</p>
</div><a name="Voirleprofil"></a><h2>Voir le profil</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">
<span class="arrow"></span>
<span class="next">Les profils</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
<span class="next">Modifier le profil</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617230" data-claire-element-id="617230">La première des deux options est à la fois la plus simple à réaliser et la plus utilisée. Il s'agit simplement d'afficher les informations au sujet d'un membre sur une page.</p><h3 id="r-les-variables-40" data-claire-element-id="617237">Les variables</h3><p id="r-617231" data-claire-element-id="617231">L'url de cette page est <strong>voirprofil.php</strong> ; cela dit, il nous faut connaitre l'id du membre dont on veut lire le profil, ainsi que l'action que l'on souhaite exécuter sur cette page (modifier ou consulter).</p><p id="r-617232" data-claire-element-id="617232">Donc on a besoin de deux variables : ainsi, l'adresse du profil d'un membre se présentera toujours comme ceci :</p><p id="r-617233" data-claire-element-id="617233"><em>/voirprofil.php?m=3&amp;action=consulter</em></p><p id="r-617234" data-claire-element-id="617234">Normalement, il ne doit pas y avoir trop de problèmes à ce niveau. On a nos deux variables :</p><p id="r-617235" data-claire-element-id="617235">$_GET['m'] = 3<br/> $_GET['action'] = consulter</p><p id="r-617236" data-claire-element-id="617236">Et leurs valeurs vont nous permettre de savoir quoi afficher. :)</p><h3 id="r-initialisation-14" data-claire-element-id="617244">Initialisation</h3><p id="r-617238" data-claire-element-id="617238">Le principe de la page repose sur un <em>switch</em> : on va vérifier la valeur de la variable action, et afficher le contenu en fonction.</p><p id="r-617239" data-claire-element-id="617239"><strong>Page : voirprofil.php</strong></p><pre id="r-617240" data-claire-element-id="617240"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Profil&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
//On récupère la valeur de nos variables passées par URL
$action = isset($_GET['action'])?htmlspecialchars($_GET['action']):'consulter';
$membre = isset($_GET['m'])?(int) $_GET['m']:'';
?&gt;</code></pre><p id="r-617241" data-claire-element-id="617241">Rien de très différent de ce qu'on a vu dans les chapitres précédents, si ce n'est qu'on récupère la valeur des variables qui se trouvent dans l'url.</p><aside id="r-617243" data-claire-element-id="617243" data-claire-semantic="information"><p id="r-617242" data-claire-element-id="617242">Bien sûr, ce n'est qu'une question de clarté ; rien ne vous empêche de garder l'écriture $_GET['m'] plutôt que $membre.</p></aside><h3 id="r-le-switch" data-claire-element-id="617251">Le switch</h3><p id="r-617245" data-claire-element-id="617245">On arrive au cœur du code : voici donc la partie du script qui permet de consulter un profil :</p><pre id="r-617246" data-claire-element-id="617246"><code data-claire-semantic="html+php">&lt;?php
//On regarde la valeur de la variable $action
switch($action)
{
    //Si c'est &quot;consulter&quot;
    case &quot;consulter&quot;:
       //On récupère les infos du membre
       $query=$db-&gt;prepare('SELECT membre_pseudo, membre_avatar,
       membre_email, membre_msn, membre_signature, membre_siteweb, membre_post,
       membre_inscrit, membre_localisation
       FROM forum_membres WHERE membre_id=:membre');
       $query-&gt;bindValue(':membre',$membre, PDO::PARAM_INT);
       $query-&gt;execute();
       $data=$query-&gt;fetch();

       //On affiche les infos sur le membre
       echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
       profil de '.stripslashes(htmlspecialchars($data['membre_pseudo']));
       echo'&lt;h1&gt;Profil de '.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/h1&gt;';
       
       echo'&lt;img src=&quot;./images/avatars/'.$data['membre_avatar'].'&quot;
       alt=&quot;Ce membre n a pas d avatar&quot; /&gt;';
       
       echo'&lt;p&gt;&lt;strong&gt;Adresse E-Mail : &lt;/strong&gt;
       &lt;a href=&quot;mailto:'.stripslashes($data['membre_email']).'&quot;&gt;
       '.stripslashes(htmlspecialchars($data['membre_email'])).'&lt;/a&gt;&lt;br /&gt;';
       
       echo'&lt;strong&gt;MSN Messenger : &lt;/strong&gt;'.stripslashes(htmlspecialchars($data['membre_msn'])).'&lt;br /&gt;';
       
       echo'&lt;strong&gt;Site Web : &lt;/strong&gt;
       &lt;a href=&quot;'.stripslashes($data['membre_siteweb']).'&quot;&gt;'.stripslashes(htmlspecialchars($data['membre_siteweb'])).'&lt;/a&gt;
       &lt;br /&gt;&lt;br /&gt;';
 
       echo'Ce membre est inscrit depuis le
       &lt;strong&gt;'.date('d/m/Y',$data['membre_inscrit']).'&lt;/strong&gt;
       et a posté &lt;strong&gt;'.$data['membre_post'].'&lt;/strong&gt; messages
       &lt;br /&gt;&lt;br /&gt;';
       echo'&lt;strong&gt;Localisation : &lt;/strong&gt;'.stripslashes(htmlspecialchars($data['membre_localisation'])).'
       &lt;/p&gt;';
       $query-&gt;CloseCursor();
       break;
?&gt;</code></pre><p id="r-617247" data-claire-element-id="617247">C'est tout, vous voyez que finalement il n'y a pas grand-chose : logique, puisqu'il ne s'agit que d'afficher les infos stockées dans une base de données.<br/> Une fois dans le switch, on lance une requête qui va retourner tout ce qu'elle trouve sur le membre dont l'id est contenu dans la variable. Si jamais elle ne trouve rien, c'est que l'id n'est attribuée à aucun membre ; ça ne devrait pas arriver sauf si l'url a été modifiée par le visiteur. Dans ce cas, on affiche un message d'erreur.</p><p id="r-617248" data-claire-element-id="617248">On en arrive donc à la fin de la partie de simple visite d'un profil, et on va maintenant voir la partie modification. C'est parti :p !</p><aside id="r-617250" data-claire-element-id="617250" data-claire-semantic="warning"><p id="r-617249" data-claire-element-id="617249">La modification du profil se fait sur la même page que la consultation, c'est pourquoi les accolades restent ouvertes !</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">
<span class="arrow"></span>
<span class="next">Les profils</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
<span class="next">Modifier le profil</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Modifierleprofil"></a><h2>Modifier le profil</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
<span class="arrow"></span>
<span class="next">Voir le profil</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">
<span class="next">Forums et Topics</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-modification-1" data-claire-element-id="617259">Modification</h2><p id="r-617253" data-claire-element-id="617253">La modification du profil ne peut être faite que par le membre concerné (c'est mieux, quand même :p ). On va donc devoir utiliser la variable $id (qui je vous le rappelle correspond à l'id du visiteur). Ensuite, il suffit d'afficher le même formulaire que celui de l'inscription, sauf que cette fois, on pré-remplit les champs avec les valeurs qu'on connaît déjà.</p><p id="r-617254" data-claire-element-id="617254"><strong>Page : voirprofil.php</strong></p><pre id="r-617255" data-claire-element-id="617255"><code data-claire-semantic="html+php">&lt;?php
    //Si on choisit de modifier son profil
    case &quot;modifier&quot;:
    if (empty($_POST['sent'])) // Si on la variable est vide, on peut considérer qu'on est sur la page de formulaire
    {
        //On commence par s'assurer que le membre est connecté
        if ($id==0) erreur(ERR_IS_NOT_CO);

        //On prend les infos du membre
        $query=$db-&gt;prepare('SELECT membre_pseudo, membre_email,
        membre_siteweb, membre_signature, membre_msn, membre_localisation,
        membre_avatar
        FROM forum_membres WHERE membre_id=:id');
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;execute();
        $data=$query-&gt;fetch();
        echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; Modification du profil';
        echo '&lt;h1&gt;Modifier son profil&lt;/h1&gt;';
        
        echo '&lt;form method=&quot;post&quot; action=&quot;voirprofil.php?action=modifier&quot; enctype=&quot;multipart/form-data&quot;&gt;
       
 
        &lt;fieldset&gt;&lt;legend&gt;Identifiants&lt;/legend&gt;
        Pseudo : &lt;strong&gt;'.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/strong&gt;&lt;br /&gt;       
        &lt;label for=&quot;password&quot;&gt;Nouveau mot de Passe :&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; /&gt;&lt;br /&gt;
        &lt;label for=&quot;confirm&quot;&gt;Confirmer le mot de passe :&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;confirm&quot; id=&quot;confirm&quot;  /&gt;
        &lt;/fieldset&gt;
 
        &lt;fieldset&gt;&lt;legend&gt;Contacts&lt;/legend&gt;
        &lt;label for=&quot;email&quot;&gt;Votre adresse E_Mail :&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;email&quot; id=&quot;email&quot;
        value=&quot;'.stripslashes($data['membre_email']).'&quot; /&gt;&lt;br /&gt;
 
        &lt;label for=&quot;msn&quot;&gt;Votre adresse MSN :&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;msn&quot; id=&quot;msn&quot;
        value=&quot;'.stripslashes($data['membre_msn']).'&quot; /&gt;&lt;br /&gt;
 
        &lt;label for=&quot;website&quot;&gt;Votre site web :&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;website&quot; id=&quot;website&quot;
        value=&quot;'.stripslashes($data['membre_siteweb']).'&quot; /&gt;&lt;br /&gt;
        &lt;/fieldset&gt;
 
        &lt;fieldset&gt;&lt;legend&gt;Informations supplémentaires&lt;/legend&gt;
        &lt;label for=&quot;localisation&quot;&gt;Localisation :&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;localisation&quot; id=&quot;localisation&quot;
        value=&quot;'.stripslashes($data['membre_localisation']).'&quot; /&gt;&lt;br /&gt;
        &lt;/fieldset&gt;
               
        &lt;fieldset&gt;&lt;legend&gt;Profil sur le forum&lt;/legend&gt;
        &lt;label for=&quot;avatar&quot;&gt;Changer votre avatar :&lt;/label&gt;
        &lt;input type=&quot;file&quot; name=&quot;avatar&quot; id=&quot;avatar&quot; /&gt;
        (Taille max : 10 ko)&lt;br /&gt;&lt;br /&gt;
        &lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;delete&quot; value=&quot;Delete&quot; /&gt;
        Supprimer l avatar&lt;/label&gt;
        Avatar actuel :
        &lt;img src=&quot;./images/avatars/'.$data['membre_avatar'].'&quot;
        alt=&quot;pas d avatar&quot; /&gt;
     
        &lt;br /&gt;&lt;br /&gt;
        &lt;label for=&quot;signature&quot;&gt;Signature :&lt;/label&gt;
        &lt;textarea cols=&quot;40&quot; rows=&quot;4&quot; name=&quot;signature&quot; id=&quot;signature&quot;&gt;
        '.stripslashes($data['membre_signature']).'&lt;/textarea&gt;
     
     
        &lt;/fieldset&gt;
        &lt;p&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Modifier son profil&quot; /&gt;
        &lt;input type=&quot;hidden&quot; id=&quot;sent&quot; name=&quot;sent&quot; value=&quot;1&quot; /&gt;
        &lt;/p&gt;&lt;/form&gt;';
        $query-&gt;CloseCursor();   
    }   
    else //Sinon on est dans la page de traitement
    {
        //Traitement (voir plus bas)
    }
    break;
 
default; //Si jamais c'est aucun de ceux-là c'est qu'il y a eu un problème :o
echo'&lt;p&gt;Cette action est impossible&lt;/p&gt;';
 
} //Fin du switch
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617256" data-claire-element-id="617256">J'ai mis d'un coup la partie formulaire, car de toute façon ce code, vous le connaissez déjà. Il en sera de même pour la suite qui est l'identique de register.php, en remplaçant les INSERT INTO par des UPDATE.</p><p id="r-617257" data-claire-element-id="617257">Pour éviter que n'importe qui ne modifie le profil des autres, on ne peut accéder à cette page que grâce à la variable de session $_SESSION['id']. Celle-ci permet de retourner des infos uniquement sur le membre qui visite la page.</p><p id="r-617258" data-claire-element-id="617258">Encore une chose : pour que ça ne devienne pas ingérable, un membre ne peut pas en général modifier son pseudo, c'est aux administrateurs de s'en charger. C'est pourquoi il n'y a pas de champ pseudo dans cette page, aussi, pour vérifier qu'on est bien dans la partie formulaire, il faut utiliser autre chose, c'est pour cela que j'ai ajouté une variable $_POST['sent'] qui nous renseignera sur la partie de la page à afficher.</p><h2 id="r-traitement-3" data-claire-element-id="617270">Traitement</h2><p id="r-617260" data-claire-element-id="617260">On passe donc ici à la suite de la page <strong>voirprofil.php</strong> : je vous conseille de garder sous la main la page register.php si vous n'avez pas la méthode utilisée bien en tête.</p><p id="r-617261" data-claire-element-id="617261">On débute sans plus attendre :</p><p id="r-617262" data-claire-element-id="617262"><strong>Page : voirprofil.php</strong></p><pre id="r-617263" data-claire-element-id="617263"><code data-claire-semantic="html+php">&lt;?php
    else //Cas du traitement
    {
     //On déclare les variables 

    $mdp_erreur = NULL;
    $email_erreur1 = NULL;
    $email_erreur2 = NULL;
    $msn_erreur = NULL;
    $signature_erreur = NULL;
    $avatar_erreur = NULL;
    $avatar_erreur1 = NULL;
    $avatar_erreur2 = NULL;
    $avatar_erreur3 = NULL;

    //Encore et toujours notre belle variable $i :p
    $i = 0;
    $temps = time(); 
    $signature = $_POST['signature'];
    $email = $_POST['email'];
    $msn = $_POST['msn'];
    $website = $_POST['website'];
    $localisation = $_POST['localisation'];
    $pass = md5($_POST['password']);
    $confirm = md5($_POST['confirm']);


    //Vérification du mdp
    if ($pass != $confirm || empty($confirm) || empty($pass))
    {
         $mdp_erreur = &quot;Votre mot de passe et votre confirmation diffèrent ou sont vides&quot;;
         $i++;
    }

    //Vérification de l'adresse email
    //Il faut que l'adresse email n'ait jamais été utilisée (sauf si elle n'a pas été modifiée)

    //On commence donc par récupérer le mail
    $query=$db-&gt;prepare('SELECT membre_email FROM forum_membres WHERE membre_id =:id'); 
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();
    if (strtolower($data['membre_email']) != strtolower($email))
    {
        //Il faut que l'adresse email n'ait jamais été utilisée
        $query=$db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_membres WHERE membre_email =:mail');
        $query-&gt;bindValue(':mail',$email,PDO::PARAM_STR);
        $query-&gt;execute();
        $mail_free=($query-&gt;fetchColumn()==0)?1:0;
        $query-&gt;CloseCursor();
        if(!$mail_free)
        {
            $email_erreur1 = &quot;Votre adresse email est déjà utilisé par un membre&quot;;
            $i++;
        }

        //On vérifie la forme maintenant
        if (!preg_match(&quot;#^[a-z0-9A-Z._-]+@[a-z0-9._-]{2,}\.[a-z]{2,4}$#&quot;, $email) || empty($email))
        {
            $email_erreur2 = &quot;Votre nouvelle adresse E-Mail n'a pas un format valide&quot;;
            $i++;
        }
    }
    //Vérification de l’adresse MSN
    if (!preg_match(&quot;#^[a-z0-9._-]+@[a-z0-9._-]{2,}\.[a-z]{2,4}$#&quot;, $msn) &amp;&amp; !empty($msn))
    {
        $msn_erreur = &quot;Votre nouvelle adresse MSN n'a pas un format valide&quot;;
        $i++;
    }

    //Vérification de la signature
    if (strlen($signature) &gt; 200)
    {
        $signature_erreur = &quot;Votre nouvelle signature est trop longue&quot;;
        $i++;
    }
 
 
    //Vérification de l'avatar
 
    if (!empty($_FILES['avatar']['size']))
    {
        //On définit les variables :
        $maxsize = 30072; //Poid de l'image
        $maxwidth = 100; //Largeur de l'image
        $maxheight = 100; //Longueur de l'image
        //Liste des extensions valides
        $extensions_valides = array( 'jpg' , 'jpeg' , 'gif' , 'png', 'bmp' );
 
        if ($_FILES['avatar']['error'] &gt; 0)
        {
        $avatar_erreur = &quot;Erreur lors du tranfsert de l'avatar : &quot;;
        }
        if ($_FILES['avatar']['size'] &gt; $maxsize)
        {
        $i++;
        $avatar_erreur1 = &quot;Le fichier est trop gros :
        (&lt;strong&gt;&quot;.$_FILES['avatar']['size'].&quot; Octets&lt;/strong&gt;
        contre &lt;strong&gt;&quot;.$maxsize.&quot; Octets&lt;/strong&gt;)&quot;;
        }
 
        $image_sizes = getimagesize($_FILES['avatar']['tmp_name']);
        if ($image_sizes[0] &gt; $maxwidth OR $image_sizes[1] &gt; $maxheight)
        {
        $i++;
        $avatar_erreur2 = &quot;Image trop large ou trop longue :
        (&lt;strong&gt;&quot;.$image_sizes[0].&quot;x&quot;.$image_sizes[1].&quot;&lt;/strong&gt; contre
        &lt;strong&gt;&quot;.$maxwidth.&quot;x&quot;.$maxheight.&quot;&lt;/strong&gt;)&quot;;
        }
 
        $extension_upload = strtolower(substr(  strrchr($_FILES['avatar']['name'], '.')  ,1));
        if (!in_array($extension_upload,$extensions_valides) )
        {
                $i++;
                $avatar_erreur3 = &quot;Extension de l'avatar incorrecte&quot;;
        }
    }
?&gt;</code></pre><p id="r-617264" data-claire-element-id="617264">Voici pour la première partie ; tout ce j'ai changé par rapport à la page register.php, c'est que j'ai rajouté &quot;nouvelle&quot; ou &quot;nouveau&quot; dans les messages d'erreurs :p . La seule difficulté vient du fait qu'on ne sait pas si le membre décide de modifier son adresse e-mail ou de la laisser. Du coup, on ne peut s'assurer de son unicité qu'une fois qu'on est certain qu'il l'a changée (bah oui sinon elle risque pas d'être unique ;) ).</p><p id="r-617265" data-claire-element-id="617265">La suite va quand même demander un peu plus de retouches :</p><pre id="r-617266" data-claire-element-id="617266"><code data-claire-semantic="html+php">&lt;?php
    echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; Modification du profil';
    echo '&lt;h1&gt;Modification d\'un profil&lt;/h1&gt;';

 
    if ($i == 0) // Si $i est vide, il n'y a pas d'erreur
    {
        if (!empty($_FILES['avatar']['size']))
        {
                $nomavatar=move_avatar($_FILES['avatar']);
                $query=$db-&gt;prepare('UPDATE forum_membres
                SET membre_avatar = :avatar 
                WHERE membre_id = :id');
                $query-&gt;bindValue(':avatar',$nomavatar,PDO::PARAM_STR);
                $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
                $query-&gt;execute();
                $query-&gt;CloseCursor();
        }
 
        //Une nouveauté ici : on peut choisis de supprimer l'avatar
        if (isset($_POST['delete']))
        {
                $query=$db-&gt;prepare('UPDATE forum_membres
		SET membre_avatar=0 WHERE membre_id = :id');
                $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
                $query-&gt;execute();
                $query-&gt;CloseCursor();
        }
 
        echo'&lt;h1&gt;Modification terminée&lt;/h1&gt;';
        echo'&lt;p&gt;Votre profil a été modifié avec succès !&lt;/p&gt;';
        echo'&lt;p&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; 
        pour revenir à la page d accueil&lt;/p&gt;';
 
        //On modifie la table
 
        $query=$db-&gt;prepare('UPDATE forum_membres
        SET  membre_mdp = :mdp, membre_email=:mail, membre_msn=:msn, membre_siteweb=:website,
        membre_signature=:sign, membre_localisation=:loc
        WHERE membre_id=:id');
        $query-&gt;bindValue(':mdp',$pass,PDO::PARAM_INT);
        $query-&gt;bindValue(':mail',$email,PDO::PARAM_STR);
        $query-&gt;bindValue(':msn',$msn,PDO::PARAM_STR);
        $query-&gt;bindValue(':website',$website,PDO::PARAM_STR);
        $query-&gt;bindValue(':sign',$signature,PDO::PARAM_STR);
        $query-&gt;bindValue(':loc',$localisation,PDO::PARAM_STR);
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();
    }
    else
    {
        echo'&lt;h1&gt;Modification interrompue&lt;/h1&gt;';
        echo'&lt;p&gt;Une ou plusieurs erreurs se sont produites pendant la modification du profil&lt;/p&gt;';
        echo'&lt;p&gt;'.$i.' erreur(s)&lt;/p&gt;';
        echo'&lt;p&gt;'.$mdp_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$email_erreur1.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$email_erreur2.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$msn_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$signature_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur1.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur2.'&lt;/p&gt;';
        echo'&lt;p&gt;'.$avatar_erreur3.'&lt;/p&gt;';
        echo'&lt;p&gt; Cliquez &lt;a href=&quot;./voirprofil.php?action=modifier&quot;&gt;ici&lt;/a&gt; pour recommencer&lt;/p&gt;';
    }
} //Fin du else
    break;
 
default; //Si jamais c'est aucun de ceux là c'est qu'il y a eu un problème :o
echo'&lt;p&gt;Cette action est impossible&lt;/p&gt;';
 
} //Fin du switch
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;/html&gt;</code></pre><p id="r-617267" data-claire-element-id="617267">Je mets tout le code d'un coup, car vous avez vu qu'il ressemble énormément à celui de register.php. Une fois que ceci est fait, vous pouvez modifier votre profil comme bon vous semble. :-°</p><p id="r-617268" data-claire-element-id="617268">Les pages de profils sont maintenant en place sur le forum. Tout ce qui concerne les membres est par la même occasion terminé, il ne reste plus qu'à s'intéresser aux messages :p .<br/> Juste un mot sur les profils : ce que je propose ici est comme d'habitude le plus basique possible. Si vous voulez afficher plus d'infos (âge, goûts, loisirs, etc.), ce qui peut être intéressant si votre forum est spécialisé, il vous faut ajouter des champs à votre table forum_membres. Puis, de la même manière, les afficher sur le profil.</p><p id="r-617269" data-claire-element-id="617269">Allez, encore un petit effort pour attaquer la suite. ;)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
<span class="arrow"></span>
<span class="next">Voir le profil</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">
<span class="next">Forums et Topics</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ForumsetTopics"></a><h2>Forums et Topics</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
<span class="arrow"></span>
<span class="next">Modifier le profil</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
<span class="next">Voir un forum</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617273" data-claire-element-id="617273">Dans ce chapitre, nous allons voir comment mettre en place les pages <em>voirforum</em> et <em>voirtopic</em>. Comme leur nom l'indique, elles vont permettre d'afficher le contenu d'un forum (donc, la liste des topics de ce forum) et celui d'un topic (donc, la liste des messages de ce topic).<br/> Cette étape est presque la dernière de la partie membre du forum : une fois ces pages réalisées, il ne restera plus qu'à s'intéresser à la manière de poster, puis c'est gagné ! ;)</p><p id="r-617274" data-claire-element-id="617274">Allez, on y va. ^^</p>
</div><a name="Voirunforum"></a><h2>Voir un forum</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">
<span class="arrow"></span>
<span class="next">Forums et Topics</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
<span class="next">Voir un topic</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617275" data-claire-element-id="617275">La page <strong>voirforum.php</strong> n'est pas très différente de notre page d'index. La seule différence, c'est qu'on va afficher la liste des <strong>topics</strong> au lieu de celle des <strong>forums</strong>. Mais finalement, les scripts restent assez similaires.</p><h3 id="r-ce-qu-on-va-faire-1" data-claire-element-id="617286">Ce qu'on va faire</h3><p id="r-617276" data-claire-element-id="617276"><em>Une requête dans la base de données pour retourner toutes les infos sur le forum en question</em><br/><em>Un tableau qui va afficher les 25 derniers topics.</em></p><p id="r-617277" data-claire-element-id="617277">Comme vous avez pu le remarquer, dans la page d'index, l'url d'un forum est de la forme : voirforum.php?f=2.<br/> On va donc récupérer la valeur de f qui correspond à l'id du forum qu'on va afficher.</p><p id="r-617278" data-claire-element-id="617278">Sans plus attendre, le début du code : :p</p><p id="r-617279" data-claire-element-id="617279"><strong>Page : voirforum.php</strong></p><pre id="r-617280" data-claire-element-id="617280"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Voir un forum&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);

//On récupère la valeur de f
$forum = (int) $_GET['f'];

//A partir d'ici, on va compter le nombre de messages
//pour n'afficher que les 25 premiers
$query=$db-&gt;prepare('SELECT forum_name, forum_topic, auth_view, auth_topic FROM forum_forum WHERE forum_id = :forum');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();

$totalDesMessages = $data['forum_topic'] + 1;
$nombreDeMessagesParPage = 25;
$nombreDePages = ceil($totalDesMessages / $nombreDeMessagesParPage);
?&gt;</code></pre><p id="r-617281" data-claire-element-id="617281">Voilà le début du code. On compte donc le nombre de messages afin de savoir combien de pages on va devoir créer. C'est exactement le même principe que dans le TP sur le Livre d'or (d'ailleurs, j'ai pris les mêmes noms de variables).</p><p id="r-617282" data-claire-element-id="617282">Je profite de cette requête pour récupérer les valeurs des champs auth_view et auth_topic : vous comprendrez plus tard pourquoi.</p><p id="r-617283" data-claire-element-id="617283">Maintenant, on va afficher le haut de la page, c'est-à-dire qu'on va écrire le nombre de pages et des informations sur le visiteur.</p><pre id="r-617284" data-claire-element-id="617284"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
&lt;a href=&quot;./voirforum.php?f='.$forum.'&quot;&gt;'.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/a&gt;';

//Nombre de pages


$page = (isset($_GET['page']))?intval($_GET['page']):1;

//On affiche les pages 1-2-3, etc.
echo '&lt;p&gt;Page : ';
for ($i = 1 ; $i &lt;= $nombreDePages ; $i++)
{
    if ($i == $page) //On ne met pas de lien sur la page actuelle
    {
    echo $i;
    }
    else
    {
    echo '
    &lt;a href=&quot;voirforum.php?f='.$forum.'&amp;amp;page='.$i.'&quot;&gt;'.$i.'&lt;/a&gt;';
    }
}
echo '&lt;/p&gt;';


$premierMessageAafficher = ($page - 1) * $nombreDeMessagesParPage;

//Le titre du forum
echo '&lt;h1&gt;'.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';


//Et le bouton pour poster
echo'&lt;a href=&quot;./poster.php?action=nouveautopic&amp;amp;f='.$forum.'&quot;&gt;
&lt;img src=&quot;./images/nouveau.gif&quot; alt=&quot;Nouveau topic&quot; title=&quot;Poster un nouveau topic&quot; /&gt;&lt;/a&gt;';
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-617285" data-claire-element-id="617285">Vous remarquez au passage que l'url du lien vers le profil prend maintenant un sens :) .</p><h3 id="r-le-tableau-1" data-claire-element-id="617296">Le tableau</h3><p id="r-617287" data-claire-element-id="617287">Une fois qu'on est arrivés là, on va devoir faire une requête de fou furieux pour prendre en une seule fois tout ce que l'on veut sur les forums.</p><p id="r-617288" data-claire-element-id="617288">Attention : on y va.</p><pre id="r-617289" data-claire-element-id="617289"><code data-claire-semantic="html+php">&lt;?php
//On prend tout ce qu'on a sur les Annonces du forum
       

$query=$db-&gt;prepare('SELECT forum_topic.topic_id, topic_titre, topic_createur, topic_vu, topic_post, topic_time, topic_last_post,
Mb.membre_pseudo AS membre_pseudo_createur, post_createur, post_time, Ma.membre_pseudo AS membre_pseudo_last_posteur, post_id FROM forum_topic 
LEFT JOIN forum_membres Mb ON Mb.membre_id = forum_topic.topic_createur
LEFT JOIN forum_post ON forum_topic.topic_last_post = forum_post.post_id
LEFT JOIN forum_membres Ma ON Ma.membre_id = forum_post.post_createur    
WHERE topic_genre = &quot;Annonce&quot; AND forum_topic.forum_id = :forum 
ORDER BY topic_last_post DESC');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
$query-&gt;execute();
?&gt;</code></pre><p id="r-617290" data-claire-element-id="617290">o_O</p><p id="r-617291" data-claire-element-id="617291">Bon bah, allons détailler : comme vous avez sûrement dû le remarquer, on fait une requête qui, grâce à des jointures, associe 4 tables. La première est forum_topic, ce qui est logique puisqu'on veut avant tout lister les différents topics du forum. On connaît l'id du membre qui a posté le premier message, et on associe alors la table forum_membres pour connaître son nom. Ensuite, on associe la table forum_post à forum_topic pour connaître tout ce que l'on veut sur le dernier message, et en l'occurrence, ce qui nous intéresse c'est <strong>qui</strong><em>qui l'a posté</em>. On repart donc sur la table forum_membres ^^ , et on sort le nom du bonhomme qui a posté ce message.</p><p id="r-617292" data-claire-element-id="617292">Si vous avez en tête la structure du tableau listant les sujets de chaque forum du Site du Zér0, ou de la plupart des autres forums, vous comprendrez facilement pourquoi il nous faut toutes ces infos.</p><div id="r-617294" data-claire-element-id="617294" data-claire-semantic="question"><p id="r-617293" data-claire-element-id="617293">Euh... c'est quoi, ça ? LEFT JOIN forum_membres <strong>Ma</strong> ON <strong>Ma</strong>.membre_id = forum_post.post_createur</p></div><p id="r-617295" data-claire-element-id="617295">C'est un alias, comme on utilise deux fois la table forum_membre, ça permet de différencier la première jointure de la seconde. La première, on la renomme Mb, et la seconde Ma ; ensuite, grâce au mot clé AS, on re-renomme les champs, pour ne plus les confondre dans l'echo qui va suivre.</p><h3 id="r-traitement-des-annonces" data-claire-element-id="617303">Traitement des annonces !</h3><p id="r-617297" data-claire-element-id="617297">En fait, on va faire deux tableaux : un pour les annonces et un pour les topics normaux (c'est la raison du Where topic_genre = &quot;Annonce&quot;). C'est la méthode la plus simple que j'ai trouvée pour avoir les annonces toujours en haut, et les sujets à la suite.</p><aside id="r-617299" data-claire-element-id="617299" data-claire-semantic="information"><p id="r-617298" data-claire-element-id="617298">Évidemment on peut toujours économiser une requête en ajoutant des conditions pour afficher la bonne image... On peut toujours arriver à supprimer une requête par-ci par là, cependant dans le tuto j'ai choisi de garder des méthodes simples, à vous de changer ça si vous voulez gagner un peu plus de performance.</p></aside><p id="r-617300" data-claire-element-id="617300">Revenons au code :</p><pre id="r-617301" data-claire-element-id="617301"><code data-claire-semantic="html+php">&lt;?php
//On lance notre tableau seulement s'il y a des requêtes !
if ($query-&gt;rowCount()&gt;0)
{
        ?&gt;
        &lt;table&gt;   
        &lt;tr&gt;
        &lt;th&gt;&lt;img src=&quot;./images/annonce.gif&quot; alt=&quot;Annonce&quot; /&gt;&lt;/th&gt;
        &lt;th class=&quot;titre&quot;&gt;&lt;strong&gt;Titre&lt;/strong&gt;&lt;/th&gt;             
        &lt;th class=&quot;nombremessages&quot;&gt;&lt;strong&gt;Réponses&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;nombrevu&quot;&gt;&lt;strong&gt;Vus&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;auteur&quot;&gt;&lt;strong&gt;Auteur&lt;/strong&gt;&lt;/th&gt;                       
        &lt;th class=&quot;derniermessage&quot;&gt;&lt;strong&gt;Dernier message&lt;/strong&gt;&lt;/th&gt;
        &lt;/tr&gt;   
       
        &lt;?php
        //On commence la boucle
        while ($data=$query-&gt;fetch())
        {
                //Pour chaque topic :
                //Si le topic est une annonce on l'affiche en haut
                //mega echo de bourrain pour tout remplir
               
                echo'&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;./images/annonce.gif&quot; alt=&quot;Annonce&quot; /&gt;&lt;/td&gt;

                &lt;td id=&quot;titre&quot;&gt;&lt;strong&gt;Annonce : &lt;/strong&gt;
                &lt;strong&gt;&lt;a href=&quot;./voirtopic.php?t='.$data['topic_id'].'&quot;                 
                title=&quot;Topic commencé à
                '.date('H\hi \l\e d M,y',$data['topic_time']).'&quot;&gt;
                '.stripslashes(htmlspecialchars($data['topic_titre'])).'&lt;/a&gt;&lt;/strong&gt;&lt;/td&gt;

                &lt;td class=&quot;nombremessages&quot;&gt;'.$data['topic_post'].'&lt;/td&gt;

                &lt;td class=&quot;nombrevu&quot;&gt;'.$data['topic_vu'].'&lt;/td&gt;

                &lt;td&gt;&lt;a href=&quot;./voirprofil.php?m='.$data['topic_createur'].'
                &amp;amp;action=consulter&quot;&gt;
                '.stripslashes(htmlspecialchars($data['membre_pseudo_createur'])).'&lt;/a&gt;&lt;/td&gt;';

               	//Selection dernier message
		$nombreDeMessagesParPage = 15;
		$nbr_post = $data['topic_post'] +1;
		$page = ceil($nbr_post / $nombreDeMessagesParPage);

                echo '&lt;td class=&quot;derniermessage&quot;&gt;Par
                &lt;a href=&quot;./voirprofil.php?m='.$data['post_createur'].'
                &amp;amp;action=consulter&quot;&gt;
                '.stripslashes(htmlspecialchars($data['membre_pseudo_last_posteur'])).'&lt;/a&gt;&lt;br /&gt;
                A &lt;a href=&quot;./voirtopic.php?t='.$data['topic_id'].'&amp;amp;page='.$page.'#p_'.$data['post_id'].'&quot;&gt;'.date('H\hi \l\e d M y',$data['post_time']).'&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;';
        }
        ?&gt;
        &lt;/table&gt;
        &lt;?php
}
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-617302" data-claire-element-id="617302">Voilà : on arrive au bout de la première boucle. Il n'y a pas grand-chose de compliqué à comprendre : on fait un tableau qu'on remplit avec le contenu de la requête. :-° Remarquez qu'on n'affiche pas un tableau vide... Enfin on pourrait, mais c'est très moche. Du coup, je vérifie avant que la requête renvoie bien au moins 1 donnée.</p><h3 id="r-sans-plus-attendre-les-topics" data-claire-element-id="617307">Sans plus attendre, les topics !</h3><p id="r-617304" data-claire-element-id="617304">Ici encore, on va faire une requête de tarés et mettre son contenu dans un tableau. Toutefois, il faut encore vérifier que le forum contient au moins 1 topic. C'est comme pour la page d'index, il est possible que ce soit la première fois que vous mettiez les pieds sur cette page ; si ça se produit, on affiche un message et non pas le tableau.</p><pre id="r-617305" data-claire-element-id="617305"><code data-claire-semantic="html+php">&lt;?php
//On prend tout ce qu'on a sur les topics normaux du forum


$query=$db-&gt;prepare('SELECT forum_topic.topic_id, topic_titre, topic_createur, topic_vu, topic_post, topic_time, topic_last_post,
Mb.membre_pseudo AS membre_pseudo_createur, post_id, post_createur, post_time, Ma.membre_pseudo AS membre_pseudo_last_posteur FROM forum_topic
LEFT JOIN forum_membres Mb ON Mb.membre_id = forum_topic.topic_createur
LEFT JOIN forum_post ON forum_topic.topic_last_post = forum_post.post_id
LEFT JOIN forum_membres Ma ON Ma.membre_id = forum_post.post_createur   
WHERE topic_genre &lt;&gt; &quot;Annonce&quot; AND forum_topic.forum_id = :forum
ORDER BY topic_last_post DESC
LIMIT :premier ,:nombre');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
$query-&gt;bindValue(':premier',(int) $premierMessageAafficher,PDO::PARAM_INT);
$query-&gt;bindValue(':nombre',(int) $nombreDeMessagesParPage,PDO::PARAM_INT);
$query-&gt;execute();

if ($query-&gt;rowCount()&gt;0)
{
?&gt;
        &lt;table&gt;
        &lt;tr&gt;
        &lt;th&gt;&lt;img src=&quot;./images/message.gif&quot; alt=&quot;Message&quot; /&gt;&lt;/th&gt;
        &lt;th class=&quot;titre&quot;&gt;&lt;strong&gt;Titre&lt;/strong&gt;&lt;/th&gt;             
        &lt;th class=&quot;nombremessages&quot;&gt;&lt;strong&gt;Réponses&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;nombrevu&quot;&gt;&lt;strong&gt;Vus&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;auteur&quot;&gt;&lt;strong&gt;Auteur&lt;/strong&gt;&lt;/th&gt;                       
        &lt;th class=&quot;derniermessage&quot;&gt;&lt;strong&gt;Dernier message  &lt;/strong&gt;&lt;/th&gt;
        &lt;/tr&gt;
        &lt;?php
        //On lance la boucle
       
        while ($data = $query-&gt;fetch())
        {
                //Ah bah tiens... re vla l'echo de fou
                echo'&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;./images/message.gif&quot; alt=&quot;Message&quot; /&gt;&lt;/td&gt;

                &lt;td class=&quot;titre&quot;&gt;
                &lt;strong&gt;&lt;a href=&quot;./voirtopic.php?t='.$data['topic_id'].'&quot;                 
                title=&quot;Topic commencé à
                '.date('H\hi \l\e d M,y',$data['topic_time']).'&quot;&gt;
                '.stripslashes(htmlspecialchars($data['topic_titre'])).'&lt;/a&gt;&lt;/strong&gt;&lt;/td&gt;

                &lt;td class=&quot;nombremessages&quot;&gt;'.$data['topic_post'].'&lt;/td&gt;

                &lt;td class=&quot;nombrevu&quot;&gt;'.$data['topic_vu'].'&lt;/td&gt;

                &lt;td&gt;&lt;a href=&quot;./voirprofil.php?m='.$data['topic_createur'].'
                &amp;amp;action=consulter&quot;&gt;
                '.stripslashes(htmlspecialchars($data['membre_pseudo_createur'])).'&lt;/a&gt;&lt;/td&gt;';

               	//Selection dernier message
		$nombreDeMessagesParPage = 15;
		$nbr_post = $data['topic_post'] +1;
		$page = ceil($nbr_post / $nombreDeMessagesParPage);

                echo '&lt;td class=&quot;derniermessage&quot;&gt;Par
                &lt;a href=&quot;./voirprofil.php?m='.$data['post_createur'].'
                &amp;amp;action=consulter&quot;&gt;
                '.stripslashes(htmlspecialchars($data['membre_pseudo_last_posteur'])).'&lt;/a&gt;&lt;br /&gt;
                A &lt;a href=&quot;./voirtopic.php?t='.$data['topic_id'].'&amp;amp;page='.$page.'#p_'.$data['post_id'].'&quot;&gt;'.date('H\hi \l\e d M y',$data['post_time']).'&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;';

        }
        ?&gt;
        &lt;/table&gt;
        &lt;?php
}
else //S'il n'y a pas de message
{
        echo'&lt;p&gt;Ce forum ne contient aucun sujet actuellement&lt;/p&gt;';
}
$query-&gt;CloseCursor();</code></pre><p id="r-617306" data-claire-element-id="617306">On est arrivés en bas de notre page : voyons plus en détail ce code. La requête que l'on fait est très voisine de celle que l'on a utilisée pour lister les annonces, sauf qu'on limite le nombre de retours à un certain nombre. Ensuite, on remplit le nouveau tableau, et comme on liste d'abord les annonces, elles resteront toujours en haut ! Pour sélectionner les topics &quot;normaux&quot;, il faut prendre ceux qui ne sont pas des annonces ; le signe <strong>&lt;&gt;</strong> signifie &quot;différent de&quot;.</p><h3 id="r-on-termine" data-claire-element-id="617311">On termine</h3><p id="r-617308" data-claire-element-id="617308">Elle est pas belle, la vie ? Vous avez maintenant une page qui liste les topics de chaque forum. Enfin je dis avez... il reste encore à terminer en fermant les balises.</p><pre id="r-617309" data-claire-element-id="617309"><code data-claire-semantic="html+php">?&gt;
&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;</code></pre><p id="r-617310" data-claire-element-id="617310">Et voilà. ^^</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">
<span class="arrow"></span>
<span class="next">Forums et Topics</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
<span class="next">Voir un topic</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Voiruntopic"></a><h2>Voir un topic</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
<span class="arrow"></span>
<span class="next">Voir un forum</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">
<span class="next">Poster</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617313" data-claire-element-id="617313">La page <strong>voirtopic.php</strong> se construit comme le script de news présenté dans le TP. A savoir qu'on va afficher chaque message du plus ancien au plus récent, la seule différence, c'est qu'à la gauche de ces messages, on montrera l'avatar du membre qui a posté.</p><h2 id="r-le-css-2" data-claire-element-id="617317">Le css</h2><p id="r-617314" data-claire-element-id="617314">Tout ceci nécessite un petit tour par <strong>notre fichier CSS</strong>. Voici comment j'ai fait, libre à vous de modifier chaque ligne pour les adapter à votre design.</p><pre id="r-617315" data-claire-element-id="617315"><code data-claire-semantic="css">.vt_auteur
{
width:20%;
background-color : rgb(244,238,250);
}
.vt_mess
{
width:75%;
background-color : rgb(244,238,250);
}</code></pre><p id="r-617316" data-claire-element-id="617316">On va donc faire un tableau à deux colonnes, la première affichera les infos sur le membre qui a posté (son avatar, son nom, etc.), et la seconde son message ^^ .</p><h2 id="r-on-passe-au-php" data-claire-element-id="617341">On passe au php</h2><p id="r-617318" data-claire-element-id="617318">Comme pour la page voirforum.php, on doit d'abord compter le nombre de messages pour compter le nombre de pages nécessaires, afin d'en afficher que 15 par page.</p><p id="r-617319" data-claire-element-id="617319"><strong>Page : voirtopic.php</strong></p><pre id="r-617320" data-claire-element-id="617320"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Voir un sujet&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
include(&quot;includes/bbcode.php&quot;); //On verra plus tard ce qu'est ce fichier
 
//On récupère la valeur de t
$topic = (int) $_GET['t'];
 
//A partir d'ici, on va compter le nombre de messages pour n'afficher que les 15 premiers
$query=$db-&gt;prepare('SELECT topic_titre, topic_post, forum_topic.forum_id, topic_last_post,
forum_name, auth_view, auth_topic, auth_post 
FROM forum_topic 
LEFT JOIN forum_forum ON forum_topic.forum_id = forum_forum.forum_id 
WHERE topic_id = :topic');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();
$forum=$data['forum_id']; 
$totalDesMessages = $data['topic_post'] + 1;
$nombreDeMessagesParPage = 15;
$nombreDePages = ceil($totalDesMessages / $nombreDeMessagesParPage);
?&gt;</code></pre><p id="r-617321" data-claire-element-id="617321">Vous remarquez que le code est exactement pareil, sauf qu'on récupère t la place de f. Par ailleurs, puisqu'il nous faut aussi des infos sur le forum auquel appartient le sujet, il faut faire une jointure.</p><div id="r-617323" data-claire-element-id="617323" data-claire-semantic="question"><p id="r-617322" data-claire-element-id="617322">Et si j'ai envie d'afficher 10 messages ? Je dois changer le script ?</p></div><p id="r-617324" data-claire-element-id="617324">En fait, le script qu'on est en train de réaliser est temporaire ; dans la seconde partie de ce tuto consacrée à la partie administration, on aura à le modifier légèrement. Ainsi, vous pourrez changer le nombre de messages par page facilement. :)</p><p id="r-617325" data-claire-element-id="617325">Maintenant qu'on a le haut de notre page, on va afficher le titre et l'éternel fil d'Ariane.</p><pre id="r-617326" data-claire-element-id="617326"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
&lt;a href=&quot;./voirforum.php?f='.$forum.'&quot;&gt;'.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/a&gt;
 --&gt; &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;'.stripslashes(htmlspecialchars($data['topic_titre'])).'&lt;/a&gt;';
echo '&lt;h1&gt;'.stripslashes(htmlspecialchars($data['topic_titre'])).'&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';
?&gt;</code></pre><p id="r-617327" data-claire-element-id="617327">Enfin, on compte le nombre de pages, et on commence notre boucle pour afficher tous les messages. Vous allez voir que finalement ce script est l'un des plus simples.</p><pre id="r-617328" data-claire-element-id="617328"><code data-claire-semantic="html+php">&lt;?php
//Nombre de pages
$page = (isset($_GET['page']))?intval($_GET['page']):1;

//On affiche les pages 1-2-3 etc...
echo '&lt;p&gt;Page : ';
for ($i = 1 ; $i &lt;= $nombreDePages ; $i++)
{
    if ($i == $page) //On affiche pas la page actuelle en lien
    {
    echo $i;
    }
    else
    {
    echo '&lt;a href=&quot;voirtopic.php?t='.$topic.'&amp;page='.$i.'&quot;&gt;
    ' . $i . '&lt;/a&gt; ';
    }
}
echo'&lt;/p&gt;';
 
$premierMessageAafficher = ($page - 1) * $nombreDeMessagesParPage;

 
//On affiche l'image répondre
echo'&lt;a href=&quot;./poster.php?action=repondre&amp;amp;t='.$topic.'&quot;&gt;
&lt;img src=&quot;./images/repondre.gif&quot; alt=&quot;Répondre&quot; title=&quot;Répondre à ce topic&quot; /&gt;&lt;/a&gt;';
 
//On affiche l'image nouveau topic
echo'&lt;a href=&quot;./poster.php?action=nouveautopic&amp;amp;f='.$data['forum_id'].'&quot;&gt;
&lt;img src=&quot;./images/nouveau.gif&quot; alt=&quot;Nouveau topic&quot; title=&quot;Poster un nouveau topic&quot; /&gt;&lt;/a&gt;';
$query-&gt;CloseCursor(); 
//Enfin on commence la boucle !
?&gt;</code></pre><p id="r-617329" data-claire-element-id="617329">Je m'arrête une minute avant d'afficher la requête (je vous rassure, elle n'est pas trop longue ^^ ). En fait, vous devriez être capables de la faire tout seuls comme des grands pendant que je pars siroter un café si vous avez bien compris les jointures. On doit prendre, à partir de l'id du créateur de chaque post, toutes les infos possibles sur ce membre.</p><p id="r-617330" data-claire-element-id="617330">Voilà comment faire :</p><pre id="r-617331" data-claire-element-id="617331"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT post_id , post_createur , post_texte , post_time ,
membre_id, membre_pseudo, membre_inscrit, membre_avatar, membre_localisation, membre_post, membre_signature
FROM forum_post
LEFT JOIN forum_membres ON forum_membres.membre_id = forum_post.post_createur
WHERE topic_id =:topic
ORDER BY post_id
LIMIT :premier, :nombre');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;bindValue(':premier',(int) $premierMessageAafficher,PDO::PARAM_INT);
$query-&gt;bindValue(':nombre',(int) $nombreDeMessagesParPage,PDO::PARAM_INT);
$query-&gt;execute();
 
//On vérifie que la requête a bien retourné des messages
if ($query-&gt;rowCount()&lt;1)
{
        echo'&lt;p&gt;Il n y a aucun post sur ce topic, vérifiez l url et reessayez&lt;/p&gt;';
}
else
{
        //Si tout roule on affiche notre tableau puis on remplit avec une boucle
        ?&gt;&lt;table&gt;
        &lt;tr&gt;
        &lt;th class=&quot;vt_auteur&quot;&gt;&lt;strong&gt;Auteurs&lt;/strong&gt;&lt;/th&gt;             
        &lt;th class=&quot;vt_mess&quot;&gt;&lt;strong&gt;Messages&lt;/strong&gt;&lt;/th&gt;       
        &lt;/tr&gt;
        &lt;?php
        while ($data = $query-&gt;fetch())
        {</code></pre><p id="r-617332" data-claire-element-id="617332">Vous avez vu qu'une fois encore je vérifie si la requête retourne au moins un message. En général, ça sera le cas puisque lors de la création d'un topic, on y adjoint un premier post. Mais comment on ne sait jamais, il vaut mieux vérifier ^^ .<br/> Sinon, on lance notre beau tableau, et on va voir de suite quoi mettre dedans.</p><pre id="r-617333" data-claire-element-id="617333"><code data-claire-semantic="html+php">&lt;?php
//On commence à afficher le pseudo du créateur du message :
         //On vérifie les droits du membre
         //(partie du code commentée plus tard)
         echo'&lt;tr&gt;&lt;td&gt;&lt;strong&gt;
         &lt;a href=&quot;./voirprofil.php?m='.$data['membre_id'].'&amp;amp;action=consulter&quot;&gt;
         '.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/strong&gt;&lt;/td&gt;';
           
         /* Si on est l'auteur du message, on affiche des liens pour
         Modérer celui-ci.
         Les modérateurs pourront aussi le faire, il faudra donc revenir sur
         ce code un peu plus tard ! */     
   
         if ($id == $data['post_createur'])
         {
         echo'&lt;td id=p_'.$data['post_id'].'&gt;Posté à '.date('H\hi \l\e d M y',$data['post_time']).'
         &lt;a href=&quot;./poster.php?p='.$data['post_id'].'&amp;amp;action=delete&quot;&gt;
         &lt;img src=&quot;./images/supprimer.gif&quot; alt=&quot;Supprimer&quot;
         title=&quot;Supprimer ce message&quot; /&gt;&lt;/a&gt;   
         &lt;a href=&quot;./poster.php?p='.$data['post_id'].'&amp;amp;action=edit&quot;&gt;
         &lt;img src=&quot;./images/editer.gif&quot; alt=&quot;Editer&quot;
         title=&quot;Editer ce message&quot; /&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;';
         }
         else
         {
         echo'&lt;td&gt;
         Posté à '.date('H\hi \l\e d M y',$data['post_time']).'
         &lt;/td&gt;&lt;/tr&gt;';
         }
       
         //Détails sur le membre qui a posté
         echo'&lt;tr&gt;&lt;td&gt;
         &lt;img src=&quot;./images/avatars/'.$data['membre_avatar'].'&quot; alt=&quot;&quot; /&gt;
         &lt;br /&gt;Membre inscrit le '.date('d/m/Y',$data['membre_inscrit']).'
         &lt;br /&gt;Messages : '.$data['membre_post'].'&lt;br /&gt;
         Localisation : '.stripslashes(htmlspecialchars($data['membre_localisation'])).'&lt;/td&gt;';
               
         //Message
         echo'&lt;td&gt;'.code(nl2br(stripslashes(htmlspecialchars($data['post_texte'])))).'
         &lt;br /&gt;&lt;hr /&gt;'.code(nl2br(stripslashes(htmlspecialchars($data['membre_signature'])))).'&lt;/td&gt;&lt;/tr&gt;';
         } //Fin de la boucle ! \o/
         $query-&gt;CloseCursor();

         ?&gt;
&lt;/table&gt;</code></pre><div id="r-617335" data-claire-element-id="617335" data-claire-semantic="question"><p id="r-617334" data-claire-element-id="617334">C'est quoi, la fonction code ?</p></div><p id="r-617336" data-claire-element-id="617336">C'est une fonction que l'on va se dépêcher de créer dans le prochain chapitre du cours. Dans un forum, on donne la possibilité de mettre en forme son texte (gras, italique, souligné...). Mais on ne peut pas laisser le membre utiliser les balises html, car ça serait trop dangereux ; c'est pourquoi on utilise des balises qu'on convertit ensuite en html grâce à la fonction code. Pensez par exemple au Zcode ^^ .<br/> Bon, bah on a terminé notre boucle, on a fermé notre tableau, il reste à terminer la page :</p><pre id="r-617337" data-claire-element-id="617337"><code data-claire-semantic="html+php">&lt;?php
        echo '&lt;p&gt;Page : ';
        for ($i = 1 ; $i &lt;= $nombreDePages ; $i++)
        {
                if ($i == $page) //On affiche pas la page actuelle en lien
                {
                echo $i;
                }
                else
                {
                echo '&lt;a href=&quot;voirtopic.php?t='.$topic.'&amp;amp;page='.$i.'&quot;&gt;
                ' . $i . '&lt;/a&gt; ';
                }
        }
        echo'&lt;/p&gt;';
       
        //On ajoute 1 au nombre de visites de ce topic
        $query=$db-&gt;prepare('UPDATE forum_topic
        SET topic_vu = topic_vu + 1 WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();

} //Fin du if qui vérifiait si le topic contenait au moins un message
?&gt;           
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617338" data-claire-element-id="617338">Héhé... on a terminé :soleil: . C'était peut-être un peu long, mais à présent, les posts sont listés, tout comme les topics ! <br/> C'est maintenant à vous de voir comment vous voulez organiser votre page : dans l'exemple, j'ai fait apparaitre pour chaque message le pseudo du membre, son avatar, le nombre de messages qu'il a postés et sa localisation. Mais personne ne vous interdit de mettre autre chose :) .</p><p id="r-617339" data-claire-element-id="617339">Voilà : on est arrivés au bout. Ces deux scripts sont assez longs, et j'avoue que j'ai pas mal hésité à les placer dans le même chapitre. Mais si vous lisez ces lignes, c'est que vous y êtes arrivés :p .</p><p id="r-617340" data-claire-element-id="617340">Prochain chapitre : comment poster un message. Allez, on y va. ;)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
<span class="arrow"></span>
<span class="next">Voir un forum</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">
<span class="next">Poster</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Poster"></a><h2>Poster</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
<span class="arrow"></span>
<span class="next">Voir un topic</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
<span class="next">Page de formulaire</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617344" data-claire-element-id="617344">Si vous avez suivi tous les chapitres jusqu'ici, vous avez dû vous rendre compte que, pour l'instant, le forum n'est qu'une coquille vide, dans la mesure où on ne peut pas poster de message. Après la lecture de cette page, ça va être chose faite. On va en effet s'occuper de la page poster.php, qui constitue par ailleurs la dernière de cette partie.</p><aside id="r-617346" data-claire-element-id="617346" data-claire-semantic="information"><p id="r-617345" data-claire-element-id="617345">Le script de cette page ne sera pas final. On va en fait simplement voir ici comment poster un message. Plus tard, on s'occupera de savoir comment les modérateurs pourront supprimer ou éditer des messages. :o</p></aside>
</div><a name="Pagedeformulaire"></a><h2>Page de formulaire</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">
<span class="arrow"></span>
<span class="next">Poster</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
<span class="next">Le bbcode</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617347" data-claire-element-id="617347">Comme tous les formulaires qu'on a vus jusqu'ici, il va falloir créer un script en 2 parties : une proposant de poster un message, et une autre pour le traiter, et afficher un message d'erreur. Ici exceptionnellement nous allons séparer les deux parties sur deux pages différentes. La raison est que les codes sont assez lourds et que c'est beaucoup plus clair comme ça.</p><p id="r-617348" data-claire-element-id="617348">On va, dans un premier temps, voir la page de formulaire : <strong>poster.php</strong>.</p><p id="r-617349" data-claire-element-id="617349">Il faut bien définir deux cas bien distincts dans le script de la page poster.php : on peut vouloir poster un nouveau <strong>message </strong>ou un nouveau <strong>topic</strong>. Dans le premier cas, il s'agit simplement de répondre à un sujet déjà commencé. Dans le second, il faut définir un titre en plus du message.</p><p id="r-617350" data-claire-element-id="617350">Quoi qu'il en soit, le visiteur souhaitant poster son message est souvent amené à vouloir mettre en forme son texte, pour le mettre en gras, par exemple. Le problème est qu'il est hors de question d'afficher un message contenant des balises html, c'est pourquoi les forums utilisent un code spécial. Dans le cas du Site du Zér0, il s'agit du zCode, dans le cas de phpbb il s'agit du bbcode, etc.</p><h2 id="r-creons-notre-bbcode" data-claire-element-id="617393">Créons notre BBcode !</h2><p id="r-617351" data-claire-element-id="617351">La page <strong>poster.php</strong> est très spéciale et n'a rien à voir avec les autres, la raison est simple : on doit utiliser du javascript pour les balises de codes. Vous savez, les boutons sur lesquels on clique pour afficher un texte en gras, en italique, etc.</p><p id="r-617352" data-claire-element-id="617352">On va devoir en fabriquer nous-mêmes. :D Pour cela, j'ai recopié un code qui provient d'un ancien tuto, maintenant disparu du SDZ, pour ceux que ça intéresse, je vous envoie vers le tuto suivant : <a href="http://www.siteduzero.com/tutoriel-3-34703-insertion-de-balises-dans-une-zone-de-texte.html">Insertion de balises dans une zone texte</a>, qui est différent mais qui propose le même résultat.</p><p id="r-617353" data-claire-element-id="617353">On va donc afficher un code très bizarre entre les balises &lt;head&gt; et &lt;/head&gt;.</p><p id="r-617354" data-claire-element-id="617354">Le voici :</p><pre id="r-617355" data-claire-element-id="617355"><code data-claire-semantic="javascript">&lt;script&gt;
function bbcode(bbdebut, bbfin)
{
var input = window.document.formulaire.message;
input.focus();
if(typeof document.selection != 'undefined')
{
var range = document.selection.createRange();
var insText = range.text;
range.text = bbdebut + insText + bbfin;
range = document.selection.createRange();
if (insText.length == 0)
{
range.move('character', -bbfin.length);
}
else
{
range.moveStart('character', bbdebut.length + insText.length + bbfin.length);
}
range.select();
}
else if(typeof input.selectionStart != 'undefined')
{
var start = input.selectionStart;
var end = input.selectionEnd;
var insText = input.value.substring(start, end);
input.value = input.value.substr(0, start) + bbdebut + insText + bbfin + input.value.substr(end);
var pos;
if (insText.length == 0)
{
pos = start + bbdebut.length;
}
else
{
pos = start + bbdebut.length + insText.length + bbfin.length;
}
input.selectionStart = pos;
input.selectionEnd = pos;
}
 
else
{
var pos;
var re = new RegExp('^[0-9]{0,3}$');
while(!re.test(pos))
{
pos = prompt(&quot;insertion (0..&quot; + input.value.length + &quot;):&quot;, &quot;0&quot;);
}
if(pos &gt; input.value.length)
{
pos = input.value.length;
}
var insText = prompt(&quot;Veuillez taper le texte&quot;);
input.value = input.value.substr(0, pos) + bbdebut + insText + bbfin + input.value.substr(pos);
}
}
function smilies(img)
{
window.document.formulaire.message.value += '' + img + '';
}
&lt;/script&gt;</code></pre><aside id="r-617357" data-claire-element-id="617357" data-claire-semantic="information"><p id="r-617356" data-claire-element-id="617356">Si vous ne comprenez strictement rien à ce code, sachez que c'est un simple copié-collé de celui du tuto que je vous ai demandé de regarder. Il utilise des infos sur le navigateur que vous utilisez, tout simplement.</p></aside><p id="r-617358" data-claire-element-id="617358">De toute façon, sa compréhension n'est pas utile pour la suite.</p><aside id="r-617360" data-claire-element-id="617360" data-claire-semantic="warning"><p id="r-617359" data-claire-element-id="617359">Attention toutefois à ces lignes :<br/> var input = window.document.formulaire.message;<br/> window.document.formulaire.message.value += '' + img + '';<br/> Comme expliqué dans le tuto, il faut que vous mettiez le nom du formulaire et du <em>textarea</em> ; donc, si vous les modifiez, pensez à changer ces parties du code.</p></aside><div id="r-617362" data-claire-element-id="617362" data-claire-semantic="question"><p id="r-617361" data-claire-element-id="617361">Mais attends une seconde, la balise &lt;head&gt; se trouve dans la page <strong>debut.php</strong>, je fais comment, moi, pour l'inclure o_O ?</p></div><p id="r-617363" data-claire-element-id="617363">C'est juste : en fait, deux choix s'offrent à vous : la méthode bourrin et la méthode douce.<br/> La première consiste à ne pas inclure le fichier <strong>debut.php</strong> dans cette page, et à simplement recopier son contenu, en ajoutant le code ci-dessus entre les balises &lt;head&gt;. Ce qui est gênant, c'est que si vous modifiez votre fichier debut.php, il faudra aussi passer ici.</p><p id="r-617364" data-claire-element-id="617364">La deuxième est de créer une variable $balises à true juste avant l'appel du fichier debut.php ; ensuite, dans cette dernière page, on vérifie que $balises= true, et si c'est le cas, on insère le javascript.</p><p id="r-617365" data-claire-element-id="617365">Faites simplement ceci :</p><p id="r-617366" data-claire-element-id="617366"><strong>Page : debut.php</strong></p><pre id="r-617367" data-claire-element-id="617367"><code data-claire-semantic="html+php">&lt;?php
$balises=(isset($balises))?$balises:0;
if($balises)
{
//Inclure le script
}</code></pre><p id="r-617368" data-claire-element-id="617368">Le début de la page ressemble alors à ça :</p><p id="r-617369" data-claire-element-id="617369"><strong>Page : poster.php</strong></p><pre id="r-617370" data-claire-element-id="617370"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Poster&quot;;
$balises = true;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
?&gt;</code></pre><p id="r-617371" data-claire-element-id="617371">Bien, on va pouvoir attaquer la suite : il va falloir récupérer quelques données.</p><pre id="r-617372" data-claire-element-id="617372"><code data-claire-semantic="html+php">&lt;?php
//Qu'est ce qu'on veut faire ? poster, répondre ou éditer ?
$action = (isset($_GET['action']))?htmlspecialchars($_GET['action']):'';

//Il faut être connecté pour poster !
if ($id==0) erreur(ERR_IS_CO);

//Si on veut poster un nouveau topic, la variable f se trouve dans l'url,
//On récupère certaines valeurs
if (isset($_GET['f']))
{
    $forum = (int) $_GET['f'];
    $query= $db-&gt;prepare('SELECT forum_name, auth_view, auth_post, auth_topic, auth_annonce, auth_modo
    FROM forum_forum WHERE forum_id =:forum');
    $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();
    echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
    &lt;a href=&quot;./voirforum.php?f='.$data['forum_id'].'&quot;&gt;'.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/a&gt;
    --&gt; Nouveau topic&lt;/p&gt;';

 
}
 
//Sinon c'est un nouveau message, on a la variable t et
//On récupère f grâce à une requête
elseif (isset($_GET['t']))
{
    $topic = (int) $_GET['t'];
    $query=$db-&gt;prepare('SELECT topic_titre, forum_topic.forum_id,
    forum_name, auth_view, auth_post, auth_topic, auth_annonce, auth_modo
    FROM forum_topic
    LEFT JOIN forum_forum ON forum_forum.forum_id = forum_topic.forum_id
    WHERE topic_id =:topic');
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();
    $forum = $data['forum_id'];  

    echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
    &lt;a href=&quot;./voirforum.php?f='.$data['forum_id'].'&quot;&gt;'.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/a&gt;
    --&gt; &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;'.stripslashes(htmlspecialchars($data['topic_titre'])).'&lt;/a&gt;
    --&gt; Répondre&lt;/p&gt;';
}
 
//Enfin sinon c'est au sujet de la modération(on verra plus tard en détail)
//On ne connait que le post, il faut chercher le reste
elseif (isset ($_GET['p']))
{
    $post = (int) $_GET['p'];
    $query=$db-&gt;prepare('SELECT post_createur, forum_post.topic_id, topic_titre, forum_topic.forum_id,
    forum_name, auth_view, auth_post, auth_topic, auth_annonce, auth_modo
    FROM forum_post
    LEFT JOIN forum_topic ON forum_topic.topic_id = forum_post.topic_id
    LEFT JOIN forum_forum ON forum_forum.forum_id = forum_topic.forum_id
    WHERE forum_post.post_id =:post');
    $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();

    $topic = $data['topic_id'];
    $forum = $data['forum_id'];
 
    echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
    &lt;a href=&quot;./voirforum.php?f='.$data['forum_id'].'&quot;&gt;'.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/a&gt;
    --&gt; &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;'.stripslashes(htmlspecialchars($data['topic_titre'])).'&lt;/a&gt;
    --&gt; Modérer un message&lt;/p&gt;';
}
$query-&gt;CloseCursor();  
?&gt;</code></pre><p id="r-617373" data-claire-element-id="617373">Ce début de code joue sur la forme de l'url ; comme vous avez pu le voir sur les autres pages, il est du style : <br/>poster.php?t=1&amp;action=repondre<br/> ou<br/>poster.php?f=2&amp;action=nouveau<br/> ou encore<br/>poster.php?p=3&amp;action=edit</p><p id="r-617374" data-claire-element-id="617374">Dans tous les cas, on a besoin de la valeur de f : si jamais on souhaite créer un nouveau topic, elle est dans l'url, donc il n'y a pas de problème. Sinon, ce n'est pas beaucoup plus grave, il suffit de faire une requête pour la récupérer.</p><h3 id="r-le-switch-1" data-claire-element-id="617387">Le switch !</h3><p id="r-617375" data-claire-element-id="617375">Comme pour la page de profil, notre code va s'articuler autour d'un switch de la variable $action.</p><pre id="r-617376" data-claire-element-id="617376"><code data-claire-semantic="html+php">&lt;?php
switch($action)
{
case &quot;repondre&quot;: //Premier cas : on souhaite répondre
//Ici, on affiche le formulaire de réponse
break;
 
case &quot;nouveautopic&quot;: //Deuxième cas : on souhaite créer un nouveau topic
//Ici, on affiche le formulaire de nouveau topic
break;
 
//D'autres cas viendront s'ajouter là plus tard :p
 
default: //Si jamais c'est aucun de ceux-là, c'est qu'il y a eu un problème :o
echo'&lt;h2&gt;Cette action est impossible&lt;/h2&gt;';
 
} //Fin du switch
?&gt;</code></pre><p id="r-617377" data-claire-element-id="617377">Voilà le squelette du code. Si vous avez compris jusqu'ici, je n'ai même pas besoin de continuer normalement (quoi, feignasse ? :D ).</p><p id="r-617378" data-claire-element-id="617378">Donc, ce que l'on va mettre entre les case et les break, ce sont des zones de textes. Il en faut une pour le titre (seulement dans le cas d'un nouveau topic), et une pour le message lui-même. Seulement il faut aussi mettre les balises de texte et les smilies : c'est pourquoi le code du formulaire est un peu plus long que d'habitude. Cela dit, si vous avez lu le tuto sur le bbcode, vous n'aurez pas de problème de compréhension ^^ .</p><p id="r-617379" data-claire-element-id="617379"><strong>Page : poster.php</strong></p><pre id="r-617380" data-claire-element-id="617380"><code data-claire-semantic="html+php">&lt;?php
switch($action)
{
case &quot;repondre&quot;: //Premier cas on souhaite répondre
?&gt;
&lt;h1&gt;Poster une réponse&lt;/h1&gt;
 
&lt;form method=&quot;post&quot; action=&quot;postok.php?action=repondre&amp;amp;t=&lt;?php echo $topic ?&gt;&quot; name=&quot;formulaire&quot;&gt;
 
&lt;fieldset&gt;&lt;legend&gt;Mise en forme&lt;/legend&gt;
&lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;italic&quot; name=&quot;italic&quot; value=&quot;Italic&quot; onClick=&quot;javascript:bbcode('[i]', '[/i]');return(false)&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;souligné&quot; name=&quot;souligné&quot; value=&quot;Souligné&quot; onClick=&quot;javascript:bbcode('[s]', '[/s]');return(false)&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;lien&quot; name=&quot;lien&quot; value=&quot;Lien&quot; onClick=&quot;javascript:bbcode('[url]', '[/url]');return(false)&quot; /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;img src=&quot;./images/smileys/heureux.gif&quot; title=&quot;heureux&quot; alt=&quot;heureux&quot; onClick=&quot;javascript:smilies(' :D ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/lol.gif&quot; title=&quot;lol&quot; alt=&quot;lol&quot; onClick=&quot;javascript:smilies(' :lol: ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; onClick=&quot;javascript:smilies(' :triste: ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/cool.gif&quot; title=&quot;cool&quot; alt=&quot;cool&quot; onClick=&quot;javascript:smilies(' :frime: ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/rire.gif&quot; title=&quot;rire&quot; alt=&quot;rire&quot; onClick=&quot;javascript:smilies(' XD ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/confus.gif&quot; title=&quot;confus&quot; alt=&quot;confus&quot; onClick=&quot;javascript:smilies(' :s ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/choc.gif&quot; title=&quot;choc&quot; alt=&quot;choc&quot; onClick=&quot;javascript:smilies(' :o ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/question.gif&quot; title=&quot;?&quot; alt=&quot;?&quot; onClick=&quot;javascript:smilies(' :interrogation: ');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/exclamation.gif&quot; title=&quot;!&quot; alt=&quot;!&quot; onClick=&quot;javascript:smilies(' :exclamation: ');return(false)&quot; /&gt;
&lt;/fieldset&gt;
 
&lt;fieldset&gt;&lt;legend&gt;Message&lt;/legend&gt;&lt;textarea cols=&quot;80&quot; rows=&quot;8&quot; id=&quot;message&quot; name=&quot;message&quot;&gt;&lt;/textarea&gt;&lt;/fieldset&gt;
 
&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
&lt;input type=&quot;reset&quot; name = &quot;Effacer&quot; value = &quot;Effacer&quot;/&gt;
&lt;/p&gt;&lt;/form&gt;
&lt;?php
break;
 
case &quot;nouveautopic&quot;:
?&gt;
 
&lt;h1&gt;Nouveau topic&lt;/h1&gt;
&lt;form method=&quot;post&quot; action=&quot;postok.php?action=nouveautopic&amp;amp;f=&lt;?php echo $forum ?&gt;&quot; name=&quot;formulaire&quot;&gt;
 
&lt;fieldset&gt;&lt;legend&gt;Titre&lt;/legend&gt;
&lt;input type=&quot;text&quot; size=&quot;80&quot; id=&quot;titre&quot; name=&quot;titre&quot; /&gt;&lt;/fieldset&gt;
 
&lt;fieldset&gt;&lt;legend&gt;Mise en forme&lt;/legend&gt;
&lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;italic&quot; name=&quot;italic&quot; value=&quot;Italic&quot; onClick=&quot;javascript:bbcode('[i]', '[/i]');return(false)&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;souligné&quot; name=&quot;souligné&quot; value=&quot;Souligné&quot; onClick=&quot;javascript:bbcode('[s]', '[/s]');return(false)&quot; /&gt;
&lt;input type=&quot;button&quot; id=&quot;lien&quot; name=&quot;lien&quot; value=&quot;Lien&quot; onClick=&quot;javascript:bbcode('[url]', '[/url]');return(false)&quot; /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;img src=&quot;./images/smileys/heureux.gif&quot; title=&quot;heureux&quot; alt=&quot;heureux&quot; onClick=&quot;javascript:smilies(':D');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/lol.gif&quot; title=&quot;lol&quot; alt=&quot;lol&quot; onClick=&quot;javascript:smilies(':lol:');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; onClick=&quot;javascript:smilies(':triste:');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/cool.gif&quot; title=&quot;cool&quot; alt=&quot;cool&quot; onClick=&quot;javascript:smilies(':frime:');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/rire.gif&quot; title=&quot;rire&quot; alt=&quot;rire&quot; onClick=&quot;javascript:smilies('XD');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/confus.gif&quot; title=&quot;confus&quot; alt=&quot;confus&quot; onClick=&quot;javascript:smilies(':s');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/choc.gif&quot; title=&quot;choc&quot; alt=&quot;choc&quot; onClick=&quot;javascript:smilies(':O');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/question.gif&quot; title=&quot;?&quot; alt=&quot;?&quot; onClick=&quot;javascript:smilies(':interrogation:');return(false)&quot; /&gt;
&lt;img src=&quot;./images/smileys/exclamation.gif&quot; title=&quot;!&quot; alt=&quot;!&quot; onClick=&quot;javascript:smilies(':exclamation:');return(false)&quot; /&gt;&lt;/fieldset&gt;
 
&lt;fieldset&gt;&lt;legend&gt;Message&lt;/legend&gt;
&lt;textarea cols=&quot;80&quot; rows=&quot;8&quot; id=&quot;message&quot; name=&quot;message&quot;&gt;&lt;/textarea&gt;
&lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;mess&quot; value=&quot;Annonce&quot; /&gt;Annonce&lt;/label&gt;
&lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;mess&quot; value=&quot;Message&quot; checked=&quot;checked&quot; /&gt;Topic&lt;/label&gt;
&lt;/fieldset&gt;
&lt;p&gt;
&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
&lt;input type=&quot;reset&quot; name = &quot;Effacer&quot; value = &quot;Effacer&quot; /&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;?php
break;
 
//D'autres cas viendront s'ajouter ici par la suite
?&gt;</code></pre><p id="r-617381" data-claire-element-id="617381">Costaud, hein ? :p Remarquez, ça valait le coup puisqu'on a terminé notre page. Je vous l'ai dit, les autres cas, l'édition et la suppression d'un message, seront vus dans une seconde partie du tuto.</p><p id="r-617382" data-claire-element-id="617382">Mais revenons plutôt au code. Mises à part les zones de texte, il reste des lignes de ce genre :</p><pre id="r-617383" data-claire-element-id="617383"><code data-claire-semantic="html">&lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;</code></pre><p id="r-617384" data-claire-element-id="617384">Ou de ce genre :</p><pre id="r-617385" data-claire-element-id="617385"><code data-claire-semantic="html">&lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; onClick=&quot;javascript:smilies(':triste:');return(false)&quot; /&gt;</code></pre><p id="r-617386" data-claire-element-id="617386">C'est ici que vous allez pouvoir laisser libre cours à votre imagination la plus folle pour créer votre &quot;bbcode&quot; (et même changer son nom ;) ). Ce que je vous ai mis, ce sont les balises utilisées par phpbb : <strong>[g]Texte en gras[/g]</strong>, <strong>[i]Texte en italique[/i]</strong>, et les smilies sont également pris sur la plate-forme. Mais après, vous faites comme vous voulez ((i) et (/i) par exemple :p ), et pour cela, il suffit de modifier les lignes que je vous ai indiquées en changeant le [i] par (i), etc.</p><h3 id="r-allez-on-termine" data-claire-element-id="617392">Allez, on termine !</h3><p id="r-617388" data-claire-element-id="617388">Il ne nous reste plus qu'à fermer notre switch, nos balises html et tout le reste.</p><pre id="r-617389" data-claire-element-id="617389"><code data-claire-semantic="html+php">&lt;?php
default: //Si jamais c'est aucun de ceux là c'est qu'il y a eu un problème :o
echo'&lt;p&gt;Cette action est impossible&lt;/p&gt;';
} //Fin du switch
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617390" data-claire-element-id="617390">C'est ici que se termine la page poster.php. Comme promis, on va passer au traitement des données : si vous avez bien lu le code, vous avez vu que la page en question a pour petit nom postok.php (oui, je sais, j'ai un goût pourri pour trouver les noms de pages :-° ).</p><p id="r-617391" data-claire-element-id="617391">Mais avant de repartir au combat, on va faire une petite pause pour compléter la création de notre bbcode... :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">
<span class="arrow"></span>
<span class="next">Poster</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
<span class="next">Le bbcode</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lebbcode"></a><h2>Le bbcode</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
<span class="arrow"></span>
<span class="next">Page de formulaire</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
<span class="next">Traiter le message</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617395" data-claire-element-id="617395">Comme je vous l'avais promis au début, dans l'introduction de ce tuto, la création d'un forum touche vraiment à tous les points du php, étudiés dans les cours officiels du Site du Zér0.<br/> Et comme je tiens mes promesses :) , on va utiliser ici la création de fonctions de modification d'un texte, choses qu'on n'avait pas encore touchées. Plus précisément, on va créer <strong>la</strong> fonction qui permettra de traduire le texte écrit en bbcode (ou en zcode, ou en ce que vous voulez d'ailleurs :p ), de façon à obtenir le rendu que l'on souhaite sur le forum. Et comme une bonne nouvelle n'arrive jamais seule, on va du coup devoir utiliser les regex (youpi !) :p .</p><p id="r-617396" data-claire-element-id="617396">Avant toute chose, on trouve un nom à cette fonction : personnellement je l'ai appelé code : il faut aussi lui donner un paramètre, le texte à transformer. On a donc ceci :</p><pre id="r-617397" data-claire-element-id="617397"><code data-claire-semantic="html+php">&lt;?php
function code($texte)
{</code></pre><p id="r-617398" data-claire-element-id="617398">Ensuite, on fait passer notre variable $texte dans une série de preg_replace, avant de la retourner transformée.</p><pre id="r-617399" data-claire-element-id="617399"><code data-claire-semantic="html+php">&lt;?php
function code($texte)
{
//Smileys
$texte = str_replace(':D ', '&lt;img src=&quot;./images/smileys/heureux.gif&quot; title=&quot;heureux&quot; alt=&quot;heureux&quot; /&gt;', $texte);
$texte = str_replace(':lol: ', '&lt;img src=&quot;./images/smileys/lol.gif&quot; title=&quot;lol&quot; alt=&quot;lol&quot; /&gt;', $texte);
$texte = str_replace(':triste:', '&lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; /&gt;', $texte);
$texte = str_replace(':frime:', '&lt;img src=&quot;./images/smileys/cool.gif&quot; title=&quot;cool&quot; alt=&quot;cool&quot; /&gt;', $texte);
$texte = str_replace(':rire:', '&lt;img src=&quot;./images/smileys/rire.gif&quot; title=&quot;rire&quot; alt=&quot;rire&quot; /&gt;', $texte);
$texte = str_replace(':s', '&lt;img src=&quot;./images/smileys/confus.gif&quot; title=&quot;confus&quot; alt=&quot;confus&quot; /&gt;', $texte);
$texte = str_replace(':O', '&lt;img src=&quot;./images/smileys/choc.gif&quot; title=&quot;choc&quot; alt=&quot;choc&quot; /&gt;', $texte);
$texte = str_replace(':question:', '&lt;img src=&quot;./images/smileys/question.gif&quot; title=&quot;?&quot; alt=&quot;?&quot; /&gt;', $texte);
$texte = str_replace(':exclamation:', '&lt;img src=&quot;./images/smileys/exclamation.gif&quot; title=&quot;!&quot; alt=&quot;!&quot; /&gt;', $texte);

//Mise en forme du texte
//gras
$texte = preg_replace('`\[g\](.+)\[/g\]`isU', '&lt;strong&gt;$1&lt;/strong&gt;', $texte); 
//italique
$texte = preg_replace('`\[i\](.+)\[/i\]`isU', '&lt;em&gt;$1&lt;/em&gt;', $texte);
//souligné
$texte = preg_replace('`\[s\](.+)\[/s\]`isU', '&lt;u&gt;$1&lt;/u&gt;', $texte);
//lien
$texte = preg_replace('#http://[a-z0-9._/-]+#i', '&lt;a href=&quot;$0&quot;&gt;$0&lt;/a&gt;', $texte);
//etc., etc.

//On retourne la variable texte
return $texte;
}
?&gt;</code></pre><aside id="r-617401" data-claire-element-id="617401" data-claire-semantic="information"><p id="r-617400" data-claire-element-id="617400">Ce que je vous ai donné ici n'est qu'un échantillon, libre à vous de rajouter des balises de mises en forme (barré, citation...).</p></aside><p id="r-617402" data-claire-element-id="617402">Pour mieux comprendre ce code, il faut reprendre les lignes de code bizarroïdes de la page poster.php. Vous vous souvenez ? Ce type de balises :</p><pre id="r-617403" data-claire-element-id="617403"><code data-claire-semantic="html">&lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;</code></pre><p id="r-617404" data-claire-element-id="617404">Ce sont [g] et [/g] qui délimitent le texte à mettre en gras ; grâce à notre fonction, on remplace [g] et [/g], qui est du simple texte pour l'ordinateur, par &lt;strong&gt; et &lt;/strong&gt;.</p><h3 id="r-un-mot-sur-le-quote" data-claire-element-id="617425">Un mot sur le quote</h3><p id="r-617405" data-claire-element-id="617405">Un grand absent de cette fonction est la balise [quote]. Présente sur quasiment tous les forum, elle permet de faire référence au message de quelqu'un d'autre.</p><p id="r-617406" data-claire-element-id="617406"><cite>Citation : Tadzoa</cite></p><blockquote id="r-617408" data-claire-element-id="617408"><p id="r-617407" data-claire-element-id="617407">Ceci est un quote !</p></blockquote><p id="r-617409" data-claire-element-id="617409">La raison de son absence est qu'elle diffère légèrement des autres, et j'ai donc souhaité la traiter à part.<br/> Pour réaliser cette balise, il vous faut ouvrir le fichier css du forum, et ajouter le code suivant :</p><pre id="r-617410" data-claire-element-id="617410"><code data-claire-semantic="css">#quote
{
width: 100%;
background-color : rgb(220,220,220);
margin-top: 2px;
margin-bottom: 2px;
font-family: &quot;Comic sans MS&quot;, Arial, Verdana, serif;
}</code></pre><p id="r-617411" data-claire-element-id="617411">Encore une fois, ceci n'est qu'indicatif, vous pouvez modifier n'importe laquelle de ces lignes selon ce que vous voulez faire.<br/> Une fois enregistré, rajouter cette ligne dans la fonction :</p><pre id="r-617412" data-claire-element-id="617412"><code data-claire-semantic="html+php">$texte = preg_replace('`\[quote\](.+)\[/quote\]`isU', '&lt;div id=&quot;quote&quot;&gt;$1&lt;/div&gt;', $texte);</code></pre><p id="r-617413" data-claire-element-id="617413">Si vous voulez un bon entraînement, vous pouvez faire en sorte de rajouter le nom de l'auteur dans la citation.</p><p id="r-617414" data-claire-element-id="617414"></p><div id="r-617417" data-claire-element-id="617417"><div id="r-617416" data-claire-element-id="617416"><p id="r-617415" data-claire-element-id="617415">'`\[quote auteur=([a-z0-9A-Z._-]+) \](.+)\[/quote\]`isU', '&lt;div id=&quot;quote&quot;&gt;Auteur : $1 &lt;/ br&gt; $2 &lt;/div&gt;</p></div></div><p id="r-617418" data-claire-element-id="617418">Et le tour est joué :D .</p><div id="r-617420" data-claire-element-id="617420" data-claire-semantic="question"><p id="r-617419" data-claire-element-id="617419">Euh... je la mets où, cette fonction ?</p></div><p id="r-617421" data-claire-element-id="617421">C'est encore une fois à vous de voir : personnellement, je vous conseille de créer un fichier functions_txt.php que vous placerez dans le dossier includes. L'avantage, c'est que vous pourrez plus facilement réutiliser cette fonction sur plusieurs pages de votre site (script de news pour votre site, livre d'or, etc.).<br/> Je préfère séparer les fonctions textes des autres parce qu'elles sont un peu particulières, cela dit vous faites ce que vous voulez.</p><aside id="r-617423" data-claire-element-id="617423" data-claire-semantic="information"><p id="r-617422" data-claire-element-id="617422">Vous avez pu voir dans la page précédente que je l'ai mise dans un fichier appelé <strong>bbcode.php</strong>.</p></aside><p id="r-617424" data-claire-element-id="617424">On en a fini avec notre bbcode, et la fin approche ;) , on va maintenant parler de la page de traitement du message.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
<span class="arrow"></span>
<span class="next">Page de formulaire</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
<span class="next">Traiter le message</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Traiterlemessage"></a><h2>Traiter le message</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
<span class="arrow"></span>
<span class="next">Le bbcode</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">
<span class="next">Messages privés</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617427" data-claire-element-id="617427">Le code de cette page, que j'ai appelée <strong>postok.php</strong>, s'articule autour d'un switch sur la valeur de la variable $action (exactement comme la page poster.php, en fait).<br/> Si on souhaite créer un nouveau topic, il faudra remplir les champs de la table forum_topic en plus de ceux de forum_post, puis mettre à jour les champs membre_post, forum_post et forum_topic. En effet, on a besoin d'entrer des infos à la fois sur le sujet en général mais également sur le message qui va être posté, et qui va constituer le premier du topic.<br/> Si par contre on souhaite simplement répondre, on n'a pas ce problème puisqu'il s'agira simplement d'entrer les données dans la table forum_post, et de mettre à jour les 2 autres.</p><h3 id="r-le-debut" data-claire-element-id="617432">Le début</h3><p id="r-617428" data-claire-element-id="617428">Le code du début est identique aux autres, encore une fois :</p><p id="r-617429" data-claire-element-id="617429"><strong>Page : postok.php</strong></p><pre id="r-617430" data-claire-element-id="617430"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Poster&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
//On récupère la valeur de la variable action
$action = (isset($_GET['action']))?htmlspecialchars($_GET['action']):'';

// Si le membre n'est pas connecté, il est arrivé ici par erreur
if ($id==0) erreur(ERR_IS_CO);
?&gt;</code></pre><p id="r-617431" data-claire-element-id="617431">Vous pouvez remarquer qu'ici, contrairement à la page poster.php, on ne cherche pas à récupérer tout de suite la valeur de $forum ou de $topic. La raison est qu'on ne sait toujours pas si on veut créer un nouveau sujet ou répondre ; on prendra donc la valeur de ces variables dans le switch.</p><h3 id="r-le-switch-2" data-claire-element-id="617447">Le switch !</h3><p id="r-617433" data-claire-element-id="617433">Le switch est le même que celui de la page poster.php, et il ne sera donc pas terminé. Logique, puisqu'il faut aussi tester les valeurs de $action pour éditer ou supprimer.</p><pre id="r-617434" data-claire-element-id="617434"><code data-claire-semantic="html+php">&lt;?php
switch($action)
{
    //Premier cas : nouveau topic
    case &quot;nouveautopic&quot;:
    //On passe le message dans une série de fonction
    $message = $_POST['message'];
    $mess = $_POST['mess'];

    //Pareil pour le titre
    $titre = $_POST['titre'];

    //ici seulement, maintenant qu'on est sur qu'elle existe, on récupère la valeur de la variable f
    $forum = (int) $_GET['f'];
    $temps = time();

    if (empty($message) || empty($titre))
    {
        echo'&lt;p&gt;Votre message ou votre titre est vide, 
        cliquez &lt;a href=&quot;./poster.php?action=nouveautopic&amp;amp;f='.$forum.'&quot;&gt;ici&lt;/a&gt; pour recommencer&lt;/p&gt;';
    }
    else //Si jamais le message n'est pas vide
    {</code></pre><p id="r-617435" data-claire-element-id="617435">Le cas du nouveau topic ne s'arrête pas ici, mais je fais une pause pour éclaircir ce bout de code. Le formulaire de la page précédente a envoyé une variable qui contient le message.</p><div id="r-617437" data-claire-element-id="617437" data-claire-semantic="question"><p id="r-617436" data-claire-element-id="617436">Pourquoi on n'utilise pas la fonction code sur cette page ?</p></div><p id="r-617438" data-claire-element-id="617438">Parce que sinon, au moment de l'édition, il sera impossible de récupérer le message avec les balises bbcode. Et du coup, ça sera quasiment impossible de le modifier, sauf si vous créez une fonction inverse qui remplacerait le html par du bbcode, mais là, ça tient du masochisme ^^ .</p><p id="r-617439" data-claire-element-id="617439">Pour la suite du code, je dois vous présenter une méthode de PDO <strong>lastInsertId</strong> (d'ailleurs on l'avait déjà utilisé discrètement dans la page register.php).<br/> Elle permet de récupérer l'id de la dernière requête. Je m'explique : en même temps qu'on envoie à la base de données des infos sur le nouveau topic créé, on en envoie aussi sur le premier message de ce topic.<br/> Jusqu'ici tout va bien, sauf que si vous regardez en détail les champs de ces deux tables, vous voyez qu'on a topic_last_post et post_topic.</p><div id="r-617441" data-claire-element-id="617441" data-claire-semantic="question"><p id="r-617440" data-claire-element-id="617440">Mais alors, comment connaitre les valeurs à entrer dans ces deux champs, puisque les id sont en <em>auto-increment</em> ?</p></div><p id="r-617442" data-claire-element-id="617442">Bah, la fonction permet de retourner ces id ; donc, ce qu'on va faire, c'est qu'on va d'abord faire la requête avec le topic, et on laissera les champs topic_last_post et topic_first_post à 0. Ensuite, on va envoyer le post dont on connaîtra la valeur de post_topic grâce à la fonction. Et enfin, on <em>update</em> le topic.</p><pre id="r-617443" data-claire-element-id="617443"><code data-claire-semantic="html+php">&lt;?php
        //On entre le topic dans la base de donnée en laissant
        //le champ topic_last_post à 0
        $query=$db-&gt;prepare('INSERT INTO forum_topic
        (forum_id, topic_titre, topic_createur, topic_vu, topic_time, topic_genre)
        VALUES(:forum, :titre, :id, 1, :temps, :mess)');
        $query-&gt;bindValue(':forum', $forum, PDO::PARAM_INT);
        $query-&gt;bindValue(':titre', $titre, PDO::PARAM_STR);
        $query-&gt;bindValue(':id', $id, PDO::PARAM_INT);
        $query-&gt;bindValue(':temps', $temps, PDO::PARAM_INT);
        $query-&gt;bindValue(':mess', $mess, PDO::PARAM_STR);
        $query-&gt;execute();


        $nouveautopic = $db-&gt;lastInsertId(); //Notre fameuse fonction !
        $query-&gt;CloseCursor(); 

        //Puis on entre le message
        $query=$db-&gt;prepare('INSERT INTO forum_post
        (post_createur, post_texte, post_time, topic_id, post_forum_id)
        VALUES (:id, :mess, :temps, :nouveautopic, :forum)');
        $query-&gt;bindValue(':id', $id, PDO::PARAM_INT);
        $query-&gt;bindValue(':mess', $message, PDO::PARAM_STR);
        $query-&gt;bindValue(':temps', $temps,PDO::PARAM_INT);
        $query-&gt;bindValue(':nouveautopic', (int) $nouveautopic, PDO::PARAM_INT);
        $query-&gt;bindValue(':forum', $forum, PDO::PARAM_INT);
        $query-&gt;execute();


        $nouveaupost = $db-&gt;lastInsertId(); //Encore notre fameuse fonction !
        $query-&gt;CloseCursor(); 


        //Ici on update comme prévu la valeur de topic_last_post et de topic_first_post
        $query=$db-&gt;prepare('UPDATE forum_topic
        SET topic_last_post = :nouveaupost,
        topic_first_post = :nouveaupost
        WHERE topic_id = :nouveautopic');
        $query-&gt;bindValue(':nouveaupost', (int) $nouveaupost, PDO::PARAM_INT);    
        $query-&gt;bindValue(':nouveautopic', (int) $nouveautopic, PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();

        //Enfin on met à jour les tables forum_forum et forum_membres
        $query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post + 1 ,forum_topic = forum_topic + 1, 
        forum_last_post_id = :nouveaupost
        WHERE forum_id = :forum');
        $query-&gt;bindValue(':nouveaupost', (int) $nouveaupost, PDO::PARAM_INT);    
        $query-&gt;bindValue(':forum', (int) $forum, PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();
    
        $query=$db-&gt;prepare('UPDATE forum_membres SET membre_post = membre_post + 1 WHERE membre_id = :id');
        $query-&gt;bindValue(':id', $id, PDO::PARAM_INT);    
        $query-&gt;execute();
        $query-&gt;CloseCursor();

        //Et un petit message
        echo'&lt;p&gt;Votre message a bien été ajouté!&lt;br /&gt;&lt;br /&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;br /&gt;
        Cliquez &lt;a href=&quot;./voirtopic.php?t='.$nouveautopic.'&quot;&gt;ici&lt;/a&gt; pour le voir&lt;/p&gt;';
    }
    break; //Houra !
?&gt;</code></pre><p id="r-617444" data-claire-element-id="617444">Vous remarquez que la méthodelastInsertId ne prend aucun paramètre : il suffit juste de la placer en dessous de la requête qu'on veut étudier.</p><aside id="r-617446" data-claire-element-id="617446" data-claire-semantic="information"><p id="r-617445" data-claire-element-id="617445">Une autre méthode consisterait à enlever les <em>auto-increment</em> de vos tables, et à tout gérer vous-mêmes ; à ce moment-là, plus besoin de la fonction mysql_insert_id. :)</p></aside><h3 id="r-suite-du-switch" data-claire-element-id="617451">Suite du switch</h3><p id="r-617448" data-claire-element-id="617448">La seconde partie du switch va être beaucoup plus facile, puisque c'est la même que celle que l'on vient de réaliser, mais en plus simple, car on n'aura pas à remplir les champs de la table forum_topic.</p><pre id="r-617449" data-claire-element-id="617449"><code data-claire-semantic="html+php">&lt;?php
    //Deuxième cas : répondre
    case &quot;repondre&quot;:
    $message = $_POST['message'];

    //ici seulement, maintenant qu'on est sur qu'elle existe, on récupère la valeur de la variable t
    $topic = (int) $_GET['t'];
    $temps = time();

    if (empty($message))
    {
        echo'&lt;p&gt;Votre message est vide, cliquez &lt;a href=&quot;./poster.php?action=repondre&amp;amp;t='.$topic.'&quot;&gt;ici&lt;/a&gt; pour recommencer&lt;/p&gt;';
    }
    else //Sinon, si le message n'est pas vide
    {

        //On récupère l'id du forum
        $query=$db-&gt;prepare('SELECT forum_id, topic_post FROM forum_topic WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic', $topic, PDO::PARAM_INT);    
        $query-&gt;execute();
        $data=$query-&gt;fetch();
        $forum = $data['forum_id'];

        //Puis on entre le message
        $query=$db-&gt;prepare('INSERT INTO forum_post
        (post_createur, post_texte, post_time, topic_id, post_forum_id)
        VALUES(:id,:mess,:temps,:topic,:forum)');
        $query-&gt;bindValue(':id', $id, PDO::PARAM_INT);   
        $query-&gt;bindValue(':mess', $message, PDO::PARAM_STR);  
        $query-&gt;bindValue(':temps', $temps, PDO::PARAM_INT);  
        $query-&gt;bindValue(':topic', $topic, PDO::PARAM_INT);   
        $query-&gt;bindValue(':forum', $forum, PDO::PARAM_INT); 
        $query-&gt;execute();

        $nouveaupost = $db-&gt;lastInsertId();
        $query-&gt;CloseCursor(); 

        //On change un peu la table forum_topic
        $query=$db-&gt;prepare('UPDATE forum_topic SET topic_post = topic_post + 1, topic_last_post = :nouveaupost WHERE topic_id =:topic');
        $query-&gt;bindValue(':nouveaupost', (int) $nouveaupost, PDO::PARAM_INT);   
        $query-&gt;bindValue(':topic', (int) $topic, PDO::PARAM_INT); 
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 

        //Puis même combat sur les 2 autres tables
        $query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post + 1 , forum_last_post_id = :nouveaupost WHERE forum_id = :forum');
        $query-&gt;bindValue(':nouveaupost', (int) $nouveaupost, PDO::PARAM_INT);   
        $query-&gt;bindValue(':forum', (int) $forum, PDO::PARAM_INT); 
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 

        $query=$db-&gt;prepare('UPDATE forum_membres SET membre_post = membre_post + 1 WHERE membre_id = :id');
        $query-&gt;bindValue(':id', $id, PDO::PARAM_INT); 
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 

        //Et un petit message
        $nombreDeMessagesParPage = 15;
        $nbr_post = $data['topic_post']+1;
        $page = ceil($nbr_post / $nombreDeMessagesParPage);
        echo'&lt;p&gt;Votre message a bien été ajouté!&lt;br /&gt;&lt;br /&gt;
        Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;br /&gt;
        Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&amp;amp;page='.$page.'#p_'.$nouveaupost.'&quot;&gt;ici&lt;/a&gt; pour le voir&lt;/p&gt;';
    }//Fin du else
    break;
?&gt;</code></pre><p id="r-617450" data-claire-element-id="617450">Ce code est, à quelques détails près, le même que celui de la première partie du switch. La seule différence notable est qu'on doit lancer une requête pour récupérer l'id du forum, celui dans lequel se trouve le topic sur lequel on veut ajouter une réponse.</p><h3 id="r-la-fin-du-code" data-claire-element-id="617456">La fin du code</h3><p id="r-617452" data-claire-element-id="617452">Je le rappelle une fois de plus, le code n'est pas terminé puisqu'on y reviendra au moment de créer les pages d'administration.<br/> En attendant, je laisse un blanc, et on achève le script en fermant le switch, puis les balises.</p><pre id="r-617453" data-claire-element-id="617453"><code data-claire-semantic="html+php">&lt;?php
    default;
    echo'&lt;p&gt;Cette action est impossible&lt;/p&gt;';
} //Fin du Switch
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617454" data-claire-element-id="617454">Bon, bah que dire ? Vous avez terminé la page :D . Vous pouvez déjà tester en postant des messages : normalement ça se passera bien. :-°</p><p id="r-617455" data-claire-element-id="617455">Nous y voilà, la partie basique de votre forum est terminée. Vous pouvez presque le lancer dès maintenant puisque l'on peut s'y inscrire, poster, répondre, lire...<br/> Dans la suite du tutoriel, on va s'occuper d'ajouter des systèmes pour améliorer un peu tout ça. <br/> Et pour commencer, on va s'attaquer aux messages privés ! :pirate:</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
<span class="arrow"></span>
<span class="next">Le bbcode</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">
<span class="next">Messages privés</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Messagesprivs"></a><h2>Messages privés</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
<span class="arrow"></span>
<span class="next">Traiter le message</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
<span class="next">Structure de la page</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617459" data-claire-element-id="617459">On va voir dans ce chapitre comment ajouter un système plus que pratique sur votre forum : il s'agit de la messagerie privée. En quoi ça consiste ? Simplement à pouvoir envoyer les messages que seule une personne pourra lire (d'où le nom, en fait :-° ).</p><p id="r-617460" data-claire-element-id="617460">Ça peut paraître un peu compliqué au premier abord, mais en fait, ce sont exactement les mêmes méthodes que celles qu'on a utilisées précédemment, à quelques différences près.</p><aside id="r-617462" data-claire-element-id="617462" data-claire-semantic="warning"><p id="r-617461" data-claire-element-id="617461">Le code de cette page est long, parce qu'il n'y a qu'une seule page pour tout le système. Vous êtes prévenus. :diable:</p></aside>
</div><a name="Structuredelapage"></a><h2>Structure de la page</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">
<span class="arrow"></span>
<span class="next">Messages privés</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
<span class="next">Lire un message</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617463" data-claire-element-id="617463">Avant de commencer le code php proprement dit, il faut s'arrêter 5 minutes pour étudier un peu la question.<br/> Voici donc ce que le système de messagerie privée (je dirai mp par la suite, je ne vous fais pas l'affront de vous dire pourquoi ;) ) permettra de faire, une fois terminé.</p><p id="r-617464" data-claire-element-id="617464">- Envoyer un message privé (on dit aussi un mp)<br/> - Répondre à un mp reçu<br/> - Afficher tous les mp reçus<br/> - Supprimer un mp reçu<br/> - Et enfin, lire un mp reçu.</p><p id="r-617465" data-claire-element-id="617465">Ce sont les fonctions principales ; vous pouvez également rajouter une boîte d'envoi, qui liste les messages déjà envoyés (vous verrez, ce n'est qu'une petite modification dans le code) ; mais sinon, tout y est.</p><h2 id="r-la-base-de-donnees-4" data-claire-element-id="617469">La base de données</h2><p id="r-617466" data-claire-element-id="617466">Vous vous souvenez ? Au début de ce tutoriel, j'avais parlé d'une table forum_mp en laissant planer le suspense quant à son contenu...<br/> Après une longue attente, voici le verdict :</p><pre id="r-617467" data-claire-element-id="617467"><code data-claire-semantic="sql">CREATE TABLE `forum_mp` (
  mp_id int(11) NOT NULL AUTO_INCREMENT,
  mp_expediteur int(11) NOT NULL,
  mp_receveur int(11) NOT NULL,
  mp_titre varchar(100) collate latin1_general_ci NOT NULL,
  mp_text text collate latin1_general_ci NOT NULL,
  mp_time int(11) NOT NULL,
  mp_lu enum('0','1') collate latin1_general_ci NOT NULL,
  PRIMARY KEY  (`mp_id`)
)</code></pre><p id="r-617468" data-claire-element-id="617468">Le rôle de chaque champ est assez simple à assimiler avec son nom : mp_id correspond à l'id du mp, on a ensuite les id respectives de l'expéditeur et du destinataire.<br/> Enfin, des infos sur le message lui-même, telles que le titre, le texte et la date.<br/> Quant à mp_lu, il prend la valeur 1 si le message a déjà été lu, et 0 si ce n'est pas le cas. Pourquoi ? Parce que l'image qu'on va afficher sera différente selon ces deux cas.</p><h2 id="r-la-page-php" data-claire-element-id="617481">La page php</h2><p id="r-617470" data-claire-element-id="617470">Bon, on va pouvoir passer aux choses sérieuses. Comme je l'ai dit en introduction, on ne va réaliser qu'une seule page pour tout le système de Mp. Mais comme on peut faire plusieurs choses sur cette page (lire, poster, etc.), il va falloir se référer à une variable passée par url, puis utiliser un switch.<br/> Plus concrètement, regardez la structure :</p><pre id="r-617471" data-claire-element-id="617471"><code data-claire-semantic="html+php">&lt;?php
$action = (isset($_GET['action']))?htmlspecialchars($_GET['action']):''; //On récupère la valeur de la variable $action
 
switch($action)
{
case &quot;consulter&quot;: //1er cas : on veut lire un mp
//Ici on a besoin de la valeur de l'id du mp que l'on veut lire
break;
 
case &quot;nouveau&quot;: //2eme cas : on veut poster un nouveau mp
//Ici on a besoin de la valeur d'aucune variable :p
break;
 
case &quot;repondre&quot;: //3eme cas : on veut répondre à un mp reçu
//Ici on a besoin de la valeur de l'id du membre qui nous a posté un mp
break;
 
case &quot;supprimer&quot;: //4eme cas : on veut supprimer un mp reçu
//Ici on a besoin de la valeur de l'id du mp à supprimer
break;
 
default; //Si rien n'est demandé ou s'il y a une erreur dans l'url, on affiche la boite de mp.
 
} //fin du switch
?&gt;</code></pre><p id="r-617472" data-claire-element-id="617472">Vous comprenez maintenant pourquoi le code de la page va être assez lourd. <br/> Mais au fait, on n'a pas donné le nom à cette page ! Si vous avez regardé les codes précédents, vous avez pu apercevoir que ma créativité en ce qui concerne les noms de page n'est plus à prouver :-° , voici donc le résultat : <strong>messagesprives.php</strong>.</p><h3 id="r-debut-de-la-page" data-claire-element-id="617480">Début de la page</h3><p id="r-617473" data-claire-element-id="617473">Vous pouvez deviner facilement pourquoi, dans cette page, on va avoir besoin de poster des messages. C'est donc le grand retour du bbcode et donc de la variable $balises.</p><p id="r-617474" data-claire-element-id="617474"><strong>Page : messagesprives.php</strong></p><pre id="r-617475" data-claire-element-id="617475"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Messages Privés&quot;;
$balises = true;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/bbcode.php&quot;);
include(&quot;includes/menu.php&quot;);

$action = (isset($_GET['action']))?htmlspecialchars($_GET['action']):'';

?&gt;</code></pre><p id="r-617476" data-claire-element-id="617476">Je vous renvoie à la page poster.php si vous ne comprenez pas ce bout de code.<br/> Il permet de faire fonctionner le bbcode et ainsi, lorsque les membres de votre forum voudront poster un mp, ils pourront le mettre en forme, comme un message normal, finalement.</p><p id="r-617477" data-claire-element-id="617477">Pour la suite, on a simplement récupéré la valeur de la variable $action, il reste maintenant à lancer le switch.</p><pre id="r-617478" data-claire-element-id="617478"><code data-claire-semantic="html+php">&lt;?php
switch($action) //On switch sur $action
{
?&gt;</code></pre><p id="r-617479" data-claire-element-id="617479">Voilà : vous êtes prêts à continuer, maintenant !</p><h2 id="r-le-design-3" data-claire-element-id="617486">Le design</h2><p id="r-617482" data-claire-element-id="617482">Une dernière chose avant de s'attaquer au contenu propre de chaque partie de la page : un petit tour par le fichier css. Comme d'habitude, il n'est pas nécessaire de faire ceci, mais ça permet au tableau qui listera les mp de ressembler à quelque chose au moins ^^ .</p><pre id="r-617483" data-claire-element-id="617483"><code data-claire-semantic="css">.mp_titre { width:65%; }
.mp_expediteur { width:10%; }
.mp_time { width:20%; }</code></pre><p id="r-617484" data-claire-element-id="617484">Il vous faudra aussi deux images : l'une pour le mp non lu, et l'autre pour le mp déjà lu.</p><p id="r-617485" data-claire-element-id="617485">Une fois que vous vous êtes équipés, on va pouvoir attaquer la suite. :pirate:</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">
<span class="arrow"></span>
<span class="next">Messages privés</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
<span class="next">Lire un message</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lireunmessage"></a><h2>Lire un message</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
<span class="arrow"></span>
<span class="next">Structure de la page</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
<span class="next">Répondre, Poster, Supprimer</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617488" data-claire-element-id="617488">La première partie de notre switch - ce n'est pas très logique mais bon, c'est comme ça :p - est la lecture d'un message. Comme je l'ai dit plus haut, on a besoin de la valeur de l'id du message à lire qu'on va récupérer dans l'url.<br/> Donc, le début du code est très classique :</p><pre id="r-617489" data-claire-element-id="617489"><code data-claire-semantic="html+php">&lt;?php
case &quot;consulter&quot;: //Si on veut lire un message
 
    echo'&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; &lt;a href=&quot;./messagesprives.php&quot;&gt;Messagerie privée&lt;/a&gt; --&gt; Consulter un message&lt;/p&gt;';
    $id_mess = (int) $_GET['id']; //On récupère la valeur de l'id
    echo '&lt;h1&gt;Consulter un message&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';

    //La requête nous permet d'obtenir les infos sur ce message :
    $query = $db-&gt;prepare('SELECT  mp_expediteur, mp_receveur, mp_titre,               
    mp_time, mp_text, mp_lu, membre_id, membre_pseudo, membre_avatar,
    membre_localisation, membre_inscrit, membre_post, membre_signature
    FROM forum_mp
    LEFT JOIN forum_membres ON membre_id = mp_expediteur
    WHERE mp_id = :id');
    $query-&gt;bindValue(':id',$id_mess,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();

    // Attention ! Seul le receveur du mp peut le lire !
    if ($id != $data['mp_receveur']) erreur(ERR_WRONG_USER);
       
    //bouton de réponse
    echo'&lt;p&gt;&lt;a href=&quot;./messagesprives.php?action=repondre&amp;amp;dest='.$data['mp_expediteur'].'&quot;&gt;
    &lt;img src=&quot;./images/repondre.gif&quot; alt=&quot;Répondre&quot; 
    title=&quot;Répondre à ce message&quot; /&gt;&lt;/a&gt;&lt;/p&gt;'; 

    ?&gt;</code></pre><p id="r-617490" data-claire-element-id="617490">On retrouve dans la requête les jointures SQL qui vont nous permettre d'afficher en plus des infos sur le membre.<br/> En fait, c'est exactement comme la page voirtopic.php, si on regarde bien... La seule différence est qu'on affiche seulement un message (donc, plus besoin de boucle), et qu'on peut accéder à cette page seulement si on est la bonne personne. D'où la présence de la fonction <strong>erreur</strong>, qui arrête l'exécution du script en cas de problème.</p><aside id="r-617492" data-claire-element-id="617492" data-claire-semantic="warning"><p id="r-617491" data-claire-element-id="617491">Evidemment vous avez tout de suite remarqué la présence de la nouvelle constante ERR_WRONG_USER qui correspond à un message du type &quot;Vous n'êtes pas le bon utilisateur nomdediou !&quot;</p></aside><p id="r-617493" data-claire-element-id="617493">La suite est simplement l'affichage du message, comme le fait la page affichant les topics.</p><pre id="r-617494" data-claire-element-id="617494"><code data-claire-semantic="html+php">&lt;table&gt;     
    &lt;tr&gt;
    &lt;th class=&quot;vt_auteur&quot;&gt;&lt;strong&gt;Auteur&lt;/strong&gt;&lt;/th&gt;             
    &lt;th class=&quot;vt_mess&quot;&gt;&lt;strong&gt;Message&lt;/strong&gt;&lt;/th&gt;       
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
    &lt;?php echo'&lt;strong&gt;
    &lt;a href=&quot;./voirprofil.php?m='.$data['membre_id'].'&amp;amp;action=consulter&quot;&gt;
    '.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/strong&gt;&lt;/td&gt;
    &lt;td&gt;Posté à '.date('H\hi \l\e d M Y',$data['mp_time']).'&lt;/td&gt;';
    ?&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
    &lt;?php
        
    //Ici des infos sur le membre qui a envoyé le mp
    echo'&lt;p&gt;&lt;img src=&quot;./images/avatars/'.$data['membre_avatar'].'&quot; alt=&quot;&quot; /&gt;
    &lt;br /&gt;Membre inscrit le '.date('d/m/Y',$data['membre_inscrit']).'
    &lt;br /&gt;Messages : '.$data['membre_post'].'
    &lt;br /&gt;Localisation : '.stripslashes(htmlspecialchars($data['membre_localisation'])).'&lt;/p&gt;
    &lt;/td&gt;&lt;td&gt;';
        
    echo code(nl2br(stripslashes(htmlspecialchars($data['mp_text'])))).'
    &lt;hr /&gt;'.code(nl2br(stripslashes(htmlspecialchars($data['membre_signature'])))).'
    &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';</code></pre><p id="r-617495" data-claire-element-id="617495">Rien de bien nouveau, finalement :) .<br/> C'est presque terminé: il reste juste à voir si le message est nouveau, auquel cas on va devoir modifier la valeur de mp_lu.</p><pre id="r-617496" data-claire-element-id="617496"><code data-claire-semantic="html+php">&lt;?php
    if ($data['mp_lu'] == 0) //Si le message n'a jamais été lu
    {
        $query-&gt;CloseCursor();
        $query=$db-&gt;prepare('UPDATE forum_mp 
        SET mp_lu = :lu
        WHERE mp_id= :id');
        $query-&gt;bindValue(':id',$id_mess, PDO::PARAM_INT);
        $query-&gt;bindValue(':lu','1', PDO::PARAM_STR);
        $query-&gt;execute();
        $query-&gt;CloseCursor();
    }
        
break; //La fin !
?&gt;</code></pre><p id="r-617497" data-claire-element-id="617497">La partie &quot;lire un mp&quot; est terminée. Il est donc possible de consulter les messages qu'on a reçus... pas très pratique, vu qu'on ne peut pas encore en envoyer :euh: . Bah, on va régler ça de suite ^^ .</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
<span class="arrow"></span>
<span class="next">Structure de la page</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
<span class="next">Répondre, Poster, Supprimer</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="RpondrePosterSupprimer"></a><h2>Répondre, Poster, Supprimer</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
<span class="arrow"></span>
<span class="next">Lire un message</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
<span class="next">La boîte de Mp</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617499" data-claire-element-id="617499">On va donc voir dans cette partie comment poster un mp, puis comment supprimer un mp de sa boîte de messagerie.<br/> Alors commençons dans l'ordre. :)</p><h2 id="r-nouveau-mp" data-claire-element-id="617510">Nouveau mp</h2><p id="r-617500" data-claire-element-id="617500">Le premier cas est aussi le plus classique : poster un nouveau mp. Par &quot;nouveau&quot; j'entends que l'identité du destinataire est décidé au moment de poster le message.<br/> Pour le reste, rien de bien nouveau par rapport à la page poster.php, le code sera très similaire.</p><div id="r-617502" data-claire-element-id="617502" data-claire-semantic="question"><p id="r-617501" data-claire-element-id="617501">Mais t'as dit qu'il n'y aurait qu'une seule nouvelle page : comment on va faire pour traiter le message envoyé ?</p></div><p id="r-617503" data-claire-element-id="617503">On va réutiliser la page postok.php, pardi ! Il suffira pour cela d'ajouter deux nouvelles options dans le switch.</p><p id="r-617504" data-claire-element-id="617504">Allez, sans plus tarder, le code !</p><pre id="r-617505" data-claire-element-id="617505"><code data-claire-semantic="html+php">&lt;?php
case &quot;nouveau&quot;: //Nouveau mp
       
   echo'&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; &lt;a href=&quot;./messagesprives.php&quot;&gt;Messagerie privée&lt;/a&gt; --&gt; Ecrire un message&lt;/p&gt;';
   echo '&lt;h1&gt;Nouveau message privé&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';
   ?&gt;
   &lt;form method=&quot;post&quot; action=&quot;postok.php?action=nouveaump&quot; name=&quot;formulaire&quot;&gt;
   &lt;p&gt;
   &lt;label for=&quot;to&quot;&gt;Envoyer à : &lt;/label&gt;
   &lt;input type=&quot;text&quot; size=&quot;30&quot; id=&quot;to&quot; name=&quot;to&quot; /&gt;
   &lt;br /&gt;
   &lt;label for=&quot;titre&quot;&gt;Titre : &lt;/label&gt;
   &lt;input type=&quot;text&quot; size=&quot;80&quot; id=&quot;titre&quot; name=&quot;titre&quot; /&gt;
   &lt;br /&gt;&lt;br /&gt;
   &lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;
   &lt;input type=&quot;button&quot; id=&quot;italic&quot; name=&quot;italic&quot; value=&quot;Italic&quot; onClick=&quot;javascript:bbcode('[i]', '[/i]');return(false)&quot; /&gt;
   &lt;input type=&quot;button&quot; id=&quot;souligné&quot; name=&quot;souligné&quot; value=&quot;Souligné&quot; onClick=&quot;javascript:bbcode('[s]', '[/s]');return(false)&quot; /&gt;
   &lt;input type=&quot;button&quot; id=&quot;lien&quot; name=&quot;lien&quot; value=&quot;Lien&quot; onClick=&quot;javascript:bbcode('[url]', '[/url]');return(false)&quot; /&gt;
   &lt;br /&gt;&lt;br /&gt;
   &lt;img src=&quot;./images/smileys/heureux.gif&quot; title=&quot;heureux&quot; alt=&quot;heureux&quot; onClick=&quot;javascript:smilies(':D');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/lol.gif&quot; title=&quot;lol&quot; alt=&quot;lol&quot; onClick=&quot;javascript:smilies(':lol:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; onClick=&quot;javascript:smilies(':triste:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/cool.gif&quot; title=&quot;cool&quot; alt=&quot;cool&quot; onClick=&quot;javascript:smilies(':frime:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/rire.gif&quot; title=&quot;rire&quot; alt=&quot;rire&quot; onClick=&quot;javascript:smilies('XD');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/confus.gif&quot; title=&quot;confus&quot; alt=&quot;confus&quot; onClick=&quot;javascript:smilies(':s');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/choc.gif&quot; title=&quot;choc&quot; alt=&quot;choc&quot; onClick=&quot;javascript:smilies(':O');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/question.gif&quot; title=&quot;?&quot; alt=&quot;?&quot; onClick=&quot;javascript:smilies(':interrogation:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/exclamation.gif&quot; title=&quot;!&quot; alt=&quot;!&quot; onClick=&quot;javascript:smilies(':exclamation:');return(false)&quot; /&gt;

   &lt;textarea cols=&quot;80&quot; rows=&quot;8&quot; id=&quot;message&quot; name=&quot;message&quot;&gt;&lt;/textarea&gt;
   &lt;br /&gt;
   &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
   &lt;input type=&quot;reset&quot; name=&quot;Effacer&quot; value=&quot;Effacer&quot; /&gt;&lt;/p&gt;
   &lt;/form&gt;

&lt;?php   
break;</code></pre><p id="r-617506" data-claire-element-id="617506">Ça vous rappelle de bons souvenirs :lol: ? Vous voyez qu'on envoie le formulaire à la page postok.php?action=nouveaump, c'est donc la valeur de la variable $action que nous allons traiter bientôt.</p><p id="r-617507" data-claire-element-id="617507">Vous remarquez aussi cette ligne :</p><pre id="r-617508" data-claire-element-id="617508"><code data-claire-semantic="html">&lt;label for=&quot;to&quot;&gt;Envoyer à : &lt;/label&gt;&lt;input type=&quot;texte&quot; cols=30 rows=1 id=&quot;to&quot; name=&quot;to&quot; /&gt;</code></pre><p id="r-617509" data-claire-element-id="617509">C'est ici que le membre qui envoie un mp devra écrire le nom du destinataire, tout simplement. :p</p><h2 id="r-reponse-1" data-claire-element-id="617518">Réponse</h2><p id="r-617511" data-claire-element-id="617511">Imaginez-vous en train de recevoir un mp d'une admiratrice (ou d'un admirateur) fou de vous, vous vous apprêtez à lui répondre, et là... paf ! Vous oubliez son pseudo et vous vous dites, &quot;arf, si seulement on pouvait cliquer sur un bouton et lui répondre directement&quot; :-° . <br/> Derrière cet exemple se cache l'utilité de ce que l'on va voir tout de suite. En effet, en cliquant sur le bouton &quot;répondre&quot;, l'id du destinataire sera directement affiché dans l'url, ce qui permet de lui envoyer directement le message.</p><p id="r-617512" data-claire-element-id="617512">Bien sûr, le code est très proche de celui qu'on a vu au-dessus : la différence majeure, c'est qu'on n'a pas besoin de la ligne.</p><pre id="r-617513" data-claire-element-id="617513"><code data-claire-semantic="html">&lt;label for=&quot;to&quot;&gt;Envoyer à : &lt;/label&gt;&lt;input type=&quot;text&quot; size=30 id=&quot;to&quot; name=&quot;to&quot; /&gt;</code></pre><p id="r-617514" data-claire-element-id="617514">Allez hop, le code :</p><pre id="r-617515" data-claire-element-id="617515"><code data-claire-semantic="html+php">&lt;?php
case &quot;repondre&quot;: //On veut répondre
   echo'&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; &lt;a href=&quot;./messagesprives.php&quot;&gt;Messagerie privée&lt;/a&gt; --&gt; Ecrire un message&lt;/p&gt;';
   echo '&lt;h1&gt;Répondre à un message privé&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';

   $dest = (int) $_GET['dest'];
   ?&gt;
   &lt;form method=&quot;post&quot; action=&quot;postok.php?action=repondremp&amp;amp;dest=&lt;?php echo $dest ?&gt;&quot; name=&quot;formulaire&quot;&gt;
   &lt;p&gt;
   &lt;label for=&quot;titre&quot;&gt;Titre : &lt;/label&gt;&lt;input type=&quot;text&quot; size=&quot;80&quot; id=&quot;titre&quot; name=&quot;titre&quot; /&gt;
   &lt;br /&gt;&lt;br /&gt;
   &lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;
   &lt;input type=&quot;button&quot; id=&quot;italic&quot; name=&quot;italic&quot; value=&quot;Italic&quot; onClick=&quot;javascript:bbcode('[i]', '[/i]');return(false)&quot; /&gt;
   &lt;input type=&quot;button&quot; id=&quot;souligné&quot; name=&quot;souligné&quot; value=&quot;Souligné&quot; onClick=&quot;javascript:bbcode('[s]', '[/s]');return(false)&quot; /&gt;
   &lt;input type=&quot;button&quot; id=&quot;lien&quot; name=&quot;lien&quot; value=&quot;Lien&quot; onClick=&quot;javascript:bbcode('[url]', '[/url]');return(false)&quot; /&gt;
   &lt;br /&gt;&lt;br /&gt;
   &lt;img src=&quot;./images/smileys/heureux.gif&quot; title=&quot;heureux&quot; alt=&quot;heureux&quot; onClick=&quot;javascript:smilies(':D');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/lol.gif&quot; title=&quot;lol&quot; alt=&quot;lol&quot; onClick=&quot;javascript:smilies(':lol:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; onClick=&quot;javascript:smilies(':triste:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/cool.gif&quot; title=&quot;cool&quot; alt=&quot;cool&quot; onClick=&quot;javascript:smilies(':frime:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/rire.gif&quot; title=&quot;rire&quot; alt=&quot;rire&quot; onClick=&quot;javascript:smilies('XD');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/confus.gif&quot; title=&quot;confus&quot; alt=&quot;confus&quot; onClick=&quot;javascript:smilies(':s');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/choc.gif&quot; title=&quot;choc&quot; alt=&quot;choc&quot; onClick=&quot;javascript:smilies(':O');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/question.gif&quot; title=&quot;?&quot; alt=&quot;?&quot; onClick=&quot;javascript:smilies(':interrogation:');return(false)&quot; /&gt;
   &lt;img src=&quot;./images/smileys/exclamation.gif&quot; title=&quot;!&quot; alt=&quot;!&quot; onClick=&quot;javascript:smilies(':exclamation:');return(false)&quot; /&gt;

   &lt;br /&gt;&lt;br /&gt;
   &lt;textarea cols=&quot;80&quot; rows=&quot;8&quot; id=&quot;message&quot; name=&quot;message&quot;&gt;&lt;/textarea&gt;
   &lt;br /&gt;
   &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
   &lt;input type=&quot;reset&quot; name=&quot;Effacer&quot; value=&quot;Effacer&quot;/&gt;
   &lt;/p&gt;&lt;/form&gt;
   &lt;?php
break;
?&gt;</code></pre><p id="r-617516" data-claire-element-id="617516">Vous comprenez maintenant pourquoi le code de cette page est si lourd... C'est pourquoi je vous conseille d'insérer toute la partie qui affiche les boutons de mise en forme du texte, ou encore les smilies, dans un fichier que vous inclurez à chaque fois qu'il faudra. Cela aura le mérite d'améliorer considérablement la lisibilité du code.</p><p id="r-617517" data-claire-element-id="617517">Passons... Et voyons à présent le traitement ^^ .</p><h2 id="r-traitement-des-mp" data-claire-element-id="617526">Traitement des mp</h2><p id="r-617519" data-claire-element-id="617519">Avant de poursuivre, il va falloir que vous ressortiez la page <strong>postok.php</strong>. Si vous regardez, vous allez vous rendre compte que tout est articulé autour d'un switch. Il va donc nous suffire d'ajouter 2 cas : 1 pour la réponse du mp, et l'autre pour les nouveaux mp.</p><p id="r-617520" data-claire-element-id="617520">Voilà comment on va faire :</p><pre id="r-617521" data-claire-element-id="617521"><code data-claire-semantic="html+php">&lt;?php
case &quot;repondremp&quot;: //Si on veut répondre

    //On récupère le titre et le message
    $message = $_POST['message'];
    $titre = $_POST['titre'];
    $temps = time();

    //On récupère la valeur de l'id du destinataire
    $dest = (int) $_GET['dest'];

    //Enfin on peut envoyer le message

    $query=$db-&gt;prepare('INSERT INTO forum_mp
    (mp_expediteur, mp_receveur, mp_titre, mp_text, mp_time, mp_lu)
    VALUES(:id, :dest, :titre, :txt, :tps, '0')'); 
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);   
    $query-&gt;bindValue(':dest',$dest,PDO::PARAM_INT);   
    $query-&gt;bindValue(':titre',$titre,PDO::PARAM_STR);   
    $query-&gt;bindValue(':txt',$message,PDO::PARAM_STR);   
    $query-&gt;bindValue(':tps',$temps,PDO::PARAM_INT);   
    $query-&gt;execute();
    $query-&gt;CloseCursor(); 

    echo'&lt;p&gt;Votre message a bien été envoyé!&lt;br /&gt;
    &lt;br /&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du   
    forum&lt;br /&gt;
    &lt;br /&gt;Cliquez &lt;a href=&quot;./messagesprives.php&quot;&gt;ici&lt;/a&gt; pour retourner
    à la messagerie&lt;/p&gt;';

    break;
?&gt;</code></pre><p id="r-617522" data-claire-element-id="617522">C'est tout classiquement une page de traitement basique, on récupère les données, et on les insère dans la base de données. Vous avez sûrement fait ça des dizaines de fois.<br/> La partie suivante va demander un peu plus de vérification, parce qu'il faut s'assurer que le nom entré correspond bien à celui d'un utilisateur.</p><pre id="r-617523" data-claire-element-id="617523"><code data-claire-semantic="html+php">&lt;?php
    case &quot;nouveaump&quot;: //On envoie un nouveau mp

    //On récupère le titre et le message
    $message = $_POST['message'];
    $titre = $_POST['titre'];
    $temps = time();
    $dest = $_POST['to'];

    //On récupère la valeur de l'id du destinataire
    //Il faut déja vérifier le nom

    $query=$db-&gt;prepare('SELECT membre_id FROM forum_membres
    WHERE LOWER(membre_pseudo) = :dest');
    $query-&gt;bindValue(':dest',strotolower($dest),PDO::PARAM_STR);
    $query-&gt;execute();
    if($data = $query-&gt;fetch())
    {
        $query=$db-&gt;prepare('INSERT INTO forum_mp
        (mp_expediteur, mp_receveur, mp_titre, mp_text, mp_time, mp_lu)
        VALUES(:id, :dest, :titre, :txt, :tps, :lu)'); 
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);   
        $query-&gt;bindValue(':dest',(int) $data['membre_id'],PDO::PARAM_INT);   
        $query-&gt;bindValue(':titre',$titre,PDO::PARAM_STR);   
        $query-&gt;bindValue(':txt',$message,PDO::PARAM_STR);   
        $query-&gt;bindValue(':tps',$temps,PDO::PARAM_INT);   
        $query-&gt;bindValue(':lu','0',PDO::PARAM_STR);   
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 

       echo'&lt;p&gt;Votre message a bien été envoyé!
       &lt;br /&gt;&lt;br /&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du
       forum&lt;br /&gt;
       &lt;br /&gt;Cliquez &lt;a href=&quot;./messagesprives.php&quot;&gt;ici&lt;/a&gt; pour retourner à
       la messagerie&lt;/p&gt;';
    }
    //Sinon l'utilisateur n'existe pas !
    else
    {
        echo'&lt;p&gt;Désolé ce membre n existe pas, veuillez vérifier et
        réessayez à nouveau.&lt;/p&gt;';
    }
    break;
?&gt;</code></pre><p id="r-617524" data-claire-element-id="617524">Voilà :) . La vérification se fait de la façon suivante : on lance la requête avec le nom donné par l'expéditeur. S'il n'y a aucun problème, on affiche la suite, sinon un message d'erreur, et on recommence.</p><p id="r-617525" data-claire-element-id="617525">A partir de maintenant, vous pouvez sans problème poster de nouveaux mp à n'importe qui. Il nous reste à voir comment supprimer un mp de sa boîte.</p><h2 id="r-suppression-d-un-mp" data-claire-element-id="617530">Suppression d'un mp</h2><p id="r-617527" data-claire-element-id="617527">Ça doit sûrement vous paraître étrange d'aborder ceci dans cette partie, mais c'est le plus pratique, finalement.<br/> Il s'agit donc simplement de supprimer un mp de sa boîte en cliquant sur un lien contenant l'id du mp, et également une variable appelée sur. Celle-ci va permettre de distinguer 2 cas : dans le premier, on a cliqué sur &quot;supprimer&quot;, mais peut-être par erreur... Il serait un peu cruel de virer directement le message : donc, on redemande, puis enfin on exécute la suppression.</p><pre id="r-617528" data-claire-element-id="617528"><code data-claire-semantic="html+php">&lt;?php
    case &quot;supprimer&quot;:
       
    //On récupère la valeur de l'id
    $id_mess = (int) $_GET['id'];
    //Il faut vérifier que le membre est bien celui qui a reçu le message
    $query=$db-&gt;prepare('SELECT mp_receveur
    FROM forum_mp WHERE mp_id = :id');
    $query-&gt;bindValue(':id',$id_mess,PDO::PARAM_INT);
    $query-&gt;execute();
    $data = $query-&gt;fetch();
    //Sinon la sanction est terrible :p
    if ($id != $data['mp_receveur']) erreur(ERR_WRONG_USER);
    $query-&gt;CloseCursor(); 

    //2 cas pour cette partie : on est sûr de supprimer ou alors on ne l'est pas
    $sur = (int) $_GET['sur'];
    //Pas encore certain
    if ($sur == 0)
    {
    echo'&lt;p&gt;Etes-vous certain de vouloir supprimer ce message ?&lt;br /&gt;
    &lt;a href=&quot;./messagesprives.php?action=supprimer&amp;amp;id='.$id_mess.'&amp;amp;sur=1&quot;&gt;
    Oui&lt;/a&gt; - &lt;a href=&quot;./messagesprives.php&quot;&gt;Non&lt;/a&gt;&lt;/p&gt;';
    }
    //Certain
    else
    {
        $query=$db-&gt;prepare('DELETE from forum_mp WHERE mp_id = :id');
        $query-&gt;bindValue(':id',$id_mess,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 
        echo'&lt;p&gt;Le message a bien été supprimé.&lt;br /&gt;
        Cliquez &lt;a href=&quot;./messagesprives.php&quot;&gt;ici&lt;/a&gt; pour revenir à la boite
        de messagerie.&lt;/p&gt;';
    }

    break;
?&gt;</code></pre><p id="r-617529" data-claire-element-id="617529">On est arrivés au bout. Vous avez remarqué qu'il faut encore une fois vérifier que le membre qui demande la suppression est bien celui qui a reçu le mp. Dans le cas contraire, n'importe qui en modifiant simplement l'id du message pourrait s'en débarrasser.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
<span class="arrow"></span>
<span class="next">Lire un message</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
<span class="next">La boîte de Mp</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LabotedeMp"></a><h2>La boîte de Mp</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
<span class="arrow"></span>
<span class="next">Répondre, Poster, Supprimer</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">
<span class="next">Autorisations d&#039;accès</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617532" data-claire-element-id="617532">On arrive à la fin du switch : il va falloir définir ce qu'on affichera par défaut. Pour cela, j'ai décidé de mettre la boîte de messagerie, mais après tout, vous pouvez aussi en faire une partie à elle seule. C'est vraiment comme vous le sentez ^^ . Quoi qu'il en soit, voilà ce que j'ai fait :</p><pre id="r-617533" data-claire-element-id="617533"><code data-claire-semantic="html+php">&lt;?php
//Si rien n'est demandé ou s'il y a une erreur dans l'url 
//On affiche la boite de mp.
default;
    
    echo'&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; &lt;a href=&quot;./messagesprives.php&quot;&gt;Messagerie privée&lt;/a&gt;';
    echo '&lt;h1&gt;Messagerie Privée&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';

    $query=$db-&gt;prepare('SELECT mp_lu, mp_id, mp_expediteur, mp_titre, mp_time, membre_id, membre_pseudo
    FROM forum_mp
    LEFT JOIN forum_membres ON forum_mp.mp_expediteur = forum_membres.membre_id
    WHERE mp_receveur = :id ORDER BY mp_id DESC');
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
    $query-&gt;execute();
    echo'&lt;p&gt;&lt;a href=&quot;./messagesprives.php?action=nouveau&quot;&gt;
    &lt;img src=&quot;./images/nouveau.gif&quot; alt=&quot;Nouveau&quot; title=&quot;Nouveau message&quot; /&gt;
    &lt;/a&gt;&lt;/p&gt;';
    if ($query-&gt;rowCount()&gt;0)
    {
        ?&gt;
        &lt;table&gt;
        &lt;tr&gt;
        &lt;th&gt;&lt;/th&gt;
        &lt;th class=&quot;mp_titre&quot;&gt;&lt;strong&gt;Titre&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;mp_expediteur&quot;&gt;&lt;strong&gt;Expéditeur&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;mp_time&quot;&gt;&lt;strong&gt;Date&lt;/strong&gt;&lt;/th&gt;
        &lt;th&gt;&lt;strong&gt;Action&lt;/strong&gt;&lt;/th&gt;
        &lt;/tr&gt;

        &lt;?php
        //On boucle et on remplit le tableau
        while ($data = $query-&gt;fetch())
        {
            echo'&lt;tr&gt;';
            //Mp jamais lu, on affiche l'icone en question
            if($data['mp_lu'] == 0)
            {
            echo'&lt;td&gt;&lt;img src=&quot;./images/message_non_lu.gif&quot; alt=&quot;Non lu&quot; /&gt;&lt;/td&gt;';
            }
            else //sinon une autre icone
            {
            echo'&lt;td&gt;&lt;img src=&quot;./images/message.gif&quot; alt=&quot;Déja lu&quot; /&gt;&lt;/td&gt;';
            }
            echo'&lt;td id=&quot;mp_titre&quot;&gt;
            &lt;a href=&quot;./messagesprives.php?action=consulter&amp;amp;id='.$data['mp_id'].'&quot;&gt;
            '.stripslashes(htmlspecialchars($data['mp_titre'])).'&lt;/a&gt;&lt;/td&gt;
            &lt;td id=&quot;mp_expediteur&quot;&gt;
            &lt;a href=&quot;./voirprofil.php?action=consulter&amp;amp;m='.$data['membre_id'].'&quot;&gt;
            '.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/td&gt;
            &lt;td id=&quot;mp_time&quot;&gt;'.date('H\hi \l\e d M Y',$data['mp_time']).'&lt;/td&gt;
            &lt;td&gt;
            &lt;a href=&quot;./messagesprives.php?action=supprimer&amp;amp;id='.$data['mp_id'].'&amp;amp;sur=0&quot;&gt;supprimer&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;';
        } //Fin de la boucle
        $query-&gt;CloseCursor();
        echo '&lt;/table&gt;';

    } //Fin du if
    else
    {
        echo'&lt;p&gt;Vous n avez aucun message privé pour l instant, cliquez
        &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à la page d index&lt;/p&gt;';
    }
} //Fin du switch
?&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-617534" data-claire-element-id="617534">Voilà. On a terminé la partie messagerie et en prime, on est au bout de la page (c'est pas beau, ça ? :) ).<br/> Donc si on résume, qu'est-ce qu'on a fait ? <br/> Tout d'abord, on lance une requête qui récupère des infos sur les messages qu'on a reçus. Une simple jointure nous permet d'obtenir par la même occasion le nom de l'expéditeur.<br/> Vous remarquez qu'ici on n'a pas besoin de vérifier que l'id du membre qui consulte la messagerie est bien la bonne : en effet, on utilise la variable $id pour savoir ce qui va s'afficher.<br/> Par la suite, il s'agit d'une boucle, et d'un tableau qui se remplit le plus classiquement possible ^^ .</p><p id="r-617535" data-claire-element-id="617535">C'est bon, le système de messagerie privée est entièrement mis en place.</p><p id="r-617536" data-claire-element-id="617536">Il reste toutefois une remarque à faire : sur le Site du Zér0, vous avez vu que les mp prennent la forme d'un topic où jusqu'à 6 personnes peuvent discuter (cela dit, vous pouvez en ajouter autant que vous voulez :p ). Si vous voulez faire la même chose, ce n'est pas très compliqué : il suffit pour cela de reprendre les méthodes utilisées pour les topics. Il va donc falloir reprendre un peu la structure de la base de données.</p><p id="r-617537" data-claire-element-id="617537">Ça fait un peu de boulot, mais le résultat en vaut vraiment la peine, et puis le script n'est pas très compliqué, il suffit d'avoir compris les jointures et c'est réglé.</p><p id="r-617538" data-claire-element-id="617538">On est arrivés par la même occasion au bout des pages membres, et il est temps à présent de s'attaquer aux pages d'administration !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
<span class="arrow"></span>
<span class="next">Répondre, Poster, Supprimer</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">
<span class="next">Autorisations d&#039;accès</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Autorisationsd039accs"></a><h2>Autorisations d&#039;accès</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
<span class="arrow"></span>
<span class="next">La boîte de Mp</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
<span class="next">Faire un forum VIP</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617543" data-claire-element-id="617543">On arrive à la partie la plus délicate de la création d'un forum, les pages d'administration. C'est-à-dire au final la façade qui fait la transition entre vous et votre base de données.</p><p id="r-617544" data-claire-element-id="617544">Dans ce chapitre (très court :) ), nous allons voir comment régler les autorisations d'accès.<br/> Mais qu'est-ce donc qu'une autorisation d'accès o_O ? Bah, comme son nom l'indique, c'est simplement un moyen de vérifier si un membre a le droit d'être là où il est. En fait, on en a déjà mis un peu partout pour éviter qu'un membre non connecté poste un message, par exemple.<br/> On va élargir un peu ce concept avec les modérateurs et administrateurs, grâce à un système assez simple.</p><p id="r-617545" data-claire-element-id="617545">Au programme :</p><ul id="r-617552" data-claire-element-id="617552"><li id="r-617547" data-claire-element-id="617547"><p id="r-617546" data-claire-element-id="617546">Création d'un forum réservé au modo</p></li><li id="r-617549" data-claire-element-id="617549"><p id="r-617548" data-claire-element-id="617548">Gestion du bannissement</p></li><li id="r-617551" data-claire-element-id="617551"><p id="r-617550" data-claire-element-id="617550">Donner la permission aux modérateurs (et seulement aux modérateurs) de poster des annonces</p></li></ul><p id="r-617553" data-claire-element-id="617553">On y va :) .</p>
</div><a name="FaireunforumVIP"></a><h2>Faire un forum VIP</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">
<span class="arrow"></span>
<span class="next">Autorisations d&#039;accès</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
<span class="next">Le bannissement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617554" data-claire-element-id="617554">Vous avez sûrement remarqué que, sur la plupart des forums, il existe des sessions réservés aux modérateurs et administrateurs, pour qu'ils puissent décider en paix des supplices qu'ils vont nous faire subir :D . Vous vous dites peut-être que vous n'en voyez pas l'intérêt, et pourtant il est énorme : lorsque votre forum commence à prendre un peu d'importance, il est très utile de pouvoir communiquer avec le reste de l'équipe.</p><p id="r-617555" data-claire-element-id="617555">Si vous avez suivi le déroulement du tuto jusqu'ici, vous pouvez remarquer qu'en fait tout est déjà mis en place.</p><h2 id="r-petit-retour-en-arriere" data-claire-element-id="617592">Petit retour en arrière</h2><p id="r-617556" data-claire-element-id="617556">Si je vous parle des cinq colonnes qu'on n'a pas encore utilisés dans la table forum_forum, vous me dites auth_view, auth_post, auth_topic, auth_annonce, et auth_modo, bien sûr :D . Je vous avais rapidement expliqué qu'ils permettaient de désigner quel groupe de membres a le droit de lire un forum, d'y poster un message ou un topic.</p><p id="r-617557" data-claire-element-id="617557">Vous vous souvenez aussi de la variable $lvl, qui permet de connaître le niveau d'un visiteur (modérateur, administrateur ou membre).</p><p id="r-617558" data-claire-element-id="617558">Je pense que vous avez compris qu'en cumulant les deux, on peut faire des miracles. ^^</p><p id="r-617559" data-claire-element-id="617559">Par exemple, si je veux qu'un forum puisse n'être vu que par les membres, mais que seuls les modérateurs puissent y poster un topic, et que seuls les administrateurs puissent y laisser un post (ne cherchez pas la logique :D ) il suffit de mettre les valeurs suivantes :</p><table id="r-617590" data-claire-element-id="617590"><thead id="r-617567" data-claire-element-id="617567"><tr id="r-617566" data-claire-element-id="617566"><th id="r-617561" data-claire-element-id="617561"><p id="r-617560" data-claire-element-id="617560">Champ</p></th><th id="r-617563" data-claire-element-id="617563"><p id="r-617562" data-claire-element-id="617562">Valeur</p></th><th id="r-617565" data-claire-element-id="617565"><p id="r-617564" data-claire-element-id="617564">Alias</p></th></tr></thead><tbody id="r-617589" data-claire-element-id="617589"><tr id="r-617574" data-claire-element-id="617574"><td id="r-617569" data-claire-element-id="617569"><p id="r-617568" data-claire-element-id="617568">auth_view</p></td><td id="r-617571" data-claire-element-id="617571"><p id="r-617570" data-claire-element-id="617570">2</p></td><td id="r-617573" data-claire-element-id="617573"><p id="r-617572" data-claire-element-id="617572">INSCRIT</p></td></tr><tr id="r-617581" data-claire-element-id="617581"><td id="r-617576" data-claire-element-id="617576"><p id="r-617575" data-claire-element-id="617575">auth_topic</p></td><td id="r-617578" data-claire-element-id="617578"><p id="r-617577" data-claire-element-id="617577">3</p></td><td id="r-617580" data-claire-element-id="617580"><p id="r-617579" data-claire-element-id="617579">MODO</p></td></tr><tr id="r-617588" data-claire-element-id="617588"><td id="r-617583" data-claire-element-id="617583"><p id="r-617582" data-claire-element-id="617582">auth_post</p></td><td id="r-617585" data-claire-element-id="617585"><p id="r-617584" data-claire-element-id="617584">4</p></td><td id="r-617587" data-claire-element-id="617587"><p id="r-617586" data-claire-element-id="617586">ADMIN</p></td></tr></tbody></table><p id="r-617591" data-claire-element-id="617591">Et puis le tour est joué !</p><h2 id="r-le-probleme-8" data-claire-element-id="617595">Le problème</h2><p id="r-617593" data-claire-element-id="617593">Il y a un problème (je vous dois bien ça :-° ) : comment faire pour créer un forum visible par les modérateurs <strong>et</strong> les administrateurs?</p><p id="r-617594" data-claire-element-id="617594">Eh bien en fait c'est la raison pour laquelle les champs auth_bidule sont des entiers ; ce que l'on va faire, c'est attribuer un numéro pour chaque catégorie de membres (par exemple, 4 pour les admins), de façon à les classer par ordre d'importance. Ensuite, il suffit de vérifier si le niveau d'accès est supérieur au niveau nécessaire :) .</p><h2 id="r-la-solution-6" data-claire-element-id="617703">La solution !</h2><p id="r-617596" data-claire-element-id="617596">Pour vous montrer comment faire à l'avenir, je vais utiliser un petit exemple. Nous allons créer un forum de news, c'est-à-dire que :</p><ul id="r-617605" data-claire-element-id="617605"><li id="r-617598" data-claire-element-id="617598"><p id="r-617597" data-claire-element-id="617597">tous les visiteurs pourront le lire</p></li><li id="r-617600" data-claire-element-id="617600"><p id="r-617599" data-claire-element-id="617599">seuls les membres pourront y poster un message</p></li><li id="r-617602" data-claire-element-id="617602"><p id="r-617601" data-claire-element-id="617601">seuls les modérateurs pourront y poster un topic</p></li><li id="r-617604" data-claire-element-id="617604"><p id="r-617603" data-claire-element-id="617603">seuls les administrateurs pourront le modérer.</p></li></ul><aside id="r-617607" data-claire-element-id="617607" data-claire-semantic="information"><p id="r-617606" data-claire-element-id="617606">Sachant que quand je dis &quot;seuls les membres&quot;, il ne faut pas penser que les modérateurs n'auront pas le droit de poster un message, il s'agit de l'exigence minimale.</p></aside><p id="r-617608" data-claire-element-id="617608">Vous vous souvenez de la page constants.php ? Je vous avais dit d'y écrire les 4 lignes suivantes :</p><pre id="r-617609" data-claire-element-id="617609"><code data-claire-semantic="html+php">&lt;?php
define('VISITEUR',1);
define('INSCRIT',2);
define('MODO',3);
define('ADMIN',4);
?&gt;</code></pre><p id="r-617610" data-claire-element-id="617610">Et bien on a donc les correspondances qui suivent :</p><table id="r-617638" data-claire-element-id="617638"><thead id="r-617616" data-claire-element-id="617616"><tr id="r-617615" data-claire-element-id="617615"><th id="r-617612" data-claire-element-id="617612"><p id="r-617611" data-claire-element-id="617611">Niveau</p></th><th id="r-617614" data-claire-element-id="617614"><p id="r-617613" data-claire-element-id="617613">Autorisation</p></th></tr></thead><tbody id="r-617637" data-claire-element-id="617637"><tr id="r-617621" data-claire-element-id="617621"><td id="r-617618" data-claire-element-id="617618"><p id="r-617617" data-claire-element-id="617617">Visiteur</p></td><td id="r-617620" data-claire-element-id="617620"><p id="r-617619" data-claire-element-id="617619">1</p></td></tr><tr id="r-617626" data-claire-element-id="617626"><td id="r-617623" data-claire-element-id="617623"><p id="r-617622" data-claire-element-id="617622">Inscrit</p></td><td id="r-617625" data-claire-element-id="617625"><p id="r-617624" data-claire-element-id="617624">2</p></td></tr><tr id="r-617631" data-claire-element-id="617631"><td id="r-617628" data-claire-element-id="617628"><p id="r-617627" data-claire-element-id="617627">Modérateur</p></td><td id="r-617630" data-claire-element-id="617630"><p id="r-617629" data-claire-element-id="617629">3</p></td></tr><tr id="r-617636" data-claire-element-id="617636"><td id="r-617633" data-claire-element-id="617633"><p id="r-617632" data-claire-element-id="617632">Administrateur</p></td><td id="r-617635" data-claire-element-id="617635"><p id="r-617634" data-claire-element-id="617634">4</p></td></tr></tbody></table><p id="r-617639" data-claire-element-id="617639">Ensuite, il va falloir modifier plusieurs choses.</p><h3 id="r-la-base-de-donnees-5" data-claire-element-id="617645">La base de données</h3><p id="r-617640" data-claire-element-id="617640">La gestion des autorisations de chaque forum se fera à l'avenir via le panneau d'administration, mais en attendant, vous devez le faire manuellement. Nous allons donc modifier les champs de notre forum News.</p><pre id="r-617641" data-claire-element-id="617641"><code data-claire-semantic="sql">UPDATE forum_forum 
SET auth_view = 1, auth_post = 2, auth_topic = 2, auth_annonce = 3, auth_modo = 4 
WHERE forum_id = 2</code></pre><p id="r-617642" data-claire-element-id="617642">Et si vous avez supprimé le forum depuis tout ce temps :</p><pre id="r-617643" data-claire-element-id="617643"><code data-claire-semantic="sql">INSERT INTO forum_forum ( forum_cat_id , forum_name , forum_desc , forum_ordre , forum_last_post_id , forum_topic , forum_post , auth_view , auth_post , auth_topic , auth_annonce, auth_modo )
VALUES ( 1, 'Les News', 'Les news du site sont ici', 50, 0, 0, 0, 1, 2, 2, 3, 4 )</code></pre><p id="r-617644" data-claire-element-id="617644">Maintenant que les champs sont remplis, le plus dur est fait ; ensuite, il n'y a plus qu'à mettre des conditions un peu partout pour vérifier les droits.</p><h3 id="r-une-fonction-2" data-claire-element-id="617652">Une fonction ?</h3><p id="r-617646" data-claire-element-id="617646">Quand j'ai dit mettre des conditions un peu partout, ça a du évidemment alerter votre logique de codeur php :-° . En effet, on va pouvoir simplifier tout ça avec une fonction, celle-ci prend un paramètre : le niveau nécessaire que doit avoir un membre. Puis elle nous dira si l'utilisateur peut continuer.</p><pre id="r-617647" data-claire-element-id="617647"><code data-claire-semantic="html+php">&lt;?php
function verif_auth($auth_necessaire)
{
$level=(isset($_SESSION['level']))?$_SESSION['level']:1;
return ($auth_necessaire &lt;= intval($level));
}
?&gt;</code></pre><p id="r-617648" data-claire-element-id="617648">Pour l'utilisation, c'est super simple puisqu'il suffit de faire ceci :</p><pre id="r-617649" data-claire-element-id="617649"><code data-claire-semantic="html+php">&lt;?php
if(verif_auth(INSCRIT))
{
//Afficher le forum
}
else
{
//Laisser tomber :p
}
?&gt;</code></pre><aside id="r-617651" data-claire-element-id="617651" data-claire-semantic="warning"><p id="r-617650" data-claire-element-id="617650">Pensez bien à l'inclure sur toutes vos pages ! Le mieux est d'utiliser la page <strong>functions.php</strong> pour cela.</p></aside><h3 id="r-page-d-index-1" data-claire-element-id="617664">Page d'index</h3><p id="r-617653" data-claire-element-id="617653">Pour la page d'index, on pourrait utiliser la fonction, néanmoins ce n'est qu'une sécurité superflue puisque la requête va déjà chercher les forums qui satisfont les autorisations d'accès. Pour l'exemple on va quand même regarder ce que ça donne.</p><p id="r-617654" data-claire-element-id="617654">Si vous vous souvenez bien, il y a une grosse requête qui est suivie par ceci :</p><p id="r-617655" data-claire-element-id="617655"><strong>Page : index.php</strong></p><pre id="r-617656" data-claire-element-id="617656"><code data-claire-semantic="html+php">&lt;?php
//Début de la boucle
        while($data=$query-&gt;fetch())
        {
        //On affiche chaque catégorie
        if( $categorie != $data['cat_id'] )
        {
        //Si c'est une nouvelle catégorie on l'affiche
       
                $categorie = $data['cat_id'];
                ?&gt;
                &lt;tr&gt;
                &lt;th&gt;&lt;/th&gt;
                &lt;th class=&quot;titre&quot;&gt;&lt;strong&gt;&lt;?php echo $data['cat_nom']; ?&gt;
                &lt;/strong&gt;&lt;/th&gt;             
                &lt;th class=&quot;nombremessages&quot;&gt;&lt;strong&gt;Sujets&lt;/strong&gt;&lt;/th&gt;       
                &lt;th class=&quot;nombresujets&quot;&gt;&lt;strong&gt;Messages&lt;/strong&gt;&lt;/th&gt;       
                &lt;th class=&quot;derniermessage&quot;&gt;&lt;strong&gt;Dernier message&lt;/strong&gt;&lt;/th&gt;   
                &lt;/tr&gt;
                &lt;?php
               
         }</code></pre><p id="r-617657" data-claire-element-id="617657">Et juste après, un echo s'occupe d'afficher le contenu de chaque catégorie, c'est-à-dire chaque forum. C'est ici qu'on va agir :ninja: !<br/> Ajoutez simplement après :</p><pre id="r-617658" data-claire-element-id="617658"><code data-claire-semantic="html+php">&lt;?php
if (verif_auth($data['auth_view']))
{
//Affichage des forums
?&gt;</code></pre><p id="r-617659" data-claire-element-id="617659">Vous comprenez à présent pourquoi la requête du début de page allait chercher le champ auth_view ; par ailleurs, vous voyez que la fonction est vraiment simple à utiliser. On fait un if, on affiche les forums, puis on ferme le if. Ainsi, les forums qui apparaissent sont ceux que le membre a le droit de voir ; dans l'exemple du forum de news, tout le monde verra le forum.<br/> Ensuite, on affiche les forums, puis on termine ici :</p><pre id="r-617660" data-claire-element-id="617660"><code data-claire-semantic="html+php">&lt;?php
else
{
echo'&lt;td class=&quot;nombremessages&quot;&gt;Pas de message&lt;/td&gt;&lt;/tr&gt;';
}
} //Fin de la vérification d'autorisation
?&gt;</code></pre><p id="r-617661" data-claire-element-id="617661">A présent, le forum ne s'affiche plus si vous n'êtes pas autorisés à le voir ; en revanche, il est toujours possible de le modifier en se rendant directement sur la page <strong>voirforum.php</strong>. On va voir comment arranger ça.</p><aside id="r-617663" data-claire-element-id="617663" data-claire-semantic="warning"><p id="r-617662" data-claire-element-id="617662">Attention à ne pas inverser le signe <strong>&gt;</strong> en <strong>&lt;</strong> : ça peut paraître idiot de dire ça, mais c'est une erreur fréquente, surtout lorsqu'on va un peu vite. Donc, si vous avez un résultat inattendu, il est probable que ça vienne d'ici.</p></aside><h3 id="r-page-voirforum" data-claire-element-id="617678">Page voirforum</h3><p id="r-617665" data-claire-element-id="617665">Maintenant que le forum s'affiche seulement pour les personnes autorisées, on va pouvoir passer à la page <strong>voirforum.php</strong>, rien de bien compliqué sur cette page puisqu'il s'agit simplement de vérifier que le visiteur ne s'est pas introduit ici en modifiant l'url. Ensuite, on va regarder si celui-ci a le droit de poster un nouveau topic. Si c'est le cas, on affiche le bouton-lien qui permet de se rendre à la page poster.php.</p><p id="r-617666" data-claire-element-id="617666">Pour commencer, rendez-vous en haut de la page <strong>voirforum.php</strong>, à l'endroit où vous voyez une requête dans ce style :</p><p id="r-617667" data-claire-element-id="617667"><strong>Page : voirforum.php</strong></p><pre id="r-617668" data-claire-element-id="617668"><code data-claire-semantic="html+php">&lt;?php
//A partir d'ici, on va compter le nombre de messages 
//pour n'afficher que les 25 premiers
$query=$db-&gt;prepare('SELECT forum_name, forum_topic, auth_view, auth_topic FROM forum_forum WHERE forum_id = :forum');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();
?&gt;</code></pre><p id="r-617669" data-claire-element-id="617669">Juste en dessous, nous allons utiliser la fonction pour vérifier les droits du membres : s'il y a un problème on utilise la fonction erreur avant d'afficher quoi que ce soit. A vous d'aller faire les bonnes modifications dans la page constants.php, je vais pas tout faire non plus (nan mais ! :colere2: )</p><pre id="r-617670" data-claire-element-id="617670"><code data-claire-semantic="html+php">&lt;?php
if (!verif_auth($data['auth_view']))
{
erreur(ERR_AUTH_VIEW);
}
?&gt;</code></pre><p id="r-617671" data-claire-element-id="617671">A présent, voyons le deuxième aspect qui est celui du bouton &quot;nouveau topic&quot;. Recherchez un peu plus bas l'endroit où vous avez placé l'image :</p><pre id="r-617672" data-claire-element-id="617672"><code data-claire-semantic="html+php">&lt;?php
//Et le bouton pour poster
echo'&lt;a href=&quot;./poster.php?action=nouveautopic&amp;amp;f='.$forum.'&quot;&gt;
&lt;img src=&quot;./images/nouveau.gif&quot; alt=&quot;Nouveau topic&quot; title=&quot;Poster un nouveau topic&quot; /&gt;&lt;/a&gt;';
?&gt;</code></pre><p id="r-617673" data-claire-element-id="617673">Il faut cette fois vérifier l'autorisation en rapport avec le droit de créer un nouveau sujet, c'est donc le champ auth_topic qui va être utilisé :</p><pre id="r-617674" data-claire-element-id="617674"><code data-claire-semantic="html+php">&lt;?php
if (verif_auth($data['auth_topic']))
{
//Et le bouton pour poster
echo'&lt;a href=&quot;./poster.php?action=nouveautopic&amp;amp;f='.$forum.'&quot;&gt;
&lt;img src=&quot;./images/nouveau.gif&quot; alt=&quot;Nouveau topic&quot; title=&quot;Poster un nouveau topic&quot;&gt;&lt;/a&gt;';
}
?&gt;</code></pre><p id="r-617675" data-claire-element-id="617675">L'idéal serait de placer une image alternative avec un else pour que le membre ne soit pas complètement perdu en ne voyant plus son image :p . Ou bien vous pouvez afficher un petit texte, pour lui expliquer qu'il n'a pas les droits.</p><p id="r-617676" data-claire-element-id="617676">Pour reprendre l'exemple du forum de news, un visiteur non connecté ou un simple membre ne pourrait pas voir ce bouton.</p><p id="r-617677" data-claire-element-id="617677">Vous voyez qu'en fait si on utilise la fonction, il ne s'agit que de légères modifications à faire ici et là ; cependant il ne faut pas non plus en oublier, sinon il suffira de connaître un peu le nom des pages pour pouvoir aller où l'on veut.</p><h3 id="r-page-voirtopic-php" data-claire-element-id="617688">Page voirtopic.php</h3><p id="r-617679" data-claire-element-id="617679">Dans la page <strong>voirtopic.php</strong>, il faut vérifier encore une fois une série d'autorisations.<br/> Tout d'abord, s'assurer que le membre a bien l'autorisation de voir le forum auquel appartient le sujet en question.<br/> Puis, s'assurer qu'il a le droit de poster un nouveau topic (auquel cas on affiche l'image en question).<br/> Et enfin s'assurer qu'il a le droit de poster une réponse.</p><p id="r-617680" data-claire-element-id="617680">Heureusement pour nous, le terrain est déjà préparé puisque vous devriez avoir une requête qui s'approche de ça :</p><p id="r-617681" data-claire-element-id="617681"><strong>Page : voirtopic.php</strong></p><pre id="r-617682" data-claire-element-id="617682"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT topic_titre, topic_post, forum_topic.forum_id, topic_last_post,
forum_name, auth_view, auth_topic, auth_post 
FROM forum_topic 
LEFT JOIN forum_forum ON forum_topic.forum_id = forum_forum.forum_id 
WHERE topic_id = :topic');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();
?&gt;</code></pre><p id="r-617683" data-claire-element-id="617683">Une fois encore, on ajoute sans plus attendre la première vérification :</p><pre id="r-617684" data-claire-element-id="617684"><code data-claire-semantic="html+php">&lt;?php
if (!verif_auth($data['auth_view']))
{
    erreur(ERR_AUTH_VIEW);
}
?&gt;</code></pre><p id="r-617685" data-claire-element-id="617685">Enfin, on se dirige vers les boutons 'poster' et 'répondre', qu'on entoure des conditions suivantes :</p><pre id="r-617686" data-claire-element-id="617686"><code data-claire-semantic="html+php">&lt;?php
if (verif_auth($data['auth_post']))
{
//On affiche l'image répondre
echo'&lt;a href=&quot;./poster.php?action=repondre&amp;amp;t='.$topic.'&quot;&gt;
&lt;img src=&quot;./images/repondre.gif&quot; alt=&quot;Répondre&quot; title=&quot;Répondre à ce topic&quot;&gt;&lt;/a&gt;';
}

if (verif_auth($data['auth_topic']))
{
//On affiche l'image nouveau topic
echo'&lt;a href=&quot;./poster.php?action=nouveautopic&amp;amp;f='.$data['forum_id'].'&quot;&gt;
&lt;img src=&quot;./images/nouveau.gif&quot; alt=&quot;Nouveau topic&quot; 
title=&quot;Poster un nouveau topic&quot;&gt;&lt;/a&gt;';
}
?&gt;</code></pre><p id="r-617687" data-claire-element-id="617687">Ce n'est pas plus compliqué que ça :) . D'ailleurs on touche à la fin, il ne nous reste plus qu'à modifier une page.</p><h3 id="r-page-poster-php" data-claire-element-id="617702">Page poster.php</h3><p id="r-617689" data-claire-element-id="617689">Comme ce qu'on fait depuis tout à l'heure est assez répétitif, et surtout assez facile, je vais vous laisser vous occuper seuls de cette page, parce qu'il est important que vous ayez compris le fonctionnement de ce système afin de pouvoir le personnaliser au maximum.</p><p id="r-617690" data-claire-element-id="617690">Voilà ce qu'il faut vérifier :</p><ul id="r-617697" data-claire-element-id="617697"><li id="r-617692" data-claire-element-id="617692"><p id="r-617691" data-claire-element-id="617691">déjà, que le visiteur a le droit d'être sur le forum (auth_view)</p></li><li id="r-617694" data-claire-element-id="617694"><p id="r-617693" data-claire-element-id="617693">ensuite, qu'il a le droit de poster un nouveau sujet (pour cela, il faut travailler à l'intérieur du switch après le case&quot;nouveautopic&quot;:)</p></li><li id="r-617696" data-claire-element-id="617696"><p id="r-617695" data-claire-element-id="617695">enfin, de la même façon qu'il peut répondre (case&quot;repondre&quot;:)</p></li></ul><p id="r-617698" data-claire-element-id="617698">Encore une fois, tout est déjà mis en place grâce à une requête, celle-ci diffère selon qu'on se trouve dans le cas d'un nouveau topic ou d'une réponse.</p><p id="r-617699" data-claire-element-id="617699">Pensez à placer les vérifications avant d'afficher le contenu de la page : si elle n'est pas remplie, faîtes un simple erreur, puis passez à la suite.</p><p id="r-617700" data-claire-element-id="617700">Pour ce qui est de la page postok.php, on ne peut logiquement pas s'y rendre en postant quelque chose, dans la mesure où l'accès à la page poster.php est bloqué si on n'a pas les droits. Toutefois, ça ne coûte rien de le faire quand même : faites donc exactement les mêmes modifications là-bas.</p><p id="r-617701" data-claire-element-id="617701">Nous avons maintenant terminé ce système d'autorisations ; dans tous les forums, vous pouvez régler différents niveaux d'accès. Libre à vous de faire une partie réservée aux modérateurs ou aux administrateurs.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">
<span class="arrow"></span>
<span class="next">Autorisations d&#039;accès</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
<span class="next">Le bannissement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lebannissement"></a><h2>Le bannissement</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
<span class="arrow"></span>
<span class="next">Faire un forum VIP</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
<span class="next">Les annonces</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617705" data-claire-element-id="617705">Il arrive malheureusement souvent d'être confronté à des membres qui ne respectent pas les règles de votre forum, et qu'il faut donc supprimer.<br/> Vous pouvez bien sûr l'effacer carrément de la base de données, mais s'il a déjà posté des messages, ça risque de créer des bugs. Reste donc une solution, le bannissement. Via le panneau d'administration, il est possible de choisir un membre et de le bannir, c'est-à-dire que si celui-ci essaye de se reconnecter, il sera bloqué.</p><p id="r-617706" data-claire-element-id="617706">La technique la plus simple est de lui mettre un niveau d'autorisation à 0. Comme ça, il ne pourra se rendre sur aucune page (je rappelle que 1 est pour un visiteur non connecté).</p><p id="r-617707" data-claire-element-id="617707">Cependant ça ne suffit pas : il faut faire comprendre à ce membre qu'il n'est plus le bienvenu. C'est-à-dire que sur la page de connexion, s'il entre bien ses identifiants, un message apparait et lui explique tout ^^ .<br/> Prenez la page <strong>connexionok.php</strong>, je vous rappelle rapidement son fonctionnement : <br/> on récupère ce qui est entré dans le formulaire, on vérifie que le pseudo et le mot de passe concordent, puis on attribue les variables de sessions.<br/> On va simplement vérifier que la valeur du champ membre_rang est nulle ; si c'est le cas, c'est que le membre est banni, et on ne déclare pas les variables de session. Ainsi, il ne sera pas connecté.<br/> Voyez plutôt :</p><p id="r-617708" data-claire-element-id="617708"><strong>Page : connexion.php</strong></p><pre id="r-617709" data-claire-element-id="617709"><code data-claire-semantic="html+php">&lt;?php
if ($data['membre_mdp'] == md5($_POST['password'])) // Acces OK !
{
    if ($data['membre_rang'] == 0) //Le membre est banni
    {
        $message=&quot;&lt;p&gt;Vous avez été banni, impossible de vous connecter sur ce forum&lt;/p&gt;&quot;;
    }
    else //Sinon c'est ok, on se connecte
    {
        $_SESSION['pseudo'] = $data['membre_pseudo'];
        $_SESSION['level'] = $data['membre_rang'];
	$_SESSION['id'] = $data['membre_id'];

       
        $message = '&lt;p&gt;Bienvenue '.$_SESSION['pseudo'].', vous êtes maintenant connecté !&lt;/p&gt; &lt;br /&gt;
        &lt;p&gt;Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à la page d accueil&lt;/p&gt;';
    }
}
?&gt;</code></pre><p id="r-617710" data-claire-element-id="617710">Vous devez normalement reconnaitre ce morceau de code : ce que j'ai fait, c'est ajouter une condition comme je l'ai expliqué plus haut.</p><p id="r-617711" data-claire-element-id="617711">Attention toutefois, le membre est banni et ne peut donc pas se connecter : ce n'est pas pour ça qu'il lui est impossible de visiter le forum en tant que visiteur &quot;simple&quot;, on parle d'ailleurs souvent de lecture seule pour dire bannissement.</p><div id="r-617713" data-claire-element-id="617713" data-claire-semantic="question"><p id="r-617712" data-claire-element-id="617712">Mais en fait, qu'est-ce qui l'empêche de recréer un compte ?</p></div><p id="r-617714" data-claire-element-id="617714">Rien... si ce n'est son adresse e-mail. A vrai dire, il est difficile de vraiment empêcher un membre de revenir : tout ce que vous pouvez espérer, c'est qu'il se rachètera ^^ .<br/> Cependant, il existe une méthode qui vaut ce qu'elle vaut : faire une table reliant les id des membres bannis et leurs adresses IP. Ainsi, vous pouvez faire une vérification sur l'adresse IP au moment de la connexion, et surtout de l'enregistrement. Mais en aucun cas cela ne va l'empêcher de revenir, il lui suffira de changer son adresse IP. C'est simplement une vérification de plus.</p><p id="r-617715" data-claire-element-id="617715">Voilà, nous venons de voir un statut assez spécial qui est celui d'un membre déchu :p . Si je dis <em>statut</em>, c'est parce qu'il s'agit en fait, comme vous l'avez vu, du niveau d'autorisation le plus bas possible.</p><p id="r-617716" data-claire-element-id="617716">Avant de conclure ce chapitre, j'aimerais que nous voyions rapidement comment permettre aux modos et aux admins de poster des <strong>annonces</strong>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
<span class="arrow"></span>
<span class="next">Faire un forum VIP</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
<span class="next">Les annonces</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesannonces"></a><h2>Les annonces</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
<span class="arrow"></span>
<span class="next">Le bannissement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
<span class="next">Remarques</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617718" data-claire-element-id="617718">Cette partie est très courte, je vous rassure : il faut simplement placer une petite vérification sur le formulaire de la page <strong>poster.php</strong>, et une autre sur <strong>postok.php</strong>.<br/> Pour éviter une trop grande prolifération des annonces, seuls les modérateurs (ou les administrateurs, de toute façon, eux, ils peuvent tout faire :p ) pourront en poster. Nous allons donc reprendre la fin du formulaire de la partie du switch concernant les <strong>nouveaux topics</strong>, et la modifier comme ceci :</p><p id="r-617719" data-claire-element-id="617719"><strong>Page : poster.php</strong></p><pre id="r-617720" data-claire-element-id="617720"><code data-claire-semantic="html+php">&lt;textarea cols=80 rows=8 id=&quot;message&quot; name=&quot;message&quot;&gt;&lt;/textarea&gt;
&lt;br /&gt;
&lt;?php
if (verif_auth($data['auth_annonce']))
{
    ?&gt;
    &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;mess&quot; value=&quot;Annonce&quot; /&gt;Annonce&lt;/label&gt;
    &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;mess&quot; value=&quot;Message&quot; checked=&quot;checked&quot; /&gt;Topic&lt;/label&gt;&lt;br /&gt;
    &lt;?php
}
?&gt;
&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
&lt;input type=&quot;reset&quot; name =&quot;Effacer&quot; value =&quot;Effacer&quot; /&gt;
&lt;/form&gt;&lt;/p&gt;</code></pre><p id="r-617721" data-claire-element-id="617721">Ainsi, un membre normal ne voit pas qu'il y a le choix, il ne peut que poster un topic &quot;normal&quot;. La variable de $_POST['mess'] est donc nulle (je vous rappelle que, dans la base de données, sa valeur par défaut est celle d'un topic normal, c'est pourquoi il n'est pas nécessaire de préciser davantage).<br/> En revanche, un modérateur a le choix, lui. Enfin je m'arrête là, je pense que vous avez compris l'idée.</p><p id="r-617722" data-claire-element-id="617722">Vous remarquez toutefois qu'il y a une séparation entre les champs auth_annonce et auth_modo, c'est-à-dire que si vous voulez, vous pouvez permettre à n'importe quelle catégorie de membres de poster une annonce sur un forum précis.</p><p id="r-617723" data-claire-element-id="617723">Il faut à présent se rendre sur la page postok.php : en effet, même si la valeur de $_POST['mess'] ne peut être remplie que par les personnes autorisées, il n'est pas exclu qu'un membre arrive à contourner le problème en utilisant un formulaire qui utilise postok.php comme page de traitement. Il pourrait alors poster une annonce. Pour éviter ça, on va simplement placer une vérification dans la partie <em>nouveautopic</em> de la page <em>postok</em>.<br/> Vous pouvez par exemple faire comme ceci :</p><pre id="r-617724" data-claire-element-id="617724"><code data-claire-semantic="html+php">&lt;?php
if (!verif_auth($data['auth_annonce']) &amp;&amp; isset($_POST['mess']))
{
    exit('&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;');
}
?&gt;</code></pre><p id="r-617725" data-claire-element-id="617725">Et voilà le travail. :p</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
<span class="arrow"></span>
<span class="next">Le bannissement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
<span class="next">Remarques</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Remarques"></a><h2>Remarques</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
<span class="arrow"></span>
<span class="next">Les annonces</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">
<span class="next">TP : Modérer le forum</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617727" data-claire-element-id="617727">Juste quelques mots avant que je vous lâche : ce chapitre a été simplifié au maximum mais il n'est pas parfait ; je vais vous donner quelques idées pour améliorer et personnaliser ce système.</p><p id="r-617728" data-claire-element-id="617728">Si vous avez bien regardé, il est impossible d'attribuer des modérateurs différents sur chaque forum (comme sur phpbb), c'est-à-dire que les modérateurs ont des droits spéciaux sur <strong>tous</strong> les forums.</p><p id="r-617729" data-claire-element-id="617729">Ce que vous pouvez faire, c'est créer des groupes, qui ont des privilèges différents (par exemple, le groupe des newsers qui ont la possibilité de modérer le forum news, mais qui restent des membres &quot;normaux&quot; partout ailleurs).<br/> Pour cela, il vous faut plusieurs tables supplémentaires :</p><p id="r-617730" data-claire-element-id="617730">- une table forum_groupes du style<br/>group_id, group_name, group_logo, etc.<br/> - une table forum_groupes_droits du style<br/>group_id, forum_id, group_droit.</p><p id="r-617731" data-claire-element-id="617731">Du coup, si on reprend l'exemple des newsers (oui, j'y tiens ^^ ), on aurait :</p><p id="r-617732" data-claire-element-id="617732"><cite>Citation : Pas de titre</cite></p><blockquote id="r-617734" data-claire-element-id="617734"><p id="r-617733" data-claire-element-id="617733">Table forum_groupes : 5, Newsers, newser.jpg<br/> Table forum_groupes_droits : 5, 1, 3</p></blockquote><p id="r-617735" data-claire-element-id="617735">Je rappelle que 3 équivaut au niveau de modération.<br/> 5 est l'id du groupes : Newsers et 1 est l'id du forum de news.</p><p id="r-617736" data-claire-element-id="617736">Il ne faudra alors plus se baser sur la variable $lvl pour connaître le niveau d'autorisation d'un membre, mais sur le résultat d'une requête qui pourrait ressembler à ça :</p><pre id="r-617737" data-claire-element-id="617737"><code data-claire-semantic="sql">SELECT group_droit FROM forum_membres
LEFT JOIN forum_groupes_droits
ON forum_groupes_droits.group_id = forum_membres.membre_rang
WHERE membre_id = :id');</code></pre><p id="r-617738" data-claire-element-id="617738">Ainsi, vous avez complexifié un peu le système d'autorisation de votre forum.<br/> L'avantage énorme qu'on en tire est qu'on n'est plus limités dans le nombre de groupes. On peut très bien atteindre le groupe avec l'id 39 !</p><div id="r-617740" data-claire-element-id="617740" data-claire-semantic="question"><p id="r-617739" data-claire-element-id="617739">Oui, mais du coup les newsers (puisqu'ils ont l'id 5 dans ton exemple) seront plus importants que les admins !</p></div><p id="r-617741" data-claire-element-id="617741">C'est vrai si l'on continue à garder l'ancienne méthode (enfin, pas si ancienne quand même :p ) en utilisant la fonction verif_auth. Mais il faut sortir de ce concept, l'id d'un groupe ne sert à présent qu'à l'identifier, et la table forum_groupes_droits nous informe sur son niveau d'accès sur le forum en question.</p><h2 id="r-afficher-les-droits-du-membre" data-claire-element-id="617748">Afficher les droits du membre !</h2><p id="r-617742" data-claire-element-id="617742">Une dernière remarque, il peut être utile pour plus de clarté d'afficher sur un pied de page les droits du membre sur le forum/topic où il se trouve. <br/> En plus de ça, vous allez voir dans le prochain chapitre que vous allez pouvoir mettre en place une véritable boîte de modération qu'il peut être utile de placer ici.</p><p id="r-617743" data-claire-element-id="617743">Voici par exemple à quoi pourrait ressembler ce footer sur la page voirtopic.php</p><pre id="r-617744" data-claire-element-id="617744"><code data-claire-semantic="html+php">&lt;div id=&quot;footer&quot;&gt;
&lt;?php
echo '&lt;h2&gt;Options de modération&lt;/h2&gt;';

$query=$db-&gt;prepare('SELECT auth_view, auth_modo, auth_post FROM forum_forum WHERE forum_id=:forum');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();
$view = (verif_auth($data['auth_view']))? 'Vous pouvez &lt;b&gt;voir&lt;/b&gt; ce topic':'Vous &lt;i&gt;ne&lt;/i&gt; pouvez &lt;i&gt;pas&lt;/i&gt; &lt;b&gt;voir&lt;/b&gt; ce topic';
$post = (verif_auth($data['auth_post']))? 'Vous pouvez &lt;b&gt;répondre&lt;/b&gt; à ce topic':'Vous &lt;i&gt;ne&lt;/i&gt; pouvez &lt;i&gt;pas&lt;/i&gt; &lt;b&gt;répondre&lt;/b&gt; à ce topic';
$modo = (verif_auth($data['auth_modo']))? 'Vous pouvez &lt;b&gt;modérer&lt;/b&gt; ce topic':'Vous &lt;i&gt;ne&lt;/i&gt; pouvez &lt;i&gt;pas&lt;/i&gt; &lt;b&gt;modérer&lt;/b&gt; ce topic';
echo '&lt;p&gt;'.$view.'&lt;br /&gt;'.$post.'&lt;br /&gt;'.$modo.'&lt;/p&gt;';
$query-&gt;CloseCursor();
?&gt;
&lt;/div&gt;</code></pre><p id="r-617745" data-claire-element-id="617745">Voilà pour cette histoire d'autorisations. On a ainsi commencé tranquillement dans les pages d'administration, puisque vous voyez qu'il ne s'agit que de petites modifications.</p><p id="r-617746" data-claire-element-id="617746">A l'avenir, lorsque vous voudrez créer un forum, il faudra renseigner la valeur des champs auth_view, auth_post, etc. pour une plus grande liberté.</p><p id="r-617747" data-claire-element-id="617747">La suite du tuto est un TP : elle concerne la partie modération, suppression de topics ou édition. Dès que vous être partants, on y va !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
<span class="arrow"></span>
<span class="next">Les annonces</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">
<span class="next">TP : Modérer le forum</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="TPModrerleforum"></a><h2>TP : Modérer le forum</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
<span class="arrow"></span>
<span class="next">Remarques</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
<span class="next">Objectif</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617751" data-claire-element-id="617751">Jusqu'ici, vous pouviez ajouter un forum, supprimer un message ou autre en vous rendant sur phpmyadmin.... Pas très pratique ;) , c'est pourquoi nous allons voir ici comment simplifier tout cela avec du php.</p><div id="r-617753" data-claire-element-id="617753" data-claire-semantic="question"><p id="r-617752" data-claire-element-id="617752">Mais pourquoi faire un TP ?</p></div><p id="r-617754" data-claire-element-id="617754">Dans cette première partie, nous allons nous intéresser à la modération du forum, c'est-à-dire à la façon dont certains membres (les modérateurs, pour ne pas les citer :p ) pourront modifier les messages.<br/> Mais au final, le code n'est pas trop compliqué, et comme j'ai peur que vous ne vous ennuyiez, je vais vous faire bosser un peu ^^ .</p><p id="r-617755" data-claire-element-id="617755">Mais ne vous en faites pas, si vous n'avez aucune idée de l'endroit par où commencer, on va faire ça ensemble quand même :-° .</p>
</div><a name="Objectif"></a><h2>Objectif</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">
<span class="arrow"></span>
<span class="next">TP : Modérer le forum</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
<span class="next">Conseils</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617756" data-claire-element-id="617756">Avant de se lancer corps et âmes dans les codes, voyons plutôt ce que l'on veut réaliser.</p><h3 id="r-editer-un-message" data-claire-element-id="617758">Éditer un message</h3><p id="r-617757" data-claire-element-id="617757">Dans la page voirtopic.php, sur chaque post, il doit être possible si l'on est modérateur, administrateur ou simplement le créateur du message de le modifier.<br/> Pour cela, nous allons mettre une petite image <em>édition</em> qui renverra à la page poster.php. Finalement, ça sera assez similaire au script pour poster une réponse, sauf que dans la zone de texte, on écrira le message à éditer.</p><h3 id="r-supprimer-un-message" data-claire-element-id="617760">Supprimer un message</h3><p id="r-617759" data-claire-element-id="617759">Je passe rapidement là-dessus : tout comme il est possible de modifier un de ses messages, il est normal que l'on puisse le supprimer. A côté du bouton 'édition', il y aura un bouton suppression dont je vous laisse deviner l'action. :D</p><h3 id="r-supprimer-un-topic" data-claire-element-id="617762">Supprimer un topic</h3><p id="r-617761" data-claire-element-id="617761">Si on veut y aller carrément, il faut aussi prévoir une suppression de tout le topic o_O . On ajoute donc une option pour cela dans la page voirtopic.php.<br/> En général, cette option ne peut être utilisée que par les modérateurs, le créateur du topic n'a pas ce droit ; cela dit, vous faites comme vous voulez sur votre forum ^^ .</p><h3 id="r-deplacer-un-topic" data-claire-element-id="617764">Déplacer un topic</h3><p id="r-617763" data-claire-element-id="617763">Voilà une option plus intéressante : la possibilité de pouvoir déplacer un topic vers un autre forum. Encore une fois, seuls les modérateurs peuvent faire ceci. Il va falloir ajouter une liste déroulante à la page voirtopic.php qui affichera tous les forums vers lesquels on peut envoyer le topic.</p><h3 id="r-verrouiller-un-topic" data-claire-element-id="617771">Verrouiller un topic</h3><p id="r-617765" data-claire-element-id="617765">Un modérateur a également la possibilité de verrouiller ou de déverrouiller un topic, si jamais celui-ci tourne mal. Pour cela, encore un bouton / lien dans la page voirtopic.php ;) .<br/> Il faudra aussi penser à changer un peu la page voirforum.php, en mettant une icône spéciale si le topic est verrouillé.</p><aside id="r-617767" data-claire-element-id="617767" data-claire-semantic="warning"><p id="r-617766" data-claire-element-id="617766">Verrouiller / Déverrouiller un topic nécessite l'ajout d'un champ dans la table forum_topic (je l'ai appelé topic_locked, et il peut prendre les valeurs 1 ou 0).</p></aside><p id="r-617768" data-claire-element-id="617768">Voici la requête :</p><pre id="r-617769" data-claire-element-id="617769"><code data-claire-semantic="sql">ALTER TABLE `forum_topic` ADD `topic_locked` ENUM( '0', '1' ) NOT NULL AFTER `topic_post` ;</code></pre><p id="r-617770" data-claire-element-id="617770">Voilà les fonctions qu'il va falloir réaliser dans ce tp ; avant que je vous lâche en pleine nature, nous allons voir quelques conseils.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">
<span class="arrow"></span>
<span class="next">TP : Modérer le forum</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
<span class="next">Conseils</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Conseils"></a><h2>Conseils</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
<span class="arrow"></span>
<span class="next">Objectif</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
<span class="next">Correction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617773" data-claire-element-id="617773">Normalement, vous n'avez pas besoin de créer une nouvelle page pour réaliser le système de modération. <strong>Le code que vous allez écrire se situera dans les pages poster.php, postok.php et voirtopic.php</strong>. En fait, il suffira d'ajouter une option à votre switch déjà bien garni sur les pages poster.php et postok.php.</p><p id="r-617774" data-claire-element-id="617774">La chose la plus importante de votre script sera de bien vérifier les permissions. Vous venez de régler tout ce qu'il faut sur la question dans le chapitre précédent. Si vous vous souvenez, le seul champ que l'on a pas utilisé est auth_modo, il suffit donc de faire ceci avant de commencer quoi que ce soit.</p><pre id="r-617775" data-claire-element-id="617775"><code data-claire-semantic="html+php">&lt;?
if (verif_auth($data['auth_modo']))
{
?&gt;</code></pre><aside id="r-617777" data-claire-element-id="617777" data-claire-semantic="warning"><p id="r-617776" data-claire-element-id="617776">Ne pas afficher le bouton / lien vers une page ne suffit en aucun cas à sécuriser son accès, vous allez devoir faire la même vérification sur la page ciblée par le lien.</p></aside><p id="r-617778" data-claire-element-id="617778">Pour ce qui est de la suppression et de l'édition, je pense que ça vous sera assez facile. Pour la suppression, vous pouvez vous baser sur le système de MP vu précédemment. Quant à l'édition, c'est exactement le même principe que celui utilisé pour modifier son profil, sauf qu'on s'en sert ici pour un message ^^ .</p><h3 id="r-un-mot-sur-le-deplacement" data-claire-element-id="617782">Un mot sur le déplacement</h3><p id="r-617779" data-claire-element-id="617779">Déplacer un topic doit vous paraître assez difficile à réaliser : pourtant, ça sera sûrement le plus facile. Il faut que grâce à une boucle vous récupériez les id et les noms des forums qui ne sont pas ceux du topic sur lequel on se trouve.</p><pre id="r-617780" data-claire-element-id="617780"><code data-claire-semantic="sql">SELECT forum_id, forum_name FROM forum_forum WHERE forum_id &lt;&gt; X</code></pre><p id="r-617781" data-claire-element-id="617781">Je rappelle que le <strong>&lt;&gt;</strong> est équivalent au <strong>!=</strong>, mais pour les bases de données, il faut utiliser <strong>&lt;&gt;</strong> (cela dit, mysql comprend les 2).<br/> A la place de X, vous mettrez l'id du forum actuel. Ensuite, grâce à une boucle, vous listez les forums obtenus par la requête (vous pouvez même les regrouper par catégorie en utilisant la balise &lt;optgroup&gt; ;) ).<br/> Ensuite, vous faites un bouton envoyer qui mène à la page postok.php avec la valeur du forum sélectionné.</p><h3 id="r-et-un-mot-sur-le-de-verrouillage" data-claire-element-id="617789">Et un mot sur le (dé)verrouillage</h3><p id="r-617783" data-claire-element-id="617783">Le verrouillage de topic va sans doute vous arrêter un moment pour une raison simple : c'est qu'il faut modifier des tas de choses.</p><p id="r-617784" data-claire-element-id="617784">Déjà, pour la base de données :</p><pre id="r-617785" data-claire-element-id="617785"><code data-claire-semantic="sql">ALTER TABLE `forum_topic` ADD `topic_locked` enum('0','1')  AFTER `topic_post`</code></pre><p id="r-617786" data-claire-element-id="617786">1 signifie verrouillé, 0 signifie ouvert ; grâce à ces valeurs, il va être facile de distinguer les cas et d'afficher une icône en fonction.<br/> Reprenons la requête de la page voirforum.php.</p><pre id="r-617787" data-claire-element-id="617787"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT forum_topic.topic_id, topic_titre, topic_createur, topic_vu, topic_post, topic_time, topic_last_post,
Mb.membre_pseudo AS membre_pseudo_createur, post_createur, post_time, Ma.membre_pseudo AS membre_pseudo_last_posteur, post_id FROM forum_topic 
LEFT JOIN forum_membres Mb ON Mb.membre_id = forum_topic.topic_createur
LEFT JOIN forum_post ON forum_topic.topic_last_post = forum_post.post_id
LEFT JOIN forum_membres Ma ON Ma.membre_id = forum_post.post_createur    
WHERE topic_genre = &quot;Annonce&quot; AND forum_topic.forum_id = :forum 
ORDER BY topic_last_post DESC');
?&gt;</code></pre><p id="r-617788" data-claire-element-id="617788">Ah, souvenirs ... ^^ Enfin, quoiqu'il en soit, il va falloir ajouter forum_topic.topic_locked dans les champs à retourner. Ensuite, un simple if permettra de modifier l'image.</p><h3 id="r-un-tout-petit-mot-sur-l-edition" data-claire-element-id="617793">Un tout petit mot sur l'édition</h3><p id="r-617790" data-claire-element-id="617790">Je sais que j'ai dit plus haut que ça serait simple mais je vais quand même vous indiquer comment faire pour écrire un lien pointant directement vers le post édité.<br/> Dans le cas d'une réponse c'est simple puisqu'il s'agit forcément du dernier post envoyé donc pour obtenir la page il suffit de prendre la dernière.<br/> Ici c'est un peu différent, alors on est obligé de compter... et bien comptons ^^</p><pre id="r-617791" data-claire-element-id="617791"><code data-claire-semantic="html+php">&lt;?
//Cette requête va récupérer le nombre de posts avant celui que vous éditez
$query= $db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_post 
WHERE topic_id = :topic AND post_time &lt; LE POST_TIME DU MESSAGE');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$data = $query-&gt;fetch();

//Les 3 lignes habituelles
$nombreDeMessagesParPage = 15;
$nbr_post = $data['nbr']+1;
$page = ceil($nbr_post / $nombreDeMessagesParPage);

echo'&lt;p&gt;Votre message a bien été édité!&lt;br /&gt;&lt;br /&gt;
Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&amp;amp;page='.$page.'#p_'.$post.'&quot;&gt;ici&lt;/a&gt; pour le voir&lt;/p&gt;';
?&gt;</code></pre><p id="r-617792" data-claire-element-id="617792">Et voilà ça devrait marcher.</p><h3 id="r-une-derniere-chose-importante" data-claire-element-id="617796">Une dernière chose importante !</h3><p id="r-617794" data-claire-element-id="617794">Pour qu'il n'y ait pas de problème, il faut que vous pensiez à tout ce que pourrait impliquer la suppression d'un topic ou son déplacement. Par exemple, lorsque sur la page d'index, vous lisez 203 messages dans un forum, il ne faut pas oublier d'enlever un à cette valeur si vous avez décidé d'y enlever un post.</p><p id="r-617795" data-claire-element-id="617795">Voilà, normalement vous êtes parés pour commencer : je vais alors aller lire le journal, tchao ! :D</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
<span class="arrow"></span>
<span class="next">Objectif</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
<span class="next">Correction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Correction"></a><h2>Correction</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
<span class="arrow"></span>
<span class="next">Conseils</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">
<span class="next">Administration Partie I</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<div id="r-617799" data-claire-element-id="617799" data-claire-semantic="question"><p id="r-617798" data-claire-element-id="617798">Euh... T'es là ? :euh:</p></div><p id="r-617800" data-claire-element-id="617800">Quoi, déjà ? :p</p><p id="r-617801" data-claire-element-id="617801">Bon bah, voyons ensemble le résultat : je vous rappelle que vous ne pouvez pas encore promouvoir des membres modérateurs, donc il faut le faire en passant par la base de données (ce n'est qu'une question de temps pour que l'on y arrive ^^ ).</p><p id="r-617802" data-claire-element-id="617802">Allez, on commence tout de suite avec l'édition de message !</p><aside id="r-617804" data-claire-element-id="617804" data-claire-semantic="error"><p id="r-617803" data-claire-element-id="617803">Si vous n'avez pas réussi à réaliser ces systèmes, il serait plus bénéfique que vous essayiez de comprendre vos erreurs grâce à mes scripts, plutôt que de laisser complètement tomber ce que vous avez fait.<br/> En tout cas, ne faites pas de copier / coller <em>aveugle</em>, et n'oubliez pas qu'un forum est là pour vous aider !</p></aside><aside id="r-617806" data-claire-element-id="617806" data-claire-semantic="warning"><p id="r-617805" data-claire-element-id="617805">Dans les codes qui suivent, je n'ai pas systématiquement déclaré mes constantes, en particulier en lien avec la fonction erreur. Vous êtes grands et vous pouvez le faire seuls !</p></aside><h2 id="r-editer-un-message-1" data-claire-element-id="617819">Éditer un message</h2><p id="r-617807" data-claire-element-id="617807">Si vous avez bien suivi tout ce qui a été vu jusqu'ici, ça n'a pas dû vous poser trop de difficultés ;) .</p><h3 id="r-page-poster-php-1" data-claire-element-id="617814">Page poster.php</h3><p id="r-617808" data-claire-element-id="617808">Déjà le code dans la page poster.php.</p><pre id="r-617809" data-claire-element-id="617809"><code data-claire-semantic="html+php">&lt;?php
case &quot;edit&quot;: //Si on veut éditer le post
    //On récupère la valeur de p
    $post = (int) $_GET['p'];
    echo'&lt;h1&gt;Edition&lt;/h1&gt;';
 
    //On lance enfin notre requête
 
    $query=$db-&gt;prepare('SELECT post_createur, post_texte, auth_modo FROM forum_post
    LEFT JOIN forum_forum ON forum_post.post_forum_id = forum_forum.forum_id
    WHERE post_id=:post');
    $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();

    $text_edit = $data['post_texte']; //On récupère le message

    //Ensuite on vérifie que le membre a le droit d'être ici (soit le créateur soit un modo/admin) 
    if (!verif_auth($data['auth_modo']) &amp;&amp; $data['post_createur'] != $id)
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_EDIT);
    }
    else //Sinon ça roule et on affiche la suite
    {
        //Le formulaire de postage
        ?&gt;
        &lt;form method=&quot;post&quot; action=&quot;postok.php?action=edit&amp;amp;p=&lt;?php echo $post ?&gt;&quot; name=&quot;formulaire&quot;&gt;
        &lt;fieldset&gt;&lt;legend&gt;Mise en forme&lt;/legend&gt;
        &lt;input type=&quot;button&quot; id=&quot;gras&quot; name=&quot;gras&quot; value=&quot;Gras&quot; onClick=&quot;javascript:bbcode('[g]', '[/g]');return(false)&quot; /&gt;
        &lt;input type=&quot;button&quot; id=&quot;italic&quot; name=&quot;italic&quot; value=&quot;Italic&quot; onClick=&quot;javascript:bbcode('[i]', '[/i]');return(false)&quot; /&gt;
        &lt;input type=&quot;button&quot; id=&quot;souligné&quot; name=&quot;souligné&quot; value=&quot;Souligné&quot; onClick=&quot;javascript:bbcode('[s]', '[/s]');return(false)&quot;/&gt;
        &lt;input type=&quot;button&quot; id=&quot;lien&quot; name=&quot;lien&quot; value=&quot;Lien&quot; onClick=&quot;javascript:bbcode('[url]', '[/url]');return(false)&quot; /&gt;
        &lt;br /&gt;&lt;br /&gt;
        &lt;img src=&quot;./images/smileys/heureux.gif&quot; title=&quot;heureux&quot; alt=&quot;heureux&quot; onClick=&quot;javascript:smilies(':D');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/lol.gif&quot; title=&quot;lol&quot; alt=&quot;lol&quot; onClick=&quot;javascript:smilies(':lol:');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/triste.gif&quot; title=&quot;triste&quot; alt=&quot;triste&quot; onClick=&quot;javascript:smilies(':triste:');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/cool.gif&quot; title=&quot;cool&quot; alt=&quot;cool&quot; onClick=&quot;javascript:smilies(':frime:');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/rire.gif&quot; title=&quot;rire&quot; alt=&quot;rire&quot; onClick=&quot;javascript:smilies('XD');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/confus.gif&quot; title=&quot;confus&quot; alt=&quot;confus&quot; onClick=&quot;javascript:smilies(':s');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/choc.gif&quot; title=&quot;choc&quot; alt=&quot;choc&quot; onClick=&quot;javascript:smilies(':O');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/question.gif&quot; title=&quot;?&quot; alt=&quot;?&quot; onClick=&quot;javascript:smilies(':interrogation:');return(false)&quot; /&gt;
        &lt;img src=&quot;./images/smileys/exclamation.gif&quot; title=&quot;!&quot; alt=&quot;!&quot; onClick=&quot;javascript:smilies(':exclamation:');return(false)&quot; /&gt;
        &lt;/fieldset&gt;
 
        &lt;fieldset&gt;&lt;legend&gt;Message&lt;/legend&gt;&lt;textarea cols=&quot;80&quot; rows=&quot;8&quot; id=&quot;message&quot; name=&quot;message&quot;&gt;&lt;?php echo $text_edit ?&gt;
        &lt;/textarea&gt;
        &lt;/fieldset&gt;
        &lt;p&gt;
        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Editer !&quot; /&gt;
        &lt;input type=&quot;reset&quot; name = &quot;Effacer&quot; value = &quot;Effacer&quot;/&gt;&lt;/p&gt;
        &lt;/form&gt;
        &lt;?php
    }
break; //Fin de ce cas :o
?&gt;</code></pre><p id="r-617810" data-claire-element-id="617810">Ce code doit être écrit dans le switch de la page poster.php.</p><p id="r-617811" data-claire-element-id="617811">Ce que l'on fait ici, c'est simplement relancer le formulaire pour poster, mais on pré-remplit la case message avant au final ^^ .</p><p id="r-617812" data-claire-element-id="617812">Vous devez aussi modifier le haut de la page poster.php, en effet les droits d'accès dans le cas de la modération sont valables pour le modérateur et le créateur du message, il faut donc rajouter cette vérification.</p><p id="r-617813" data-claire-element-id="617813">Passons au traitement du message :</p><h3 id="r-page-postok-php" data-claire-element-id="617818">Page postok.php</h3><p id="r-617815" data-claire-element-id="617815">Ce code est assez court, assez simple et en plus, il ressemble au précédent :-°</p><pre id="r-617816" data-claire-element-id="617816"><code data-claire-semantic="html+php">&lt;?php
case &quot;edit&quot;: //Si on veut éditer le post
    //On récupère la valeur de p
    $post = (int) $_GET['p'];
 
    //On récupère le message
    $message = $_POST['message'];

    //Ensuite on vérifie que le membre a le droit d'être ici (soit le créateur soit un modo/admin)
    $query=$db-&gt;prepare('SELECT post_createur, post_texte, post_time, topic_id, auth_modo
    FROM forum_post
    LEFT JOIN forum_forum ON forum_post.post_forum_id = forum_forum.forum_id
    WHERE post_id=:post');
    $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
    $query-&gt;execute();
    $data1 = $query-&gt;fetch();
    $topic = $data1['topic_id'];

    //On récupère la place du message dans le topic (pour le lien)
    $query = $db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_post 
    WHERE topic_id = :topic AND post_time &lt; '.$data1['post_time']);
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute();
    $data2=$query-&gt;fetch();

    if (!verif_auth($data1['auth_modo'])&amp;&amp; $data1['post_createur'] != $id)
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_EDIT);    
    }
    else //Sinon ça roule et on continue
    {
        $query=$db-&gt;prepare('UPDATE forum_post SET post_texte =  :message WHERE post_id = :post');
        $query-&gt;bindValue(':message',$message,PDO::PARAM_STR);
        $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
        $query-&gt;execute();
        $nombreDeMessagesParPage = 15;
        $nbr_post = $data2['nbr']+1;
        $page = ceil($nbr_post / $nombreDeMessagesParPage);
        echo'&lt;p&gt;Votre message a bien été édité!&lt;br /&gt;&lt;br /&gt;
        Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;br /&gt;
        Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&amp;amp;page='.$page.'#p_'.$post.'&quot;&gt;ici&lt;/a&gt; pour le voir&lt;/p&gt;';
        $query-&gt;CloseCursor();
    }
break;
?&gt;</code></pre><p id="r-617817" data-claire-element-id="617817">Voilà pour ce qui est de l'édition. Quand tout est terminé, on affiche un message pour annoncer la bonne nouvelle.<br/> Quant à l'affichage du lien vers le dernier message, il est un peu étrange. En fait la difficulté est que le message édité n'est pas forcément le dernier du topic, il faut donc calculer sa place pour ensuite connaitre la page et enfin mettre le bon lien.</p><h2 id="r-supprimer-pirate" data-claire-element-id="617842">Supprimer :pirate:</h2><p id="r-617820" data-claire-element-id="617820">On passe au système suivant, la suppression d'un post et d'un topic. C'est à peu de choses près le même script que celui de la suppression d'un mp.</p><h3 id="r-page-poster-php-2" data-claire-element-id="617823">Page poster.php</h3><pre id="r-617821" data-claire-element-id="617821"><code data-claire-semantic="html+php">&lt;?php
case &quot;delete&quot;: //Si on veut supprimer le post
    //On récupère la valeur de p
    $post = (int) $_GET['p'];
    //Ensuite on vérifie que le membre a le droit d'être ici
    echo'&lt;h1&gt;Suppression&lt;/h1&gt;';
    $query=$db-&gt;prepare('SELECT post_createur, auth_modo
    FROM forum_post
    LEFT JOIN forum_forum ON forum_post.post_forum_id = forum_forum.forum_id
    WHERE post_id= :post');
    $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
    $query-&gt;execute();
    $data = $query-&gt;fetch();
 
    if (!verif_auth($data['auth_modo']) &amp;&amp; $data['post_createur'] != $id)
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_DELETE); 
    }
    else //Sinon ça roule et on affiche la suite
    {
        echo'&lt;p&gt;Êtes vous certains de vouloir supprimer ce post ?&lt;/p&gt;';
        echo'&lt;p&gt;&lt;a href=&quot;./postok.php?action=delete&amp;amp;p='.$post.'&quot;&gt;Oui&lt;/a&gt; ou &lt;a href=&quot;./index.php&quot;&gt;Non&lt;/a&gt;&lt;/p&gt;';
    }
    $query-&gt;CloseCursor();
break;
?&gt;</code></pre><p id="r-617822" data-claire-element-id="617822">On retrouve beaucoup de similitudes avec la partie édition dans la vérification des droits du membre. Vous voyez par ailleurs que cette fois, on demande de confirmer la suppression avant de tout envoyer aux oubliettes.</p><h3 id="r-page-postok-php-1" data-claire-element-id="617831">Page postok.php</h3><p id="r-617824" data-claire-element-id="617824">Il ne reste plus qu'à traiter le message, en le supprimant sans pitié.</p><div id="r-617826" data-claire-element-id="617826" data-claire-semantic="question"><p id="r-617825" data-claire-element-id="617825">Eh, mais attends :o ! Comment on fait si c'est le premier post ou le dernier post d'un topic, faudra changer la valeur de topic_last_post et topic_first_post o_O ?</p></div><p id="r-617827" data-claire-element-id="617827">En fait pas tout à fait, c'est là qu'est la petite difficulté. Je m'explique : imaginez qu'on essaye de supprimer le premier post d'un topic. Si on laisse le topic en vie, ça ne va pas le faire... Il faudra donc le supprimer lui aussi. Et si on essaye de supprimer le dernier, il faudra ne pas oublier de mettre à jour la valeur de topic_last_post !<br/> Puis il faudra aussi baisser la valeur de topic_post et de forum_post, et mettre à jour forum_last_post_id.</p><p id="r-617828" data-claire-element-id="617828">Bon bah au final, ça fait un code assez compliqué, tout ça ...</p><pre id="r-617829" data-claire-element-id="617829"><code data-claire-semantic="html+php">&lt;?php
case &quot;delete&quot;: //Si on veut supprimer le post
    //On récupère la valeur de p
    $post = (int) $_GET['p'];
    $query=$db-&gt;prepare('SELECT post_createur, post_texte, forum_id, topic_id, auth_modo
    FROM forum_post
    LEFT JOIN forum_forum ON forum_post.post_forum_id = forum_forum.forum_id
    WHERE post_id=:post');
    $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
    $query-&gt;execute();
    $data = $query-&gt;fetch();
    $topic = $data['topic_id'];
    $forum = $data['forum_id'];
	$poster = $data['post_createur'];

   
    //Ensuite on vérifie que le membre a le droit d'être ici 
    //(soit le créateur soit un modo/admin)
    if (!verif_auth($data['auth_modo']) &amp;&amp; $poster != $id)
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_DELETE); 
    }
    else //Sinon ça roule et on continue
    {
        
        //Ici on vérifie plusieurs choses :
        //est-ce un premier post ? Dernier post ou post classique ?
 
        $query = $db-&gt;prepare('SELECT topic_first_post, topic_last_post FROM forum_topic
        WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();
        $data_post=$query-&gt;fetch();
               
               
               
        //On distingue maintenant les cas
        if ($data_post['topic_first_post']==$post) //Si le message est le premier
        {
 
            //Les autorisations ont changé !
            //Normal, seul un modo peut décider de supprimer tout un topic
            if (!verif_auth($data['auth_modo']))
            {
                erreur('ERR_AUTH_DELETE_TOPIC');
            }

            //Il faut s'assurer que ce n'est pas une erreur
 
            echo'&lt;p&gt;Vous avez choisi de supprimer un post.
            Cependant ce post est le premier du topic. Voulez vous supprimer le topic ? &lt;br /&gt;
            &lt;a href=&quot;./postok.php?action=delete_topic&amp;amp;t='.$topic.'&quot;&gt;oui&lt;/a&gt; - &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;non&lt;/a&gt;
            &lt;/p&gt;';
            $query-&gt;CloseCursor();                     
        }
        elseif ($data_post['topic_last_post']==$post)  //Si le message est le dernier
        {
 
            //On supprime le post
            $query=$db-&gt;prepare('DELETE FROM forum_post WHERE post_id = :post');
            $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();
           
            //On modifie la valeur de topic_last_post pour cela on
            //récupère l'id du plus récent message de ce topic
            $query=$db-&gt;prepare('SELECT post_id FROM forum_post WHERE topic_id = :topic 
            ORDER BY post_id DESC LIMIT 0,1');
            $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
            $query-&gt;execute();
            $data=$query-&gt;fetch();             
            $last_post_topic=$data['post_id'];
            $query-&gt;CloseCursor();

            //On fait de même pour forum_last_post_id
            $query=$db-&gt;prepare('SELECT post_id FROM forum_post WHERE post_forum_id = :forum
            ORDER BY post_id DESC LIMIT 0,1');
            $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
            $query-&gt;execute();
            $data=$query-&gt;fetch();             
            $last_post_forum=$data['post_id'];
            $query-&gt;CloseCursor();   
                   
            //On met à jour la valeur de topic_last_post
			
            $query=$db-&gt;prepare('UPDATE forum_topic SET topic_last_post = :last
            WHERE topic_last_post = :post');
            $query-&gt;bindValue(':last',$last_post_topic,PDO::PARAM_INT);
            $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();
 
            //On enlève 1 au nombre de messages du forum et on met à       
            //jour forum_last_post
            $query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post - 1, forum_last_post_id = :last
            WHERE forum_id = :forum');
            $query-&gt;bindValue(':last',$last_post_forum,PDO::PARAM_INT);
            $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor(); 
                        
            //On enlève 1 au nombre de messages du topic
            $query=$db-&gt;prepare('UPDATE forum_topic SET  topic_post = topic_post - 1
            WHERE topic_id = :topic');
            $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor(); 
                       
            //On enlève 1 au nombre de messages du membre
            $query=$db-&gt;prepare('UPDATE forum_membres SET  membre_post = membre_post - 1
            WHERE membre_id = :id');
            $query-&gt;bindValue(':id',$poster,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();  
                        
            //Enfin le message
            echo'&lt;p&gt;Le message a bien été supprimé !&lt;br /&gt;
            Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;ici&lt;/a&gt; pour retourner au topic&lt;br /&gt;
            Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;/p&gt;';
 
        }
        else // Si c'est un post classique
        {
 
            //On supprime le post
            $query=$db-&gt;prepare('DELETE FROM forum_post WHERE post_id = :post');
            $query-&gt;bindValue(':post',$post,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();
                       
            //On enlève 1 au nombre de messages du forum
            $query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post - 1  WHERE forum_id = :forum');
            $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor(); 
                        
            //On enlève 1 au nombre de messages du topic
            $query=$db-&gt;prepare('UPDATE forum_topic SET  topic_post = topic_post - 1
            WHERE topic_id = :topic');
            $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor(); 
                       
            //On enlève 1 au nombre de messages du membre
            $query=$db-&gt;prepare('UPDATE forum_membres SET  membre_post = membre_post - 1
            WHERE membre_id = :id');
            $query-&gt;bindValue(':id',$data['post_createur'],PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();  
                        
            //Enfin le message
            echo'&lt;p&gt;Le message a bien été supprimé !&lt;br /&gt;
            Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;ici&lt;/a&gt; pour retourner au topic&lt;br /&gt;
            Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;/p&gt;';
        }
               
    } //Fin du else
break;
?&gt;</code></pre><p id="r-617830" data-claire-element-id="617830">Il faut distinguer les trois cas, ensuite on peut agir en fonction. De toute façon, il faudra toujours faire attention à ce genre de détails lorsque l'on travaillera sur les pages d'administration. Les tables sont liées entre elles par des valeurs comme topic_last_post, par exemple, il est important de penser à mettre celles-ci à jour également pour ne pas rompre la relation :) .</p><h3 id="r-concernant-la-suppression-d-un-topic" data-claire-element-id="617836">Concernant la suppression d'un topic</h3><p id="r-617832" data-claire-element-id="617832">Vous avez sûrement remarqué une chose assez étrange : si l'on décide de supprimer le premier post, j'avais dit qu'il fallait supprimer tout le topic. Mais alors pourquoi on ne le fait pas directement ? C'est une question de clarté, et puis ça permet d'éviter de virer un topic entier par erreur ;) . Ce qu'on fait alors, c'est qu'on redemande si c'est bien le topic qu'il faut supprimer ? Si oui, on va voir ce qu'il se passe, si non, on a eu chaud et on revient en arrière :p .</p><p id="r-617833" data-claire-element-id="617833">Voici donc la fin du code :</p><pre id="r-617834" data-claire-element-id="617834"><code data-claire-semantic="html+php">&lt;?php
case &quot;delete_topic&quot;:
    $topic = (int) $_GET['t'];
    $query=$db-&gt;prepare('SELECT forum_topic.forum_id, auth_modo
    FROM forum_topic
    LEFT JOIN forum_forum ON forum_topic.forum_id = forum_forum.forum_id
    WHERE topic_id=:topic');
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute();
    $data = $query-&gt;fetch();
    $forum = $data['forum_id'];
 
    //Ensuite on vérifie que le membre a le droit d'être ici 
    //c'est-à-dire si c'est un modo / admin
 
    if (!verif_auth($data['auth_modo']))
    {
        erreur('ERR_AUTH_DELETE_TOPIC');
    }
    else //Sinon ça roule et on continue
    {
        $query-&gt;CloseCursor();

        //On compte le nombre de post du topic
        $query=$db-&gt;prepare('SELECT topic_post FROM forum_topic WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();
        $data = $query-&gt;fetch();
        $nombrepost = $data['topic_post'] + 1;
        $query-&gt;CloseCursor();

        //On supprime le topic
        $query=$db-&gt;prepare('DELETE FROM forum_topic
        WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();
       
        //On enlève le nombre de post posté par chaque membre dans le topic
        $query=$db-&gt;prepare('SELECT post_createur, COUNT(*) AS nombre_mess FROM forum_post
        WHERE topic_id = :topic GROUP BY post_createur');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();

        while($data = $query-&gt;fetch())
        {
            $query=$db-&gt;prepare('UPDATE forum_membres
            SET membre_post = membre_post - :mess
            WHERE membre_id = :id');
            $query-&gt;bindValue(':mess',$data['nombre_mess'],PDO::PARAM_INT);
            $query-&gt;bindValue(':id',$data['post_createur'],PDO::PARAM_INT);
            $query-&gt;execute();
        }

        $query-&gt;CloseCursor();       
        //Et on supprime les posts !
        $query=$db-&gt;prepare('DELETE FROM forum_post WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 

        //Dernière chose, on récupère le dernier post du forum
        $query=$db-&gt;prepare('SELECT post_id FROM forum_post
        WHERE post_forum_id = :forum ORDER BY post_id DESC LIMIT 0,1');
        $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
        $query-&gt;execute();
        $data = $query-&gt;fetch();
 
        //Ensuite on modifie certaines valeurs :
        $query=$db-&gt;prepare('UPDATE forum_forum
        SET forum_topic = forum_topic - 1, forum_post = forum_post - :nbr, forum_last_post_id = :id
        WHERE forum_id = :forum');
        $query-&gt;bindValue(':nbr',$nombrepost,PDO::PARAM_INT);
        $query-&gt;bindValue(':id',$data['post_id'],PDO::PARAM_INT);
        $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
        $query-&gt;execute(); 
        $query-&gt;CloseCursor();

        //Enfin le message
        echo'&lt;p&gt;Le topic a bien été supprimé !&lt;br /&gt;
        Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;/p&gt;';

    } //Fin du else
break;
?&gt;</code></pre><p id="r-617835" data-claire-element-id="617835">Et là, c'est gagné. Du coup si vous avez suivi, il est très facile de faire un lien pour supprimer directement tout le topic (lien que vous pouvez placer dans la page voirtopic, par exemple ;) ).</p><h3 id="r-retour-sur-la-modification-du-nombre-de-post" data-claire-element-id="617841">Retour sur la modification du nombre de post</h3><p id="r-617837" data-claire-element-id="617837">J'aimerais revenir sur ce morceau de code :</p><pre id="r-617838" data-claire-element-id="617838"><code data-claire-semantic="html+php">&lt;?php
        //On enlève le nombre de post posté par chaque membre dans le topic
        $query=$db-&gt;prepare('SELECT post_createur, COUNT(*) AS nombre_mess FROM forum_post
        WHERE topic_id = :topic GROUP BY post_createur');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();

        while($data = $query-&gt;fetch())
        {
            $query=$db-&gt;prepare('UPDATE forum_membres
            SET membre_post = membre_post - :mess
            WHERE membre_id = :id');
            $query-&gt;bindValue(':mess',$data['nombre_mess'],PDO::PARAM_INT);
            $query-&gt;bindValue(':id',$data['post_createur'],PDO::PARAM_INT);
            $query-&gt;execute();
        }
?&gt;</code></pre><p id="r-617839" data-claire-element-id="617839">Ici, on veut soustraire à la valeur de membre_post (nombre de posts d'un membre) le nombre de messages qu'il a laissé dans le topic que l'on supprime. Ça peut paraître simple, mais en fait on est obligé de faire une requête dans une boucle (berk :o ).</p><p id="r-617840" data-claire-element-id="617840">Du coup, grâce à une boucle, on retourne pour chaque membre qui a posté le nombre de messages qu'il a laissé. Ça limite un peu le nombre de requêtes ; cela dit, il est assez rare de supprimer un topic, en général, on le déplace dans un forum &quot;poubelle&quot;.</p><h2 id="r-verrouillons" data-claire-element-id="617863">Verrouillons !</h2><p id="r-617843" data-claire-element-id="617843">Ce système de verrouillage / déverrouillage va se faire sur une simple requête sql. Celle-ci retourne la valeur de la case topic_locked : si c'est 1, je rappelle que c'est verrouillé, on proposera alors de déverrouiller. Si c'est 0, le topic est ouvert, on propose alors de le verrouiller. Ça va, vous me suivez ? :D</p><p id="r-617844" data-claire-element-id="617844">En plus, comble du bonheur, on n'aura qu'une seule page à modifier.</p><h3 id="r-codons-12" data-claire-element-id="617862">Codons !</h3><p id="r-617845" data-claire-element-id="617845">En fait, j'ai dit 1 page, mais j'ai menti :diable: . C'est-à-dire que c'est dans la page voirtopic.php qu'il faut faire la requête qui va nous donner la valeur de topic_locked. Ainsi, on fera deux liens selon les cas vers la page postok.php.</p><p id="r-617846" data-claire-element-id="617846">Enfin, voyez plutôt ^^ :</p><pre id="r-617847" data-claire-element-id="617847"><code data-claire-semantic="html+php">&lt;?php
$query = $db-&gt;prepare('SELECT topic_locked FROM forum_topic WHERE topic_id = :topic');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();

if ($data['topic_locked'] == 1) // Topic verrouillé !
{
    echo'&lt;a href=&quot;./postok.php?action=unlock&amp;t='.$topic.'&quot;&gt;
    &lt;img src=&quot;./images/unlock.gif&quot; alt=&quot;deverrouiller&quot; title=&quot;Déverrouiller ce sujet&quot; /&gt;&lt;/a&gt;';
}
else //Sinon le topic est déverrouillé !
{
    echo'&lt;a href=&quot;./postok.php?action=lock&amp;amp;t='.$topic.'&quot;&gt;
    &lt;img src=&quot;./images/lock.gif&quot; alt=&quot;verrouiller&quot; title=&quot;Verrouiller ce sujet&quot; /&gt;&lt;/a&gt;';
}
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-617848" data-claire-element-id="617848">Tout simplement ^^ . Vous pouvez insérer ceci où vous voulez dans la page voirtopic.php, mais je vous conseille de le mettre en bas (à côté du numéro des pages) dans un endroit où vous mettrez toutes les options de modération (suppression du topic, verrouillage et déplacement).</p><aside id="r-617850" data-claire-element-id="617850" data-claire-semantic="warning"><p id="r-617849" data-claire-element-id="617849">Je ne l'ai pas mis parce que normalement vous l'avez fait au moment d'afficher le bouton de suppression du topic : mais pensez à vérifier les autorisations avant !</p></aside><p id="r-617851" data-claire-element-id="617851">Passons à la page postok.php :</p><pre id="r-617852" data-claire-element-id="617852"><code data-claire-semantic="html+php">&lt;?php
case &quot;lock&quot;: //Si on veut verrouiller le topic
    //On récupère la valeur de t
    $topic = (int) $_GET['t'];
    $query = $db-&gt;prepare('SELECT forum_topic.forum_id, auth_modo FROM forum_topic
    LEFT JOIN forum_forum ON forum_forum.forum_id = forum_topic.forum_id
    WHERE topic_id = :topic');
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute();
    $data = $query-&gt;fetch();

    //Ensuite on vérifie que le membre a le droit d'être ici
    if (!verif_auth($data['auth_modo']))
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_VERR);
    }  
    else //Sinon ça roule et on continue
    {
        //On met à jour la valeur de topic_locked
        $query-&gt;CloseCursor();
        $query=$db-&gt;prepare('UPDATE forum_topic SET topic_locked = :lock WHERE topic_id = :topic');
        $query-&gt;bindValue(':lock',1,PDO::PARAM_STR);
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute(); 
        $query-&gt;CloseCursor();

        echo'&lt;p&gt;Le topic a bien été verrouillé ! &lt;br /&gt;
        Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;ici&lt;/a&gt; pour retourner au topic&lt;br /&gt;
        Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;/p&gt;';
    }
break;
 
case &quot;unlock&quot;: //Si on veut déverrouiller le topic
    //On récupère la valeur de t
        $topic = (int) $_GET['t'];
    $query = $db-&gt;prepare('SELECT forum_topic.forum_id, auth_modo FROM forum_topic
    LEFT JOIN forum_forum ON forum_forum.forum_id = forum_topic.forum_id
    WHERE topic_id = :topic');
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute();
    $data = $query-&gt;fetch();
 
 //Ensuite on vérifie que le membre a le droit d'être ici
    if (!verif_auth($data['auth_modo']))
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_VERR);
    }  
    else //Sinon ça roule et on continue
    {
        //On met à jour la valeur de topic_locked
        $query-&gt;CloseCursor();
        $query=$db-&gt;prepare('UPDATE forum_topic SET topic_locked = :lock WHERE topic_id = :topic');
        $query-&gt;bindValue(':lock',0,PDO::PARAM_STR);
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute(); 
        $query-&gt;CloseCursor();
 
        echo'&lt;p&gt;Le topic a bien été déverrouillé !&lt;br /&gt;
        Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;ici&lt;/a&gt; pour retourner au topic&lt;br /&gt;
        Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;/p&gt;';
    }
break;
?&gt;</code></pre><p id="r-617853" data-claire-element-id="617853">Un simple update, et le tour est joué !</p><div id="r-617855" data-claire-element-id="617855" data-claire-semantic="question"><p id="r-617854" data-claire-element-id="617854">Ouais, c'est cool ton truc, mais pour l'instant, ça sert à quoi que le champ topic_locked soit sur <em>verrouillé</em> puisque ça ne nous empêche pas de poster o_O ?</p></div><p id="r-617856" data-claire-element-id="617856">En effet, pour l'instant c'est plus pour le style, mais ça n'empêche personne de poster un message :( . Bah, ce n'est pas grave, remontez dans votre page postok.php, vous avez une des premières valeurs possibles de $action qui est <strong>repondre</strong>. C'est ici et ici seulement qu'il faut faire agir le verrouillage.<br/> Vous avez normalement quelque chose qui ressemble à ceci :</p><pre id="r-617857" data-claire-element-id="617857"><code data-claire-semantic="html+php">&lt;?php
case &quot;repondre&quot;:
    //On passe le message dans une série de fonction
    $message = $_POST['message'];
 
    //ici seulement, maintenant qu'on est sur qu'elle existe, on récupère la valeur de la variable t
    $topic = (int) $_GET['t'];
    ?&gt;</code></pre><p id="r-617858" data-claire-element-id="617858">Il suffit de rajouter au-dessous le code suivant :</p><pre id="r-617859" data-claire-element-id="617859"><code data-claire-semantic="html+php">&lt;?php
    $query=$db-&gt;prepare('SELECT topic_locked FROM forum_topic WHERE topic_id = :topic');
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute(); 
    $data=$query-&gt;fetch();
    if ($data['topic_locked'] != 0)
    {
        erreur(ERR_TOPIC_VERR); //A vous d'afficher un message du genre : le topic est verrouillé qu'est ce que tu fous là !?
    }
    $query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-617860" data-claire-element-id="617860">Et le tour est joué ! :magicien: Pensez cependant aussi à préciser que le topic est verrouillé sur les pages voirtopic.php, et même voirforum.php, avec une icône spéciale, pourquoi pas :) .</p><p id="r-617861" data-claire-element-id="617861">Vous avez à présent un système de verrouillage / déverrouillage pour les topics de votre forum. Nous allons maintenant voir comment faire pour déplacer un topic ^^ .</p><h2 id="r-deplacement-d-un-topic" data-claire-element-id="617884">Déplacement d'un topic</h2><p id="r-617864" data-claire-element-id="617864">La correction touche à sa fin et je vois déjà vos mines réjouies... Donc, on va calmer ça tout de suite avec ce qui arrive :diable: .<br/> En fait, ce n'est rien de très compliqué : c'est juste différent de ce qu'on a fait jusqu'ici.</p><h3 id="r-afficher-la-liste-des-forums" data-claire-element-id="617874">Afficher la liste des forums</h3><p id="r-617865" data-claire-element-id="617865">Pour déplacer un topic, de quoi j'ai besoin ? D'un forum vers lequel l'envoyer, pardi ! Et comment je le choisis ? Avec une liste déroulante, par exemple :p .<br/> J'en ai déjà un peu parlé plus haut, donc on va voir cela plus concrètement.</p><p id="r-617866" data-claire-element-id="617866">Déjà, on va afficher cette liste sur la page voirtopic.php, tout en bas entre 'supprimer' et 'verrouiller' le topic. Pensez donc à vérifier encore une fois les autorisations (enfin vous n'avez besoin de le faire qu'une fois dans la page, hein ? ^^ )</p><pre id="r-617867" data-claire-element-id="617867"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT forum_id, forum_name FROM forum_forum WHERE forum_id &lt;&gt; :forum');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
$query-&gt;execute();

//$forum a été définie tout en haut de la page !
echo'&lt;p&gt;Déplacer vers :&lt;/p&gt;
&lt;form method=&quot;post&quot; action=postok.php?action=deplacer&amp;amp;t='.$topic.'&gt;
&lt;select name=&quot;dest&quot;&gt;';               
while($data=$query-&gt;fetch())
{
     echo'&lt;option value='.$data['forum_id'].' id='.$data['forum_id'].'&gt;'.$data['forum_name'].'&lt;/option&gt;';
}
$query-&gt;CloseCursor();
echo'
&lt;/select&gt;
&lt;input type=&quot;hidden&quot; name=&quot;from&quot; value='.$forum.'&gt;
&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
&lt;/form&gt;';
?&gt;</code></pre><p id="r-617868" data-claire-element-id="617868">Vous remarquez que je passe plusieurs infos à la page postok.php. Déjà l'id du topic à déplacer, mais aussi le forum d'origine ainsi que la destination. Vous comprendrez mieux pourquoi dans 2 minutes :) .<br/> Voilà déjà la liste qui est faite :p : ça devrait vous donner quelque chose comme ça :</p><figure id="r-617870" data-claire-element-id="617871"><img id="r-617869" data-claire-element-id="617869" src="medias/uploads.siteduzero.com_files_56001_57000_56768.png" alt="Image utilisateur"/></figure><p id="r-617872" data-claire-element-id="617872">.</p><p id="r-617873" data-claire-element-id="617873">Passons maintenant au code de la page postok.php (pour changer :D ).</p><h3 id="r-traitement-5" data-claire-element-id="617883">Traitement</h3><pre id="r-617875" data-claire-element-id="617875"><code data-claire-semantic="html+php">&lt;?php
case &quot;deplacer&quot;:

    $topic = (int) $_GET['t'];
    $query= $db-&gt;prepare('SELECT forum_topic.forum_id, auth_modo
    FROM forum_topic
    LEFT JOIN forum_forum 
    ON forum_forum.forum_id = forum_topic.forum_id
    WHERE topic_id =:topic');
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;execute();
    $data=$query-&gt;fetch();
    
    if (!verif_auth($data['auth_modo']))
    {
        // Si cette condition n'est pas remplie ça va barder :o
        erreur(ERR_AUTH_MOVE);
    }
    else //Sinon ça roule et on continue
    {
        $query-&gt;CloseCursor();
        $destination = (int) $_POST['dest'];
        $origine = (int) $_POST['from'];
               
        //On déplace le topic
        $query=$db-&gt;prepare('UPDATE forum_topic SET forum_id = :dest WHERE topic_id = :topic');
        $query-&gt;bindValue(':dest',$destination,PDO::PARAM_INT);
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor(); 
 
        //On déplace les posts
        $query=$db-&gt;prepare('UPDATE forum_post SET post_forum_id = :dest
        WHERE topic_id = :topic');
        $query-&gt;bindValue(':dest',$destination,PDO::PARAM_INT);
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute(); 
        $query-&gt;CloseCursor();     
        //On s'occupe d'ajouter / enlever les nombres de post / topic aux
        //forum d'origine et de destination
        //Pour cela on compte le nombre de post déplacé
               
        
        $query=$db-&gt;prepare('SELECT COUNT(*) AS nombre_post
        FROM forum_post WHERE topic_id = :topic');
        $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
        $query-&gt;execute();    
        $data = $query-&gt;fetch();
        $nombrepost = $data['nombre_post'];
        $query-&gt;CloseCursor();       
                
        //Il faut également vérifier qu'on a pas déplacé un post qui été
        //l'ancien premier post du forum (champ forum_last_post_id)
 
        $query=$db-&gt;prepare('SELECT post_id FROM forum_post WHERE post_forum_id = :ori
        ORDER BY post_id DESC LIMIT 0,1');
        $query-&gt;bindValue(':ori',$origine,PDO::PARAM_INT);
        $query-&gt;execute();
        $data=$query-&gt;fetch();       
        $last_post=$data['post_id'];
        $query-&gt;CloseCursor();
        
        //Puis on met à jour le forum d'origine
        $query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post - :nbr, forum_topic = forum_topic - 1,
        forum_last_post_id = :id
        WHERE forum_id = :ori');
        $query-&gt;bindValue(':nbr',$nombrepost,PDO::PARAM_INT);
        $query-&gt;bindValue(':ori',$origine,PDO::PARAM_INT);
        $query-&gt;bindValue(':id',$last_post,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();

        //Avant de mettre à jour le forum de destination il faut
        //vérifier la valeur de forum_last_post_id
        $query=$db-&gt;prepare('SELECT post_id FROM forum_post WHERE post_forum_id = :dest
        ORDER BY post_id DESC LIMIT 0,1');
        $query-&gt;bindValue(':dest',$destination,PDO::PARAM_INT);
        $query-&gt;execute();
        $data=$query-&gt;fetch();
        $last_post=$data['post_id'];
        $query-&gt;CloseCursor();

        //Et on met à jour enfin !
        $query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post + :nbr,
        forum_topic = forum_topic + 1,
        forum_last_post_id = :last
        WHERE forum_id = :forum');
        $query-&gt;bindValue(':nbr',$nombrepost,PDO::PARAM_INT);
        $query-&gt;bindValue(':last',$last_post,PDO::PARAM_INT);
        $query-&gt;bindValue(':forum',$destination,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();

        //C'est gagné ! On affiche le message
        echo'&lt;p&gt;Le topic a bien été déplacé &lt;br /&gt;
        Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;ici&lt;/a&gt; pour revenir au topic&lt;br /&gt;
        Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour revenir à l index du forum&lt;/p&gt;';
    }
break;
?&gt;</code></pre><p id="r-617876" data-claire-element-id="617876">Piuu... ça en fait des choses à modifier... o_O . C'était la difficulté majeure de ces codes, ne pas oublier de modifier un seul champ, car sinon, on a vite fait de se retrouver avec des problèmes sur son forum.</p><p id="r-617877" data-claire-element-id="617877">C'est ce qui fait le nombre assez élevé de requêtes : donc, il ne faut pas se perdre. N'hésitez pas à reprendre les codes, et ne les utilisez qu'une fois compris (je les ai piégés, et ils vont tout faire sauter, sinon :diable: ).</p><aside id="r-617879" data-claire-element-id="617879" data-claire-semantic="information"><p id="r-617878" data-claire-element-id="617878">Comme je l'ai déjà dit, il existe autant de façons de créer un forum qu'il y a de codeurs php. C'est-à-dire que les choix que j'ai fait ne sont pas forcément les seuls possibles. Notamment concernant les champs qui lient certaines tables : il ne tient qu'à vous de les supprimer, et de les contourner avec une jointure lorsque vous en avez besoin, ce qui permet de passer plus vite ce genre de code en en faisant qu'un seul update.</p></aside><p id="r-617880" data-claire-element-id="617880">En tout cas, la correction est terminée et par la même occasion, la partie modération ! :)</p><p id="r-617881" data-claire-element-id="617881">Voilà pour la fin de ce TP. Bien entendu il n'est pas nécessaire de s'arrêter à ces quelques options, si votre forum devient important il peut être bon de simplifier la vie des modérateurs.</p><p id="r-617882" data-claire-element-id="617882">Par exemple sur le sdz les modérateurs peuvent activer des réponses automatiques, pénaliser des membres en ajoutant des % :diable: et sûrement d'autres choses que j'ignore :D . En fait il n'y a pas de limite si ce n'est votre imagination donc n'hésitez pas à continuer un peu ce système.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
<span class="arrow"></span>
<span class="next">Conseils</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">
<span class="next">Administration Partie I</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="AdministrationPartieI"></a><h2>Administration Partie I</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
<span class="arrow"></span>
<span class="next">Correction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
<span class="next">Structure de la page</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-617887" data-claire-element-id="617887">On y arrive : le forum touche à sa fin, et la partie la plus intéressante est là ! L'administration d'un forum est la touche finale dans la mesure où elle vous permettra, une fois mise en place, de n'accéder à la base de données qu'en cas de problèmes.<br/> Une fois le script réalisé, vous serez totalement indépendants et le forum pourra commencer à tourner normalement.<br/> Ça fait rêver, hein ? :p</p><p id="r-617888" data-claire-element-id="617888">Bon. Malheureusement, le script est à la fois long et tordu, il va donc falloir s'accrocher un minimum ^^ . Pas de panique toutefois, ce n'est pas non plus spécialement compliqué : ce qui est embêtant, c'est la longueur des codes. C'est pour cela que j'ai décidé de séparer le chapitre en deux parties. Ici, nous verrons la page admin.php, qui servira de formulaire en quelque sorte, tandis que dans un second temps, nous verrons la page adminok.php (je sais, ça veut rien dire... :D ) qui s'occupera de tout le traitement.</p><p id="r-617889" data-claire-element-id="617889">Allez 1, 2, 3, c'est parti !</p>
</div><a name="Structuredelapage"></a><h2>Structure de la page</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">
<span class="arrow"></span>
<span class="next">Administration Partie I</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
<span class="next">Configuration</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617890" data-claire-element-id="617890">Une seule page pour toute la partie administration (enfin, 2, mais une seule pour la récupération d'informations), cette phrase a peut être dû vous choquer. Vous vous dites : <br/> &quot;hop hop hop mais comment on va pouvoir mettre tout ce qu'on veut faire là-dedans (gestion des forums, des membres, du bannissement, des configurations, des catégories, des droits...) :euh: ?&quot; <br/> Eh bien la réponse à cette question, c'est qu'on va utiliser un double switch (prononcez à l'anglaise pour plus de style ^^ ) !</p><h3 id="r-le-double-switch" data-claire-element-id="617895">Le double switch</h3><p id="r-617891" data-claire-element-id="617891">Le premier switch récupère en fait des infos sur ce que l'on va toucher (forum ou membre, par exemple), il les prend dans l'url grâce à la variable cat. Le second s'insère dans le premier, et donne des infos supplémentaires (par exemple <em>édition</em>) ; lui, il prend les infos grâce à la variable action, qui se trouve également dans l'url.<br/> Si la variable action est absente, on affiche le menu de la catégorie qu'on a choisie ; si la variable cat est absente, on affiche le menu général de l'administration.<br/> Ça va, vous me suivez ? :p</p><p id="r-617892" data-claire-element-id="617892">Voilà la structure de la page, vous comprendrez sûrement mieux ensuite :</p><pre id="r-617893" data-claire-element-id="617893"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Administration&quot;;
$balises = true;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);

// On indique o l'on se trouve
$cat = (isset($_GET['cat']))?htmlspecialchars($_GET['cat']):'';

echo'&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt;  &lt;a href=&quot;./admin.php&quot;&gt;Administration du forum&lt;/a&gt;';
if (!verif_auth(ADMIN)) erreur(ERR_AUTH_ADMIN);

switch($cat) //1er switch
{
case &quot;config&quot;:
//ici configuration
break;
 
case &quot;forum&quot;:
//Ici forum
$action = htmlspecialchars($_GET['action']); //On récupère la valeur de action
        switch($action) //2eme switch
        {
        case &quot;creer&quot;:
        //Création d'un forum
        break;
        
        case &quot;edit&quot;:
        //Edition d'un forum
        break;
        
        case &quot;droits&quot;:
        //Gestion des droits
        break;
        
        default; //action n'est pas remplie, on affiche le menu
        echo'&lt;h1&gt;Administration des forums&lt;/h1&gt;';
        echo'&lt;p&gt;Bonjour, cher administrateur :p, que veux tu faire ?
        &lt;br /&gt;
        &lt;a href=&quot;./admin.php?cat=forum&amp;amp;action=creer&quot;&gt;Créer un forum&lt;/a&gt;
        &lt;br /&gt;
        &lt;a href=&quot;./admin.php?cat=forum&amp;amp;action=edit&quot;&gt;Modifier un forum&lt;/a&gt;
        &lt;br /&gt;
        &lt;a href=&quot;./admin.php?cat=forum&amp;amp;action=droits&quot;&gt;
        Modifier les droits d un forum&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;';
        break;
        }
break;
 
case &quot;membres&quot;:
//Ici membres
$action = htmlspecialchars($_GET['action']); //On récupère la valeur de action
        switch($action) //2eme switch
        {
        case &quot;edit&quot;:
        //Edition d'un membre
        break;
        
        case &quot;droits&quot;:
        //Droits d'un membre (rang)
        break;
        
        case &quot;ban&quot;:
        //Bannissement
        break;
        
        default; //action n'est pas remplie, on affiche le menu 
        echo'&lt;h1&gt;Administration des membres&lt;/h1&gt;';
        echo'&lt;p&gt;Salut mon ptit, alors tu veux faire quoi ?&lt;br /&gt;
        &lt;a href=&quot;./admin.php?cat=membres&amp;amp;action=edit&quot;&gt;
        Editer le profil d un membre&lt;/a&gt;&lt;br /&gt;
        &lt;a href=&quot;./admin.php?cat=membres&amp;amp;action=droits&quot;&gt;
        Modifier les droits d un membre&lt;/a&gt;&lt;br /&gt;
        &lt;a href=&quot;./admin.php?cat=membres&amp;amp;action=ban&quot;&gt;
        Bannir / Debannir un membre&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;';
        break;
        }
break;
default; //cat n'est pas remplie, on affiche le menu général
echo'&lt;h1&gt;Index de l administration&lt;/h1&gt;';
echo'&lt;p&gt;Bienvenue sur la page d administration.&lt;br /&gt;
&lt;a href=&quot;./admin.php?cat=config&quot;&gt;Configuration du forum&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;./admin.php?cat=forum&quot;&gt;Administration des forums&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;./admin.php?cat=membres&quot;&gt;Administration des membres&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;';
break;
}
?&gt;</code></pre><p id="r-617894" data-claire-element-id="617894">Vous pouvez comme ça avoir déjà une idée de ce que l'on va réaliser par la suite... Après, si vous voulez ajouter d'autres fonctions, vous n'aurez qu'à les insérer dans ce squelette.</p><h3 id="r-une-nouvelle-table" data-claire-element-id="617902">Une nouvelle table</h3><p id="r-617896" data-claire-element-id="617896">Comme je vous l'avais promis tout au long de la partie 1 de ce tuto, on va pouvoir grâce à l'administration fixer la valeur de certaines variables, comme, par exemple, la taille de l'avatar. Mais vous comprenez bien qu'il faut stocker ces valeurs quelque part : c'est pourquoi nous allons avoir besoin d'une nouvelle table, un peu spéciale puisqu'elle ne contient que deux champs : config_name, qui représente le nom du paramètre et config_valeur, qui représente sa... valeur !</p><div id="r-617898" data-claire-element-id="617898" data-claire-semantic="question"><p id="r-617897" data-claire-element-id="617897">Je ne vois pas comment ça peut marcher ton truc : config_valeur, ça peut être un entier comme une chaîne de caractères, et pourtant faut bien faire un choix, non ?</p></div><p id="r-617899" data-claire-element-id="617899">Oui, c'est vrai que c'est un problème, le mieux est encore d'utiliser VARCHAR : ce type de champ stocke normalement des chaînes de caractères, mais on peut très bien y mettre des chiffres, la seule différence avec INT, c'est qu'on ne pourra faire aucun calcul avec, sur la base de données.</p><pre id="r-617900" data-claire-element-id="617900"><code data-claire-semantic="sql">CREATE TABLE `forum_config` (
config_nom VARCHAR( 200 ) NOT NULL ,
config_valeur VARCHAR( 500 ) NOT NULL
) TYPE = MYISAM ;</code></pre><p id="r-617901" data-claire-element-id="617901">Et voilà pour la table !</p><h3 id="r-les-autorisations" data-claire-element-id="617905">Les autorisations</h3><p id="r-617903" data-claire-element-id="617903">Ce que je vais dire là va sûrement vous paraître évident, mais on n'est jamais trop prudent. Seuls les administrateurs ont accès au panneau d'administration, autrement dit à la page admin.php. Libre à vous de mettre un lien vers celle-ci où vous voulez, mais assurez-vous que celui-ci ne s'affiche que pour les administrateurs (utilisez la fonction auth_verif et la constante ADMIN pour cela). Et comme d'habitude, une seconde vérification s'impose sur la page adminok.php, afin d'être sûrs que personne ne s'y est introduit en modifiant l'url.</p><p id="r-617904" data-claire-element-id="617904">Vous pouvez également jouer sur les autorisations, et faire des parties du panneau d'administration que les modérateurs pourront lire (et donc modifier) afin d'alléger le travail des administrateurs.<br/> Bon : je m'arrête ici, vous voyez qu'il y a des dizaines de façon de personnaliser les scripts qui vont suivre.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">
<span class="arrow"></span>
<span class="next">Administration Partie I</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
<span class="next">Configuration</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Configuration"></a><h2>Configuration</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
<span class="arrow"></span>
<span class="next">Structure de la page</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
<span class="next">Gestion des forums</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617907" data-claire-element-id="617907">On commence tout de suite avec la configuration du forum, c'est-à-dire comme je l'ai dit plus haut, donner des valeurs à des variables par-ci par-là, pour pouvoir les modifier plus rapidement qu'en changeant les scripts.<br/> Mais avant toute chose, il va nous falloir lister un peu toutes ces variables.</p><p id="r-617908" data-claire-element-id="617908"><strong>Concernant l'enregistrement </strong><br/><em>Avatar</em></p><ul id="r-617915" data-claire-element-id="617915"><li id="r-617910" data-claire-element-id="617910"><p id="r-617909" data-claire-element-id="617909">Taille maximale de l'avatar (en octets)</p></li><li id="r-617912" data-claire-element-id="617912"><p id="r-617911" data-claire-element-id="617911">Largeur maximale de l'avatar (en pixels)</p></li><li id="r-617914" data-claire-element-id="617914"><p id="r-617913" data-claire-element-id="617913">Hauteur maximale de l'avatar (en pixels)</p></li></ul><p id="r-617916" data-claire-element-id="617916"><em>Signature</em></p><ul id="r-617921" data-claire-element-id="617921"><li id="r-617918" data-claire-element-id="617918"><p id="r-617917" data-claire-element-id="617917">Longueur maximale de la signature (en caractères)</p></li><li id="r-617920" data-claire-element-id="617920"><p id="r-617919" data-claire-element-id="617919">Autorisation du bbcode</p></li></ul><p id="r-617922" data-claire-element-id="617922"><em>Pseudo</em></p><ul id="r-617927" data-claire-element-id="617927"><li id="r-617924" data-claire-element-id="617924"><p id="r-617923" data-claire-element-id="617923">Longueur maximale du pseudo (en caractères)</p></li><li id="r-617926" data-claire-element-id="617926"><p id="r-617925" data-claire-element-id="617925">Longueur minimale du pseudo (en caractères)</p></li></ul><p id="r-617928" data-claire-element-id="617928"><strong>Concernant les topics et posts </strong><br/><em>Topics</em></p><ul id="r-617931" data-claire-element-id="617931"><li id="r-617930" data-claire-element-id="617930"><p id="r-617929" data-claire-element-id="617929">Nombre de topics par page</p></li></ul><p id="r-617932" data-claire-element-id="617932"><em>posts</em></p><ul id="r-617935" data-claire-element-id="617935"><li id="r-617934" data-claire-element-id="617934"><p id="r-617933" data-claire-element-id="617933">Nombre de posts par page</p></li></ul><p id="r-617936" data-claire-element-id="617936">Ça fera déjà un bon début : de toutes façons, si vous voulez ajouter quelque chose, vous pouvez le faire très facilement.</p><h3 id="r-modification-de-la-base-de-donnees" data-claire-element-id="617942">Modification de la base de données</h3><div id="r-617938" data-claire-element-id="617938" data-claire-semantic="question"><p id="r-617937" data-claire-element-id="617937">Encore ?!</p></div><p id="r-617939" data-claire-element-id="617939">Oui, cette fois il faut remplir un peu notre nouvelle table avec les noms de nos paramètres, et des valeurs par défaut.</p><pre id="r-617940" data-claire-element-id="617940"><code data-claire-semantic="sql">INSERT INTO forum_config VALUES ('avatar_maxsize', '10 000');
INSERT INTO forum_config VALUES ('avatar_maxh', '100 '); 
INSERT INTO forum_config VALUES ('avatar_maxl', '100 '); 
INSERT INTO forum_config VALUES ('sign_maxl', '200');
INSERT INTO forum_config VALUES ('auth_bbcode_sign', 'oui');
INSERT INTO forum_config VALUES ('pseudo_maxsize', '15');
INSERT INTO forum_config VALUES ('pseudo_minsize', '3');
INSERT INTO forum_config VALUES ('topic_par_page', '20');
INSERT INTO forum_config VALUES ('post_par_page', '15');</code></pre><p id="r-617941" data-claire-element-id="617941">Cette liste n'a de limite que votre imagination, à vous de la compléter, en annexe de ce tuto, vous trouverez un petit paragraphe sur le sujet.</p><h3 id="r-on-affiche-le-formulaire" data-claire-element-id="617952">On affiche le formulaire</h3><p id="r-617943" data-claire-element-id="617943">Heureusement, le code de cette partie est très simple et très court : il suffit de faire une requête qui retire tout ce qui se trouve dans la table forum_config, et d'afficher le tout dans un formulaire.</p><p id="r-617944" data-claire-element-id="617944">Mais il faut avant faire une petite modification : vous avez pu remarquer que les entrées qui se trouvent dans la colonne config_name sont carrément baroques, on ne peut pas les afficher comme cela. Donc, deux choix s'offrent à vous : soit vous ajoutez une colonne à cette table, qui contiendra ainsi le texte à afficher, soit vous faites un tableau, qui associe le nom brut au nom à afficher. J'ai choisi cette deuxième méthode, mais la première est tout aussi bien, mieux même si vous voulez pouvoir tout gérer depuis la base de données, sans avoir à modifier les scripts.</p><pre id="r-617945" data-claire-element-id="617945"><code data-claire-semantic="html+php">&lt;?
case &quot;config&quot;:
	//ici configuration
	echo'&lt;h1&gt;Configuration du forum&lt;/h1&gt;';
	echo '&lt;form method=&quot;post&quot; action=&quot;adminok.php?cat=config&quot;&gt;';

	//Le tableau associatif
	$config_name = array(
	&quot;avatar_maxsize&quot; =&gt; &quot;Taille maximale de l avatar&quot;,
	&quot;avatar_maxh&quot; =&gt; &quot;Hauteur maximale de l avatar&quot;,
	&quot;avatar_maxl&quot; =&gt; &quot;Largeur maximale de l avatar&quot;,
	&quot;sign_maxl&quot; =&gt; &quot;Taille maximale de la signature&quot;,
	&quot;auth_bbcode_sign&quot; =&gt; &quot;Autoriser le bbcode dans la signature&quot;,
	&quot;pseudo_maxsize&quot; =&gt; &quot;Taille maximale du pseudo&quot;,
	&quot;pseudo_minsize&quot; =&gt; &quot;Taille minimale du pseudo&quot;,
	&quot;topic_par_page&quot; =&gt; &quot;Nombre de topics par page&quot;,
	&quot;post_par_page&quot; =&gt; &quot;Nombre de posts par page&quot;,
	&quot;forum_titre&quot; =&gt; &quot;Titre du forum&quot;
	);
	$query = $db-&gt;query('SELECT config_nom, config_valeur FROM forum_config');
	
	while($data=$query-&gt;fetch())
	{
           echo '&lt;p&gt;&lt;label for='.$data['config_nom'].'&gt;'.$config_name[$data['config_nom']].' &lt;/label&gt; :
           &lt;input type=&quot;text&quot; id=&quot;'.$data['config_nom'].'&quot; value=&quot;'.$data['config_valeur'].'&quot; name=&quot;'.$data['config_nom'].'&quot;&gt;&lt;/p&gt;';
	}
	echo '&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;&lt;/p&gt;&lt;/form&gt;';
	$query-&gt;CloseCursor();
break;</code></pre><p id="r-617946" data-claire-element-id="617946">Voilà : vous obtenez maintenant un formulaire qui n'attend plus qu'à être modifié ; d'ailleurs, il va attendre un peu parce que la page adminok.php est pour le chapitre suivant.<br/> Pour revenir au script ci-dessus, c'est sûr : ce n'est pas très beau, on aurait pu organiser les champs entre eux, mettre des sous-titres, etc. Mais souvenez-vous que cette page ne sera vue que par les administrateurs : donc, à vous de voir si vous jugez important d'améliorer le design :p .</p><div id="r-617948" data-claire-element-id="617948" data-claire-semantic="question"><p id="r-617947" data-claire-element-id="617947">Pourquoi ce tableau au final, on ne peut pas envoyer tout simplement le nom affiché, plutôt que le nom brut ?</p></div><p id="r-617949" data-claire-element-id="617949">On pourrait ; à vrai dire, j'avais fait comme ça au début, mais le problème, c'est que dès qu'il y a des espaces, ça devient plus compliqué : il faut les remplacer par des tirets bas &quot;_&quot; ; croyez-moi, cette méthode est plus simple, même si elle n'en a pas l'air tout de suite :) .</p><p id="r-617950" data-claire-element-id="617950">Par ailleurs, pour que cette page serve à quelque chose, il va falloir bien entendu modifier les scripts dans lesquels apparaissent les variables en question, pour cela je vous laisse faire, il y a plusieurs méthodes dont une exposée en annexe du tuto.</p><p id="r-617951" data-claire-element-id="617951">Passons à présent à la gestion des forums, c'est un peu plus long et un peu plus compliqué, alors on s'accroche, et ça ira ^^ .</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
<span class="arrow"></span>
<span class="next">Structure de la page</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
<span class="next">Gestion des forums</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gestiondesforums"></a><h2>Gestion des forums</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
<span class="arrow"></span>
<span class="next">Configuration</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
<span class="next">Gestion des membres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617954" data-claire-element-id="617954">On continue avec l'administration des forums et des catégories.<br/> Commençons en douceur avec la création d'un forum.</p><h2 id="r-creer-un-forum" data-claire-element-id="617960">Créer un forum</h2><p id="r-617955" data-claire-element-id="617955">Lorsque vous créez un forum, vous renseignez les champs de la table forum_forum. Il faut donc indiquer le nom, la catégorie et la description. Seulement, il ne faut pas oublier un détail : lorsque vous commencez votre forum, il n'y a pas de catégorie dessus :waw: ; donc, on va également proposer à l'administrateur de créer une catégorie.</p><p id="r-617956" data-claire-element-id="617956">Voici comment va s'organiser le script.<br/> - Si l'url ne contient pas la variable c, on demande à l'admin ce qu'il veut créer (forum ou catégorie).<br/> - Si c contient forum, on lance le formulaire pour la création d'un forum.<br/> - Si c contient catégorie, on lance le formulaire pour la création d'une catégorie.</p><p id="r-617957" data-claire-element-id="617957">Le code n'a rien d'extraordinaire, je le mets donc d'un coup :</p><pre id="r-617958" data-claire-element-id="617958"><code data-claire-semantic="html+php">&lt;?php
    case &quot;creer&quot;:
        //Création d'un forum

        //1er cas : pas de variable c
        if(empty($_GET['c']))
        {
                echo'&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Que voulez-vous faire?&lt;br /&gt;
                &lt;a href=&quot;./admin.php?cat=forum&amp;action=creer&amp;c=f&quot;&gt;Créer un forum&lt;/a&gt;&lt;br /&gt;
                &lt;a href=&quot;./admin.php?cat=forum&amp;action=creer&amp;c=c&quot;&gt;Créer une catégorie&lt;/a&gt;&lt;/br&gt;';
        }

        //2ème cas : on cherche à créer un forum (c=f)
        elseif($_GET['c'] == &quot;f&quot;)
        {
                $query=$db-&gt;query('SELECT cat_id, cat_nom FROM forum_categorie
                ORDER BY cat_ordre DESC');
                echo'&lt;h1&gt;Création d un forum&lt;/h1&gt;';
                echo'&lt;form method=&quot;post&quot; action=&quot;./adminok.php?cat=forum&amp;action=creer&amp;c=f&quot;&gt;';
                echo'&lt;label&gt;Nom :&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;nom&quot; name=&quot;nom&quot; /&gt;&lt;br /&gt;&lt;br /&gt;
                &lt;label&gt;Description :&lt;/label&gt;
                &lt;textarea cols=40 rows=4 name=&quot;desc&quot; id=&quot;desc&quot;&gt;&lt;/textarea&gt;
                &lt;br /&gt;&lt;br /&gt;
                &lt;label&gt;Catégorie : &lt;/label&gt;&lt;select name=&quot;cat&quot;&gt;';
                while($data = $query-&gt;fetch())
                {
		    echo'&lt;option value=&quot;'.$data['cat_id'].'&quot;&gt;'.$data['cat_nom'].'&lt;/option&gt;';
                }
                echo'&lt;/select&gt;&lt;br /&gt;&lt;br /&gt;
                &lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/form&gt;';
		$query-&gt;CloseCursor();
        }       
        //3ème cas : on cherche à créer une catégorie (c=c)
        elseif($_GET['c'] == &quot;c&quot;)
        {
                echo'&lt;h1&gt;Création d une catégorie&lt;/h1&gt;';
                echo'&lt;form method=&quot;post&quot; action=&quot;./adminok.php?cat=forum&amp;action=creer&amp;c=c&quot;&gt;';
                echo'&lt;label&gt; Indiquez le nom de la catégorie :&lt;/label&gt;
                &lt;input type=&quot;text&quot; id=&quot;nom&quot; name=&quot;nom&quot; /&gt;&lt;br /&gt;&lt;br /&gt;   
                &lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/form&gt;';
        }
    break;
?&gt;</code></pre><p id="r-617959" data-claire-element-id="617959">Vous voyez qu'on n'a pas grand-chose à faire pour créer un forum, et encore moins pour créer une catégorie. En revanche, après, il ne faudra pas oublier d'y inscrire les droits de celui-ci et son ordre. Nous allons voir ça tout de suite.</p><h2 id="r-edition-d-un-forum" data-claire-element-id="617985">Édition d'un forum</h2><p id="r-617961" data-claire-element-id="617961">Là, on arrive à la partie costaud de la page, l'édition d'un forum, mais aussi -je le rappelle- d'une catégorie doit en effet prendre en compte plusieurs choses. Pour être plus clair, il va en fait falloir faire comme précédemment, c'est-à-dire encore subdiviser le script en plusieurs cas. Il y a tout d'abord l'édition basique d'un forum, c'est-à-dire changer son nom, sa description ou encore le déplacer ; ensuite l'édition d'une catégorie, c'est-à-dire tout simplement changer son nom. Enfin, il y a la réorganisation des forums et des catégories. <br/> C'est une variable que j'ai nommée e, et qui se balade dans l'url qui nous permettra de savoir quoi faire ^^ .</p><h3 id="r-1er-cas-rien-n-est-renseigne" data-claire-element-id="617965">1er Cas : Rien n'est renseigné</h3><p id="r-617962" data-claire-element-id="617962">Voyons tout d'abord le premier cas, le plus basique : e n'existe pas, on affiche alors un sous-menu :</p><pre id="r-617963" data-claire-element-id="617963"><code data-claire-semantic="html+php">&lt;?php
    case &quot;edit&quot;:
        //Edition d'un forum
        echo'&lt;h1&gt;Edition d un forum&lt;/h1&gt;';
       
        if(!isset($_GET['e']))
        {
                echo'&lt;p&gt;Que voulez vous faire ?&lt;br /&gt;
                &lt;a href=&quot;./admin.php?cat=forum&amp;action=edit&amp;amp;e=editf&quot;&gt;
                Editer un forum&lt;/a&gt;&lt;br /&gt;
                &lt;a href=&quot;./admin.php?cat=forum&amp;action=edit&amp;amp;e=editc&quot;&gt;
                Editer une catégorie&lt;/a&gt;&lt;br /&gt;
                &lt;a href=&quot;./admin.php?cat=forum&amp;action=edit&amp;amp;e=ordref&quot;&gt;
                Changer l ordre des forums&lt;/a&gt;&lt;br /&gt;
                &lt;a href=&quot;./admin.php?cat=forum&amp;action=edit&amp;amp;e=ordrec&quot;&gt;
                Changer l ordre des catégories&lt;/a&gt;
                &lt;br /&gt;&lt;/p&gt;';
        }
?&gt;</code></pre><p id="r-617964" data-claire-element-id="617964">Comme d'habitude, en fait :p . J'en profite pour vous signaler à la suite de certaines remarques que ce que je fais est très moche, j'en suis conscient, mais c'est à vous de l'adapter. Par exemple, vous pouvez faire ça sous forme de liste déroulante, ou encore mettre des images, que sais-je encore;) .</p><h3 id="r-2eme-cas-edition-d-un-forum" data-claire-element-id="617970">2ème cas : Édition d'un forum</h3><p id="r-617966" data-claire-element-id="617966">Pour ce cas-là non plus, pas de difficulté mais un code un peu plus long ; en effet, il va dans un premier temps falloir demander de choisir le forum à éditer dans une liste, avant d'afficher les infos que l'on a sur celui-ci et de les modifier.</p><p id="r-617967" data-claire-element-id="617967">Les infos en question sont le nom, la description et la catégorie où il se trouve. C'est ce dernier renseignement qui va nous demander un peu plus de code : il faudra boucler toutes les catégories du forum, et mettre le tout dans une liste déroulante.</p><pre id="r-617968" data-claire-element-id="617968"><code data-claire-semantic="html+php">&lt;?php
        elseif($_GET['e'] == &quot;editf&quot;)
        {
            //On affiche dans un premier temps la liste des forums
            if(!isset($_POST['forum']))
            {
		$query=$db-&gt;query('SELECT forum_id, forum_name
		FROM forum_forum ORDER BY forum_ordre DESC');
			   
		echo'&lt;form method=&quot;post&quot; action=&quot;admin.php?cat=forum&amp;amp;action=edit&amp;amp;e=editf&quot;&gt;';
		echo'&lt;p&gt;Choisir un forum :&lt;/br /&gt;&lt;/h2&gt;
		&lt;select name=&quot;forum&quot;&gt;';
				   
		while($data = $query-&gt;fetch())
		{
		    echo'&lt;option value=&quot;'.$data['forum_id'].'&quot;&gt;
		    '.stripslashes(htmlspecialchars($data['forum_name'])).'&lt;/option&gt;';
		}
		echo'&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/p&gt;&lt;/form&gt;';
		$query-&gt;CloseCursor();

            }               
            //Ensuite, on affiche les renseignements sur le forum choisi
            else
            {
	        $query = $db-&gt;prepare('SELECT forum_id, forum_name, forum_desc,
		forum_cat_id
		FROM forum_forum
		WHERE forum_id = :forum');
		$query-&gt;bindValue(':forum',(int) $_POST['forum'],PDO::PARAM_INT);
		$query-&gt;execute();
				
		$data1 = $query-&gt;fetch();

		echo'&lt;p&gt;Edition du forum
		&lt;strong&gt;'.stripslashes(htmlspecialchars($data1['forum_name'])).'&lt;/strong&gt;&lt;/p&gt;';
				   
		echo'&lt;form method=&quot;post&quot; action=&quot;adminok.php?cat=forum&amp;amp;action=edit&amp;amp;e=editf&quot;&gt;
		&lt;label&gt;Nom du forum : &lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;nom&quot;
		name=&quot;nom&quot; value=&quot;'.$data1['forum_name'].'&quot; /&gt;
		&lt;br /&gt;
				   
		&lt;label&gt;Description :&lt;/label&gt;&lt;textarea cols=40 rows=4 name=&quot;desc&quot;
		id=&quot;desc&quot;&gt;'.$data1['forum_desc'].'&lt;/textarea&gt;&lt;br /&gt;&lt;br /&gt;';
		$query-&gt;CloseCursor();				  
		//A partir d'ici, on boucle toutes les catégories,
		//On affichera en premier celle du forum

		$query = $db-&gt;query('SELECT cat_id, cat_nom
		FROM forum_categorie ORDER BY cat_ordre DESC');
		echo'&lt;label&gt;Déplacer le forum vers : &lt;/label&gt;
		&lt;select name=&quot;depl&quot;&gt;';
		while($data2 = $query-&gt;fetch())
		{
		    if($data2['cat_id'] == $data1['forum_cat_id'])
		    {
		    echo'&lt;option value=&quot;'.$data2['cat_id'].'&quot; 
                    selected=&quot;selected&quot;&gt;'.stripslashes(htmlspecialchars($data2['cat_nom'])).' 
                    &lt;/option&gt;';
		    }
		    else
		    {
		        echo'&lt;option value=&quot;'.$data2['cat_id'].'&quot;&gt;'.$data2['cat_nom'].'&lt;/option&gt;';
		    }
	        }
	        echo'&lt;/select&gt;&lt;input type=&quot;hidden&quot; name=&quot;forum_id&quot; value=&quot;'.$data1['forum_id'].'&quot;&gt;';
	        echo'&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/p&gt;&lt;/form&gt;';
	        $query-&gt;CloseCursor();				  
				
            }
        }
?&gt;</code></pre><p id="r-617969" data-claire-element-id="617969">C'est un peu comme ce que l'on a vu pour les droits des membres, c'est-à-dire qu'on affiche en premier la catégorie où se trouve le forum, ça permet une lecture plus facile, et puis ça évite de déplacer un forum sans faire exprès :) .<br/> Le champ caché envoie la valeur de l'id du forum qui a été choisi, il va permettre de décharger un peu l'url qui contient déjà un paquet de variables : on récupérera simplement cette valeur avec $_GET['forum_id'].</p><h3 id="r-3eme-cas-edition-d-une-categorie" data-claire-element-id="617974">3ème cas : Édition d'une catégorie</h3><p id="r-617971" data-claire-element-id="617971">Ce cas-ci est quasiment similaire au précédent... mais en plus court. Pour le coup, il suffit de modifier le nom et puis c'est tout, une catégorie ne contenant pas de description, ni rien.<br/> Donc on affiche la liste des catégories, on envoie et on modifie le nom, puis le tour est joué :) .</p><pre id="r-617972" data-claire-element-id="617972"><code data-claire-semantic="html+php">&lt;?php
        elseif($_GET['e'] == &quot;editc&quot;)
        {
            //On commence par afficher la liste des catégories
            if(!isset($_POST['cat']))
            {
	        $query = $db-&gt;query('SELECT cat_id, cat_nom
		FROM forum_categorie ORDER BY cat_ordre DESC');
		echo'&lt;form method=&quot;post&quot; action=&quot;admin.php?cat=forum&amp;amp;action=edit&amp;amp;e=editc&quot;&gt;';
		echo'&lt;p&gt;Choisir une catégorie :&lt;/br /&gt;
		&lt;select name=&quot;cat&quot;&gt;';
		while($data = $query-&gt;fetch())
		{
		    echo'&lt;option value=&quot;'.$data['cat_id'].'&quot;&gt;'.$data['cat_nom'].'&lt;/option&gt;';
		}
		echo'&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/p&gt;&lt;/form&gt;';		
                $query-&gt;CloseCursor();				  					
            }         
            //Puis le formulaire
            else
            {
	        $query = $db-&gt;prepare('SELECT cat_nom FROM forum_categorie
	        WHERE cat_id = :cat');
		$query-&gt;bindValue(':cat',(int) $_POST['cat'],PDO::PARAM_INT);
		$query-&gt;execute();
		$data = $query-&gt;fetch();
		echo'&lt;form method=&quot;post&quot; action=&quot;./adminok.php?cat=forum&amp;amp;action=edit&amp;amp;e=editc&quot;&gt;';

		echo'&lt;label&gt; Indiquez le nom de la catégorie :&lt;/label&gt;
		&lt;input type=&quot;text&quot; id=&quot;nom&quot; name=&quot;nom&quot;
		value=&quot;'.stripslashes(htmlspecialchars($data['cat_nom'])).'&quot; /&gt;
		&lt;br /&gt;&lt;br /&gt;   
		&lt;input type=&quot;hidden&quot; name=&quot;cat&quot; value=&quot;'.$_POST['cat'].'&quot; /&gt;
		&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;&lt;/p&gt;&lt;/form&gt;';
		$query-&gt;CloseCursor();				  
				
            }
        }
?&gt;</code></pre><p id="r-617973" data-claire-element-id="617973">Bon bah, pas grand chose à redire là-dessus, on affiche le nom et encore une fois, un champ caché est envoyé à la page d'action afin que l'on connaisse la valeur de l'id de la catégorie à modifier.</p><h3 id="r-4eme-cas-ordonner-les-forums" data-claire-element-id="617979">4ème cas : Ordonner les forums</h3><p id="r-617975" data-claire-element-id="617975">Ce que l'on va faire dans cette partie est assez simple à comprendre : on affiche, comme sur la page d'index, les forums rangés par catégories. Seulement, cette fois on inscrit ni le nombre de posts, ni celui de topics ou autres, mais simplement un champ texte avec la valeur du champ forum_ordre à l'intérieur. L'administrateur pourra ainsi facilement les modifier, puis envoyer le tout à la page de traitement pour réordonner ses forums.</p><p id="r-617976" data-claire-element-id="617976">Voici le code :</p><pre id="r-617977" data-claire-element-id="617977"><code data-claire-semantic="html+php">&lt;?php
        elseif($_GET['e'] == &quot;ordref&quot;)
        {
            $categorie=&quot;&quot;;
            $query = $db-&gt;query('SELECT forum_id, forum_name, forum_ordre,
            forum_cat_id, cat_id, cat_nom
            FROM forum_categorie
            LEFT JOIN forum_forum ON cat_id = forum_cat_id
            ORDER BY cat_ordre DESC');

            echo'&lt;form method=&quot;post&quot;
            action=&quot;adminok.php?cat=forum&amp;amp;action=edit&amp;amp;e=ordref&quot;&gt;';
               
            echo '&lt;table&gt;';

            while($data = $query-&gt;fetch())
            {
	        if( $categorie !== $data['cat_id'] )
		{
		    $categorie = $data['cat_id'];
		    echo'
		    &lt;tr&gt;       
	            &lt;th&gt;&lt;strong&gt;'.stripslashes(htmlspecialchars($data['cat_nom'])).'&lt;/strong&gt;&lt;/th&gt;
		    &lt;th&gt;&lt;strong&gt;Ordre&lt;/strong&gt;&lt;/th&gt;
		    &lt;/tr&gt;';
		}
		echo'&lt;tr&gt;&lt;td&gt;
                &lt;a href=&quot;./voirforum.php?f='.$data['forum_id'].'&quot;&gt;'.$data['forum_name'].'&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;&lt;input type=&quot;text&quot; value=&quot;'.$data['forum_ordre'].'&quot; name=&quot;'.$data['forum_id'].'&quot; /&gt;
                &lt;/td&gt;&lt;/tr&gt;';
            }
            echo'&lt;/table&gt;
            &lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;&lt;/p&gt;&lt;/form&gt;';
				
        }
?&gt;</code></pre><p id="r-617978" data-claire-element-id="617978">Ça doit vous rappeler quelque chose, non ? ^^ C'est en effet de cette manière que l'on avait affiché les forums sur la page d'index. Ce que l'on fait là, c'est un tableau, tout ce qu'il y a de plus simple : avec deux colonnes, une pour le nom, et une pour l'ordre. On fait ensuite passer à la page de traitement le nouvel ordre de chaque forum, qui se trouveront inscrits dans des variables du type $_POST[9], où 9 est l'id du forum. Cela permettra de les coupler à leur forum.</p><h3 id="r-5eme-cas-ordonner-les-categories" data-claire-element-id="617984">5ème cas : Ordonner les catégories</h3><p id="r-617980" data-claire-element-id="617980">Très simple et très court : il suffit d'afficher les catégories avec un champ texte qui contient leur numéro d'ordre. Il est inutile de les ranger dans un tableau, il faut juste les ordonner.</p><pre id="r-617981" data-claire-element-id="617981"><code data-claire-semantic="html+php">&lt;?php
        elseif($_GET['e'] == &quot;ordrec&quot;)
        {
            $query = $db-&gt;query('SELECT cat_id, cat_nom, cat_ordre
            FROM forum_categorie
            ORDER BY cat_ordre DESC');
 
            echo'&lt;form method=&quot;post&quot; action=&quot;adminok.php?cat=forum&amp;amp;action=edit&amp;amp;e=ordrec&quot;&gt;';
            while($data = $query-&gt;fetch())
            {
		echo'&lt;label&gt;'.stripslashes(htmlspecialchars($data['cat_nom'])).' :&lt;/label&gt;
		&lt;input type=&quot;text&quot; value=&quot;'.$data['cat_ordre'].'&quot;name=&quot;'.$data['cat_id'].'&quot; /&gt;&lt;br /&gt;&lt;br /&gt;';
            }
            echo '&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;&lt;/form&gt;';
            $query-&gt;CloseCursor();				  					
        }
    break;
?&gt;</code></pre><p id="r-617982" data-claire-element-id="617982">Et du coup c'est terminé : ce code est quasiment le même que celui qui précède. Comme vous pouvez le voir, il n'y a pas grand-chose à modifier sur une catégorie, si ce n'est son nom... Je rappelle que pour l'ordre, on a vu plus haut comment faire.</p><p id="r-617983" data-claire-element-id="617983">Bien, passons à présent aux droits d'un forum, puis on en aura terminé avec cette page :) .</p><h2 id="r-droits-d-un-forum" data-claire-element-id="617992">Droits d'un forum</h2><p id="r-617986" data-claire-element-id="617986">Allez, un dernier effort !</p><p id="r-617987" data-claire-element-id="617987">Ce que l'on veut faire ici, c'est afficher pour un forum donné les autorisations qui lui sont propres. Donc, on va encore séparer le code en deux : d'abord le formulaire, qui est en fait une liste déroulante grâce à laquelle on va choisir le forum. Ensuite, on va afficher dans un tableau une série de listes déroulantes, pour chaque type d'autorisation (lire, poster, modérer...), qui seront automatiquement placées sur la valeur actuelle.</p><p id="r-617988" data-claire-element-id="617988">Le problème est le suivant : je rappelle que les noms des groupes sont des entiers. Or, on veut afficher du texte pour que l'administrateur sache ce qu'il fait. On va donc utiliser un tableau qui associe encore une fois numéro d'autorisation et sa valeur concrète.</p><p id="r-617989" data-claire-element-id="617989">Toutefois, contrairement au script sur les droits des membres, on doit afficher plusieurs listes, c'est pourquoi on aura besoin de faire une boucle dans la première boucle, et par la même occasion, on va devoir utiliser un tableau qui associe les noms des champs (auth_view, auth_topic...) en quelque chose de plus parlant (lire, poster...).</p><pre id="r-617990" data-claire-element-id="617990"><code data-claire-semantic="html+php">&lt;?php
    case &quot;droits&quot;:
        //Gestion des droits
        echo'&lt;h1&gt;Edition des droits&lt;/h1&gt;';     
       
        if(!isset($_POST['forum']))
        {
            $query=$db-&gt;query('SELECT forum_id, forum_name
            FROM forum_forum ORDER BY forum_ordre DESC');
            echo'&lt;form method=&quot;post&quot; action=&quot;admin.php?cat=forum&amp;action=droits&quot;&gt;';
            echo'&lt;p&gt;Choisir un forum :&lt;/br /&gt;
            &lt;select name=&quot;forum&quot;&gt;';
            while($data = $query-&gt;fetch())
            {
                echo'&lt;option value=&quot;'.$data['forum_id'].'&quot;&gt;'.$data['forum_name'].'&lt;/option&gt;';
            }
            echo'&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/p&gt;&lt;/form&gt;';
            $query-&gt;CloseCursor();				  					
        }
        else
        {
	    $query = $db-&gt;prepare('SELECT forum_id, forum_name, auth_view,
	    auth_post, auth_topic, auth_annonce, auth_modo
	    FROM forum_forum WHERE forum_id = :forum');
	    $query-&gt;bindValue(':forum',(int) $_POST['forum'], PDO::PARAM_INT);
	    $query-&gt;execute();
 
            echo '&lt;form method=&quot;post&quot; action=&quot;adminok.php?cat=forum&amp;action=droits&quot;&gt;&lt;p&gt;&lt;table&gt;&lt;tr&gt;
	    &lt;th&gt;Lire&lt;/th&gt;
	    &lt;th&gt;Répondre&lt;/th&gt;
	    &lt;th&gt;Poster&lt;/th&gt;
	    &lt;th&gt;Annonce&lt;/th&gt;
	    &lt;th&gt;Modérer&lt;/th&gt;
	    &lt;/tr&gt;';
	    $data = $query-&gt;fetch();
		   
	    //Ces deux tableaux vont permettre d'afficher les résultats
	    $rang = array(
            VISITEUR=&gt;&quot;Visiteur&quot;,
            INSCRIT=&gt;&quot;Membre&quot;, 
            MODO=&gt;&quot;Modérateur&quot;,
            ADMIN=&gt;&quot;Administrateur&quot;);
	    $list_champ = array(&quot;auth_view&quot;, &quot;auth_post&quot;, &quot;auth_topic&quot;,&quot;auth_annonce&quot;, &quot;auth_modo&quot;);
	 
	    //On boucle
	    foreach($list_champ as $champ)
	    {
	        echo'&lt;td&gt;&lt;select name=&quot;'.$champ.'&quot;&gt;';
		for($i=1;$i&lt;5;$i++)
		{
		    if ($i == $data[$champ])
		    {
		        echo'&lt;option value=&quot;'.$i.'&quot; selected=&quot;selected&quot;&gt;'.$rang[$i].'&lt;/option&gt;';
		    }	
		    else
		    {
		        echo'&lt;option value=&quot;'.$i.'&quot;&gt;'.$rang[$i].'&lt;/option&gt;';
		    }
		}
		echo'&lt;/td&gt;&lt;/select&gt;';
	    }	
	    echo'&lt;br /&gt;&lt;input type=&quot;hidden&quot; name=&quot;forum_id&quot; value=&quot;'.$data['forum_id'].'&quot; /&gt;
	    &lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/p&gt;&lt;/form&gt;';			          

            $query-&gt;CloseCursor();				  					

        }
        echo '&lt;/table&gt;';
    break;
?&gt;</code></pre><p id="r-617991" data-claire-element-id="617991">Ce qu'il faut bien comprendre, c'est que le foreach parcourt le premier tableau, il va donc commencer à auth_view, puis il va afficher en priorité la valeur actuelle de auth_view avant d'afficher les autres, grâce à la seconde boucle. Puis ainsi de suite... :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
<span class="arrow"></span>
<span class="next">Configuration</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
<span class="next">Gestion des membres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gestiondesmembres"></a><h2>Gestion des membres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
<span class="arrow"></span>
<span class="next">Gestion des forums</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">
<span class="next">Administration Partie II</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-617994" data-claire-element-id="617994">Nous allons voir tout ce qui concerne la partie administration, et qui a un rapport avec les membres.</p><h2 id="r-edition-d-un-profil-1" data-claire-element-id="618002">Édition d'un profil</h2><p id="r-617995" data-claire-element-id="617995">Cette partie ressemble énormément à la page de modification du profil : la seule différence est que cette fois ce n'est pas le membre, mais l'administrateur qui modifie les infos sur son compte. C'est pourquoi il faut dans un premier temps lui demander de qui il veut modifier le profil.</p><p id="r-617996" data-claire-element-id="617996">Voilà comment s'organise ce code :<br/> - on regarde si la variable $_POST['membre'] est renseignée<br/> . si ce n'est pas le cas, c'est qu'on arrive à l'instant, on propose alors un formulaire qui demande d'entrer le pseudo d'un membre.<br/> . Si c'est le cas, on affiche un formulaire avec les infos du membres (comme sur la page de profil).</p><pre id="r-617997" data-claire-element-id="617997"><code data-claire-semantic="html+php">&lt;?php
case &quot;membres&quot;:
//Ici membres
    $action = htmlspecialchars($_GET['action']); //On récupère la valeur de action
    switch($action) //2ème switch
    {
        case &quot;edit&quot;:
            echo'&lt;h1&gt;Edition du profil d un membre&lt;/h1&gt;';   

            if(!isset($_POST['membre'])) //Si la variable $_POST['membre'] n'existe pas
            {
                echo'De quel membre voulez-vous éditer le profil ?&lt;br /&gt;';
                echo'&lt;br /&gt;&lt;form method=&quot;post&quot; action=&quot;./admin.php?cat=membres&amp;amp;action=edit&quot;&gt;
                &lt;p&gt;&lt;label for=&quot;membre&quot;&gt;Inscrivez le pseudo : &lt;/label&gt; 
                &lt;input type=&quot;text&quot; id=&quot;membre&quot; name=&quot;membre&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;Chercher&quot;&gt;
                &lt;/p&gt;&lt;/form&gt;';
            }
        
?&gt;</code></pre><p id="r-617998" data-claire-element-id="617998">Ici, on a affiché le formulaire, c'est la méthode que j'ai choisie ; mais vous pouvez très bien vous en passer, et demander l'id simplement.<br/> Passons maintenant à la suite :</p><pre id="r-617999" data-claire-element-id="617999"><code data-claire-semantic="html+php">&lt;?php
        else //sinon
        {
            $pseudo_d = $_POST['membre'];

            //Requête qui ramène des info sur le membre à 
            //Partir de son pseudo
            $query = $db-&gt;prepare('SELECT membre_id, 
            membre_pseudo, membre_email,
            membre_siteweb, membre_signature, 
            membre_msn, membre_localisation, membre_avatar
            FROM forum_membres WHERE LOWER(membre_pseudo)=:pseudo');
	    $query-&gt;bindValue(':pseudo',strtolower($pseudo_d),PDO::PARAM_STR);
            $query-&gt;execute();    
            //Si la requête retourne un truc, le membre existe
            if ($data = $query-&gt;fetch()) 
            {
		?&gt;
	        &lt;form method=&quot;post&quot; action=&quot;adminok.php?cat=membres&amp;amp;action=edit&quot; enctype=&quot;multipart/form-data&quot;&gt;
		&lt;fieldset&gt;&lt;legend&gt;Identifiants&lt;/legend&gt;
		&lt;label for=&quot;pseudo&quot;&gt;Pseudo :&lt;/label&gt;
		&lt;input type=&quot;text&quot; name=&quot;pseudo&quot; id=&quot;pseudo&quot; 
		value=&quot;&lt;?php echo stripslashes(htmlspecialchars($data['membre_pseudo'])) ?&gt;&quot; /&gt;&lt;br /&gt;
		&lt;/fieldset&gt;

		&lt;fieldset&gt;&lt;legend&gt;Contacts&lt;/legend&gt;
		&lt;label for=&quot;email&quot;&gt;Adresse E_Mail :&lt;/label&gt;
		&lt;input type = &quot;text&quot; name=&quot;email&quot; id=&quot;email&quot;
		value=&quot;&lt;?php echo stripslashes(htmlspecialchars($data['membre_email'])) ?&gt;&quot; /&gt;&lt;br /&gt;
		&lt;label for=&quot;msn&quot;&gt;Adresse MSN :&lt;/label&gt;
		&lt;input type = &quot;text&quot; name=&quot;msn&quot; id=&quot;msn&quot;
		value=&quot;&lt;?php echo stripslashes(htmlspecialchars($data['membre_msn'])) ?&gt;&quot; /&gt;&lt;br /&gt;
		&lt;label for=&quot;website&quot;&gt;Site web :&lt;/label&gt;
		&lt;input type = &quot;text&quot; name=&quot;website&quot; id=&quot;website&quot;
		value=&quot;&lt;?php echo stripslashes(htmlspecialchars($data['membre_siteweb'])) ?&gt;&quot;/&gt;&lt;br /&gt;
		&lt;/fieldset&gt;

		&lt;fieldset&gt;&lt;legend&gt;Informations supplémentaire&lt;/legend&gt;
		&lt;label for=&quot;localisation&quot;&gt;Localisation :&lt;/label&gt;
		&lt;input type = &quot;text&quot; name=&quot;localisation&quot; id=&quot;localisation&quot;
		value=&quot;&lt;?php echo stripslashes(htmlspecialchars($data['membre_localisation'])) ?&gt;&quot; /&gt;
		&lt;br /&gt;
		&lt;/fieldset&gt;
			   
		&lt;fieldset&gt;&lt;legend&gt;Profil sur le forum&lt;/legend&gt;
		&lt;label for=&quot;avatar&quot;&gt;Changer l avatar :&lt;/label&gt;
		&lt;input type=&quot;file&quot; name=&quot;avatar&quot; id=&quot;avatar&quot; /&gt;
		&lt;br /&gt;&lt;br /&gt;
		&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;delete&quot; value=&quot;Delete&quot; /&gt; Supprimer l avatar&lt;/label&gt;
		Avatar actuel :
		&lt;?php echo'
		&lt;img src=&quot;./images/avatars/'.$data['membre_avatar'].'&quot; alt=&quot;pas d avatar&quot; /&gt;' ?&gt;
		 
		&lt;br /&gt;&lt;br /&gt;
		&lt;label for=&quot;signature&quot;&gt;Signature :&lt;/label&gt;
		&lt;textarea cols=40 rows=4 name=&quot;signature&quot; id=&quot;signature&quot;&gt;
		&lt;?php echo $data['membre_signature'] ?&gt;&lt;/textarea&gt;
		
		&lt;br /&gt;&lt;/h2&gt;
		&lt;/fieldset&gt;
		&lt;?php
		echo'&lt;input type=&quot;hidden&quot; value=&quot;'.stripslashes($pseudo_d).'&quot; name=&quot;pseudo_d&quot;&gt;
		&lt;input type=&quot;submit&quot; value=&quot;Modifier le profil&quot; /&gt;&lt;/form&gt;';
                $query-&gt;CloseCursor();

            }
            else echo' &lt;p&gt;Erreur : Ce membre n existe pas, &lt;br /&gt;
            cliquez &lt;a href=&quot;./admin.php?cat=membres&amp;amp;action=edit&quot;&gt;ici&lt;/a&gt; pour réessayez&lt;/p&gt;';
        }
    break;
?&gt;</code></pre><p id="r-618000" data-claire-element-id="618000">Vous avez sûrement remarqué qu'il s'agit, à quelques modifications près, de la page voirprofil.php dans sa partie modification. Ce qui est parfaitement normal, étant donné qu'on veut faire la même chose.<br/> Pour reprendre le code, on sécurise d'abord la variable créée avec le pseudo passé par le formulaire, ça peut paraître étrange qu'un admin décide d'hacker son propre forum, mais bon, ça ne coûte rien. Grâce à celle-ci, on lance une requête, on prend les infos que l'on a dans la base de données sur le membre. Si elle ne retourne rien, c'est que le membre n'existe pas (par exemple, si le pseudo a été mal orthographié), sinon tout va bien, on affiche le formulaire.<br/> Il est surprenant qu'un administrateur trouve une raison pour modifier le mot de passe d'un membre, c'est pourquoi j'ai retiré cette option du formulaire :p .</p><p id="r-618001" data-claire-element-id="618001">Comme promis, la page de traitement viendra plus tard, passons alors aux droits des membres.</p><h2 id="r-droits-des-membres" data-claire-element-id="618012">Droits des membres</h2><p id="r-618003" data-claire-element-id="618003">Comme toute personne, les membres ont des droits, la différence est que dans votre forum, c'est vous qui décidez de quels droits ils disposeront. ^^ <br/> Pour cela, on va organiser la page comme ceci : on demande d'entrer un nom dans un formulaire, et on retourne le niveau d'autorisation de celui-ci, ensuite on propose de changer ce niveau.</p><aside id="r-618005" data-claire-element-id="618005" data-claire-semantic="information"><p id="r-618004" data-claire-element-id="618004">Pour ceux qui ont décidé d'utiliser la méthode qui associe groupes et forums, le mieux est d'afficher tous les forums, avec pour chacun les droits du membre, et de modifier le tout.</p></aside><p id="r-618006" data-claire-element-id="618006">Pour le début, ça sera exactement pareil que précédemment : donc, il n'y a pas grand chose à expliquer.<br/> Bref, voilà la page :</p><pre id="r-618007" data-claire-element-id="618007"><code data-claire-semantic="html+php">&lt;?php
    case &quot;droits&quot;:
        //Droits d'un membre (rang)
        echo'&lt;h1&gt;Edition des droits d un membre&lt;/h1&gt;';  

        if(!isset($_POST['membre']))
        {
                echo'De quel membre voulez-vous modifier les droits ?&lt;br /&gt;';
                echo'&lt;br /&gt;&lt;form method=&quot;post&quot; action=&quot;./admin.php?cat=membres&amp;action=droits&quot;&gt;
                &lt;p&gt;&lt;label for=&quot;membre&quot;&gt;Inscrivez le pseudo : &lt;/label&gt; 
                &lt;input type=&quot;text&quot; id=&quot;membre&quot; name=&quot;membre&quot;&gt;
                &lt;input type=&quot;submit&quot; value=&quot;Chercher&quot;&gt;&lt;/p&gt;&lt;/form&gt;';
        }
        else
        {
            $pseudo_d = $_POST['membre'];
            $query = $db-&gt;prepare('SELECT membre_pseudo,membre_rang
            FROM forum_membres WHERE LOWER(membre_pseudo) = :pseudo');
	    $query-&gt;bindValue(':pseudo',strtolower($pseudo_d),PDO::PARAM_STR);
            $query-&gt;execute();
	    if ($data = $query-&gt;fetch())
            {       
                echo'&lt;form action=&quot;./adminok.php?cat=membres&amp;amp;action=droits&quot; method=&quot;post&quot;&gt;';
?&gt;</code></pre><p id="r-618008" data-claire-element-id="618008">C'est ici qu'on est confrontés à un petit problème : comment présenter le formulaire. Le mieux est de faire une liste déroulante avec les différents grades. Oui, mais voilà, comment faire pour savoir quel est l'original ? Par exemple, si je tombe sur un modérateur, comment mettre en &quot;<em>selected</em>&quot; modérateur ?<br/> Le plus facile est de créer un tableau qui associe à chaque chiffre recueilli dans le champ membre_rang le nom qu'il représente. Ensuite, grâce à une boucle, on pourra facilement faire ce que l'on veut.</p><pre id="r-618009" data-claire-element-id="618009"><code data-claire-semantic="html+php">&lt;?php
                $rang = array
                (0 =&gt; &quot;Bannis&quot;,
                1 =&gt; &quot;Visiteur&quot;, 
                2 =&gt; &quot;Membre&quot;, 
                3 =&gt; &quot;Modérateur&quot;, 
                4 =&gt; &quot;Administrateur&quot;); //Ce tableau associe numéro de droit et nom
                echo'&lt;label&gt;'.$data['membre_pseudo'].'&lt;/label&gt;';
                echo'&lt;select name=&quot;droits&quot;&gt;';
                for($i=0;$i&lt;5;$i++)
                {
		    if ($i == $data['membre_rang'])
		        {
			    echo'&lt;option value=&quot;'.$i.'&quot; selected=&quot;selected&quot;&gt;'.$rang[$i].'&lt;/option&gt;';
			}
			else
			{
			    echo'&lt;option value=&quot;'.$i.'&quot;&gt;'.$rang[$i].'&lt;/option&gt;';
			}
                }
		echo'&lt;/select&gt;
		&lt;input type=&quot;hidden&quot; value=&quot;'.stripslashes($pseudo_d).'&quot; name=&quot;pseudo&quot;&gt;               
		&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;/form&gt;';
                $query-&gt;CloseCursor();
            }				  					
            else echo' &lt;p&gt;Erreur : Ce membre n existe pas, &lt;br /&gt;
            cliquez &lt;a href=&quot;./admin.php?cat=membres&amp;amp;action=edit&quot;&gt;ici&lt;/a&gt; pour réessayer&lt;/p&gt;';
        }
    break;
?&gt;</code></pre><p id="r-618010" data-claire-element-id="618010">Un peu étrange ce code, je vous l'accorde : on va donc voir ça tout en douceur. Tout d'abord on crée le tableau, celui-ci associe, comme je l'ai dit plus haut, un numéro avec le nom qu'il représente. Ensuite, il faut faire la boucle qui affiche l'option de la liste déroulante, et c'est grâce à la variable $i que l'on va pouvoir savoir quelle option mettre en &quot;<em>selected</em>&quot;.</p><p id="r-618011" data-claire-element-id="618011">Un truc peut vous paraitre mauvais, le tableau qu'il faudra modifier dès qu'on voudra ajouter un rang. C'est pourquoi je vous conseille d'utiliser la méthode expliquée <a href="http://www.siteduzero.com/tuto-3-15474-1-autorisations-d-acces.html#ss_part_4">ici</a>, le tableau est alors tout beau, et prêt à être utilisé grâce à la table forum_groupes.</p><h2 id="r-bannissement" data-claire-element-id="618022">Bannissement</h2><p id="r-618013" data-claire-element-id="618013">Pour ce qui est du bannissement, vous avez certainement remarqué qu'il est possible de bannir un membre en modifiant ses droits et en mettant 0. Toutefois, pour des raisons pratiques, il est possible en effet que vous n'ayez pas suivi mes idées à la lettre, et que vous gériez le bannissement autrement ; nous allons tout de suite voir une autre méthode. De plus, il sera beaucoup plus clair d'afficher la liste de tous les membres bannis pour que vous puissiez réhabiliter celui que vous voulez :p .</p><p id="r-618014" data-claire-element-id="618014">Voilà ce que l'on va faire :<br/> - en haut, un formulaire propose à l'admin d'entrer le pseudo du membre à bannir<br/> - en bas, la liste de tous les membres bannis avec l'option <em>débannir</em>.</p><pre id="r-618015" data-claire-element-id="618015"><code data-claire-semantic="html+php">&lt;?php
    case &quot;ban&quot;:
        //Bannissement
        echo'&lt;h1&gt;Gestion du bannissement&lt;/h1&gt;'; 

        //Zone de texte pour bannir le membre
        echo'Quel membre voulez-vous bannir ?&lt;br /&gt;';
        echo'&lt;br /&gt;
        &lt;form method=&quot;post&quot; action=&quot;./adminok.php?cat=membres&amp;amp;action=ban&quot;&gt;
        &lt;label for=&quot;membre&quot;&gt;Inscrivez le pseudo : &lt;/label&gt; 
        &lt;input type=&quot;text&quot; id=&quot;membre&quot; name=&quot;membre&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;&lt;br /&gt;';

        //Ici, on boucle : pour chaque membre banni, on affiche une checkbox
        //Qui propose de le débannir
        $query = $db-&gt;query('SELECT membre_id, membre_pseudo 
        FROM forum_membres WHERE membre_rang = 0');
        
        //Bien sur, on ne lance la suite que s'il y a des membres bannis !
        if ($query-&gt;rowCount() &gt; 0)
        {
        
	    while($data = $query-&gt;fetch())
            {
                echo'&lt;br /&gt;&lt;label&gt;&lt;a href=&quot;./voirprofil.php?action=consulter&amp;amp;m='.$data['membre_id'].'&quot;&gt;
                '.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/label&gt;
                &lt;input type=&quot;checkbox&quot; name=&quot;'.$data['membre_id'].'&quot; /&gt;
                Débannir&lt;br /&gt;';
            }
            echo'&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Go !&quot; /&gt;&lt;/p&gt;&lt;/form&gt;';
        }
        else echo' &lt;p&gt;Aucun membre banni pour le moment :p&lt;/p&gt;';
        $query-&gt;CloseCursor();
    break;
?&gt;</code></pre><p id="r-618016" data-claire-element-id="618016">Le code n'est pas bien compliqué : on affiche finalement encore une fois un formulaire. Le gros avantage de cette méthode est que vous pouvez d'un coup bannir un membre, et en débannir autant que vous voulez.</p><p id="r-618017" data-claire-element-id="618017">Bon, on a fait le tour de l'administration des membres ; pour le coup, je ne vois pas ce qu'on pourrait ajouter... Mais de toute façon, si vous avez une idée, il ne vous reste qu'à l'ajouter :p .</p><p id="r-618018" data-claire-element-id="618018">Bon, bah on y est arrivés :p : on a maintenant un panneau d'administration qui prend forme, avec toutes les fonctions que l'on va voir maintenant mises en place.</p><p id="r-618019" data-claire-element-id="618019">Avant de repartir, j'aimerais faire une remarque.<br/> La page n'est pas complète, vous avez certainement remarqué qu'il manque à la fois le début et la fin. C'est parce qu'ils n'ont que peu d'intérêt. N'oubliez toutefois pas de réserver l'accès <strong>aux seuls administrateurs !</strong></p><p id="r-618020" data-claire-element-id="618020">La suite ne sera qu'une adaptation de ce qu'on vient de voir... Il suffira de faire les bonnes requêtes, et le tour sera joué ! ^^ .</p><p id="r-618021" data-claire-element-id="618021">Allez : on y va !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
<span class="arrow"></span>
<span class="next">Gestion des forums</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">
<span class="next">Administration Partie II</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="AdministrationPartieII"></a><h2>Administration Partie II</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
<span class="arrow"></span>
<span class="next">Gestion des membres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
<span class="next">Configuration</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-618025" data-claire-element-id="618025">Nous voici donc à la suite du long chapitre sur la page d'administration. Ici, nous allons voir la page adminok.php, qui est en fait la page de traitement des données envoyées depuis la page admin.php que l'on vient de créer... Une fois n'est pas coutume, la page de traitement est beaucoup plus courte que celle de formulaire... Autrement dit, c'est presque terminé :D .</p><p id="r-618026" data-claire-element-id="618026">Mais bon comme j'ai dit presque... on continue. :p</p>
</div><a name="Configuration"></a><h2>Configuration</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">
<span class="arrow"></span>
<span class="next">Administration Partie II</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
<span class="next">Gestion des forums</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618027" data-claire-element-id="618027">Vous allez voir que dans cette page, on reprend le même plan que dans la précédente. Donc, on va à nouveau avoir besoin du double switch qui se présentera dans le même ordre, avec les mêmes noms de variables. D'ailleurs, si vous avez regardé les cibles des formulaires de la page admin.php, vous savez déjà tout ça.</p><p id="r-618028" data-claire-element-id="618028">Comme sur le chapitre précédent, je ne vais pas vous mettre le début de la page ; mais n'oubliez surtout pas de restreindre son accès aux administrateurs. Je répète que ce n'est pas parce qu'aucun lien ne va sur la page qu'il faut négliger sa sécurité !</p><p id="r-618029" data-claire-element-id="618029">On va commencer tout de suite avec la configuration du forum : le code n'a rien de compliqué et n'est pas long, mais vous allez voir que c'est la mode ici, et on ne va pas s'en plaindre :D !</p><p id="r-618030" data-claire-element-id="618030">Donc : qu'est-ce qu'on va faire exactement ?<br/> On reçoit de la page admin.php des données sous forme de variables $_POST. Pour chaque case du formulaire, on a une variable qui s'obtient de la façon suivante : $_POST[$nom_de_la_case]. On va donc les récupérer, et mettre à jour la base de données avec les nouvelles valeurs !</p><p id="r-618031" data-claire-element-id="618031">Mais si vous avez bien en tête la structure de la table forum_config, vous comprenez qu'on est obligés de faire une requête dans une boucle pour tout mettre à jour... Aussi, pour diminuer un peu ce nombre, on va d'abord faire une vérification sur la valeur de ce qui est posté. Si elle est identique à celle qui se trouve dans la table, alors c'est que rien n'a changé, et il est inutile de faire une requête pour ça. C'est bon, vous me suivez ? :p</p><p id="r-618032" data-claire-element-id="618032">De toute façon, vous comprendrez sûrement mieux avec le code. ^^</p><pre id="r-618033" data-claire-element-id="618033"><code data-claire-semantic="html+php">&lt;?
$cat = htmlspecialchars($_GET['cat']); //on récupère dans l'url la variable cat
switch($cat) //1er switch
{
case &quot;config&quot;:
    echo'&lt;h1&gt;Configuration du forum&lt;/h1&gt;';
    //On récupère les valeurs et le nom de chaque entrée de la table
    $query=$db-&gt;query('SELECT config_nom, config_valeur FROM forum_config');
    //Avec cette boucle, on va pouvoir contrôler le résultat pour voir s'il a changé
    while($data = $query-&gt;fetch())
    {
        if ($data['config_valeur'] != $_POST[$data['config_nom']])
	{
            //On met ensuite à jour
            $valeur = htmlspecialchars($_POST[$data['config_nom']]);
	    $query=$db-&gt;prepare('UPDATE forum_config SET config_valeur = :valeur
            WHERE config_nom = :nom');
            $query-&gt;bindValue(':valeur', $valeur, PDO::PARAM_STR);
            $query-&gt;bindValue(':nom', $data['config_nom'],PDO::PARAM_STR);
            $query-&gt;execute();
	}
    }
    $query-&gt;CloseCursor();
    //Et le message !
    echo'&lt;br /&gt;&lt;br /&gt;Les nouvelles configurations ont été mises à jour !&lt;br /&gt;  
    Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour revenir à l administration';
break;
?&gt;</code></pre><p id="r-618034" data-claire-element-id="618034">Voilà le code, j'espère que c'est clair à présent parce que c'est grosso modo comme cela que l'on va procéder à chaque fois.</p><p id="r-618035" data-claire-element-id="618035">Continuons, maintenant ! :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">
<span class="arrow"></span>
<span class="next">Administration Partie II</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
<span class="next">Gestion des forums</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gestiondesforums"></a><h2>Gestion des forums</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
<span class="arrow"></span>
<span class="next">Configuration</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
<span class="next">Gestion des membres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618037" data-claire-element-id="618037">Cette partie est la plus longue, mais reste tout de même assez courte, même très courte par rapport à celles de la page admin.php ;) .</p><h2 id="r-creation-1" data-claire-element-id="618041">Création</h2><p id="r-618038" data-claire-element-id="618038">Si vous vous souvenez, dans cette partie on peut créer soit un forum, soit une catégorie. C'est une petite variable appelée c qui fait la différence. On va donc dans un premier temps la récupérer (elle se cache quelque part dans l'url), et ensuite on va agir :p .</p><pre id="r-618039" data-claire-element-id="618039"><code data-claire-semantic="html+php">&lt;?php
case &quot;forum&quot;:
    //Ici forum
    $action = htmlspecialchars($_GET['action']); //On récupère la valeur de action
    switch($action) //2ème switch
    {
    case &quot;creer&quot;:

        //On commence par les forums
	if ($_GET['c'] == &quot;f&quot;)
	{
	    $titre = $_POST['nom'];
	    $desc = $_POST['desc'];
	    $cat = (int) $_POST['cat'];

	
	    $query=$db-&gt;prepare('INSERT INTO forum_forum (forum_cat_id, forum_name, forum_desc) 
	    VALUES (:cat, :titre, :desc)');
            $query-&gt;bindValue(':cat',$cat,PDO::PARAM_INT);
            $query-&gt;bindValue(':titre',$titre, PDO::PARAM_STR);
            $query-&gt;bindValue(':desc',$desc,PDO::PARAM_STR);
            $query-&gt;execute();
	    echo'&lt;br /&gt;&lt;br /&gt;Le forum a été créé !&lt;br /&gt;
	    Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour revenir à l administration';
	    $query-&gt;CloseCursor();
        }
        //Puis par les catégories
        elseif ($_GET['c'] == &quot;c&quot;)
        {
            $titre = $_POST['nom'];
            $query=$db-&gt;prepare('INSERT INTO forum_categorie (cat_nom) VALUES (:titre)');
            $query-&gt;bindValue(':titre',$titre, PDO::PARAM_STR); 
            $query-&gt;execute();          
            echo'&lt;p&gt;La catégorie a été créée !&lt;br /&gt; Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; 
            pour revenir à l administration&lt;/p&gt;';
	    $query-&gt;CloseCursor();
        }
    break;

?&gt;</code></pre><p id="r-618040" data-claire-element-id="618040">Il s'agit donc simplement de récupérer les données et de faire une requête. Juste un truc avant de continuer : vous remarquez qu'on ne modifie que 3 champs pour les forums, alors que la table forum_forum en contient une bonne dizaine... C'est en fait parce que les autres doivent être modifiés ailleurs. Ainsi, un forum nouvellement créé se retrouvera automatiquement relégué à la dernière place de la catégorie.</p><h2 id="r-editer" data-claire-element-id="618061">Éditer</h2><p id="r-618042" data-claire-element-id="618042">Pour l'édition, il y avait 4 cas différents ; on va bien sûr devoir en tenir compte ici aussi. Le code est donc découpé à l'aide de if et autres elseif, mais on va voir ça progressivement.</p><h3 id="r-edition-d-un-forum-1" data-claire-element-id="618046">Édition d'un forum</h3><p id="r-618043" data-claire-element-id="618043">Bon bah ça, c'est très simple : on récupère les infos envoyées par la page admin.php, et on met à jour la base de données.<br/> Avant ça, il faut toutefois vérifier qu'il n'y a pas eu de problème, et que le forum à éditer existe bien.</p><pre id="r-618044" data-claire-element-id="618044"><code data-claire-semantic="html+php">&lt;?php
    case &quot;edit&quot;:
        echo'&lt;h1&gt;Edition d un forum&lt;/h1&gt;';
        
        if($_GET['e'] == &quot;editf&quot;)
        {
            //Récupération d'informations

	    $titre = $_POST['nom'];
	    $desc = $_POST['desc'];
	    $cat = (int) $_POST['depl'];       

            //Vérification
            $query=$db-&gt;prepare('SELECT COUNT(*) 
            FROM forum_forum WHERE forum_id = :id');
            $query-&gt;bindValue(':id',(int) $_POST['forum_id'],PDO::PARAM_INT);
            $query-&gt;execute();
            $forum_existe=$query-&gt;fetchColumn();
            $query-&gt;CloseCursor();
            if ($forum_existe == 0) erreur(ERR_FOR_EXIST);

            
            //Mise à jour
            $query=$db-&gt;prepare('UPDATE forum_forum 
            SET forum_cat_id = :cat, forum_name = :name, forum_desc = :desc 
            WHERE forum_id = :id');
            $query-&gt;bindValue(':cat',$cat,PDO::PARAM_INT);  
            $query-&gt;bindValue(':name',$titre,PDO::PARAM_STR);
            $query-&gt;bindValue(':desc',$desc,PDO::PARAM_STR);
            $query-&gt;bindValue(':id',(int) $_POST['forum_id'],PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();
            //Message
            echo'&lt;p&gt;Le forum a été modifié !&lt;br /&gt;Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; 
            pour revenir à l administration&lt;/p&gt;';
        
        }
?&gt;</code></pre><p id="r-618045" data-claire-element-id="618045">Pas grand-chose à ajouter... Vous pouvez, si vous le souhaitez, permettre l'utilisation du bbcode sur les descriptions des forums. Dans ce cas, utilisez la fonction code. De plus, vous pouvez aussi limiter la taille des descriptions pour éviter des textes trop longs.</p><h3 id="r-edition-d-une-categorie" data-claire-element-id="618050">Édition d'une catégorie</h3><p id="r-618047" data-claire-element-id="618047">Encore plus facile, puisqu'il n'y a que le nom à mettre à jour. Du coup, c'est le même schéma, mais en plus court !</p><pre id="r-618048" data-claire-element-id="618048"><code data-claire-semantic="html+php">&lt;?php
        elseif($_GET['e'] == &quot;editc&quot;)
        {
            //Récupération d'informations
            $titre = $_POST['nom'];

            //Vérification
            $query=$db-&gt;prepare('SELECT COUNT(*) 
            FROM forum_categorie WHERE cat_id = :cat');
            $query-&gt;bindValue(':cat',(int) $_POST['cat'],PDO::PARAM_INT);
            $query-&gt;execute();
            $cat_existe=$query-&gt;fetchColumn();
            $query-&gt;CloseCursor();
            if ($cat_existe == 0) erreur(ERR_CAT_EXIST);
            
            //Mise à jour
            $query=$db-&gt;prepare('UPDATE forum_categorie
            SET cat_nom = :name WHERE cat_id = :cat');
            $query-&gt;bindValue(':name',$titre,PDO::PARAM_STR);
            $query-&gt;bindValue(':cat',(int) $_POST['cat'],PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();

            //Message
            echo'&lt;p&gt;La catégorie a été modifiée !&lt;br /&gt;
            Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; 
            pour revenir à l administration&lt;/p&gt;';
        
        }
?&gt;</code></pre><p id="r-618049" data-claire-element-id="618049">Ici aussi, vous pouvez limiter la taille du nom de la catégorie, mais à vrai dire, je vois mal comment celui-ci pourrait être très long :p .</p><h3 id="r-modification-de-l-ordre-des-forums" data-claire-element-id="618057">Modification de l'ordre des forums</h3><p id="r-618051" data-claire-element-id="618051">Voilà qui devient un peu plus intéressant :-° : je vous rappelle que dans la page admin.php, on avait créé un formulaire qui associait à chaque forum son numéro d'ordre ; il va donc falloir mettre les éventuelles modifications à jour dans la base de données.</p><p id="r-618052" data-claire-element-id="618052">Pour cela, on est obligés de faire une requête dans une boucle... Cependant, pour limiter un peu le nombre des requêtes, on vérifie d'abord si l'ordre a effectivement changé.</p><pre id="r-618053" data-claire-element-id="618053"><code data-claire-semantic="html+php">&lt;?php
       elseif($_GET['e'] == &quot;ordref&quot;)
        {
            //On récupère les id et l'ordre de tous les forums
            $query=$db-&gt;query('SELECT forum_id, forum_ordre FROM forum_forum');
            
            //On boucle les résultats
            while($data= $query-&gt;fetch())
            {
                $ordre = (int) $_POST[$data['forum_id']]; 
        
                //Si et seulement si l'ordre est différent de l'ancien, on le met à jour
                if ($data['forum_ordre'] != $ordre)
                {
                    $query=$db-&gt;prepare('UPDATE forum_forum SET forum_ordre = :ordre
                    WHERE forum_id = :id');
                    $query-&gt;bindValue(':ordre',$ordre,PDO::PARAM_INT);
                    $query-&gt;bindValue(':id',$data['forum_id'],PDO::PARAM_INT);
                    $query-&gt;execute();
                    $query-&gt;CloseCursor();
                }
            } 
        $query-&gt;CloseCursor();
        //Message
        echo'&lt;p&gt;L ordre a été modifié !&lt;br /&gt; 
        Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour revenir à l administration&lt;/p&gt;';
        }
?&gt;</code></pre><p id="r-618054" data-claire-element-id="618054">Si vous ne comprenez pas le</p><pre id="r-618055" data-claire-element-id="618055"><code data-claire-semantic="html+php">&lt;? $ordre = (int) $_POST[$data['forum_id']] ?&gt;</code></pre><p id="r-618056" data-claire-element-id="618056">c'est en rapport avec la page admin.php, la valeur des ordres s'obtient en faisant $_POST['id_du_forum'].</p><h3 id="r-changer-l-ordre-des-categories" data-claire-element-id="618060">Changer l'ordre des catégories</h3><p id="r-618058" data-claire-element-id="618058">Assez similaire : on va encore une fois faire une requête dans la boucle, qu'on limitera un peu avec la condition qui vérifie si l'ordre a bien changé avant de le mettre à jour.</p><pre id="r-618059" data-claire-element-id="618059"><code data-claire-semantic="html+php">&lt;?php
       elseif($_GET['e'] == &quot;ordrec&quot;)
        {
    
            //On récupère les id et les ordres de toutes les catégories
            $query=$db-&gt;query('SELECT cat_id, cat_ordre FROM forum_categorie');
        
            //On boucle le tout
            while($data = $query-&gt;fetch())
            {
                $ordre = (int) $_POST[$data['cat_id']]; 
        
                //On met à jour si l'ordre a changé
                if($data['cat_ordre'] != $ordre)
                {
                    $query=$db-&gt;prepare('UPDATE forum_categorie SET cat_ordre = :ordre
                    WHERE cat_id = :id');
                    $query-&gt;bindValue(':ordre',$ordre,PDO::PARAM_INT);
                    $query-&gt;bindValue(':id',$data['cat_id'],PDO::PARAM_INT);
                    $query-&gt;execute();
                    $query-&gt;CloseCursor();
                }
            }
        echo'&lt;p&gt;L ordre a été modifié !&lt;br /&gt;
        Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour revenir à l administration&lt;/p&gt;';
        }
    break;
?&gt;</code></pre><h2 id="r-les-droits-2" data-claire-element-id="618069">Les droits</h2><p id="r-618062" data-claire-element-id="618062">Pour les droits du forum, il faut récupérer les données pour 5 variables, auth_view, auth_post, auth_topic, etc. En clair, toutes les variables qui vont servir à remplir les champs qui ont un rapport avec les autorisations.</p><p id="r-618063" data-claire-element-id="618063">Heureusement pour nous, le travail a été mâché dans la page précédente ; il ne restera plus qu'à faire comme ceci pour obtenir la valeur de la variable que l'on cherche :</p><pre id="r-618064" data-claire-element-id="618064"><code data-claire-semantic="html+php">&lt;?php
$auth_view = (int) $_POST['auth_view']; 
?&gt;</code></pre><p id="r-618065" data-claire-element-id="618065">Voci alors le code :</p><pre id="r-618066" data-claire-element-id="618066"><code data-claire-semantic="html+php">&lt;?php
    case &quot;droits&quot;:    
        //Récupération d'informations
        $auth_view = (int) $_POST['auth_view'];
        $auth_post = (int) $_POST['auth_post'];
        $auth_topic = (int) $_POST['auth_topic'];
        $auth_annonce = (int) $_POST['auth_annonce'];
        $auth_modo = (int) $_POST['auth_modo'];
        
        //Mise à jour
        $query=$db-&gt;prepare('UPDATE forum_forum
        SET auth_view = :view, auth_post = :post, auth_topic = :topic,
        auth_annonce = :annonce, auth_modo = :modo WHERE forum_id = :id');
        $query-&gt;bindValue(':view',$auth_view,PDO::PARAM_INT);
        $query-&gt;bindValue(':post',$auth_post,PDO::PARAM_INT);
        $query-&gt;bindValue(':topic',$auth_topic,PDO::PARAM_INT);
        $query-&gt;bindValue(':annonce',$auth_annonce,PDO::PARAM_INT);
        $query-&gt;bindValue(':modo',$auth_modo,PDO::PARAM_INT);
        $query-&gt;bindValue(':id',(int) $_POST['forum_id'],PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;CloseCursor();
      
        //Message
        echo'&lt;p&gt;Les droits ont été modifiés !&lt;br /&gt;
        Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour revenir à l administration&lt;/p&gt;';
    break;
    } //Fin du switch
break; 
?&gt;</code></pre><p id="r-618067" data-claire-element-id="618067">Voici alors le code :</p><p id="r-618068" data-claire-element-id="618068">Rien de bien compliqué donc, et du coup la partie forum est achevée. Il ne nous reste plus qu'à nous occuper des membres, et ça sera enfin terminé :) .</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
<span class="arrow"></span>
<span class="next">Configuration</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
<span class="next">Gestion des membres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gestiondesmembres"></a><h2>Gestion des membres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
<span class="arrow"></span>
<span class="next">Gestion des forums</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">
<span class="next">Quelques fonctions en plus</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618071" data-claire-element-id="618071">Allez : un dernier effort, et on est arrivés :p .On va s'occuper ici du traitement des informations envoyées par la page admin.php et concernant les membres.</p><h2 id="r-edition-du-profil" data-claire-element-id="618078">Édition du profil</h2><p id="r-618072" data-claire-element-id="618072">Bon : ça commence vraiment tranquillement pour nous, l'édition du profil d'un membre est une pure copie de la page voirprofil.php (vous vous souvenez, la page sur la modification du profil par un membre). Il y a deux différences majeures.<br/> La première est que vous devez permettre aux administrateurs, <strong>et seulement aux administrateurs</strong> d'accéder à cette page. <br/> La seconde est que cette fois, la modification du pseudo doit être prise en compte.</p><p id="r-618073" data-claire-element-id="618073">Je vous laisse faire cette partie du code seuls ; vous ne devriez pas rencontrer trop de difficultés... D'ailleurs, dans ma grande bonté, je vais vous écrire la partie qui concerne le pseudo :</p><pre id="r-618074" data-claire-element-id="618074"><code data-claire-semantic="html+php">&lt;?php
//Le pseudo doit être unique !
//Il faut donc vérifier s'il a été modifié, si c'est le cas, on vérifie bien 
//l'unicité
$query=$db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_membres WHERE membre_pseudo =:pseudo');
$query-&gt;execute(array('pseudo'=&gt;$pseudo));
$pseudo_free=($query-&gt;fetchColumn()==0)?1:0;

    if(!$pseudo_free)
    {
        $pseudo_erreur1 = &quot;Votre pseudo est déjà utilisé par un membre&quot;;
        $i++;
    }
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618075" data-claire-element-id="618075">Pensez aussi à vérifier la longueur du pseudo par rapport aux variables fixées dans la table forum_config... Ça fera une première utilisation pour ce système.</p><aside id="r-618077" data-claire-element-id="618077" data-claire-semantic="warning"><p id="r-618076" data-claire-element-id="618076">N'oubliez pas de mettre le case &quot;membres&quot;: avant votre script.</p></aside><h2 id="r-les-droits-du-membre" data-claire-element-id="618082">Les droits du membre</h2><p id="r-618079" data-claire-element-id="618079">Cette partie va sûrement vous réjouir, car le script est très court, mais alors vraiment très court. En fait, il suffit de récupérer la valeur du pseudo, passée par un champ caché, et la valeur du rang qui est, elle, passée par la liste déroulante.<br/> Ensuite, on met à jour la base de données, et au final ça donne cela :</p><pre id="r-618080" data-claire-element-id="618080"><code data-claire-semantic="html+php">&lt;?php
    case &quot;droits&quot;:
	$membre =$_POST['pseudo'];
	$rang = (int) $_POST['droits'];
	$query=$db-&gt;prepare('UPDATE forum_membres SET membre_rang = :rang
	WHERE LOWER(membre_pseudo) = :pseudo');
        $query-&gt;bindValue(':rang',$rang,PDO::PARAM_INT);
        $query-&gt;bindValue(':pseudo',strtolower($membre), PDO::PARAM_STR);
        $query-&gt;execute();
        $query-&gt;CloseCursor();
	echo'&lt;p&gt;Le niveau du membre a été modifié !&lt;br /&gt;
	Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour revenir à l administration&lt;/p&gt;';
    break;
?&gt;</code></pre><p id="r-618081" data-claire-element-id="618081">Vous pouvez donc maintenant vous amuser à promouvoir de nouveaux administrateurs, des modérateurs ou encore à bannir des membres... Remarquez qu'on va voir tout de suite une méthode plus efficace.</p><h2 id="r-le-bannissement-1" data-claire-element-id="618096">Le bannissement</h2><p id="r-618083" data-claire-element-id="618083">On arrive au bannissement : dernière étape, mais aussi la plus délicate (encore que ça reste acceptable) de la partie membre.<br/> Je rappelle qu'ici on peut à la fois bannir <strong>et</strong> débannir des utilisateurs. Il faut donc prendre en compte ces deux aspects.</p><p id="r-618084" data-claire-element-id="618084">Donc, on s'occupe dans un premier temps de récupérer le pseudo du membre prêt à être banni, on vérifie qu'il existe et on met à jour son rang à 0.<br/> Ensuite, on récupère les id des membres prêts à être débannis, et on met leur rang à 2. Ils deviendront alors de simples membres ; pour changer à nouveau leur rang, vous savez comment faire, maintenant ^^ .</p><pre id="r-618085" data-claire-element-id="618085"><code data-claire-semantic="html+php">&lt;?php
    case &quot;ban&quot;:
        //Bannissement dans un premier temps
        //Si jamais on n'a pas laissé vide le champ pour le pseudo
        if (isset($_POST['membre']) AND !empty($_POST['membre']))
        {
            $membre = $_POST['membre'];
            $query=$db-&gt;prepare('SELECT membre_id 
            FROM forum_membres WHERE LOWER(membre_pseudo) = :pseudo');    
            $query-&gt;bindValue(':pseudo',strtolower($membre), PDO::PARAM_STR);
            $query-&gt;execute();
            //Si le membre existe
            if ($data = $query-&gt;fetch())
            {
                //On le bannit
                $query=$db-&gt;prepare('UPDATE forum_membres SET membre_rang = 0 
                WHERE membre_id = :id');
                $query-&gt;bindValue(':id',$data['membre_id'], PDO::PARAM_INT);
                $query-&gt;execute();
                $query-&gt;CloseCursor();
                echo'&lt;br /&gt;&lt;br /&gt;
                Le membre '.stripslashes(htmlspecialchars($membre)).' a bien été banni !&lt;br /&gt;';
            }
            else 
            {
                echo'&lt;p&gt;Désolé, le membre '.stripslashes(htmlspecialchars($membre)).' n existe pas !
                &lt;br /&gt;
                Cliquez &lt;a href=&quot;./admin.php?cat=membres&amp;action=ban&quot;&gt;ici&lt;/a&gt; 
                pour réessayer&lt;/p&gt;';
            }
        }
        //Debannissement ici        
        $query = $db-&gt;query('SELECT membre_id FROM forum_membres 
        WHERE membre_rang = 0');
        //Si on veut débannir au moins un membre
        if ($query-&gt;rowCount() &gt; 0)
        {
	    $i=0;
            while($data= $query-&gt;fetch())
            {
                if(isset($_POST[$data'membre_id']]))
                {
	            $i++;
                    //On remet son rang à 2
                    $query=$db-&gt;prepare('UPDATE forum_membres SET membre_rang = 2 
                    WHERE membre_id = :id');
                    $query-&gt;bindValue(':id',$data['membre_id'],PDO::PARAM_INT);
                    $query-&gt;execute();
                    $query-&gt;CloseCursor();
                }
            }
	    if ($i!=0)
            echo'&lt;p&gt;Les membres ont été débannis&lt;br /&gt;
            Cliquez &lt;a href=&quot;./admin.php&quot;&gt;ici&lt;/a&gt; pour retourner à l administration&lt;/p&gt;';
        }
    break;
    }
break;
}
?&gt;</code></pre><p id="r-618086" data-claire-element-id="618086">Code un peu plus long, certes, mais pas bien compliqué : en fait, il faut simplement faire gaffe à ne pas mélanger les deux cas. Le script a été bien commenté, et je ne pense pas qu'il pose de problèmes de compréhension. Si jamais c'est le cas, regardez à nouveau la page admin.php, et ne continuez que lorsque c'est assimilé.</p><p id="r-618087" data-claire-element-id="618087">Bon bah, comme on dit, ça, c'est fait :D . La partie administration est mise en place... Ça fait certes des pages assez longues et plutôt indigestes, c'est pourquoi je vous conseille de séparer chaque cas en le mettant dans une page à part, que vous inclurez grâce à la fonction include.</p><p id="r-618088" data-claire-element-id="618088">Après, c'est à vous de voir. :p</p><p id="r-618089" data-claire-element-id="618089">Avant de vous laisser vous éclater avec le panneau d'admin, j'aimerais vous lancer sur quelques pistes pour améliorer un peu ces pages, et les compléter avec plus d'options.</p><ul id="r-618094" data-claire-element-id="618094"><li id="r-618091" data-claire-element-id="618091"><p id="r-618090" data-claire-element-id="618090">Permettre de supprimer un forum.</p></li><li id="r-618093" data-claire-element-id="618093"><p id="r-618092" data-claire-element-id="618092">Déplacer tout le contenu d'un forum vers un autre :<br/> cette option est pratique, et en même temps assez simple : il vous suffit en effet de modifier la valeur de post_forum, topic_forum, forum_post, forum_topic. Le tout peut être fait en 3 ou 4 requêtes.</p></li></ul><p id="r-618095" data-claire-element-id="618095">Allez ! Sur ces belles paroles, je vous laisse à votre forum, et je vous donne rendez-vous dans la partie suivante du tuto pour voir ensemble des options sympas à ajouter au forum (système de lu / non-lu, par exemple :p ).</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
<span class="arrow"></span>
<span class="next">Gestion des forums</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">
<span class="next">Quelques fonctions en plus</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Quelquesfonctionsenplus"></a><h2>Quelques fonctions en plus</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
<span class="arrow"></span>
<span class="next">Gestion des membres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
<span class="next">Système lu / non-lu</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-618101" data-claire-element-id="618101">Cette partie a été créée pour ceux qui désirent améliorer leur forum, mais qui ne savent pas trop par où commencer. Je vais donc indiquer quelques fonctionnalités supplémentaires qu'il est facile de mettre en place. Bien entendu, il ne s'agit que de quelques pistes, c'est à vous de <strong>personnaliser </strong>votre forum (sinon, ça ne sert à rien de le faire soi-même).</p><p id="r-618102" data-claire-element-id="618102">Le premier système que nous allons voir est quasiment indispensable sur un forum : il s'agit du fameux système lu / non-lu concernant les messages.</p><p id="r-618103" data-claire-element-id="618103">Le deuxième système est celui de l'affichage des membres / non-membres (qui est en ligne ?).</p>
</div><a name="Systmelu_non-lu"></a><h2>Système lu / non-lu</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">
<span class="arrow"></span>
<span class="next">Quelques fonctions en plus</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
<span class="next">Qui est en ligne ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618104" data-claire-element-id="618104">Avant de commencer, j'aimerais insister sur le fait qu'il existe un très bon tuto sur la question ici-même : <a href="http://www.siteduzero.com/tuto-3-8770-1-timestamp-messages-lus-non-lus.html">lien</a>.</p><p id="r-618105" data-claire-element-id="618105">Mais ici, on va voir comment faire un système plus à la SDZ, avec possibilité de se rendre au dernier message non-lu.</p><h2 id="r-comment-on-s-y-prend" data-claire-element-id="618155">Comment on s'y prend ?</h2><p id="r-618106" data-claire-element-id="618106">Pour faire un système de ce type, on va avoir besoin d'une nouvelle table, qui s'appelle forum_topic_view ( :lol: ) ; voici comment elle se compose :</p><ul id="r-618115" data-claire-element-id="618115"><li id="r-618108" data-claire-element-id="618108"><p id="r-618107" data-claire-element-id="618107">un champ <strong>tv_id</strong> qui contient l'id du membre</p></li><li id="r-618110" data-claire-element-id="618110"><p id="r-618109" data-claire-element-id="618109">un champ <strong>tv_topic_id</strong> qui contient l'id du topic</p></li><li id="r-618112" data-claire-element-id="618112"><p id="r-618111" data-claire-element-id="618111">un champ <strong>tv_post_id</strong> qui contient l'id du dernier post lu du topic</p></li><li id="r-618114" data-claire-element-id="618114"><p id="r-618113" data-claire-element-id="618113">un champ <strong>tv_poste</strong>, qui contient 0 ou 1 si on a posté ou non dans le topic.</p></li></ul><p id="r-618116" data-claire-element-id="618116">Vous pouvez comprendre qu'elle va servir à relier les id de chaque membre avec les topics qu'ils ont consultés, mais elle peut aussi faire plein d'autres choses qu'on verra en leur temps ^^ .</p><p id="r-618117" data-claire-element-id="618117">Voici la requête pour créer la table :</p><pre id="r-618118" data-claire-element-id="618118"><code data-claire-semantic="sql">CREATE TABLE `forum_topic_view` (
`tv_id` INT( 11 ) NOT NULL ,
`tv_topic_id` INT( 11 ) NOT NULL ,
`tv_forum_id` INT( 11 ) NOT NULL ,
`tv_post_id` INT( 11 ) NOT NULL ,
`tv_poste` ENUM( '0', '1' ) NOT NULL,
PRIMARY KEY  (`tv_id`,`tv_topic_id`)
) TYPE = MYISAM ;</code></pre><p id="r-618119" data-claire-element-id="618119">Ensuite, il va vous falloir 5 images, <br/> une pour les messages non-lus, <br/> une pour les messages lus dans un topic où le membre a posté,<br/> une pour les messages non-lus dans un topic où le membre a posté, <br/> une pour les messages non-lus dans un topic que le membre a consulté <br/> et une pour les messages déjà lus.</p><p id="r-618120" data-claire-element-id="618120">Je les ai appelées respectivement :</p><div id="r-618153" data-claire-element-id="618153"><table id="r-618152" data-claire-element-id="618152"><tbody id="r-618151" data-claire-element-id="618151"><tr id="r-618126" data-claire-element-id="618126"><td id="r-618122" data-claire-element-id="618122"><p id="r-618121" data-claire-element-id="618121">message_non_lu.gif</p></td><td id="r-618124" data-claire-element-id="618125"><img id="r-618125" data-claire-element-id="618124" src="medias/uploads.siteduzero.com_files_132001_133000_132715.png" alt="Image utilisateur"/><img id="r-618123" data-claire-element-id="618123" src="medias/uploads.siteduzero.com_files_132001_133000_132715.png" alt="Image utilisateur"/></td></tr><tr id="r-618132" data-claire-element-id="618132"><td id="r-618128" data-claire-element-id="618128"><p id="r-618127" data-claire-element-id="618127">messagep_lu.gif</p></td><td id="r-618130" data-claire-element-id="618131"><img id="r-618131" data-claire-element-id="618130" src="medias/uploads.siteduzero.com_files_132001_133000_132712.png" alt="Image utilisateur"/><img id="r-618129" data-claire-element-id="618129" src="medias/uploads.siteduzero.com_files_132001_133000_132712.png" alt="Image utilisateur"/></td></tr><tr id="r-618138" data-claire-element-id="618138"><td id="r-618134" data-claire-element-id="618134"><p id="r-618133" data-claire-element-id="618133">messagep_non_lu.gif</p></td><td id="r-618136" data-claire-element-id="618137"><img id="r-618137" data-claire-element-id="618136" src="medias/uploads.siteduzero.com_files_132001_133000_132714.png" alt="Image utilisateur"/><img id="r-618135" data-claire-element-id="618135" src="medias/uploads.siteduzero.com_files_132001_133000_132714.png" alt="Image utilisateur"/></td></tr><tr id="r-618144" data-claire-element-id="618144"><td id="r-618140" data-claire-element-id="618140"><p id="r-618139" data-claire-element-id="618139">messagec_non_lus.gif</p></td><td id="r-618142" data-claire-element-id="618143"><img id="r-618143" data-claire-element-id="618142" src="medias/uploads.siteduzero.com_files_132001_133000_132711.png" alt="Image utilisateur"/><img id="r-618141" data-claire-element-id="618141" src="medias/uploads.siteduzero.com_files_132001_133000_132711.png" alt="Image utilisateur"/></td></tr><tr id="r-618150" data-claire-element-id="618150"><td id="r-618146" data-claire-element-id="618146"><p id="r-618145" data-claire-element-id="618145">message.gif</p></td><td id="r-618148" data-claire-element-id="618149"><img id="r-618149" data-claire-element-id="618148" src="medias/uploads.siteduzero.com_files_132001_133000_132713.png" alt="Image utilisateur"/><img id="r-618147" data-claire-element-id="618147" src="medias/uploads.siteduzero.com_files_132001_133000_132713.png" alt="Image utilisateur"/></td></tr></tbody></table></div><p id="r-618154" data-claire-element-id="618154">Voici pour les correspondances avec le SDZ, on peut remarquer que le site ne fait pas de distinction entre message simple non lu et message consulté non lu (en réalité une petite flèche est ajoutée nous permettant d'aller au dernier post lu).</p><h2 id="r-modification-des-pages-php-information" data-claire-element-id="618174">Modification des pages php (Information)</h2><p id="r-618156" data-claire-element-id="618156">Bon. Jusqu'ici tout va bien, c'est maintenant qu'il va falloir s'accrocher un peu ^^ . On va tout d'abord s'occuper de la récupération d'informations, puis on verra l'affichage ensuite.</p><h3 id="r-page-voirtopic-php-1" data-claire-element-id="618164">Page voirtopic.php</h3><p id="r-618157" data-claire-element-id="618157">Donc, il faut ouvrir la page <strong>voirtopic.php</strong> : c'est en visitant celle-ci que le membre consulte un topic, et on va tout simplement faire une requête qui envoie le résultat à savoir : <br/> - l'id du membre qu'on obtient avec $id<br/> - l'id du topic qui est obtenu en GET (elle est contenu dans la variable $topic) <br/> - et enfin, l'id du dernier message qui est connue grâce à la requête placée au début, et qui récupère des infos sur le topic, la variable est donc $data['topic_last_post'].</p><aside id="r-618159" data-claire-element-id="618159" data-claire-semantic="information"><p id="r-618158" data-claire-element-id="618158">Pensez à vous assurer que le membre est bien connecté avant de faire cette requête</p></aside><p id="r-618160" data-claire-element-id="618160">Mais ce n'est pas tout : il faut également regarder s'il n'existe pas déjà une entrée avec ce topic et ce membre ; si c'est le cas, c'est-à-dire si le membre a déjà visité le topic, il faudra simplement mettre à jour la valeur du champ tv_post_id.</p><p id="r-618161" data-claire-element-id="618161">Voici le script :</p><pre id="r-618162" data-claire-element-id="618162"><code data-claire-semantic="html+php">&lt;?php
//Topic déjà consulté ?
$query=$db-&gt;prepare('SELECT COUNT(*) FROM forum_topic_view WHERE tv_topic_id = :topic AND tv_id = :id');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;execute();
$nbr_vu=$query-&gt;fetchColumn();
$query-&gt;CloseCursor();
if ($nbr_vu == 0) //Si c'est la première fois on insère une ligne entière
{
    $query=$db-&gt;prepare('INSERT INTO forum_topic_view 
    (tv_id, tv_topic_id, tv_forum_id, tv_post_id)
    VALUES (:id, :topic, :forum, :last_post)');
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
    $query-&gt;bindValue(':last_post',$data['topic_last_post'],PDO::PARAM_INT);
    $query-&gt;execute();
    $query-&gt;CloseCursor();
      
}
else //Sinon, on met simplement à jour
{
    $query=$db-&gt;prepare('UPDATE forum_topic_view SET tv_post_id = :last_post 
    WHERE tv_topic_id = :topic 
    AND tv_id = :id');
    $query-&gt;bindValue(':last_post',$data['topic_last_post'],PDO::PARAM_INT);
    $query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
    $query-&gt;execute();
    $query-&gt;CloseCursor();
}
?&gt;</code></pre><p id="r-618163" data-claire-element-id="618163">Il est inutile de s'occuper ici du champ tv_poste, il reste à 0, mais on se chargera de son cas dans 2 secondes ^^ .</p><h3 id="r-page-postok-php-2" data-claire-element-id="618173">Page postok.php</h3><p id="r-618165" data-claire-element-id="618165">Sur cette page, il va falloir faire deux choses : si on crée un nouveau topic, il faudra ajouter une ligne dans la table forum_topic_view, exactement comme on vient de le faire. Par contre, si on envoie une réponse, il faudra mettre à jour cette table, on changera ainsi la valeur de tv_post_id et tv_poste.</p><p id="r-618166" data-claire-element-id="618166">Donc, dans la partie du switch traitant d'un nouveau topic, vous devez placer, juste avant le echo, le code suivant :</p><p id="r-618167" data-claire-element-id="618167"><strong>Page : postok.php</strong></p><pre id="r-618168" data-claire-element-id="618168"><code data-claire-semantic="html+php">&lt;?php
//On ajoute une ligne dans la table forum_topic_view
$query=$db-&gt;prepare('INSERT INTO forum_topic_view 
(tv_id, tv_topic_id, tv_forum_id, tv_post_id, tv_poste) 
VALUES(:id, :topic, :forum, :post, :poste)');
$query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;bindValue(':topic',$nouveautopic,PDO::PARAM_INT);
$query-&gt;bindValue(':forum',$forum ,PDO::PARAM_INT);
$query-&gt;bindValue(':post',$nouveaupost,PDO::PARAM_INT);
$query-&gt;bindValue(':poste','1',PDO::PARAM_STR);
$query-&gt;execute();
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618169" data-claire-element-id="618169">Et de même, dans la partie traitant des réponses :</p><pre id="r-618170" data-claire-element-id="618170"><code data-claire-semantic="html+php">&lt;?php
//On update la table forum_topic_view
$query=$db-&gt;prepare('UPDATE forum_topic_view 
SET tv_post_id = :post, tv_poste = :poste
WHERE tv_id = :id AND tv_topic_id = :topic')
$query-&gt;bindValue(':post',$nouveaupost,PDO::PARAM_INT);
$query-&gt;bindValue(':poste','1',PDO::PARAM_STR);
$query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618171" data-claire-element-id="618171">Si vous ne vous souvenez plus des variables utilisées, regardez un coup votre code, ou alors reprenez le chapitre en question. Vous voyez que tout est déjà en place : en fait, il ne reste plus qu'à appliquer ce qu'on a dit plus haut :) .</p><p id="r-618172" data-claire-element-id="618172">Bon, c'en est terminé pour la première partie ; on va maintenant passer à la gestion de l'affichage, qui est un peu plus tordue.</p><h2 id="r-modification-des-pages-php-affichage" data-claire-element-id="618199">Modification des pages php (Affichage)</h2><h3 id="r-page-voirforum-php" data-claire-element-id="618196">Page voirforum.php</h3><p id="r-618175" data-claire-element-id="618175">Alors, j'espère que vous êtes prêts, parce que la suite va demander un peu plus d'attention. <br/> Déjà ouvrez la page <strong>voirforum.php</strong> : il va falloir modifier les deux requêtes qui listent les sujets, afin d'y associer la table forum_topic_view.<br/> Pour cela, une jointure sera très utile : on pourra récupérer la valeur de tv_id et de tv_topic_id, et tout se déroulera parfaitement ; mais il ne faut pas oublier une chose : <strong>un visiteur n'est pas forcément connecté</strong>, et c'est là que ça se corse un peu, il va falloir discerner les cas une fois de plus.</p><p id="r-618176" data-claire-element-id="618176">En fait, la requête va être modifiée à deux endroits, selon qu'on est connecté ou non (pour la sélection des champs et pour la jointure) ; en effet, si on est un simple invité, inutile d'inclure la table forum_topic_view, puisqu'on marquera alors tous les messages comme déjà lus.<br/> Donc, ce que l'on va faire, c'est créer deux variables : elles contiendront une portion de la requête si le membre est connecté, et rien si ce n'est pas le cas.</p><p id="r-618177" data-claire-element-id="618177">J'imagine que c'est difficile à comprendre avec des mots, alors je vous montre la première partie du script : elle se trouve juste avant la première grosse requête qui liste les annonces :) .</p><pre id="r-618178" data-claire-element-id="618178"><code data-claire-semantic="html+php">&lt;?php
$add1='';
$add2='';
if ($id!=0) //on est connecté 
{
//Premièrement, sélection des champs
$add1 = 'tv_id, tv_post_id, tv_poste'; 
//Deuxièmement, jointure
$add2 = 'LEFT JOIN forum_topic_view 
ON forum_topic.topic_id = forum_topic_view.tv_topic_id AND forum_topic_view.tv_id = :id';
}
?&gt;</code></pre><p id="r-618179" data-claire-element-id="618179">Les variables $add1 et $add2 contiennent donc une partie de la requête : s'ils ne sont pas renseignés, alors la jointure ne se fera pas, et on n'y verra que du feu ^^ .</p><p id="r-618180" data-claire-element-id="618180">J'en profite pour expliquer un peu cette ligne :</p><pre id="r-618181" data-claire-element-id="618181"><code data-claire-semantic="sql">ON forum_topic.topic_id = forum_topic_view.tv_topic_id AND forum_topic_view.tv_id = blablabla</code></pre><p id="r-618182" data-claire-element-id="618182">En fait, on veut inclure la table forum_topic_view, mais pas entièrement ; sinon, lors de l'affichage, on aurait sur la page autant de fois un topic qu'il a été vu par les membres, ce qui n'est pas forcément très intéressant, quand on y pense ^^ . Donc, on ajoute une condition sur le ON, qui récupère uniquement les lignes de la table qui nous intéressent, à savoir celles qui concernent le membre en question.</p><p id="r-618183" data-claire-element-id="618183">Pour la suite, il va falloir reprendre la requête de cette façon :</p><pre id="r-618184" data-claire-element-id="618184"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT forum_topic.topic_id, topic_titre, topic_createur, topic_vu, topic_post, topic_time, topic_last_post, topic_locked,
Mb.membre_pseudo AS membre_pseudo_createur, post_createur, post_time, Ma.membre_pseudo AS membre_pseudo_last_posteur, 
'.$add1.' post_id FROM forum_topic 
LEFT JOIN forum_membres Mb ON Mb.membre_id = forum_topic.topic_createur
LEFT JOIN forum_post ON forum_topic.topic_last_post = forum_post.post_id
LEFT JOIN forum_membres Ma ON Ma.membre_id = forum_post.post_createur
'.$add2.'
WHERE topic_genre = &quot;Annonce&quot; AND forum_topic.forum_id = :forum 
ORDER BY topic_last_post DESC');
$query-&gt;bindValue(':forum',$forum,PDO::PARAM_INT);
if ($id!=0) $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;execute();

?&gt;</code></pre><p id="r-618185" data-claire-element-id="618185">Ainsi, il n'y aura plus d'erreurs si vous visitez la page en tant qu'invité !<br/> Je vous laisse faire de même pour les topics normaux.</p><p id="r-618186" data-claire-element-id="618186">Passons à présent à la sélection de l'icône à afficher. Il s'agit d'un gros enchevêtrement de if / else, donc il ne faut surtout pas perdre de vue ce que l'on fait.</p><pre id="r-618187" data-claire-element-id="618187"><code data-claire-semantic="html+php">&lt;?php
//Gestion de l'image à afficher
if (!empty($id)) // Si le membre est connecté
{
    if ($data['tv_id'] == $id) //S'il a lu le topic
    {
        if ($data['tv_poste'] == '0') // S'il n'a pas posté
        {
            if ($data['tv_post_id'] == $data['topic_last_post']) //S'il n'y a pas de nouveau message
            {
                $ico_mess = 'message.gif';
            }
            else
            {
                $ico_mess = 'messagec_non_lus.gif'; //S'il y a un nouveau message
            }
        }
        else // S'il a  posté
        {
            if ($data['tv_post_id'] == $data['topic_last_post']) //S'il n'y a pas de nouveau message
            {
                $ico_mess = 'messagep_lu.gif';
            }
            else //S'il y a un nouveau message
            {
                $ico_mess = 'messagep_non_lu.gif';
            }
        }
    }
    else //S'il n'a pas lu le topic
    {
        $ico_mess = 'message_non_lu.gif';
    }
} //S'il n'est pas connecté
else
{
    $ico_mess = 'message.gif';
}
?&gt;</code></pre><p id="r-618188" data-claire-element-id="618188">Piuf, ça fait des cas différents, mais au moins tout est pris en compte. J'espère que les commentaires vous ont aidés à comprendre comment ça fonctionne ; sinon, essayez avec des topics, et vous verrez que ça marche ^^ .</p><p id="r-618189" data-claire-element-id="618189">Il ne vous reste maintenant plus qu'à afficher la valeur de $ico_mess de la façon suivante :</p><pre id="r-618190" data-claire-element-id="618190"><code data-claire-semantic="html+php">echo'&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;./images/'.$ico_mess.'&quot;&gt;&lt;/td&gt;';</code></pre><p id="r-618191" data-claire-element-id="618191">Et ce, à la place de l'ancien echo, qui faisait simplement</p><pre id="r-618192" data-claire-element-id="618192"><code data-claire-semantic="html+php">echo'&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;./images/annonce.gif&quot;&gt;&lt;/td&gt;';</code></pre><aside id="r-618194" data-claire-element-id="618194" data-claire-semantic="warning"><p id="r-618193" data-claire-element-id="618193">N'hésitez surtout pas à relire le code, et à essayer de le refaire (d'ailleurs, il faut que vos le refassiez pour la liste des topics &quot;normaux&quot; ; je rappelle qu'ici il ne s'agit que des annonces).</p></aside><p id="r-618195" data-claire-element-id="618195">Maintenant, comme sur le SDZ, vous pouvez repérer plus facilement les topics où vous avez posté par rapport à ceux que vous avez simplement consultés.</p><h3 id="r-page-index-php" data-claire-element-id="618198">Page index.php</h3><p id="r-618197" data-claire-element-id="618197">Bon bah pour la page d'index, c'est la même affaire, je vais donc vous laisser vous débrouiller un peu seuls. La seule différence, c'est que cette fois on utilise le dernier post du forum, et non pas du topic. Il faut utiliser le champ tv_forum_id tout simplement.<br/> Donc, une fois la condition faite, vous entrez le résultat dans la variable $ico_mess, et puis le tour est joué : il vous suffit de recopier la série de conditions !</p><h2 id="r-faire-des-liens-sympas" data-claire-element-id="618202">Faire des liens sympas</h2><p id="r-618200" data-claire-element-id="618200">Le gros avantage de cette méthode est qu'il est possible de faire, encore une fois comme sur le SdZ, des liens qui nous listent directement les topics où l'on a posté, ceux que l'on a visités, etc.<br/> Donc, n'hésitez pas à vous amuser à en faire : non seulement ça sera un bon entraînement si vous avez compris la méthode, mais c'est toujours un plus pour les visiteurs (personnellement, j'utilise très souvent cette option et je suis très content qu'elle existe :) ).</p><p id="r-618201" data-claire-element-id="618201">Si vous avez un peu digéré, on va passer à une partie plus tranquille qui est la réalisation de la fonction &quot;Qui est en ligne ?&quot;.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">
<span class="arrow"></span>
<span class="next">Quelques fonctions en plus</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
<span class="next">Qui est en ligne ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Quiestenligne"></a><h2>Qui est en ligne ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
<span class="arrow"></span>
<span class="next">Système lu / non-lu</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">
<span class="next">Et encore trois autres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618204" data-claire-element-id="618204">Dans cette partie, nous allons voir comment afficher la liste de tous les membres connectés.</p><p id="r-618205" data-claire-element-id="618205">Ce système n'est pas très compliqué à réaliser : au final, il suffit d'entrer dans une table l'id du membre et sa date de dernière activité. En fait, c'est assez connu comme méthode, tellement qu'elle se trouve même dans les cours de M@teo21, <a href="http://www.siteduzero.com/tuto-3-174-1-tp-nombre-de-visiteurs-connectes.html">ici !</a>.</p><p id="r-618206" data-claire-element-id="618206">Mais nous, la différence, c'est qu'on veut également afficher le nom des personnes connectées et le nombre de visiteurs.</p><h2 id="r-la-base-de-donnees-12" data-claire-element-id="618214">La base de données</h2><div id="r-618208" data-claire-element-id="618208" data-claire-semantic="question"><p id="r-618207" data-claire-element-id="618207">Bah ça va, on la connaît ta table, elle est dans le tuto de M@teo !</p></div><p id="r-618209" data-claire-element-id="618209">Oui, mais pas seulement : en effet, comme on veut également compter le nombre de membres et afficher leur nom, il va falloir ajouter un champ à la table qui contient les id des visiteurs. S'ils ne sont pas connectés, celles-ci vaudront 0, sinon, on pourra obtenir leur nom avec une jointure SQL.</p><p id="r-618210" data-claire-element-id="618210">Voici donc la requête pour créer la table :</p><pre id="r-618211" data-claire-element-id="618211"><code data-claire-semantic="sql">CREATE TABLE `forum_whosonline` (
  `online_id` int(11) NOT NULL,
  `online_time` int(11) NOT NULL,
  `online_ip` int(15) NOT NULL,
  PRIMARY KEY  (`online_ip`)
) ENGINE=MyISAM</code></pre><aside id="r-618213" data-claire-element-id="618213" data-claire-semantic="information"><p id="r-618212" data-claire-element-id="618212">Contrairement à M@teo, j'utilise un type INT pour l'adresse IP : on pourra alors la convertir avant l'entrée, grâce à la fonction <a href="http://fr.php.net/ip2long">ip2long</a>.</p></aside><h2 id="r-un-petit-boulot-pour-vous" data-claire-element-id="618221">Un petit boulot pour vous</h2><p id="r-618215" data-claire-element-id="618215">Bon bah, c'est à vous de jouer cette fois, je ne vais pas vous demander un boulot monstre non plus, mais je tiens à vous garder éveillés, et à éviter les bêtes copier / coller.<br/> Donc, vous allez insérer le code suivant ; vous pouvez le mettre dans la page <strong>debut.php</strong>.</p><pre id="r-618216" data-claire-element-id="618216"><code data-claire-semantic="html+php">&lt;?php
//Création des variables
$ip = ip2long($_SERVER['REMOTE_ADDR']);

//Requête
$query=$db-&gt;prepare('INSERT INTO forum_whosonline VALUES(:id, :time,:ip)
ON DUPLICATE KEY UPDATE
online_time = :time , online_id = :id');
$query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;bindValue(':time',time(), PDO::PARAM_INT);
$query-&gt;bindValue(':ip', $ip, PDO::PARAM_INT);
$query-&gt;execute();
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618217" data-claire-element-id="618217">Cette méthode est la même que celle de M@teo, mais en plus rapide : en effet, on ne cherche pas à savoir si l'ip se trouve déjà dans la table, on l'écrase si c'est le cas, et on met à jour le temps, et on ajoute une ligne si ce n'est pas le cas. C'est à ça que sert le DUPLICATE KEY UPDATE, et c'est aussi pour cela qu'on a mis une clé primaire sur l'ip.</p><p id="r-618218" data-claire-element-id="618218">Ensuite, de la même manière, il va falloir supprimer les entrées trop vieilles : pour cela, à la suite de ce que vous venez d'écrire, mettez ceci.</p><pre id="r-618219" data-claire-element-id="618219"><code data-claire-semantic="html+php">&lt;?php
$time_max = time() - (60 * 5);
$query=$db-&gt;prepare('DELETE FROM forum_whosonline WHERE online_time &lt; :timemax');
$query-&gt;bindValue(':timemax',$time_max, PDO::PARAM_INT);
$query-&gt;execute();
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618220" data-claire-element-id="618220">Jusqu'ici pas de problème, la suite devrait passer tranquillement aussi ^^ .</p><h2 id="r-affichage-10" data-claire-element-id="618237">Affichage</h2><p id="r-618222" data-claire-element-id="618222">Bon, il ne reste plus qu'à afficher tout ça sur le pied de page de <strong>la page d'index</strong> (ou le pied de page commun à chaque page, c'est à vous de voir :) ).</p><p id="r-618223" data-claire-element-id="618223">Tout d'abord on va compter un peu : le total des personnes sur le site est la somme visiteurs + membres ; il va donc falloir traduire cela en php.</p><p id="r-618224" data-claire-element-id="618224">Dans ce code, on fait deux requêtes : une pour les visiteurs, et une pour les membres connectés ; on obtient ainsi leur nombre, mais également des infos supplémentaires pour ces derniers : leur pseudo. On peut ainsi afficher la liste des personnes en lignes.</p><p id="r-618225" data-claire-element-id="618225">Pour afficher la liste, j'utilise une méthode nouvelle dans ce tuto : en fait, on stocke le texte à afficher dans une variable, à chaque fois on va ajouter le nouveau nom, suivi d'une virgule. A la fin, on enlève la dernière virgule (sinon, ça fait moche une virgule toute seule avec rien après ^^ ) grâce à la fonction substr.</p><pre id="r-618226" data-claire-element-id="618226"><code data-claire-semantic="html+php">&lt;?php
//Initialisation de la variable
$count_online = 0;

//Décompte des visiteurs
$count_visiteurs=$db-&gt;query('SELECT COUNT(*) AS nbr_visiteurs FROM forum_whosonline WHERE online_id = 0')-&gt;fetchColumn();
$query-&gt;CloseCursor();

//Décompte des membres
$texte_a_afficher = &quot;&lt;br /&gt;Liste des personnes en ligne : &quot;;
$time_max = time() - (60 * 5);
$query=$db-&gt;prepare('SELECT membre_id, membre_pseudo 
FROM forum_whosonline
LEFT JOIN forum_membres ON online_id = membre_id
WHERE online_time &gt; :timemax AND online_id &lt;&gt; 0');
$query-&gt;bindValue(':timemax',$time_max, PDO::PARAM_INT);
$query-&gt;execute();
$count_membres=0;
while ($data = $query-&gt;fetch())
{
	$count_membres ++;
	$texte_a_afficher .= '&lt;a href=&quot;./voirprofil.php?m='.$data['membre_id'].'&amp;amp;action=consulter&quot;&gt;
	'.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt; ,';
}

$texte_a_afficher = substr($texte_a_afficher, 0, -1);
$count_online = $count_visiteurs + $count_membres;
echo '&lt;p&gt;Il y a '.$count_online.' connectés ('.$count_membres.' membres et '.$count_visiteurs.' invités)';
echo $texte_a_afficher.'&lt;/p&gt;';
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618227" data-claire-element-id="618227">Et le tour est joué, il ne vous reste plus qu'à tester ça, et à l'améliorer comme ça vous amuse. :)</p><div id="r-618229" data-claire-element-id="618229" data-claire-semantic="question"><p id="r-618228" data-claire-element-id="618228">Hey ! Si je me déconnecte de mon compte je suis encore affiché en ligne ! Ca marche pas ton truc !</p></div><p id="r-618230" data-claire-element-id="618230">En effet c'est un problème, lors de la déconnexion le membre est encore affiché en ligne pendant 5 minutes.<br/> Donc il faut régler ça n'est ce pas ? Et bah aucun soucis, ouvrez la page <strong>deconnexion.php</strong> et faites ceci :</p><pre id="r-618231" data-claire-element-id="618231"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Déconnexion&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
session_destroy();
$query=$db-&gt;prepare('DELETE FROM forum_whosonline WHERE online_id= :id');
$query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;execute();
$query-&gt;CloseCursor();

?&gt;</code></pre><p id="r-618232" data-claire-element-id="618232">A la place du beaucoup plus sobre :</p><pre id="r-618233" data-claire-element-id="618233"><code data-claire-semantic="html+php">&lt;?
session_start();
session_destroy();
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
?&gt;</code></pre><p id="r-618234" data-claire-element-id="618234">Voilà : pour le coup, c'est tout. :)</p><p id="r-618235" data-claire-element-id="618235">J'ai présenté deux fonctionnalités importantes d'un forum, mais ce ne sont pas les seules : par exemple, un système de recherche peut être très utile pour faire gagner du temps aux membres :) (à ce sujet, je vous conseille <a href="http://www.siteduzero.com/tuto-3-5578-1-realiser-un-moteur-de-recherche-pour-son-site.html">ce tuto</a>).</p><p id="r-618236" data-claire-element-id="618236">Une remarque importante : il existe une autre façon d'afficher les messages lus / non-lus, qui se base sur la date de dernière connexion du membre ; elle n'utilise donc pas de nouvelles tables. Si vous voulez en savoir plus, je vous envoie au <a href="http://www.siteduzero.com/tuto-3-8770-1-timestamp-messages-lus-non-lus.html">tuto suivant</a>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
<span class="arrow"></span>
<span class="next">Système lu / non-lu</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">
<span class="next">Et encore trois autres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Etencoretroisautres"></a><h2>Et encore trois autres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
<span class="arrow"></span>
<span class="next">Qui est en ligne ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
<span class="next">La liste des membres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-618240" data-claire-element-id="618240">Dans ce chapitre nous allons étudier trois nouveaux systèmes qui pourront être ajouté à votre forum très facilement en ne modifiant que quelques pages.</p><p id="r-618241" data-claire-element-id="618241">Alors avant d'aller plus loin voilà ces trois fonctions :</p><ul id="r-618248" data-claire-element-id="618248"><li id="r-618243" data-claire-element-id="618243"><p id="r-618242" data-claire-element-id="618242">La liste de tous les membres</p></li><li id="r-618245" data-claire-element-id="618245"><p id="r-618244" data-claire-element-id="618244">Un système de gestion des amis</p></li><li id="r-618247" data-claire-element-id="618247"><p id="r-618246" data-claire-element-id="618246">Un système permettant d'envoyer des réponses automatiques par les modérateur</p></li></ul><p id="r-618249" data-claire-element-id="618249">Le second va demander un peu de modifications y compris dans la base de données mais de toute façon vous avez l'habitude maintenant ;) .</p><p id="r-618250" data-claire-element-id="618250">Bon bah on y va alors !</p>
</div><a name="Lalistedesmembres"></a><h2>La liste des membres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">
<span class="arrow"></span>
<span class="next">Et encore trois autres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
<span class="next">Gestion des amis</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618251" data-claire-element-id="618251">Avant de faire quoi que ce soit concernant les amis, il faut dresser un aspect communautaire à votre forum en installant une liste des membres.</p><p id="r-618252" data-claire-element-id="618252">Cette liste est vraiment simple à réaliser, il suffit en fait de faire une requête et d'afficher les résultats dans un tableau.</p><p id="r-618253" data-claire-element-id="618253">On va rapidement voir comment faire ça, tout d'abord il vous faut une nouvelle page que personnellement j'ai appelé memberlist.php, on commence un peu comme sur la page voirforum.php.</p><pre id="r-618254" data-claire-element-id="618254"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Liste des membres&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);

//A partir d'ici, on va compter le nombre de members
//pour n'afficher que les 25 premiers
$query=$db-&gt;query('SELECT COUNT(*) AS nbr FROM forum_membres');
$data = $query-&gt;fetch();

$total = $data['nbr'] +1;
$query-&gt;CloseCursor();
$MembreParPage = 25;
$NombreDePages = ceil($total / $MembreParPage);
echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; 
&lt;a href=&quot;./memberlist.php&quot;&gt;Liste des membres&lt;/a&gt;&lt;/p&gt;';

//Nombre de pages

$page = (isset($_GET['page']))?intval($_GET['page']):1;

//On affiche les pages 1-2-3, etc.
echo 'Page : ';
for ($i = 1 ; $i &lt;= $NombreDePages ; $i++)
{
    if ($i == $page) //On ne met pas de lien sur la page actuelle
    {
        echo $i;
    }
    else
    {
        echo '&lt;p&gt;&lt;a href=&quot;memberlist.php?page='.$i.'&quot;&gt;'.$i.'&lt;/a&gt;&lt;/p&gt;';
    }
}
echo '&lt;/p&gt;';

$premier = ($page - 1) * $MembreParPage;

//Le titre de la page
echo '&lt;h1&gt;Liste des membres&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';
?&gt;</code></pre><p id="r-618255" data-claire-element-id="618255">Là on a tout mis en place, arriver ici il faut pouvoir proposer au visiteur de classer les membres comme il le souhaite (par pseudo, age, date de naissance...). Pour le nombre de classement et leur nature c'est à vous de voir, pour ma part j'ai uniquement mis 4 propositions, le pseudo, la date d'inscription, la date de dernière connexion et le nombre de messages :) .</p><p id="r-618256" data-claire-element-id="618256">Ensuite il faut également faire en sorte qu'il puisse les classer par ordre croissant ou décroissant.</p><p id="r-618257" data-claire-element-id="618257">Pour faire ça, j'ai utilisé deux array qui vont permettre de convertir en texte compréhensible par n'importe qui le nom des champs de la table forum_membres correspondants.<br/> Je m'explique ( :-° ), en fait on va demander au visiteur grâce à une liste déroulante de choisir par quoi il veut trier les membres. Seulement on ne peut pas lui proposer les noms des champs brut donc on passe par un tableau qui convertit tout ça.</p><p id="r-618258" data-claire-element-id="618258">Le mieux est encore de regarder le code ^^ .</p><pre id="r-618259" data-claire-element-id="618259"><code data-claire-semantic="html+php">&lt;?php
//Tri

$convert_order = array('membre_pseudo', 'membre_inscrit', 'membre_post', 'membre_derniere_visite'); 
$convert_tri = array('ASC', 'DESC');
//On récupère la valeur de s
if (isset ($_POST['s'])) $sort = $convert_order[$_POST['s']];
else $sort = $convert_order[0];
//On récupère la valeur de t
if (isset ($_POST['t'])) $tri = $convert_tri[$_POST['t']];
else $tri = $convert_tri[0];

?&gt;
&lt;form action=&quot;memberlist.php&quot; method=&quot;post&quot;&gt;
&lt;p&gt;&lt;label for=&quot;s&quot;&gt;Trier par : &lt;/label&gt;

&lt;select name=&quot;s&quot; id=&quot;s&quot;&gt;
&lt;option value=&quot;0&quot; name=&quot;0&quot;&gt;Pseudo&lt;/option&gt;
&lt;option value=&quot;1&quot; name=&quot;1&quot;&gt;Inscription&lt;/option&gt;
&lt;option value=&quot;2&quot; name=&quot;2&quot;&gt;Messages&lt;/option&gt;
&lt;option value=&quot;3&quot; name=&quot;3&quot;&gt;Dernière visite&lt;/option&gt;
&lt;/select&gt;

&lt;select name=&quot;t&quot; id=&quot;t&quot;&gt;
&lt;option value=&quot;0&quot; name=&quot;0&quot;&gt;Croissant&lt;/option&gt;
&lt;option value=&quot;1&quot; name=&quot;1&quot;&gt;Décroissant&lt;/option&gt;
&lt;/select&gt;
&lt;input type=&quot;submit&quot; value=&quot;Trier&quot; /&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;?php
//Requête

$query = $db-&gt;prepare('SELECT membre_id, membre_pseudo, membre_inscrit, membre_post, membre_derniere_visite, online_id
FROM forum_membres
LEFT JOIN forum_whosonline ON online_id = membre_id
ORDER BY '.$sort.', online_id '.$tri.'
LIMIT :premier, :membreparpage');
$query-&gt;bindValue(':premier',$premier,PDO::PARAM_INT);
$query-&gt;bindValue(':membreparpage',$MembreParPage, PDO::PARAM_INT);
$query-&gt;execute();

if ($query-&gt;rowCount() &gt; 0)
{
?&gt;
       &lt;table&gt;
       &lt;tr&gt;
       &lt;th class=&quot;pseudo&quot;&gt;&lt;strong&gt;Pseudo&lt;/strong&gt;&lt;/th&gt;             
       &lt;th class=&quot;posts&quot;&gt;&lt;strong&gt;Messages&lt;/strong&gt;&lt;/th&gt;
       &lt;th class=&quot;inscrit&quot;&gt;&lt;strong&gt;Inscrit depuis le&lt;/strong&gt;&lt;/th&gt;
       &lt;th class=&quot;derniere_visite&quot;&gt;&lt;strong&gt;Dernière visite&lt;/strong&gt;&lt;/th&gt;                       
       &lt;th&gt;&lt;strong&gt;Connecté&lt;/strong&gt;&lt;/th&gt;             

       &lt;/tr&gt;
       &lt;?php
       //On lance la boucle
       
       while ($data = $query-&gt;fetch())
       {
           echo '&lt;tr&gt;&lt;td&gt;
           &lt;a href=&quot;./voirprofil.php?m='.$data['membre_id'].'&amp;amp;action=consulter&quot;&gt;
           '.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/td&gt;
           &lt;td&gt;'.$data['membre_post'].'&lt;/td&gt;
           &lt;td&gt;'.date('d/m/Y',$data['membre_inscrit']).'&lt;/td&gt;
           &lt;td&gt;'.date('d/m/Y',$data['membre_derniere_visite']).'&lt;/td&gt;';
           if (empty($data['online_id'])) echo '&lt;td&gt;non&lt;/td&gt;'; 
           else echo '&lt;td&gt;oui&lt;/td&gt;';
           echo '&lt;/tr&gt;';
       }
       $query-&gt;CloseCursor();
       ?&gt;
       &lt;/table&gt;
       &lt;?php
}
else //S'il n'y a pas de message
{
    echo'&lt;p&gt;Ce forum ne contient aucun membre actuellement&lt;/p&gt;';
}
?&gt;
&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;</code></pre><p id="r-618260" data-claire-element-id="618260">Et le voilà le travail, vous avez à présent une liste de membres assez sommaire mais qui a le mérite de marcher :D .</p><p id="r-618261" data-claire-element-id="618261">J'aimerai tout de même revenir sur la requête, vous avez remarqué que je fais une jointure sur la table forum_whosonline. En fait je cherche à récupérer l'id du membre, si elle s'y trouve c'est que le membre est connecté, sinon c'est qu'il ne l'est pas et donc la valeur de $data['online_id'] sera <em>NULL</em>.<br/> On réutilisera cette méthode dans la suite et maintenant on va pouvoir passer à la page de gestion des amis sans plus tarder!</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">
<span class="arrow"></span>
<span class="next">Et encore trois autres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
<span class="next">Gestion des amis</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gestiondesamis"></a><h2>Gestion des amis</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
<span class="arrow"></span>
<span class="next">La liste des membres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
<span class="next">Réponses automatiques</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618263" data-claire-element-id="618263">Avoir des amis sur un forum... On se sent tout de suite moins seul, c'est plus rapide pour communiquer et puis ça met une meilleure ambiance, bref, que du bonheur :p .</p><p id="r-618264" data-claire-element-id="618264">J'imagine que la plupart d'entre vous a déjà au moins essayé ce système sur le site du zéro mais je vais quand même expliquer le principe.</p><p id="r-618265" data-claire-element-id="618265">Tout se passe sur une seule page que j'ai appelée amis.php, celle-ci comme beaucoup dans ce tuto, s'articule autour d'un switch.<br/> Tout d'abord lorsque l'on arrive sur la page, un tableau liste les amis que l'on a, à partir de là il est possible de :</p><ul id="r-618272" data-claire-element-id="618272"><li id="r-618267" data-claire-element-id="618267"><p id="r-618266" data-claire-element-id="618266">Supprimer un ami :euh:</p></li><li id="r-618269" data-claire-element-id="618269"><p id="r-618268" data-claire-element-id="618268">Ajouter un ami</p></li><li id="r-618271" data-claire-element-id="618271"><p id="r-618270" data-claire-element-id="618270">Valider la demande d'ajout d'un ami</p></li></ul><p id="r-618273" data-claire-element-id="618273">En effet pour avoir un ami, il faut que celui-ci soit d'accord, c'est pourquoi lorsque vous voulez ajouter un membre à votre liste, il est immédiatement prévenu (par MP par exemple) qu'il doit se rendre sur sa page de gestion des amis pour valider ou supprimer cette demande.</p><p id="r-618274" data-claire-element-id="618274">Avant tout, il nous faut une table dans la base de données, celle-ci (forum_amis) comprend 4 champs :</p><ul id="r-618283" data-claire-element-id="618283"><li id="r-618276" data-claire-element-id="618276"><p id="r-618275" data-claire-element-id="618275">ami_from : contient l'id du membre qui demande à ajouter un ami</p></li><li id="r-618278" data-claire-element-id="618278"><p id="r-618277" data-claire-element-id="618277">ami_to : contient l'id de l'ami en question</p></li><li id="r-618280" data-claire-element-id="618280"><p id="r-618279" data-claire-element-id="618279">ami_confirm : retourne 1 si l'amitié est réciproque, 0 sinon</p></li><li id="r-618282" data-claire-element-id="618282"><p id="r-618281" data-claire-element-id="618281">ami_date : contient la date d'ajout</p></li></ul><p id="r-618284" data-claire-element-id="618284">Voici le code à copier :</p><pre id="r-618285" data-claire-element-id="618285"><code data-claire-semantic="sql">CREATE TABLE `forum_amis` (
  `ami_from` int(11) NOT NULL,
  `ami_to` int(11) NOT NULL,
  `ami_confirm` enum('0','1') collate latin1_general_ci NOT NULL,
  `ami_date` int(11) NOT NULL,
  PRIMARY KEY  (`ami_to`,`ami_from`)
)</code></pre><p id="r-618286" data-claire-element-id="618286">Allez on commence de suite :)</p><p id="r-618287" data-claire-element-id="618287">Déjà le début de la page est très classique, il faut simplement récupérer la valeur de action qui se trouve dans l'url et s'assurer que le visiteur est bien connecté.</p><pre id="r-618288" data-claire-element-id="618288"><code data-claire-semantic="html+php">&lt;?php
session_start();
$titre=&quot;Gestion des amis&quot;;
include(&quot;includes/identifiants.php&quot;);
include(&quot;includes/debut.php&quot;);
include(&quot;includes/menu.php&quot;);
$action = isset($_GET['action'])?htmlspecialchars($_GET['action']):'';

echo '&lt;p&gt;&lt;i&gt;Vous êtes ici&lt;/i&gt; : &lt;a href=&quot;./index.php&quot;&gt;Index du forum&lt;/a&gt; --&gt; &lt;a href=&quot;./amis.php&quot;&gt;Gestion des amis&lt;/a&gt;';
if ($id==0) erreur(ERR_IS_CO);
 
//Le titre 
echo '&lt;h1&gt;Gestion des amis&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;';
?&gt;</code></pre><p id="r-618289" data-claire-element-id="618289">Comme prévu, rien de très compliqué ni de nouveau :p</p><h2 id="r-ajouter-un-ami" data-claire-element-id="618307">Ajouter un ami</h2><p id="r-618290" data-claire-element-id="618290">Pour ajouter un ami, on propose au membre un champ dans lequel il écrira le pseudo de cette personne, ensuite il faut lancer une série de tests pour s'assurer qu'il n'y a pas de problème.</p><p id="r-618291" data-claire-element-id="618291">Tout d'abord le formulaire :</p><pre id="r-618292" data-claire-element-id="618292"><code data-claire-semantic="html+php">&lt;?
switch($action)
{
    case &quot;add&quot;: //On veut ajouter un ami
    if (!isset($_POST['pseudo']))
    {
    echo '&lt;form action=&quot;amis.php?action=add&quot; method=&quot;post&quot;&gt;
    &lt;p&gt;&lt;label for=&quot;pseudo&quot;&gt;Entrez le pseudo&lt;/label&gt;
    &lt;input type=&quot;text&quot; name=&quot;pseudo&quot; id=&quot;pseudo&quot; /&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;
    &lt;/p&gt;&lt;/form&gt;';
    }
?&gt;</code></pre><p id="r-618293" data-claire-element-id="618293">Comme vous voyez, on ne lance le formulaire que si la variable $_POST['pseudo'] est vide, c'est-à-dire si on vient d'arriver sur la page.</p><p id="r-618294" data-claire-element-id="618294">Ensuite pour la batterie de tests, j'ai prévu 3 conditions :</p><ul id="r-618301" data-claire-element-id="618301"><li id="r-618296" data-claire-element-id="618296"><p id="r-618295" data-claire-element-id="618295">L'ami doit exister ^^</p></li><li id="r-618298" data-claire-element-id="618298"><p id="r-618297" data-claire-element-id="618297">L'ami ne doit pas être déjà présent dans la liste d'ami, ni en cours de demande</p></li><li id="r-618300" data-claire-element-id="618300"><p id="r-618299" data-claire-element-id="618299">L'ami ne doit pas être le membre en question</p></li></ul><p id="r-618302" data-claire-element-id="618302">On va donc traduire ça en php.</p><pre id="r-618303" data-claire-element-id="618303"><code data-claire-semantic="html+php">&lt;?php
    else
    {
        $pseudo_d = $_POST['pseudo'];
        //On vérifie que le pseudo renvoit bien quelque chose :o

        $query=$db-&gt;prepare('SELECT membre_id, COUNT(*) AS nbr FROM forum_membres 
        WHERE LOWER(membre_pseudo) = :pseudo GROUP BY membre_pseudo');
        $query-&gt;bindValue(':pseudo',strtolower($pseudo_d),PDO::PARAM_STR);
        $query-&gt;execute();
        $data = $query-&gt;fetch();
        $pseudo_exist = $data['nbr'];
        $i = 0;
        $id_to=$data['membre_id'];
        if(!$pseudo_exist)
        {
            echo '&lt;p&gt;Ce membre ne semble pas exister&lt;br /&gt;
            Cliquez &lt;a href=&quot;./amis.php?action=add&quot;&gt;ici&lt;/a&gt; pour réessayer&lt;/p&gt;';
            $i++;
        }
        $query-&gt;CloseCursor();
        $query = $db-&gt;prepare('SELECT COUNT(*) AS nbr FROM forum_amis 
        WHERE ami_from = :id AND ami_to = :id_to
        OR ami_from = :id AND ami_to = :id_to');
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;bindValue(':id_to', $id_to, PDO::PARAM_INT);
        $query-&gt;execute();
        $deja_ami=$query-&gt;fetchColumn();
        $query-&gt;CloseCursor();

        if ($deja_ami != 0)
        {
            echo '&lt;p&gt;Ce membre fait déjà parti de vos amis ou a déjà proposé son amitié :p&lt;br /&gt;
            Cliquez &lt;a href=&quot;./amis.php?action=add&quot;&gt;ici&lt;/a&gt; pour réessayer&lt;/p&gt;';
            $i++;
        }
        if ($id_to == $id)
        {
            echo '&lt;p&gt;Vous ne pouvez pas vous ajouter vous même&lt;br /&gt;
            Cliquez &lt;a href=&quot;./amis.php?action=add&quot;&gt;ici&lt;/a&gt; pour réessayer&lt;/p&gt;';
            $i++;
        }
        if ($i == 0)
        {
            $query=$db-&gt;prepare('INSERT INTO forum_amis (ami_from, ami_to, ami_confirm, ami_date)
            VALUES(:id, :id_to, :conf, :temps)');
            $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
            $query-&gt;bindValue(':id_to', $id_to, PDO::PARAM_INT);
            $query-&gt;bindValue(':conf','0',PDO::PARAM_STR);
            $query-&gt;bindValue(':temps', time(), PDO::PARAM_INT);
            $query-&gt;execute();
            $query-&gt;CloseCursor();
            echo '&lt;p&gt;&lt;a href=&quot;/voirprofil.php?m='.$data['membre_id'].'&quot;&gt;'.stripslashes(htmlspecialchars($pseudo_d)).'&lt;/a&gt; 
            a bien été ajouté à vos amis, il faut toutefois qu il donne son accord.&lt;br /&gt;
            Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt; pour retourner à l index du forum&lt;br /&gt;
            Cliquez &lt;a href=&quot;./amis.php&quot;&gt;ici&lt;/a&gt; pour retourner à la page de gestion des amis&lt;/p&gt;';
        }
    }
?&gt;</code></pre><p id="r-618304" data-claire-element-id="618304">Comme vous le voyez, la variable $i s'occupe de compter le nombre d'erreur. Même si je vois mal comment il peut y en avoir plusieurs en même temps o_O , cela permet de savoir si on peut lancer la requête ou non.</p><p id="r-618305" data-claire-element-id="618305">Voilà vous pouvez à présent demander à ajouter des amis ce qui est quand même un premier pas ^^ .</p><p id="r-618306" data-claire-element-id="618306">On va à présent voir la validation de ces demandes.</p><h2 id="r-validation-des-demandes" data-claire-element-id="618318">Validation des demandes</h2><p id="r-618308" data-claire-element-id="618308">Cette partie du switch se présente de la façon suivante :<br/> On affiche un tableau qui liste les membres qui vous ont voulu comme ami mais dont vous n'avez pas encore validé la demande.<br/> Pour chacun on propose un lien vers l'acceptation et un autre vers le refus.<br/> De la même façon, il va falloir vérifier qu'on vient d'arriver sur la page (auquel cas on affiche le tableau) ou qu'on a déjà fait son choix (dans ce cas on lance les requêtes).</p><pre id="r-618309" data-claire-element-id="618309"><code data-claire-semantic="html+php">&lt;?php
case &quot;check&quot;:
    $add = (isset($_GET['add']))?htmlspecialchars($_GET['add']):0;
    if (empty($add))
    {
        $query = $db-&gt;prepare('SELECT ami_from, ami_date, membre_pseudo FROM forum_amis
        LEFT JOIN forum_membres ON membre_id = ami_from
        WHERE ami_to = :id AND ami_confirm = :conf
        ORDER BY ami_date DESC');
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;bindValue(':conf','0',PDO::PARAM_STR); 
        $query-&gt;execute();

        echo '&lt;table align=&quot;center&quot;&gt;&lt;tr&gt;
        &lt;th class=&quot;pseudo&quot;&gt;&lt;strong&gt;Pseudo&lt;/strong&gt;&lt;/th&gt;
        &lt;th class=&quot;inscrit&quot;&gt;&lt;strong&gt;Date d ajout&lt;/strong&gt;&lt;/th&gt;
        &lt;th&gt;&lt;strong&gt;Action&lt;/strong&gt;&lt;/th&gt;&lt;/tr&gt;';

        if ($query-&gt;rowCount() == 0)
        {
            echo '&lt;td colspan=&quot;3&quot; align=&quot;center&quot;&gt;Vous n avez aucune proposition&lt;/td&gt;';
        }
        while ($data = $query-&gt;fetch())
        {
            echo '&lt;tr&gt;&lt;td&gt;&lt;a href=&quot;./voirprofil.php?m='.$data['ami_from'].'&amp;amp;action=consulter&quot;&gt;'.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/td&gt;
            &lt;td&gt;'.date('d/m/Y',$data['ami_date']).'&lt;/td&gt;
            &lt;td&gt;&lt;a href=&quot;./amis.php?action=check&amp;amp;add=ok&amp;amp;m='.$data['ami_from'].'&quot;&gt;Accepter&lt;/a&gt; - 
            &lt;a href=&quot;./amis.php?action=delete&amp;amp;m='.$data['ami_from'].'&quot;&gt;Refuser&lt;/a&gt; 
            &lt;/td&gt;&lt;/tr&gt;';
        }
        $query-&gt;CloseCursor();
    }
?&gt;</code></pre><p id="r-618310" data-claire-element-id="618310">Si vous étudiez un peu les deux liens, vous verrez que dans ce switch on ne va s'occuper que du cas où vous acceptez la demande de validation. On récupère la valeur de l'ami qui se trouve dans l'url sous le nom de m. C'est par ailleur la présence, ou l'absence de cette variable qui nous indique si on doit afficher le tableau ou si on doit lancer les requêtes.</p><p id="r-618311" data-claire-element-id="618311">D'ailleurs on va voir les requêtes de suite :)</p><pre id="r-618312" data-claire-element-id="618312"><code data-claire-semantic="html+php">&lt;?php
    else
    {
        $membre = (int) $_GET['m'];
        $query = $db-&gt;prepare('UPDATE forum_amis SET ami_confirm = :conf 
        WHERE ami_from = :membre AND ami_to = :id');
        $query-&gt;bindValue(':conf','1',PDO::PARAM_STR);
        $query-&gt;bindValue(':membre',$membre,PDO::PARAM_INT);
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;closeCursor();
        echo '&lt;p&gt;Le membre a bien été ajouté à votre liste d ami&lt;br /&gt;
        Cliquez &lt;a href=&quot;./amis.php&quot;&gt;ici&lt;/a&gt; pour retourner à la liste des amis';
    }
break;
?&gt;</code></pre><p id="r-618313" data-claire-element-id="618313">On change la valeur du champ ami_confirm à 1 et le tour est joué !</p><div id="r-618315" data-claire-element-id="618315" data-claire-semantic="question"><p id="r-618314" data-claire-element-id="618314">Hep attends une minute, dans la base de données on aura tantôt des membres qui seront dans les listes en tant que ami_to ou ami_from !</p></div><p id="r-618316" data-claire-element-id="618316">Oui mais ça ne pose pas de problème, il suffira de s'arranger avec la requête pour ne pas oublier de cas. En fait à partir du moment où la demande est validée, la différence entre les champs ami_to et ami_from n'existe plus.</p><p id="r-618317" data-claire-element-id="618317">Allez on file vers la suppression et puis on aura gagné !</p><h2 id="r-supprimer-un-ami" data-claire-element-id="618326">Supprimer un ami</h2><p id="r-618319" data-claire-element-id="618319">Derrière ce titre très ambigu ( :D ) se cache la dernière partie de notre switch.<br/> La suppression d'un ami peut être de deux natures, soit vous voulez vous débarrasser d'un ami que vous avez depuis un moment et dont vous avez déjà validé la demande d'ajout. Soit vous voulez refuser une demande d'ajout.</p><p id="r-618320" data-claire-element-id="618320">L'avantage c'est qu'on a même pas besoin de faire la différence entre les deux, il suffit de récupérer la valeur de l'id du membre et de le virer de la base de données.</p><p id="r-618321" data-claire-element-id="618321">En revanche, comme il s'agit d'une suppression, il faut s'assurer que ce n'est pas une erreur en demandant une confirmation.</p><pre id="r-618322" data-claire-element-id="618322"><code data-claire-semantic="html+php">&lt;?php
case &quot;delete&quot;:
    $membre = (int) $_GET['m'];
    if (!isset($_GET['ok']))
    {
        echo '&lt;p&gt;Etes vous certain de vouloir supprimer ce membre ?&lt;br /&gt;
        &lt;a href=&quot;./amis.php?action=delete&amp;amp;ok=ok&amp;amp;m='.$membre.'&quot;&gt;oui&lt;/a&gt; - &lt;a href=&quot;./amis.php&quot;&gt;non&lt;/a&gt;&lt;/p&gt;';
    }
    else
    {
        $query = $db-&gt;prepare('DELETE FROM forum_amis WHERE ami_from = :membre AND ami_to = :id');
        $query-&gt;bindValue(':membre',$membre,PDO::PARAM_INT);
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;closeCursor();

        $query = $db-&gt;prepare('DELETE FROM forum_amis WHERE ami_to = :membre AND ami_from = :id');
        $query-&gt;bindValue(':membre',$membre,PDO::PARAM_INT);
        $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
        $query-&gt;execute();
        $query-&gt;closeCursor();

        echo '&lt;p&gt;Membre correctement supprimé :D &lt;br /&gt;
        Cliquez &lt;a href=&quot;./amis.php&quot;&gt;ici&lt;/a&gt; pour retourner à la liste des amis&lt;/p&gt;';
    }
break;
?&gt;</code></pre><p id="r-618323" data-claire-element-id="618323">Vous voyez que comme on ignore si le membre se trouve au champ ami_to ou ami_from, on supprime les deux sans faire de distinction.</p><aside id="r-618325" data-claire-element-id="618325" data-claire-semantic="information"><p id="r-618324" data-claire-element-id="618324">Il est tout de même important de prévenir l'ami en question, vous pouvez vous arranger pour qu'il reçoive le cas échéant un MP pour le prévenir. Il est en est d'ailleurs de même pour les demandes d'ajout, les validations etc...</p></aside><h2 id="r-enfin-on-affiche-la-liste-des-amis" data-claire-element-id="618334">Enfin on affiche la liste des amis</h2><p id="r-618327" data-claire-element-id="618327">Je vais passer vite là dessus étant donné que c'est ce que l'on a fait dans le premier chapitre.</p><pre id="r-618328" data-claire-element-id="618328"><code data-claire-semantic="html+php">&lt;?php
default:

    $query = $db-&gt;prepare('SELECT (ami_from + ami_to - :id) AS ami_id, ami_date, membre_pseudo, online_id 
    FROM forum_amis
    LEFT JOIN forum_membres ON membre_id = (ami_from + ami_to - :id)
    LEFT JOIN forum_whosonline ON online_id = membre_id
    WHERE (ami_from = :id OR ami_to = :id) AND ami_confirm = :conf ORDER BY membre_pseudo');
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);       
    $query-&gt;bindValue(':conf','1',PDO::PARAM_STR);
    $query-&gt;execute();
    
    echo '&lt;table align=&quot;center&quot;&gt;&lt;tr&gt;
    &lt;th class=&quot;pseudo&quot;&gt;&lt;strong&gt;Pseudo&lt;/strong&gt;&lt;/th&gt;
    &lt;th class=&quot;inscrit&quot;&gt;&lt;strong&gt;Date d ajout&lt;/strong&gt;&lt;/th&gt;
    &lt;th&gt;&lt;strong&gt;Action&lt;/strong&gt;&lt;/th&gt;
    &lt;th&gt;&lt;strong&gt;Connecté&lt;/strong&gt;&lt;/th&gt;&lt;/tr&gt;';

    if ($query-&gt;rowCount() == 0)
    {
        echo '&lt;td colspan=&quot;4&quot; align=&quot;center&quot;&gt;Vous n avez aucun ami pour l instant&lt;/td&gt;';
    }
    while ($data = $query-&gt;fetch())
    {
        echo '&lt;tr&gt;&lt;td&gt;&lt;a href=&quot;./voirprofil.php?m='.$data['ami_id'].'&amp;amp;action=consulter&quot;&gt;'.stripslashes(htmlspecialchars($data['membre_pseudo'])).'&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;'.date('d/m/Y',$data['ami_date']).'&lt;/td&gt;
        &lt;td&gt;&lt;a href=&quot;./messagesprives.php?action=repondre&amp;amp;dest='.$data['ami_id'].'&quot;&gt;Envoyer un MP&lt;/a&gt;&lt;br /&gt;
        &lt;a href=&quot;./amis.php?action=delete&amp;m='.$data['ami_id'].'&quot;&gt;Supprimer&lt;/a&gt;&lt;/td&gt;';
        if (!empty($data['online_id'])) echo '&lt;td&gt;Oui&lt;/td&gt;'; else echo '&lt;td&gt;Non&lt;/td&gt;';
        echo '&lt;/tr&gt;';
    }
    echo '&lt;/table&gt;';
    $query-&gt;CloseCursor();

    //On compte le nombre de demande en cours et on met quelques liens
    $query=$db-&gt;prepare('SELECT COUNT(*) FROM forum_amis 
    WHERE ami_to = :id AND ami_confirm = :conf');
    $query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
    $query-&gt;bindValue(':conf','0', PDO::PARAM_STR);
    $query-&gt;execute();
    $demande_ami=$query-&gt;fetchColumn();

    //Cette ligne va permettre d'afficher 0 plutôt qu'un vide
    if (empty($demande_ami)) $demande_ami=0;
    echo '&lt;br /&gt;&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;./amis.php?action=add&quot;&gt;Ajouter un ami&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./amis.php?action=check&quot;&gt;Voir les demandes d\'ajout ('.$demande_ami.')&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;';
break;
}

?&gt;
&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;</code></pre><p id="r-618329" data-claire-element-id="618329">Alors un arrêt important sur cette requête, c'est une méthode assez astucieuse proposée par tarekbouchkati dans les commentaires du tuto. En fait on ne veux pas récupérer les entrées de le base de donnée qui concerne le membre connecté en tant qu'ami (sinon on aurait son propre nom dans la liste d'amis puisqu'il n'est pas possible de faire la différence).<br/> Avec cette méthode, on ne va garder que l'id qui n'est pas celle du membre et ainsi afficher le bon nom. C'est un peu étrange mais je vous laisse réfléchir à ce que donnerait le résultat de la requête en piochant indifféremment dans ami_from et ami_to.</p><p id="r-618330" data-claire-element-id="618330">Pour le reste c'est du classique, on récupère tout ce qui concerne le membre dans la table forum_amis puis on affiche. Maintenant c'est à vous de personnaliser cette page comme ça vous arrange.</p><aside id="r-618332" data-claire-element-id="618332" data-claire-semantic="information"><p id="r-618331" data-claire-element-id="618331">Si vous voulez connaitre le nombre de demandes d'amis en cours, il vous suffit d'utiliser la dernière requête de ce script</p></aside><p id="r-618333" data-claire-element-id="618333">En général, il est très utile comme sur le SDZ de mettre dans le menu la liste des amis connectés ce qui n'est pas très compliqué si vous avez suivi jusque ici :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
<span class="arrow"></span>
<span class="next">La liste des membres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
<span class="next">Réponses automatiques</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Rponsesautomatiques"></a><h2>Réponses automatiques</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
<span class="arrow"></span>
<span class="next">Gestion des amis</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">
<span class="next">Annexe</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618336" data-claire-element-id="618336">Bon on passe maintenant à l'autre système qui est la réponse automatique que les modérateurs peuvent activer pour leur éviter de répéter 10 fois par jour la même chose.<br/> Croyez moi sur un forum assez important ça évite pas mal de crise de nerfs à votre équipe ^^</p><p id="r-618337" data-claire-element-id="618337">Alors, le principe est assez simple, sur la base de données vous allez enregistrer une série de messages que vous voulez voir afficher. Puis sur la page voirtopic.php, à côté de toutes les options de modérations, vous mettrez une liste déroulante qui contient tous ces messages. Ensuite le modérateur en sélectionne un puis envoie le tout. Il faut également penser à verrouiller le topic une fois tout ça fait.</p><aside id="r-618339" data-claire-element-id="618339" data-claire-semantic="information"><p id="r-618338" data-claire-element-id="618338">Vous pouvez également stocker les messages sur un fichier php à part ce qui peut être plus facile pour les écrire.<br/> Dans tous les cas il faut tenir compte du parsage, comme sur ce tuto, les messages sont parsés à l'affichage, il faudra les écrire comme si vous faisiez un post (donc en utilisant le bbcode/zcode etc... :-°</p></aside><p id="r-618340" data-claire-element-id="618340">Vous allez donc lancer ceci dans votre base de données</p><pre id="r-618341" data-claire-element-id="618341"><code data-claire-semantic="sql">CREATE TABLE `forum_automess` (
`automess_id` TINYINT( 3 ) NOT NULL AUTO_INCREMENT ,
`automess_mess` TEXT NOT NULL ,
`automess_titre` VARCHAR( 200 ) NOT NULL ,
PRIMARY KEY ( `automess_id` )
) TYPE = MYISAM ;</code></pre><p id="r-618342" data-claire-element-id="618342">Je pense que vous pouvez deviner un peu le principe, le titre sera le texte qui va apparaitre dans la liste déroulante et le message sera ... le message qui sera posté :D</p><h2 id="r-afficher-la-liste-deroulante" data-claire-element-id="618348">Afficher la liste déroulante</h2><p id="r-618343" data-claire-element-id="618343">Pour ce code qui se trouve sur la page voirtopic.php, le code est simple puisqu'il suffit de faire une requête et de tout lister. Par contre, assurez vous bien d'être toujours dans la partie de votre page qui est sous la vérification d'accès. En effet, seuls les modérateurs peuvent poster des réponses automatiques :)</p><pre id="r-618344" data-claire-element-id="618344"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;p&gt;Réponse automatique :&lt;/p&gt;
&lt;form method=&quot;post&quot; action=postok.php?action=autorep&amp;amp;t='.$topic.'&gt;
&lt;select name=&quot;rep&quot;&gt;';
$query=$db-&gt;query('SELECT automess_id, automess_titre
FROM forum_automess');
while ($data = $query-&gt;fetch())
{
     echo '&lt;option value=&quot;'.$data['automess_id'].'&quot;&gt;
     '.$data['automess_titre'].'&lt;/option&gt;';
}
echo '&lt;/select&gt;  
&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Envoyer&quot; /&gt;&lt;/form&gt;';
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618345" data-claire-element-id="618345">Le mieux est encore de placer ce code à la suite du script qui affichait la liste déroulante pour le déplacement du topic.</p><aside id="r-618347" data-claire-element-id="618347" data-claire-semantic="warning"><p id="r-618346" data-claire-element-id="618346">Etant donné qu'une fois la réponse activée le topic sera verrouillé, il peut être préférable de ne pas afficher cette option dans le cas où le topic est déjà verrouillé. Il suffit pour cela de mettre une condition en jouant sur la valeur du champ topic_locked</p></aside><h2 id="r-traitement-du-message" data-claire-element-id="618367">Traitement du message</h2><p id="r-618349" data-claire-element-id="618349">Pour cette partie on va reprendre la page postok.php et ajouter une dernière option à notre switch.<br/> Si vous regardez la cible du formulaire qui se trouve plus haut, vous voyez que je l'ai appelé autorep. Par ailleurs, ce formulaire renvoie l'id du message à afficher sous le sobre nom de rep.</p><p id="r-618350" data-claire-element-id="618350">A partir de là il suffit de faire une requête pour récupérer le texte en question et l'afficher comme s'il s'agissait d'un vrai message. Puis avant de terminer il faudra veiller à fermer le sujet.</p><p id="r-618351" data-claire-element-id="618351">Bref, beaucoup de copie de code déjà vu et un peu de nouveautés :) .</p><h3 id="r-debut-du-script" data-claire-element-id="618354">Début du script</h3><pre id="r-618352" data-claire-element-id="618352"><code data-claire-semantic="html+php">&lt;?php
case &quot;autorep&quot;:
$topic = (int) $_GET['t'];
$query=$db-&gt;prepare('SELECT forum_topic.forum_id, auth_modo
FROM forum_topic
LEFT JOIN forum_forum ON forum_forum.forum_id = forum_topic.forum_id
WHERE topic_id = :topic');
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$data=$query-&gt;fetch();
$forum=$data['forum_id'];
if (!verif_auth($data['auth_modo']))
{
    erreur(ERR_AUTH_MODO);
}
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618353" data-claire-element-id="618353">Comme habituellement (je vous renvoie au TP sur la modération si ça ne vous rappelle vraiment rien) on fait une vérification sur les droits du membre, on récupère des infos sur le topic et puis on commence.</p><h3 id="r-recuperation-du-message" data-claire-element-id="618357">Récupération du message</h3><pre id="r-618355" data-claire-element-id="618355"><code data-claire-semantic="html+php">&lt;?php
$rep = (int) $_POST['rep'];
$query=$db-&gt;prepare('SELECT automess_mess FROM forum_automess 
WHERE automess_id = :rep');
$query-&gt;bindValue(':rep',$rep,PDO::PARAM_INT);
$query-&gt;execute();
$data = $query-&gt;fetch();
$message = $data['automess_mess'];
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618356" data-claire-element-id="618356">Rien de très compliqué ici, on récupère simplement des informations avant de commencer à lancer la machine ^^</p><h3 id="r-enregistrement-du-message" data-claire-element-id="618360">Enregistrement du message</h3><pre id="r-618358" data-claire-element-id="618358"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('INSERT INTO forum_post
(post_createur, post_texte, post_time, topic_id, post_forum_id)
VALUES(:id,:mess,:temps,:topic,:forum)');
$query-&gt;bindValue(':id', $id, PDO::PARAM_INT);   
$query-&gt;bindValue(':mess', $message, PDO::PARAM_STR);  
$query-&gt;bindValue(':temps', time(), PDO::PARAM_INT);  
$query-&gt;bindValue(':topic', $topic, PDO::PARAM_INT);   
$query-&gt;bindValue(':forum', $forum, PDO::PARAM_INT); 
$query-&gt;execute();

$nouveaupost = $db-&gt;lastInsertId();
$query-&gt;CloseCursor(); 

//On change un peu la table forum_topic
$query=$db-&gt;prepare('UPDATE forum_topic SET topic_post = topic_post + 1, topic_last_post = :nouveaupost WHERE topic_id =:topic');
$query-&gt;bindValue(':nouveaupost', (int) $nouveaupost, PDO::PARAM_INT);   
$query-&gt;bindValue(':topic', (int) $topic, PDO::PARAM_INT); 
$query-&gt;execute();
$query-&gt;CloseCursor(); 

//Puis même combat sur les 2 autres tables
$query=$db-&gt;prepare('UPDATE forum_forum SET forum_post = forum_post + 1 , forum_last_post_id = :nouveaupost WHERE forum_id = :forum');
$query-&gt;bindValue(':nouveaupost', (int) $nouveaupost, PDO::PARAM_INT);   
$query-&gt;bindValue(':forum', (int) $forum, PDO::PARAM_INT); 
$query-&gt;execute();
$query-&gt;CloseCursor(); 

$query=$db-&gt;prepare('UPDATE forum_membres SET membre_post = membre_post + 1 WHERE membre_id = :id');
$query-&gt;bindValue(':id', $id, PDO::PARAM_INT); 
$query-&gt;execute();
$query-&gt;CloseCursor(); 

?&gt;</code></pre><p id="r-618359" data-claire-element-id="618359">Ce code est exactement le même que celui qui se trouvait dans la partie traitant des réponses. On enregistre le message, on met à jour le forum et le profil du membre (oui une réponse automatique reste une réponse et donc augmente de 1 le nombre de posts d'un modo ^^ ).</p><h3 id="r-on-verrouille-et-c-est-gagne" data-claire-element-id="618366">On verrouille et c'est gagné !</h3><pre id="r-618361" data-claire-element-id="618361"><code data-claire-semantic="html+php">&lt;?
$query=$db-&gt;prepare('UPDATE forum_topic
SET topic_locked = :lock
WHERE topic_id = :topic');
$query-&gt;bindValue(':lock','1',PDO::PARAM_STR);
$query-&gt;bindValue(':topic',$topic,PDO::PARAM_INT);
$query-&gt;execute();
$query-&gt;CloseCursor();

echo '&lt;p&gt;La réponse automatique a bien été envoyée ! &lt;br /&gt;
Cliquez &lt;a href=&quot;./voirtopic.php?t='.$topic.'&quot;&gt;ici&lt;/a&gt;
pour revenir au topic&lt;br /&gt;
Cliquez &lt;a href=&quot;./index.php&quot;&gt;ici&lt;/a&gt;
pour revenir à l index du forum&lt;/p&gt;';

break;
?&gt;</code></pre><p id="r-618362" data-claire-element-id="618362">Et voilà le travail les amis :p Tout est maintenant en place pour que vos modérateurs ne se tracassent pas trop et puissent assouvir leur moindre désir de répression :diable: .</p><p id="r-618363" data-claire-element-id="618363">Voilà pour ce chapitre qui achève le tuto sur la création d'un forum. A partir de maintenant je pense que vous avez une bonne base pour commencer ;)</p><p id="r-618364" data-claire-element-id="618364">Avant qu'on se quitte j'aimerai revenir sur le système de messages automatiques et particulièrement sur leur création. J'ai vu sur un forum, dans le panneau d'admin une option qui permettait d'écrire directement les messages et de les enregistrer dans la base de données ce qui évite du coup d'avoir à le faire manuellement en prenant compte le parsage etc...</p><p id="r-618365" data-claire-element-id="618365">Si ça vous intéresse je ne pense pas que ça pose de problème de difficulté ou autre donc je vous conseille de faire ça :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
<span class="arrow"></span>
<span class="next">Gestion des amis</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">
<span class="next">Annexe</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Annexe"></a><h2>Annexe</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
<span class="arrow"></span>
<span class="next">Réponses automatiques</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
<span class="next">Questions récurrentes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-618370" data-claire-element-id="618370">Je ne pouvais pas terminer ce tuto sans une petite annexe pour mettre les choses au points et en plus je suis certain que je vous ai manqué :p .<br/> Plus sérieusement depuis plus d'un an je reçois régulièrement par MP des conseils, remarques ou demandes d'aide sur des parties compliquées.<br/> Avec cette annexe je ne vais pas vous donner de nouvelles fonctionnalités ni de super méthode pour résoudre tout vos bugs, je vais simplement répondre à une série de questions et donner quelques suggestions.</p><p id="r-618371" data-claire-element-id="618371">Par ailleurs, une partie est réservée à la sécurité du tuto et vous trouverez à la fin de cette annexe une liste des forums qui ont été créé à l'aide de ce tuto afin de pouvoir comparer ou simplement avoir un aperçu des rendus possibles ;) .</p>
</div><a name="Questionsrcurrentes"></a><h2>Questions récurrentes</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">
<span class="arrow"></span>
<span class="next">Annexe</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
<span class="next">Liste de forums</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618372" data-claire-element-id="618372">Je n'ai pas voulu appelé cette partie FAQ car ça n'en est pas une et en plus j'ai l'esprit de contradiction :p .<br/> Je vais simplement donner des indications sous forme de questions/réponses en basant le tout sur ce que j'ai pu lire par-ci par-là.</p><h2 id="r-espace-membre" data-claire-element-id="618378">Espace membre</h2><p id="r-618373" data-claire-element-id="618373">La plupart d'entre vous essaye de coder son forum dans le but de rassembler une communauté qui visite votre site.<br/> Donc la plupart du temps vous souhaitez que les sessions du forum restent en vigueur sur votre site.<br/> Ca peut paraitre un non problème pour certains mais je vous garantis que j'ai reçu plusieurs demandes dans ce style.</p><p id="r-618374" data-claire-element-id="618374">Et bien voici la solution, qui est d'ailleurs assez automatique et simple, il suffit basiquement de faire usage de la table forum_membres ainsi que des variables de sessions.</p><p id="r-618375" data-claire-element-id="618375">Petit rappel pour ceux qui ont oublié :<br/> Obtenir le pseudo : $_SESSION['pseudo']<br/> Obtenir l'id : $_SESSION['id']<br/> Obtenir le rang (modérateur, administrateur...) : $_SESSION['level']</p><p id="r-618376" data-claire-element-id="618376">A partir de là tout ce dont vous aurez besoin ce trouve dans la table forum_membres.</p><p id="r-618377" data-claire-element-id="618377">Je vois pas trop quoi dire de plus... Si vous voulez mettre la page de connexion et d'inscription sur votre site ça ne pose évidemment aucun problème à condition de vérifier 2 ou 3 liens.</p><h2 id="r-mise-en-forme" data-claire-element-id="618439">Mise en forme</h2><h3 id="r-la-pagination-1" data-claire-element-id="618406">La pagination</h3><p id="r-618379" data-claire-element-id="618379">Lorsque l'on créer un forum, un problème souvent rencontré est qu'on ne se soucie pas en premier lieu des conséquences d'une grosse affluence.<br/> L'exemple le plus frappant est la pagination, dans mon tuto je n'ai fait qu'afficher toutes les pages. Mais imaginez un peu un topic avec 20 pages, on aurait droit à quelque chose comme ça :</p><p id="r-618380" data-claire-element-id="618380"><cite>Citation : voirtopic.php</cite></p><blockquote id="r-618382" data-claire-element-id="618382"><p id="r-618381" data-claire-element-id="618381">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20</p></blockquote><p id="r-618383" data-claire-element-id="618383">(Oui je me suis amusé à tout recopier :-° ).</p><p id="r-618384" data-claire-element-id="618384">Vous conviendrez que ce n'est pas très pratique, et je vous laisse imaginer l'horreur s'il y a 100 pages, 1000 pages ? o_O</p><p id="r-618385" data-claire-element-id="618385">C'est pour celà qu'on va modifier tout ça grâce à une fonction que j'ai trouvé sur le SDZ et dont l'auteur est Winzou.</p><p id="r-618386" data-claire-element-id="618386">Le rendu est beaucoup plus agréable car en cas de topic de 20 pages, si l'on se trouve sur la page 10 on lira.</p><p id="r-618387" data-claire-element-id="618387"><cite>Citation : voirtopic.php</cite></p><blockquote id="r-618389" data-claire-element-id="618389"><p id="r-618388" data-claire-element-id="618388">1 2 ... 8 9 10 11 12 ... 18 19 20</p></blockquote><p id="r-618390" data-claire-element-id="618390">Sympa non ?</p><aside id="r-618392" data-claire-element-id="618392" data-claire-semantic="information"><p id="r-618391" data-claire-element-id="618391">J'ai légèrement modifié la fonction pour qu'elle concorde avec nos scripts.</p></aside><pre id="r-618393" data-claire-element-id="618393"><code data-claire-semantic="html+php">&lt;?
//Fonction listant les pages
function get_list_page($page, $nb_page, $link, $nb = 2){
$list_page = array();
for ($i=1; $i &lt;= $nb_page; $i++){
if (($i &lt; $nb) OR ($i &gt; $nb_page - $nb) OR (($i &lt; $page + $nb) AND ($i &gt; $page -$nb)))
$list_page[] = ($i==$page)?'&lt;strong&gt;'.$i.'&lt;/strong&gt;':'&lt;a href=&quot;'.$link.'&amp;amp;page='.$i.'&quot;&gt;'.$i.'&lt;/a&gt;'; 
else{
if ($i &gt;= $nb AND $i &lt;= $page - $nb)
$i = $page - $nb;
elseif ($i &gt;= $page + $nb AND $i &lt;= $nb_page - $nb)
$i = $nb_page - $nb;
$list_page[] = '...';
}
}
$print= implode('-', $list_page);
return $print;
}
?&gt;</code></pre><p id="r-618394" data-claire-element-id="618394">Vous pouvez mettre ce code avec les autres fonctions pour s'assurer qu'il sera bien sur les pages voirtopic.php et voirforum.php ainsi que sur la liste des membres, bref à n'importe quel endroit où vous souhaitez lister des pages, enfin vous savez faire ça maintenant.</p><p id="r-618395" data-claire-element-id="618395">Pour ce qui est de son fonctionnement, quelques explications :</p><p id="r-618396" data-claire-element-id="618396">La fonction prend 3 paramètres obligatoires et 1 paramètre optionnel, le premier est le numéro de la page actuel, le second est le nombre de page, jusque là pas de soucis.<br/> Pour le troisième il s'agit en fait du début de la page sur laquelle vous vous trouvez, on verra un exemple plus tard mais en gros si vous êtes sur la page voirtopic.php, vous voulez que les liens pointent vers cette même page donc on doit donner cette information.<br/> Enfin le paramètre optionnel est le nombre de pages à afficher autours de la page actuel (genre si on est page 10, on veut afficher 8,9 et 11,12).</p><p id="r-618397" data-claire-element-id="618397">Concernant le php, il n'y a pas grand chose à dire, la fonction va entrer les pages à afficher dans un tableau nommé $list_page, pour transformer ce tableau en une chaine de caractère on utilise la fonction <a href="http://fr3.php.net/implode">implode</a> qui va au passage ajouter des - entre les numéros.</p><p id="r-618398" data-claire-element-id="618398">Allez hop un petit exemple bien senti pour mieux comprendre, celui de la page <strong>voirtopic.php</strong>.</p><p id="r-618399" data-claire-element-id="618399">Avant on avait :</p><pre id="r-618400" data-claire-element-id="618400"><code data-claire-semantic="html+php">&lt;?
echo '&lt;p&gt;Page : ';
for ($i = 1 ; $i &lt;= $nombreDePages ; $i++)
   {
   if ($i == $page) //On affiche pas la page actuelle en lien
      {
      echo' &lt;strong&gt;'.$i.'&lt;/strong&gt; ';
      }
   else
      {
      echo '&lt;a href=&quot;voirtopic.php?t='.$topic.'&amp;page='.$i.'&quot;&gt;' . $i . '&lt;/a&gt; ';
      }
   }
echo'&lt;/p&gt;';
?&gt;</code></pre><p id="r-618401" data-claire-element-id="618401">Et maintenant on aura</p><pre id="r-618402" data-claire-element-id="618402"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;p&gt;Page : ';
echo get_list_page($page, $nombreDePages, './voirtopic.php?t='.$topic);
echo'&lt;/p&gt;';
?&gt;</code></pre><p id="r-618403" data-claire-element-id="618403">Et en plus ça prend moins de place !</p><aside id="r-618405" data-claire-element-id="618405" data-claire-semantic="warning"><p id="r-618404" data-claire-element-id="618404">Vous remarquerez que pour le lien on ne met pas tout puisque c'est la fonction qui va se charger de le compléter (parce qu'on a besoin de mettre le numéro de la page dans l'url ce qu'on ne peut pas faire directement). Prudence donc...</p></aside><h3 id="r-les-configurations" data-claire-element-id="618433">Les configurations</h3><p id="r-618407" data-claire-element-id="618407">Lors du chapitre sur la page d'administration, je vous avais un peu laissé seul avec une phrase mystérieuse vous invitant à utiliser les valeurs de la table forum_config dans tout le forum, par exemple pour définir la taille minimale du pseudo.</p><p id="r-618408" data-claire-element-id="618408">Voici quelques informations supplémentaires pour vous guider, je ne voulais pas les mettre sur le chapitre concerné car il est déjà très lourd d'une part et d'autre part parce que ça vous laissez un peu gérer ça comme vous le souhaitiez.<br/> Néanmoins il s'est avéré que certains ne savaient pas quoi faire, donc voilà ma méthode, il y en a d'autres, si vous aviez déjà un système fonctionnel inutile de changer quoique ce soit.</p><p id="r-618409" data-claire-element-id="618409">L'idée est de récupérer les variables de configuration et de tout mettre dans un tableau appelé $config. Pour mémoire, la table forum_config est organisé en 2 champs, config_nom et config_valeur, il suffira donc de faire $config['nom de la config'] pour accéder à sa valeur.</p><p id="r-618410" data-claire-element-id="618410">Il suffit donc de remplir un petit tableau sur chaque page, donc pour cela il faut utiliser la page <strong>debut.php</strong>.</p><pre id="r-618411" data-claire-element-id="618411"><code data-claire-semantic="html+php">&lt;?php
//Récupération des variables de configuration
$query = $db-&gt;query('SELECT * FROM forum_config');
$config = array();
while($data=$query-&gt;fetch())
{
    $config[$data['config_nom']] = $data['config_valeur']; 
}
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618412" data-claire-element-id="618412">Voilà le travail, et pour finir un petit exemple :</p><p id="r-618413" data-claire-element-id="618413">Toujours sur la page <strong>voirtopic.php</strong> vous aviez au moment de compter le nombre de page un truc dans ce style :</p><pre id="r-618414" data-claire-element-id="618414"><code data-claire-semantic="html+php">&lt;?php
$totalDesMessages = $data['topic_post'] +1;
$nombreDeMessagesParPage = 15;
$nombreDePages = ceil($totalDesMessages / $nombreDeMessagesParPage);
?&gt;</code></pre><p id="r-618415" data-claire-element-id="618415">il suffit de remplacer le 15 par $config['post_par_page'] et vous pourrez alors modifier cette valeur directement via le panneau d'administration :) .</p><p id="r-618416" data-claire-element-id="618416">Avant de passe à la suite, je vais donner une liste en vrac des valeurs configurables depuis le panneau d'administration de cette manière :</p><ul id="r-618431" data-claire-element-id="618431"><li id="r-618418" data-claire-element-id="618418"><p id="r-618417" data-claire-element-id="618417">Le nombre de topics/posts par page</p></li><li id="r-618420" data-claire-element-id="618420"><p id="r-618419" data-claire-element-id="618419">La longueur/largeur max de l'avatar ainsi que son poids max</p></li><li id="r-618422" data-claire-element-id="618422"><p id="r-618421" data-claire-element-id="618421">Le titre du forum (qui apparait en gros sur la page d'index</p></li><li id="r-618424" data-claire-element-id="618424"><p id="r-618423" data-claire-element-id="618423">L'intervalle entre deux actions (contrôle anti flood, voir plus bas :p )</p></li><li id="r-618426" data-claire-element-id="618426"><p id="r-618425" data-claire-element-id="618425">La durée à partir de laquelle on affiche l'utilisateur en ligne (pour le système qui est en ligne, on avait pris 5 minutes)</p></li><li id="r-618428" data-claire-element-id="618428"><p id="r-618427" data-claire-element-id="618427">Autorisation du bbcode dans les messages/signatures</p></li><li id="r-618430" data-claire-element-id="618430"><p id="r-618429" data-claire-element-id="618429">Taille maximale de la signature/du pseudo et taille minimale du pseudo</p></li></ul><p id="r-618432" data-claire-element-id="618432">En gros il ne doit plus rester un seul chiffre dans tout vos codes :p . Bien évidemment vous pouvez ajouter autant de champ que vous le désirez !</p><h3 id="r-afficher-le-nombre-de-messages-non-lus" data-claire-element-id="618438">Afficher le nombre de messages non-lus</h3><p id="r-618434" data-claire-element-id="618434">Comme sur le SDZ, je pense que beaucoup préfère que le nombre de messages privés reçu apparaisse sur la page d'accueil ou du moins dans un menu pour éviter d'avoir à vérifier à chaque fois.</p><p id="r-618435" data-claire-element-id="618435">Il suffit tout bonnement d'utiliser le champ mp_lu de la table forum_mp, placez une requête de ce style :</p><pre id="r-618436" data-claire-element-id="618436"><code data-claire-semantic="html+php">&lt;?php
$query=$db-&gt;prepare('SELECT COUNT(*) FROM forum_mp WHERE mp_receveur = :id AND mp_lu = :lu');
$query-&gt;bindValue('id',$id,PDO::PARAM_INT);
$query-&gt;bindValue(':lu','0', PDO::PARAM_STR);
$query-&gt;execute();
$nbr_lu=$query-&gt;fetchColumn();
$query-&gt;CloseCursor();
?&gt;</code></pre><p id="r-618437" data-claire-element-id="618437">Avec $id l'id du membre (bien sûr il ne faut afficher cette requête que lorsque le visiteur est connecté, sinon il n'y a pas de mp...</p><h2 id="r-la-securite-2" data-claire-element-id="618456">La sécurité</h2><h3 id="r-systeme-anti-flood" data-claire-element-id="618448">Système anti-flood</h3><p id="r-618440" data-claire-element-id="618440">La sécurité anti flood permet d'éviter qu'un membre appuie sur raffraichir une fois sur la page de validation d'un message et qu'il en envoie ainsi une dizaine. Cette action peut être volontaire dans le cas d'un spam ou tout simplement accidentelle, c'est pourquoi il faut lutter contre.</p><p id="r-618441" data-claire-element-id="618441">Pour continuer le parallèle avec le SDZ, le système du SDZ est plus perfectionné, puisqu'il est possible de poster autant que l'on souhaite mais si on veut poster deux messages de suite sur le même topic, on doit attendre 24h.</p><p id="r-618442" data-claire-element-id="618442">Ce que l'on va faire c'est simplement au moment de valider le message d'un utilisateur, vérifier que le dernier message de l'utilisateur en question remonte a au moins x secondes. Pour le x vous pouvez entrer ce que vous voulez (10s, 15s, 20s), au delà ça devient assez pénible pour les gens postant des messages courts, de toute façon un spammeur ne va pas s'amuser à attendre 20 secondes entre deux posts, ça va vite le gonfler ^^ .</p><p id="r-618443" data-claire-element-id="618443">Voici donc le code à placer sur la page <strong>postok.php</strong></p><pre id="r-618444" data-claire-element-id="618444"><code data-claire-semantic="html+php">&lt;?
//Contrôle anti flood
$nombre_mess = mysql_result(mysql_query('SELECT COUNT(*) FROM forum_post WHERE post_createur = :id AND post_time &gt; :time');
$query-&gt;bindValue(':id',$id,PDO::PARAM_INT);
$query-&gt;bindValue(':time',time() - $config['temps_flood'],PDO::PARAM_INT);
$query-&gt;execute();
$nombre_mess=$query-&gt;fetchColumm();
if ($nombre_mess !=0)
{
    erreur(ERR_FLOOD);
}
?&gt;</code></pre><p id="r-618445" data-claire-element-id="618445">$config['temps_flood'] contient la valeur de la durée en secondes minimales entre deux actions.<br/> Bien sur il faudra penser à mettre ce code à 2 endroits (pour les réponses et pour les nouveaux topics).</p><p id="r-618446" data-claire-element-id="618446">Pour l'erreur ERR_FLOOD, vous pouvez écrire quelque chose comme</p><pre id="r-618447" data-claire-element-id="618447"><code data-claire-semantic="html+php">&lt;?php
define('ERR_FLOOD','Contrôle anti flood, vous ne pouvez poster que toutes les '.$config['temps_flood'].' sec.&lt;br /&gt;
Veuillez attendre un moment puis recommencer');
?&gt;</code></pre><h3 id="r-le-forum-est-il-fiable" data-claire-element-id="618455">Le forum est-il fiable ?</h3><p id="r-618449" data-claire-element-id="618449">Une question qu'on m'a posé (très) souvent et qui est largement légitime mais dont il est difficile d'apporter une réponse claire.<br/> Les dernières modifications apportées au tuto ont permis d'en améliorer la sécurité en suivant un schéma simple :</p><p id="r-618450" data-claire-element-id="618450">L'utilisation de la fonction bindValue et de la PDO permet de limiter les risques d'injection SQL.</p><p id="r-618451" data-claire-element-id="618451">stripslashes(htmlspecialchars()) est utilisé lors de l'affichage de cette variable.</p><p id="r-618452" data-claire-element-id="618452">Enfin on utilise intval() pour les données chiffrées et simplement htmlspecialchars() pour afficher simplement une variable qui ne provient pas de la base de données (formulaire ou variable $_GET par exemple).</p><p id="r-618453" data-claire-element-id="618453">Enfin pour ceux qui ont adapté le système de cookie il ne faut surtout pas oublier la vérification par le mot de passe.<br/> Le mieux serait d'entrer le mot de passe dans un cookie lors de la connexion et de faire la vérification avant de créer la variable de session, sinon n'importe qui pourra se connecter en changeant ses cookies ce qui est carrément gênant surtout s'il prend le compte d'un admin...</p><p id="r-618454" data-claire-element-id="618454">Finalement c'est assez simple mais si vous respectez cette méthode vous n'aurez à priori pas de problème de failles.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">
<span class="arrow"></span>
<span class="next">Annexe</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
<span class="next">Liste de forums</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Listedeforums"></a><h2>Liste de forums</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
<span class="arrow"></span>
<span class="next">Questions récurrentes</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-618458" data-claire-element-id="618458">Dans cette sous partie j'aimerai donner des liens vers des forums qui se sont inspirés de près ou de loin du tuto. J'ai déjà vu un bon paquet de tels forums et beaucoup m'ont envoyé un lien pour que je le recopie.</p><p id="r-618459" data-claire-element-id="618459">J'invite tous les zéros désirant ajouter leur forum à m'envoyer un MP avec dans le titre [forum] et en précisant le lien et une petite description.</p><p id="r-618460" data-claire-element-id="618460">Quant aux autres, cette liste constituera autant d'exemples et de démonstrations que possible à partir des scripts que vous avez lu jusqu'ici.</p><h2 id="r-la-liste-3" data-claire-element-id="618569">La liste</h2><table id="r-618568" data-claire-element-id="618568"><thead id="r-618468" data-claire-element-id="618468"><tr id="r-618467" data-claire-element-id="618467"><th id="r-618462" data-claire-element-id="618462"><p id="r-618461" data-claire-element-id="618461">Forum</p></th><th id="r-618464" data-claire-element-id="618464"><p id="r-618463" data-claire-element-id="618463">Auteur</p></th><th id="r-618466" data-claire-element-id="618466"><p id="r-618465" data-claire-element-id="618465">Description</p></th></tr></thead><tbody id="r-618567" data-claire-element-id="618567"><tr id="r-618475" data-claire-element-id="618475"><td id="r-618470" data-claire-element-id="618470"><p id="r-618469" data-claire-element-id="618469"><a href="http://communots.free.fr/tuto">Forum exemple du tuto</a></p></td><td id="r-618472" data-claire-element-id="618472"><p id="r-618471" data-claire-element-id="618471"><a href="http://www.siteduzero.com/membres-294-7851.html">Tadzoa</a></p></td><td id="r-618474" data-claire-element-id="618474"><p id="r-618473" data-claire-element-id="618473"><em>Le forum qui a servit de support pour ce tuto, il possède à peu de choses près les mêmes script que ceux que vous avez pu voir ici</em></p></td></tr><tr id="r-618482" data-claire-element-id="618482"><td id="r-618477" data-claire-element-id="618477"><p id="r-618476" data-claire-element-id="618476"><a href="http://edudz.net/forum/">eduDZ</a></p></td><td id="r-618479" data-claire-element-id="618479"><p id="r-618478" data-claire-element-id="618478"><a href="http://www.siteduzero.com/membres-294-16441.html">nextrem</a></p></td><td id="r-618481" data-claire-element-id="618481"><p id="r-618480" data-claire-element-id="618480"><em>Forum regroupant une communauté de lycéens algériens</em></p></td></tr><tr id="r-618489" data-claire-element-id="618489"><td id="r-618484" data-claire-element-id="618484"><p id="r-618483" data-claire-element-id="618483"><a href="http://www.d3news.fr/forum/">D3news</a></p></td><td id="r-618486" data-claire-element-id="618486"><p id="r-618485" data-claire-element-id="618485"><a href="http://www.siteduzero.com/membres-294-86614.html">Panzaa</a></p></td><td id="r-618488" data-claire-element-id="618488"><p id="r-618487" data-claire-element-id="618487"><em>Forum autours de Diablo 3</em></p></td></tr><tr id="r-618496" data-claire-element-id="618496"><td id="r-618491" data-claire-element-id="618491"><p id="r-618490" data-claire-element-id="618490"><a href="http://www.infowebmaster.fr/forum/">Forum webmastering</a></p></td><td id="r-618493" data-claire-element-id="618493"><p id="r-618492" data-claire-element-id="618492"><a href="http://www.siteduzero.com/membres-294-52982.html">funnycat</a></p></td><td id="r-618495" data-claire-element-id="618495"><p id="r-618494" data-claire-element-id="618494"><em>Forum ayant pour thématique le webmastering au sens large.</em></p></td></tr><tr id="r-618503" data-claire-element-id="618503"><td id="r-618498" data-claire-element-id="618498"><p id="r-618497" data-claire-element-id="618497"><a href="http://nairod.site90.net/forum">Forum Web By Nairod</a></p></td><td id="r-618500" data-claire-element-id="618500"><p id="r-618499" data-claire-element-id="618499"><a href="http://www.siteduzero.com/membres-294-116568.html">MisterDo</a></p></td><td id="r-618502" data-claire-element-id="618502"><p id="r-618501" data-claire-element-id="618501"><em>Site sur l'informatique avec tutoriels, projets, forum ayant pour but le partage de connaissances</em></p></td></tr><tr id="r-618510" data-claire-element-id="618510"><td id="r-618505" data-claire-element-id="618505"><p id="r-618504" data-claire-element-id="618504"><a href="http://philisto.servhome.org/forum.php">Forum Philisto</a></p></td><td id="r-618507" data-claire-element-id="618507"><p id="r-618506" data-claire-element-id="618506"><a href="http://www.siteduzero.com/membres-294-129488.html">thibaultg</a></p></td><td id="r-618509" data-claire-element-id="618509"><p id="r-618508" data-claire-element-id="618508"><em>Forum sur l'histoire et la philosophie</em></p></td></tr><tr id="r-618517" data-claire-element-id="618517"><td id="r-618512" data-claire-element-id="618512"><p id="r-618511" data-claire-element-id="618511"><a href="http://demo.chezgus.com/forum.html">Forum ChezGus</a></p></td><td id="r-618514" data-claire-element-id="618514"><p id="r-618513" data-claire-element-id="618513"><a href="http://www.siteduzero.com/membres-294-47716.html">Nikitz</a></p></td><td id="r-618516" data-claire-element-id="618516"><p id="r-618515" data-claire-element-id="618515"><em>Un CMS dont le forum est inspiré du tuto</em></p></td></tr><tr id="r-618524" data-claire-element-id="618524"><td id="r-618519" data-claire-element-id="618519"><p id="r-618518" data-claire-element-id="618518"><a href="http://www.mhqforum.fr/">Forum MHQ</a></p></td><td id="r-618521" data-claire-element-id="618521"><p id="r-618520" data-claire-element-id="618520"><a href="http://www.siteduzero.com/membres-294-58326.html">Lucky_68</a></p></td><td id="r-618523" data-claire-element-id="618523"><p id="r-618522" data-claire-element-id="618522"><em>Forum créé pour un lycée</em></p></td></tr><tr id="r-618531" data-claire-element-id="618531"><td id="r-618526" data-claire-element-id="618526"><p id="r-618525" data-claire-element-id="618525"><a href="http://www.celestia-odyssey.com/forum/index.php">Forum Celestia Odyssey</a></p></td><td id="r-618528" data-claire-element-id="618528"><p id="r-618527" data-claire-element-id="618527"><a href="http://www.siteduzero.com/membres-294-159557.html">SoupeurStar</a></p></td><td id="r-618530" data-claire-element-id="618530"><p id="r-618529" data-claire-element-id="618529"><em>Forum créé pour un MMO en ligne</em></p></td></tr><tr id="r-618538" data-claire-element-id="618538"><td id="r-618533" data-claire-element-id="618533"><p id="r-618532" data-claire-element-id="618532"><a href="http://www.tuenpensesquoi.fr/accueil_forum.php">Forum Tu en penses quoi ?</a></p></td><td id="r-618535" data-claire-element-id="618535"><p id="r-618534" data-claire-element-id="618534"><a href="http://www.siteduzero.com/membres-294-55661.html">Bat538</a></p></td><td id="r-618537" data-claire-element-id="618537"><p id="r-618536" data-claire-element-id="618536"><em>Le forum accompagne un site de pronostics footballistiques. Il permet aux membres (peu nombreux) de discuter des sujets sportifs divers</em></p></td></tr><tr id="r-618545" data-claire-element-id="618545"><td id="r-618540" data-claire-element-id="618540"><p id="r-618539" data-claire-element-id="618539"><a href="http://www.dofux.org/forum.dx">Forum Dofux</a></p></td><td id="r-618542" data-claire-element-id="618542"><p id="r-618541" data-claire-element-id="618541"><a href="http://www.siteduzero.com/membres-294-63260.html">Sw4gger</a></p></td><td id="r-618544" data-claire-element-id="618544"><p id="r-618543" data-claire-element-id="618543"><em>Un forum sur Dofus</em></p></td></tr><tr id="r-618552" data-claire-element-id="618552"><td id="r-618547" data-claire-element-id="618547"><p id="r-618546" data-claire-element-id="618546"><a href="http://2geek.legtux.org/forum/index.php">Forum2Geek</a></p></td><td id="r-618549" data-claire-element-id="618549"><p id="r-618548" data-claire-element-id="618548"><a href="http://www.siteduzero.com/membres-294-216235.html">Abmo</a></p></td><td id="r-618551" data-claire-element-id="618551"><p id="r-618550" data-claire-element-id="618550"><em>Forum du site 2geek : Le site pour débutants où tout est expliqué à partir de Zéro ! Des créations est des tutos de tout les genres ! Des astuces pour tout le monde ...</em></p></td></tr><tr id="r-618559" data-claire-element-id="618559"><td id="r-618554" data-claire-element-id="618554"><p id="r-618553" data-claire-element-id="618553"><a href="http://www.tera-world.fr/">Tera World</a></p></td><td id="r-618556" data-claire-element-id="618556"><p id="r-618555" data-claire-element-id="618555"><a href="http://www.siteduzero.com/membres-294-95965.html">Bacamos</a></p></td><td id="r-618558" data-claire-element-id="618558"><p id="r-618557" data-claire-element-id="618557"><em>Forum sur le mmorpg Tera</em></p></td></tr><tr id="r-618566" data-claire-element-id="618566"><td id="r-618561" data-claire-element-id="618561"><p id="r-618560" data-claire-element-id="618560"><a href="http://www.boite-a-questions.com/fr/forum">La boite à question</a></p></td><td id="r-618563" data-claire-element-id="618563"><p id="r-618562" data-claire-element-id="618562"><a href="http://www.siteduzero.com/membres-294-224135.html">quentinus95</a></p></td><td id="r-618565" data-claire-element-id="618565"><p id="r-618564" data-claire-element-id="618564"><em>Un forum d'entraide qui parle de tout</em></p></td></tr></tbody></table><h2 id="r-ajouter-son-forum" data-claire-element-id="618577">Ajouter son forum</h2><p id="r-618570" data-claire-element-id="618570">Pour ajouter son forum à cette liste, si votre forum est terminé et qu'il est inspiré du tuto, n'hésitez pas à m'envoyer un MP, mais n'oubliez surtout pas le [forum] devant le titre ^^</p><p id="r-618571" data-claire-element-id="618571">Voilà c'est tout pour cette annexe que je n'exclue pas de modifier ne serait-ce qu'avec les adresses de nouveaux forum qui j'espère seront nombreux.</p><p id="r-618572" data-claire-element-id="618572">Je vous souhaite une fois de plus un bon courage et un avenir radieux pour votre forum :)</p><p id="r-618573" data-claire-element-id="618573">Voilà pour ce tuto sur la création d'un forum, j'ai essayé d'être le plus complet possible tout en laissant à chacun une grande part de personnalisation.<br/> Si jamais vous avez des conseils n'hésitez pas à les signaler dans les commentaires et je souhaite à votre forum un bon développement.</p><aside id="r-618575" data-claire-element-id="618575" data-claire-semantic="information"><p id="r-618574" data-claire-element-id="618574">Si vous avez une question sur le tuto, évitez de la poser sur les commentaires du tuto et préférez le forum.<br/> Vous pouvez par exemple vous rendre sur <a href="http://www.siteduzero.com/forum-83-567346-p1-big-tuto-sur-les-forums.html">ce topic</a> qui vous proposera en outre un lien vers un forum démo.<br/> Par contre évitez de me poser des questions sur vos codes par MP, je n'ai pas le temps de corriger tous vos codes ! Je suis en revanche ouvert à toutes question de fond sur le tuto !</p></aside><p id="r-618576" data-claire-element-id="618576">Merci également de ne pas me réclamer les codes, si je ne les donne pas c'est parce que ça n'a aucun intérêt, si vous cherchez un forum tout fait il en existe des centaines.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces">Créer son forum de toutes pièces</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les pages membres
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/avant-tout-2">Avant tout</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/presentation-67">
Présentation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-base-de-donnees-3">
La base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-design-1">
Le design
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-d-index">Page d&#039;index</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-fichiers-inclus">
Les fichiers inclus
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/affichons-notre-page">
Affichons notre page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/on-teste">
On teste !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/inscription-et-connexion">Inscription et connexion</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/connexion-4">
Connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/enregistrement-9">
Enregistrement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/ameliorations-8">
Améliorations
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-profils-2">Les profils</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-le-profil">
Voir le profil
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/modifier-le-profil">
Modifier le profil
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/forums-et-topics">Forums et Topics</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-forum">
Voir un forum
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/voir-un-topic">
Voir un topic
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/poster">Poster</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/page-de-formulaire">
Page de formulaire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bbcode">
Le bbcode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/traiter-le-message">
Traiter le message
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/messages-prives">Messages privés</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/lire-un-message">
Lire un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/repondre-poster-supprimer">
Répondre, Poster, Supprimer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-boite-de-mp">
La boîte de Mp
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Les pages administration
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/autorisations-d-acces">Autorisations d&#039;accès</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/faire-un-forum-vip">
Faire un forum VIP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/le-bannissement">
Le bannissement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/les-annonces">
Les annonces
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/remarques-3">
Remarques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/tp-moderer-le-forum">TP : Modérer le forum</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/objectif-14">
Objectif
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/conseils-1">
Conseils
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/correction-29">
Correction
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-i">Administration Partie I</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/structure-de-la-page-1">
Structure de la page
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-2">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres">
Gestion des membres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/administration-partie-ii">Administration Partie II</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/configuration-5">
Configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-forums-1">
Gestion des forums
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-membres-1">
Gestion des membres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Et plus
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/quelques-fonctions-en-plus">Quelques fonctions en plus</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/systeme-lu-non-lu">
Système lu / non-lu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/qui-est-en-ligne">
Qui est en ligne ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/et-encore-trois-autres">Et encore trois autres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/la-liste-des-membres">
La liste des membres
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/gestion-des-amis">
Gestion des amis
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/reponses-automatiques">
Réponses automatiques
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/annexe-1">Annexe</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
Questions récurrentes
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/liste-de-forums">
Liste de forums
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-son-forum-de-toutes-pieces/questions-recurrentes">
<span class="arrow"></span>
<span class="next">Questions récurrentes</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-son-forum-de-toutes-pieces.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 09:14:54 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-son-forum-de-toutes-pieces.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:38:02 GMT -->
</html>