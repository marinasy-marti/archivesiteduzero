<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-une-horloge-animee-avec-css3-et-javascript.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:32:15 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-une-horloge-animee-avec-css3-et-javascript.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:32:04 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Créer une horloge animée avec CSS3 et Javascript</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Créer une horloge animée avec CSS3 et Javascript</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#CrerunehorlogeanimeavecCSS3etJavascript">Créer une horloge animée avec CSS3 et Javascript</a><br/><a href="#Introduction">Introduction</a><br/><a href="#Lefonctionnementdel039horloge">Le fonctionnement de l&#039;horloge</a><br/><a href="#Oncode">On code</a><br/><a href="#Pourallerplusloin">Pour aller plus loin</a><br/></div>
<a name="CrerunehorlogeanimeavecCSS3etJavascript"></a><h2>Créer une horloge animée avec CSS3 et Javascript</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
<span class="next">Introduction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-384146" data-claire-element-id="384146">Le but de ce tutoriel sera de vous montrer comment exploiter certaines propriétés CSS3 pour créer une horloge et comment l'animer avec Javascript.<br/> La création de ce petit module nécessite peu de connaissances : il suffit de connaître les bases du Javascript, du CSS et, bien sûr, de l'HTML. :)</p><aside id="r-384148" data-claire-element-id="384148" data-claire-semantic="warning"><p id="r-384147" data-claire-element-id="384147">L'horloge telle que présentée dans ce tutoriel ne sera compatible qu'avec les navigateurs (très) récents. Il y a toutefois des solutions pour remédier à ce problème et des liens sont donnés à la fin du tutoriel.</p></aside><p id="r-384149" data-claire-element-id="384149">Voici un aperçu du résultat final :</p><figure id="r-384151" data-claire-element-id="384152"><img id="r-384150" data-claire-element-id="384150" src="medias/uploads.siteduzero.com_files_162001_163000_162750.jpg" alt="Image utilisateur"/></figure>
</div><a name="Introduction"></a><h2>Introduction</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
<span class="next">Le fonctionnement de l&#039;horloge</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-384153" data-claire-element-id="384153">Le gros problème de ce module est la compatibilité. En effet, il utilise des propriétés CSS3 qui ne sont actuellement prises en charge que par les navigateurs récents.<br/> Voici la liste des principaux navigateurs qui le supportent :</p><ul id="r-384164" data-claire-element-id="384164"><li id="r-384155" data-claire-element-id="384155"><p id="r-384154" data-claire-element-id="384154">Firefox 3.5 et plus ;</p></li><li id="r-384157" data-claire-element-id="384157"><p id="r-384156" data-claire-element-id="384156">Safari 3.0.4 et plus ;</p></li><li id="r-384159" data-claire-element-id="384159"><p id="r-384158" data-claire-element-id="384158">Google Chrome ;</p></li><li id="r-384161" data-claire-element-id="384161"><p id="r-384160" data-claire-element-id="384160">Internet Explorer 9 ;</p></li><li id="r-384163" data-claire-element-id="384163"><p id="r-384162" data-claire-element-id="384162">Opera 10.5 et plus ;</p></li></ul><p id="r-384165" data-claire-element-id="384165">Si vous voulez savoir si votre navigateur peut afficher le module, allez <a href="http://berdes.alwaysdata.net/SdZ/test.html">sur cette page</a>. Si votre navigateur n'est pas compatible, il faudra vous procurer un navigateur plus récent.</p><p id="r-384166" data-claire-element-id="384166">Nous verrons quand même comment faire pour que tous navigateurs affichent une page correcte sans bug, même s'ils ne sont pas compatibles.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript">Créer une horloge animée avec CSS3 et Javascript</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
Le fonctionnement de l&#039;horloge
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
On code
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/pour-aller-plus-loin-28">
Pour aller plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
<span class="next">Le fonctionnement de l&#039;horloge</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lefonctionnementdel039horloge"></a><h2>Le fonctionnement de l&#039;horloge</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
<span class="arrow"></span>
<span class="next">Introduction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
<span class="next">On code</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-384168" data-claire-element-id="384168">Dans cette partie, je vais expliquer le principe de ce module, comment il fonctionne. On va décortiquer son fonctionnement pour pouvoir coder efficacement et sans tracas. :) On ne codera que dans la partie suivante.</p><h3 id="r-transform-et-transform-origin" data-claire-element-id="384187">Transform et transform-origin</h3><p id="r-384169" data-claire-element-id="384169">Le module se base sur les propriétés CSS3 <strong>transform</strong> et <strong>transform-origin</strong>. La première propriété transforme (quelle surprise :D ) un élément de la page. Les transformations les plus intéressantes sont la mise à l'échelle, la rotation et la translation. Nous ne nous servirons que de la rotation.<br/> Voici un exemple d'utilisation pour que vous compreniez bien comment cela fonctionne :</p><pre id="r-384170" data-claire-element-id="384170"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
   &lt;head&gt;
      &lt;title&gt;Créer une horloge animée avec CSS3 et Javascript&lt;/title&gt;
      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
      &lt;style type=&quot;text/css&quot;&gt;
        h1
         {
            -moz-transform: rotate(-5deg);
            -webkit-transform: rotate(-5deg);
            -o-transform: rotate(-5deg);
            -ms-transform: rotate(-5deg);
            transform: rotate(-5deg);
            -moz-transform-origin: center center;
            -webkit-transform-origin: center center;
            -o-transform-origin: center center;
            -ms-transform-origin: center center;
            transform-origin: center center;
            text-align: center;
         }
      &lt;/style&gt;
   &lt;/head&gt;
   &lt;body&gt;
      &lt;h1&gt;Mon super titre&lt;/h1&gt;
   &lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-384171" data-claire-element-id="384171">Le résultat <a href="http://berdes.alwaysdata.net/SdZ/1.html">ici</a>.</p><div id="r-384174" data-claire-element-id="384174" data-claire-semantic="question"><p id="r-384172" data-claire-element-id="384172">Eh ! Mais je croyais qu'on utilisait juste les propriétés <strong>transform</strong> et <strong>transform-origin</strong> ! o_O</p><p id="r-384173" data-claire-element-id="384173">Qu'est-ce que c'est que ces <em>-moz-</em>, <em>-webkit-</em>, <em>-o-</em> et <em>-ms-</em>?</p></div><p id="r-384175" data-claire-element-id="384175">Bonne question. En fait, ces propriétés (<strong>transform</strong> et <strong>transform-origin</strong>) ne sont pas encore dans les standards du W3C (la spécification CSS3 n'étant pas encore finalisée), donc les navigateurs qui les utilisent mettent un préfixe (<em>-moz-</em> pour Mozilla, <em>-webkit-</em> pour Safari, <em>-ms-</em> pour Internet Explorer et <em>-o-</em> pour Opera) pour ne pas interférer avec les standards. Il est tout de même préférable de rajouter les propriétés sans suffixe pour qu'elles fonctionnent pleinement le jour où un navigateur ne comprendra que la propriété non suffixée (Merci à SpaceFox pour la remarque).</p><div id="r-384177" data-claire-element-id="384177" data-claire-semantic="question"><p id="r-384176" data-claire-element-id="384176">Ça veut dire qu'on devra mettre <em>-moz-*</em>, <em>-webkit-*</em>, <em>-o-*</em> et <em>-ms-*</em> à chaque fois ?</p></div><p id="r-384178" data-claire-element-id="384178">Malheureusement, oui.</p><h2 id="r-on-decortique-le-code" data-claire-element-id="384186">On décortique le code</h2><h3 id="r-l-xhtml" data-claire-element-id="384180">L'xHTML</h3><p id="r-384179" data-claire-element-id="384179">Pour la partie xHTML, l'horloge est très simple, vu que ce sont trois images (les trois aiguilles) dans un conteneur (ici un <em>div</em>).</p><h3 id="r-le-css-3" data-claire-element-id="384182">Le CSS</h3><p id="r-384181" data-claire-element-id="384181">Du côté du CSS, ça reste toujours aussi simple :<br/> On va mettre le cadran comme fond de l'horloge. On va arrondir les bords du <em>div</em> conteneur de l'horloge pour qu'il fasse un cercle entourant le cadran et on va placer l'horloge en position relative pour pouvoir positionner les aiguilles en fonction de la position de l'horloge.</p><h3 id="r-le-javascript-1" data-claire-element-id="384185">Le Javascript</h3><p id="r-384183" data-claire-element-id="384183">C'est ici que résident tous les secrets de cette horloge.<br/> On va commencer par déterminer le nombre de secondes écoulées depuis le début de la journée.<br/> Ensuite, on va faire tourner les aiguilles pour qu'elles indiquent l'heure du chargement de la page.<br/> Et enfin, toutes les secondes, on va incrémenter le nombre de secondes écoulées depuis le début de la journée, puis replacer les aiguilles en conséquence.</p><p id="r-384184" data-claire-element-id="384184">Avouez tout de même que le fonctionnement est vraiment simple ! :)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript">Créer une horloge animée avec CSS3 et Javascript</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
Introduction
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
Le fonctionnement de l&#039;horloge
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
On code
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/pour-aller-plus-loin-28">
Pour aller plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
<span class="arrow"></span>
<span class="next">Introduction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
<span class="next">On code</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Oncode"></a><h2>On code</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
<span class="arrow"></span>
<span class="next">Le fonctionnement de l&#039;horloge</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/pour-aller-plus-loin-28">
<span class="next">Pour aller plus loin</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-384189" data-claire-element-id="384189">Nous y voici donc, au codage de cette horloge. Cela va aller assez vite, vu que l'on a déjà fait 70% du travail en décortiquant le fonctionnement de l'horloge.</p><h2 id="r-l-xhtml-1" data-claire-element-id="384202">L'xHTML</h2><p id="r-384190" data-claire-element-id="384190">On va donc commencer par mettre un <em>div</em> qui contient les 3 aiguilles :</p><pre id="r-384191" data-claire-element-id="384191"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
&lt;head&gt;
   &lt;title&gt;Horloge&lt;/title&gt;
   &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;div id=&quot;horloge&quot;&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigS&quot; src=&quot;aigS.png&quot; alt=&quot;aiguille des secondes&quot; /&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigM&quot; src=&quot;aigM.png&quot; alt=&quot;aiguille des minutes&quot; /&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigH&quot; src=&quot;aigH.png&quot; alt=&quot;aiguille des heures&quot; /&gt;
   &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-384192" data-claire-element-id="384192">Voici d'ailleurs les images des trois aiguilles, ainsi que le cadran (vous remarquerez au passage que je n'ai aucun talent d'artiste :p ) :</p><ul id="r-384201" data-claire-element-id="384201"><li id="r-384194" data-claire-element-id="384194"><p id="r-384193" data-claire-element-id="384193"><a href="medias/uploads.siteduzero.com_files_162001_163000_162994.png">Aiguille des secondes</a></p></li><li id="r-384196" data-claire-element-id="384196"><p id="r-384195" data-claire-element-id="384195"><a href="medias/uploads.siteduzero.com_files_162001_163000_162993.png">Aiguille des minutes</a></p></li><li id="r-384198" data-claire-element-id="384198"><p id="r-384197" data-claire-element-id="384197"><a href="medias/uploads.siteduzero.com_files_162001_163000_162992.png">Aiguille des heures</a></p></li><li id="r-384200" data-claire-element-id="384200"><p id="r-384199" data-claire-element-id="384199"><a href="medias/uploads.siteduzero.com_files_163001_164000_163059.png">Cadran</a></p></li></ul><h2 id="r-le-css-4" data-claire-element-id="384206">Le CSS</h2><p id="r-384203" data-claire-element-id="384203">On met l'horloge en <code data-claire-semantic="css">position: relative;</code>. Cela permet de pouvoir positionner les aiguilles en fonction de l'emplacement de l'horloge.<br/> On met les aiguilles en <code data-claire-semantic="css">position: absolute;</code>.<br/> On met le cadran : <code data-claire-semantic="css">background: url('cadran.png');</code>.<br/> On agrandit l'horloge pour que le cadran soit entier : <code data-claire-semantic="css">height: 567px; width: 567px;</code>.<br/> On met le bas des aiguilles au milieu de l'horloge : <code data-claire-semantic="css">bottom: 283px;</code>.<br/> On règle l'abscisse des aiguilles : <code data-claire-semantic="css">/* aiguille des secondes : */left: 283px; /* pour les deux autres : */left : 278px;</code>.<br/> On place le centre de rotation des aiguilles : <code data-claire-semantic="css">transform-origin: bottom center;</code> (je n'ai pas mis les suffixes).<br/> Et enfin, on met une bordure à l'horloge et on l'arrondit pour qu'elle soit circulaire : <code data-claire-semantic="css">border: 1px solid black; border-radius: 284px;</code>. On indique ici la valeur de l'arrondi en pixels parce que webkit n'accepte pas la valeur en pourcentage.</p><p id="r-384204" data-claire-element-id="384204">On met tout ça dans le code HTML :</p><pre id="r-384205" data-claire-element-id="384205"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
&lt;head&gt;
   &lt;title&gt;Horloge&lt;/title&gt;
   &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
   &lt;style type=&quot;text/css&quot;&gt;
      .aig
      {
         position: absolute;
         bottom: 283px;
         -moz-transform-origin: bottom center;
         -webkit-transform-origin: bottom center;
         -o-transform-origin: bottom center;
         -ms-transform-origin: bottom center;
         transform-origin: bottom center;
      }
      #horloge
      {
         position: relative;
         height: 567px;
         width: 567px;
         border: 1px solid black;
         -moz-border-radius: 284px;
         -webkit-border-radius: 284px;
         -o-border-radius: 284px;
         -ms-border-radius: 284px;
         border-radius: 284px;
         background: url('cadran.png');
      }
   &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;div id=&quot;horloge&quot;&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigS&quot; src=&quot;aigS.png&quot; alt=&quot;aiguille des secondes&quot; style=&quot;left: 283px;&quot; /&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigM&quot; src=&quot;aigM.png&quot; alt=&quot;aiguille des minutes&quot; style=&quot;left: 278px;&quot; /&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigH&quot; src=&quot;aigH.png&quot; alt=&quot;aiguille des heures&quot; style=&quot;left: 278px;&quot; /&gt;
   &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h2 id="r-le-javascript-2" data-claire-element-id="384247">Le Javascript</h2><p id="r-384207" data-claire-element-id="384207">On détermine le nombre de secondes écoulées depuis le début de la journée :</p><pre id="r-384208" data-claire-element-id="384208"><code data-claire-semantic="javascript">var d    = new Date();
var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();</code></pre><p id="r-384209" data-claire-element-id="384209">On place les aiguilles. Je vais expliquer les calculs juste après :</p><pre id="r-384210" data-claire-element-id="384210"><code data-claire-semantic="javascript">var aigS = document.getElementById('aigS');
var aigM = document.getElementById('aigM');
var aigH = document.getElementById('aigH');

aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';</code></pre><p id="r-384211" data-claire-element-id="384211">Voici un petit tableau de proportionnalité pour comprendre les calculs :</p><table id="r-384235" data-claire-element-id="384235"><thead id="r-384219" data-claire-element-id="384219"><tr id="r-384218" data-claire-element-id="384218"><th id="r-384213" data-claire-element-id="384213"><p id="r-384212" data-claire-element-id="384212">Nombre de degrés</p></th><th id="r-384215" data-claire-element-id="384215"><p id="r-384214" data-claire-element-id="384214">Minutes, secondes</p></th><th id="r-384217" data-claire-element-id="384217"><p id="r-384216" data-claire-element-id="384216">Heures</p></th></tr></thead><tbody id="r-384234" data-claire-element-id="384234"><tr id="r-384226" data-claire-element-id="384226"><td id="r-384221" data-claire-element-id="384221"><p id="r-384220" data-claire-element-id="384220">360</p></td><td id="r-384223" data-claire-element-id="384223"><p id="r-384222" data-claire-element-id="384222">60</p></td><td id="r-384225" data-claire-element-id="384225"><p id="r-384224" data-claire-element-id="384224">12</p></td></tr><tr id="r-384233" data-claire-element-id="384233"><td id="r-384228" data-claire-element-id="384228"><p id="r-384227" data-claire-element-id="384227">Nombre inconnu<br/> (noté x)</p></td><td id="r-384230" data-claire-element-id="384230"><p id="r-384229" data-claire-element-id="384229">Nombre de minutes ou secondes<br/> (notées respectivement « m » et « s »)</p></td><td id="r-384232" data-claire-element-id="384232"><p id="r-384231" data-claire-element-id="384231">Nombre d'heures<br/> (notées « h »)</p></td></tr></tbody></table><p id="r-384236" data-claire-element-id="384236">Comme vous le voyez, il n'y a qu'un nombre inconnu ( : x ), donc pour calculer l'angle de décalage de l'aiguille des secondes, on doit faire : x_s=\frac{360s}{60}<br/> Pour celle des minutes, on doit faire : x_m=\frac{360m}{60}<br/> Et pour celle des heures, on fait : x_h=\frac{360h}{12}<br/> Et donc en simplifiant, on obtient respectivement : x_s=6s\qquad ;\qquad x_m=6m\qquad;\qquad x_h=30h</p><div id="r-384238" data-claire-element-id="384238" data-claire-semantic="question"><p id="r-384237" data-claire-element-id="384237">Oui, mais on ne possède que le nombre de secondes !</p></div><p id="r-384239" data-claire-element-id="384239">J'y viens, j'y viens. Je devine que tout le monde sait qu'il y a 3600 secondes dans une heure et 60 secondes dans une minute.<br/> Donc on a : m=\frac{s}{60}\qquad;\qquad h=\frac{s}{3600}<br/> Les calculs de tout à l'heure deviennent donc, en simplifiant : x_s=6s\qquad ;\qquad x_m=\frac{s}{10}\qquad;\qquad x_h=\frac{s}{120}</p><p id="r-384240" data-claire-element-id="384240">Retournons à notre Javascript :<br/> Il nous reste juste à faire en sorte que l'horloge se « mette à l'heure » (c'est le cas de le dire :p ) toutes les secondes.<br/> Pour cela, on va utiliser <em>setInterval()</em> qui va exécuter une fonction toutes les x millisecondes :</p><pre id="r-384241" data-claire-element-id="384241"><code data-claire-semantic="javascript">setInterval(function() {
   time++;
   aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
   aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
}, 1000);</code></pre><p id="r-384242" data-claire-element-id="384242">On a donc au final ce code Javascript :</p><pre id="r-384243" data-claire-element-id="384243"><code data-claire-semantic="javascript">var d    = new Date();
var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();

var aigS = document.getElementById('aigS');
var aigM = document.getElementById('aigM');
var aigH = document.getElementById('aigH');

aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';

setInterval(function() {
   time++;
   aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
   aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
   aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
   aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
}, 1000);</code></pre><p id="r-384244" data-claire-element-id="384244">Et inséré dans le code HTML ça donne :</p><pre id="r-384245" data-claire-element-id="384245"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
&lt;head&gt;
   &lt;title&gt;Horloge&lt;/title&gt;
   &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
   &lt;style type=&quot;text/css&quot;&gt;
      .aig
      {
         position: absolute;
         bottom: 283px;
         -moz-transform-origin: bottom center;
         -webkit-transform-origin: bottom center;
         -o-transform-origin: bottom center;
         -ms-transform-origin: bottom center;
         transform-origin: bottom center;
      }
      #horloge
      {
         position: relative;
         height: 567px;
         width: 567px;
         border: 1px solid black;
         -moz-border-radius: 284px;
         -webkit-border-radius: 284px;
         -o-border-radius: 284px;
         -ms-border-radius: 284px;
         border-radius: 284px;
         background: url('cadran.png');
      }
   &lt;/style&gt;
   &lt;script type=&quot;text/javascript&quot;&gt;
   window.onload = function() // Il faut pense à attendre que la page soit chargée avant d'exécuter le script
   {
      var d    = new Date();
      var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();

      var aigS = document.getElementById('aigS');
      var aigM = document.getElementById('aigM');
      var aigH = document.getElementById('aigH');

      aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
      aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';

      setInterval(function() {
         time++;
         aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
         aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
      }, 1000);
   }
   &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;div id=&quot;horloge&quot;&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigS&quot; src=&quot;aigS.png&quot; alt=&quot;aiguille des secondes&quot; style=&quot;left: 283px;&quot; /&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigM&quot; src=&quot;aigM.png&quot; alt=&quot;aiguille des minutes&quot; style=&quot;left: 278px;&quot; /&gt;
      &lt;img class=&quot;aig&quot; id=&quot;aigH&quot; src=&quot;aigH.png&quot; alt=&quot;aiguille des heures&quot; style=&quot;left: 278px;&quot; /&gt;
   &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-384246" data-claire-element-id="384246">Vous pouvez voir le résultat <a href="http://berdes.alwaysdata.net/SdZ/horloge1.html">ici</a>. Attention, le cadran de fond est assez long à charger la première fois.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript">Créer une horloge animée avec CSS3 et Javascript</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
Le fonctionnement de l&#039;horloge
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
On code
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/pour-aller-plus-loin-28">
Pour aller plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
<span class="arrow"></span>
<span class="next">Le fonctionnement de l&#039;horloge</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/pour-aller-plus-loin-28">
<span class="next">Pour aller plus loin</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Pourallerplusloin"></a><h2>Pour aller plus loin</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
<span class="arrow"></span>
<span class="next">On code</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-compatibilite-1" data-claire-element-id="384258">Compatibilité</h2><p id="r-384249" data-claire-element-id="384249">On a réussi à créer notre horloge, mais elle n'est compatible qu'avec certains navigateurs et de ce fait s'affiche mal dans les autres.<br/> On va commencer par régler ce problème. Tout d'abord, il ne faut pas afficher les aiguilles et le cadran, on va donc les supprimer de l'HTML et de la CSS :</p><pre id="r-384250" data-claire-element-id="384250"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
&lt;head&gt;
   &lt;title&gt;Horloge&lt;/title&gt;
   &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
   &lt;style type=&quot;text/css&quot;&gt;
      .aig
      {
         position: absolute;
         bottom: 283px;
         -moz-transform-origin: bottom center;
         -webkit-transform-origin: bottom center;
         -o-transform-origin: bottom center;
         -ms-transform-origin: bottom center;
         transform-origin: bottom center;
      }
      #horloge
      {
         position: relative;
         height: 567px;
         width: 567px;
         border: 1px solid black;
         -moz-border-radius: 284px;
         -webkit-border-radius: 284px;
         -o-border-radius: 284px;
         -ms-border-radius: 284px;
         border-radius: 284px;
      }
   &lt;/style&gt;
   &lt;script type=&quot;text/javascript&quot;&gt;
   window.onload=function()
   {
      var d    = new Date();
      var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();

      var aigS = document.getElementById('aigS');
      var aigM = document.getElementById('aigM');
      var aigH = document.getElementById('aigH');

      aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
      aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
      aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
      aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
      aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';

      setInterval(function() {
         time++;
         aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
         aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
      }, 1000);
   }
   &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;div id=&quot;horloge&quot;&gt;
   &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-384251" data-claire-element-id="384251">On va les afficher en Javascript via DOM :</p><pre id="r-384252" data-claire-element-id="384252"><code data-claire-semantic="javascript">var aigS = document.createElement('img');
   aigS.setAttribute('src'  , 'aigS.png');
   aigS.setAttribute('class', 'aig');
   aigS.setAttribute('alt'  , 'aiguille des secondes');
   aigS.setAttribute('style', 'left: 283px;');

var aigM = document.createElement('img');
   aigM.setAttribute('src'  , 'aigM.png');
   aigM.setAttribute('class', 'aig');
   aigM.setAttribute('alt'  , 'aiguille des minutes');
   aigM.setAttribute('style', 'left: 278px;');

var aigH = document.createElement('img');
   aigH.setAttribute('src'  , 'aigH.png');
   aigH.setAttribute('class', 'aig');
   aigH.setAttribute('alt'  , 'aiguille des heures');
   aigH.setAttribute('style', 'left: 278px;');

var horloge = document.getElementById('horloge');
   horloge.appendChild(aigS);
   horloge.appendChild(aigM);
   horloge.appendChild(aigH);
   horloge.setAttribute('style', 'background: url(\'cadran.png\');');</code></pre><p id="r-384253" data-claire-element-id="384253">Et maintenant, on va n'exécuter le Javascript que si le navigateur est compatible :</p><pre id="r-384254" data-claire-element-id="384254"><code data-claire-semantic="javascript">window.onload = function()
   {
      if(document.getElementsByTagName('body')[0].style.MozTransform == ''
         || document.getElementsByTagName('body')[0].style.WebkitTransform == ''
         || document.getElementsByTagName('body')[0].style.OTransform == ''
         || document.getElementsByTagName('body')[0].style.OTransform
         || document.getElementsByTagName('body')[0].style.msTransform == ''
         || document.getElementsByTagName('body')[0].style.transform == '')
      {
         var aigS = document.createElement('img');
            aigS.setAttribute('src'  , 'aigS.png');
            aigS.setAttribute('class', 'aig');
            aigS.setAttribute('alt'  , 'aiguille des secondes');
            aigS.setAttribute('style', 'left: 283px;');

         var aigM = document.createElement('img');
            aigM.setAttribute('src'  , 'aigM.png');
            aigM.setAttribute('class', 'aig');
            aigM.setAttribute('alt'  , 'aiguille des minutes');
            aigM.setAttribute('style', 'left: 278px;');

         var aigH = document.createElement('img');
            aigH.setAttribute('src'  , 'aigH.png');
            aigH.setAttribute('class', 'aig');
            aigH.setAttribute('alt'  , 'aiguille des heures');
            aigH.setAttribute('style', 'left: 278px;');

         var horloge = document.getElementById('horloge');
            horloge.appendChild(aigS);
            horloge.appendChild(aigM);
            horloge.appendChild(aigH);
            horloge.setAttribute('style', 'background: url(\'cadran.png\');');

         var d    = new Date();
         var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();

         aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
         aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
         aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
         aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
         aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';

         setInterval(function() {
            time++;
            aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
            aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
         }, 1000);
      }
   };</code></pre><p id="r-384255" data-claire-element-id="384255">Vous remarquerez dans la condition que pour de sombres raisons, suivant la version Opera ne va pas donner une chaîne de caractère, mais un objet CSSTransformValue, comportement qui n'est valable que pour cette propriété.</p><p id="r-384256" data-claire-element-id="384256">Avec l'HTML, la CSS et le Javascript, on obtient au final :</p><pre id="r-384257" data-claire-element-id="384257"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;fr&quot; &gt;
&lt;head&gt;
   &lt;title&gt;Horloge&lt;/title&gt;
   &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
   &lt;style type=&quot;text/css&quot;&gt;
      .aig
      {
         position: absolute;
         bottom: 283px;
         -moz-transform-origin: bottom center;
         -webkit-transform-origin: bottom center;
         -o-transform-origin: bottom center;
         -ms-transform-origin: bottom center;
         transform-origin: bottom center;
      }
      #horloge
      {
         position: relative;
         height: 567px;
         width: 567px;
         border: 1px solid black;
         -moz-border-radius: 284px;
         -webkit-border-radius: 284px;
         -o-border-radius: 284px;
         -ms-border-radius: 284px;
         border-radius: 284px;
      }
   &lt;/style&gt;
   &lt;script type=&quot;text/javascript&quot;&gt;
   window.onload = function()
      {
         if(document.getElementsByTagName('body')[0].style.MozTransform == ''
            || document.getElementsByTagName('body')[0].style.WebkitTransform == ''
            || document.getElementsByTagName('body')[0].style.OTransform == ''
            || document.getElementsByTagName('body')[0].style.OTransform
            || document.getElementsByTagName('body')[0].style.msTransform == ''
            || document.getElementsByTagName('body')[0].style.transform == '')
         {
            var aigS = document.createElement('img');
               aigS.setAttribute('src'  , 'aigS.png');
               aigS.setAttribute('class', 'aig');
               aigS.setAttribute('alt'  , 'aiguille des secondes');
               aigS.setAttribute('style', 'left: 283px;');

            var aigM = document.createElement('img');
               aigM.setAttribute('src'  , 'aigM.png');
               aigM.setAttribute('class', 'aig');
               aigM.setAttribute('alt'  , 'aiguille des minutes');
               aigM.setAttribute('style', 'left: 278px;');

            var aigH = document.createElement('img');
               aigH.setAttribute('src'  , 'aigH.png');
               aigH.setAttribute('class', 'aig');
               aigH.setAttribute('alt'  , 'aiguille des heures');
               aigH.setAttribute('style', 'left: 278px;');

            var horloge = document.getElementById('horloge');
               horloge.appendChild(aigS);
               horloge.appendChild(aigM);
               horloge.appendChild(aigH);
               horloge.setAttribute('style', 'background: url(\'cadran.png\');');

            var d    = new Date();
            var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();

            aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
            aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';

            setInterval(function() {
               time++;
               aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
               aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
               aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
               aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
               aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
               aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
               aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
               aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
               aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
               aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
               aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
               aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
               aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
               aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
               aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
            }, 1000);
         }
      };
   &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;div id=&quot;horloge&quot;&gt;
   &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h2 id="r-alleger-son-code" data-claire-element-id="384269">Alléger son code</h2><p id="r-384259" data-claire-element-id="384259">Bon, je sais pas si c'est pareil pour vous, mais moi j'en ai vraiment marre de recopier à chaque code que je vous montre deux fois <strong>exactement</strong> le même groupe d'instructions dans le script. On va donc créer une fonction qui exécutera ces instructions :</p><pre id="r-384260" data-claire-element-id="384260"><code data-claire-semantic="javascript">window.onload = function()
   {
      
      if(document.getElementsByTagName('body')[0].style.MozTransform == ''
         || document.getElementsByTagName('body')[0].style.WebkitTransform == ''
         || document.getElementsByTagName('body')[0].style.OTransform == ''
         || document.getElementsByTagName('body')[0].style.OTransform
         || document.getElementsByTagName('body')[0].style.msTransform == ''
         || document.getElementsByTagName('body')[0].style.transform == '')
      {
         function aig()
         {
            aigS.style.MozTransform    = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.WebkitTransform = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.OTransform      = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.msTransform     = 'rotate(' + (time * 6) + 'deg)';
            aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
            aigM.style.MozTransform    = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.WebkitTransform = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.OTransform      = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.msTransform     = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
            aigH.style.MozTransform    = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.WebkitTransform = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.OTransform      = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.msTransform     = 'rotate(' + Math.round(time / 120) + 'deg)';
            aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
         }

         var aigS = document.createElement('img');
            aigS.setAttribute('src'  , 'aigS.png');
            aigS.setAttribute('class', 'aig');
            aigS.setAttribute('alt'  , 'aiguille des secondes');
            aigS.setAttribute('style', 'left: 283px;');

         var aigM = document.createElement('img');
            aigM.setAttribute('src'  , 'aigM.png');
            aigM.setAttribute('class', 'aig');
            aigM.setAttribute('alt'  , 'aiguille des minutes');
            aigM.setAttribute('style', 'left: 278px;');

         var aigH = document.createElement('img');
            aigH.setAttribute('src'  , 'aigH.png');
            aigH.setAttribute('class', 'aig');
            aigH.setAttribute('alt'  , 'aiguille des heures');
            aigH.setAttribute('style', 'left: 278px;');

         var horloge = document.getElementById('horloge');
            horloge.appendChild(aigS);
            horloge.appendChild(aigM);
            horloge.appendChild(aigH);
            horloge.setAttribute('style', 'background: url(\'cadran.png\');');

         var d    = new Date();
         var time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();
         aig();
         setInterval(function() {
            time++;
            aig();
         }, 1000);
      }
   };</code></pre><p id="r-384261" data-claire-element-id="384261">Et tant qu'on y est, on va éviter au navigateur de recalculer 4 fois les mêmes choses :</p><pre id="r-384262" data-claire-element-id="384262"><code data-claire-semantic="javascript">function aig()
{
   aigS.style.MozTransform    =
   aigS.style.WebkitTransform =
   aigS.style.OTransform      =
   aigS.style.msTransform     =
   aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';
   aigM.style.MozTransform    =
   aigM.style.WebkitTransform =
   aigM.style.OTransform      =
   aigM.style.msTransform     =
   aigM.style.transform       = 'rotate(' + Math.round(time / 10) + 'deg)';
   aigH.style.MozTransform    =
   aigH.style.WebkitTransform =
   aigH.style.OTransform      =
   aigH.style.msTransform     =
   aigH.style.transform       = 'rotate(' + Math.round(time / 120) + 'deg)';
}</code></pre><p id="r-384263" data-claire-element-id="384263">Je vous laisse réfléchir à ce que ça fait exactement. Si vous ne trouvez pas, vous avez la réponse en dessous :</p><div id="r-384268" data-claire-element-id="384268"><p id="r-384264" data-claire-element-id="384264">Ceci est une seule instruction (regardez bien le point virgule) :</p><pre id="r-384265" data-claire-element-id="384265"><code data-claire-semantic="javascript">aigS.style.MozTransform    =
aigS.style.WebkitTransform =
aigS.style.OTransform      =
aigS.style.msTransform     =
aigS.style.transform       = 'rotate(' + (time * 6) + 'deg)';</code></pre><p id="r-384266" data-claire-element-id="384266">Quand il va analyser ça, le navigateur va d'abord voire que c'est une assignation et va calculer ce qui ce trouve à droite du signe « = » et va se retrouver avec une autre assignation qu'il va traiter de la même façon. Avec des parenthèses et de l'indentation, ça donne ça :</p><pre id="r-384267" data-claire-element-id="384267"><code data-claire-semantic="javascript">aigS.style.MozTransform =
(
   aigS.style.WebkitTransform =
   (
      aigS.style.OTransform =
         (
            aigS.style.msTransform =
               (aigS.style.transform = 'rotate(' + (time * 6) + 'deg)')
         )
   )
);</code></pre></div><h2 id="r-garder-la-pendule-a-l-heure" data-claire-element-id="384273">Garder la pendule à l'heure</h2><p id="r-384270" data-claire-element-id="384270">Encore un dernier petit truc : la fonction <em>setInterval</em> peut se décaler assez rapidement pour arriver à un décalage de une à deux minute(s) en une heure (au pire). On va donc régler ce problème en ajoutant cette ligne de code à la fin du script précédent :</p><pre id="r-384271" data-claire-element-id="384271"><code data-claire-semantic="javascript">setInterval(function() {
   d    = new Date();
   time = d.getSeconds() + 60 * d.getMinutes() + 3600 * d.getHours();
}, 60000);</code></pre><p id="r-384272" data-claire-element-id="384272">Vous avez la version finale <a href="http://berdes.alwaysdata.net/SdZ/horloge.html">ici</a>.</p><h2 id="r-a-vous-2" data-claire-element-id="384305">À vous !</h2><p id="r-384274" data-claire-element-id="384274">On a enfin réussi à terminer cette horloge, mais il reste encore des améliorations possibles. Voici une liste non exhaustive de ce que vous pouvez améliorer :</p><ul id="r-384287" data-claire-element-id="384287"><li id="r-384276" data-claire-element-id="384276"><p id="r-384275" data-claire-element-id="384275">Réduire la taille de l'horloge (notamment du cadran) ;</p></li><li id="r-384278" data-claire-element-id="384278"><p id="r-384277" data-claire-element-id="384277">permettre à l'utilisateur de déplacer l'horloge sur la page ;</p></li><li id="r-384280" data-claire-element-id="384280"><p id="r-384279" data-claire-element-id="384279">permettre à l'utilisateur de cacher l'horloge ;</p></li><li id="r-384282" data-claire-element-id="384282"><p id="r-384281" data-claire-element-id="384281">faire un cadran et des aiguilles plus jolis ;</p></li><li id="r-384284" data-claire-element-id="384284"><p id="r-384283" data-claire-element-id="384283">afficher l'heure en digital pour ceux qui ne peuvent pas avoir l'horloge ;</p></li><li id="r-384286" data-claire-element-id="384286"><p id="r-384285" data-claire-element-id="384285">…</p></li></ul><p id="r-384288" data-claire-element-id="384288">Maintenant, vous savez comment faire une jolie horloge pour votre site. Mais surtout, vous connaissez de nouvelles propriétés CSS (et peut-être de nouvelles choses en Javascript).<br/> Je vous invite à aller regarder les autres propriétés disponibles via <em>-webkit-*</em> et <em>-moz-*</em> (et aussi <em>-o-*</em> et <em>-ms-*</em>) grâce à ces liens (merci à Thunderseb) :</p><ul id="r-384297" data-claire-element-id="384297"><li id="r-384290" data-claire-element-id="384290"><p id="r-384289" data-claire-element-id="384289"><a href="https://developer.mozilla.org/en/CSS_Reference/Mozilla_Extensions">Extensions CSS de Mozilla</a> ;</p></li><li id="r-384292" data-claire-element-id="384292"><p id="r-384291" data-claire-element-id="384291"><a href="http://qooxdoo.org/documentation/general/webkit_css_styles">extensions CSS dans Webkit</a> ;</p></li><li id="r-384294" data-claire-element-id="384294"><p id="r-384293" data-claire-element-id="384293"><a href="http://www.blooberry.com/indexdot/css/properties/extensions/operaextensions.htm">extensions CSS dans Opera</a> ;</p></li><li id="r-384296" data-claire-element-id="384296"><p id="r-384295" data-claire-element-id="384295"><a href="http://blogs.msdn.com/ie/archive/2008/09/08/microsoft-css-vendor-extensions.aspx">extensions CSS d'Internet Explorer 8</a>.</p></li></ul><p id="r-384298" data-claire-element-id="384298">Voici une autre horloge également réalisée pour des sites web, mais avec une autre technique :</p><ul id="r-384301" data-claire-element-id="384301"><li id="r-384300" data-claire-element-id="384300"><p id="r-384299" data-claire-element-id="384299"><a href="http://xulfr.org/demos/clock.xhtml">Avec SVG et XBL (nécessite Firefox ou un navigateur basé sur WebKit comme Safari et Google Chrome)</a>.</p></li></ul><p id="r-384302" data-claire-element-id="384302">Et voici un site (en anglais) parlant du <a href="http://www.css3.info/">CSS3</a> si vous voulez aller plus loin.</p><p id="r-384303" data-claire-element-id="384303">Si vous constatez une erreur ou une inexactitude dans ce tutoriel, ou bien que vous avez des remarques à faire, n'hésitez pas à poster un commentaire.</p><p id="r-384304" data-claire-element-id="384304">Afin de faire fonctionner cette horloge avec les navigateurs qui n'ont pas implémenté les propriétés CSS3, il existe un plugin jQuery qui pourrait résoudre vos problèmes : <a href="http://transformie.com/documentation.html">Transformie</a> (en anglais).<br/> Pour les allergiques à jQuery, j'ai aussi trouvé <a href="http://www.useragentman.com/blog/csssandpaper-a-css3-javascript-library/">cssSandpaper (en)</a> qui vous permettra d'utiliser transform et d'autres propriétés CSS3 avec Internet Explorer et d'autres navigateurs non compatibles.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript">Créer une horloge animée avec CSS3 et Javascript</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/introduction-55">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/le-fonctionnement-de-l-horloge">
Le fonctionnement de l&#039;horloge
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
On code
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/pour-aller-plus-loin-28">
Pour aller plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-horloge-animee-avec-css3-et-javascript/on-code">
<span class="arrow"></span>
<span class="next">On code</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-une-horloge-animee-avec-css3-et-javascript.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:32:17 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-une-horloge-animee-avec-css3-et-javascript.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:32:05 GMT -->
</html>