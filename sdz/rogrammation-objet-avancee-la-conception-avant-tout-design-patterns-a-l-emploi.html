<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/rogrammation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 05:51:24 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/rogrammation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:03:43 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Programmationobjetavancelaconceptionavanttoutdesignpatternsl039emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a><br/><a href="#Introductioncecours">Introduction à ce cours</a><br/><a href="#Cyclesimplifid039unprojet">Cycle simplifié d&#039;un projet</a><br/><a href="#Laconceptionvotremeilleureamie">La conception, votre meilleure amie</a><br/><a href="#Commentbienconcevoir">Comment bien concevoir</a><br/><a href="#Adoptezlaphilosophiedel039objet">Adoptez la philosophie de l&#039;objet</a><br/><a href="#Offrezduservice">Offrez du service</a><br/><a href="#L039encapsulationrgneenmaitre">L&#039;encapsulation règne en maitre !</a><br/><a href="#Responsabilitlimite">Responsabilité limitée</a><br/><a href="#Privilegiezlacompositionl039hritage">Privilegiez la composition à l&#039;héritage</a><br/><a href="#Pensezinterface">Pensez interface</a><br/><a href="#Lasensibilitdel039objetsubirdesmodifications">La sensibilité de l&#039;objet à subir des modifications</a><br/><a href="#Pourallerplusloin">Pour aller plus loin</a><br/><a href="#LepatrondeconceptionObservateurObserver">Le patron de conception Observateur (Observer)</a><br/><a href="#Posonsleproblme">Posons le problème</a><br/><a href="#Rsolvonsprogressivementnotrecas">Résolvons progressivement notre cas</a><br/><a href="#L039observateur">L&#039;observateur</a><br/><a href="#LepatrondeconceptiontatState">Le patron de conception État (State)</a><br/><a href="#Letramway">Le tramway</a><br/><a href="#Lanonsnous">Lançons nous</a><br/><a href="#Lepatterntatnousvientenaide">Le pattern État nous vient en aide !</a><br/></div>
<a name="Programmationobjetavancelaconceptionavanttoutdesignpatternsl039emploi"></a><h2>Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</h2><div class="content" role="article">
<p id="r-431184" data-claire-element-id="431184">Bonjour à tous, <br/> Voici un tutoriel qui a pour objectif d'aider les personnes à mieux cerner ce qui se cache derrière la programmation orientée objet. Moi-même venant d'un langage impératif, il a été plutôt difficile de cerner les penchants et les aboutissants de cette philosophie. Après un temps d'adaptation on commence à comprendre les mécanismes et comment les objets doivent se lier entre eux. C'est alors en persévérant et en se renseignant sur diverses sources internet (une grande partie imputable à <a href="http://www.developpez.com/">developpez.com</a>) que l'on se rend compte qu'il faut adopter une certaine rigueur et des bons principes pour avoir un code robuste, suffisamment robuste pour qu'une adaptation ne bouleverse pas tout le code en cascade.</p><p id="r-431185" data-claire-element-id="431185">C'est en glanant principalement des codes créés par les gens de mon entourage et des divers post sur les forums que je me suis décidé à créer ce tutoriel : Apprendre aux gens ce qu'est le paradigme objet (son contexte) pour mieux concevoir vos futurs programmes. Après avoir montré <strong>quelques principes essentiels assez peu soulignés</strong> sur le net, je m’arrêterai sur certains design patterns (si vous ne connaissez pas, je vous invite à lire mon introduction) pour vous montrer ce que peuvent donner de bonnes conceptions.</p><p id="r-431186" data-claire-element-id="431186">Concernant le tutoriel en lui-même, voici les prérequis :</p><ul id="r-431193" data-claire-element-id="431193"><li id="r-431188" data-claire-element-id="431188"><p id="r-431187" data-claire-element-id="431187">Savoir programmer un minimum en orienté objet (hormis pour les 2 premiers chapitres).</p></li><li id="r-431190" data-claire-element-id="431190"><p id="r-431189" data-claire-element-id="431189">Connaitre la lecture de diagrammes de classes UML.</p></li><li id="r-431192" data-claire-element-id="431192"><p id="r-431191" data-claire-element-id="431191">Connaitre la syntaxe d'un langage se rapprochant du C++ / Java / C#</p></li></ul><aside id="r-431195" data-claire-element-id="431195" data-claire-semantic="warning"><p id="r-431194" data-claire-element-id="431194">Si les termes comme <em>instance</em>, <em>composition</em>, <em>héritage</em>, <em>polymorphisme</em> vous sont inconnus, vous n'êtes pas prêt à apprendre ce qui va suivre, renseignez-vous d'abord sur ces notions et soyez sûr de comprendre de quoi il en retourne.</p></aside><p id="r-431196" data-claire-element-id="431196">A ce propos, le tutoriel utilisera du code C++ et du code Java Ce sont 2 langages très populaires qui me permettent de toucher quasiment toutes les personnes du monde objet. Cependant, vous ne me verrez pas utiliser les spécificités pointues de chaque langage, le but étant <strong>d’écrire du code suffisamment générique pour le transposer dans un autre langage objet</strong> ! L'objectif principal est de privilégier <strong>la conception</strong>, aussi je vais essayer de produire un code reproductible aux 3 langages cités dans les besoins du tutoriel et je placerai ponctuellement des commentaires sur les fonctionnalités disponibles sur certains d'entre eux.</p><div id="r-431198" data-claire-element-id="431198"><p id="r-431197" data-claire-element-id="431197"><em>Avant toute chose, je tiens à remercier lmghs pour sa relecture attentive et ses différents conseils.</em></p></div><p id="r-431199" data-claire-element-id="431199">Si des personnes souhaitent m'aider à la rédaction du tutoriel, n'hésitez pas à me contacter. Toute aide est la bienvenue. :)</p><p id="r-431200" data-claire-element-id="431200">Vous êtes prêt ?</p>
</div>
<div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script>
</div><a name="Introductioncecours"></a><h2>Introduction à ce cours</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
<span class="next">Cycle simplifié d&#039;un projet</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-431201" data-claire-element-id="431201">En guise d'introduction sur ce cours, je vais tenter de vous sensibiliser sur les problèmes récurrents lorsqu'on aborde la partie programmation. Il est important de bien comprendre que programmer de manière objet est une tâche qui n'est pas simple, nombre de personnes qui se targuent de coder en objet n'appliquent pas correctement sa philosophie (on parle du paradigme objet). Comme ce cours se veut pour des zéros, je vais survoler des principes à la gestion de projets complexes qui peuvent s'appliquer à des projets de très petites envergures.</p><p id="r-431202" data-claire-element-id="431202">Pour aborder ce cours, j'estime qu'il est nécessaire d'avoir un minimum de pratique en programmation en s'étant déjà &quot;cassé les dents&quot; sur diverses difficultés. Vous pourrez cependant trouver la pensée à adopter pour concevoir en orienté objet. Ces notions peuvent se révéler très intéressantes surtout pour les nouveaux qui ont une vision issue des langages impératifs.</p>
</div><a name="Cyclesimplifid039unprojet"></a><h2>Cycle simplifié d&#039;un projet</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">
<span class="arrow"></span>
<span class="next">Introduction à ce cours</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
<span class="next">La conception, votre meilleure amie</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-cycle-simplifie-d-un-projet" data-claire-element-id="431256">Cycle simplifié d'un projet</h4><p id="r-431203" data-claire-element-id="431203">Lorsqu'on acquiert suffisamment d’expérience en programmation orienté objet, on constate que pour un problème donné, plusieurs solutions d'implémentations s'offrent à nous. Il est parfois difficile de trouver parmi ces solutions, laquelle offrira un maximum d'avantages sans apporter d’inconvénients. Malgré la simplicité apparente offerte par l'approche objet, certaines solutions qui semblent efficaces au départ se retrouvent désuètes si une évolution doit être apportée.</p><p id="r-431204" data-claire-element-id="431204">Ne vous est-il jamais arrivé de vous prendre la tête parce que votre code se révèle finalement peu flexible lorsque vous souhaitez rajouter une possibilité inédite à votre programme ? La relecture du code qui peut sembler évidente au premier abord, peut devenir difficile si des jours se sont écoulés entre temps. Partant de ce constat, il y a un postulat qu'il ne faut pas négliger :</p><aside id="r-431206" data-claire-element-id="431206" data-claire-semantic="warning"><p id="r-431205" data-claire-element-id="431205">La programmation orientée objet nécessite un minimum de conception pour voir sa réutilisabilité accrue. Je vais même jusqu'à dire que c'est même une étape indispensable pour un projet qui commence à prendre un minimum d'ampleur.</p></aside><p id="r-431207" data-claire-element-id="431207">J'insiste sur ce point car on aperçoit que la plupart des problèmes des codes développés en objet viennent de complications soulevées en amont que l'on a voulus reporter à l'étape de codage. Il ne faut pas se leurrer, nous pratiquons ce report tous à plus ou moins grande échelle afin d'arriver le plus rapidement à la programmation. Cependant, c'est une mauvaise manière de faire car établir un programme se base sur le cycle (simplifié) suivant :</p><figure id="r-431209" data-claire-element-id="431210"><img id="r-431208" data-claire-element-id="431208" src="medias/uploads.siteduzero.com_files_378001_379000_378178.png" alt="Cycle de projet simplifié"/></figure><p id="r-431211" data-claire-element-id="431211">Cycle de développement simplifié.</p><aside id="r-431213" data-claire-element-id="431213" data-claire-semantic="information"><p id="r-431212" data-claire-element-id="431212">Notez que cette gestion de projet s'inspire du cycle incrémental (mais simplifié). C'est la gestion la plus intuitive que l'on mène dans un projet. C'est à dire qu'on s'attaque à des parties spécifiques (un module, une fonctionnalité) que l'on va résoudre et développer avant de passer à un autre problème (la flèche qui repart du développement vers l'analyse). Réaliser le projet de la sorte permet de tester son programme au fur et à mesure de son avancement et de valider ou changer la partie concernée. Même si d'autres cycles de gestion existent (spirale, en V, méthodes agiles, ...), tous contiennent au moins les phases présentées dans ce tutoriel. Mon discours reste valable dans les grandes lignes pour ces modèles.</p></aside><p id="r-431214" data-claire-element-id="431214">Ce modèle emprunté au cycle de gestion d'un projet de grande envergure est intéressant sur plusieurs points mais comme il faudrait un cours complet pour expliquer ses principes, nous nous attarderons seulement sur les grandes phases. Ces phases se suivent dans un ordre bien précis qu'il est pratiquement impossible de faire autrement même lorsque vous écrivez le plus petit programme qu'il soit (sauf si vous êtes un prestataire avec un cahier des charges, ce qui doit être le cas de 0% des zéros ;) ) !</p><div id="r-431216" data-claire-element-id="431216" data-claire-semantic="question"><p id="r-431215" data-claire-element-id="431215">Attends une seconde, comment ça on respecte ce cycle ? Puis d'abord j'y comprends rien à ton schéma !</p></div><p id="r-431217" data-claire-element-id="431217">Pas trop vite ! Décrivons ces phases sommairement pour savoir à quoi elles correspondent réellement :</p><ul id="r-431226" data-claire-element-id="431226"><li id="r-431219" data-claire-element-id="431219"><p id="r-431218" data-claire-element-id="431218"><strong>Analyse</strong> : C'est la phase qui s'occupe de poser les problématiques générales au projet et d'y répondre. Ici, on n'aborde pas l'aspect programmation.</p></li><li id="r-431221" data-claire-element-id="431221"><p id="r-431220" data-claire-element-id="431220"><strong>Conception</strong> : Une phase tout aussi importante, elle précède la programmation réelle en s'attardant sur &quot;comment modéliser&quot; tel problème dans mon code.</p></li><li id="r-431223" data-claire-element-id="431223"><p id="r-431222" data-claire-element-id="431222"><strong>Développement</strong> : C'est le code produit en fonction des deux premiers points, c'est donc une étape qui doit être considérée avec autant de poids que les autres.</p></li><li id="r-431225" data-claire-element-id="431225"><p id="r-431224" data-claire-element-id="431224"><strong>Maintenance &amp; évolutions</strong> : Un point qui peut paraître secondaire mais il n'en est rien. C'est ce dernier qui le plus consommateur en temps. Les raisons en seront évoquées juste après.</p></li></ul><p id="r-431227" data-claire-element-id="431227">Si vous ne voyez pas le rapprochement avec le code que vous vous amusez à écrire, prenons un cas concret à la mode sur le site du zéro : le RPG et décortiquons. Comment va se structurer votre pensée si vous vous fixez comme objectif de coder un RPG simple en mode console ? Logiquement vous allez vous poser les questions suivantes :</p><ul id="r-431238" data-claire-element-id="431238"><li id="r-431229" data-claire-element-id="431229"><p id="r-431228" data-claire-element-id="431228">Que va devoir gérer mon RPG (personnages, armes, magies, ...) ? Quelles sont les limites que je m'impose ?</p></li><li id="r-431231" data-claire-element-id="431231"><p id="r-431230" data-claire-element-id="431230">Avec cette &quot;analyse&quot;, vous arrivez à entrevoir les classes correspondantes et leurs interactions avec d'autres classes.</p></li><li id="r-431233" data-claire-element-id="431233"><p id="r-431232" data-claire-element-id="431232">Vous lancez votre éditeur de code favori et vous commencez à développer en vous basant sur votre pensée précédente.</p></li><li id="r-431235" data-claire-element-id="431235"><p id="r-431234" data-claire-element-id="431234">Une fois que vous avez réussi à programmer une partie spécifique (exemple : le personnage avec toutes ses interactions), vous vous attardez sur un élément à appréhender.</p></li><li id="r-431237" data-claire-element-id="431237"><p id="r-431236" data-claire-element-id="431236">Vous jonglez constamment sur les 3 points précédents lorsque vous écrivez du nouveau code (ce qui s'apparente aux évolutions dans notre cas).</p></li></ul><p id="r-431239" data-claire-element-id="431239">Intrinsèquement vous respectez donc (presque) toujours ce cycle même si c'est de manière implicite. Vous vous demandez encore sûrement pourquoi je vous ai balancé ce schéma. Bien, venons-en aux faits : Que se passe-t-il lorsque vous programmez et que vous tombez sur un problème. Le problème du genre (en reprenant l'exemple d'un RPG) : <br/>&quot;J'ai un magicien qui hérite de personnage et un barbare qui hérite de personnage. Je propose dans mon jeu de pouvoir créer un personnage avec 2 catégories, il faut donc créer un magicien barbare qui hérite de magicien et de barbare. J'ai maintenant une classe voleur (une nouvelle fonctionnalité fraîchement rajoutée dans le jeu), je vais maintenant créer les couples magicien voleur et voleur barbare.&quot;<br/> Le problème se profile très clairement, que va t'il se passer si je décide d'ajouter un nouveau type de personnage comme par exemple assassin ? Il faudra créer les classes assassin voleur, magicien assassin, barbare assassin. C'est une solution peu flexible et qui augmente le nombre de classes très rapidement. Cette erreur va vite devenir un cauchemar, jusqu'à ce que vous décidiez de changer votre manière de faire en évitant de reproduire l'erreur. Vous refaites alors de la conception pour corriger cette lacune. Voyons quels sont les impacts ce mode de fonctionnement sur mon schéma :</p><figure id="r-431241" data-claire-element-id="431242"><img id="r-431240" data-claire-element-id="431240" src="medias/uploads.siteduzero.com_files_369001_370000_369312.png" alt="Rétroaction d'une erreur dans le projet"/></figure><p id="r-431243" data-claire-element-id="431243">Les flèches rouges représentent les répercussions que peuvent entraîner une erreur selon la phase. Par exemple, une erreur à l'étape du développement nécessite de revoir la conception. Revoir la conception peut impliquer de revoir aussi l'analyse.</p><p id="r-431244" data-claire-element-id="431244">Que pouvons-nous tirer de ce constat ? Plusieurs points intéressants qui sont :</p><ul id="r-431251" data-claire-element-id="431251"><li id="r-431246" data-claire-element-id="431246"><p id="r-431245" data-claire-element-id="431245">Plus la source du problème se dévoile dans les phases en amont, plus les répercussions seront grandes. En l’occurrence ici, le problème se situe soit au niveau de l'analyse avec le raisonnement qu'au début il n'était pas possible de pouvoir créer des personnages de multiples natures. Soit il peut s'agir d'un problème conceptuel car on souhaitait offrir cette possibilité dès le départ, mais par manque de technique et/ou réflexion nous nous retrouvons dans l'impasse.</p></li><li id="r-431248" data-claire-element-id="431248"><p id="r-431247" data-claire-element-id="431247">Certaines modifications inhérentes à une mauvaise conception peuvent se révéler douloureuses entraînant probablement d'autres correctifs non souhaités.</p></li><li id="r-431250" data-claire-element-id="431250"><p id="r-431249" data-claire-element-id="431249">Il y a une perte conséquente de temps à pallier ce genre d'imprévus.</p></li></ul><p id="r-431252" data-claire-element-id="431252">Si vous devez retenir une chose de tout ce qui a été dit cela se formulerait par :</p><aside id="r-431254" data-claire-element-id="431254" data-claire-semantic="warning"><p id="r-431253" data-claire-element-id="431253">Il est important de prendre du temps sur l'analyse et surtout (pour le cas des zéros qui programment par plaisir) <strong>de consacrer des ressources sur la conception</strong> !</p></aside><p id="r-431255" data-claire-element-id="431255">De très nombreux maux sur les forums de ce site sont dus à une mauvaise conception. Apprenez à bien concevoir et vous vous rendrez très vite compte des effets bénéfiques que vous pourrez en tirer. La bonne conception vient aussi en pratiquant, planchez vous sur des problèmes en essayant différents angles d'approches et mesurer les avantages/inconvénients sur chacune pour en tirer un maximum de bénéfice.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">
<span class="arrow"></span>
<span class="next">Introduction à ce cours</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
<span class="next">La conception, votre meilleure amie</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Laconceptionvotremeilleureamie"></a><h2>La conception, votre meilleure amie</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
<span class="arrow"></span>
<span class="next">Cycle simplifié d&#039;un projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
<span class="next">Comment bien concevoir</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-la-conception-votre-meilleure-amie" data-claire-element-id="431276">La conception, votre meilleure amie</h4><p id="r-431257" data-claire-element-id="431257">Prenez pour acquis que plus vous passerez du temps sur la conception plus le développement s'en retrouvera simplifié, efficace et donc amoindri d'erreurs. Cependant la tâche n'est pas si simple que je voudrais le faire croire car concevoir est une tâche plutôt ardue qui nécessite de la réflexion et surtout, du recul. Ce recul correspond à adopter un maximum d'abstractions pour résoudre un obstacle. Plus la solution aura un taux d'abstraction élevé plus vous pourrez appliquer ce même concept pour un autre problème similaire.</p><p id="r-431258" data-claire-element-id="431258">Il est très difficile de répondre à une problématique donnée en s'imaginant la meilleure alternative dans sa tête. Le plus simple étant de prendre une feuille et de modéliser diverses solutions avec des diagrammes. J'utiliserai à partir de maintenant des diagrammes de classes pour argumenter mes propos.</p><p id="r-431259" data-claire-element-id="431259">De nombreux informaticiens très expérimentés se sont arrachés les cheveux sur certaines problématiques et ont offerts diverses alternatives. Par la suite, des chercheurs conscients que la conception étant une tâche ardue ont commencé à proposer des recettes suffisamment abstraites pour qu'on puisse les réutiliser dans des circonstances similaires. Ces aboutissements portent le nom de &quot;patrons de conceptions&quot; (design patterns en anglais).</p><aside id="r-431261" data-claire-element-id="431261" data-claire-semantic="information"><p id="r-431260" data-claire-element-id="431260">Très tôt dans la programmation orientée objet, des personnes se sont intéressées à la construction de ces design patterns. Les principaux qui seront traités dans ce cours sont issus du GoF (Gang of Four), une équipe de 4 personnes qui a établi une publication de 23 patrons de conceptions dans un livre de 1994 devenu une référence. Depuis, il existe d'autres patrons de conceptions, mais ils sont un peu moins connus (bien que certains soient très utiles).</p></aside><div id="r-431263" data-claire-element-id="431263" data-claire-semantic="question"><p id="r-431262" data-claire-element-id="431262">Mais attend ! S'il existe de telles recettes pour faciliter la conception, ça va maintenant devenir un jeu d'enfants de surmonter mes problèmes non ? A moi la gloire, le futur jeu de la mort, les femmes ! :D</p></div><p id="r-431264" data-claire-element-id="431264">Pas si vite ! Ces outils n'ont pas cette prétention (même si j'aurais préféré que ce soit le cas :p ) . <br/> Certes dans des cas précis, ils vous faciliteront la tâche car vous n'aurez qu'à utiliser le patron correspondant mais : Il faut d'abord comprendre ce patron de conception (Dites-vous qu'il y a une abstraction élevée dans un design pattern et que ce n'est pas si instinctif que ça pour l’implémenter à son cas). Aussi, il est important de savoir si pour le problème auquel on se heurte, il existe le design pattern correspondant (ici non plus ce n'est pas aussi simple que ça en a l'air de savoir si toutes les conditions sont réunies). Même en ayant connaissance de ces éléments, vous passerez la majorité de votre temps à concevoir de manière classique sans vous référer à ces recettes. N'attendez pas de ce &quot;catalogue&quot; le Saint Graal de la programmation !</p><div id="r-431266" data-claire-element-id="431266" data-claire-semantic="question"><p id="r-431265" data-claire-element-id="431265">Mais alors c'est nul ton truc, ça a l'air prise de tête pour pas grand-chose finalement je me trompe ?</p></div><p id="r-431267" data-claire-element-id="431267">Avant que celui du fond ne sorte la cagette de tomates, prenez le temps de lire ce qui suit. Je ne vous le cache pas, c'est un investissement que de passer à apprendre ces patrons de conception, on peut cependant en tirer plusieurs bénéfices notables. Si vous trouvez une partie de votre code qui exige un design pattern voilà les gains apportés :</p><ul id="r-431272" data-claire-element-id="431272"><li id="r-431269" data-claire-element-id="431269"><p id="r-431268" data-claire-element-id="431268">Une documentation facilement accessible sur le design pattern utilisé. Si vous même ou quelqu'un d'autre ayant connaissance de ce qu'est un design pattern, il n'y aura pas besoin de commenter de manière complexe le code. Au pire, si la personne qui tombe sur votre code ne connaît pas les patrons de conception, il n'aura que l'apprentissage de celui concerné. C'est un gain de temps notable de tous les côtés et ça évite les prises de têtes (pour vous y compris).</p></li><li id="r-431271" data-claire-element-id="431271"><p id="r-431270" data-claire-element-id="431270">Votre code (si vous avez correctement implémenté le patron) est ouvert aux apports et sans contrepartie pour la solution que vous avez employée au problème posé. Vous pourrez donc très facilement faire évoluer le code sans risquer de devoir tout modifier.</p></li></ul><p id="r-431273" data-claire-element-id="431273">En conclusion de cette partie, si vous devez retenir une chose c'est que les patrons de conceptions ne sont pas indispensables pour bien concevoir, mais pour une problématique donnée, ils y répondent d'une manière élégante (à leur époque).</p><aside id="r-431275" data-claire-element-id="431275" data-claire-semantic="information"><p id="r-431274" data-claire-element-id="431274">Évidemment, ce ne sont pas les seules recherches qui ont fait progresser l'orienté objet, de très grands auteurs comme James O. Coplien ont offert d'autres approches pour concevoir efficacement. Vous verrez un tour d'horizon des principales idées dans le prochain chapitre des influences portées par ces experts.</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
<span class="arrow"></span>
<span class="next">Cycle simplifié d&#039;un projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
<span class="next">Comment bien concevoir</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Commentbienconcevoir"></a><h2>Comment bien concevoir</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
<span class="arrow"></span>
<span class="next">La conception, votre meilleure amie</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">
<span class="next">Adoptez la philosophie de l&#039;objet</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-comment-bien-concevoir" data-claire-element-id="431289">Comment bien concevoir</h4><p id="r-431277" data-claire-element-id="431277">Plusieurs ingrédients essentiels doivent être connus en amont pour réussir une bonne conception. Tout d'abord, l'analyse : elle est une partie quasiment obligatoire afin de savoir quelles sont les fonctionnalités de la future application (jeux, outils, applications bureautiques...). Cette distinction qui ne vous semble pas nécessaire prend un intérêt énorme pour &quot;segmenter&quot; son application en modules indépendants (en termes de code, pas forcément en termes de données). Favoriser des découpages en modules est la première clef d'une conception souple. On réduit les problèmes de manière plus locale, plus ciblés. Parvenir à séparer son application en module n'est pas une chose facile et les diagrammes des cas d'utilisations peuvent constituer une excellente première approche :</p><figure id="r-431279" data-claire-element-id="431280"><img id="r-431278" data-claire-element-id="431278" src="medias/uploads.siteduzero.com_files_369001_370000_369498.png" alt="Cas d'utilisations"/></figure><p id="r-431281" data-claire-element-id="431281">Diagramme de cas d'utilisations d'une pizzeria. Ne vous attardez pas dessus vous ne connaissez pas le contexte. <br/> Rappelons juste que ce diagramme permet de représenter les fonctionnalités auxquelles l'application doit répondre.</p><p id="r-431282" data-claire-element-id="431282">Notez que grâce à ce schéma on peut déjà connaître beaucoup de choses sur l'application. Il est possible d'entrevoir un découpage, des traitements et les différentes interfaces hommes machines que l'on devra créer selon le profil utilisateur. Je ne vais pas expliquer comment modéliser ce diagramme mais il ne faut pas oublier qu'il est toujours accompagné d'un descriptif. Nous sommes plus doués pour se représenter les choses par des dessins que par du simple texte, ne sous-estimez donc pas l'importance de passer par cette modélisation visuelle préalable.</p><p id="r-431283" data-claire-element-id="431283">D'autres diagrammes tels que le diagramme de séquence, le diagramme d'activité ou encore le diagramme d'états-transitions offrent par la même occasion une aide considérable pour réaliser une conception qui reflète au mieux ce que vous avez cerné. Le plus intéressant lorsqu'on modélise, c'est que sur certains points, on commence à buter et ce sont généralement ces parties-là qui vont vous causer du tort plus tard. Sauf qu'ici, l'impact de ces soucis a des conséquences moindres que si on s'était déjà lancé dans le développement. Si vous démarrez de nouveaux projets qui commence à avoir de l'ampleur, il est <strong>vivement conseillé</strong> de faire une modélisation préalable et <strong>encore plus si vous travaillez en équipe</strong>.</p><aside id="r-431285" data-claire-element-id="431285" data-claire-semantic="warning"><p id="r-431284" data-claire-element-id="431284">Toutes ces étapes qui précèdent le développement peuvent vous sembler superflues mais c'est tout le contraire. A défaut de perdre du temps à l'élaboration de l'analyse, vous gagnerez un temps considérable par la suite car la majorité des problèmes auront été anticipés. Toute forme quelconque de texte ou de schéma sert aussi pour créer une documentation solide, dans une autre mesure ces éléments <br/> peuvent être des constituants d'un cahier des charges.</p></aside><p id="r-431286" data-claire-element-id="431286">Le second point pour concevoir efficacement est de connaître ce qui se cache derrière le nom de programmation orientée objet, sa raison d'être et comment elle devrait être utilisée. Ce que l'on nomme plus scientifiquement &quot;le paradigme objet&quot;. C'est ce sur quoi le prochain chapitre va porter.</p><p id="r-431287" data-claire-element-id="431287">J'espère que cette petite introduction vous aura mis l'eau à la bouche. Si vous êtes motivé pour apprendre ce qui suit ou simplement curieux, continuez la lecture, vous ne serez pas déçus. Cependant, avant de se lancer dans l’explication de certains patrons de conception, il me paraît indispensable de vous poser les bases de l'objet. Je n'ai malheureusement pas vu sur le site du zéro un cours s'y rapprochant, je vais donc faire un rapide aparté afin de mieux comprendre comment les patrons de conceptions ont été conçus.</p><p id="r-431288" data-claire-element-id="431288">Je pense que vous aborderez la vision de l'objet sous un autre angle à la fin du chapitre suivant si certains des principes évoqués vous étaient méconnus. Si vous êtes toujours là, allons-y !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
<span class="arrow"></span>
<span class="next">La conception, votre meilleure amie</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">
<span class="next">Adoptez la philosophie de l&#039;objet</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Adoptezlaphilosophiedel039objet"></a><h2>Adoptez la philosophie de l&#039;objet</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
<span class="arrow"></span>
<span class="next">Comment bien concevoir</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
<span class="next">Offrez du service</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-431291" data-claire-element-id="431291">Pour bien commencer à concevoir en objet, il faut d'abord s'imprégner des concepts liés à sa philosophie. C'est en prenant pour acquis ces points et en les appliquant que vous pourrez prétendre programmer et penser objet. Ce chapitre peut paraître superflu pour une majorité d'entre vous, il en reste cependant très instructif sur la suite. En effet, les patrons de conception respectent intimement ces principes.</p><aside id="r-431293" data-claire-element-id="431293" data-claire-semantic="warning"><p id="r-431292" data-claire-element-id="431292">Ne voyez pas dans la programmation orientée objet, un simple rajout de méthodes dans les structures (pour les personnes ayant l'habitude de faire du C). C'est une vision erronée du paradigme objet.</p></aside><p id="r-431294" data-claire-element-id="431294">Venons-en maintenant aux faits, si vous êtes toujours là et que les parties suivantes seront nouvelles pour vous, j'ose dire que vous ne verrez plus l'orienté objet de la même façon. C'est parti !</p><p id="r-431295" data-claire-element-id="431295"><em>Les codes que je vous présenterai sont donnés à titre d'exemple et pas forcement compilables. Ne soyez donc pas étonnés si vous trouvez que certaines portions sont manquantes, je m’intéresse uniquement à la partie utile du code. Cette remarque est d'autant plus vrai pour les différents exemples donnés en code Java afin d'éviter l'alourdissement du chapitre.</em></p>
</div><a name="Offrezduservice"></a><h2>Offrez du service</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">
<span class="arrow"></span>
<span class="next">Adoptez la philosophie de l&#039;objet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
<span class="next">L&#039;encapsulation règne en maitre !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-offrez-du-service" data-claire-element-id="431319">Offrez du service</h4><p id="r-431296" data-claire-element-id="431296">Le point que je considère comme l'un des plus importants en programmation orientée objet est probablement sur les opérations que proposeront vos classes. Lorsque vous concevez une nouvelle classe qui s'avère complexe dans ses traitements, la première chose que nombre d'entre vous faites est de créer des getters / setters sur vos variables afin de pouvoir y accéder en dehors de la classe. Ce n'est pas obligatoirement une mauvaise chose mais dans la plupart des cas c'est à proscrire.</p><p id="r-431297" data-claire-element-id="431297">Pour construire efficacement les méthodes d'accès publiques, il faut penser différemment; Adopter une approche en termes de services rendus.</p><div id="r-431299" data-claire-element-id="431299" data-claire-semantic="question"><p id="r-431298" data-claire-element-id="431298">Mais qu'appelles-tu un service ?</p></div><p id="r-431300" data-claire-element-id="431300">C'est simple, prenons un exemple. Je viens de créer ma classe, il faut simplement imaginer qu'est-ce que peut proposer ma classe aux autres ayant un intérêt. Ou avec du code :</p><pre id="r-431301" data-claire-element-id="431301"><code data-claire-semantic="cpp">MaClasse instance;
instance. // Les méthodes utiles aux utilisateurs de cet objet.</code></pre><pre id="r-431302" data-claire-element-id="431302"><code data-claire-semantic="java">MaClasse instance = new MaClasse();
instance. // Les méthodes utiles aux utilisateurs de cet objet.</code></pre><p id="r-431303" data-claire-element-id="431303">Ce qui peut se schématiser par :</p><figure id="r-431305" data-claire-element-id="431306"><img id="r-431304" data-claire-element-id="431304" src="medias/uploads.siteduzero.com_files_369001_370000_369320.png" alt="Image utilisateur"/></figure><p id="r-431307" data-claire-element-id="431307">Pour établir des services efficaces, il faut se positionner en tant qu'utilisateur extérieur de la classe et définir les méthodes qui lui seront utiles.</p><p id="r-431308" data-claire-element-id="431308">C'est donc de construire sa classe depuis l’extérieur sans réfléchir à ce qu'elle contient. En prenant un exemple extrême, ma classe peut contenir 100 variables privées utiles à son bon fonctionnement (pour des raisons de performance par exemple), si une seule méthode est utile pour les utilisateurs de cette classe, alors pas besoin d'offrir des méthodes d'accès inutiles.</p><p id="r-431309" data-claire-element-id="431309">Si vous n'arrivez pas à réaliser efficacement une construction de méthodes avec des services, vous pouvez simplement procéder de la manière suivante :</p><pre id="r-431310" data-claire-element-id="431310"><code data-claire-semantic="cpp">class NouvelleClasse
{
     // Avant n'importe quel code, on va construire toutes les méthodes qui nous semblent indispensables.
     // pour les utilisateurs extérieurs 
};</code></pre><p id="r-431311" data-claire-element-id="431311">Ce n'est pas plus compliqué et vous améliorerez grandement la compréhension de votre code que si vous ne réfléchissiez pas en termes de service. Essayez juste de raisonner simplement pour offrir des services précis et concis.</p><p id="r-431312" data-claire-element-id="431312">Pour faire un rapprochement avec la réalité, vous pouvez prendre un four électrique :</p><figure id="r-431314" data-claire-element-id="431315"><img id="r-431313" data-claire-element-id="431313" src="medias/uploads.siteduzero.com_files_370001_371000_370581.png" alt="four electrique interface"/></figure><p id="r-431316" data-claire-element-id="431316">Prière de ne pas trop rire de mes talents artistiques. ^^ <br/> Seuls quatre boutons sont accessibles pour préparer le four : ce sont les services proposés à l'utilisateur. Pourtant le four doit gérer des choses en interne comme par exemple, s'allumer (si le minuteur est au dessus de 0), mesurer constamment la température pour respecter le thermostat indiqué, décrémenter le compte à rebours ou vérifier que l'utilisateur ne rentre pas un thermostat ou un nombre de minutes en dehors des bornes autorisées. Si cette représentation peut vous aider à réfléchir en terme de services, alors retenez ce moyen mnémotechnique, il représente bien le concept. On parle aussi de construction de sa classe par l’extérieur et non pas par l'intérieur.</p><p id="r-431317" data-claire-element-id="431317">Si vous voulez des exemples de services proposés avec une classe très connue, vous pouvez vous inspirer de <strong>string</strong>. En C++, comme en Java ou autre, l'utilisateur de la classe ne se soucie pas de sa gestion en interne (la classe string possède généralement de nombreuses optimisations cachées aux yeux de l’utilisateur). Vous n'avez accès qu'à des méthodes qui camouflent ces détails de bas niveau en augmentant ainsi l'abstraction pour la manipulation de chaînes. Pas la peine de se le cacher, il y a un coût potentiel de performance par rapport à de la gestion pure de chaine mais vous améliorez grandement en gain de temps et maintenance. Sauf si c'est une partie critique de votre code, favorisez une certaine abstraction, vous y gagnerez sur tous les plans.</p><p id="r-431318" data-claire-element-id="431318">Plus d'informations à ce sujet :<br/> - Ce principe qui va de paire avec l'encapsulation présentée juste après porte l'acronyme LoD ou s'appelle loi de Déméter.<br/> - Article succinct sur Wikipédia : <a href="http://fr.wikipedia.org/wiki/Loi_de_Déméter">loi de Déméter</a>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">
<span class="arrow"></span>
<span class="next">Adoptez la philosophie de l&#039;objet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
<span class="next">L&#039;encapsulation règne en maitre !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="L039encapsulationrgneenmaitre"></a><h2>L&#039;encapsulation règne en maitre !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
<span class="arrow"></span>
<span class="next">Offrez du service</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
<span class="next">Responsabilité limitée</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-l-encapsulation-regne-en-maitre" data-claire-element-id="431356">L'encapsulation règne en maitre !</h4><p id="r-431320" data-claire-element-id="431320">L'encapsulation c'est facile, il suffit de placer toutes ses variables en accès privé ou protégé et d'encapsuler ces variables par des accesseurs/mutateurs (getters/setter)! Si c'est le réflexe qui vous vient en premier lieu, vous êtes dans le faux, faisons le tour d'horizon de ce raisonnement.</p><p id="r-431321" data-claire-element-id="431321">Pour commencer, je vais évoquer la raison précédente : la classe doit être construite pour offrir des services : certaines variables n'ont donc pas d'utilité à être connues de l’extérieur, sauf si vous voulez obscurcir son usage et sa documentation. Ce qui peut être intéressant, c'est de donner un accès en lecture seulement sur certaines propriétés d'un objet à un instant &quot;t&quot;. On se retrouve dans ce cas à créer un getter afin d’empêcher toute corruption de l'état d'un objet. L'autre cas utile qui peut justifier de créer un couple de getter/setter sur une propriété est la mise en place de contrôles sur le setter. Ces remarques découlent du bon sens, on ne crée que ce qui est <strong>nécessaire</strong> aux utilisateurs de la classe.</p><aside id="r-431323" data-claire-element-id="431323" data-claire-semantic="warning"><p id="r-431322" data-claire-element-id="431322">Le cas des getters/setters vidés de contrôles :</p></aside><p id="r-431324" data-claire-element-id="431324">Soit le code :</p><pre id="r-431325" data-claire-element-id="431325"><code data-claire-semantic="cpp">class Personne 
{
  public :
    const std::string&amp; getNom() const { return m_nom }
    void setNom(const std::string &amp;nouveauNom) { m_nom = nouveauNom; }

  private :
    std::string m_nom;
};</code></pre><pre id="r-431326" data-claire-element-id="431326"><code data-claire-semantic="java">class Personne 
{
  public String getNom() { return nom; }
  public void setNom(String nouveauNom) { nom = nouveauNom; }

  private String nom;
}</code></pre><p id="r-431327" data-claire-element-id="431327">Le seul cas où il pourrait être judicieux d'écrire du tel code, c'est lorsque vous suspectez une possible évolution des contrôles qui pourront être appliqués sur le nom. Par exemple, que la méthode setNom vérifie que le nom passé en paramètre ne soit pas vide. Quand le doute est permis, n'hésitez pas à encapsuler la propriété, cela pourrait éviter une refactorisation importante du code. Cependant, ne vous leurrez pas, si vous faites un couple getter/setter comme au-dessus sans tenir compte de la règle (c'est le cas des conventions Java par exemple :o ), vous offrez un accès direct à votre variable membre, ce qui la rend indirectement publique.</p><p id="r-431328" data-claire-element-id="431328">Voyons ce que peut donner l'utilisation de ces bonnes pratiques :</p><pre id="r-431329" data-claire-element-id="431329"><code data-claire-semantic="cpp">// Le code suivant va utiliser le mot clef struct en référence à une structure en c++.
// Cela équivaut à une classe hormis que les attributs et méthodes sont publics par défaut.

/** Définition d'un point avec une position en X et Y en tant que structure.
  * Pourquoi s’embêter à placer des getters/setters inutiles qui n'apporteront jamais
  * de valeur ajoutée aux attributs publics.
  */
struct Point
{
   Point(int ptX, int ptY) { x = ptX; y = ptY; }
   int x, y;
};

/** Classe permettant de représenter une couleur selon les composantes Rouge, Vert, Bleu
  * et le canal alpha (la transparence)
  */
class Couleur
{
  public : // Tout ce qui suit est en accès publique

   Couleur (int rouge, int vert, int bleu, int alpha = 255) :
      m_r(corrigerIntervalleComposante(rouge)),
      m_v(corrigerIntervalleComposante(vert)),
      m_b(corrigerIntervalleComposante(bleu)),
      m_alpha(corrigerIntervalleComposante(alpha))
   {
   }


   // Comme il y a un contrôle sur les composantes, l'usage de getters/setters semble justifié
   int getRouge() const { return m_r; }
   int getVert() const { return m_v; }
   int getBleu() const { return m_b; }
   int getAlpha() const { return m_alpha; }

   void setRouge(int valeur) { m_r = (corrigerIntervalleComposante(valeur)); }
   void setVert(int valeur)  { m_v = (corrigerIntervalleComposante(valeur)); }
   void setBleu(int valeur)  { m_b = (corrigerIntervalleComposante(valeur)); }
   void setAlpha(int valeur) { m_alpha = (corrigerIntervalleComposante(valeur)); }


  private : // Tout ce qui suit est réservé à la classe ou ses dérivées
   int corrigerIntervalleComposante(int valeurComposante)
   {
      if(valeurComposante &gt; 255) // Une constante aurait été plus judicieuse mais inutile pour l'exemple
         return 255;
      else if(valeurComposante &lt; 0)
         return 0;
      return valeurComposante;
   }
   int m_r, m_v, m_b, m_alpha;
};

class Image
{
  public :
   static bool charger(string nomFichier);
   const Point&amp; getTailleImage() const; // Pour les gens du monde C++, le mot clef const très important

   // Par exemple, la méthode du dessous n'a pas lieu d'être
   void setTailleImage(const Point &amp;nouvelleTaille);

   // Un autre exemple d'accès à une valeur en lecture seule :
   const Couleur&amp; getPixelCouleur(const Point &amp;pixelConcerne) const;

   // ....

  private :
   Point m_tailleImage;
   Couleur **m_matricePixels; // Tableau en 2 dimensions à allouer dynamiquement
                              // On pourrait utiliser un std::vector de std::vector
                              //   ou la classe multi_array de la bibliothèque boost
   // D'autres attributs

};</code></pre><pre id="r-431330" data-claire-element-id="431330"><code data-claire-semantic="java">/** Définition d'un point avec une position en X et Y en tant que structure.
  * Pourquoi s’embêter à placer des getters/setters inutiles qui n'apporteront jamais
  * de valeur ajoutée aux attributs publics.
  */
class Point 
{
   public Point(int ptX, int ptY) { x = ptX; y = ptY; }
   public int x, y;
}

/** Classe permettant de représenter une couleur selon les composantes Rouge, Vert, Bleu 
  * et le canal alpha (la transparence)
  */
class Couleur 
{
   public Couleur (int rouge, int vert, int bleu, int alpha)
   {
      m_r = corrigerIntervalleComposante(rouge);
      m_v = corrigerIntervalleComposante(vert);
      m_b = corrigerIntervalleComposante(bleu);
      m_alpha = corrigerIntervalleComposante(alpha);
   }

   // Composante alpha fixée à 255
   public Couleur (int rouge, int vert, int bleu)
   {
      this(rouge, vert, bleu, 255);
   }


   // Comme il y a un contrôle sur les composantes, l'usage de getters/setters semble justifié
   public int getRouge() { return m_r; }
   public int getVert()  { return m_v; }
   public int getBleu()  { return m_b; }
   public int getAlpha() { return m_alpha; }

   public void setRouge(int valeur) { m_r = (corrigerIntervalleComposante(valeur)); }
   public void setVert(int valeur)  { m_v = (corrigerIntervalleComposante(valeur)); }
   public void setBleu(int valeur)  { m_b = (corrigerIntervalleComposante(valeur)); }
   public void setAlpha(int valeur) { m_alpha = (corrigerIntervalleComposante(valeur)); }


   private int corrigerIntervalleComposante(int valeurComposante) 
   {
      if(valeurComposante &gt; 255) // Une constante aurait été plus judicieuse mais inutile pour l'exemple
         return 255;
      else if(valeurComposante &lt; 0)
         return 0;
      return valeurComposante;
   }
   private int m_r, m_v, m_b, m_alpha;
}

class Image 
{
  public static boolean charger(string nomFichier);
  public Point getTailleImage(); 
   
   // Par exemple, la méthode du dessous n'a pas lieu d'être
   public void setTailleImage(Point nouvelleTaille);

   // Un autre exemple d'accès à une valeur en lecture seule :
   public Couleur getPixelCouleur(Point pixelConcerne);

   // ....

  private Point m_tailleImage;
  private Couleur[][] m_matricePixels; // Tableau en 2 dimensions
   // D'autres attributs
   
}</code></pre><p id="r-431331" data-claire-element-id="431331">Ce code est déjà un bon exemple des services rendus, si vos classes proposent les bons services, les classes peuvent voir leur implémentation interne complétement changée sans aucune incidence sur le code. Imaginons maintenant que l'application est un logiciel de retouche d'images, il est crucial d'optimiser la place mémoire, on peut améliorer les classes existantes sans impacter le service offert, voyez plutôt :</p><pre id="r-431332" data-claire-element-id="431332"><code data-claire-semantic="java">// Utilisation des opérateurs de bits. L'utilisateur de la classe n'en a que faire !
// Cependant, une couleur prend 4 fois moins d'espace mémoire qu'avant. il y a cependant un traitement à faire.
class Couleur
{
   public Couleur (int rouge, int vert, int bleu, int alpha)
   {
	  m_stockageBinaire = 0;
      m_stockageBinaire |= corrigerIntervalleComposante(rouge) &lt;&lt; 24;
      m_stockageBinaire |= corrigerIntervalleComposante(vert)&lt;&lt; 16;
      m_stockageBinaire |= corrigerIntervalleComposante(bleu)&lt;&lt; 8;
      m_stockageBinaire |= corrigerIntervalleComposante(alpha);
   }
   
   public Couleur (int rouge, int vert, int bleu)
   {
	   this(rouge, vert, bleu, 255);
   }


   // Comme il y a un contrôle sur les composantes, l'usage de getters/setters semble justifié
   public int getRouge() { return m_stockageBinaire &gt;&gt;&gt; 24; }
   public int getVert()  { return m_stockageBinaire &lt;&lt; 8 &gt;&gt;&gt; 24; }
   public int getBleu()  { return m_stockageBinaire &lt;&lt; 16 &gt;&gt;&gt; 24; }
   public int getAlpha() { return m_stockageBinaire &lt;&lt; 24 &gt;&gt;&gt; 24; }

   public void setRouge(int valeur) {  m_stockageBinaire -= getRouge()&lt;&lt;24; m_stockageBinaire += (corrigerIntervalleComposante(valeur)) &lt;&lt; 24; }
   public void setVert(int valeur)  {  m_stockageBinaire -= getVert()&lt;&lt;16; m_stockageBinaire += (corrigerIntervalleComposante(valeur)) &lt;&lt; 16; }
   public void setBleu(int valeur)  {  m_stockageBinaire -= getBleu()&lt;&lt;8; m_stockageBinaire += (corrigerIntervalleComposante(valeur)) &lt;&lt;8; }
   public void setAlpha(int valeur) {  m_stockageBinaire &amp;= ~getAlpha(); m_stockageBinaire += (corrigerIntervalleComposante(valeur)); }


  private int corrigerIntervalleComposante(int valeurComposante)
   {
      if(valeurComposante &gt; 255) // Une constante aurait été plus judicieuse mais inutile pour l'exemple
         return 255;
      else if(valeurComposante &lt; 0)
         return 0;
      return valeurComposante;
   };
   private int m_stockageBinaire;
}</code></pre><p id="r-431333" data-claire-element-id="431333">Pour la petite anecdote, la classe <strong>Couleur</strong> aurait pu être optimisée avec le code suivant (mais disponible que sur certains langages comme le C++ qui possède des types non signés).</p><pre id="r-431334" data-claire-element-id="431334"><code data-claire-semantic="cpp">// En s'assurant que le char soit codé en 8 bits (256 valeurs) :
struct Couleur 
{
   Couleur (unsigned char rouge, unsigned char vert, 
          unsigned char bleu, unsigned char canalAlpha = 255) 
   {
       r = rouge;
       v = vert;
       b = bleu;
       alpha  = canalAlpha;
   }

   unsigned char r, v, b, alpha;
};</code></pre><p id="r-431335" data-claire-element-id="431335">Je rappelle que ce tutoriel n'a pas la prétention d'optimiser chaque ligne de code, surtout que ces différences sont issues des particularités de langages généralement. ;) <br/> En conception pure, la première classe Couleur codée est valide, n'oubliez pas que le langage vient normalement se greffer après et c'est là que viennent les optimisations. Noter aussi qu'au lieu de pondre ces solutions, il existe un design pattern qui permet de réduire énormément la place que peuvent prendre des petits objets identique (c'est le cas avec les couleurs d'une image). Ce patron de conception s'appelle poids mouche ou flyweight et sera abordé plus tard.</p><aside id="r-431337" data-claire-element-id="431337" data-claire-semantic="information"><p id="r-431336" data-claire-element-id="431336">Il est utile de constater que les classes qui servent uniquement de <strong>structu</strong>res de données brutes se passent très généralement du couple getter/setter. En ce sens, le C++ offre le mot clef struct qui offre une meilleur sémantique que le Java par exemple.</p></aside><p id="r-431338" data-claire-element-id="431338">Ouf, pour résumer, voilà comment on pourrait formuler la chose (je vais ré-insister pour être sûr qu'il n'y ai pas de malentendu) :</p><ul id="r-431347" data-claire-element-id="431347"><li id="r-431340" data-claire-element-id="431340"><p id="r-431339" data-claire-element-id="431339">Lorsqu'on construit sa classe, on va proposer des services.</p></li><li id="r-431342" data-claire-element-id="431342"><p id="r-431341" data-claire-element-id="431341">Certains de ces services correspondent à l'accès en lecture des propriétés de la classe.</p></li><li id="r-431344" data-claire-element-id="431344"><p id="r-431343" data-claire-element-id="431343">On regarde ensuite s'il y a des propriétés qui doivent être en écriture dans les services proposés.</p></li><li id="r-431346" data-claire-element-id="431346"><p id="r-431345" data-claire-element-id="431345">Dans le cas de structures de données, la variable membre devrait être publique sinon on écrit l'accesseur et/ou mutateur correspondant.</p></li></ul><p id="r-431348" data-claire-element-id="431348">Si vous n'êtes pas convaincu que les accesseurs/mutateurs ne sont pas toujours une bonne solution, beaucoup de sujets traitent de ce problème sur internet. Une simple recherche avec l'expression &quot;why getters setters are evil&quot; vous donnera une foulée d'arguments qui se tiennent. Voilà un exemple qui pourra vous faire changer d'avis sur l'utilisation non réfléchie des setters :</p><pre id="r-431349" data-claire-element-id="431349"><code data-claire-semantic="cpp">class Compteur
{
  public :
    Compteur(unsigned int tickDepart = 0);
    unsigned int getTick() const ;
    void setTick(unsigned int nouvelleValeur);
    void reinitialiser();

  private :
   unsigned int m_cpt; 
};</code></pre><pre id="r-431350" data-claire-element-id="431350"><code data-claire-semantic="java">class Compteur
{
   public Compteur();
   public Compteur(int tickDepart);
   public int getTick();
   public  void setTick(int nouvelleCaleur);
   public  void reinitialiser();

  private int m_cpt; 
}</code></pre><p id="r-431351" data-claire-element-id="431351">Ce code présente deux inconvénients majeurs. Tout d'abord, il révèle en quelque sorte la structure interne de la classe Compteur car on peut y déceler les méthodes get/set correspondantes, rappelez-vous, l'utilisateur n'a pas à faire de suspicion sur les rouages internes de la classe. Le second problème plus grave est que le setter offre une trop grande liberté à l'utilisateur, un compteur ne doit pas offrir la possibilité de changer sa valeur lorsqu'il... compte ! Une implémentation largement plus claire qui corrigerait ces deux défauts pourrait être :</p><pre id="r-431352" data-claire-element-id="431352"><code data-claire-semantic="cpp">class Compteur
{
  public :
    // Rajout d'une variable pas pour plus de souplesse
    Compteur(unsigned int tickDepart = 0, unsigned int pas = 0);
    unsigned int tickActuel() const ;
    unsigned int incrementer(); // Incrémente du pas et retourne la nouvelle valeur
    void reinitialiser();

  private :
   unsigned int m_cpt, m_pas; 
};</code></pre><pre id="r-431353" data-claire-element-id="431353"><code data-claire-semantic="java">class Compteur
{
   public Compteur();
   public Compteur(int tickDepart);
   public Compteur(int tickDepart, int pas); // Ajout d'un pas pour plus de souplesse
   public int tickActuel();
   public int incremente(); // Incrémente du pas et retourne la nouvelle valeur du compteur
   public void reinitialiser();

  private int m_cpt, m_pas; 
}</code></pre><p id="r-431354" data-claire-element-id="431354">Même si c'est une classe triviale, il faut bien comprendre les enjeux pour des structures plus complexes. Le raisonnement n'est pas si difficile à avoir et le code gagne énormément en auto-documentation. Vous m'accuserez peut être de tricher en rajoutant un pas pour le compteur; C'est vrai, mais je voulais surtout prendre un exemple qui mettait l'accent sur deux codes semblables dont l'un n'est pas fondamentalement faux mais dont le second est beaucoup plus idiomatique (respect des bonnes pratiques).</p><p id="r-431355" data-claire-element-id="431355">Plus d'informations à ce sujet :<br/> - <a href="http://blog.emmanueldeloget.com/index.php?post/2006/09/14/12-la-guerre-des-accesseurs">Blog d'Emmanuel Deloget : La guerre des accesseurs</a>.<br/> - Article sur javaworld.com : <a href="http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html">[Anglais] Why getter and setter methods are evil de Allen Holub</a>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
<span class="arrow"></span>
<span class="next">Offrez du service</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
<span class="next">Responsabilité limitée</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Responsabilitlimite"></a><h2>Responsabilité limitée</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
<span class="arrow"></span>
<span class="next">L&#039;encapsulation règne en maitre !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
<span class="next">Privilegiez la composition à l&#039;héritage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-responsabilite-limitee" data-claire-element-id="431371">Responsabilité limitée</h4><p id="r-431357" data-claire-element-id="431357">Cette remarque ne concerne pas que la conception objet. Dans tout système, il est important de décomposer les rôles qu'auront vos classes. Il faut surtout éviter se retrouver avec une classe &quot;utilitaire&quot; qui s'occupe de beaucoup de ressources à la fois et dont son rôle est mal défini. Prenons pour exemple une classe ConvertHTML avec le code suivant :</p><pre id="r-431358" data-claire-element-id="431358"><code data-claire-semantic="cpp">class ConvertHTML
{
  public:
   ConvertHTML(const std::string &amp;source);

   void toPdfFile(const std::string &amp;nomFichierDest);
   void toRtfFile(const std::string &amp;nomFichierDest);
   void toTxtFile(const std::string &amp;nomFichierDest);
   void toWordFile(const std::string &amp;nomFichierDest);
   // ...
};</code></pre><pre id="r-431359" data-claire-element-id="431359"><code data-claire-semantic="java">class ConvertHTML
{
  public ConvertHTML(String source);

  public  void toPdfFile(String nomFichierDest);
  public  void toRtfFile(String nomFichierDest);
  public  void toTxtFile(String nomFichierDest);
  public  void toWordFile(String nomFichierDest);
   // ...
}</code></pre><p id="r-431360" data-claire-element-id="431360">Cet exemple montre vite que trop de choses sont gérées au sein de cette même classe, on va vite arriver à des complexités dans le code qui vont impliquées des modifications successives. C'est surtout le cas pour le format Pdf ou le format Word qui permettent des structures d'affichages aussi complexes que le Html. L'idéal est simplement de déporter du code afin d'avoir une architecture de code plus flexible. Il suffit donc d'éclater la classe en plusieurs plus petites qui se chargent de remplir un rôle mieux défini et de manière indépendante. Grâce à cette division en sous classes vous favorisez aussi la réutilisation de ces portions de codes qui sont moins dépendants d'un contexte précis. Dans l'exemple précédent, il faudrait que chaque méthode voit son traitement déporté dans des classes indépendantes comme <strong>PdfFromHTML</strong>.</p><aside id="r-431362" data-claire-element-id="431362" data-claire-semantic="warning"><p id="r-431361" data-claire-element-id="431361">Il faut faire preuve d'un peu de bon sens dans cet éclatement des rôles. Si vous voyez une utilité très faible à découpler alors ne le faites pas. Essayez juste de voir si votre classe peut fonctionner dans un autre contexte que le votre.</p></aside><p id="r-431363" data-claire-element-id="431363">Si vous avez tendance à vouloir attribuer beaucoup de responsabilité à une classe, essayez de découper le problème, vous sentirez très vite son importance. D'ailleurs, beaucoup de patrons de conceptions se servent de ce principe pour avoir des codes très modulables. Certes, le projet voit son nombre de classes augmenter mais sa maintenance en sera réduite.</p><p id="r-431364" data-claire-element-id="431364">Une chose importante que je n'ai pas spécialement mis en évidence : il faut éviter que vos classes soient trop dépendantes les unes par rapports aux autre. En rejoignant un peu le principe de responsabilité unique, plus vos classes peuvent se passer de liens étroits avec d'autres classes en relation, plus serez apte à produire du code interchangeable ou réutilisable dans d'autres contextes avec d'autres avantages. Essayez de favoriser un couplage faible est une clef de réussite. La cohésion pour un système est aussi un atout majeur pour savoir si votre découpage en classes est efficace.</p><div id="r-431366" data-claire-element-id="431366" data-claire-semantic="question"><p id="r-431365" data-claire-element-id="431365">Mais c'est quoi la cohésion dans la conception ?</p></div><p id="r-431367" data-claire-element-id="431367">Il suffit tout simplement de prendre le nom de la classe, par exemple &quot;ConvertHTML&quot; et de savoir quels sont les services proposés par celle-ci. Si le nom de la classe est suffisamment évocateur pour les opérations proposées, on suppose que la classe joue un rôle que l'on peut clairement définir. Plus la définition du rôle est précise, plus la cohésion sera forte.</p><p id="r-431368" data-claire-element-id="431368">Plus d'informations à ce sujet :<br/> - Le concept de base est appelé SRP.<br/> - L'autre concept présenté après porte le nom de couplage et cohésion (application avec les patrons GRASP en Java).<br/> - <a href="http://blog.emmanueldeloget.com/index.php?post/2006/09/07/16-le-principe-de-responsabilite-unique">Blog d'Emmanuel Deloget : le principe de responsabilité unique</a>.<br/> - <a href="http://msdn.microsoft.com/fr-fr/magazine/cc947917.aspx">Article MSDN : cohésion et couplage</a>.</p><aside id="r-431370" data-claire-element-id="431370" data-claire-semantic="information"><p id="r-431369" data-claire-element-id="431369">Je vous conseille vivement de lire les deux articles présentés. Il sont très enrichissants et accessible facilement au niveau de la difficulté.</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
<span class="arrow"></span>
<span class="next">L&#039;encapsulation règne en maitre !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
<span class="next">Privilegiez la composition à l&#039;héritage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Privilegiezlacompositionl039hritage"></a><h2>Privilegiez la composition à l&#039;héritage</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
<span class="arrow"></span>
<span class="next">Responsabilité limitée</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
<span class="next">Pensez interface</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-privilegiez-la-composition-a-l-heritage" data-claire-element-id="431384">Privilegiez la composition à l'héritage</h4><p id="r-431372" data-claire-element-id="431372">Derrière ce titre provocateur, je souligne plutôt une erreur causée par bon nombre de débutants : L'utilisation de l'héritage à tort et à travers. Je vous rassure tout de suite, l'héritage est utile dans certains cas mais je tenais à avoir votre attention.</p><p id="r-431373" data-claire-element-id="431373">Le vrai concept qui se cache derrière ce titre porte le nom de &quot;substituabilité&quot;.</p><p id="r-431374" data-claire-element-id="431374">Beaucoup pensent que pour réutiliser le code, il n'y a rien de mieux que l'héritage. Cette erreur arrive fréquemment et même les développeurs assez chevronnés ont réussi à tomber dans le piège. On peut par exemple citer Java et la fameuse classe Stack (la structure de données pile) avec laquelle les développeurs de l'API ont décidé de la faire hériter de Vector (un tableau dynamique à accès direct). Le gros problème est que la classe Vector offre un surplus de fonctionnalités qui est d'une part inutile pour la classe Stack, d'autre part dans cet exemple précis va carrément offrir des comportements contraires à ce que devrait proposer une pile. On peut en effet ajouter un élément n'importe où et pas seulement sur le haut du tas, sans compter d'autres opérations dénuées de sens. Bref, réfléchissez à deux fois avant de d'hériter naïvement.</p><p id="r-431375" data-claire-element-id="431375">La solution pour ce genre d'embarras est simplement d'utiliser la composition, voyez plutôt :</p><pre id="r-431376" data-claire-element-id="431376"><code data-claire-semantic="cpp">//Mauvaise version 
template &lt;typename T&gt;
class Pile : public std::vector&lt;T&gt;
{ /* TOUTES LES METHODES DE VECTOR SERONT PROPOSEES + CELLES DE LA PILE. */ };

// Solution acceptable avec l'héritage privé. Revient au même que la composition dans ce cas précis.
template &lt;typename T&gt;
class Pile : private std::vector&lt;T&gt;
{ };

// La solution à base de composition.
template &lt;typename T&gt;
class Pile
{ 
   private :
    std::vector&lt;T&gt; m_pile; // La composition consiste à avoir une variable du type souhaité au lieu d'en hériter.
};</code></pre><pre id="r-431377" data-claire-element-id="431377"><code data-claire-semantic="java">//Mauvaise version, il n'y a pas d'héritage privé en Java
class Pile extends ArrayList
{ /* TOUTES LES METHODES D'ACCES DIRECT SERONT PROPOSEES + CELLES DE LA PILE. */ }

// La solution à base de composition.
class Pile&lt;T&gt;
{ 
   private ArrayList&lt;T&gt; m_pile; // La composition consiste à avoir une variable du type souhaité au lieu d'en hériter.
}</code></pre><p id="r-431378" data-claire-element-id="431378">Il est tentant d'hériter pour éviter de réécrire du code mais une chose essentielle a été oubliée. L'héritage doit être effectué lorsque la classe fille &quot;est une&quot; classe mère avec des fonctionnalités en plus <strong>mais jamais moins</strong>. La classe Pile n'est pas une classe Vector spécialisée, elle adopte un comportement différent et un peu de bon sens suffit à s'en rendre compte. Pour vous aider, rares sont les cas où hériter publiquement (type héritage imposé dans java) d'une classe concrète est préférable à une composition.</p><p id="r-431379" data-claire-element-id="431379">Le postulat de Barbara Liskov :<br/> Cette personne ayant mené des recherches sur la programmation par contrat (je vous invite à vous renseigner si vous ne connaissez pas le sujet), une théorie en est ressortie pour concevoir une bonne relation d'héritage. Je vais vous éviter d'étaler sa théorie ici mais juste en faire une formulation simple, ce qui donne : <br/><em>&quot;Pour prétendre à l'héritage, une sous-classe doit être conçue de sorte que ses instances puissent se substituer à des instances de la classe de base partout où cette classe de base est utilisée.&quot;</em><br/> En gros, cette phrase met l'accent sur la substituabilité d'une classe fille lorsqu'on utilise l'interface de la classe mère. Même si ce n'est pas toujours facile d'obtenir une classe fille qui calque ses comportements exactement de la même manière que la classe mère, c'est une bonne pratique que d'essayer de s'en rapprocher un maximum. Pour formuler différemment, les méthodes qui utilisent des objets d'une classe doivent pouvoir utiliser des objets dérivés de cette classe sans même le savoir.</p><aside id="r-431381" data-claire-element-id="431381" data-claire-semantic="information"><p id="r-431380" data-claire-element-id="431380">Les interfaces sont d'excellents moyens pour répondre à cette bonne pratique.</p></aside><p id="r-431382" data-claire-element-id="431382">Cependant, ce n'est pas la seule chose qui est mise en avant par cette personne. Son domaine d'étude s'attardait sur la programmation par contrat en orienté objet et d'autres principes ont été évoqués lors d'un héritage. Le lien wikipédia donné pourra plus vous informer si le sujet vous intéresse.</p><p id="r-431383" data-claire-element-id="431383">Plus d'informations à ce sujet :<br/> - Acronyme LSP pour la théorie de Liskov.<br/> - Article sur developpez : <a href="http://gfx.developpez.com/tutoriel/java/composition/">Composition et héritage de Romain Guy</a>.<br/> - Article sur Wikipédia : <a href="http://fr.wikipedia.org/wiki/Principe_de_substitution_de_Liskov">Principe de substitution de Liskov</a>.<br/> - Inspiration du contenu : <a href="http://www.crossbowlabs.com/dossiers/principesoo/lsp">www.crossbowlabs.com</a> (site fermé).</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
<span class="arrow"></span>
<span class="next">Responsabilité limitée</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
<span class="next">Pensez interface</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Pensezinterface"></a><h2>Pensez interface</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
<span class="arrow"></span>
<span class="next">Privilegiez la composition à l&#039;héritage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
<span class="next">La sensibilité de l&#039;objet à subir des modifications</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-pensez-interface" data-claire-element-id="431402">Pensez interface</h4><p id="r-431385" data-claire-element-id="431385">Comme vous avez pu vous en rendre compte, les principes évoqués précédemment peuvent s'appliquer à d'autre paradigmes que celui de l'objet, on peut aussi bien placer ces arguments pour un langage impératif voir même fonctionnel. Une interface quant à elle représente une façade qui propose des opérations. Plus généralement, elle décrit des comportements que l'on peut utiliser. En programmation objet il est possible de représenter ce concept explicitement. Je vais faire un rappel mais si ce terme est nouveau pour vous c'est peut être que vous n'avez pas un niveau suffisant pour lire ce cours.</p><aside id="r-431387" data-claire-element-id="431387" data-claire-semantic="warning"><p id="r-431386" data-claire-element-id="431386">Les interfaces n'ont rien à voir avec ce que l'on appelle IHM. Ce n'est en rien une représentation visuelle de quoi que ce soit.</p></aside><p id="r-431388" data-claire-element-id="431388">Une interface se définit comme suit :</p><pre id="r-431389" data-claire-element-id="431389"><code data-claire-semantic="cpp">/** En C++ une interface n'est rien d'autre qu'une classe qui ne comporte que des méthodes
  * publiques et virtuelles pures. Il n'y a aucune implémentation de code (donc pas de variables membres)
  *
  * Cette interface va permettre de récupérer la valeur selon le nom d'un champ dans une source de
  * données.
  */
class IRequete
{
   public:
     // Retourne faux si le champ n'a pas été trouvé dans la source de données.
     // Si le champ est trouvé, sa valeur sera écrite dans le second paramètre.
     virtual bool requeter(const std::string &amp;nomChamp, std::string &amp;valeurChamp) const = 0;
     // Ces méthodes ne sont pas nécessairement constantes.
};</code></pre><pre id="r-431390" data-claire-element-id="431390"><code data-claire-semantic="java">/** Java comme d'autres langages plus récents possède un mot clef destiné à cet usage.
  * C'est un palliatif obligatoire à l'héritage multiple qui n'existe pas.
  *
  * Cette interface va permettre de récupérer la valeur selon le nom d'un champ dans une source de
  * données.
  */
interface IRequete
{
   // Retourne la valeur du champ et null si celui-ci n'a pas été trouvé dans la source de données.
   public String requeter(String nomChamp);
}</code></pre><p id="r-431391" data-claire-element-id="431391">Définir une interface n'est pas bien compliqué, c'est une base pour induire des comportements à des classes plus concrètes. Un code possible serait :</p><pre id="r-431392" data-claire-element-id="431392"><code data-claire-semantic="cpp">class BDDRelationnelle : public IRequete// Comme un héritage
{
   // On est maintenant obligé de redéfinir les méthodes issues de l'interface.
};

class XML : public IRequete// Comme un héritage
{
   // On est maintenant obligé de redéfinir les méthodes issues de l'interface.
};</code></pre><pre id="r-431393" data-claire-element-id="431393"><code data-claire-semantic="java">class BDDRelationnelle implements IRequete 
{
  // On est maintenant obligé de redéfinir les méthodes issues de l'interface.
}

class XML implements IRequete 
{
  // On est maintenant obligé de redéfinir les méthodes issues de l'interface.
}</code></pre><p id="r-431394" data-claire-element-id="431394">Certains pourront se poser la question de la différence avec une classe abstraite. La réponse est simple, une classe abstraite permet une factorisation de code des classes filles. L'interface va forcer à <strong>implémenter des comportements</strong> (on peut l'assimiler à un contrat). On pourra dès lors passer par une interface pour effectuer des requêtes alors qu'on manipule des objets concrets. Je vais mettre un exemple pour illustrer plus facilement :</p><pre id="r-431395" data-claire-element-id="431395"><code data-claire-semantic="cpp">// On va utiliser le polymorphisme pour utiliser l'interface à la place de la classe concrète.
std::string valeurRetour;
bool succesRequete;

// Pour faire du polymorphisme, le C++ oblige à utiliser les pointeurs.
// On pourrait utiliser des pointeurs intelligents mais ce n'est pas l'objet de ce cours.
IRequete *requeteur = new BDDRelationnelle(); 

succesRequete = requeteur-&gt;requeter(&quot;nomSARL&quot;, valeurRetour); // On requête sur la base de données relationnelle
if(succesRequete) 
   std::cout &lt;&lt; valeurRetour;
delete requeteur;

requeteur = new XML();
succesRequete = requeteur-&gt;requeter(&quot;nomSARL&quot;, valeurRetour); // On requête maintenant sur la source de données XML
if(succesRequete) 
   std::cout &lt;&lt; valeurRetour;
delete requeteur;</code></pre><pre id="r-431396" data-claire-element-id="431396"><code data-claire-semantic="java">// On va utiliser le polymorphisme pour utiliser l'interface à la place de la classe concrète.
String valeurRetour;

IRequete requeteur = new BDDRelationnelle();
valeurRetour = requeteur.requeter(&quot;nomSARL&quot;); // On requête sur la base de données relationnelle
if(valeurRetour != null) 
   System.out.println(valeurRetour);

requeteur = new XML();
valeurRetour = requeteur.requeter(&quot;nomSARL&quot;); // On requête sur la base de données relationnelle
if(valeurRetour != null) 
   System.out.println(valeurRetour);</code></pre><p id="r-431397" data-claire-element-id="431397">A travers cet exemple on voit qu'on élève le niveau d'abstraction du programme, il devient simple de rajouter une nouvelle source de données (le CSV pour la forme) sans impacter le reste du code. Si je sais qu'il adoptera le comportement de mon interface, alors je pourrais l'interroger de la même manière, peu importe que son implémentation soit proche ou très éloignée de celle du XML.</p><p id="r-431398" data-claire-element-id="431398">Les interfaces sont la base de nombreux design pattern car elles apportent énormément de flexibilité en se dispensant de faire la moindre supposition sur les objets qui l'implémenteront. On sait juste que ces derniers doivent se contenter de satisfaire ces actions. L'ouvrage du GoF se permet même de faire l'assertion suivante : <br/><em>&quot;Programmer pour une interface, non pour une implémentation&quot;</em><br/> Si vous programmez avec des bonnes interfaces votre code sera beaucoup plus robuste aux changements et vous pourrez utiliser certaines fonctionnalités communes efficacement. L'exemple le plus parlant est sans doute l'itérateur Java pour parcourir une collection. Pas besoin de connaitre la structure interne d'une collection parmi les nombreuses existantes pour naviguer sur les éléments qui la constitue, il suffit d'utiliser l'interface <a href="http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Iterator.html">Iterator</a>. Vous pouvez donc parcourir une liste chaînée, un tableau dynamique, une structure en arbre ou je ne sais quoi de la même manière. Avouez que c'est vraiment utile.</p><aside id="r-431400" data-claire-element-id="431400" data-claire-semantic="information"><p id="r-431399" data-claire-element-id="431399">L'itérateur est issu d'un design pattern du même nom &quot;iterator&quot; qui n'est pas si simple à mettre en place. Ce que vous pouvez constater si vous avez déjà utilisé ces objets (je l'espère pour vous), c'est qu'il est plutôt &quot;simple&quot; de s'en servir du point de vue utilisateur.</p></aside><p id="r-431401" data-claire-element-id="431401">Retenez donc que les interfaces sont le début de la programmation flexible en objet. Grâce à elles, vous pouvez appliquer le principe de substitution pour vous passer d’éléments concrets lors de la conception.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
<span class="arrow"></span>
<span class="next">Privilegiez la composition à l&#039;héritage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
<span class="next">La sensibilité de l&#039;objet à subir des modifications</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lasensibilitdel039objetsubirdesmodifications"></a><h2>La sensibilité de l&#039;objet à subir des modifications</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
<span class="arrow"></span>
<span class="next">Pensez interface</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
<span class="next">Pour aller plus loin</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-la-sensibilite-de-l-objet-a-subir-des-modifications" data-claire-element-id="431414">La sensibilité de l'objet à subir des modifications</h4><p id="r-431403" data-claire-element-id="431403">Cette partie ne concerne pas que le monde objet. La programmation en général supporte assez mal la modification de code existant; Que ce soit dû à la correction d'un problème ou l'ajout d'une nouvelle fonctionnalité nécessitant d'adapter l'ancien code.</p><p id="r-431404" data-claire-element-id="431404">Appliquer ces modifications est souvent source de nouveaux bugs entrainant des effets de bord que l'on n'avait pas prévus dans notre scénario initial. Vous savez, c'est le genre de petit bug qui survient très rarement (donc difficile à diagnostiquer) et dont la provenance est insoupçonnée. C'est un fait, nous ne sommes pas parfaits, patcher un code qui était fonctionnel peut avoir des incidences car de nouveaux cas non anticipés surviennent.</p><p id="r-431405" data-claire-element-id="431405">La solution à ce problème est de prévoir que de nouvelles fonctionnalités donneront lieu à des ajouts dans le code <strong>sans toucher à l'existant</strong>. Je ne vous le cache pas, c'est une tâche ardue que de rendre sa conception suffisamment solide pour que les nouveaux besoins viennent se greffer sur ce qui existe. Ce serait une sorte d'addon si vous voulez. Les patrons de conception misent énormément pour éviter une modification de code si une fonctionnalité venait à se produire. C'est peut être l'un de leur plus gros point fort, l'ajout d'un besoin rajoutera uniquement du code sans aucune forme d’altération. C'est d'ailleurs pourquoi ils sont si efficaces lorsqu'ils répondent à un problème : Le risque d'erreur d'implémentation est très faible.</p><p id="r-431406" data-claire-element-id="431406">En reprenant l'exemple précédant sur la classe ConvertHTML et son implémentation sans découpage des responsabilités voici ce qu'on obtient :</p><pre id="r-431407" data-claire-element-id="431407"><code data-claire-semantic="cpp">class ConvertHTML
{
  public:
   ConvertHTML(const std::string &amp;source);

   void toPdfFile(const std::string &amp;nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
   void toRtfFile(const std::string &amp;nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
   void toTxtFile(const std::string &amp;nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
   void toWordFile(const std::string &amp;nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
   // ...
};</code></pre><pre id="r-431408" data-claire-element-id="431408"><code data-claire-semantic="java">class ConvertHTML
{
  public ConvertHTML(String source);

  public  void toPdfFile(String nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
  public  void toRtfFile(String nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
  public  void toTxtFile(String nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
  public  void toWordFile(String nomFichierDest) { /* CODE D'IMPLEMENTATION */ }
   // ...
}</code></pre><p id="r-431409" data-claire-element-id="431409">Si on a un problème on va être obligé d'intervenir sur cette classe. Une nouvelle conversion va aussi imposer de mettre son implémentation dans ce code. Vous vous retrouvez donc avec une classe de milliers de lignes de code. Une structuration plus intelligente utiliserait une interface capable d'abstraire le comportement des formats de destination. Quel est le comportement que l'on cherche à généraliser lors de la conversion ? Tout simplement la transformation, on peut donc créer l'interface correspondante :</p><pre id="r-431410" data-claire-element-id="431410"><code data-claire-semantic="cpp">// En C++
class IConvertisseurHTML
{
  public : 
   virtual void fromHTMLToFile(const std::string &amp;html, const std::string &amp; fichierDestination) const = 0; // virtuelle pure
};</code></pre><pre id="r-431411" data-claire-element-id="431411"><code data-claire-semantic="java">// En Java
interface IConvertisseurHTML
{
  public void fromHTMLToFile(String html, String fichierDestination);
}</code></pre><p id="r-431412" data-claire-element-id="431412">Ensuite on peut imaginer que la classe qui transforme le Html en Pdf va implémenter cette interface. Cependant je ne m'étends pas plus sur le sujet et pour cause le design pattern strategy répond à ce problème posé de manière très efficace. Ce n'est cependant pas le seul design pattern à user de ce principe. Si vous souhaitez savoir comment, suivez la suite du tutoriel !</p><p id="r-431413" data-claire-element-id="431413">Plus d'informations à ce sujet :<br/> - le terme désigné pour ce concept se nomme OCP. On parle aussi de respecter le principe Open/Closed.<br/> - <a href="http://www.regismedina.com/articles/fr/principesoo/ocp">Article en C++ sur Régis Medina</a>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
<span class="arrow"></span>
<span class="next">Pensez interface</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
<span class="next">Pour aller plus loin</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Pourallerplusloin"></a><h2>Pour aller plus loin</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
<span class="arrow"></span>
<span class="next">La sensibilité de l&#039;objet à subir des modifications</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">
<span class="next">Le patron de conception Observateur (Observer)</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-pour-aller-plus-loin-35" data-claire-element-id="431428">Pour aller plus loin</h4><p id="r-431415" data-claire-element-id="431415">Si vous appliquez la plupart des théories du paradigme explicitée plus haut vous êtes déjà paré pour concevoir d'une manière efficace. Ce sont des points qui ont tous pour vocation de rendre la programmation orientée objet réutilisable (l'argument majeur qui est tout le temps ressorti) en obtenant un maximum de flexibilité/souplesse au code. Si certains de ces concepts étaient nouveaux pour vous, certaines choses doivent être encore floues ou difficilement réalisables. Et oui, une bonne conception objet <strong>est tout, sauf une tâche simple</strong>, du moins pas aussi simple que certains voudraient le croire.</p><p id="r-431416" data-claire-element-id="431416">Vous comprenez peut être mieux la motivation qu'ont eu certaines personnes dans l'écriture de catalogues sur des patrons de conceptions réutilisables. Ces recettes ont été le fruit de beaucoup de remaniements avant d'arriver à une version très aboutie. Les auteurs avouent eux même que l'élaboration de patrons de conception est <em>&quot;le résultat travail obscur de remaniements de la conception et du code effectué par les développeurs&quot;</em>.</p><p id="r-431417" data-claire-element-id="431417">Une chose importante dont je n'ai pas parlé, dans la grande majorité des situations vous n'êtes pas sensé connaître le type précis d'un objet. L'utilisation des opérateurs <em>instance_of, is, type_info, typeid , getClass(), etc.</em> révèle souvent comme une erreur de conception. Soyez sûr que vous voulez connaitre le type non pas par fainéantise mais par nécessité. Retenez qu'une bonne conception devrait se passer de savoir l'instance réelle d'un objet en se substituant par <strong>polymorphisme</strong> sauf si elle engendre une complexité marquante.</p><p id="r-431418" data-claire-element-id="431418">Si vous souhaitez encore approfondir votre connaissance dans le paradigme objet, voici des sujets et les mots clefs correspondants qui pourront vous aiguiller dans vos recherches. Bien sûr, les quelques explications qui sont données ne sont qu'une vulgarisation de ces sujets :</p><p id="r-431419" data-claire-element-id="431419"><strong>Construction par couches :</strong><br/> Un concept qui recoupe pas mal ce qui a été dit plus haut dans ce chapitre est de développer avec de l'abstraction. On peut visualiser une application comme une succession de couches qui partent d'un niveau d'abstraction très élevé et en empilant des couches de plus en plus concrètes. En procédant de cette manière on s'assure que les attentes fixées dans les couches abstraites sont respectées dans les classes plus concrètes.<br/> Mot clef associé : DIP ou Principe d'inversion des dépendances.</p><p id="r-431420" data-claire-element-id="431420"><strong>La différentiation des classes &quot;entité&quot; et classe &quot;valeur&quot; :</strong><br/> Bien que cette notion ait plus d'importance en C++ que dans d'autres langages plus modernes, il est toujours intéressant de connaître ce que sont les classes entités à opposer aux classes de valeurs. Les classes à sémantique de valeur représentent des classes dont deux instances différentes peuvent être considérées égales si elles ont le même contenu (par exemple la comparaison de 2 Couleurs). A l'inverse, une classe à sémantique d'entité n'autorise pas de dire que deux instances différentes au contenu identique sont équivalentes (une personne est unique même si deux peuvent avoir le même nom et prénom). <strong>Elle connote une identité propre</strong> à chaque objet.</p><p id="r-431421" data-claire-element-id="431421">Faire cette distinction permet de savoir quelles opérations particulières doivent être implémentées. Les liens donnés juste après rentrent un peu plus en détail. L’intérêt bien que moins important en Java est de savoir quand écrire certaines méthodes comme par exemple equals() ou des opérations d'ajout, de soustraction, etc.</p><p id="r-431422" data-claire-element-id="431422">Références :<br/> - Classes à sémantique de valeur : <a href="http://cpp.developpez.com/faq/cpp/?page=classes#CLASS_valeur">faq developpez</a>.<br/> - Classes à sémantique d'entité : <a href="http://cpp.developpez.com/faq/cpp/?page=classes#CLASS_entite">faq developpez</a>.</p><p id="r-431423" data-claire-element-id="431423"><strong>Évitez la duplication de code :</strong><br/> Derrière ce principe simple, il n'est pas aisé d'avoir un code qui ne possède pas de redondance ou très peu. L'usage d'une bonne conception objet va réduire drastiquement cette duplication. Il existe d'autres pratiques permettant de poser les bases sur l'écriture unique de code. Cette étape vient généralement pendant l'écriture du code et se retrouve donc en aval de la conception.<br/> Mot clef associé : DRY</p><p id="r-431424" data-claire-element-id="431424"><strong>Pour aller encore plus loin :</strong><br/> - Réalisation d'interfaces avec découplage de l'implémentation : le pattern NVI, <a href="http://cpp.developpez.com/faq/cpp/?page=heritage#HERITAGE_NVI">faq sur developpez</a>.<br/> - Commonalities &amp; variation points : un sujet complexe de Coplien qui permet d'avoir une vision très abstraite permettant de voir plus loin que le simple mécanisme du polymorphisme.</p><p id="r-431425" data-claire-element-id="431425"><strong>Auteurs ayant activement participé à la conception objet (non exhaustif):</strong><br/> - Jim Coplien.<br/> - Robert C Martin.<br/> - Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides (Gof)</p><p id="r-431426" data-claire-element-id="431426">Que de choses complexes ont été relatées à travers ce chapitre. Oui, vous êtes fixés, respecter les différents postulats survolés nécessite une grosse part d'investissement intellectuel pour réussir à les satisfaire mais les bénéfices sont sans appel : Vous pourrez non seulement vous targuer d'avoir des codes qui ne seront plus remis en doute à la moindre occasion et votre application pourra évoluer beaucoup plus sereinement. Aussi, les corrections de bogues auront beaucoup moins de chances de se propager en cascade.</p><p id="r-431427" data-claire-element-id="431427">En route pour découvrir un patron de conception très largement utilisé aujourd'hui, &quot;l’observer&quot;. La plupart des concepts évoqués vont être utilisés, soyez à l'aise avec ces grandes lignes et vous pourrez avoir un regard critique sur le &quot;pourquoi&quot; ils en sont devenus des références aujourd'hui. Ne vous contentez pas d'apprendre les patterns, assimilez les mécanismes sous-jacents pour pourvoir les réutiliser lorsque vous tomberez sur un &quot;os&quot;.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
<span class="arrow"></span>
<span class="next">La sensibilité de l&#039;objet à subir des modifications</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">
<span class="next">Le patron de conception Observateur (Observer)</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LepatrondeconceptionObservateurObserver"></a><h2>Le patron de conception Observateur (Observer)</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
<span class="arrow"></span>
<span class="next">Pour aller plus loin</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
<span class="next">Posons le problème</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-431432" data-claire-element-id="431432">Pour bien comprendre pourquoi et comment utiliser un design pattern, il faut une raison. Je vais donc vous définir un sujet particulier sur lequel vous devrez cogiter. Oui, vous avez bien lu, il va falloir réfléchir. Le meilleur moyen de retenir durablement ce qui va suivre est de buter sur le problème. Pour ma part je suivrai un cheminement pour essayer progressivement de m'approcher de la solution.</p><aside id="r-431434" data-claire-element-id="431434" data-claire-semantic="warning"><p id="r-431433" data-claire-element-id="431433">Essayez de vous forcer un minimum à réfléchir avant de lire la solution. Si je ne devais donner qu'un seul conseil, ce serait de prendre un papier et un crayon afin de tenter la résolution par vous-même.</p></aside>
</div><a name="Posonsleproblme"></a><h2>Posons le problème</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">
<span class="arrow"></span>
<span class="next">Le patron de conception Observateur (Observer)</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
<span class="next">Résolvons progressivement notre cas</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-posons-le-probleme-4" data-claire-element-id="431457">Posons le problème</h4><p id="r-431435" data-claire-element-id="431435">Soit un ascenseur, sa fonction première est de monter ou de descendre des étages pour satisfaire des requêtes de personnes. Comme vous le savez peut être, l'installation d'un ascenseur ne se réduit pas à placer la cabine qui se déplacera dans un rail. De multiples capteurs sont présents pour que la cabine puisse se comporter idéalement selon les situations, en voici une petite liste :</p><ul id="r-431442" data-claire-element-id="431442"><li id="r-431437" data-claire-element-id="431437"><p id="r-431436" data-claire-element-id="431436">Un capteur qui indique qu'un utilisateur ne se retrouve pas entre deux niveaux lorsque les portes doivent s'ouvrir.</p></li><li id="r-431439" data-claire-element-id="431439"><p id="r-431438" data-claire-element-id="431438">Un capteur situé au niveau des portes pour savoir si quelqu'un n'est pas totalement rentré dans l'ascenseur.</p></li><li id="r-431441" data-claire-element-id="431441"><p id="r-431440" data-claire-element-id="431440">Un capteur qui mesure la pression exercée sur les portes de l'ascenseur lorsqu'elles sont ouvertes. Ce dispositif permet de s'assurer que rien ne sera écrasé si une trop forte résistance s'oppose lors de la fermeture.</p></li></ul><p id="r-431443" data-claire-element-id="431443">Cette liste n'est pas exhaustive, mais c'est pour vous montrer que sous son apparence simpliste, un ascenseur comporte des mécanismes complexes (sans parler du traitement des requêtes utilisateurs).</p><aside id="r-431445" data-claire-element-id="431445" data-claire-semantic="information"><p id="r-431444" data-claire-element-id="431444">Les personnes ayant connaissance des automates programmables, des grafcets ou de la création de schémas électriques complexes savent de quoi il est question.</p></aside><p id="r-431446" data-claire-element-id="431446">Par cette brève introduction, rentrons maintenant dans le vif du sujet. Vous êtes en charge de gérer <strong>la bonne position</strong> de la <strong>cabine de l'ascenseur</strong>. Pour cela, la cabine possède diverses informations comme son sens courant de déplacement et son étage actuel. Le seul moyen pour vous de savoir quand l'ascenseur changera d'étage sera par l’intermédiaire d'un <strong>capteur photosensible</strong> placé sur l'ascenseur et détectant un <strong>repère placé sur chaque étage</strong>. Comme un schéma est souvent plus clair pour montrer de quoi il est question, je vous propose le suivant :</p><figure id="r-431448" data-claire-element-id="431449"><img id="r-431447" data-claire-element-id="431447" src="medias/uploads.siteduzero.com_files_370001_371000_370193.png" alt="Récapitulatif ascenseur"/></figure><p id="r-431450" data-claire-element-id="431450">Dès que le laser passe sur le repère, une variation va être détectée. Le capteur laser sait donc qu'un étage a été décelé.<br/> La cabine doit maintenant mettre à jour son nouvel étage courant.</p><p id="r-431451" data-claire-element-id="431451">Voici les éléments qui sont donnés pour résoudre ce problème :</p><figure id="r-431453" data-claire-element-id="431454"><img id="r-431452" data-claire-element-id="431452" src="medias/uploads.siteduzero.com_files_370001_371000_370196.png" alt="Elements UML"/></figure><p id="r-431455" data-claire-element-id="431455">Vous pouvez voir que le capteur est dans un thread, cela importe peu, concentrez-vous juste sur les opérations à faire lorsqu'une variation est détectée. <br/> En gros, ne touchez à rien d'autre dans la méthode du thread que le corps de la boucle.</p><p id="r-431456" data-claire-element-id="431456">Avec ces éléments de base, vous pouvez modifier les classes à votre souhait, rajouter autant de méthodes que vous le souhaitez, l'essentiel étant de faire diffuser l'information du capteur vers la cabine et de mettre à jour l'étage de celle-ci. A vos brouillons !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">
<span class="arrow"></span>
<span class="next">Le patron de conception Observateur (Observer)</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
<span class="next">Résolvons progressivement notre cas</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Rsolvonsprogressivementnotrecas"></a><h2>Résolvons progressivement notre cas</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
<span class="arrow"></span>
<span class="next">Posons le problème</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
<span class="next">L&#039;observateur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-resolvons-progressivement-notre-cas" data-claire-element-id="431480">Résolvons progressivement notre cas</h4><p id="r-431458" data-claire-element-id="431458">Comme dit précédemment dans ce tutoriel, je vais décrire plusieurs approches qui sont issues de raisonnements simples pour montrer comment doit s'organiser votre pensée. Vous verrez qu'il s'agit de l'approche de la réussite par l'échec. Si vous avez suffisamment assimilé le sujet, deux voire trois options vous sont peut-être venues à l'esprit, je vais tenter de décrire chacune d'entre-elles et les confronter aux principes objets que j'ai évoqué dans le chapitre précédent.</p><p id="r-431459" data-claire-element-id="431459"><strong>Première approche, scruter le capteur pour déterminer une variation :</strong><br/>On peut partir du principe que le capteur vérifie en permanence le repère d'un étage. Avec cette approche, il suffit de créer une méthode renvoyant un booléen qui indique si oui ou non une variation a été détectée. Voyons une version de ce diagramme UML :</p><figure id="r-431461" data-claire-element-id="431462"><img id="r-431460" data-claire-element-id="431460" src="medias/uploads.siteduzero.com_files_370001_371000_370311.png" alt="Diagramme cas 1"/></figure><p id="r-431463" data-claire-element-id="431463">Il ne manque plus qu'à vérifier que la méthode <em>detecteEtage()</em> renvoie <em>vrai</em>.<br/> Oui dans les faits, c'est une manière plutôt élégante de résoudre ce problème, vous respectez même les grands principes objets. En effet, la cabine peut juste consulter l'état d'un objet sans en altérer le comportement, aussi chaque objet peut évoluer indépendamment. En rajoutant un peu d'abstraction on pourrait même se payer le luxe de pouvoir représenter n'importe quel capteur qui signale juste un changement d'état. Comment ? à l'aide d'une interface bien sûr, je vous laisse réfléchir sur le diagramme suivant :</p><figure id="r-431465" data-claire-element-id="431466"><img id="r-431464" data-claire-element-id="431464" src="medias/uploads.siteduzero.com_files_370001_371000_370310.png" alt="Diagramme cas 1, abstraction"/></figure><p id="r-431467" data-claire-element-id="431467">Voilà une conception très flexible, si on décide de changer de capteur (par exemple un capteur à aimantation), il suffira de créer une nouvelle classe qui implémente l'interface. Le code pour la cabine ne changera pas.<br/> Cependant cette approche a un problème et vous avez probablement remarqué que je n'en ai pas parlé. Quel est le code exact à mettre dans la classe Cabine ? Puisqu'on doit scruter les changements d'états du capteur, il faut pouvoir connaître en permanence l'état courant de celui-ci. Si vous avez deviné, oui il s'agit bien d'une boucle qui s'occupe de vérifier la variation. Et c'est encore une boucle infinie comme pour le capteur et bloquante de surcroît si on ne la place pas dans un autre thread. L'implémentation est donc assez fastidieuse dans la cabine mais elle est possible. L’inconvénient majeur est que malgré tout, on va consommer des ressources processeur inutilement et il faudra éventuellement gérer les problèmes de synchronisme de thread. Imaginez que le capteur détecte toutes les 60èmes de seconde, il est important que la cabine consulte <strong>au minimum</strong> 60 fois par seconde aussi.</p><aside id="r-431469" data-claire-element-id="431469" data-claire-semantic="information"><p id="r-431468" data-claire-element-id="431468">Le framework MFC de microsoft reprenait dans les grandes lignes cette approche pour gérer les évènements. S'il paraît absurde aujourd'hui de procéder de cette manière, à l'époque rien ne choquait particulièrement.</p></aside><p id="r-431470" data-claire-element-id="431470">Retenez que cette solution n'est pas mauvaise en soit mais pour des raisons de performances/complexités, elle n'est pas spécialement adaptée à nos besoins. C'est pourquoi nous l'abandonnons pour un autre raisonnement tout aussi trivial. Voyez tout de même la démarche adoptée pour réussir à pouvoir définir un comportement commun à certains capteurs, ce qui fait que l'écriture du thread pour la cabine n'aurait pas changé si on &quot;substituait&quot; un autre capteur au même comportement. Adopter cette démarche est la voie de la programmation réutilisable et flexible.</p><p id="r-431471" data-claire-element-id="431471"><strong>Seconde approche, avoir l'instance de l'ascenseur dans la classe capteur :</strong><br/> Une autre solution serait tout simplement de prévenir la cabine qu'une variation a été détectée. Cette méthode est beaucoup plus efficace et ne comporte pas de défaut particulier. Il faut juste que la cabine puisse proposer une méthode sur laquelle on pourra informer un changement d'étage. Comme à mon habitude, je vous propose un diagramme UML de cette solution :</p><figure id="r-431473" data-claire-element-id="431474"><img id="r-431472" data-claire-element-id="431472" src="medias/uploads.siteduzero.com_files_370001_371000_370309.png" alt="Diagramme cas 2"/></figure><p id="r-431475" data-claire-element-id="431475">A vrai dire, si vous modélisez le problème de cette manière, vous vous passez d'une deuxième boucle comme traitée dans la première approche et vous respectez par la même occasion les grands principes objets. En fait pour tout vous dire, c'est une implémentation concrète du design pattern observateur. Le seul inconvénient majeur de notre capteur est que si nous voulons ajouter une autre classe qui souhaite savoir qu'une variation a eu lieu, il va falloir rajouter une référence explicite dans le capteur laser et rajouter l'instruction dans notre boucle de thread.</p><figure id="r-431477" data-claire-element-id="431478"><img id="r-431476" data-claire-element-id="431476" src="medias/uploads.siteduzero.com_files_370001_371000_370313.png" alt="Diagramme cas 2, multiple"/></figure><p id="r-431479" data-claire-element-id="431479">On pourrait imaginer que la cabine contrôle le moteur. Admettons que pour offrir une sécurité supplémentaire, ce moteur vérifie indépendamment si l'ascenseur n'est pas à un niveau hors des bornes (13ème étage par exemple alors que le bâtiment ne possède que 12 étages).<br/> Dans ce cas précis, on voit bien que le code du capteur va devoir être modifié pour renseigner cette information au moteur. Rappelez-vous qu'une bonne conception doit être fermée autant que possible aux modifications sur le code existant. Si vous avez suivi mon discours jusqu'à présent, vous pouvez déjà entrevoir une solution à l'aide d'interfaces, cette abstraction qui permettra au capteur laser de signaler à un nombre quelconque de classes sa variation sans modifier le code existant se rapprochera du patron de conception observateur. Voyons maintenant de quoi il est question.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
<span class="arrow"></span>
<span class="next">Posons le problème</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
<span class="next">L&#039;observateur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="L039observateur"></a><h2>L&#039;observateur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
<span class="arrow"></span>
<span class="next">Résolvons progressivement notre cas</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">
<span class="next">Le patron de conception État (State)</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-l-observateur" data-claire-element-id="431527">L'observateur</h4><p id="r-431481" data-claire-element-id="431481">Ce que nous cherchons à faire ici se résume simplement avec un schéma :</p><figure id="r-431483" data-claire-element-id="431484"><img id="r-431482" data-claire-element-id="431482" src="medias/uploads.siteduzero.com_files_370001_371000_370402.png" alt="Représentation observateur"/></figure><p id="r-431485" data-claire-element-id="431485">Transposé à notre cas, l’émetteur d'une information se révélerait être le capteur. Les récepteurs de signalement seraient la cabine ainsi que le moteur.</p><p id="r-431486" data-claire-element-id="431486">Je vous ai mis plusieurs couples de mots qui peuvent aider certaines personnes à comprendre dans quel cas nous pouvons appliquer le problème. Notez que les termes &quot;Observable&quot; et &quot;Observateur&quot; sont les mots les plus représentatifs car ils sont <strong>plus abstraits</strong> (assez difficile à juger tout de même). Cependant vous ne serez pas en tort si vous utilisez les autres termes ;) .</p><p id="r-431487" data-claire-element-id="431487">Grâce à cette représentation, on peut directement constater quels termes vont apparaître dans notre conception pour manipuler des abstractions. Il y a cependant un détail à noter : Un annuaire, pour prévenir ses abonnés qu'un changement d'état existe (on parle de notification), doit contenir la liste des intéressés. Ce qui implique que l'annuaire doit proposer des méthodes permettant à n'importe qui de s'inscrire et de se désinscrire aux moments souhaités.</p><aside id="r-431489" data-claire-element-id="431489" data-claire-semantic="information"><p id="r-431488" data-claire-element-id="431488">Ces opérations communes à tout ce qui pourrait être observable nécessitent d'écrire une implémentation. L'interface ne sera donc pas adaptée pour représenter un annuaire.</p></aside><p id="r-431490" data-claire-element-id="431490">L'observateur lui, se contente de s'inscrire à ce qui l'intéresse, il a juste besoin d'être prévenu lors d'une parution. Ce sera donc une interface avec la méthode permettant de notifier.</p><figure id="r-431492" data-claire-element-id="431493"><img id="r-431491" data-claire-element-id="431491" src="medias/uploads.siteduzero.com_files_370001_371000_370657.png" alt="UML esquisse observeur"/></figure><p id="r-431494" data-claire-element-id="431494">La méthode notification() permet de signaler un changement de la part de l'observable.<br/> Nous avons notre version minimale du patron de conception Observateur ! Voyez que les meilleures solutions ne sont pas forcément les plus compliquées (c'est même souvent le contraire). Il a suffi d'une classe et d'une interface pour pouvoir modéliser ce comportement. En l'appliquant à notre sujet de départ voici le diagramme de classes UML que l'on obtiendrait :</p><figure id="r-431496" data-claire-element-id="431497"><img id="r-431495" data-claire-element-id="431495" src="medias/uploads.siteduzero.com_files_370001_371000_370658.png" alt="UML final"/></figure><p id="r-431498" data-claire-element-id="431498">Passons maintenant à notre implémentation (je ne vais que m'attarder sur la partie code sur l'observateur et l'observable) :</p><pre id="r-431499" data-claire-element-id="431499"><code data-claire-semantic="cpp">#include &lt;string&gt;
#include &lt;list&gt;
#include &lt;iostream&gt;
using namespace std;

class IObservateur
{
  public:
    virtual void notifier() = 0;
};

class Observable
{
  public:
    void notifierObservateurs() const
    {
        // Notifier tous les observateurs
        list&lt;IObservateur*&gt;::const_iterator end = m_observateurs.end();
        for (list&lt;IObservateur*&gt;::const_iterator it = m_observateurs.begin(); it != end; ++it)
            (*it)-&gt;notifier();
    }

    void ajouterObservateur(IObservateur* observateur)
    {
        // On ajoute un abonné à la liste en le plaçant en premier (implémenté en pull).
        // On pourrait placer cet observateur en dernier (implémenté en push, plus commun).
        m_observateurs.push_front(observateur);
    }

    void supprimerObservateur(IObservateur* observateur)
    {
        // Enlever un abonné a la liste
        m_observateurs.remove(observateur);
    }
    
  private:
        list&lt;IObservateur*&gt; m_observateurs;
};

class Cabine : public IObservateur
{
  public:
    void notifier()
    {
        cout &lt;&lt; &quot;Cabine a recu la notif&quot; &lt;&lt; endl;
        // Changement d'étage selon son sens et sa position précédente.
    }
};

class Moteur : public IObservateur
{
  public:
    void notifier()
    {
        cout &lt;&lt; &quot;Moteur a recu la notif&quot; &lt;&lt; endl;
        // Verification que l'étage soit dans les bornes autorisées.
    }
};

class CapteurLaser : public Observable
{
  public:

   // Le code de la boucle while en environnement Threadé
   void run()
   {
       while(true)
       {
           if(m_detecteVariation)
               notifierObservateurs();
       }
   }

   private:
     bool m_detecteVariation;
};

int main()
{
    Cabine instanceCabine;
    Moteur instanceMoteur;

    CapteurLaser capteurEtage;

    capteurEtage.ajouterObservateur(&amp;instanceCabine);
    capteurEtage.ajouterObservateur(&amp;instanceMoteur);

    // On simule manuellement une variation (normalement c'est le thread qui s'en charge)
    capteurEtage.notifierObservateurs();

    // La cabine et le moteur ont reçu une notification sur leur méthode notifier()

    capteurEtage.supprimerObservateur(&amp;instanceMoteur);
    cout &lt;&lt; &quot;Suppression du moteur dans les abonnes&quot; &lt;&lt; endl;

    capteurEtage.notifierObservateurs();


    return 0;
}</code></pre><p id="r-431500" data-claire-element-id="431500">Et le java correspondant :</p><pre id="r-431501" data-claire-element-id="431501"><code data-claire-semantic="java">import java.util.Iterator;
import java.util.LinkedList;
import java.util.List;

interface IObservateur
{
	public void notifier();
}

class Observable
{

	public Observable() 
	{
		m_observateurs = new LinkedList&lt;IObservateur&gt;();
	}
	
	public void notifierObservateurs()
	{
	   Iterator&lt;IObservateur&gt; it = m_observateurs.iterator();
	    // Notifier tous les observers
	   while(it.hasNext()){
		   IObservateur obs = it.next();
		   obs.notifier();
	   }
	}
	
	void ajouterObservateur(IObservateur observateur)
	{
	    // On ajoute un abonné à la liste en le plaçant en premier (implémenté en pull).
            // On pourrait placer cet observateur en dernier (implémenté en push, plus commun).
	    m_observateurs.add(observateur);
	}
	
	void supprimerObservateur(IObservateur observateur)
	{
	    // Enlever un abonné a la liste
	    m_observateurs.remove(observateur);
	}
	
	private List&lt;IObservateur&gt; m_observateurs;
}

class Cabine implements IObservateur
{
	public void notifier()
	{
		System.out.println(&quot;Cabine a recu la notif&quot;);
		// Changement d'étage selon son sens et sa position précédente.
	}
}

class Moteur implements IObservateur
{
	public void notifier()
	{
		 System.out.println(&quot;Moteur a recu la notif&quot;);
		 // Verification que l'étage soit dans les bornes autorisées.
	}
}

class CapteurLaser extends Observable
{
   // Le code de la boucle while en environnement Threadé
	public void run()
	{
		while(true)
		{
			if(m_detecteVariation)
				notifierObservateurs();
		}
	}

	private boolean m_detecteVariation;
}


public class Run {

	/**
	 * @param args
	 */
	public static void main(String[] args) 
	{
		Cabine instanceCabine = new Cabine();
		Moteur instanceMoteur = new Moteur();
		
		CapteurLaser capteurEtage = new CapteurLaser();;
		
		capteurEtage.ajouterObservateur(instanceCabine);
		capteurEtage.ajouterObservateur(instanceMoteur);
		
		// On simule manuellement une variation (normalement c'est le thread qui s'en charge)
		capteurEtage.notifierObservateurs();
		
		// La cabine et le moteur ont reçu une notification sur leur méthode notifier()
		
		capteurEtage.supprimerObservateur(instanceMoteur);
		System.out.println(&quot;Suppression du moteur dans les abonnes&quot;);
		
		capteurEtage.notifierObservateurs();
	}
}</code></pre><p id="r-431502" data-claire-element-id="431502">La sortie obtenue après exécution :</p><pre id="r-431503" data-claire-element-id="431503"><code data-claire-semantic="console">Cabine a recu la notif
Moteur a recu la notif
Suppression du moteur dans les abonnes
Cabine a recu la notif</code></pre><p id="r-431504" data-claire-element-id="431504">Le principal dans tout ce que vous avez lu jusqu'à présent est le <strong>cheminement suivi</strong>. Si vous avez assimilé cette démarche c'est que l'essentiel sur ce chapitre vous a été retransmis. Il est très important de de suivre un raisonnement et de réfléchir avant de partir tête baissée dans le code. J'insiste encore sur le fait qu'<strong>une bonne conception est la clef de voute pour du code réutilisable, extensible et robuste</strong>. <strong>Je rappelle que mon objectif premier sur ce cours n'est pas de vous apprendre à utiliser les design patterns mais d'apprendre à concevoir d'une meilleure manière</strong>. Il existe tellement de sources sur internet qui traitent des patrons de conception que je n'ai aucune prétention de faire mieux. Je développe plutôt la démarche qui montre le résultat d'une conception très réfléchie à partir d'idées concrètes.</p><p id="r-431505" data-claire-element-id="431505">Maintenant sachez qu'en Java vous ne serez pas obligés de devoir écrire le code de l'Observateur et de l'Observable, ce design pattern étant tellement utilisé, il existe dans l'API de base :</p><pre id="r-431506" data-claire-element-id="431506"><code data-claire-semantic="java">// Exemple tiré de wikipédia
class Signal extends Observable {
 
  void setData(byte[] lbData){
    setChanged(); // Positionne son indicateur de changement
    notifyObservers(); // (1) notification
  }
}
/*
    On crée le panneau d'affichage qui implémente l'interface java.util.Observer.
    Avec une méthode d'initialisation (2), on lui transmet le signal à observer (2).
    Lorsque le signal notifie une mise à jour, le panneau est redessiné (3).*/

class JPanelSignal extends JPanel implements Observer {
 
  void init(Signal lSigAObserver) {
    lSigAObserver.addObserver(this); // (2) ajout d'observateur
  }
 
  void update(Observable observable, Object objectConcerne) {
    repaint();  // (3) traitement de l'observation
  }
}</code></pre><p id="r-431507" data-claire-element-id="431507">Le code varie un peu, on peut voir que la méthode update(...) correspond à notre méthode notifier().</p><div id="r-431509" data-claire-element-id="431509" data-claire-semantic="question"><p id="r-431508" data-claire-element-id="431508">Mais attend ! Pourquoi il y a deux arguments supplémentaires dans la méthode o_O ?</p></div><p id="r-431510" data-claire-element-id="431510">Pas de panique, un petit tour dans la documentation <a href="http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Observer.html">nous éclaire très vite</a>. Le premier argument correspond à l'objet émetteur de la notification, alors que le second paramètre permet de passer des valeurs relatives à cet évènement. Prenons pour exemple un thermomètre qui lorsqu'il change sa température va envoyer la notification à ses abonnés. Oui mais on veut aussi obtenir quelle température était indiquée au thermomètre lorsqu'il a émis la notification. C'est le rôle du second argument. Le premier argument quant à lui permet de reconnaitre qui a indiqué la notification si notre objet s'est abonné à plusieurs sources (par exemple un objet qui reçoit la notification de deux thermomètres différents).</p><p id="r-431511" data-claire-element-id="431511">Connaître l’émetteur peut vous sembler superflu mais dans la programmation événementielle ce cas arrive assez souvent. Pour ceux qui auraient un doute, la programmation événementielle s'utilise très souvent lorsque les logiciels fonctionnent avec une interface graphique. Tout est évènement sur les interfaces et regardez sur une fenêtre à l'apparence simple le nombre d'évènements que l'on peut lancer :</p><figure id="r-431513" data-claire-element-id="431514"><img id="r-431512" data-claire-element-id="431512" src="medias/uploads.siteduzero.com_files_370001_371000_370469.png" alt="IHM"/></figure><p id="r-431515" data-claire-element-id="431515">Il n'y a que la moitié des éléments (encadrés en rouge) pouvant lancer des notifications sur mon exemple.<br/> Sachez que chaque bouton, liste déroulante ou autre utilise en principe une base de ce design pattern (même si certains IDE camouflent leur utilisation à l'aide d'outils graphiques pour dessiner les fenêtres). C'est un patron de conception qui a un très fort taux d'utilisation.</p><p id="r-431516" data-claire-element-id="431516">Pour bien insister sur le fonctionnement de ce patron de conception, je vais vous proposer un exemple dans une application graphique. Il sera ici question d'une interface de panier et vous verrez que son utilisation est moins intuitive qu'elle en a l'air. Mais penchons nous sur le sujet : Une liste d'articles est représentée et affichée dans un contrôle avec un montant total n'est pas calculé à l'affichage. Un bouton permet d’estimer le coût total des composants et de le renseigner dans un champ prévu à cet effet. L'image qui suit devrait vous faciliter la compréhension :</p><figure id="r-431518" data-claire-element-id="431519"><img id="r-431517" data-claire-element-id="431517" src="medias/uploads.siteduzero.com_files_378001_379000_378180.png" alt="IHM observer à placer."/></figure><p id="r-431520" data-claire-element-id="431520">IHM d'un panier. On peut voir le bouton qui permet de calculer le prix et de remplir le champ &quot;Total&quot;.<br/> Le problème avec le bouton, c'est qu'aucune capture d'évènement n'est associée dessus. Un bouton est à la base un simple composant comme le reste, inerte. Il est nécessaire de venir lui indiquer qu'un clic utilisateur va engendrer un comportement spécifique. C'est là que le pattern observateur entre en jeu : <strong>l'utilisateur est donc observé</strong> pour savoir si une pression sur le bouton a été exercée, tandis que le <strong>bouton devient un observateur</strong>. Autant vous le dire tout de suite, les programmes avec interfaces graphiques <strong>camouflent la partie d'utilisateur observé</strong> (le framework ou le système d'exploitation de charge de cet élément). Vous, en tant que programmeur, vous n'avez qu'à vous préoccuper du bouton et de le rendre observateur. La méthode pour rendre un composant graphique observateur diffère selon le langage et les outils utilisés mais le principe reste toujours le même. Le résultat sera donc le suivant :</p><figure id="r-431522" data-claire-element-id="431523"><img id="r-431521" data-claire-element-id="431521" src="medias/uploads.siteduzero.com_files_378001_379000_378182.png" alt="IHM bouton écoute clic utilisateur."/></figure><p id="r-431524" data-claire-element-id="431524">Le bouton devient observateur d'un clic. Lorsque l'utilisateur appuiera sur le bouton, l'interface graphique va appeler l'évènement que le bouton écoute.</p><p id="r-431525" data-claire-element-id="431525">C'est ainsi que s'achève notre première étude de cas. J'espère que ce chapitre aura été enrichissant pour vous. si tel est le cas, j'aurai réussi mon pari. Assurez vous de comprendre comment fonctionne ce patron de conception car il est utilisé dans de nombreux cas et même dans d'autres patrons de conception plus complexes.</p><p id="r-431526" data-claire-element-id="431526">Si vous n'avez pas saisi quelque chose, relisez ce chapitre à tête.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
<span class="arrow"></span>
<span class="next">Résolvons progressivement notre cas</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">
<span class="next">Le patron de conception État (State)</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LepatrondeconceptiontatState"></a><h2>Le patron de conception État (State)</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
<span class="arrow"></span>
<span class="next">L&#039;observateur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
<span class="next">Le tramway</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-431529" data-claire-element-id="431529">Toujours présents ? :) <br/> Nous voilà fin prêt à attaquer sur un autre sujet. Les puristes des design patterns constateront que je vais m'attarder sur un patron de conception qui ne présente pas un taux d'utilisation élevé. Je rappelle avant tout que mon cours ne se veut pas un catalogue des patrons de conception, je préfère aborder les notions sur la <em>bonne conception</em>. Et puis, il existe peu de documentation française claire sur ce pattern, ce qui rend cette partie d'autant plus intéressante.<br/> Comme pour le chapitre précédent, je vais poser un problème sur lequel j'attaquerai différents angles d'approche. Si vous le permettez, lançons-nous dans la fosse !</p>
</div><a name="Letramway"></a><h2>Le tramway</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">
<span class="arrow"></span>
<span class="next">Le patron de conception État (State)</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
<span class="next">Lançons nous</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-le-tramway" data-claire-element-id="431718">Le tramway</h4><p id="r-431530" data-claire-element-id="431530">Voici un cas un peu plus original que l'ascenseur vu précédemment. J'ai nommé à la barre un système de contrôle sur un tramway. Ne vous affolez pas, je vais faire en sorte de bien vous guider pour comprendre ce que j'attends de ce système.</p><aside id="r-431532" data-claire-element-id="431532" data-claire-semantic="information"><p id="r-431531" data-claire-element-id="431531">L'exemple qui va suivre ne correspond pas forcément à la réalité, inutile de me préciser que le tramway s'utilise différemment. Le but étant de comprendre le mini cahier des charges qui va suivre, pas de vous focaliser sur les divergences par rapport à la réalité.</p></aside><p id="r-431533" data-claire-element-id="431533">Ce que l'on souhaite gérer, c'est le comportement de ce tramway selon diverses situations. Par exemple, lorsque le tramway est à l'arrêt, il est possible d'ouvrir les portes pour pouvoir sortir. Cette action n'est pas possible lorsque celui-ci est en déplacement. Le tramway se voit donc offrir différentes interactions possibles qui n'auront pas les mêmes incidences selon sa configuration.</p><p id="r-431534" data-claire-element-id="431534">Je vais sans plus attendre, donner les contraintes d'une manière plus formelle. Attaquons dans le vif du sujet avec un cahier des charges très simpliste. Bien qu’incomplètes, ces spécifications seront suffisantes à notre niveau.</p><p id="r-431535" data-claire-element-id="431535"><strong>Le cahier des charges :</strong><br/> Le tramway propose plusieurs actions possibles lorsqu'on est passager :</p><ul id="r-431542" data-claire-element-id="431542"><li id="r-431537" data-claire-element-id="431537"><p id="r-431536" data-claire-element-id="431536">Un bouton arrêt d'urgence pour arrêter le tramway à tout moment.</p></li><li id="r-431539" data-claire-element-id="431539"><p id="r-431538" data-claire-element-id="431538">Un bouton pour pouvoir ouvrir les portes du tramway lorsqu'il est en station.</p></li><li id="r-431541" data-claire-element-id="431541"><p id="r-431540" data-claire-element-id="431540">Un bouton pour demander l'arrêt à la prochaine station</p></li></ul><p id="r-431543" data-claire-element-id="431543">Les stations quant à elles, ont :</p><ul id="r-431550" data-claire-element-id="431550"><li id="r-431545" data-claire-element-id="431545"><p id="r-431544" data-claire-element-id="431544">Un bouton pour prévenir le tramway qui arrive de s'arrêter pour récupérer des gens.</p></li><li id="r-431547" data-claire-element-id="431547"><p id="r-431546" data-claire-element-id="431546">Un capteur qui indique au tramway qu'il est bien positionné pour s'arrêter.</p></li><li id="r-431549" data-claire-element-id="431549"><p id="r-431548" data-claire-element-id="431548">Un compteur qui envoie une impulsion au tramway pour indiquer qu'il peut repartir lors d'une attente respectée en station.</p></li></ul><p id="r-431551" data-claire-element-id="431551">Vous constaterez que les actions engendrées par ces boutons devraient vous rappeler quelque chose. Aller, un petit effort ! :) <br/> Et oui, pour ceux qui auraient suivi, il s'agit d'évènements : cette notion est très souvent rattachable au patron de conception Observateur. Il va falloir revoir le concept s'il n'est pas maitrisé, vous n'y couperez pas.</p><p id="r-431552" data-claire-element-id="431552">Afin d'éclaircir le fonctionnement du tramway, je vous offre le schéma suivant :</p><figure id="r-431554" data-claire-element-id="431555"><img id="r-431553" data-claire-element-id="431553" src="medias/uploads.siteduzero.com_files_372001_373000_372033.png" alt="Interfaces pupitres"/></figure><p id="r-431556" data-claire-element-id="431556">On peut voir les pupitres de commandes que proposeront le tramway et la station.<br/> Selon la circonstance, ces boutons ne vont pas avoir le même comportement. Je vais décrire pour chaque situation comment le tramway devra réagir :<br/><em>tramway en déplacement sans arrêt prévu :</em></p><ul id="r-431565" data-claire-element-id="431565"><li id="r-431558" data-claire-element-id="431558"><p id="r-431557" data-claire-element-id="431557">L'impulsion du compteur de station n'a aucun effet.</p></li><li id="r-431560" data-claire-element-id="431560"><p id="r-431559" data-claire-element-id="431559">Le bouton d'arrêt d'urgence stoppe le tramway.</p></li><li id="r-431562" data-claire-element-id="431562"><p id="r-431561" data-claire-element-id="431561">Le bouton pour ouvrir les portes est désactivé.</p></li><li id="r-431564" data-claire-element-id="431564"><p id="r-431563" data-claire-element-id="431563">Le bouton pour demander le prochain arrêt fonctionne (du tramway ou de l’extérieur). Une pression sur celui-ci entraine le tramway en mode arrêt imminent.</p></li></ul><p id="r-431566" data-claire-element-id="431566"><em>tramway en déplacement avec arrêt prévu (arrêt imminent) :</em></p><ul id="r-431575" data-claire-element-id="431575"><li id="r-431568" data-claire-element-id="431568"><p id="r-431567" data-claire-element-id="431567">L'impulsion du compteur de station n'a aucun effet.</p></li><li id="r-431570" data-claire-element-id="431570"><p id="r-431569" data-claire-element-id="431569">Le bouton d'arrêt d'urgence stoppe le tramway.</p></li><li id="r-431572" data-claire-element-id="431572"><p id="r-431571" data-claire-element-id="431571">Le bouton pour ouvrir les portes est désactivé.</p></li><li id="r-431574" data-claire-element-id="431574"><p id="r-431573" data-claire-element-id="431573">Le bouton pour demander le prochain arrêt est inactif (du tramway ou de l’extérieur).</p></li></ul><p id="r-431576" data-claire-element-id="431576"><em>tramway en arrêt de station :</em></p><ul id="r-431585" data-claire-element-id="431585"><li id="r-431578" data-claire-element-id="431578"><p id="r-431577" data-claire-element-id="431577">L'impulsion du compteur de station va relancer le tramway.</p></li><li id="r-431580" data-claire-element-id="431580"><p id="r-431579" data-claire-element-id="431579">Le bouton d'arrêt d'urgence stoppe le tramway.</p></li><li id="r-431582" data-claire-element-id="431582"><p id="r-431581" data-claire-element-id="431581">Le bouton pour ouvrir les portes fonctionne.</p></li><li id="r-431584" data-claire-element-id="431584"><p id="r-431583" data-claire-element-id="431583">Le bouton pour demander le prochain arrêt est actif (du tramway ou de l’extérieur). Une pression sur celui-ci entraine le tramway en mode arrêt imminent dès qu'il repartira.</p></li></ul><p id="r-431586" data-claire-element-id="431586"><em>tramway en arrêt d'urgence :</em></p><ul id="r-431597" data-claire-element-id="431597"><li id="r-431588" data-claire-element-id="431588"><p id="r-431587" data-claire-element-id="431587">L'impulsion du compteur de station n'a aucun effet.</p></li><li id="r-431590" data-claire-element-id="431590"><p id="r-431589" data-claire-element-id="431589">Les demandes pour les prochaines stations sont effacées.</p></li><li id="r-431592" data-claire-element-id="431592"><p id="r-431591" data-claire-element-id="431591">Le bouton d'arrêt d'urgence rebascule le tramway dans un fonctionnement normal. Le wagon devra donc reprendre sa situation précédente (en déplacement ou en station).</p></li><li id="r-431594" data-claire-element-id="431594"><p id="r-431593" data-claire-element-id="431593">Le bouton pour ouvrir les portes fonctionne.</p></li><li id="r-431596" data-claire-element-id="431596"><p id="r-431595" data-claire-element-id="431595">Le bouton pour demander le prochain arrêt est désactivé (du tramway ou de l’extérieur).</p></li></ul><p id="r-431598" data-claire-element-id="431598"><em>Aussi, le tramway a la responsabilité de gérer :</em></p><ul id="r-431607" data-claire-element-id="431607"><li id="r-431600" data-claire-element-id="431600"><p id="r-431599" data-claire-element-id="431599">L'ouverture de ses portes.</p></li><li id="r-431602" data-claire-element-id="431602"><p id="r-431601" data-claire-element-id="431601">La fermeture de ses portes.</p></li><li id="r-431604" data-claire-element-id="431604"><p id="r-431603" data-claire-element-id="431603">Le démarrage du wagon pour aller vers la station suite ou pour repartir suite à un arrêt d'urgence..</p></li><li id="r-431606" data-claire-element-id="431606"><p id="r-431605" data-claire-element-id="431605">L'arrêt de son wagon, uniquement lorsqu'il arrive en station ou quand l'arrêt d'urgence est enclenché.</p></li></ul><aside id="r-431609" data-claire-element-id="431609" data-claire-semantic="warning"><p id="r-431608" data-claire-element-id="431608">Mais c'est une blague ton truc ?</p></aside><p id="r-431610" data-claire-element-id="431610">Ne soyez pas surpris, sous des apparences très simples, de tels systèmes peuvent vite receler des difficultés. Moi-même, j'ai déjà sous-estimé ce genre de problèmes. :D <br/> Bon, si vous lisez à tête reposée vous verrez que ce système n'est pas difficile à comprendre. Il y a même beaucoup de redondances dans l’énoncé mais je préfère être clair sur ce que j'attends du système. J'aurais pu complexifier le problème mais pour éviter de vous noyer sous une masse d'informations, on se contentera de ces éléments. Vous verrez qu'on a déjà de quoi cogiter !</p><p id="r-431611" data-claire-element-id="431611">Pour notre étude de cas, on ne va pas s'occuper du fonctionnement des pupitres de commandes, je vais juste vous donner leurs interfaces d'utilisation. Si vous ne le saviez pas, une interface permet aussi de pouvoir simuler des bouts de codes dont on ne possède pas l'implémentation. C'est très pratique si on veut simuler des environnements dont nous ne sommes pas toujours maîtres. Les éléments que je vous fournis sont les suivants :</p><figure id="r-431613" data-claire-element-id="431614"><img id="r-431612" data-claire-element-id="431612" src="medias/uploads.siteduzero.com_files_372001_373000_372710.png" alt="Diagramme classes CDC"/></figure><p id="r-431615" data-claire-element-id="431615">Diagramme de classes représentant les interfaces existantes. Ce n'est pas à vous de les implémenter.<br/> Le code à fournir va juste concerner la classe Tramway.</p><p id="r-431616" data-claire-element-id="431616">Pour éclaircir le fonctionnement du tramway, je vous propose un diagramme d'états-transitions. Il s'agit d'une version un peu dérivée de sa représentation formelle pour faciliter sa lecture à notre cas.</p><figure id="r-431618" data-claire-element-id="431619"><img id="r-431617" data-claire-element-id="431617" src="medias/uploads.siteduzero.com_files_372001_373000_372040.png" alt="Diagramme d'états"/></figure><table id="r-431692" data-claire-element-id="431692"><thead id="r-431627" data-claire-element-id="431627"><tr id="r-431626" data-claire-element-id="431626"><th id="r-431621" data-claire-element-id="431621"><p id="r-431620" data-claire-element-id="431620">Arc</p></th><th id="r-431623" data-claire-element-id="431623"><p id="r-431622" data-claire-element-id="431622">Évènement(s) déclencheur(s)</p></th><th id="r-431625" data-claire-element-id="431625"><p id="r-431624" data-claire-element-id="431624">Condition(s)</p></th></tr></thead><tbody id="r-431691" data-claire-element-id="431691"><tr id="r-431634" data-claire-element-id="431634"><td id="r-431629" data-claire-element-id="431629"><p id="r-431628" data-claire-element-id="431628">1</p></td><td id="r-431631" data-claire-element-id="431631"><p id="r-431630" data-claire-element-id="431630">arretProchaineStationDeclenche()<br/><strong><em>OU</em></strong> arretDepuisStationDemande()</p></td><td id="r-431633" data-claire-element-id="431633"><p id="r-431632" data-claire-element-id="431632">-</p></td></tr><tr id="r-431641" data-claire-element-id="431641"><td id="r-431636" data-claire-element-id="431636"><p id="r-431635" data-claire-element-id="431635">2</p></td><td id="r-431638" data-claire-element-id="431638"><p id="r-431637" data-claire-element-id="431637">tramwayPositionne()</p></td><td id="r-431640" data-claire-element-id="431640"><p id="r-431639" data-claire-element-id="431639">-</p></td></tr><tr id="r-431648" data-claire-element-id="431648"><td id="r-431643" data-claire-element-id="431643"><p id="r-431642" data-claire-element-id="431642">3</p></td><td id="r-431645" data-claire-element-id="431645"><p id="r-431644" data-claire-element-id="431644">departAutorise()</p></td><td id="r-431647" data-claire-element-id="431647"><p id="r-431646" data-claire-element-id="431646">portes fermées<br/> demande d'arrêt</p></td></tr><tr id="r-431655" data-claire-element-id="431655"><td id="r-431650" data-claire-element-id="431650"><p id="r-431649" data-claire-element-id="431649">4</p></td><td id="r-431652" data-claire-element-id="431652"><p id="r-431651" data-claire-element-id="431651">departAutorise()</p></td><td id="r-431654" data-claire-element-id="431654"><p id="r-431653" data-claire-element-id="431653">portes fermées</p></td></tr><tr id="r-431662" data-claire-element-id="431662"><td id="r-431657" data-claire-element-id="431657"><p id="r-431656" data-claire-element-id="431656">5</p></td><td id="r-431659" data-claire-element-id="431659"><p id="r-431658" data-claire-element-id="431658">arretUrgenceDeclenche()</p></td><td id="r-431661" data-claire-element-id="431661"><p id="r-431660" data-claire-element-id="431660">-</p></td></tr><tr id="r-431669" data-claire-element-id="431669"><td id="r-431664" data-claire-element-id="431664"><p id="r-431663" data-claire-element-id="431663">6</p></td><td id="r-431666" data-claire-element-id="431666"><p id="r-431665" data-claire-element-id="431665">arretUrgenceDeclenche()</p></td><td id="r-431668" data-claire-element-id="431668"><p id="r-431667" data-claire-element-id="431667">-</p></td></tr><tr id="r-431676" data-claire-element-id="431676"><td id="r-431671" data-claire-element-id="431671"><p id="r-431670" data-claire-element-id="431670">7</p></td><td id="r-431673" data-claire-element-id="431673"><p id="r-431672" data-claire-element-id="431672">arretUrgenceDeclenche()</p></td><td id="r-431675" data-claire-element-id="431675"><p id="r-431674" data-claire-element-id="431674">-</p></td></tr><tr id="r-431683" data-claire-element-id="431683"><td id="r-431678" data-claire-element-id="431678"><p id="r-431677" data-claire-element-id="431677">8</p></td><td id="r-431680" data-claire-element-id="431680"><p id="r-431679" data-claire-element-id="431679">arretUrgenceDeclenche()</p></td><td id="r-431682" data-claire-element-id="431682"><p id="r-431681" data-claire-element-id="431681">était en déplacement</p></td></tr><tr id="r-431690" data-claire-element-id="431690"><td id="r-431685" data-claire-element-id="431685"><p id="r-431684" data-claire-element-id="431684">9</p></td><td id="r-431687" data-claire-element-id="431687"><p id="r-431686" data-claire-element-id="431686">arretUrgenceDeclenche()</p></td><td id="r-431689" data-claire-element-id="431689"><p id="r-431688" data-claire-element-id="431688">était en station</p></td></tr></tbody></table><p id="r-431693" data-claire-element-id="431693">Diagramme d'états-transitions du tramway.</p><p id="r-431694" data-claire-element-id="431694">Si on s'attarde un peu sur ce schéma, il n'est pas difficile de le comprendre. Je vais prendre un exemple pour que vous compreniez comment le lire.<br/> Le tramway possède 4 états qui représentent ses différentes situations :</p><ul id="r-431703" data-claire-element-id="431703"><li id="r-431696" data-claire-element-id="431696"><p id="r-431695" data-claire-element-id="431695">Déplacement : Lorsque le tramway se déplace sur les rails.</p></li><li id="r-431698" data-claire-element-id="431698"><p id="r-431697" data-claire-element-id="431697">Arrêt imminent : Lorsque le tramway se déplace et qu'il doit s'arrêter à la prochaine station.</p></li><li id="r-431700" data-claire-element-id="431700"><p id="r-431699" data-claire-element-id="431699">Arrêt station : Lorsque le tramway est en train de déposer/récupérer des gens en station.</p></li><li id="r-431702" data-claire-element-id="431702"><p id="r-431701" data-claire-element-id="431701">Arrêt d'urgence : Lorsque le tramway a le mode &quot;arrêt d'urgence&quot; activé. Peut se produire à tout moment.</p></li></ul><p id="r-431704" data-claire-element-id="431704">Maintenant, admettons que le tramway se déplace sans que personne ne réclame l'arrêt pour la prochaine station (on se situe donc sur l'état Déplacement). Tout à coup, un utilisateur va demander un arrêt pour être déposé à la station qui arrive. L'évènement déclencheur <em>arretProchaineStationDeclenche()</em> est émis par l’intermédiaire du bouton prévu à cet effet. En jetant un œil au tableau, on peut voir que l'arc numéro 1 attend cet évènement. Il est de ce fait, possible d'emprunter cet arc (ou transition) pour se retrouver dans l'état qui est pointé : Arrêt imminent. Puisque je suis généreux, je vais encore vous offrir un schéma sur ce qui se passe :D :</p><figure id="r-431706" data-claire-element-id="431707"><img id="r-431705" data-claire-element-id="431705" src="medias/uploads.siteduzero.com_files_372001_373000_372239.png" alt="Exemple transition arc 1"/></figure><figure id="r-431709" data-claire-element-id="431710"><img id="r-431708" data-claire-element-id="431708" src="medias/uploads.siteduzero.com_files_372001_373000_372240.png" alt="Exemple transition arc 1, sur arc 2"/></figure><p id="r-431711" data-claire-element-id="431711">Exemple du passage de l'état &quot;Déplacement&quot; vers &quot;Arrêt imminent&quot;. L'arc est emprunté car la condition est satisfaite.<br/> C'est toujours la même logique à adopter pour passer d'état en état. Avec un peu de bon sens vous pouvez facilement comprendre ce diagramme, d'ailleurs je vous invite à le faire :) .</p><aside id="r-431713" data-claire-element-id="431713" data-claire-semantic="information"><p id="r-431712" data-claire-element-id="431712">Pour les gens qui connaissent les automates à états, vous ne serez pas déboussolé, c'est exactement le même principe. D'ailleurs, le diagramme d'états-transitions que j'ai représenté plus haut s'apparente plus à un automate qu'autre chose.</p></aside><p id="r-431714" data-claire-element-id="431714">Et vous dans tout ça :</p><p id="r-431715" data-claire-element-id="431715">Comme vous pouvez le constater, je vous ai donné pas mal d'informations. Vous n'avez qu'un seul objectif : <strong>Gérer le wagon du tramway, ne vous préoccupez pas du reste</strong>. Les seuls évènements dont vous serez la source, seront les ouvertures/fermetures de portes, le démarrage et le freinage. Pour les autres signaux, vous êtes juste &quot;observateurs&quot;.</p><p id="r-431716" data-claire-element-id="431716">A partir d'ici vous pouvez commencer à fournir vos propres solutions. Si vous ne savez pas par où commencer, le début de la partie suivante vous aiguillera.</p><p id="r-431717" data-claire-element-id="431717">Bonne chance ;)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">
<span class="arrow"></span>
<span class="next">Le patron de conception État (State)</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
<span class="next">Lançons nous</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lanonsnous"></a><h2>Lançons nous</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
<span class="arrow"></span>
<span class="next">Le tramway</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
<span class="next">Le pattern État nous vient en aide !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-lancons-nous" data-claire-element-id="431752">Lançons nous</h4><p id="r-431719" data-claire-element-id="431719">Pour bien commencer à attaquer le problème, on va implémenter les évènements déclenchés ou captés par le tramway en écrivant les interfaces respectives. On pose le socle du système pour ensuite nous intéresser à la partie essentielle de notre problème. Ainsi, on ne s’éparpille pas et on respecte les contraintes intrinsèques du système. Le code à écrire est le suivant :</p><pre id="r-431720" data-claire-element-id="431720"><code data-claire-semantic="cpp">class IEventsPupitreTramway
{
   public :
    virtual void arretUrgenceDeclenche() = 0;
    virtual void arretProchaineStationDeclenche() = 0;
    virtual void ouverturePorteDeclenche() = 0;
};

class IEventsPupitreStation
{
   public :
    virtual void arretDepuisStationDemande() = 0;
    virtual void tramwayPositionne() = 0;
    virtual void departAutorise() = 0;
};

class IEventsControleTramway
{
   public :
    virtual void ouvrirPortes() = 0;
    virtual void fermerPortes() = 0;
    virtual void stopperWagon() = 0;
    virtual void demarrerWagon() = 0;
};

class Tramway : public IEventsPupitreTramway, public IEventsPupitreStation
{
   
   public:
    virtual void arretUrgenceDeclenche()          { /* CODE ICI */ }
    virtual void arretProchaineStationDeclenche() { /* CODE ICI */ }
    virtual void ouverturePorteDeclenche()        { /* CODE ICI */ }
    virtual void arretDepuisStationDemande()      { /* CODE ICI */ }
    virtual void tramwayPositionne()              { /* CODE ICI */ }
    virtual void departAutorise()                 { /* CODE ICI */ }

   private:
    IEventsControleTramway m_controlesWagon;
}</code></pre><pre id="r-431721" data-claire-element-id="431721"><code data-claire-semantic="java">interface IEventsPupitreTramway
{
   public void arretUrgenceDeclenche();
   public void arretProchaineStationDeclenche();
   public void ouverturePorteDeclenche();
}

interface IEventsPupitreStation
{
   public void arretDepuisStationDemande();
   public void tramwayPositionne();
   public void departAutorise();
}

interface IEventsControleTramway
{
   public void ouvrirPortes();
   public void fermerPortes();
   public void stopperWagon();
   public void demarrerWagon();
}

class Tramway implements IEventsPupitreTramway, IEventsPupitreStation
{
    public void arretUrgenceDeclenche()          { /* CODE ICI */ }
    public void arretProchaineStationDeclenche() { /* CODE ICI */ }
    public void ouverturePorteDeclenche()        { /* CODE ICI */ }
    public void arretDepuisStationDemande()      { /* CODE ICI */ }
    public void tramwayPositionne()              { /* CODE ICI */ }
    public void departAutorise()                 { /* CODE ICI */ }

    private IEventsControleTramway m_controlesWagon;
}</code></pre><p id="r-431722" data-claire-element-id="431722">La chose la plus intuitive consiste à écrire les comportements directement dans la classe Tramway. Pour ce cas précis, il est même probablement judicieux de procéder de cette manière. Avec une bonne appréhension du sujet, on peut facilement écrire du code propre qui corresponde au cahier des charges. Il va cependant falloir conserver des informations utiles pour que le tramway adopte le bon comportement dans toutes les situations. Par exemple, lorsqu'il sort du mode arrêt d'urgence, le wagon doit savoir quelle était son action précédente (arrêt d'un station ou en déplacement). Un autre exemple : le tramway doit savoir à certains moments si il doit s'arrêter à la prochaine station mais ce ne sont pas les seules choses à sauvegarder.</p><p id="r-431723" data-claire-element-id="431723">Avec toutes ces astuces données, vous devriez être à même de vous lancer dans une implémentation. Pour réussir efficacement cette épreuve, respectez point par point cette étude de cas et vérifiez que chaque élément est respecté à la lettre.</p><p id="r-431724" data-claire-element-id="431724">Il est temps de vous mettre au travail ! (Mais qu'est-ce que c'est que ces mines dépitées, plus vite que ça moussaillon ! :pirate: ) Ne vous découragez pas, c'est en fait assez simple, pensez juste à tous les cas.</p><p id="r-431725" data-claire-element-id="431725">Passons à la correction. Une première version du code qui correspondrait aux différentes contraintes pourrait être :</p><pre id="r-431726" data-claire-element-id="431726"><code data-claire-semantic="cpp">#include &lt;iostream&gt;

using namespace std;

/**
 * Implémentation de l'interface IEventsControleTramway pour pouvoir faire des tests.
 * On se contente juste de redéfinir les opérations avec des affichages.
 */
class ControlesTramway : public IEventsControleTramway
{
   public:
    virtual void ouvrirPortes()  {cout &lt;&lt; &quot;Portes ouvertes.&quot; &lt;&lt; endl;}
    virtual void fermerPortes()  {cout &lt;&lt; &quot;Portes fermées.&quot; &lt;&lt; endl;}
    virtual void stopperWagon()  {cout &lt;&lt;  &quot;Le tramway freine jusqu'à son arrêt.&quot; &lt;&lt; endl;}
    virtual void demarrerWagon()  {cout &lt;&lt; &quot;Le tramway se lance en prenant de la vitesse.&quot; &lt;&lt; endl;}
};

class Tramway : public IEventsPupitreTramway, public IEventsPupitreStation
{
    public:
     /**
      * Constructeur, on va considérer que le train commence à l'état &quot;arrêt station&quot;.
      */
     Tramway() : m_portesOuvertes(false), m_enDeplacement(false),
         m_requeteProchaineStation(false), m_arretUrgenceEnclenche(false)
     {
         m_controlesWagon = new ControlesTramway();
     }

     virtual ~Tramway()
     {
        // DTOR
         delete m_controlesWagon;
     }

     /**
      * L'arrêt d'urgence doit savoir son état précédent pour adopter un comportement.
      * De plus, il faut savoir si l'évènement correspond à l'activation ou désactivation de l'urgence.
      */
     virtual void arretUrgenceDeclenche()
     {
         m_arretUrgenceEnclenche = !m_arretUrgenceEnclenche; // On déclare le nouvel état
         if(!m_arretUrgenceEnclenche)
         {
             if(m_portesOuvertes) // Les portes peuvent ne pas être ouvertes
                  m_controlesWagon-&gt;fermerPortes();
             if(m_enDeplacement)
                 m_controlesWagon-&gt;demarrerWagon();
         }
         else
         {
             m_controlesWagon-&gt;stopperWagon();
         }

     }

     virtual void arretProchaineStationDeclenche()
     {
         m_requeteProchaineStation = true;
         cout &lt;&lt; &quot;Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.&quot; &lt;&lt; endl;
     }

     virtual void arretDepuisStationDemande()
     {
         m_requeteProchaineStation = true;
         cout &lt;&lt; &quot;Appel utilisateur d'un arrêt à la prochaine station depuis la station.&quot; &lt;&lt; endl;
     }

     /**
      * L'ouverture des portes va s'assurer que le wagon n'est pas en déplacement ou que le
      * système est en arrêt d'urgence.
      */
     virtual void ouverturePorteDeclenche()
     {
         if(m_arretUrgenceEnclenche || !m_enDeplacement)
         {
             m_controlesWagon-&gt;ouvrirPortes(); // On ouvre les portes
             m_portesOuvertes = true;
         }
         else
         {
             cout &lt;&lt; &quot;Ouverture porte impossible.&quot; &lt;&lt; endl;
         }
     }


     /**
      * Le capteur de station émet un signal pour déclarer que le tramway doit commencer sa phase
      * d'arrêt si des requêtes sont à satisfaire.
      */
     virtual void tramwayPositionne()
     {
         if(m_requeteProchaineStation)
         {
             m_controlesWagon-&gt;stopperWagon();
             m_enDeplacement = false;

             m_requeteProchaineStation = false;
         }
         else
             cout &lt;&lt; &quot;Station passée sans s'arrêter.&quot; &lt;&lt; endl;
     }


     virtual void departAutorise()
     {
         m_controlesWagon-&gt;fermerPortes();
         m_controlesWagon-&gt;demarrerWagon();
         m_enDeplacement = true;
     }

    private:
     IEventsControleTramway *m_controlesWagon;
     bool m_portesOuvertes;
     bool m_enDeplacement;
     bool m_requeteProchaineStation;
     bool m_arretUrgenceEnclenche;
};

int main()
{
   Tramway tram;
   // On va simuler les évènements en les appelant manuellement.

   tram.arretDepuisStationDemande();
   tram.departAutorise();
   tram.tramwayPositionne();
   tram.ouverturePorteDeclenche();
   tram.departAutorise();
   tram.tramwayPositionne();
   tram.ouverturePorteDeclenche(); // Portes impossibles à ouvrir
   tram.tramwayPositionne();
   tram.arretUrgenceDeclenche();
   tram.ouverturePorteDeclenche();
   tram.arretUrgenceDeclenche();

   tram.arretProchaineStationDeclenche();
   tram.tramwayPositionne();

   return 0;
}</code></pre><pre id="r-431727" data-claire-element-id="431727"><code data-claire-semantic="java">/**
 * Implémentation de l'interface IEventsControleTramway pour pouvoir faire des tests.
 * On se contente juste de redéfinir les opérations avec des affichages.
 */
class ControlesTramway implements IEventsControleTramway
{
    public void ouvrirPortes() {System.out.println(&quot;Portes ouvertes.&quot;);}
    public void fermerPortes() {System.out.println(&quot;Portes fermées.&quot;);}
    public void stopperWagon() {System.out.println(&quot;Le tramway freine jusqu'à son arrêt.&quot;);}
    public void demarrerWagon() {System.out.println(&quot;Le tramway se lance en prenant de la vitesse.&quot;);}
}

class Tramway implements IEventsPupitreTramway, IEventsPupitreStation
{
    /**
     * Constructeur, on va considérer que le train commence à l'état arrêt station.
     */
    public Tramway()
    {
        // Ligne qui nécessite d'écrire une implémentation de IEventsControleTramway
        m_controlesWagon = new ControlesTramway(); 
        
        m_portesOuvertes = false;
        m_enDeplacement = false;
        m_requeteProchaineStation = false;
        m_arretUrgenceEnclenche = false;
    }
    
    public void arretUrgenceDeclenche()         
    { 
        m_arretUrgenceEnclenche = !m_arretUrgenceEnclenche; // On change l'état de l'arrêt d'urgence
        if(!m_arretUrgenceEnclenche)
        {
            if(m_portesOuvertes) // Les portes ne sont pas forcement ouvertes à ce moment là.
                m_controlesWagon.fermerPortes();
            if(m_enDeplacement)
                m_controlesWagon.demarrerWagon();
        }
        else
        {
            m_controlesWagon.stopperWagon();
        }
        
    }
    
    public void arretProchaineStationDeclenche()
    { 
        m_requeteProchaineStation = true;
        System.out.println(&quot;Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.&quot;);
    }
    
    public void arretDepuisStationDemande()      
    { 
        m_requeteProchaineStation = true;        
        System.out.println(&quot;Appel utilisateur d'un arrêt à la prochaine station depuis la station.&quot;);
    }
    
    /**
     * L'ouverture des portes va s'assurer que le wagon n'est pas en déplacement ou que le
     * système est en arrêt d'urgence.
     */
    public void ouverturePorteDeclenche()       
    {
        if(m_arretUrgenceEnclenche || !m_enDeplacement)
        {
            m_controlesWagon.ouvrirPortes(); // On ouvre les portes
            m_portesOuvertes = true;
        }
        else
        {
            System.out.println(&quot;Ouverture porte impossible.&quot;);
        }
    }
    
    
    /**
     * Le capteur de station émet un signal pour déclarer que le tramway doit commencer sa phase
     * d'arrêt si des requêtes sont à satisfaire.
     */
    public void tramwayPositionne()              
    {
        if(m_requeteProchaineStation)
        {
            m_controlesWagon.stopperWagon();
            m_enDeplacement = false;
            
            m_requeteProchaineStation = false;
        }
        else
            System.out.println(&quot;Station passée sans s'arrêter.&quot;);
    }
    
    public void departAutorise()                 
    {
        m_controlesWagon.fermerPortes();
        m_controlesWagon.demarrerWagon();
        m_enDeplacement = true;
    }

    private IEventsControleTramway m_controlesWagon;
    private boolean m_portesOuvertes;
    private boolean m_enDeplacement;
    private boolean m_requeteProchaineStation;
    private boolean m_arretUrgenceEnclenche;
}

public class Run {
    public static void main(String[] args) {
        Tramway tram = new Tramway();
        // On va simuler les évènements en les appelant manuellement.
        tram.arretDepuisStationDemande();
        tram.departAutorise();
        tram.tramwayPositionne();
        tram.ouverturePorteDeclenche();
        tram.departAutorise();
        tram.tramwayPositionne();
        tram.ouverturePorteDeclenche(); // Portes impossibles à ouvrir
        tram.tramwayPositionne();
        tram.arretUrgenceDeclenche();
        tram.ouverturePorteDeclenche();
        tram.arretUrgenceDeclenche();
        
        tram.arretProchaineStationDeclenche();
        tram.tramwayPositionne();
        
    }
}</code></pre><p id="r-431728" data-claire-element-id="431728">Ce qui affiche à l’exécution :</p><pre id="r-431729" data-claire-element-id="431729"><code data-claire-semantic="console">Appel utilisateur d'un arrêt à la prochaine station depuis la station.
Portes fermées.
Le tramway se lance en prenant de la vitesse.
Le tramway freine jusqu'à son arrêt.
Portes ouvertes.
Portes fermées.
Le tramway se lance en prenant de la vitesse.
Station passée sans s'arrêter.
Ouverture porte impossible.
Station passée sans s'arrêter.
Le tramway freine jusqu'à son arrêt.
Portes ouvertes.
Portes fermées.
Le tramway se lance en prenant de la vitesse.
Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.
Le tramway freine jusqu'à son arrêt.</code></pre><p id="r-431730" data-claire-element-id="431730">Plusieurs points notables sur le code :</p><ul id="r-431737" data-claire-element-id="431737"><li id="r-431732" data-claire-element-id="431732"><p id="r-431731" data-claire-element-id="431731">Il répond parfaitement à la problématique posée.</p></li><li id="r-431734" data-claire-element-id="431734"><p id="r-431733" data-claire-element-id="431733">Il est nécessaire de conserver la plupart des statuts du tramway à un instant &quot;t&quot; (les différents booléens dans notre classe).</p></li><li id="r-431736" data-claire-element-id="431736"><p id="r-431735" data-claire-element-id="431735">Le code est concis et sans réelle difficulté.</p></li></ul><div id="r-431739" data-claire-element-id="431739" data-claire-semantic="question"><p id="r-431738" data-claire-element-id="431738">Mais alors, quel est le problème ?</p></div><p id="r-431740" data-claire-element-id="431740">Souvenez vous qu'une majorité du temps est consacré à la correction de bogues ou à l'ajout de nouvelles fonctionnalités. Si dans notre cas, un ajout de fonctionnalité va se traduire par une modification de la classe tramway, il est difficile de faire autrement. On se concentrera donc plutôt sur l'aspect maintenance. Je ne sais pas pour vous, mais moi je trouve que le code que j'ai écrit est difficile à relire. En effet, les conditions et les états qui sont sauvegardés qui sont codés ne correspondent pas <strong>explicitement</strong> à mes spécifications. Pour moi, il est difficile de reprendre ce code car je dois m'imprégner de la logique du développeur qui n'est pas forcement évidente. Par exemple, regardez l'implémentation de la méthode ouverturePorteDemandee() : Les conditions écrites sont disséminées dans le sujet et pas si simple à retrouver. Dans le cas d'un contexte simple comme le tramway, l’intérêt de rendre plus compréhensible ce code est minime mais il faut se placer dans des cas plus complexes ou prévoir une évolution du système.</p><p id="r-431741" data-claire-element-id="431741">C'est pourquoi il est judicieux de réfléchir pour rendre notre code plus lisible. La solution qui serait très utile dans notre cas serait de calquer le code sur le diagramme d'états-transitions. Comment ? La première solution qui viendrait à l'esprit serait d'utiliser une énumération, on stockerait ensuite les états spécifiques du système :</p><pre id="r-431742" data-claire-element-id="431742"><code data-claire-semantic="cpp">class Tramway
{
   public : 
    enum Etat {DEPLACEMENT, ARRET_IMMINENT, ARRET_STATION, ARRET_URGENCE};

   private :
    Etat etatCourant;
   // ...
}</code></pre><pre id="r-431743" data-claire-element-id="431743"><code data-claire-semantic="java">class Tramway
{
   public enum Etat {DEPLACEMENT, ARRET_IMMINENT, ARRET_STATION, ARRET_URGENCE};
   private Etat etatCourant;
   // ...
}</code></pre><p id="r-431744" data-claire-element-id="431744">Le code pour exprimer les comportements du tramway deviennent ensuite beaucoup plus naturels et lisibles. La lecture s'en retrouve grandement simplifiée, je vous laisse juger par vous même :</p><pre id="r-431745" data-claire-element-id="431745"><code data-claire-semantic="cpp">class Tramway : public IEventsPupitreTramway, public IEventsPupitreStation
{

    public:
     enum Etat {DEPLACEMENT, ARRET_IMMINENT, ARRET_STATION, ARRET_URGENCE};
     /**
      * Constructeur, on va considérer que le train commence à l'état &quot;arrêt station&quot;.
      */
     Tramway() : m_etatCourant(ARRET_STATION), m_portesOuvertes(false)
     {
         m_controlesWagon = new ControlesTramway();
     }

     virtual ~Tramway()
     {
        // DTOR
         delete m_controlesWagon;
     }

     /**
      * L'arrêt d'urgence doit savoir son état précédent pour adopter un comportement.
      * De plus, il faut savoir si l'évènement correspond à l'activation ou désactivation de l'urgence.
      */
     virtual void arretUrgenceDeclenche()
     {

         if(m_etatCourant != ARRET_URGENCE)
         {
            m_etatPrecedentArretUrgence = m_etatCourant;
            m_etatCourant = ARRET_URGENCE;
         }
         else
         {
             m_etatCourant = m_etatPrecedentArretUrgence;
         }

         switch(m_etatCourant)
         {
            case ARRET_URGENCE :
               m_controlesWagon-&gt;stopperWagon();
               break;

            case DEPLACEMENT :
               if(m_portesOuvertes)
                  m_controlesWagon-&gt;fermerPortes();
               m_controlesWagon-&gt;demarrerWagon();
               break;

            case ARRET_STATION :
               m_controlesWagon-&gt;fermerPortes();
               break;

            default:
               m_controlesWagon-&gt;stopperWagon();
               // Il faudrait créer un nouveau type d'exception qui dérive d'Exception.
               throw &quot;Etat incohérent sur le bouton arrêt d'urgence&quot;;
         }
     }

     virtual void arretProchaineStationDeclenche()
     {
         m_etatCourant = ARRET_IMMINENT;
         cout &lt;&lt; &quot;Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.&quot; &lt;&lt; endl;
     }

     virtual void arretDepuisStationDemande()
     {
         m_etatCourant = ARRET_IMMINENT;
         cout &lt;&lt; &quot;Appel utilisateur d'un arrêt à la prochaine station depuis la station.&quot; &lt;&lt; endl;
     }

     /**
      * L'ouverture des portes va s'assurer que le wagon n'est pas en déplacement ou que le
      * système est en arrêt d'urgence.
      */
     virtual void ouverturePorteDeclenche()
     {
         switch(m_etatCourant)
         {
            case ARRET_URGENCE :
               m_controlesWagon-&gt;ouvrirPortes(); // On ouvre les portes
               m_portesOuvertes = true;
               break;

            case ARRET_STATION :
               m_controlesWagon-&gt;ouvrirPortes(); // On ouvre les portes
               m_portesOuvertes = true;
               break;

            default:
               cout &lt;&lt; &quot;Ouverture porte impossible.&quot; &lt;&lt; endl;
         }
     }


     /**
      * Le capteur de station émet un signal pour déclarer que le tramway doit commencer sa phase
      * d'arrêt si des requêtes sont à satisfaire.
      */
     virtual void tramwayPositionne()
     {
         switch(m_etatCourant)
         {
            case ARRET_IMMINENT :
               m_controlesWagon-&gt;stopperWagon();
               m_etatCourant = ARRET_STATION; // Changement d'état
               break;

            default:
               cout &lt;&lt; &quot;Station passée sans s'arrêter.&quot; &lt;&lt; endl;
         }
     }


     virtual void departAutorise()
     {
         m_controlesWagon-&gt;fermerPortes();
         m_controlesWagon-&gt;demarrerWagon();

         if(m_etatCourant == ARRET_STATION) // Aucune requête pour la prochaine station
            m_etatCourant = DEPLACEMENT; // Changement d'état
        // Sinon l'état a déjà été redéfini.
     }

    private:
     IEventsControleTramway *m_controlesWagon;
     Etat m_etatCourant;
     Etat m_etatPrecedentArretUrgence;
     bool m_portesOuvertes;
};</code></pre><pre id="r-431746" data-claire-element-id="431746"><code data-claire-semantic="java">class Tramway implements IEventsPupitreTramway, IEventsPupitreStation
{
    public enum Etat {DEPLACEMENT, ARRET_IMMINENT, ARRET_STATION, ARRET_URGENCE};
    
    /**
     * Constructeur, on va considérer que le train commence à l'état arrêt station.
     */
    public Tramway()
    {
        // Ligne qui nécessite d'écrire une implémentation de IEventsControleTramway
        m_controlesWagon = new ControlesTramway(); 
        m_etatCourant = Etat.ARRET_STATION;
        m_portesOuvertes = false;
    }
    
    public void arretUrgenceDeclenche() throws Exception         
    { 
        if(m_etatCourant != Etat.ARRET_URGENCE)
        {
           m_etatPrecedentArretUrgence = m_etatCourant;
           m_etatCourant = Etat.ARRET_URGENCE;
        }
        else
        {
            m_etatCourant = m_etatPrecedentArretUrgence;
        }

        switch(m_etatCourant)
        {
            case ARRET_URGENCE :
               m_controlesWagon.stopperWagon();
               break;
        
            case DEPLACEMENT :
               if(m_portesOuvertes)
                   m_controlesWagon.fermerPortes();
               m_controlesWagon.demarrerWagon();
               break;
        
            case ARRET_STATION :
               m_controlesWagon.fermerPortes();
               break;
        
            default:
               m_controlesWagon.stopperWagon();
              // Il faudrait créer un nouveau type d'exception qui dérive d'Exception.
              throw new Exception(&quot;Etat incohérent sur le bouton arrêt d'urgence&quot;);
        }
        
    }
    
    public void arretProchaineStationDeclenche()
    { 
        m_etatCourant = Etat.ARRET_IMMINENT;
        System.out.println(&quot;Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.&quot;);
    }
    
    public void arretDepuisStationDemande()      
    { 
        m_etatCourant = Etat.ARRET_IMMINENT;        
        System.out.println(&quot;Appel utilisateur d'un arrêt à la prochaine station depuis la station.&quot;);
    }
    
    /**
     * L'ouverture des portes va s'assurer que le wagon n'est pas en déplacement ou que le
     * système est en arrêt d'urgence.
     */
    public void ouverturePorteDeclenche()       
    {
        switch(m_etatCourant)
        {
            case ARRET_URGENCE :
               m_controlesWagon.ouvrirPortes(); // On ouvre les portes
               m_portesOuvertes = true;
               break;

            case ARRET_STATION :
               m_controlesWagon.ouvrirPortes(); // On ouvre les portes
               m_portesOuvertes = true;
               break;

            default:
               System.out.println(&quot;Ouverture porte impossible.&quot;);
        }
            
        
    }
    
    
    /**
     * Le capteur de station émet un signal pour déclarer que le tramway doit commencer sa phase
     * d'arrêt si des requêtes sont à satisfaire.
     */
    public void tramwayPositionne()              
    {
        switch(m_etatCourant)
        {
            case ARRET_IMMINENT :
               m_controlesWagon.stopperWagon();
               m_etatCourant = Etat.ARRET_STATION; // Changement d'état
               break;

            default:
               System.out.println(&quot;Station passée sans s'arrêter.&quot;);
        }
            
    }
    
    public void departAutorise()                 
    {
        m_controlesWagon.fermerPortes();
        m_controlesWagon.demarrerWagon();

        if(m_etatCourant == Etat.ARRET_STATION) // Aucune requête pour la prochaine station
           m_etatCourant = Etat.DEPLACEMENT; // Changement d'état
       // Sinon l'état a déjà été redéfini.
    }

    private IEventsControleTramway m_controlesWagon;
    private boolean m_portesOuvertes;
    private Etat m_etatCourant;
    private Etat m_etatPrecedentArretUrgence;
}</code></pre><p id="r-431747" data-claire-element-id="431747">Je sais pas pour vous, mais je trouve ce code beaucoup plus simple à appréhender. Même si le nombre de lignes augment quantité de code augmente, ce handicap est largement compensé par sa facilité de relecture. Par la même occasion, certains booléens ont disparu pour ne garder que les états du tramway. Notez donc qu'en changeant au minimum son approche, on se permet de se décoller d'une implémentation trop ciblée et on diminue les futurs prises de têtes. ^^ De plus, il est maintenant très facile de prendre en compte un nouvel état en rajouter le cas dans un switch.</p><p id="r-431748" data-claire-element-id="431748">Il y a tout de même quelque chose de gênant dans ce code ne reflétant toujours pas notre diagramme d'états-transition de manière naturelle. La retranscription fait surtout ressortir les arcs et non les états en eux-mêmes. Par exemple, il est difficile de savoir quand notre tramway se retrouve dans un état spécifique. En plus, si de nouveaux états ou arcs apparaissent, la classe Tramway va vite devenir énorme et être difficilement maintenable.</p><div id="r-431750" data-claire-element-id="431750" data-claire-semantic="question"><p id="r-431749" data-claire-element-id="431749">Bon et alors tu proposes quoi ? De déporter le code en dehors de cette classe ?</p></div><p id="r-431751" data-claire-element-id="431751">Si vous avez pensé de la sorte, vous êtes dans le juste. :) <br/> Le but est de pouvoir retranscrire fidèlement ce diagramme d'états-transitions (ou automate) en le découplant du Tramway. Seulement, il faut le faire de manière intelligente et c'est là que le design pattern État intervient.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
<span class="arrow"></span>
<span class="next">Le tramway</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
<span class="next">Le pattern État nous vient en aide !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lepatterntatnousvientenaide"></a><h2>Le pattern État nous vient en aide !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
<span class="arrow"></span>
<span class="next">Lançons nous</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-le-pattern-etat-nous-vient-en-aide" data-claire-element-id="431808">Le pattern État nous vient en aide !</h4><p id="r-431753" data-claire-element-id="431753">Le design pattern État porte bien son nom : Il intervient lorsqu'un diagramme d'états-transitions ou d'automates à états est possible. Le principe est simple, il doit être possible de représenter n'importe quel état et le traiter indifféremment d'un autre. Un état doit pouvoir recevoir des évènements qu'ils puissent les traiter et éventuellement muter vers d'autres états. On sent qu'une abstraction va être nécessaire pour représenter un &quot;état&quot; ! Voyons maintenant ce que propose ce patron de conception :</p><figure id="r-431755" data-claire-element-id="431756"><img id="r-431754" data-claire-element-id="431754" src="medias/uploads.siteduzero.com_files_373001_374000_373533.png" alt="Pattern état générique"/></figure><p id="r-431757" data-claire-element-id="431757">Diagramme de classes générique du design pattern état.<br/> Effectivement, annoncé de la sorte, ce n'est pas simple de comprendre comment l'utiliser. ^^ <br/> Je vais le transposer à notre cas pour que vous puissiez comprendre ce que signifie chaque élément du diagramme :</p><figure id="r-431759" data-claire-element-id="431760"><img id="r-431758" data-claire-element-id="431758" src="medias/uploads.siteduzero.com_files_373001_374000_373548.png" alt="Pattern état appliqué au problème"/></figure><p id="r-431761" data-claire-element-id="431761">Application du pattern à notre cas.<br/> Si vous vous attardez un petit peu sur le diagramme vous comprendrez très vite le principe. Le tramway va référencer l'automate (contexte) qui lui même va manipuler des états, peu importe lesquels. Lorsque le tramway reçoit un évènement, il en informe l'automate. Cet automate qui possède un seul état à tout instant va :</p><ul id="r-431766" data-claire-element-id="431766"><li id="r-431763" data-claire-element-id="431763"><p id="r-431762" data-claire-element-id="431762">Appeler sur l'état courant l'évènement associé. L'état effectuera alors des opérations sur le tramway.</p></li><li id="r-431765" data-claire-element-id="431765"><p id="r-431764" data-claire-element-id="431764">Éventuellement changer d'état courant si l'évènement le prévoit. L'opération changerEtat de la classe AutomateTramway permet de définir le nouvel état à prendre.</p></li></ul><p id="r-431767" data-claire-element-id="431767">Pour bien comprendre le fonctionnement, rien de mieux qu'un petit exemple. Imaginons que le tramway se situe dans l'état EtatDeplacement. Il reçoit l'évènement arretUrgenceDeclenche(). Le tramway va donc rediriger cet évènement sur son automate. L'automate va à son tour indiquer l'évènement sur son état en passant par l'interface EtatTramway. C'est l'état EtatDeplacement qui va traiter cette requête en effectuant l'arrêt du train et en transformant son état en EtatArretUrgence.</p><div id="r-431769" data-claire-element-id="431769" data-claire-semantic="question"><p id="r-431768" data-claire-element-id="431768">Mais pourquoi l'interface EtatTramway a besoin d'un paramètre AutomateTramway dans chacune de ses opérations ?</p></div><p id="r-431770" data-claire-element-id="431770">En fait, c'est la seule possibilité pour un état de de dire qu'il va laisser place à un autre. Il est obligé de remonter vers l'automate pour que ce dernier puisse changer vers le nouvel état à pointer. Si vous avez compris le principe, alors c'est gagné ! Voila ce que donne le diagramme UML complet :</p><figure id="r-431772" data-claire-element-id="431773"><img id="r-431771" data-claire-element-id="431771" src="medias/uploads.siteduzero.com_files_373001_374000_373590.png" alt="Pattern état final"/></figure><p id="r-431774" data-claire-element-id="431774">Un lien a été rajouté à l'automate permettant à un état de pouvoir agir sur les contrôles du tramway.</p><aside id="r-431776" data-claire-element-id="431776" data-claire-semantic="warning"><p id="r-431775" data-claire-element-id="431775">Les plus attentionnés auront remarqué qu'il y a un problème sur le diagramme. L'opération changerEtat() propose un service qui ne <strong>doit pas</strong> être accessibles en dehors du cadre de l'automate et de ses états. Le Tramway ne <strong>doit pas</strong> pouvoir changer un état de l'automate, <strong>seuls ces états sont habilités</strong> à faire ce changement.</p></aside><p id="r-431777" data-claire-element-id="431777">Sans rentrer dans les détails, il existe des moyens plus ou moins efficaces pour résoudre cet aléa. Voici une liste des possibilités :</p><ul id="r-431786" data-claire-element-id="431786"><li id="r-431779" data-claire-element-id="431779"><p id="r-431778" data-claire-element-id="431778">Laisser le code tel quel et rajouter un commentaire pour indiquer que l'opération est réservée pour un usage interne. <strong>Cette solution est à éviter autant que possible</strong>.</p></li><li id="r-431781" data-claire-element-id="431781"><p id="r-431780" data-claire-element-id="431780">On peut utiliser l'amitié pour donner des accès privilégiés à certaines classes. Cet artifice existe en C++ mais pas en Java par exemple.</p></li><li id="r-431783" data-claire-element-id="431783"><p id="r-431782" data-claire-element-id="431782">On peut découper l'application en packages ou namespaces et indiquer que certaines opérations sont isolées dans ces sous-couches et ne sont pas connues ailleurs. Cette fonctionnalité n'est pas présente dans tous les langages non plus.</p></li><li id="r-431785" data-claire-element-id="431785"><p id="r-431784" data-claire-element-id="431784">Enfin, on peut se servir du design pattern Visiteur qui peut s'utiliser dans tous les langages mais engendre une complexité supplémentaire. Cependant, ce pattern n'est pas prévu pour résoudre ce problème à la base.</p></li></ul><p id="r-431787" data-claire-element-id="431787">Pour éviter une surcharge du code, je me contenterai de la première solution mais elle est à proscrire autant que possible. Si je devais choisir une solution parmi les suivantes, mon choix se porterait sur l'amitié pour le code C++ et un découpage en packages pour la solution Java (avec l'automate et ses états dans un même package isolés du reste et dont l'opération changerEtat() serait en visibilité package).</p><p id="r-431788" data-claire-element-id="431788">Nous voilà enfin arrivés à l'implémentation. Je place le code dans une balise secret pour éviter de rallonger la page. En effet, la quantité de code augmente significativement avec cette solution.</p><p id="r-431789" data-claire-element-id="431789">Code C++ : Pour des raisons de déclarations anticipées obligatoires, je n'ai pas pu regrouper le code dans un seul fichier. J'ai donc donné le code découpé pour chaque fichier d'entête et du corps correspondant :<br/><strong>Code header C++ :</strong></p><div id="r-431791" data-claire-element-id="431791"><pre id="r-431790" data-claire-element-id="431790"><code data-claire-semantic="cpp">// ====================================
// FICHIER Interfaces.h
// ====================================
#ifndef INTERFACES_H_INCLUDED
#define INTERFACES_H_INCLUDED

class IEventsPupitreTramway
{
   public :
    virtual void arretUrgenceDeclenche() = 0;
    virtual void arretProchaineStationDeclenche() = 0;
    virtual void ouverturePorteDeclenche() = 0;
};

class IEventsPupitreStation
{
   public :
    virtual void arretDepuisStationDemande() = 0;
    virtual void tramwayPositionne() = 0;
    virtual void departAutorise() = 0;
};

class IEventsControleTramway
{
   public :
    virtual void ouvrirPortes() = 0;
    virtual void fermerPortes() = 0;
    virtual void stopperWagon() = 0;
    virtual void demarrerWagon() = 0;
};

class AutomateTramway; // Déclaration anticipée !
class EtatTramway
{
   public :
    virtual void arretProchaineStationDemandee(AutomateTramway &amp;c) = 0;
    virtual void arretDepuisStationDemande(AutomateTramway &amp;c) = 0;
    virtual void tramwayPositionne(AutomateTramway &amp;c) = 0;
    virtual void departAutorise(AutomateTramway &amp;c) = 0;
    virtual void arretUrgenceDeclenche(AutomateTramway &amp;c) = 0;
    virtual void ouverturePorteDeclenche(AutomateTramway &amp;c) = 0;
};
#endif // INTERFACES_H_INCLUDED

#ifndef TRAMWAY_H_INCLUDED
#define TRAMWAY_H_INCLUDED

// ====================================
// FICHIER Tramway.h
// ====================================
#include &quot;Interfaces.h&quot;

class Tramway : public IEventsPupitreTramway, public IEventsPupitreStation
{
   public :
    Tramway();

    virtual ~Tramway();

    IEventsControleTramway&amp; controles();

    virtual void arretDepuisStationDemande() ;
    virtual void tramwayPositionne();
    virtual void departAutorise();
    virtual void arretUrgenceDeclenche();
    virtual void arretProchaineStationDeclenche();
    virtual void ouverturePorteDeclenche();

   private :
    AutomateTramway *m_contexte;
    IEventsControleTramway *m_controlesWagon;
};
#endif // TRAMWAY_H_INCLUDED

// ====================================
// FICHIER AutomateTramway.h
// ====================================
#ifndef AUTOMATETRAMWAY_H_INCLUDED
#define AUTOMATETRAMWAY_H_INCLUDED

#include &quot;Interfaces.h&quot;

class AutomateTramway : public IEventsPupitreStation, public IEventsPupitreTramway
{
   public :
    AutomateTramway(IEventsControleTramway *referenceTram);

    IEventsControleTramway&amp; getControlesTramway();

    void changerEtat(EtatTramway *etat);

    virtual void arretUrgenceDeclenche();
    virtual void arretProchaineStationDeclenche() ;
    virtual void ouverturePorteDeclenche();
    virtual void arretDepuisStationDemande();
    virtual void tramwayPositionne();
    virtual void departAutorise();

   private :
    IEventsControleTramway *m_refCtrlTramway;
    EtatTramway *m_possedeEtat;
};
#endif // AUTOMATETRAMWAY_H_INCLUDED

// ====================================
// FICHIER EtatDeplacement.h
// ====================================
#ifndef ETATDEPLACEMENT_H_INCLUDED
#define ETATDEPLACEMENT_H_INCLUDED

#include &quot;Interfaces.h&quot;

class EtatDeplacement : public EtatTramway
{
   public :
    virtual void arretProchaineStationDemandee(AutomateTramway &amp;c);
    virtual void arretDepuisStationDemande(AutomateTramway &amp;c);
    virtual void arretUrgenceDeclenche(AutomateTramway &amp;c);
    virtual void tramwayPositionne(AutomateTramway &amp;c);
    virtual void ouverturePorteDeclenche(AutomateTramway &amp;c);
    virtual void departAutorise(AutomateTramway &amp;c);
};
#endif // ETATDEPLACEMENT_H_INCLUDED

// ====================================
// FICHIER EtatArretStation.h
// ====================================
#ifndef ETATARRETSTATION_H_INCLUDED
#define ETATARRETSTATION_H_INCLUDED

#include &quot;Interfaces.h&quot;

class EtatArretStation : public EtatTramway
{
   public :
    EtatArretStation();

    virtual void arretProchaineStationDemandee(AutomateTramway &amp;c);
    virtual void arretDepuisStationDemande(AutomateTramway &amp;c);
    virtual void arretUrgenceDeclenche(AutomateTramway &amp;c);
    virtual void departAutorise(AutomateTramway &amp;c);
    virtual void ouverturePorteDeclenche(AutomateTramway &amp;c);

    virtual void tramwayPositionne(AutomateTramway &amp;c);

    private :
     bool m_demandeProchainArret;
};
#endif // ETATARRETSTATION_H_INCLUDED

// ====================================
// FICHIER EtatArretImminent.h
// ====================================
#ifndef ETATARRETIMMINENT_H_INCLUDED
#define ETATARRETIMMINENT_H_INCLUDED

#include &quot;Interfaces.h&quot;


class EtatArretImminent : public EtatTramway
{
   public :
    virtual void arretUrgenceDeclenche(AutomateTramway &amp;c);
    virtual void tramwayPositionne(AutomateTramway &amp;c);
    virtual void ouverturePorteDeclenche(AutomateTramway &amp;c);
    virtual void arretProchaineStationDemandee(AutomateTramway &amp;c);
    virtual void departAutorise(AutomateTramway &amp;c);
    virtual void arretDepuisStationDemande(AutomateTramway &amp;c);
};
#endif // ETATARRETIMMINENT_H_INCLUDED

// ====================================
// FICHIER EtatArretUrgence.h
// ====================================
#ifndef ETATARRETURGENCE_H_INCLUDED
#define ETATARRETURGENCE_H_INCLUDED

#include &quot;Interfaces.h&quot;

class EtatArretUrgence : public EtatTramway
{
   public :
    EtatArretUrgence(EtatTramway *etatPrecedent) ;

    virtual void arretUrgenceDeclenche(AutomateTramway &amp;c);
    virtual void tramwayPositionne(AutomateTramway &amp;c);
    virtual void departAutorise(AutomateTramway &amp;c);
    virtual void arretProchaineStationDemandee(AutomateTramway &amp;c);
    virtual void arretDepuisStationDemande(AutomateTramway &amp;c);
    virtual void ouverturePorteDeclenche(AutomateTramway &amp;c);

   private :
    EtatTramway *m_etatPrecedent;
    bool m_portesOUvertes;
};
#endif // ETATARRETURGENCE_H_INCLUDED</code></pre></div><p id="r-431792" data-claire-element-id="431792"><strong>Code Corps C++ :</strong></p><div id="r-431794" data-claire-element-id="431794"><pre id="r-431793" data-claire-element-id="431793"><code data-claire-semantic="cpp">// ====================================
// FICHIER Tramway.cpp
// ====================================
#include &quot;Tramway.h&quot;

#include &quot;AutomateTramway.h&quot;

#include &lt;iostream&gt;

/**
 * Implémentation de l'interface IEventsControleTramway pour pouvoir faire des tests.
 * On se contente juste de redéfinir les opérations pour l'utiliser.
 */
class ControlesTramway : public IEventsControleTramway
{
   public:
    virtual void ouvrirPortes()  {std::cout &lt;&lt; &quot;Portes ouvertes.&quot; &lt;&lt; std::endl;}
    virtual void fermerPortes()  {std::cout &lt;&lt; &quot;Portes fermées.&quot; &lt;&lt; std::endl;}
    virtual void stopperWagon()  {std::cout &lt;&lt;  &quot;Le tramway freine jusqu'à son arrêt.&quot; &lt;&lt; std::endl;}
    virtual void demarrerWagon()  {std::cout &lt;&lt; &quot;Le tramway se lance en prenant de la vitesse.&quot; &lt;&lt; std::endl;}
};

Tramway::Tramway()
{
   m_controlesWagon = new ControlesTramway(); // Le pointeur devrait être testé !
   m_contexte = new AutomateTramway(m_controlesWagon);
}

Tramway::~Tramway()
{
   delete m_controlesWagon;
   delete m_contexte;
}

IEventsControleTramway&amp; Tramway::controles() { return *m_controlesWagon; }

void Tramway::arretDepuisStationDemande()
{
   m_contexte-&gt;arretDepuisStationDemande();
   std::cout &lt;&lt; &quot;Appel utilisateur d'un arrêt à la prochaine station depuis la station.&quot; &lt;&lt; std::endl;
}

void Tramway::tramwayPositionne() { m_contexte-&gt;tramwayPositionne(); }
void Tramway::departAutorise() { m_contexte-&gt;departAutorise(); }
void Tramway::arretUrgenceDeclenche() {m_contexte-&gt;arretUrgenceDeclenche(); }
void Tramway::arretProchaineStationDeclenche()
{
     m_contexte-&gt;arretProchaineStationDeclenche();
     std::cout &lt;&lt; &quot;Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.&quot; &lt;&lt; std::endl;
}
void Tramway::ouverturePorteDeclenche() { m_contexte-&gt;ouverturePorteDeclenche(); }

// ====================================
// FICHIER AutomateTramway.cpp
// ====================================
#include &quot;AutomateTramway.h&quot;

#include &quot;EtatArretStation.h&quot;

AutomateTramway::AutomateTramway(IEventsControleTramway *referenceTram) : m_refCtrlTramway(referenceTram)
{
   m_possedeEtat = new EtatArretStation();
}

AutomateTramway::~AutomateTramway()
{
   delete m_possedeEtat;
}

IEventsControleTramway &amp;AutomateTramway::getControlesTramway() { return *m_refCtrlTramway; }

void AutomateTramway::changerEtat(EtatTramway *etat)
{
    delete m_possedeEtat;
    m_possedeEtat = etat;
}

void AutomateTramway::arretUrgenceDeclenche() { m_possedeEtat-&gt;arretUrgenceDeclenche(*this);   }
void AutomateTramway::arretProchaineStationDeclenche() { m_possedeEtat-&gt;arretProchaineStationDemandee(*this);}
void AutomateTramway::ouverturePorteDeclenche() { m_possedeEtat-&gt;ouverturePorteDeclenche(*this);   }
void AutomateTramway::arretDepuisStationDemande() { m_possedeEtat-&gt;arretDepuisStationDemande(*this);   }
void AutomateTramway::tramwayPositionne() { m_possedeEtat-&gt;tramwayPositionne(*this); }
void AutomateTramway::departAutorise() { m_possedeEtat-&gt;departAutorise(*this); }

// ====================================
// FICHIER EtatDeplacement.cpp
// ====================================
#include &quot;EtatDeplacement.h&quot;

#include &quot;AutomateTramway.h&quot;
#include &quot;EtatArretImminent.h&quot;
#include &quot;EtatArretUrgence.h&quot;

#include &lt;iostream&gt;

void EtatDeplacement::arretProchaineStationDemandee(AutomateTramway &amp;c)
{
   c.changerEtat(new EtatArretImminent());
}

void EtatDeplacement::arretDepuisStationDemande(AutomateTramway &amp;c)
{
   c.changerEtat(new EtatArretImminent());
}

void EtatDeplacement::arretUrgenceDeclenche(AutomateTramway &amp;c)
{
   c.getControlesTramway().stopperWagon();
   c.changerEtat(new EtatArretUrgence(this));
}

void EtatDeplacement::tramwayPositionne(AutomateTramway &amp;c)
{ std::cout &lt;&lt; &quot;Station passée sans s'arrêter.&quot; &lt;&lt; std::endl; }

void EtatDeplacement::ouverturePorteDeclenche(AutomateTramway &amp;c)
{ std::cout &lt;&lt; &quot;Ouverture porte impossible.&quot; &lt;&lt; std::endl; }

void EtatDeplacement::departAutorise(AutomateTramway &amp;c) { /* RIEN */ }


// ====================================
// FICHIER EtatArretStation.cpp
// ====================================
#include &quot;EtatArretStation.h&quot;

#include &quot;AutomateTramway.h&quot;
#include &quot;EtatArretUrgence.h&quot;
#include &quot;EtatArretImminent.h&quot;
#include &quot;EtatDeplacement.h&quot;

EtatArretStation::EtatArretStation() : m_demandeProchainArret(false)
{

}

void EtatArretStation::arretProchaineStationDemandee(AutomateTramway &amp;c)
{
   m_demandeProchainArret = true;
}

void EtatArretStation::arretDepuisStationDemande(AutomateTramway &amp;c)
{
   m_demandeProchainArret = true;
}

void EtatArretStation::arretUrgenceDeclenche(AutomateTramway &amp;c)
{
   c.getControlesTramway().stopperWagon();
   c.changerEtat(new EtatArretUrgence(this));
}

void EtatArretStation::departAutorise(AutomateTramway &amp;c)
{
   c.getControlesTramway().fermerPortes();
   c.getControlesTramway().demarrerWagon();
   if(m_demandeProchainArret)
      c.changerEtat(new EtatArretImminent());
   else
      c.changerEtat(new EtatDeplacement());
}

void EtatArretStation::ouverturePorteDeclenche(AutomateTramway &amp;c)
{
    c.getControlesTramway().ouvrirPortes();
}

void EtatArretStation::tramwayPositionne(AutomateTramway &amp;c) { /* RIEN */ }

// ====================================
// FICHIER EtatArretImminent.cpp
// ====================================
#include &quot;EtatArretImminent.h&quot;

#include &quot;AutomateTramway.h&quot;
#include &quot;EtatArretStation.h&quot;
#include &quot;EtatArretUrgence.h&quot;

#include &lt;iostream&gt;

void EtatArretImminent::arretUrgenceDeclenche(AutomateTramway &amp;c)
{
   c.getControlesTramway().stopperWagon();
   c.changerEtat(new EtatArretUrgence(this));
}

void EtatArretImminent::tramwayPositionne(AutomateTramway &amp;c)
{
   c.getControlesTramway().stopperWagon();
   c.changerEtat(new EtatArretStation());
}

void EtatArretImminent::ouverturePorteDeclenche(AutomateTramway &amp;c)
{ std::cout &lt;&lt; &quot;Ouverture porte impossible.&quot; &lt;&lt; std::endl; }

void EtatArretImminent::arretProchaineStationDemandee(AutomateTramway &amp;c)  { /* RIEN */ }
void EtatArretImminent::departAutorise(AutomateTramway &amp;c) { /* RIEN */ }
void EtatArretImminent::arretDepuisStationDemande(AutomateTramway &amp;c)  { /* RIEN */ }

// ====================================
// FICHIER EtatArretUrgence.cpp
// ====================================
#include &quot;EtatArretUrgence.h&quot;

#include &quot;AutomateTramway.h&quot;

EtatArretUrgence::EtatArretUrgence(EtatTramway *etatPrecedent) : m_etatPrecedent(etatPrecedent),
   m_portesOUvertes(false)
{

}

void EtatArretUrgence::arretUrgenceDeclenche(AutomateTramway &amp;c)
{
   if(m_portesOUvertes)
      c.getControlesTramway().fermerPortes();
   c.getControlesTramway().demarrerWagon();
   c.changerEtat(m_etatPrecedent);
}

void EtatArretUrgence::tramwayPositionne(AutomateTramway &amp;c) { /* RIEN */ }
void EtatArretUrgence::departAutorise(AutomateTramway &amp;c) { /* RIEN */ }
void EtatArretUrgence::arretProchaineStationDemandee(AutomateTramway &amp;c) { /* RIEN */ }
void EtatArretUrgence::arretDepuisStationDemande(AutomateTramway &amp;c) { /* RIEN */ }

void EtatArretUrgence::ouverturePorteDeclenche(AutomateTramway &amp;c)
{
   c.getControlesTramway().ouvrirPortes();
   m_portesOUvertes = true;
}

// ====================================
// FICHIER main.cpp
// ====================================
#include &quot;Tramway.h&quot;

using namespace std;

int main()
{
   Tramway tram;
   // On va simuler les évènements en les appelant manuellement.

   tram.arretDepuisStationDemande();
   tram.departAutorise();
   tram.tramwayPositionne();
   tram.ouverturePorteDeclenche();
   tram.departAutorise();
   tram.tramwayPositionne();
   tram.ouverturePorteDeclenche(); // Portes impossibles à ouvrir
   tram.tramwayPositionne();
   tram.arretUrgenceDeclenche();
   tram.ouverturePorteDeclenche();
   tram.arretUrgenceDeclenche();

   tram.arretProchaineStationDeclenche();
   tram.tramwayPositionne();

   return 0;
}</code></pre></div><p id="r-431795" data-claire-element-id="431795"><strong>Code Java :</strong></p><div id="r-431797" data-claire-element-id="431797"><pre id="r-431796" data-claire-element-id="431796"><code data-claire-semantic="java">interface IEventsPupitreTramway
{
   public void arretUrgenceDeclenche();
   public void arretProchaineStationDeclenche();
   public void ouverturePorteDeclenche();
}

interface IEventsPupitreStation
{
   public void arretDepuisStationDemande();
   public void tramwayPositionne();
   public void departAutorise();
}

interface IEventsControleTramway
{
   public void ouvrirPortes();
   public void fermerPortes();
   public void stopperWagon();
   public void demarrerWagon();
}


interface EtatTramway 
{ 
   public void arretProchaineStationDemandee(AutomateTramway c);
   public void arretDepuisStationDemande(AutomateTramway c);
   public void tramwayPositionne(AutomateTramway c);
   public void departAutorise(AutomateTramway c);
   public void arretUrgenceDeclenche(AutomateTramway c);
   public void ouverturePorteDeclenche(AutomateTramway c);
}



class ControlesTramway implements IEventsControleTramway
{
    public void ouvrirPortes() {System.out.println(&quot;Portes ouvertes.&quot;);}
    public void fermerPortes() {System.out.println(&quot;Portes fermées.&quot;);}
    public void stopperWagon() {System.out.println(&quot;Le tramway freine jusqu'à son arrêt.&quot;);}
    public void demarrerWagon() {System.out.println(&quot;Le tramway se lance en prenant de la vitesse.&quot;);}
}

class Tramway implements IEventsPupitreTramway, IEventsPupitreStation 
{
   public Tramway()
   {
      m_controlesWagon = new ControlesTramway();
      m_contexte = new AutomateTramway(m_controlesWagon);
   }
   
   public IEventsControleTramway controles() { return m_controlesWagon; }

   public void arretDepuisStationDemande() 
   {
      m_contexte.arretDepuisStationDemande(); 
      System.out.println(&quot;Appel utilisateur d'un arrêt à la prochaine station depuis la station.&quot;);
   }
   public void tramwayPositionne() { m_contexte.tramwayPositionne(); }
   public void departAutorise() { m_contexte.departAutorise(); }
   public void arretUrgenceDeclenche() {m_contexte.arretUrgenceDeclenche(); }
   public void arretProchaineStationDeclenche() 
   { 
      m_contexte.arretProchaineStationDeclenche(); 
      System.out.println(&quot;Appel utilisateur d'un arrêt à la prochaine station depuis le wagon.&quot;); 
   }
   public void ouverturePorteDeclenche() { m_contexte.ouverturePorteDeclenche(); }
      
   private AutomateTramway m_contexte;
   private IEventsControleTramway m_controlesWagon;
}

class AutomateTramway implements IEventsPupitreStation, IEventsPupitreTramway
{
   public AutomateTramway(IEventsControleTramway referenceTram)
   {
      m_refCtrlTramway = referenceTram;
      m_possedeEtat = new EtatArretStation();
   }
   
   public IEventsControleTramway getControlesTramway() { return m_refCtrlTramway; }
   
   public void changerEtat(EtatTramway etat) { m_possedeEtat = etat; }
   public void arretUrgenceDeclenche() { m_possedeEtat.arretUrgenceDeclenche(this);   }
   public void arretProchaineStationDeclenche() { m_possedeEtat.arretProchaineStationDemandee(this);}
   public void ouverturePorteDeclenche() { m_possedeEtat.ouverturePorteDeclenche(this);   }
   public void arretDepuisStationDemande() { m_possedeEtat.arretDepuisStationDemande(this);   }
   public void tramwayPositionne() { m_possedeEtat.tramwayPositionne(this); }
   public void departAutorise() { m_possedeEtat.departAutorise(this); }
   
   private IEventsControleTramway m_refCtrlTramway;
   private EtatTramway m_possedeEtat;
}


class EtatDeplacement implements EtatTramway 
{
   public void arretProchaineStationDemandee(AutomateTramway c) 
   {
      c.changerEtat(new EtatArretImminent());
   }

   public void arretDepuisStationDemande(AutomateTramway c) 
   {
      c.changerEtat(new EtatArretImminent());
   }
   
   public void arretUrgenceDeclenche(AutomateTramway c) 
   {
      c.getControlesTramway().stopperWagon();
      c.changerEtat(new EtatArretUrgence(this));
   }

   public void tramwayPositionne(AutomateTramway c) 
   { 
      System.out.println(&quot;Station passée sans s'arrêter.&quot;); 
   }
   
   public void ouverturePorteDeclenche(AutomateTramway c) 
   { 
      System.out.println(&quot;Ouverture porte impossible.&quot;);
   }
   
   public void departAutorise(AutomateTramway c) { /* RIEN */ }
}

class EtatArretUrgence implements EtatTramway 
{
   public EtatArretUrgence(EtatTramway etatPrecedent)
   {
      m_etatPrecedent = etatPrecedent;
      m_portesOUvertes = false;
   }
   
   public void arretUrgenceDeclenche(AutomateTramway c) 
   {
      if(m_portesOUvertes)
         c.getControlesTramway().fermerPortes();
      c.getControlesTramway().demarrerWagon();
      c.changerEtat(m_etatPrecedent);
   }

   public void tramwayPositionne(AutomateTramway c) { /* RIEN */ }
   public void departAutorise(AutomateTramway c) { /* RIEN */ }
   public void arretProchaineStationDemandee(AutomateTramway c) { /* RIEN */ }
   public void arretDepuisStationDemande(AutomateTramway c) { /* RIEN */ }
   
   public void ouverturePorteDeclenche(AutomateTramway c) 
   { 
      c.getControlesTramway().ouvrirPortes();
      m_portesOUvertes = true;
   }
   
   private EtatTramway m_etatPrecedent;
   private boolean m_portesOUvertes;
}

class EtatArretImminent implements EtatTramway
{
   public void arretUrgenceDeclenche(AutomateTramway c) 
   {
      c.getControlesTramway().stopperWagon();
      c.changerEtat(new EtatArretUrgence(this));
   }

   public void tramwayPositionne(AutomateTramway c) 
   { 
      c.getControlesTramway().stopperWagon();
      c.changerEtat(new EtatArretStation());
   }
   
   public void ouverturePorteDeclenche(AutomateTramway c) 
   { 
      System.out.println(&quot;Ouverture porte impossible.&quot;); 
   }
   
   public void arretProchaineStationDemandee(AutomateTramway c)  { /* RIEN */ }
   public void departAutorise(AutomateTramway c) { /* RIEN */ }
   public void arretDepuisStationDemande(AutomateTramway c)  { /* RIEN */ }
}

class EtatArretStation implements EtatTramway 
{
   public EtatArretStation()
   {
      m_demandeProchainArret = false;
   }
   
   public void arretProchaineStationDemandee(AutomateTramway c)  
   {
      m_demandeProchainArret = true; 
   }
   
   public void arretDepuisStationDemande(AutomateTramway c) 
   {
      m_demandeProchainArret = true; 
   }
   
   public void arretUrgenceDeclenche(AutomateTramway c) 
   {
      c.getControlesTramway().stopperWagon();
      c.changerEtat(new EtatArretUrgence(this));
   }

   public void departAutorise(AutomateTramway c) 
   { 
      c.getControlesTramway().fermerPortes();
      c.getControlesTramway().demarrerWagon();
      if(m_demandeProchainArret)
         c.changerEtat(new EtatArretImminent());
      else
         c.changerEtat(new EtatDeplacement());
   }
   
   public void ouverturePorteDeclenche(AutomateTramway c) 
   { 
      c.getControlesTramway().ouvrirPortes(); 
   }
   
   public void tramwayPositionne(AutomateTramway c) { /* RIEN */ }
   
   private boolean m_demandeProchainArret;
}

public class Run {
    public static void main(String[] args) {
        Tramway tram = new Tramway();
        // On va simuler les évènements en les appelant manuellement.
        tram.arretDepuisStationDemande();
        tram.departAutorise();
        tram.tramwayPositionne();
        tram.ouverturePorteDeclenche();
        tram.departAutorise();
        tram.tramwayPositionne();
        tram.ouverturePorteDeclenche(); // Portes impossibles à ouvrir
        tram.tramwayPositionne();
        tram.arretUrgenceDeclenche();
        tram.ouverturePorteDeclenche();
        tram.arretUrgenceDeclenche();
        
        tram.arretProchaineStationDeclenche();
        tram.tramwayPositionne();  
    }
}</code></pre></div><p id="r-431798" data-claire-element-id="431798">La quantité de code a vraiment grimpé. Première constatation : La mise en place du design pattern a souvent pour conséquence d'engendrer des classes en plus, complexifiant le code. L'avantage principal ici est qu'en connaissant comment s'utilise le patron de conception État, on peut facilement trouver et corriger les problèmes car les classes ont des rôles très spécifiques et bien déterminés. L'autre aspect déterminant que l'on peut soulever, est le fait qu'on puisse traduire de manière fidèle un automate à états ou un diagramme d'états-transitions. Si une nouvelle transition ou un nouvel état apparait, il est simple de le rajouter.</p><p id="r-431799" data-claire-element-id="431799">Si vous trouvez que le code du dessus vous parait difficile, voilà une petite aide sur la procédure. Vous verrez qu'en fait c'est très simple à partir de mon diagramme d'états-transitions de retranscrire le modèle. Si on reprend le croquis :</p><figure id="r-431801" data-claire-element-id="431802"><img id="r-431800" data-claire-element-id="431800" src="medias/uploads.siteduzero.com_files_372001_373000_372040.png" alt="Diagramme d'états"/></figure><p id="r-431803" data-claire-element-id="431803">Rappel du diagramme.<br/> Il suffit de se placer sur un état particulier. Prenons par exemple l'état &quot;Arrêt station&quot; qui possède les origines des arcs &quot;3&quot;, &quot;4&quot;, et &quot;7&quot;. En regardant le tableau correspondant dans la première partie, on peut voir les évènements déclencheurs sur chacun de ces arcs. Chaque arc implique d'implémenter une opération pour un évènement donné. Si on suit notre exemple, l'arc &quot;3&quot; possède comme évènement déclencheur departAutorise(), on devra donc écrire le comportement de cette opération dans l'état &quot;Arrêt station&quot;. Dans cette opération, le changement d'état vers &quot;Arrêt imminent&quot; sera à effectuer si les conditions sont respectées. En regardant le code, la retranscription apparait très distinctement. ;)</p><p id="r-431804" data-claire-element-id="431804">Pour conclure sur le design pattern État, retenez que c'est un modèle intéressant pour représenter un problème spécifique. C'est un bon exemple qui vous montre que les patrons de conception ne sont pas tous synonymes de réponses à des problèmes quotidiens. Maintenant, si vous tombez sur ce genre de situation, son implémentation ne sera plus un casse tête. N'apprenez pas la solution par cœur, sachez à quelle problématique répond ce pattern et une recherche sur internet vous indiquera la marche à suivre. Le but est justement de pouvoir rechercher facilement ces modèles. D'ailleurs, c'est ce que moi même j'ai fait pour la rédaction de ce chapitre. ;)</p><p id="r-431805" data-claire-element-id="431805">Ouf, en voilà un chapitre plutôt chargé ! Si la lecture vous a été profitable je n'en serai que plus heureux. Nous allons revenir sur des patrons de conception à utilisation plus courants.</p><p id="r-431806" data-claire-element-id="431806">La suite pour bientôt...</p><p id="r-431807" data-claire-element-id="431807">Pas de conclusion pour l'instant</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi">Programmation objet avancée : la conception avant tout (design patterns à l&#039;emploi)</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Le paradigme objet
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/introduction-a-ce-cours">Introduction à ce cours</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/cycle-simplifie-d-un-projet">
Cycle simplifié d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-conception-votre-meilleure-amie">
La conception, votre meilleure amie
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/comment-bien-concevoir">
Comment bien concevoir
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/adoptez-la-philosophie-de-l-objet">Adoptez la philosophie de l&#039;objet</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/offrez-du-service">
Offrez du service
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-encapsulation-regne-en-maitre">
L&#039;encapsulation règne en maitre !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/responsabilite-limitee">
Responsabilité limitée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/privilegiez-la-composition-a-l-heritage">
Privilegiez la composition à l&#039;héritage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pensez-interface">
Pensez interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/la-sensibilite-de-l-objet-a-subir-des-modifications">
La sensibilité de l&#039;objet à subir des modifications
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/pour-aller-plus-loin-35">
Pour aller plus loin
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Commençons en douceur
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-observateur-observer">Le patron de conception Observateur (Observer)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/posons-le-probleme-4">
Posons le problème
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/resolvons-progressivement-notre-cas">
Résolvons progressivement notre cas
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/l-observateur">
L&#039;observateur
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-patron-de-conception-etat-state">Le patron de conception État (State)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-tramway">
Le tramway
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
Lançons nous
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/le-pattern-etat-nous-vient-en-aide">
Le pattern État nous vient en aide !
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/programmation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi/lancons-nous">
<span class="arrow"></span>
<span class="next">Lançons nous</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/rogrammation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 05:51:44 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/rogrammation-objet-avancee-la-conception-avant-tout-design-patterns-a-l-emploi.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:03:49 GMT -->
</html>