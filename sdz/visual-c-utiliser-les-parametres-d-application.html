<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/visual-c-utiliser-les-parametres-d-application.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 03:09:44 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/visual-c-utiliser-les-parametres-d-application.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:41:50 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : [Visual C#] Utiliser les paramètres d&#039;application</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : [Visual C#] Utiliser les paramètres d&#039;application</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#VisualCUtiliserlesparamtresd039application">[Visual C#] Utiliser les paramètres d&#039;application</a><br/><a href="#Lesfichiersdeconfiguration">Les fichiers de configuration</a><br/><a href="#Soyezprt">Soyez prêt !</a><br/><a href="#Utiliserlesparamtresd039application">Utiliser les paramètres d&#039;application !</a><br/></div>
<a name="VisualCUtiliserlesparamtresd039application"></a><h2>[Visual C#] Utiliser les paramètres d&#039;application</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/les-fichiers-de-configuration">
<span class="next">Les fichiers de configuration</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-572416" data-claire-element-id="572416">Salut à tous et bienvenue dans ce tutoriel !</p><p id="r-572417" data-claire-element-id="572417">Vous avez besoin de stocker des données sans utiliser <a href="http://www.siteduzero.com/tutoriel-3-35426-utilisez-les-bases-de-donnees-dans-vos-programmes-c.html">les bases de données</a> (SQL et LINQ) ? <br/> Vous êtes débutant et vous connaissez les bases du langage C# ?</p><p id="r-572418" data-claire-element-id="572418">Dans ce cas, ce tutoriel est fait pour vous !</p>
</div><a name="Lesfichiersdeconfiguration"></a><h2>Les fichiers de configuration</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
<span class="next">Soyez prêt !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-572419" data-claire-element-id="572419">Les <strong>paramètres d'application</strong> sont des données comprises dans des <strong>fichiers de configuration</strong> qui sont écrits en <strong>XML</strong>.</p><aside id="r-572421" data-claire-element-id="572421" data-claire-semantic="warning"><p id="r-572420" data-claire-element-id="572420">Attention, ne pas confondre fichiers de configuration et paramètres d'application !</p></aside><p id="r-572422" data-claire-element-id="572422">Si vous ne savez pas ce qu'est le XML, voici un exemple de code :</p><pre id="r-572423" data-claire-element-id="572423"><code data-claire-semantic="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;configuration&gt;
    &lt;configSections&gt;
        &lt;sectionGroup name=&quot;userSettings&quot; type=&quot;System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; &gt;
            &lt;section name=&quot;Tutoriel.Properties.Settings&quot; type=&quot;System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; allowExeDefinition=&quot;MachineToLocalUser&quot; requirePermission=&quot;false&quot; /&gt;
        &lt;/sectionGroup&gt;
    &lt;/configSections&gt;
    &lt;userSettings&gt;
        &lt;Tutoriel.Properties.Settings&gt;
            &lt;setting name=&quot;Setting&quot; serializeAs=&quot;String&quot;&gt;
                &lt;value&gt;Ceci est un exemple d'utilisation de notre fichier XML pour une application C# !&lt;/value&gt;
            &lt;/setting&gt;
        &lt;/Tutoriel.Properties.Settings&gt;
    &lt;/userSettings&gt;
&lt;/configuration&gt;</code></pre><p id="r-572424" data-claire-element-id="572424">Pour de plus amples informations sur XML, vous pouvez lire <a href="http://www.siteduzero.com/tutoriel-3-33440-le-point-sur-xml.html">le tutoriel de Tangui</a> qui l'explique en détail.</p><p id="r-572425" data-claire-element-id="572425">Vous verrez plus tard, dans la troisième partie, comment utiliser ces fichiers par l'intermédiaire de C#. Je tiens à préciser que le <strong>.NET Framework</strong> permet d'accéder à ces fichiers très simplement à l'aide d'une seule méthode !</p><p id="r-572426" data-claire-element-id="572426">Le XML est utilisé de deux façons différentes :</p><ul id="r-572431" data-claire-element-id="572431"><li id="r-572428" data-claire-element-id="572428"><p id="r-572427" data-claire-element-id="572427">avec l'aide de XPath ;</p></li><li id="r-572430" data-claire-element-id="572430"><p id="r-572429" data-claire-element-id="572429">avec l'outil de Visual C#.</p></li></ul><p id="r-572432" data-claire-element-id="572432">L'outil livré avec Visual C# est celui que nous utiliserons dans ce cours.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application">[Visual C#] Utiliser les paramètres d&#039;application</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/les-fichiers-de-configuration">
Les fichiers de configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
Soyez prêt !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/utiliser-les-parametres-d-application">
Utiliser les paramètres d&#039;application !
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
<span class="next">Soyez prêt !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Soyezprt"></a><h2>Soyez prêt !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/les-fichiers-de-configuration">
<span class="arrow"></span>
<span class="next">Les fichiers de configuration</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/utiliser-les-parametres-d-application">
<span class="next">Utiliser les paramètres d&#039;application !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-572434" data-claire-element-id="572434">Nous allons maintenant commencer.</p><p id="r-572435" data-claire-element-id="572435">J'utiliserai Microsoft Visual Studio 2010 avec le .NET Framework 4.0 dans ce tutoriel. N'ayez crainte, que vous ayez une version express de Visual Studio 2010 ou 2008, ça ne changera rien. ;)</p><p id="r-572436" data-claire-element-id="572436">Bon alors, commençons !</p><h2 id="r-creation-du-projet-12" data-claire-element-id="572443">Création du projet !</h2><p id="r-572437" data-claire-element-id="572437">Lancez Microsoft Visual C# (pas trop loin ^^ ).</p><p id="r-572438" data-claire-element-id="572438">Créez un nouveau projet : Fichier → Nouveau projet → Application Windows Forms / Application WPF. Après, à vous de choisir si vous voulez créer un projet WinForms ou WPF. Ça ne changera rien.</p><p id="r-572439" data-claire-element-id="572439">Nommez votre projet : « <em>Vive H@des</em> », par exemple.</p><aside id="r-572441" data-claire-element-id="572441" data-claire-semantic="warning"><p id="r-572440" data-claire-element-id="572440">Petite précision : je ne supporterai pas si vous mettez autre chose que mon nom ! :pirate:</p></aside><p id="r-572442" data-claire-element-id="572442">Maintenant, reste à créer le fichier *.config.</p><h2 id="r-le-fichier-config" data-claire-element-id="572510">Le fichier *.config</h2><p id="r-572444" data-claire-element-id="572444">Nous allons entamer la création et la construction du fichier *.config.</p><p id="r-572445" data-claire-element-id="572445">Pour cela, il vous faudra double-cliquer sur Properties ou Propriétés dans l'explorateur de solutions : vous devriez voir apparaître les <strong>options de l'application</strong>, mais pas encore les <strong>paramètres de configuration</strong>.</p><aside id="r-572447" data-claire-element-id="572447" data-claire-semantic="warning"><p id="r-572446" data-claire-element-id="572446">Attention à ne pas confondre !</p></aside><p id="r-572448" data-claire-element-id="572448">Afin de voir ces paramètres, double-cliquez sur... Paramètres. ^^ <br/> Vous voyez donc apparaître ceci :</p><figure id="r-572450" data-claire-element-id="572451"><img id="r-572449" data-claire-element-id="572449" src="medias/uploads.siteduzero.com_files_285001_286000_285782.jpg" alt="Image utilisateur"/></figure><ul id="r-572460" data-claire-element-id="572460"><li id="r-572453" data-claire-element-id="572453"><p id="r-572452" data-claire-element-id="572452">Le nom correspond au nom du paramètre que vous utiliserez dans votre partie code source. Bien évidemment, n'utilisez pas d'espaces ni de caractères spéciaux.</p></li><li id="r-572455" data-claire-element-id="572455"><p id="r-572454" data-claire-element-id="572454">Le type sert à préciser de quel type sera la variable. Il existe aussi d'autres types, comme la taille.</p></li><li id="r-572457" data-claire-element-id="572457"><p id="r-572456" data-claire-element-id="572456">La portée. Deux choix sont possibles. Je vous en parlerai après.</p></li><li id="r-572459" data-claire-element-id="572459"><p id="r-572458" data-claire-element-id="572458">Et la valeur, qui sert, comme vous l'avez sûrement compris, à stocker la valeur que contiendra la variable. Vous pouvez très bien ne rien mettre, ce qui sera équivalent à un <code data-claire-semantic="csharp">null</code>.</p></li></ul><p id="r-572461" data-claire-element-id="572461">Comme je l'ai dit, pour la portée du paramètre, il y a un choix à faire parmi :</p><ul id="r-572466" data-claire-element-id="572466"><li id="r-572463" data-claire-element-id="572463"><p id="r-572462" data-claire-element-id="572462"><strong>Application</strong>. Cette portée est utilisable seulement en lecture seule. Vous ne pourrez la modifier que par Visual Studio ou par exemple le célèbre Bloc-notes de Windows, mais surtout pas par l'application ; ;)</p></li><li id="r-572465" data-claire-element-id="572465"><p id="r-572464" data-claire-element-id="572464"><strong>Utilisateur</strong>. Contrairement à la portée Application, celle-ci est utilisable et modifiable à n'importe quel moment.</p></li></ul><p id="r-572467" data-claire-element-id="572467">Vous l'avez sans doute remarqué, mais quand vous créez votre premier paramètre, un fichier *.config est créé dans votre solution. C'est lui qui contient toutes les données. Visual C# ne fait que le générer et l'interpréter !</p><aside id="r-572469" data-claire-element-id="572469" data-claire-semantic="information"><p id="r-572468" data-claire-element-id="572468">Notez que quand vous utilisez la portée Utilisateur, les paramètres ne sont pas stockés dans le fichier *.config à la racine de votre application, mais dans un nouveau fichier [user].config où [user] désigne le nom de la session utilisateur. C'est comme ça que chaque utilisateur peut enregistrer ses valeurs préférées.</p></aside><div id="r-572471" data-claire-element-id="572471" data-claire-semantic="question"><p id="r-572470" data-claire-element-id="572470">Mais il y a quelque chose de surligné en rouge sur l'image ! Qu'est-ce que c'est ?</p></div><aside id="r-572473" data-claire-element-id="572473" data-claire-semantic="information"><p id="r-572472" data-claire-element-id="572472">Je reviendrai sur ce point tout à l'heure. ;)</p></aside><p id="r-572474" data-claire-element-id="572474">Le T.P. de ce tutoriel est un navigateur web qui devra, au démarrage, lire ce paramètre qui est une URL et afficher la page web. Il y aura aussi un bouton afin de donner l'URL de la page web actuelle à notre paramètre.</p><div id="r-572476" data-claire-element-id="572476" data-claire-semantic="question"><p id="r-572475" data-claire-element-id="572475">Vous suivez ? ^^</p></div><p id="r-572477" data-claire-element-id="572477">Nous allons juste mettre une seule propriété :</p><table id="r-572498" data-claire-element-id="572498"><thead id="r-572487" data-claire-element-id="572487"><tr id="r-572486" data-claire-element-id="572486"><th id="r-572479" data-claire-element-id="572479"><p id="r-572478" data-claire-element-id="572478">Nom</p></th><th id="r-572481" data-claire-element-id="572481"><p id="r-572480" data-claire-element-id="572480">Type</p></th><th id="r-572483" data-claire-element-id="572483"><p id="r-572482" data-claire-element-id="572482">Portée</p></th><th id="r-572485" data-claire-element-id="572485"><p id="r-572484" data-claire-element-id="572484">Valeur</p></th></tr></thead><tbody id="r-572497" data-claire-element-id="572497"><tr id="r-572496" data-claire-element-id="572496"><td id="r-572489" data-claire-element-id="572489"><p id="r-572488" data-claire-element-id="572488">PageDeDemarrage</p></td><td id="r-572491" data-claire-element-id="572491"><p id="r-572490" data-claire-element-id="572490">String</p></td><td id="r-572493" data-claire-element-id="572493"><p id="r-572492" data-claire-element-id="572492">Utilisateur 1</p></td><td id="r-572495" data-claire-element-id="572495"><p id="r-572494" data-claire-element-id="572494"><a href="http://www.siteduzero.com/">http://www.siteduzero.com/</a></p></td></tr></tbody></table><p id="r-572499" data-claire-element-id="572499">1 → Nous allons mettre Utilisateur car notre programme va consister, comme je l'ai dit, à ouvrir une page web et en définir une. Donc on a besoin de modifier cette valeur : → <code data-claire-semantic="csharp">public</code>. Une fois que tout ceci sera bon et que vous aurez validé, vous retournerez sur votre formulaire <em>Forms1.cs [Desgin]</em> ou <em>Window1.xaml</em>.</p><p id="r-572500" data-claire-element-id="572500">Maintenant, double-cliquez sur <em>« App.config »</em> ; vous devriez avoir ce code :</p><pre id="r-572501" data-claire-element-id="572501"><code data-claire-semantic="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;configuration&gt;
    &lt;configSections&gt;
        &lt;sectionGroup name=&quot;userSettings&quot; type=&quot;System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; &gt;
            &lt;section name=&quot;Projet.Properties.Settings&quot; type=&quot;System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; allowExeDefinition=&quot;MachineToLocalUser&quot; requirePermission=&quot;false&quot; /&gt;
        &lt;/sectionGroup&gt;
    &lt;/configSections&gt;
    &lt;userSettings&gt;
        &lt;Projet.Properties.Settings&gt;
            &lt;setting name=&quot;PageDeDemarrage&quot; serializeAs=&quot;String&quot;&gt;
                &lt;value&gt;http://www.google.fr/&lt;/value&gt;
            &lt;/setting&gt;
        &lt;/Projet.Properties.Settings&gt;
    &lt;/userSettings&gt;
&lt;/configuration&gt;</code></pre><p id="r-572502" data-claire-element-id="572502">Nous n'allons pas étudier ces lignes de code en XML. Si vous avez lu le lien que je vous avais donné au début du tutoriel, vous comprendrez. ;)</p><p id="r-572503" data-claire-element-id="572503">Revenons à l'image de tout à l'heure ! Vous êtes peut-être impatient de savoir quelle est cette chose soulignée ! o_O</p><aside id="r-572505" data-claire-element-id="572505" data-claire-semantic="information"><p id="r-572504" data-claire-element-id="572504">La chose soulignée est une fonction de Visual Studio qui permet de gérer les événements du fichier *.config. Ça y est, j'en ai trop dit. &gt;_</p></aside><p id="r-572506" data-claire-element-id="572506">Eh oui ! Visual Studio permet de gérer des événements du fichier *.config. C'est un outil puissant que nous avons là !</p><p id="r-572507" data-claire-element-id="572507">Quand vous cliquez dessus, Visual Studio vous ouvre un fichier source.</p><pre id="r-572508" data-claire-element-id="572508"><code data-claire-semantic="csharp">namespace ParametreApplication.Properties {
    
    
    // Cette classe vous permet de gérer des événements spécifiques dans la classe de paramètres :
    //  l'événement SettingChanging est déclenché avant la modification d'une valeur de paramètre ;
    //  l'événement PropertyChanged est déclenché après la modification d'une valeur de paramètre ;
    //  l'événement SettingsLoaded est déclenché après le chargement des valeurs de paramètre ;
    //  l'événement SettingsSaving est déclenché avant l'enregistrement des valeurs de paramètre.
    internal sealed partial class Settings {
        
        public Settings() {
            // // Pour ajouter des gestionnaires d'événements afin d'enregistrer et de modifier les paramètres, supprimez les marques de commentaire des lignes ci-dessous :
            //
            // this.SettingChanging += this.SettingChangingEventHandler;
            //
            // this.SettingsSaving += this.SettingsSavingEventHandler;
            //
        }
        
        private void SettingChangingEventHandler(object sender, System.Configuration.SettingChangingEventArgs e) {
            // Ajouter du code pour gérer l'événement SettingChangingEvent ici.
        }
        
        private void SettingsSavingEventHandler(object sender, System.ComponentModel.CancelEventArgs e) {
            // Ajouter du code pour gérer l'événement SettingsSaving ici.
        }
    }
}</code></pre><p id="r-572509" data-claire-element-id="572509">Tout est expliqué dans ce code source par l'intermédiaire des commentaires. Vous n'aurez pas besoin de moi. ;)</p><h2 id="r-personnalisons-notre-formulaire" data-claire-element-id="572517">Personnalisons notre formulaire !</h2><p id="r-572511" data-claire-element-id="572511">Maintenant, nous allons nous occuper de l'apparence du formulaire. Glissez un <code data-claire-semantic="csharp">WebBrowser</code> dans votre formulaire (je suppose que vous savez faire ça).</p><h3 id="r-en-wpf" data-claire-element-id="572513">En WPF</h3><p id="r-572512" data-claire-element-id="572512">Mettez le <code>VerticalAlignment</code> à <code>Stretch</code> ainsi que l'<code>HorizontalAlignment</code>.</p><h3 id="r-en-winform" data-claire-element-id="572516">En WinForm</h3><p id="r-572514" data-claire-element-id="572514">Mettez-le tout simplement en <code data-claire-semantic="csharp">Dock.Fill</code>. Puis mettez un <code data-claire-semantic="csharp">Button</code> n'importe où dans votre formulaire qui contient le texte suivant : « Définir cette page comme page de démarrage. »</p><p id="r-572515" data-claire-element-id="572515">Et voilà, c'était tout pour cette sous-partie.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application">[Visual C#] Utiliser les paramètres d&#039;application</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/les-fichiers-de-configuration">
Les fichiers de configuration
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
Soyez prêt !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/utiliser-les-parametres-d-application">
Utiliser les paramètres d&#039;application !
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/les-fichiers-de-configuration">
<span class="arrow"></span>
<span class="next">Les fichiers de configuration</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/utiliser-les-parametres-d-application">
<span class="next">Utiliser les paramètres d&#039;application !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Utiliserlesparamtresd039application"></a><h2>Utiliser les paramètres d&#039;application !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
<span class="arrow"></span>
<span class="next">Soyez prêt !</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-572519" data-claire-element-id="572519">Bon... Assez discuté !</p><p id="r-572520" data-claire-element-id="572520">Je vais enfin vous donner la syntaxe pour les paramètres d'application. Il n'y en a que deux ; ce sont des propriétés, générées automatiquement par Visual Studio, ce qui veut dire que ces paramètres sont utilisés de la même manière que des <em><strong>Propriétés</strong></em><code data-claire-semantic="csharp">get{} set{} </code>.</p><p id="r-572521" data-claire-element-id="572521">Non, vous ne rêvez pas ! Je vous avais prévenu que c'était d'une simplicité ! C'est votre jour de chance !</p><p id="r-572522" data-claire-element-id="572522">Je vais commencer par mettre la syntaxe permettant de lire une de ces propriétés. Et puis comme vous savez aussi en définir une, je vous laisserai deviner la syntaxe pour le faire.</p><h2 id="r-lire-3" data-claire-element-id="572532">Lire</h2><h3 id="r-syntaxe-30" data-claire-element-id="572526">Syntaxe</h3><pre id="r-572523" data-claire-element-id="572523"><code>[Type] [NomDuType] = Properties.Settings.Default.[NomDuParamètre];</code></pre><aside id="r-572525" data-claire-element-id="572525" data-claire-semantic="warning"><p id="r-572524" data-claire-element-id="572524">Vous ne devez pas mettre les crochets ! C'est pour vous montrer ce qu'il y a à modifier.</p></aside><h3 id="r-dans-notre-cas" data-claire-element-id="572531">Dans notre cas</h3><pre id="r-572527" data-claire-element-id="572527"><code data-claire-semantic="csharp">string Url = Properties.Settings.Default.PageDeDemarrage;
webBrowser1.Navigate(Url);</code></pre><aside id="r-572529" data-claire-element-id="572529" data-claire-semantic="information"><p id="r-572528" data-claire-element-id="572528">Notez que vous pouvez utiliser directement le paramètre ! Rien de tel pour se simplifier la vie !</p></aside><pre id="r-572530" data-claire-element-id="572530"><code data-claire-semantic="csharp">webBrowser1.Navigate(Properties.Settings.Default.PageDeDemarrage);</code></pre><h2 id="r-ecrire-4" data-claire-element-id="572543">Écrire</h2><h3 id="r-syntaxe-31" data-claire-element-id="572539">Syntaxe</h3><pre id="r-572533" data-claire-element-id="572533"><code>Properties.Settings.Default.[NomDuParamètre] = [Valeur];</code></pre><aside id="r-572535" data-claire-element-id="572535" data-claire-semantic="warning"><p id="r-572534" data-claire-element-id="572534">[Type] et [NomDuType] doivent être de même type. Les casts fonctionnent quand même, mais je ne vois pas l'intérêt puisque [NomDuType] peut s'agir de n'importe quel type de variable.</p></aside><aside id="r-572537" data-claire-element-id="572537" data-claire-semantic="information"><p id="r-572536" data-claire-element-id="572536">Si vous voulez réutiliser la même valeur pour le type lors d'une prochaine session, vous devez sauvegarder les changements (dans l'événement <code data-claire-semantic="html">_Closing </code> de votre application). Ça ne sert à rien de sauvegarder le fichier à chaque fois qu'il y a un changement, mettez-le uniquement à la sortie de votre application !</p></aside><pre id="r-572538" data-claire-element-id="572538"><code data-claire-semantic="csharp">Properties.Settings.Default.Save();</code></pre><h3 id="r-dans-notre-cas-1" data-claire-element-id="572542">Dans notre cas</h3><pre id="r-572540" data-claire-element-id="572540"><code data-claire-semantic="csharp">Properties.Settings.Default.PageDeDemarrage = &quot;http://www.siteduzero.com/&quot;;
Properties.Settings.Default.Save();</code></pre><p id="r-572541" data-claire-element-id="572541">C'est bon ! Vous maîtrisez les fichiers de configuration ! Maintenant, place à la pratique !</p><h2 id="r-dans-notre-programme" data-claire-element-id="572560">Dans notre programme</h2><p id="r-572544" data-claire-element-id="572544">Je vais vous demander de gérer l'événement : <code>_Load</code> pour votre fenêtre et l'événement : <code>_Click</code> pour votre bouton. Donc dans : <code>_Load</code>, je vais vous demander de charger une URL de type <code>string</code> dans votre composant : <code>webBrowser1</code>, sachant que pour charger une URL à partir de ce composant, la syntaxe est la suivante :</p><pre id="r-572545" data-claire-element-id="572545"><code data-claire-semantic="csharp">webBrowser1.Navigate([IciVousMettezL'UrlAChargerSansLesCrochets]);</code></pre><p id="r-572546" data-claire-element-id="572546">Et dans l'événement <code data-claire-semantic="csharp">_Click </code> de notre bouton, je voudrais que la page actuelle sur le composant <code data-claire-semantic="csharp">webBrowser1 </code> soit définie dans le paramètre PageDeDemarrage. Pour obtenir l'URL de la page actuelle, vous devez utiliser la propriété Url du composant WebBrowser :</p><pre id="r-572547" data-claire-element-id="572547"><code data-claire-semantic="csharp">webBrowser1.Url();</code></pre><p id="r-572548" data-claire-element-id="572548">Je veux aussi que vous sauvegardiez le paramètre pour une prochaine session !</p><p id="r-572549" data-claire-element-id="572549">Bon ! J'en ai trop dit ! Bonne chance !</p><p id="r-572550" data-claire-element-id="572550">Je vous laisse 5 minutes !</p><p id="r-572551" data-claire-element-id="572551">3...<br/> 2...<br/> 1...<br/> :pirate: GO !!!</p><p id="r-572552" data-claire-element-id="572552">Voici la correction :</p><p id="r-572553" data-claire-element-id="572553"></p><div id="r-572555" data-claire-element-id="572555"><pre id="r-572554" data-claire-element-id="572554"><code data-claire-semantic="csharp">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace ParametreApplication
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load()
        {
            webBrowser1.Navigate(Properties.Settings.Default.PageDeDemarrage);
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Properties.Settings.Default.PageDeDemarrage = webBrowser1.Url.ToString();
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            Properties.Settings.Default.Save();
        }
    }
}</code></pre></div><p id="r-572556" data-claire-element-id="572556">Maintenant, nous pouvons exécuter notre programme et vous voyez le navigateur charger la page définie dans le fichier *.config, et quand on clique sur le bouton, il donne l'URL de la page actuelle à notre Type dans le fichier *.config pour qu'il puisse charger la page lors d'une prochaine session.</p><p id="r-572557" data-claire-element-id="572557">Ceci marque la fin du tutoriel !</p><p id="r-572558" data-claire-element-id="572558">Comme vous le voyez, ce système d'utilisation pour stocker vos données est très simple et est aujourd'hui utilisé dans la plupart des programmes.</p><p id="r-572559" data-claire-element-id="572559">Je tenais à remercier <a href="http://www.siteduzero.com/membres-294-1398.html">Thunderseb</a>, <a href="http://www.siteduzero.com/membres-294-26302.html">Orwell</a> et <a href="http://www.siteduzero.com/membres-294-1084.html">Coyote</a> pour m'avoir aidé à rendre ce tutoriel publiable.<br/> Et aussi aux zCorrecteurs zoubab et <a href="http://www.zcorrecteurs.fr/membres/profil-811-fihld.html">Fihld</a> pour avoir corriger mon tutoriel très rapidement. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application">[Visual C#] Utiliser les paramètres d&#039;application</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/les-fichiers-de-configuration">
Les fichiers de configuration
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
Soyez prêt !
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/utiliser-les-parametres-d-application">
Utiliser les paramètres d&#039;application !
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/visual-c-utiliser-les-parametres-d-application/soyez-pret">
<span class="arrow"></span>
<span class="next">Soyez prêt !</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/visual-c-utiliser-les-parametres-d-application.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 03:09:44 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/visual-c-utiliser-les-parametres-d-application.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:41:51 GMT -->
</html>