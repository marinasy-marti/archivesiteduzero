<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/des-applications-ultra-rapides-avec-node-js.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 02:53:44 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/des-applications-ultra-rapides-avec-node-js.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:38:11 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Des applications ultra-rapides avec Node.js</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Des applications ultra-rapides avec Node.js</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Desapplicationsultra-rapidesavecNode.js">Des applications ultra-rapides avec Node.js</a><br/><a href="#Node.jsmaisquoiasert">Node.js : mais à quoi ça sert ?</a><br/><a href="#DuJavaScriptquotlapapaquotNode.js">Du JavaScript &quot;à la papa&quot; à Node.js</a><br/><a href="#Node.jsleJavaScriptctserveur">Node.js : le JavaScript côté serveur</a><br/><a href="#PourquoiNode.jsest-ilrapide">Pourquoi Node.js est-il rapide ?</a><br/><a href="#InstallerNode.js">Installer Node.js</a><br/><a href="#InstallationdeNode.jssousWindows">Installation de Node.js sous Windows</a><br/><a href="#InstallationdeNode.jssousMacOSX">Installation de Node.js sous Mac OS X</a><br/><a href="#InstallationdeNode.jssousLinux">Installation de Node.js sous Linux</a><br/><a href="#TesterNode.jsavecunprogrammeminimal">Tester Node.js avec un programme minimal</a><br/><a href="#UnepremireapplicationavecNode.js">Une première application avec Node.js</a><br/><a href="#Desserveurswebetdesthreads">Des serveurs web et des threads</a><br/><a href="#ConstruiresonserveurHTTP">Construire son serveur HTTP</a><br/><a href="#RetournerducodeHTML">Retourner du code HTML</a><br/><a href="#Dterminerlapageappeleetlesparamtres">Déterminer la page appelée et les paramètres</a><br/><a href="#Lesvnements">Les évènements</a><br/><a href="#Ecouterdesvnements">Ecouter des évènements</a><br/><a href="#Emettredesvnements">Emettre des évènements</a><br/><a href="#LesmodulesNode.jsetNPM">Les modules Node.js et NPM</a><br/><a href="#Crerdesmodules">Créer des modules</a><br/><a href="#UtiliserNPMpourinstallerdesmodules">Utiliser NPM pour installer des modules</a><br/><a href="#Dclareretpubliersonmodule">Déclarer et publier son module</a><br/><a href="#LeframeworkExpress.js">Le framework Express.js</a><br/><a href="#Lesroutes">Les routes</a><br/><a href="#Lestemplates">Les templates</a><br/><a href="#AllerplusloinConnectetlesmiddlewares">Aller plus loin : Connect et les middlewares</a><br/><a href="#TPlatodolist">TP : la todo list</a><br/><a href="#Besoind039aide">Besoin d&#039;aide ?</a><br/><a href="#Correction">Correction</a><br/></div>
<a name="Desapplicationsultra-rapidesavecNode.js"></a><h2>Des applications ultra-rapides avec Node.js</h2><div class="content" role="article">
<p id="r-907874" data-claire-element-id="907874">Node.js, c'est un peu l'outil dont les développeurs web entendent parler tout le temps en ce moment. Il y a ceux qui connaissent (et qui ont l'air de s'éclater en l'utilisant) et il y a ceux qui se disent &quot;Bon, ça serait bien que j'y jette un oeil, mais je ne sais pas par où commencer&quot;.</p><p id="r-907875" data-claire-element-id="907875">Vous êtes de ceux-là ? Ca tombe bien, je l'ai été moi aussi ! ;)</p><p id="r-907876" data-claire-element-id="907876">Pourquoi la communauté des développeurs web est-elle autant excitée par Node.js ? Pourquoi cet intérêt aussi massif pour le langage JavaScript ? Cacherait-il des ressources insoupçonnées ? Ou tout ça n'est qu'un effet de mode qui passera aussi vite qu'il est arrivé ?</p><p id="r-907877" data-claire-element-id="907877">Le mieux pour se faire une idée est de le tester. Si vous avez déjà un bon niveau en développement web, il ne vous faudra que quelques jours pour couvrir globalement Node.js en surface et savoir ce qu'il vaut et à quoi il sert. Et si vous voulez aller plus loin, il ne tiendra plus qu'à vous de pratiquer plus en profondeur !</p><aside id="r-907879" data-claire-element-id="907879" data-claire-semantic="warning"><p id="r-907878" data-claire-element-id="907878"><strong>Attention</strong> : Node.js n'est pas fait pour les débutants. Notez bien le niveau &quot;Difficile&quot; de ce tutoriel. ;) <br/> Pour suivre ce tutoriel, il faut déjà avoir un bon niveau en JavaScript. Lisez ou relisez le <a href="../www.siteduzero.com/informatique/tutoriels/dynamisez-vos-sites-web-avec-javascript.html">tutoriel JavaScript</a> de Thunderseb et Nesquik69.<br/> Si vous vous dites &quot;Je fais déjà du jQuery régulièrement donc je connais JavaScript&quot;, vous n'avez très probablement PAS le niveau attendu. Si par contre vous êtes à l'aise avec le concept d'objets JS, d'héritage par prototype, de closures... C'est bon signe ! Je m'efforcerai d'être le plus accessible à tous et de faire des rappels, mais ne sous-estimez pas l'importance d'une relecture du <a href="../www.siteduzero.com/informatique/tutoriels/dynamisez-vos-sites-web-avec-javascript.html">tutoriel JavaScript</a> !</p></aside>
</div>
<div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script>
</div><a name="Node.jsmaisquoiasert"></a><h2>Node.js : mais à quoi ça sert ?</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
<span class="next">Du JavaScript &quot;à la papa&quot; à Node.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-907880" data-claire-element-id="907880">Et si on commençait par répondre à toutes ces questions qui vous taraudent :</p><ul id="r-907889" data-claire-element-id="907889"><li id="r-907882" data-claire-element-id="907882"><p id="r-907881" data-claire-element-id="907881">Pourquoi Node.js semble-t-il aussi apprécié des développeurs web ?</p></li><li id="r-907884" data-claire-element-id="907884"><p id="r-907883" data-claire-element-id="907883">Pourquoi avoir utilisé un langage comme JavaScript ? Je croyais que c'était juste pour faire des effets dans sa page web ?</p></li><li id="r-907886" data-claire-element-id="907886"><p id="r-907885" data-claire-element-id="907885">D'où vient cette rapidité supposée de Node.js ? A quoi ça peut me servir ?</p></li><li id="r-907888" data-claire-element-id="907888"><p id="r-907887" data-claire-element-id="907887">Est-ce que ce truc est mature ? Qui l'utilise (à part des geeks barbus) ? Devrais-je l'utiliser moi aussi ?</p></li></ul><p id="r-907890" data-claire-element-id="907890">Allez, pas de chichis, on va répondre à tout ça et même plus dans ce premier chapitre. :)</p><p id="r-907891" data-claire-element-id="907891">Si l'aventure vous tente, vous pourrez passer à la suite avec moi et installer Node.js sur votre machine !</p>
</div><a name="DuJavaScriptquotlapapaquotNode.js"></a><h2>Du JavaScript &quot;à la papa&quot; à Node.js</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">
<span class="arrow"></span>
<span class="next">Node.js : mais à quoi ça sert ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
<span class="next">Node.js : le JavaScript côté serveur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-907892" data-claire-element-id="907892">OK, j'avoue, l'expression &quot;JavaScript à la papa&quot; est un peu forte. :-° <br/> Mais il y a du vrai là-dedans : JavaScript a eu plusieurs vies. Il a eu mauvaise presse. On l'a considéré comme un &quot;petit truc parfois bien pratique&quot;, longtemps pour &quot;faire des effets dans sa page web&quot;. Or, JavaScript est avant tout un <em>langage</em>. Un langage au même titre que le C, Ruby, PHP et bien d'autres.</p><p id="r-907893" data-claire-element-id="907893">Aujourd'hui, JavaScript est de retour et il prend sa revanche. :pirate: <br/> En quelque sorte, les développeurs sont en train de découvrir que ce langage qu'ils ont longtemps ignoré, parfois même méprisé, cache en fait bien son jeu.</p><p id="r-907894" data-claire-element-id="907894">Non, JavaScript n'est pas juste un petit langage utilitaire.<br/> Oui, JavaScript est un langage à part, qui s'utilise vraiment différemment de Java, du C et d'un tas d'autres langages.<br/> Oui, JavaScript peut être compliqué à utiliser, mais recèle derrière ça d'une vraie puissance.</p><p id="r-907895" data-claire-element-id="907895">Alors que ce langage a été créé en 1995 (la préhistoire de l'informatique, vous vous rendez compte !), il a depuis bien évolué. Je vous invite à (re)lire <a href="../www.siteduzero.com/informatique/tutoriels/dynamisez-vos-sites-web-avec-javascript/petit-historique-du-langage.html">la petite histoire de JavaScript</a> racontée par les compères Thunderseb et Nesquik69 dans leur <a href="../www.siteduzero.com/informatique/tutoriels/dynamisez-vos-sites-web-avec-javascript/index.html">tutoriel JavaScript</a>.</p><p id="r-907896" data-claire-element-id="907896">Je vous disais que JavaScript était un langage qui, pour moi, avait connu plusieurs vies. Pour situer les choses, je dirais même qu'il a connu 3 vies :</p><ol id="r-907903" data-claire-element-id="907903"><li id="r-907898" data-claire-element-id="907898"><p id="r-907897" data-claire-element-id="907897">Dans les années 90, on parlait de DHTML (Dynamic HTML). On utilisait en fait les toutes premières versions de JavaScript pour faire des petits effets dans ses pages web : afficher une image lors d'un clic sur un bouton par exemple. C'était l'époque de Netscape et d'Internet Explorer 5.5 (mon Dieu ça me rajeunit pas !).</p></li><li id="r-907900" data-claire-element-id="907900"><p id="r-907899" data-claire-element-id="907899">Dans les années 2000, on a commencé à utiliser le langage pour créer des interfaces côté client. C'est là que des bibliothèques comme jQuery ou Mootools sont apparues. Aujourd'hui, cet usage de JavaScript est très répandu et mature. On a pris l'habitude de manipuler le DOM (Document Object Model) pour affecter ses balises HTML en JavaScript et leur faire subir toutes sortes de traitements.</p></li><li id="r-907902" data-claire-element-id="907902"><p id="r-907901" data-claire-element-id="907901">Puis, aux alentours de 2010, JavaScript est entré dans une nouvelle ère. Google a commencé à rendre le langage beaucoup plus rapide avec l'apparition du navigateur Google Chrome. Avec ce navigateur est né le moteur d'exécution V8 qui a considérablement permis d'accélérer l'exécution de code JavaScript (j'y reviendrai). Des outils comme Node.js sont ensuite apparus. Les bibliothèques dont le nom finit par .js se sont multipliées : Backbone.js, Ember.js, Meteor.js. JavaScript a l'air à nouveau <em>cool</em>... et semble en même temps plus compliqué qu'il n'y paraissait au premier abord.</p></li></ol><figure id="r-les-3-vies-de-javascript" data-claire-element-id="907906"><img id="r-907904" data-claire-element-id="907904" src="medias/uploads.siteduzero.com_files_421001_422000_421107.png" alt="Les 3 vies de JavaScript"/><figcaption>Les 3 vies de JavaScript</figcaption></figure><p id="r-907907" data-claire-element-id="907907">Soyons clairs : jQuery n'est pas mort et ça ne veut pas dire qu'il faut cesser de l'utiliser (par contre DHTML et Netscape sont bel et bien morts eux :p ). Les nouveaux outils JavaScript comme Node.js font des choses très différentes de jQuery et consorts. Les deux peuvent tout à fait se compléter.</p><div id="r-907909" data-claire-element-id="907909" data-claire-semantic="question"><p id="r-907908" data-claire-element-id="907908">Bon, mais ça apporte quoi concrètement Node.js ?</p></div><p id="r-907910" data-claire-element-id="907910">Node.js nous permet d'<strong>utiliser le langage JavaScript sur le serveur</strong>... Il nous permet donc de faire du JavaScript en dehors du navigateur !<br/> Node.js bénéficie de la puissance de JavaScript pour proposer une toute nouvelle façon de développer des sites web dynamiques.</p><p id="r-907911" data-claire-element-id="907911">Je vous propose justement maintenant de rentrer dans le détail du fonctionnement de Node.js. :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">
<span class="arrow"></span>
<span class="next">Node.js : mais à quoi ça sert ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
<span class="next">Node.js : le JavaScript côté serveur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Node.jsleJavaScriptctserveur"></a><h2>Node.js : le JavaScript côté serveur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
<span class="arrow"></span>
<span class="next">Du JavaScript &quot;à la papa&quot; à Node.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
<span class="next">Pourquoi Node.js est-il rapide ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-907913" data-claire-element-id="907913">Jusqu'ici, JavaScript avait toujours été utilisé du côté du client, c'est-à-dire du côté du visiteur qui navigue sur notre site. Le navigateur web du visiteur (Firefox, Chrome, IE...) exécute le code JavaScript et effectue des actions sur la page web.</p><figure id="r-le-schema-classique-php-sur-le-serveur-javascript-chez-le-client" data-claire-element-id="907916"><img id="r-907914" data-claire-element-id="907914" src="medias/uploads.siteduzero.com_files_421001_422000_421108.png" alt="Le schéma classique : PHP sur le serveur, JavaScript chez le client"/><figcaption>Le schéma classique : PHP sur le serveur, JavaScript chez le client</figcaption></figure><div id="r-907918" data-claire-element-id="907918" data-claire-semantic="question"><p id="r-907917" data-claire-element-id="907917">Qu'est-ce qui change avec l'arrivée de Node.js ?</p></div><p id="r-907919" data-claire-element-id="907919">On peut toujours utiliser du JavaScript côté client pour manipuler la page HTML. Ca, ça ne change pas.</p><p id="r-907920" data-claire-element-id="907920">Par contre, <strong>Node.js offre un environnement côté serveur</strong> qui nous permet aussi d'utiliser le langage JavaScript pour générer des pages web. En gros, il vient en remplacement de langages serveur comme PHP, Java EE, etc.</p><figure id="r-avec-node-js-on-peut-aussi-utiliser-du-javascript-sur-le-serveur" data-claire-element-id="907923"><img id="r-907921" data-claire-element-id="907921" src="medias/uploads.siteduzero.com_files_421001_422000_421109.png" alt="Avec Node.js, on peut aussi utiliser du JavaScript sur le serveur !"/><figcaption>Avec Node.js, on peut aussi utiliser du JavaScript sur le serveur !</figcaption></figure><div id="r-907925" data-claire-element-id="907925" data-claire-semantic="question"><p id="r-907924" data-claire-element-id="907924">Pourquoi Node.js semble-t-il si différent ? Parce qu'il utilise JavaScript ?</p></div><p id="r-907926" data-claire-element-id="907926">Oui, et parce que JavaScript est un langage basé sur les évènements, donc Node.js est lui-même basé sur les évènements. Du coup, c'est toute la façon d'écrire des applications web qui change ! Et c'est de là que Node.js tire toute sa puissance et sa rapidité.</p><p id="r-907927" data-claire-element-id="907927">Avec Node.js, vous pouvez créer des applications rapides comme :</p><ul id="r-907934" data-claire-element-id="907934"><li id="r-907929" data-claire-element-id="907929"><p id="r-907928" data-claire-element-id="907928">Un serveur de Chat</p></li><li id="r-907931" data-claire-element-id="907931"><p id="r-907930" data-claire-element-id="907930">Un système d'upload très rapide</p></li><li id="r-907933" data-claire-element-id="907933"><p id="r-907932" data-claire-element-id="907932">... et de façon générale n'importe quelle application qui doit répondre à de nombreuses requêtes rapidement et efficacement, en temps réel</p></li></ul><aside id="r-907936" data-claire-element-id="907936" data-claire-semantic="warning"><p id="r-907935" data-claire-element-id="907935">Node.js n'est pas un framework. Node.js est un environnement très bas niveau. Il se rapproche donc en quelque sorte plus du C que de PHP, Ruby on Rails ou Django. Voilà pourquoi il n'est pas vraiment conseillé aux débutants.<br/> Notez qu'il existe des frameworks web comme Express qui sont basés sur Node.js. Ils nous permettent d'éviter les tâches répétitives qui nous sont imposées par la nature bas niveau de Node.js, mais ils restent quand même plus complexes à utiliser que des langages comme PHP.</p></aside><p id="r-907937" data-claire-element-id="907937">JavaScript n'est pas vraiment un langage orienté objet, il est donc très loin de Java, Ruby ou Python. Ecrire une application avec Node.js demande une gymnastique d'esprit complètement différente ! C'est un peu déroutant au début pour tout vous avouer, mais quand on commence à maîtriser cet outil, on se sent un peu comme si on venait d'avoir de nouveaux super-pouvoirs qu'on ne soupçonnait pas.<br/> Voilà pourquoi tant de geeks barbus sont excités à propos de Node.js !</p><figure id="r-907939" data-claire-element-id="907940"><img id="r-907938" data-claire-element-id="907938" src="medias/uploads.siteduzero.com_files_421001_422000_421125.jpg" alt="Avant, j'étais un barbu..."/></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
<span class="arrow"></span>
<span class="next">Du JavaScript &quot;à la papa&quot; à Node.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
<span class="next">Pourquoi Node.js est-il rapide ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="PourquoiNode.jsest-ilrapide"></a><h2>Pourquoi Node.js est-il rapide ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
<span class="arrow"></span>
<span class="next">Node.js : le JavaScript côté serveur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">
<span class="next">Installer Node.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-907942" data-claire-element-id="907942">Si Node.js est rapide, cela tient principalement à deux choses : le moteur V8 et son fonctionnement non bloquant.</p><h2 id="r-le-moteur-v8" data-claire-element-id="907950">Le moteur V8</h2><p id="r-907943" data-claire-element-id="907943">Node.js utilise le moteur d'exécution ultrarapide V8 de Google Chrome. Ce moteur V8 avait fait beaucoup parler de lui à la sortie de Google Chrome, car c'est un outil open source créé par Google qui analyse et exécute du code JavaScript très rapidement.</p><figure id="r-le-logo-du-moteur-javascript-v8-de-google" data-claire-element-id="907946"><img id="r-907944" data-claire-element-id="907944" src="medias/uploads.siteduzero.com_files_421001_422000_421143.png" alt="Le logo du moteur JavaScript V8 de Google"/><figcaption>Le logo du moteur JavaScript V8 de Google</figcaption></figure><p id="r-907947" data-claire-element-id="907947">Jusqu'à la sortie de Chrome, la plupart des navigateurs lisaient le code JavaScript de façon peu efficace : le code était lu et interprété au fur et à mesure. Le navigateur mettait beaucoup de temps à lire le JavaScript et à le transformer en code machine compréhensible pour le processeur.</p><p id="r-907948" data-claire-element-id="907948">Le moteur V8 de Google Chrome, qui est réutilisé ici par Node.js, fonctionne complètement différent. Très optimisé, il fait ce qu'on appelle de la compilation JIT (Just In Time). Il transforme le code JavaScript très rapidement en code machine et l'optimise même grâce à des procédés complexes : <em>code inlining</em>, <em>copy elision</em> et j'en passe.</p><p id="r-907949" data-claire-element-id="907949">Vous n'avez pas besoin de connaître le fonctionnement de V8 pour utiliser Node.js. Retenez juste qu'il permet de rendre l'exécution de code JavaScript ultrarapide (et que les développeurs chez Google qui l'ont conçu sont des bons vrais barbus :-° ).</p><h2 id="r-le-modele-non-bloquant" data-claire-element-id="908012">Le modèle non bloquant</h2><p id="r-907951" data-claire-element-id="907951">Comme JavaScript est un langage conçu autour de la notion d'évènement, Node.js a pu mettre en place une architecture de code entièrement non bloquante.</p><p id="r-907952" data-claire-element-id="907952">Mais au fait, connaissez-vous la différence entre un code bloquant et un code non bloquant ? Hmmm, un peu d'explications ne peuvent pas faire de mal je vois ! ;)</p><h3 id="r-modele-bloquant-vs-modele-non-bloquant" data-claire-element-id="907978">Modèle bloquant vs modèle non bloquant</h3><p id="r-907953" data-claire-element-id="907953">Imaginez un programme dont le rôle est de télécharger un fichier puis de l'afficher. Voici comment on écrirait le code dans un <strong>modèle bloquant</strong> :</p><pre id="r-907954" data-claire-element-id="907954"><code>Télécharger un fichier
Afficher le fichier
Faire autre chose</code></pre><p id="r-907955" data-claire-element-id="907955">Les actions sont effectuées dans l'ordre. Il faut lire les lignes de haut en bas :</p><ol id="r-907962" data-claire-element-id="907962"><li id="r-907957" data-claire-element-id="907957"><p id="r-907956" data-claire-element-id="907956">Le programme va télécharger un fichier sur Internet</p></li><li id="r-907959" data-claire-element-id="907959"><p id="r-907958" data-claire-element-id="907958">Le programme affiche le fichier à l'utilisateur</p></li><li id="r-907961" data-claire-element-id="907961"><p id="r-907960" data-claire-element-id="907960">Puis ensuite le programme peut faire d'autres choses (effectuer d'autres actions)</p></li></ol><p id="r-907963" data-claire-element-id="907963">Maintenant, on peut écrire le même code sur un <strong>modèle non bloquant</strong> :</p><pre id="r-907964" data-claire-element-id="907964"><code>Télécharger un fichier
    Dès que c'est terminé, afficher le fichier
Faire autre chose</code></pre><p id="r-907965" data-claire-element-id="907965">Le programme n'exécute plus les lignes dans l'ordre où elles sont écrites. Il fait ceci :</p><ol id="r-907972" data-claire-element-id="907972"><li id="r-907967" data-claire-element-id="907967"><p id="r-907966" data-claire-element-id="907966">Le programme lance le téléchargement d'un fichier sur Internet</p></li><li id="r-907969" data-claire-element-id="907969"><p id="r-907968" data-claire-element-id="907968">Le programme fait d'autres choses (le programme suit son cours)</p></li><li id="r-907971" data-claire-element-id="907971"><p id="r-907970" data-claire-element-id="907970">Dès que le téléchargement est terminé, le programme effectue les actions qu'on lui avait demandées : il affiche le fichier</p></li></ol><p id="r-907973" data-claire-element-id="907973">Schématiquement, l'exécution du programme peut donc se représenter comme ça :</p><figure id="r-le-modele-non-bloquant-en-programmation" data-claire-element-id="907976"><img id="r-907974" data-claire-element-id="907974" src="medias/uploads.siteduzero.com_files_421001_422000_421157.png" alt="Le modèle non bloquant en programmation"/><figcaption>Le modèle non bloquant en programmation</figcaption></figure><p id="r-907977" data-claire-element-id="907977">C'est justement comme ça que fonctionne Node.js. Dès que l'évènement &quot;Fichier téléchargé&quot; apparaît, une fonction appelée <em>fonction de callback </em>est appelée et effectue des actions (ici, la fonction de callback affiche le fichier).</p><h3 id="r-le-modele-non-bloquant-avec-node-js" data-claire-element-id="908011">Le modèle non bloquant avec Node.js</h3><p id="r-907979" data-claire-element-id="907979">Bon, et avec du vrai code ça donne quoi ? Voici un exemple de programme Node.js qui télécharge un fichier sur Internet et affiche &quot;Fichier téléchargé !&quot; quand il a terminé :</p><pre id="r-907980" data-claire-element-id="907980"><code data-claire-semantic="javascript">request('http://www.site.com/fichier.zip', function (error, response, body) {
    console.log(&quot;Fichier téléchargé !&quot;);
});
console.log(&quot;Je fais d'autres choses en attendant...&quot;);</code></pre><p id="r-907981" data-claire-element-id="907981">La requête de téléchargement est lancée en premier. Ensuite, le programme fait d'autres choses (ici, il affiche un message dans la console, mais il pourrait faire n'importe quoi d'autre). Dès que le téléchargement est terminé, le programme va à la ligne 2 et affiche &quot;Fichier téléchargé !&quot;.</p><div id="r-907983" data-claire-element-id="907983" data-claire-semantic="question"><p id="r-907982" data-claire-element-id="907982">Mais... Comment ça marche ? Je vois une fonction en paramètre de la fonction request ! C'est une fonction dans une fonction, au secours ces barbus sont fous ! :waw:</p></div><p id="r-907984" data-claire-element-id="907984">Hola pas de panique. :p Ce que vous voyez là est une fonction de callback. En JavaScript on peut tout à fait envoyer une fonction en paramètre d'une autre fonction. Cela signifie ici : &quot;Exécute cette fonction quand le téléchargement est terminé&quot;.</p><p id="r-907985" data-claire-element-id="907985">Ici, la fonction n'a pas de nom. On dit que c'est une fonction anonyme. Mais on pourrait décomposer ce code comme ceci, <strong>le résultat serait identique</strong> :</p><pre id="r-907986" data-claire-element-id="907986"><code data-claire-semantic="javascript">// Résultat identique au code précédent

var callback = function (error, response, body) {
    console.log(&quot;Fichier téléchargé !&quot;);
});

request('http://www.site.com/fichier.zip', callback);
console.log(&quot;Je fais d'autres choses en attendant...&quot;);</code></pre><p id="r-907987" data-claire-element-id="907987">La fonction de callback est enregistrée dans une variable. Comme toutes les fonctions, elle n'est pas exécutée tant qu'on ne l'a pas appelée.<br/> Ensuite, on envoie cette fonction de callback en paramètre de la fonction request() pour dire : &quot;Dès que la requête de téléchargement est terminée, appelle cette fonction de callback&quot;.</p><p id="r-907988" data-claire-element-id="907988">En pratique, les développeurs JavaScript mettent régulièrement des fonctions anonymes directement à l'intérieur d'autres fonctions en paramètre, comme dans mon premier code. C'est un peu étrange au début mais on s'y fait vite !</p><div id="r-907990" data-claire-element-id="907990" data-claire-semantic="question"><p id="r-907989" data-claire-element-id="907989">Je ne vois pas pourquoi ça rendrait le programme plus rapide. J'ai l'impression que ça le rend surtout plus compliqué !</p></div><p id="r-907991" data-claire-element-id="907991">Je vous avais dit que Node.js n'était pas simple, mais le jeu en vaut la chandelle ! Vous allez comprendre pourquoi. Imaginez qu'on demande le téléchargement de 2 fichiers à Node.js :</p><pre id="r-907992" data-claire-element-id="907992"><code data-claire-semantic="javascript">var callback = function (error, response, body) {
    console.log(&quot;Fichier téléchargé !&quot;);
});

request('http://www.site.com/fichier.zip', callback);
request('http://www.site.com/autrefichier.zip', callback);</code></pre><p id="r-907993" data-claire-element-id="907993">Si le modèle avait été bloquant, le programme aurait :</p><ol id="r-907998" data-claire-element-id="907998"><li id="r-907995" data-claire-element-id="907995"><p id="r-907994" data-claire-element-id="907994">Lancé le téléchargement du fichier 1, et attendu qu'il se termine...</p></li><li id="r-907997" data-claire-element-id="907997"><p id="r-907996" data-claire-element-id="907996">... puis lancé le téléchargement du fichier 2, et attendu qu'il se termine.</p></li></ol><p id="r-907999" data-claire-element-id="907999">Or, avec Node.js, les deux téléchargements sont lancés <em>en même temps</em> ! Le programme n'attend pas la fin du premier téléchargement pour passer à l'instruction suivante.</p><p id="r-908000" data-claire-element-id="908000">Du coup, le téléchargement des 2 fichiers au total va beaucoup plus vite puisque le programme fait les 2 à la fois :</p><figure id="r-en-modele-non-bloquant-comme-node-js-les-2-fichiers-sont-telecharges-en-meme-temps-et-l-ensemble-finit-plus-vite" data-claire-element-id="908003"><img id="r-908001" data-claire-element-id="908001" src="medias/uploads.siteduzero.com_files_421001_422000_421164.png" alt="En modèle non bloquant (comme Node.js), les 2 fichiers sont téléchargés en même temps et l'ensemble finit plus vite"/><figcaption>En modèle non bloquant (comme Node.js), les 2 fichiers sont téléchargés en même temps et l'ensemble finit plus vite</figcaption></figure><p id="r-908004" data-claire-element-id="908004">Dans les applications web, il est courant d'avoir des opérations longues et bloquantes comme :</p><ul id="r-908009" data-claire-element-id="908009"><li id="r-908006" data-claire-element-id="908006"><p id="r-908005" data-claire-element-id="908005">Les appels aux bases de données</p></li><li id="r-908008" data-claire-element-id="908008"><p id="r-908007" data-claire-element-id="908007">Les appels à des services web (ex : l'API de Twitter)</p></li></ul><p id="r-908010" data-claire-element-id="908010">Node.js nous évite de perdre du temps en nous permettant de faire d'autres choses en attendant que les actions longues soient terminées !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
<span class="arrow"></span>
<span class="next">Node.js : le JavaScript côté serveur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">
<span class="next">Installer Node.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="InstallerNode.js"></a><h2>Installer Node.js</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
<span class="arrow"></span>
<span class="next">Pourquoi Node.js est-il rapide ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
<span class="next">Installation de Node.js sous Windows</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-908015" data-claire-element-id="908015">Vous êtes convaincus ? Vous voulez vous mettre à Node.js ?<br/> Très bien ! N'attendons pas alors, et installons la bête ! :pirate:</p><p id="r-908016" data-claire-element-id="908016">Dans ce chapitre, nous couvrirons l'installation pour chaque OS :</p><ul id="r-908023" data-claire-element-id="908023"><li id="r-908018" data-claire-element-id="908018"><p id="r-908017" data-claire-element-id="908017">Windows</p></li><li id="r-908020" data-claire-element-id="908020"><p id="r-908019" data-claire-element-id="908019">Mac OS X</p></li><li id="r-908022" data-claire-element-id="908022"><p id="r-908021" data-claire-element-id="908021">Linux</p></li></ul><p id="r-908024" data-claire-element-id="908024">Vous devez juste lire la section qui correspond à votre système d'exploitation. Il n'y aura rien de bien difficile ici rassurez-vous.</p><p id="r-908025" data-claire-element-id="908025">Ensuite, nous testerons une toute première application très simple pour vérifier que Node.js est bien installé et fonctionne correctement. Cette dernière section doit évidemment être lue par tout le monde si vous voulez être prêts pour le prochain chapitre. ;)</p>
</div><a name="InstallationdeNode.jssousWindows"></a><h2>Installation de Node.js sous Windows</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">
<span class="arrow"></span>
<span class="next">Installer Node.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
<span class="next">Installation de Node.js sous Mac OS X</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908026" data-claire-element-id="908026">Pour installer Node.js sous Windows, il suffit de télécharger l'installeur qui est proposé sur le <a href="http://nodejs.org/">site de Node.js</a>. Cliquez simplement sur le lien Install.</p><p id="r-908027" data-claire-element-id="908027">Vous pouvez aussi vous rendre sur la page des téléchargements pour avoir plus d'options :</p><figure id="r-la-page-de-telechargement-de-node-js" data-claire-element-id="908030"><img id="r-908028" data-claire-element-id="908028" src="medias/uploads.siteduzero.com_files_421001_422000_421188.png" alt="La page de téléchargement de Node.js"/><figcaption>La page de téléchargement de Node.js</figcaption></figure><p id="r-908031" data-claire-element-id="908031">Vous pouvez télécharger soit le .msi, soit le .exe (le résultat sera le même). Prenez la version 64 bits si vous avez un Windows 64 bits (cas de la plupart des PC récents).<br/> Dans le doute, prenez la version 32 bits.</p><p id="r-908032" data-claire-element-id="908032">Lancez ensuite l'installeur :</p><figure id="r-installation-de-node-js" data-claire-element-id="908035"><img id="r-908033" data-claire-element-id="908033" src="medias/uploads.siteduzero.com_files_421001_422000_421239.png" alt="Installation de Node.js"/><figcaption>Installation de Node.js</figcaption></figure><p id="r-908036" data-claire-element-id="908036">Après quelques écrans classiques on vous demandera ce que vous voulez installer. Je vous invite à tout laisser coché :</p><figure id="r-choix-des-elements-a-installer" data-claire-element-id="908039"><img id="r-908037" data-claire-element-id="908037" src="medias/uploads.siteduzero.com_files_421001_422000_421240.png" alt="Choix des éléments à installer"/><figcaption>Choix des éléments à installer</figcaption></figure><p id="r-908040" data-claire-element-id="908040">L'installation se lance ensuite. Elle ne prend que quelques secondes !</p><figure id="r-l-installation-est-terminee" data-claire-element-id="908043"><img id="r-908041" data-claire-element-id="908041" src="medias/uploads.siteduzero.com_files_421001_422000_421241.png" alt="L'installation est terminée !"/><figcaption>L'installation est terminée !</figcaption></figure><p id="r-908044" data-claire-element-id="908044">A la fin, on vous dit que Node.js est installé... oui, mais où ? Comment ça marche ?</p><p id="r-908045" data-claire-element-id="908045">En fait, vous devriez voir avoir 2 programmes installés :</p><ul id="r-908050" data-claire-element-id="908050"><li id="r-908047" data-claire-element-id="908047"><p id="r-908046" data-claire-element-id="908046"><strong>Node.js</strong> : c'est l'intepréteur de commandes de Node.js (dont nous parlerons à la fin de ce chapitre). Nous l'utiliserons assez peu en pratique. Il sert à tester des commandes JavaScript.</p></li><li id="r-908049" data-claire-element-id="908049"><p id="r-908048" data-claire-element-id="908048"><strong>Node.js command prompt</strong> : c'est une console de Windows configurée pour reconnaître Node.js. C'est par là que vous passerez pour lancer vos programmes Node.js, c'est donc ce que nous utiliserons le plus souvent.</p></li></ul><figure id="r-node-js-l-interpreteur-node-js-sous-windows-sera-peu-utilise" data-claire-element-id="908053"><img id="r-908051" data-claire-element-id="908051" src="medias/uploads.siteduzero.com_files_421001_422000_421242.png" alt="Node.js - L'interpréteur Node.js sous Windows (sera peu utilisé)"/><figcaption>Node.js - L'interpréteur Node.js sous Windows (sera peu utilisé)</figcaption></figure><figure id="r-node-js-command-prompt-la-console-node-js-sera-frequemment-utilisee" data-claire-element-id="908056"><img id="r-908054" data-claire-element-id="908054" src="medias/uploads.siteduzero.com_files_421001_422000_421243.png" alt="Node.js command prompt - La console Node.js (sera fréquemment utilisée)"/><figcaption>Node.js command prompt - La console Node.js (sera fréquemment utilisée)</figcaption></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">
<span class="arrow"></span>
<span class="next">Installer Node.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
<span class="next">Installation de Node.js sous Mac OS X</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="InstallationdeNode.jssousMacOSX"></a><h2>Installation de Node.js sous Mac OS X</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
<span class="arrow"></span>
<span class="next">Installation de Node.js sous Windows</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
<span class="next">Installation de Node.js sous Linux</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908058" data-claire-element-id="908058">Si vous êtes sous Mac OS X, vous pouvez cliquer sur le lien &quot;Install&quot; sur la <a href="http://nodejs.org/">page d'accueil de Node.js</a>.</p><p id="r-908059" data-claire-element-id="908059">Si vous voulez plus d'options, affichez la <a href="http://nodejs.org/download/">page des téléchargements</a> :</p><figure id="r-la-page-de-telechargement-de-node-js-1" data-claire-element-id="908062"><img id="r-908060" data-claire-element-id="908060" src="medias/uploads.siteduzero.com_files_421001_422000_421188.png" alt="La page de téléchargement de Node.js"/><figcaption>La page de téléchargement de Node.js</figcaption></figure><p id="r-908063" data-claire-element-id="908063">Le mieux est de prendre l'installeur (fichier .pkg). Il ouvre un assistant d'installation, dans lequel il suffit de cliquer frénétiquement sur &quot;Suivant&quot;, &quot;Suivant&quot;, &quot;Suivant&quot;, &quot;Terminer&quot;.</p><figure id="r-l-installation-de-node-js-sous-mac-os-x" data-claire-element-id="908066"><img id="r-908064" data-claire-element-id="908064" src="medias/uploads.siteduzero.com_files_421001_422000_421189.png" alt="L'installation de Node.js sous Mac OS X"/><figcaption>L'installation de Node.js sous Mac OS X</figcaption></figure><p id="r-908067" data-claire-element-id="908067">Une fois l'installation terminée, vous pouvez vérifier que Node.js fonctionne correctement en tapant la commande <code data-claire-semantic="console">node</code> dans la console. Ouvrez une fenêtre de Terminal (le Terminal étant installé par défaut sous Mac OS X), en allant dans le Finder, section &quot;Applications&quot;, &quot;Terminal&quot;. Je vous conseille de mettre un raccourci dans le dock !</p><p id="r-908068" data-claire-element-id="908068">Tapez quelques commandes comme <code data-claire-semantic="console">node -v</code> (pour avoir le numéro de version) ou <code data-claire-semantic="console">node</code> tout court pour lancer l'interpréteur interactif.</p><figure id="r-execution-de-node-js-dans-le-terminal" data-claire-element-id="908071"><img id="r-908069" data-claire-element-id="908069" src="medias/uploads.siteduzero.com_files_421001_422000_421190.png" alt="Exécution de Node.js dans le Terminal"/><figcaption>Exécution de Node.js dans le Terminal</figcaption></figure><p id="r-908072" data-claire-element-id="908072">Lorsque l'interpréteur est lancé, vous pouvez taper des commandes JavaScript et obtenir une réponse. Ici, par exemple, j'ai demandé combien font 1 et 1. :-°</p><p id="r-908073" data-claire-element-id="908073">Pour quitter l'interpréteur, faites Ctrl + D (c'est la commande classique qui demande à quitter un interpréteur sous Linux et Mac).</p><aside id="r-908075" data-claire-element-id="908075" data-claire-semantic="information"><p id="r-908074" data-claire-element-id="908074">Rassurez-vous, nous n'écrirons pas nos programmes Node.js là-dedans ! Ca nous sert ici surtout pour faire des tests.<br/> En pratique, nous allons écrire des fichiers .js et demander à Node de les exécuter. Nous verrons ça un peu plus loin.</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
<span class="arrow"></span>
<span class="next">Installation de Node.js sous Windows</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
<span class="next">Installation de Node.js sous Linux</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="InstallationdeNode.jssousLinux"></a><h2>Installation de Node.js sous Linux</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
<span class="arrow"></span>
<span class="next">Installation de Node.js sous Mac OS X</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
<span class="next">Tester Node.js avec un programme minimal</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908077" data-claire-element-id="908077">Sous Linux, comme d'habitude, vous avez deux choix :</p><ul id="r-908082" data-claire-element-id="908082"><li id="r-908079" data-claire-element-id="908079"><p id="r-908078" data-claire-element-id="908078">La méthode warrior ( :pirate: ), qui consiste à télécharger les sources et à les compiler.</p></li><li id="r-908081" data-claire-element-id="908081"><p id="r-908080" data-claire-element-id="908080">La méthode douce, qui consiste à utiliser le gestionnaire de paquets de sa distribution.</p></li></ul><p id="r-908083" data-claire-element-id="908083">Là, c'est une question de goût. Je n'ai rien contre la méthode warrior (moi aussi je sais taper <code data-claire-semantic="console">make</code>, <code data-claire-semantic="console">make install</code> :-° ), mais comme j'ai en général moins de problèmes de configuration avec la méthode douce, je préfère passer par un gestionnaire de paquets.</p><p id="r-908084" data-claire-element-id="908084">Sous Ubuntu par exemple, vous devrez rentrer les commandes suivantes :</p><pre id="r-908085" data-claire-element-id="908085"><code data-claire-semantic="console">sudo apt-get install python-software-properties python g++ make
sudo add-apt-repository ppa:chris-lea/node.js
sudo apt-get update
sudo apt-get install nodejs</code></pre><p id="r-908086" data-claire-element-id="908086">Notez que pour avoir la commande add-apt-repository il vous faudra peut-être télécharger software-properties-common : <code data-claire-semantic="console">sudo apt-get install software-properties-common</code></p><p id="r-908087" data-claire-element-id="908087">Et voilà le travail ! Pour vérifier que Node est bien installé, tapez quelques commandes dans la console comme :</p><pre id="r-908088" data-claire-element-id="908088"><code data-claire-semantic="console">node -v
node</code></pre><p id="r-908089" data-claire-element-id="908089">La première affiche le numéro de version de Node.js que vous avez installé.<br/> La seconde lance l'interpréteur interactif de Node.js. Vous pouvez y taper du code JavaScript (essayez simplement de taper &quot;1+1&quot; pour voir). Pour sortir de l'interpréteur, faites Ctrl + D.</p><p id="r-908090" data-claire-element-id="908090">Rassurez-vous, nous n'écrirons pas nos programmes dans l'interpréteur interactif. Nous créerons plutôt des fichiers .js et demanderons à Node de les exécuter.</p><aside id="r-908092" data-claire-element-id="908092" data-claire-semantic="information"><p id="r-908091" data-claire-element-id="908091">Depuis les versions les plus récentes de Node.js, il faut savoir que NPM est installé en même temps automatiquement. NPM est le gestionnaire de paquets de Node.js (c'est un peu l'équivalent de apt, mais pour les extensions Node.js). NPM est vraiment un outil formidable qui nous permet d'étendre les possibilités de Node.js à l'infini, nous le découvrirons un peu plus tard.</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
<span class="arrow"></span>
<span class="next">Installation de Node.js sous Mac OS X</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
<span class="next">Tester Node.js avec un programme minimal</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="TesterNode.jsavecunprogrammeminimal"></a><h2>Tester Node.js avec un programme minimal</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
<span class="arrow"></span>
<span class="next">Installation de Node.js sous Linux</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">
<span class="next">Une première application avec Node.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908094" data-claire-element-id="908094">Il est temps de vérifier que Node.js fonctionne bien ! Nous allons écrire un tout tout petit programme pour commencer, qui se contente d'afficher un message dans la console. Ce sera l'occasion de voir comment fonctionne l'exécution de fichiers .js avec Node.</p><p id="r-908095" data-claire-element-id="908095">Pour commencer, ouvrez votre éditeur de texte favori (vim, Emacs, Sublime Text, Notepad++...) et rentrez le code JavaScript suivant :</p><pre id="r-908096" data-claire-element-id="908096"><code data-claire-semantic="javascript">console.log('Bienvenue dans Node.js !');</code></pre><p id="r-908097" data-claire-element-id="908097">Enregistrez votre fichier sous l'extension .js. Par exemple test.js.</p><p id="r-908098" data-claire-element-id="908098">Ensuite, ouvrez une console dans le dossier où se trouve votre fichier test.js et entrez la commande <code data-claire-semantic="console">node test.js</code>. Vous devriez avoir le résultat suivant dans la console :</p><pre id="r-908099" data-claire-element-id="908099"><code data-claire-semantic="console">$ node test.js 
Bienvenue dans Node.js !</code></pre><p id="r-908100" data-claire-element-id="908100">Bravo, vous avez créé votre tout premier programme Node.js ! :D</p><p id="r-908101" data-claire-element-id="908101">Bon, c'était vraiment ce qu'on pouvait faire de plus simple. On a simplement demandé à écrire un message dans la console.<br/> Vous avez vu que pour lancer un programme Node.js il suffisait d'indiquer le nom du fichier .js à exécuter. Vous savez tout ce qu'il faut pour le moment !</p><p id="r-908102" data-claire-element-id="908102">Dans le prochain chapitre, on attaque les choses sérieuses : on va créer notre première vraie application Node.js. Attention, ça va se corser !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
<span class="arrow"></span>
<span class="next">Installation de Node.js sous Linux</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">
<span class="next">Une première application avec Node.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="UnepremireapplicationavecNode.js"></a><h2>Une première application avec Node.js</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
<span class="arrow"></span>
<span class="next">Tester Node.js avec un programme minimal</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
<span class="next">Des serveurs web et des threads</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-908105" data-claire-element-id="908105">Les choses sérieuses commencent ! Fini de rigoler, on rentre maintenant dans le vif du sujet.</p><p id="r-908106" data-claire-element-id="908106">C'est un des chapitres les plus importants du cours car il introduit de nombreux concepts de Node.js, qui seront pour la plupart nouveaux pour vous. Il faudra donc lire ce chapitre dans un environnement calme, progressivement, et ne pas hésiter à le relire une seconde fois le lendemain pour vous assurer que vous avez bien compris.</p><p id="r-908107" data-claire-element-id="908107">Dans ce chapitre, nous allons créer une vraie application Node.js de bout en bout.<br/> Vous allez voir ce que bas niveau veut dire ! Nous allons en effet devoir gérer tous les rouages du serveur web, qui va traiter les requêtes HTTP des visiteurs et leur retourner une page web HTML.</p><p id="r-908108" data-claire-element-id="908108">Ce sera pour vous l'occasion d'expérimenter les fameux <em>callbacks </em>dont je vous avais parlé dans le premier chapitre, ces fonctions qui s'exécutent dès lors qu'un évènement survient. Node.js en est rempli, vous ne pourrez pas y échapper ! ;)</p>
</div><a name="Desserveurswebetdesthreads"></a><h2>Des serveurs web et des threads</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">
<span class="arrow"></span>
<span class="next">Une première application avec Node.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
<span class="next">Construire son serveur HTTP</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908109" data-claire-element-id="908109">Je crois vous l'avoir déjà dit plusieurs fois mais j'ai envie de le répéter une nouvelle fois ici : Node.js est <em>bas niveau</em>. Tellement bas niveau que vous allez devoir faire des choses que vous n'avez pas l'habitude de faire pour que votre programme fonctionne correctement.</p><p id="r-908110" data-claire-element-id="908110">Quand vous créez des sites web avec PHP par exemple, vous associez le langage avec un serveur web HTTP comme Apache ou Nginx. Chacun se répartit les rôles :</p><ul id="r-908115" data-claire-element-id="908115"><li id="r-908112" data-claire-element-id="908112"><p id="r-908111" data-claire-element-id="908111">Apache gère les demandes de connexion HTTP au serveur. C'est lui qui fait en quelque sorte la circulation et qui gère les entrées/sorties.</p></li><li id="r-908114" data-claire-element-id="908114"><p id="r-908113" data-claire-element-id="908113">PHP exécute le code des fichiers .php et renvoie le résultat à Apache, qui se charge à son tour de l'envoyer au visiteur.</p></li></ul><p id="r-908116" data-claire-element-id="908116">Comme plusieurs visiteurs peuvent demander une page en même temps au serveur, Apache se charge de les répartir et de les exécuter en parallèle dans des <em>threads</em> différents. Chaque thread utilise un processeur différent sur le serveur (ou un noyau de processeur) :</p><figure id="r-le-serveur-apache-est-multithread" data-claire-element-id="908119"><img id="r-908117" data-claire-element-id="908117" src="medias/uploads.siteduzero.com_files_421001_422000_421191.png" alt="Le serveur Apache est multithread"/><figcaption>Le serveur Apache est multithread</figcaption></figure><p id="r-908120" data-claire-element-id="908120">Avec Node.js, on n'utilise pas de serveur web HTTP comme Apache. En fait, <em>c'est à nous de créer le serveur</em> ! Génial non ? :D</p><p id="r-908121" data-claire-element-id="908121">Node.js est <strong>monothread</strong>, contrairement à Apache. Cela veut dire qu'il n'y a qu'un seul processus, qu'une seule version du programme qui peut tourner à la fois en mémoire.</p><div id="r-908123" data-claire-element-id="908123" data-claire-semantic="question"><p id="r-908122" data-claire-element-id="908122">Mais... je croyais que Node.js était super rapide parce qu'il pouvait gérer des tonnes de requêtes simultanées... S'il est monothread, il ne peut faire qu'une action à la fois non ?</p></div><p id="r-908124" data-claire-element-id="908124">En effet, il ne peut faire qu'une chose à la fois et ne tourne donc que sur un noyau de processeur. Mais il fait ça de façon ultra efficace, et malgré ça il est quand même beaucoup plus rapide !<br/> Cela est dû à la nature &quot;orientée évènements&quot; de Node.js. Les applications utilisant Node ne restent jamais les bras croisés sans rien faire. Dès qu'il y a une action un peu longue, le programme redonne la main à Node.js qui va effectuer d'autres actions en attendant qu'un évènement survienne pour dire que l'opération est terminée.</p><figure id="r-node-js-est-monothread-mais-il-est-souple-grace-aux-evenements" data-claire-element-id="908127"><img id="r-908125" data-claire-element-id="908125" src="medias/uploads.siteduzero.com_files_421001_422000_421192.png" alt="Node.js est monothread, mais il est souple grâce aux évènements"/><figcaption>Node.js est monothread, mais il est souple grâce aux évènements</figcaption></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">
<span class="arrow"></span>
<span class="next">Une première application avec Node.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
<span class="next">Construire son serveur HTTP</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ConstruiresonserveurHTTP"></a><h2>Construire son serveur HTTP</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
<span class="arrow"></span>
<span class="next">Des serveurs web et des threads</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
<span class="next">Retourner du code HTML</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908129" data-claire-element-id="908129">Je vous propose d'attaquer le vif du sujet avec ce tout premier code Node.js :</p><pre id="r-908130" data-claire-element-id="908130"><code data-claire-semantic="javascript">var http = require('http');

var server = http.createServer(function(req, res) {
  res.writeHead(200);
  res.end('Salut tout le monde !');
});
server.listen(8080);</code></pre><p id="r-908131" data-claire-element-id="908131">C'est en quelque sorte le &quot;code minimal&quot; pour un projet Node.js. Placez-le dans un fichier que vous appellerez serveur.js (par exemple).</p><div id="r-908133" data-claire-element-id="908133" data-claire-semantic="question"><p id="r-908132" data-claire-element-id="908132">Mais que fait ce code ?! o_O</p></div><p id="r-908134" data-claire-element-id="908134">Il crée un mini-serveur web qui renvoie un message &quot;Salut tout le monde&quot; dans tous les cas, quelle que soit la page demandée. Ce serveur est lancé sur le port 8080 à la dernière ligne.</p><h2 id="r-dissequons-du-code" data-claire-element-id="908161">Disséquons du code</h2><p id="r-908135" data-claire-element-id="908135">Décomposons le code :</p><pre id="r-908136" data-claire-element-id="908136"><code data-claire-semantic="javascript">var http = require('http');</code></pre><p id="r-908137" data-claire-element-id="908137">require effectue un appel à une bibliothèque de Node.js, ici la bibliothèque &quot;http&quot; qui nous permet de créer un serveur web. Il existe des tonnes de bibliothèques comme celle-là, la plupart pouvant être téléchargées avec NPM, le gestionnaire de paquets de Node.js (on apprendra à l'utiliser plus tard).</p><p id="r-908138" data-claire-element-id="908138">La variable http représente un objet JavaScript qui va nous permettre de lancer un serveur web. C'est justement ce qu'on fait avec :</p><pre id="r-908139" data-claire-element-id="908139"><code data-claire-semantic="javascript">var server = http.createServer();</code></pre><p id="r-908140" data-claire-element-id="908140">On appelle la fonction createServer() contenue dans l'objet http et on enregistre ce serveur dans la variable server. Vous remarquerez que la fonction createServer prend un paramètre... et que ce paramètre est une fonction ! C'est pour ça que l'instruction est un peu compliquée, puisqu'elle s'étend sur plusieurs lignes :</p><pre id="r-908141" data-claire-element-id="908141"><code data-claire-semantic="javascript">var server = http.createServer(function(req, res) {
  res.writeHead(200);
  res.end('Salut tout le monde !');
});</code></pre><p id="r-908142" data-claire-element-id="908142">Tout le code ci-dessus correspond à l'appel à createServer(). Il comprend en paramètre <strong>la fonction à exécuter quand un visiteur se connecte à notre site</strong>.</p><p id="r-908143" data-claire-element-id="908143">Notez que vous pouvez faire ça en deux temps comme je vous l'avait dit. La fonction à exécuter est la fonction de <em>callback</em>. On peut la définir avant dans une variable et transmettre cette variable à createServer(). Ainsi, le code ci-dessous est strictement identique au précédent :</p><pre id="r-908144" data-claire-element-id="908144"><code data-claire-semantic="javascript">// Code identique au précédent

var instructionsNouveauVisiteur = function(req, res) {
  res.writeHead(200);
  res.end('Salut tout le monde !');
}

var server = http.createServer(instructionsNouveauVisiteur);</code></pre><p id="r-908145" data-claire-element-id="908145">Il est très important que vous compreniez ce principe car Node.js ne fonctionne que comme ça. Il y a des fonctions de callback de partout, et en général elles sont placées à l'intérieur des arguments d'une autre fonction comme je l'ai fait dans mon premier code. Ca paraît un peu délicat à lire mais vous prendrez vite le pli rassurez-vous. ;)</p><p id="r-908146" data-claire-element-id="908146">N'oubliez pas de bien fermer la fonction de callback avec une accolade, puis de fermer les parenthèses d'appel de la fonction qui l'englobe, puis de placer le fameux point-virgule. C'est pour ça que vous voyez les symboles <code data-claire-semantic="javascript">});</code> à la dernière ligne de mon premier code.</p><p id="r-908147" data-claire-element-id="908147">La fonction de callback est donc appelée à chaque fois qu'un visiteur se connecte à notre site. Elle prend 2 paramètres :</p><ul id="r-908152" data-claire-element-id="908152"><li id="r-908149" data-claire-element-id="908149"><p id="r-908148" data-claire-element-id="908148">La requête du visiteur (<code data-claire-semantic="javascript">req</code> dans mes exemples) : cet objet contient toutes les informations sur ce que le visiteur a demandé. On y trouve le nom de la page appelée, les paramètres, les éventuels champs de formulaires remplis...</p></li><li id="r-908151" data-claire-element-id="908151"><p id="r-908150" data-claire-element-id="908150">La réponse que vous devez renvoyer (<code data-claire-semantic="javascript">res</code> dans mes exemples) : c'est cet objet qu'il faut remplir pour donner un retour au visiteur. Au final, res contiendra en général le code HTML de la page à renvoyer au visiteur.</p></li></ul><p id="r-908153" data-claire-element-id="908153">Ici, on fait 2 choses très simples dans la réponse :</p><pre id="r-908154" data-claire-element-id="908154"><code data-claire-semantic="javascript">res.writeHead(200);
res.end('Salut tout le monde !');</code></pre><p id="r-908155" data-claire-element-id="908155">On renvoie le code 200 dans l'en-tête de la réponse, qui signifie au navigateur &quot;OK tout va bien&quot; (on aurait par exemple répondu 404 si la page demandée n'existait pas). Il faut savoir qu'en plus du code HTML, le serveur renvoie en général tout un tas de paramètres en en-tête. Il faut connaître la norme HTTP qui indique comment clients et serveurs doivent communiquer pour bien l'utiliser. Voilà encore un exemple de la complexité dûe au fait que Node.js est bas niveau... Mais en même temps ça nous fait comprendre tout un tas de choses. :)</p><p id="r-908156" data-claire-element-id="908156">Ensuite, on termine la réponse (avec <code data-claire-semantic="javascript">end()</code>) en envoyant le message de notre choix au navigateur. Ici, on n'envoie même pas de HTML, juste du texte brut.</p><p id="r-908157" data-claire-element-id="908157">Enfin, le serveur est lancé et &quot;écoute&quot; sur le port 8080 avec l'instruction :</p><pre id="r-908158" data-claire-element-id="908158"><code data-claire-semantic="javascript">server.listen(8080);</code></pre><aside id="r-908160" data-claire-element-id="908160" data-claire-semantic="information"><p id="r-908159" data-claire-element-id="908159">On évite d'utiliser ici le port 80 qui est normalement réservé aux serveurs web, car celui-ci est peut-être déjà utilisé par votre machine. Ce port 8080 sert juste pour nos tests évidemment, une fois en production il est conseillé au contraire d'écouter cette fois sur le port 80 car c'est à cette porte (à ce port) que vos visiteurs iront taper en arrivant sur votre serveur.</p></aside><h2 id="r-tester-le-serveur-http" data-claire-element-id="908170">Tester le serveur HTTP</h2><p id="r-908162" data-claire-element-id="908162">Pour tester votre premier serveur, rendez-vous dans la console et tapez :</p><pre id="r-908163" data-claire-element-id="908163"><code data-claire-semantic="console">node serveur.js</code></pre><p id="r-908164" data-claire-element-id="908164">La console n'affiche rien et ne répond pas, ce qui est parfaitement normal. Ouvrez maintenant votre navigateur et rendez-vous à l'adresse http://localhost:8080. Vous allez vous connecter sur votre propre machine sur le port 8080 sur lequel votre programme Node.js est en train d'écouter !</p><figure id="r-notre-premier-programme-node-js-s-affiche-dans-le-navigateur" data-claire-element-id="908167"><img id="r-908165" data-claire-element-id="908165" src="medias/uploads.siteduzero.com_files_421001_422000_421193.png" alt="Notre premier programme Node.js s'affiche dans le navigateur !"/><figcaption>Notre premier programme Node.js s'affiche dans le navigateur !</figcaption></figure><p id="r-908168" data-claire-element-id="908168">Et voilà le travail ! :soleil:</p><p id="r-908169" data-claire-element-id="908169">Pour arrêter votre serveur Node.js, retournez dans la console et faites Ctrl + C pour couper la commande.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
<span class="arrow"></span>
<span class="next">Des serveurs web et des threads</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
<span class="next">Retourner du code HTML</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="RetournerducodeHTML"></a><h2>Retourner du code HTML</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
<span class="arrow"></span>
<span class="next">Construire son serveur HTTP</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
<span class="next">Déterminer la page appelée et les paramètres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908172" data-claire-element-id="908172">Bon résumons ! Nous avons créé notre première vraie application avec son serveur web embarqué. Mais l'application est pour l'instant minimaliste :</p><ul id="r-908177" data-claire-element-id="908177"><li id="r-908174" data-claire-element-id="908174"><p id="r-908173" data-claire-element-id="908173">Le message renvoyé est du texte brut, il ne comporte même pas de HTML !</p></li><li id="r-908176" data-claire-element-id="908176"><p id="r-908175" data-claire-element-id="908175">L'application renvoie toujours le même message, quelle que soit la page appelée (http://localhost:8080, http://localhost:8080/mapage, http://localhost:8080/dossier/autrepage)</p></li></ul><p id="r-908178" data-claire-element-id="908178">Pour que ce chapitre soit complet, nous allons voir comment remédier à ces deux problèmes. Commençons ici par voir comment faire pour renvoyer du HTML.</p><p id="r-908179" data-claire-element-id="908179">Comme je vous l'ai dit, il y a des règles à respecter entre le client et le serveur. Ils communiquent en se basant sur la <strong>norme HTTP</strong> inventée par Tim Berners-Lee. Cette norme est à la base du Web (tout comme le langage HTML qui a aussi été inventé par ce même monsieur ;) ).</p><p id="r-908180" data-claire-element-id="908180">Que dit la norme HTTP ? Que le serveur doit indiquer le <em>type de données</em> qu'il s'apprête à envoyer au client. Eh oui, un serveur peut renvoyer différents types de données :</p><ul id="r-908195" data-claire-element-id="908195"><li id="r-908182" data-claire-element-id="908182"><p id="r-908181" data-claire-element-id="908181">Du texte brut : text/plain</p></li><li id="r-908184" data-claire-element-id="908184"><p id="r-908183" data-claire-element-id="908183">Du HTML : text/html</p></li><li id="r-908186" data-claire-element-id="908186"><p id="r-908185" data-claire-element-id="908185">Du CSS : text/css</p></li><li id="r-908188" data-claire-element-id="908188"><p id="r-908187" data-claire-element-id="908187">Une image JPEG : image/jpeg</p></li><li id="r-908190" data-claire-element-id="908190"><p id="r-908189" data-claire-element-id="908189">Une vidéo MPEG4 : video/mp4</p></li><li id="r-908192" data-claire-element-id="908192"><p id="r-908191" data-claire-element-id="908191">Un fichier ZIP : application/zip</p></li><li id="r-908194" data-claire-element-id="908194"><p id="r-908193" data-claire-element-id="908193">etc.</p></li></ul><p id="r-908196" data-claire-element-id="908196">Ce sont ce qu'on appelle les types MIME. Ils sont envoyés dans l'en-tête de la réponse du serveur.<br/> Vous vous souvenez comment on écrit dans l'en-tête de la réponse avec Node.js ? Nous avions écrit ceci :</p><pre id="r-908197" data-claire-element-id="908197"><code data-claire-semantic="javascript">res.writeHead(200);</code></pre><p id="r-908198" data-claire-element-id="908198">Nous avions seulement indiqué le code de réponse 200 qui signifie &quot;OK, pas d'erreur&quot;. Nous devons rajouter un paramètre qui indique le type MIME de la réponse. Pour HTML, ce sera donc :</p><pre id="r-908199" data-claire-element-id="908199"><code data-claire-semantic="javascript">res.writeHead(200, {&quot;Content-Type&quot;: &quot;text/html&quot;});</code></pre><aside id="r-908201" data-claire-element-id="908201" data-claire-semantic="information"><p id="r-908200" data-claire-element-id="908200">Le second paramètre est entre accolades car on peut y envoyer plusieurs valeurs sous forme de tableau.</p></aside><p id="r-908202" data-claire-element-id="908202">Maintenant que c'est fait, nous pouvons renvoyer du HTML dans la réponse !</p><pre id="r-908203" data-claire-element-id="908203"><code data-claire-semantic="javascript">res.end('&lt;p&gt;Voici un paragraphe &lt;strong&gt;HTML&lt;/strong&gt; !&lt;/p&gt;');</code></pre><p id="r-908204" data-claire-element-id="908204">Au final, notre code ressemble donc maintenant à ceci :</p><pre id="r-908205" data-claire-element-id="908205"><code data-claire-semantic="javascript">var http = require('http');

var server = http.createServer(function(req, res) {
    res.writeHead(200, {&quot;Content-Type&quot;: &quot;text/html&quot;});
    res.end('&lt;p&gt;Voici un paragraphe &lt;strong&gt;HTML&lt;/strong&gt; !&lt;/p&gt;');
});
server.listen(8080);</code></pre><p id="r-908206" data-claire-element-id="908206">Essayez-le comme vous l'avez appris, en lançant l'application avec la commande <code data-claire-semantic="console">node</code> dans la console et en ouvrant votre navigateur sur http://localhost:8080 :</p><figure id="r-un-paragraphe-html-renvoye-par-notre-appli-node-js" data-claire-element-id="908209"><img id="r-908207" data-claire-element-id="908207" src="medias/uploads.siteduzero.com_files_421001_422000_421250.png" alt="Un paragraphe HTML renvoyé par notre appli Node.js"/><figcaption>Un paragraphe HTML renvoyé par notre appli Node.js</figcaption></figure><p id="r-908210" data-claire-element-id="908210">Votre paragraphe de texte s'affiche et est bien mis en forme comme prévu ! :)</p><div id="r-908212" data-claire-element-id="908212" data-claire-semantic="question"><p id="r-908211" data-claire-element-id="908211">Mais... le code HTML n'est pas valide non ?! On n'a pas écrit de doctype, ni la balise <code data-claire-semantic="html">&lt;html&gt;</code>, ni la balise <code data-claire-semantic="html">&lt;body&gt;</code>... :euh:</p></div><p id="r-908213" data-claire-element-id="908213">Grmpf, vous m'avez pris la main dans le sac ! Un code HTML invalide, j'ai honte. :honte:</p><p id="r-908214" data-claire-element-id="908214">Allez réparons ça ! C'est facile, il suffit d'envoyer toutes les autres balises qui manquent.</p><aside id="r-908216" data-claire-element-id="908216" data-claire-semantic="information"><p id="r-908215" data-claire-element-id="908215">Jusqu'ici, nous avions toujours écrit le code HTML dans <code data-claire-semantic="javascript">res.end()</code>. Pour mieux découper le code, à partir de maintenant j'utilise la commande <code data-claire-semantic="javascript">res.write()</code> qui permet d'écrire la réponse en plusieurs temps. Ca revient au même, mais notre code est mieux découplé comme ça.<br/><code data-claire-semantic="javascript">res.end()</code> doit toujours être appelé en dernier pour terminer la réponse et faire en sorte que le serveur envoie le résultat au client.</p></aside><pre id="r-908217" data-claire-element-id="908217"><code data-claire-semantic="javascript">var http = require('http');

var server = http.createServer(function(req, res) {
    res.writeHead(200, {&quot;Content-Type&quot;: &quot;text/html&quot;});
    res.write('&lt;!DOCTYPE html&gt;'+
'&lt;html&gt;'+
'    &lt;head&gt;'+
'        &lt;meta charset=&quot;utf-8&quot; /&gt;'+
'        &lt;title&gt;Ma page Node.js !&lt;/title&gt;'+
'    &lt;/head&gt;'+ 
'    &lt;body&gt;'+
'     	&lt;p&gt;Voici un paragraphe &lt;strong&gt;HTML&lt;/strong&gt; !&lt;/p&gt;'+
'    &lt;/body&gt;'+
'&lt;/html&gt;');
    res.end();
});
server.listen(8080);</code></pre><div id="r-908219" data-claire-element-id="908219" data-claire-semantic="question"><p id="r-908218" data-claire-element-id="908218">Waaah ! Mais c'est atroce d'écrire du HTML comme ça ! :waw:</p></div><p id="r-908220" data-claire-element-id="908220">Hé ho, on fait ce qu'on peut avec ce qu'on a !<br/> Node.js est bas niveau, je vous l'ai pas déjà dit une bonne centaine de fois ? :p</p><p id="r-908221" data-claire-element-id="908221">Je vous rassure, aucun développeur ne s'amusera vraiment à faire des pages web HTML complexes comme ça là-dedans. Il existe des moyens de séparer le code HTML du code JavaScript : ce sont les systèmes de templates. C'est un peu hors sujet pour le moment, étant donné qu'on commence tout juste à découvrir les bases de Node.js. Mais si le sujet vous intéresse, sachez qu'il existe des <a href="https://github.com/joyent/node/wiki/modules#wiki-templating">tonnes de modules Node.js dédiés aux templates</a>. Le choix est immense !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
<span class="arrow"></span>
<span class="next">Construire son serveur HTTP</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
<span class="next">Déterminer la page appelée et les paramètres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Dterminerlapageappeleetlesparamtres"></a><h2>Déterminer la page appelée et les paramètres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
<span class="arrow"></span>
<span class="next">Retourner du code HTML</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">
<span class="next">Les évènements</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908223" data-claire-element-id="908223">Nous savons renvoyer du code HTML, mais pour le moment notre application... renvoie toujours la même chose ! Comment fait-on pour créer différentes pages avec Node.js ?</p><p id="r-908224" data-claire-element-id="908224">Essayez notre petite application sur différentes URLs. Quelle que soit la page appelée...</p><ul id="r-908231" data-claire-element-id="908231"><li id="r-908226" data-claire-element-id="908226"><p id="r-908225" data-claire-element-id="908225">http://localhost:8080</p></li><li id="r-908228" data-claire-element-id="908228"><p id="r-908227" data-claire-element-id="908227">http://localhost:8080/mapage</p></li><li id="r-908230" data-claire-element-id="908230"><p id="r-908229" data-claire-element-id="908229">http://localhost:8080/dossier/autrepage...)</p></li></ul><p id="r-908232" data-claire-element-id="908232">... la page qui s'affiche est toujours la même !</p><p id="r-908233" data-claire-element-id="908233">Il faut qu'on sache quelle est la page demandée par le visiteur. Pour l'instant, vu qu'on ne fait aucun test, notre application renvoie toujours la même chose.</p><p id="r-908234" data-claire-element-id="908234">Nous allons découvrir comment récupérer :</p><ul id="r-908239" data-claire-element-id="908239"><li id="r-908236" data-claire-element-id="908236"><p id="r-908235" data-claire-element-id="908235">Le nom de la page demandée (/mapage, /page.html, /dossier/autrepage...)</p></li><li id="r-908238" data-claire-element-id="908238"><p id="r-908237" data-claire-element-id="908237">Les paramètres qui circulent dans l'URL (ex : http://localhost:8080/mapage?nom=dupont&amp;prenom=robert).</p></li></ul><h2 id="r-quelle-est-la-page-demandee-par-le-visiteur" data-claire-element-id="908267">Quelle est la page demandée par le visiteur ?</h2><p id="r-908240" data-claire-element-id="908240">Pour récupérer la page demandée par le visiteur, on va faire appel à un nouveau module de Node appelé &quot;url&quot;. On demande son inclusion avec :</p><pre id="r-908241" data-claire-element-id="908241"><code data-claire-semantic="javascript">var url = require(&quot;url&quot;);</code></pre><p id="r-908242" data-claire-element-id="908242">Ensuite, il nous suffit de &quot;parser&quot; la requête du visiteur comme ceci pour obtenir le nom de la page demandée :</p><pre id="r-908243" data-claire-element-id="908243"><code data-claire-semantic="javascript">url.parse(req.url).pathname;</code></pre><p id="r-908244" data-claire-element-id="908244">Voici un code très simple qui nous permet de tester ça :</p><pre id="r-908245" data-claire-element-id="908245"><code data-claire-semantic="javascript">var http = require('http');
var url = require('url');

var server = http.createServer(function(req, res) {
    var page = url.parse(req.url).pathname;
    console.log(page);
    res.writeHead(200, {&quot;Content-Type&quot;: &quot;text/plain&quot;});
    res.write('Bien le bonjour');
    res.end();
});
server.listen(8080);</code></pre><p id="r-908246" data-claire-element-id="908246">Exécutez ce script et lancez votre navigateur à l'adresse http://localhost:8080 pour commencer. Retournez ensuite dans la console. Nous y loggons le nom de la page demandée. Vous devriez y voir :</p><pre id="r-908247" data-claire-element-id="908247"><code data-claire-semantic="console">/
/favicon.ico</code></pre><div id="r-908249" data-claire-element-id="908249" data-claire-semantic="question"><p id="r-908248" data-claire-element-id="908248">Je n'ai chargé que la page d'accueil, pourquoi est-ce que je vois /favicon.ico ?</p></div><p id="r-908250" data-claire-element-id="908250">La plupart des navigateurs font en réalité une seconde requête pour récupérer l'icône du site (la &quot;favicon&quot; qu'on voit dans les onglets en général). C'est normal, ne vous en préoccupez pas.</p><p id="r-908251" data-claire-element-id="908251">Essayez maintenant de charger des &quot;fausses pages&quot; de votre site pour voir ce que ça fait.</p><pre id="r-908252" data-claire-element-id="908252"><code data-claire-semantic="console">/testpage
/favicon.ico
/un/long/chemin/
/favicon.ico
/faussepage.html
/favicon.ico</code></pre><p id="r-908253" data-claire-element-id="908253">Si on omet les favicon.ico qui viennent un peu polluer la console, on voit que j'ai essayé de charger les pages suivantes :</p><ul id="r-908260" data-claire-element-id="908260"><li id="r-908255" data-claire-element-id="908255"><p id="r-908254" data-claire-element-id="908254">http://localhost:8080/testpage</p></li><li id="r-908257" data-claire-element-id="908257"><p id="r-908256" data-claire-element-id="908256">http://localhost:8080/un/long/chemin</p></li><li id="r-908259" data-claire-element-id="908259"><p id="r-908258" data-claire-element-id="908258"><a href="http://localhost:8080/faussepage.html">http://localhost:8080/faussepage.html</a></p></li></ul><div id="r-908262" data-claire-element-id="908262" data-claire-semantic="question"><p id="r-908261" data-claire-element-id="908261">Bon et alors ? Mon site renvoie toujours la même chose quelle que soit la page appelée malgré tout !</p></div><p id="r-908263" data-claire-element-id="908263">Eh bien vous êtes des grands, vous devriez savoir comment faire pour renvoyer un message différent en fonction de la page demandée ! Non ? Une petite condition, un petit if, ça vous dit rien ? ;)</p><pre id="r-908264" data-claire-element-id="908264"><code data-claire-semantic="javascript">var http = require('http');
var url = require('url');

var server = http.createServer(function(req, res) {
    var page = url.parse(req.url).pathname;
    console.log(page);
    res.writeHead(200, {&quot;Content-Type&quot;: &quot;text/plain&quot;});
    if (page == '/') {
        res.write('Vous êtes à l\'accueil, que puis-je pour vous ?');
    }
    else if (page == '/sous-sol') {
        res.write('Vous êtes dans la cave à vins, ces bouteilles sont à moi !');
    }
    else if (page == '/etage/1/chambre') {
        res.write('Hé ho, c\'est privé ici !');
    }
    res.end();
});
server.listen(8080);</code></pre><p id="r-908265" data-claire-element-id="908265">Hé oui, c'est basique, c'est <em>roots</em>, c'est parce que Node.js est bas niv... bon OK je me tais. :D</p><p id="r-908266" data-claire-element-id="908266">Allez un petit défi pour vous entraîner : faites en sorte d'afficher un message d'erreur si le visiteur demande une page inconnue. Et n'oubliez pas de renvoyer un code d'erreur 404 !</p><h2 id="r-quels-sont-les-parametres" data-claire-element-id="908283">Quels sont les paramètres ?</h2><p id="r-908268" data-claire-element-id="908268">Les paramètres sont envoyés à la fin de l'URL, après le chemin du fichier. Prenez cette URL par exemple :</p><p id="r-908269" data-claire-element-id="908269">http://localhost:8080/page?prenom=Robert&amp;nom=Dupont</p><p id="r-908270" data-claire-element-id="908270">Les paramètres sont contenus dans la chaîne ?prenom=Robert&amp;nom=Dupont. Pour récupérer cette chaîne, il suffit de faire appel à :</p><pre id="r-908271" data-claire-element-id="908271"><code data-claire-semantic="javascript">url.parse(req.url).query</code></pre><p id="r-908272" data-claire-element-id="908272">Le problème, c'est qu'on vous renvoie toute la chaîne sans découper au préalable les différents paramètres. Heureusement, il existe un module Node.js qui s'en charge pour nous : querystring !</p><p id="r-908273" data-claire-element-id="908273">Incluez ce module :</p><pre id="r-908274" data-claire-element-id="908274"><code data-claire-semantic="javascript">var querystring = require('querystring');</code></pre><p id="r-908275" data-claire-element-id="908275">Vous pourrez ensuite faire :</p><pre id="r-908276" data-claire-element-id="908276"><code data-claire-semantic="javascript">var params = querystring.parse(url.parse(req.url).query);</code></pre><p id="r-908277" data-claire-element-id="908277">Vous disposerez alors d'un tableau de paramètres &quot;params&quot;. Pour récupérer le paramètre &quot;prenom&quot; par exemple, il suffira d'écrire : <code data-claire-semantic="javascript">params['prenom']</code>.</p><p id="r-908278" data-claire-element-id="908278">Amusons-nous avec un code complet qui affiche votre prénom et votre nom (pourvu que ceux-ci soient définis !) :</p><pre id="r-908279" data-claire-element-id="908279"><code data-claire-semantic="javascript">var http = require('http');
var url = require('url');
var querystring = require('querystring');

var server = http.createServer(function(req, res) {
    var params = querystring.parse(url.parse(req.url).query);
    res.writeHead(200, {&quot;Content-Type&quot;: &quot;text/plain&quot;});
    if ('prenom' in params &amp;&amp; 'nom' in params) {
        res.write('Vous vous appelez ' + params['prenom'] + ' ' + params['nom']);
    }
    else {
        res.write('Vous devez bien avoir un prénom et un nom, non ?');
    }
    res.end();
});
server.listen(8080);</code></pre><p id="r-908280" data-claire-element-id="908280">Essayez d'aller sur http://localhost:8080?prenom=Robert&amp;nom=Dupont pour voir, puis changez le prénom et le nom pour les remplacer par les vôtres !</p><aside id="r-908282" data-claire-element-id="908282" data-claire-semantic="information"><p id="r-908281" data-claire-element-id="908281">Deux petites précisions par rapport à ce code : 'prenom' in params me permet en JavaScript de tester si le tableau contient bien une entrée 'prenom'. S'il manque un paramètre, je peux alors afficher un message d'erreur (sinon mon script aurait affiché <code data-claire-semantic="javascript">undefined</code> à la place).<br/> Par ailleurs, vous constaterez que je ne vérifie pas la page qui est appelée. Ce code fonctionne aussi bien que l'on soit sur http://localhost:8080 ou sur http://localhost:8080/pageimaginaire. Il faudrait combiner ce code et le précédent pour gérer à la fois la page ET les paramètres.</p></aside><h2 id="r-schema-resume-5" data-claire-element-id="908288">Schéma résumé</h2><p id="r-908284" data-claire-element-id="908284">Allez, résumons ce qu'on vient d'apprendre dans un seul et unique schéma avant de terminer !</p><figure id="r-recuperer-l-url-et-les-parametres-avec-node-js" data-claire-element-id="908287"><img id="r-908285" data-claire-element-id="908285" src="medias/uploads.siteduzero.com_files_421001_422000_421255.png" alt="Récupérer l'URL et les paramètres avec Node.js"/><figcaption>Récupérer l'URL et les paramètres avec Node.js</figcaption></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
<span class="arrow"></span>
<span class="next">Retourner du code HTML</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">
<span class="next">Les évènements</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesvnements"></a><h2>Les évènements</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
<span class="arrow"></span>
<span class="next">Déterminer la page appelée et les paramètres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
<span class="next">Ecouter des évènements</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-908292" data-claire-element-id="908292">Node.js est un environnement de développement JavaScript basé sur les évènements. Je vous ai montré dans le premier chapitre ce que ça signifie : il y a un seul <em>thread</em> mais aucune opération n'est bloquante. Ainsi, les opérations un peu longues (chargement d'un fichier, téléchargement d'une page web, démarrage d'un serveur web...) sont lancées en tâche de fond et une fonction de <em>callback</em> est appelée quand l'opération est terminée.</p><figure id="r-le-modele-non-bloquant-en-programmation-1" data-claire-element-id="908295"><img id="r-908293" data-claire-element-id="908293" src="medias/uploads.siteduzero.com_files_421001_422000_421157.png" alt="Le modèle non bloquant en programmation"/><figcaption>Le modèle non bloquant en programmation</figcaption></figure><p id="r-908296" data-claire-element-id="908296">Les évènements sont à la base de Node.js. C'est ce qui fait que Node.js est puissant mais aussi un peu plus difficile à appréhender, puisque ça nous impose de coder avec beaucoup de fonctions de <em>callback</em>.</p><p id="r-908297" data-claire-element-id="908297">Je vous propose de rentrer ici dans les détails du fonctionnement des évènements Node.js. Nous verrons en particulier comment on peut <em>écouter</em> et <em>créer</em> des évènements. Tout développeur Node.js qui se respecte doit savoir faire ça, alors au boulot ! :D</p>
</div><a name="Ecouterdesvnements"></a><h2>Ecouter des évènements</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">
<span class="arrow"></span>
<span class="next">Les évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
<span class="next">Emettre des évènements</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908298" data-claire-element-id="908298">Surprise ! Vous savez déjà écouter des évènements en JavaScript. Allons, vous n'allez pas me faire croire que vous n'avez jamais utilisé une bibliothèque comme jQuery pour écouter des évènements sur votre page web !</p><p id="r-908299" data-claire-element-id="908299">Par exemple :</p><pre id="r-908300" data-claire-element-id="908300"><code data-claire-semantic="javascript">$(&quot;canvas&quot;).on(&quot;mouseleave&quot;, function() { ... });</code></pre><p id="r-908301" data-claire-element-id="908301">Avec ce genre d'instruction, vous demandez à exécuter une fonction de <em>callback</em> quand la souris sort d'un élément <code data-claire-semantic="html">&lt;canvas&gt;</code> de la page. On dit que vous attachez l'évènement au DOM de la page.</p><p id="r-908302" data-claire-element-id="908302">Avec Node.js, le principe est exactement le même. Un très très grand nombre d'objets Node.js émettent des évènements. Leur particularité ? lls héritent tous d'un objet EventEmitter fourni par Node.</p><p id="r-908303" data-claire-element-id="908303">Prenons par exemple le module &quot;http&quot; que nous avons utilisé pour créer notre serveur web. Il comprend un objet Server qui émet des évènements <a href="http://nodejs.org/api/http.html">d'après la doc</a> :</p><figure id="r-la-doc-de-node-js-indique-les-evenements-que-les-objets-emettent" data-claire-element-id="908306"><img id="r-908304" data-claire-element-id="908304" src="medias/uploads.siteduzero.com_files_421001_422000_421286.png" alt="La doc de Node.js indique les évènements que les objets émettent"/><figcaption>La doc de Node.js indique les évènements que les objets émettent</figcaption></figure><p id="r-908307" data-claire-element-id="908307">Comment écouter ces évènements ? Supposons par exemple qu'on souhaite écouter l'évènement &quot;close&quot; qui survient quand le serveur est arrêté. Il suffit de faire appel à la méthode <code data-claire-semantic="javascript">on()</code> et d'indiquer :</p><ul id="r-908312" data-claire-element-id="908312"><li id="r-908309" data-claire-element-id="908309"><p id="r-908308" data-claire-element-id="908308">Le nom de l'évènement que vous écoutez (ici &quot;close&quot;)</p></li><li id="r-908311" data-claire-element-id="908311"><p id="r-908310" data-claire-element-id="908310">La fonction de <em>callback</em> à appeler quand l'évènement survient</p></li></ul><p id="r-908313" data-claire-element-id="908313">Exemple :</p><pre id="r-908314" data-claire-element-id="908314"><code data-claire-semantic="javascript">server.on('close', function() {
    // Faire quelque chose quand le serveur est arrêté
})</code></pre><p id="r-908315" data-claire-element-id="908315">Je vous propose un exemple concret et complet. On va lancer un serveur et l'arrêter juste après. On écoute l'évènement close qui survient lorsque le serveur est arrêté. On affiche un message dans la console quand le serveur s'apprête à s'arrêter.</p><pre id="r-908316" data-claire-element-id="908316"><code data-claire-semantic="javascript">var http = require('http');

var server = http.createServer(function(req, res) {
  res.writeHead(200);
  res.end('Salut tout le monde !');
});

server.on('close', function() { // On écoute l'évènement close
    console.log('Bye bye !');
})

server.listen(8080); // Démarre le serveur

server.close(); // Arrête le serveur. Déclenche l'évènement close</code></pre><div id="r-908318" data-claire-element-id="908318" data-claire-semantic="question"><p id="r-908317" data-claire-element-id="908317">Mais au fait... <code data-claire-semantic="javascript">createServer()</code> comprend une fonction de <em>callback</em> lui aussi. Pourquoi on n'utilise pas <code data-claire-semantic="javascript">on()</code> ici ?</p></div><p id="r-908319" data-claire-element-id="908319">Bien vu ! En fait, c'est une contraction de code. Lisez la doc de <a href="http://nodejs.org/api/http.html#http_http_createserver_requestlistener">createServer()</a> : elle dit que la fonction de callback qu'on lui envoie en paramètre est automatiquement ajoutée à l'évènement &quot;request&quot; !</p><p id="r-908320" data-claire-element-id="908320">Donc ce code :</p><pre id="r-908321" data-claire-element-id="908321"><code data-claire-semantic="javascript">var server = http.createServer(function(req, res) { });</code></pre><p id="r-908322" data-claire-element-id="908322">... peut être réécrit comme ceci de façon plus détaillée :</p><pre id="r-908323" data-claire-element-id="908323"><code data-claire-semantic="javascript">// Code équivalent au précédent
var server = http.createServer();
server.on('request', function(req, res) { });</code></pre><p id="r-908324" data-claire-element-id="908324">Bref, les évènements sont partout, vous ne pouvez pas y échapper ! :D <br/> Certains sont simplement un peu &quot;masqués&quot; comme c'est le cas ici, mais il est important de savoir ce qui se passe derrière.</p><aside id="r-908326" data-claire-element-id="908326" data-claire-semantic="information"><p id="r-908325" data-claire-element-id="908325">Vous pouvez écouter plusieurs fois un même évènement. Faites deux fois appel à la fonction <code data-claire-semantic="javascript">on()</code> pour le même évènement : les deux fonctions de <em>callback</em> seront appelées quand l'évènement aura lieu.</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">
<span class="arrow"></span>
<span class="next">Les évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
<span class="next">Emettre des évènements</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Emettredesvnements"></a><h2>Emettre des évènements</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
<span class="arrow"></span>
<span class="next">Ecouter des évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">
<span class="next">Les modules Node.js et NPM</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908328" data-claire-element-id="908328">Si vous voulez émettre des évènements vous aussi, c'est très simple : incluez le module EventEmitter et créez un objet basé sur EventEmitter.</p><pre id="r-908329" data-claire-element-id="908329"><code data-claire-semantic="javascript">var EventEmitter = require('events').EventEmitter;

var jeu = new EventEmitter();</code></pre><p id="r-908330" data-claire-element-id="908330">Ensuite, pour émettre un évènement dans votre code, il suffit de faire appel à <code data-claire-semantic="javascript">emit()</code> depuis votre objet basé sur EventEmitter. Indiquez :</p><ul id="r-908335" data-claire-element-id="908335"><li id="r-908332" data-claire-element-id="908332"><p id="r-908331" data-claire-element-id="908331">Le nom de l'évènement que vous voulez générer (ex : &quot;gameover&quot;). A vous de le choisir.</p></li><li id="r-908334" data-claire-element-id="908334"><p id="r-908333" data-claire-element-id="908333">Un ou plusieurs éventuels paramètres à passer (facultatif)</p></li></ul><p id="r-908336" data-claire-element-id="908336">Ici, je génère un évènement &quot;gameover&quot; et j'envoie un message à celui qui réceptionnera l'évènement via un paramètre :</p><pre id="r-908337" data-claire-element-id="908337"><code data-claire-semantic="javascript">jeu.emit('gameover', 'Vous avez perdu !');</code></pre><p id="r-908338" data-claire-element-id="908338">Celui qui veut écouter l'évènement doit faire ensuite :</p><pre id="r-908339" data-claire-element-id="908339"><code data-claire-semantic="javascript">jeu.on('gameover', function(message) { });</code></pre><p id="r-908340" data-claire-element-id="908340">Voici un code complet pour tester l'émission d'évènements :</p><pre id="r-908341" data-claire-element-id="908341"><code data-claire-semantic="javascript">var EventEmitter = require('events').EventEmitter;

var jeu = new EventEmitter();

jeu.on('gameover', function(message){
    console.log(message);
});

jeu.emit('gameover', 'Vous avez perdu !');</code></pre><p id="r-908342" data-claire-element-id="908342">Bon, j'admets, c'est un peu trop simple. Ce code se contente d'émettre un évènement. Dans la réalité, les évènements seront émis depuis des fonctions imbriquées dans d'autres fonctions, et c'est de là que Node.js tire toute sa richesse.</p><p id="r-908343" data-claire-element-id="908343">En tout cas comme vous le voyez, le principe n'est pas franchement compliqué à comprendre ! :)</p><aside id="r-908346" data-claire-element-id="908346" data-claire-semantic="information"><p id="r-908344" data-claire-element-id="908344">N'oubliez pas que vous pouvez envoyer autant de paramètres que nécessaire à la fonction de callback. Emettez simplement plus de paramètres :</p><pre id="r-908345" data-claire-element-id="908345"><code data-claire-semantic="javascript">jeu.emit('nouveaujoueur', 'Mario', 35); // Envoie le nom d'un nouveau joueur qui arrive et son âge</code></pre></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
<span class="arrow"></span>
<span class="next">Ecouter des évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">
<span class="next">Les modules Node.js et NPM</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LesmodulesNode.jsetNPM"></a><h2>Les modules Node.js et NPM</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
<span class="arrow"></span>
<span class="next">Emettre des évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
<span class="next">Créer des modules</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-908349" data-claire-element-id="908349">Croyez-le ou non, le noyau de Node.js est tout petit. De base, Node.js ne sait en fait pas faire grand chose.</p><p id="r-908350" data-claire-element-id="908350">Pourtant, Node.js est très riche grâce à son extensibilité. Ces extensions de Node.js sont appelées <strong>modules</strong>.</p><p id="r-908351" data-claire-element-id="908351">Il existe des milliers de modules qui offrent des fonctionnalités variées : de la gestion des fichiers uploadés à la connexion aux bases de données MySQL ou à Redis, en passant par des frameworks, des systèmes de templates et la gestion de la communication temps réel avec le visiteur ! Il y a à peu près tout ce dont on peut rêver et de nouveaux modules apparaissent chaque jour.</p><p id="r-908352" data-claire-element-id="908352">Nous allons commencer par voir comment sont gérés les modules par Node.js et nous verrons que nous pouvons facilement en créer un nous aussi. Puis, nous découvrirons NPM (Node Package Manager), l'outil indispensable qui vous permet de télécharger facilement tous les modules de la communauté Node.js ! Enfin, je vous montrerai comment accéder à la gloire éternelle en publiant votre module sur NPM. :soleil:</p>
</div><a name="Crerdesmodules"></a><h2>Créer des modules</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">
<span class="arrow"></span>
<span class="next">Les modules Node.js et NPM</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
<span class="next">Utiliser NPM pour installer des modules</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908353" data-claire-element-id="908353">Vous souvenez-vous de cette ligne ?</p><pre id="r-908354" data-claire-element-id="908354"><code data-claire-semantic="javascript">var http = require('http');</code></pre><p id="r-908355" data-claire-element-id="908355">Elle était tout au début de notre premier code. Je vous avais dit que c'était un appel à la bibliothèque &quot;http&quot; de Node.js (ou devrais-je dire au <em>module</em> &quot;http&quot;).</p><p id="r-908356" data-claire-element-id="908356">Quand on fait ça, Node.js va chercher sur notre disque un fichier appelé <code>http.js</code>. De même, si on demande le module &quot;url&quot;, Node.js va rechercher un fichier appelé url.js.</p><pre id="r-908357" data-claire-element-id="908357"><code data-claire-semantic="javascript">var http = require('http'); // Fait appel à http.js
var url = require('url'); // Fait appel à url.js</code></pre><div id="r-908359" data-claire-element-id="908359" data-claire-semantic="question"><p id="r-908358" data-claire-element-id="908358">Où sont ces fichiers .js ? Je ne les vois pas !</p></div><p id="r-908360" data-claire-element-id="908360">Ils sont quelque part bien au chaud sur votre disque, leur position ne nous intéresse pas. ;) <br/> Etant donné qu'ils font partie du noyau de Node.js, ils sont tout le temps disponibles.</p><p id="r-908361" data-claire-element-id="908361">Les modules sont donc de simples fichiers .js. Si nous voulons créer un module, disons le module &quot;test&quot;, nous devons créer un fichier test.js dans le même dossier et y faire appel comme ceci :</p><pre id="r-908362" data-claire-element-id="908362"><code data-claire-semantic="javascript">var test = require('./test'); // Fait appel à test.js (même dossier)</code></pre><aside id="r-908364" data-claire-element-id="908364" data-claire-semantic="warning"><p id="r-908363" data-claire-element-id="908363">Il ne faut pas mettre l'extension .js dans le <code data-claire-semantic="javascript">require()</code> !</p></aside><p id="r-908365" data-claire-element-id="908365">C'est un chemin relatif. Si le module se trouve dans le dossier parent, nous pouvons l'inclure comme ceci :</p><pre id="r-908366" data-claire-element-id="908366"><code data-claire-semantic="javascript">var test = require('../test'); // Fait appel à test.js (dossier parent)</code></pre><div id="r-908368" data-claire-element-id="908368" data-claire-semantic="question"><p id="r-908367" data-claire-element-id="908367">Et si je ne veux pas mettre de chemin relatif ? Je ne peux pas juste faire <code data-claire-semantic="javascript">require('test')</code> ?</p></div><p id="r-908369" data-claire-element-id="908369">Si vous pouvez ! Il faut mettre votre fichier test.js dans un sous-dossier appelé &quot;node_modules&quot;. C'est une convention de Node.js :</p><pre id="r-908370" data-claire-element-id="908370"><code data-claire-semantic="javascript">var test = require('test'); // Fait appel à test.js (sous-dossier node_modules)</code></pre><p id="r-908371" data-claire-element-id="908371">En résumé :</p><figure id="r-node-js-sait-ou-chercher-les-modules" data-claire-element-id="908374"><img id="r-908372" data-claire-element-id="908372" src="medias/uploads.siteduzero.com_files_421001_422000_421271.png" alt="Node.js sait où chercher les modules"/><figcaption>Node.js sait où chercher les modules</figcaption></figure><p id="r-908375" data-claire-element-id="908375">Notez que si le dossier node_modules n'existe pas, Node.js ira chercher un dossier qui a le même nom plus haut dans l'arborescence. Ainsi, si votre projet se trouve dans le dossier : /home/mateo21/dev/nodejs/projet, il ira chercher un dossier nommé :</p><ul id="r-908382" data-claire-element-id="908382"><li id="r-908377" data-claire-element-id="908377"><p id="r-908376" data-claire-element-id="908376">/home/mateo21/dev/nodejs/projet/node_modules, et si ce dossier n'existe pas il ira le chercher dans...</p></li><li id="r-908379" data-claire-element-id="908379"><p id="r-908378" data-claire-element-id="908378">... /home/mateo21/dev/nodejs/node_modules, et si ce dossier n'existe pas il ira le chercher dans...</p></li><li id="r-908381" data-claire-element-id="908381"><p id="r-908380" data-claire-element-id="908380">... /home/mateo21/dev/node_modules, et ainsi de suite !</p></li></ul><div id="r-908384" data-claire-element-id="908384" data-claire-semantic="question"><p id="r-908383" data-claire-element-id="908383">A quoi ressemble le code des fichiers .js des modules ?</p></div><p id="r-908385" data-claire-element-id="908385">C'est du code JavaScript tout ce qu'il y a de plus classique. Vous y créez des fonctions.<br/> Une seule particularité : vous devez &quot;exporter&quot; les fonctions que vous voulez que d'autres personnes puissent réutiliser.</p><p id="r-908386" data-claire-element-id="908386">Testons ça ! On va créer un module tout bête qui sait dire &quot;Bonjour !&quot; et &quot;Bye bye !&quot;. Créez un fichier monmodule.js avec le code suivant :</p><pre id="r-908387" data-claire-element-id="908387"><code data-claire-semantic="javascript">var direBonjour = function() {
    console.log('Bonjour !');
}

var direByeBye = function() {
    console.log('Bye bye !');
}

exports.direBonjour = direBonjour;
exports.direByeBye = direByeBye;</code></pre><p id="r-908388" data-claire-element-id="908388">Le début du fichier ne contient rien de nouveau. Nous créons des fonctions que nous plaçons dans des variables. D'où le <code data-claire-semantic="javascript">var direBonjour = function()</code>...</p><p id="r-908389" data-claire-element-id="908389">Ensuite, et c'est la nouveauté, nous exportons ces fonctions pour qu'elles soient utilisables de l'extérieur : <code data-claire-semantic="javascript">exports.direBonjour = direBonjour;</code>. Notez d'ailleurs qu'on aurait aussi pu faire directement :</p><pre id="r-908390" data-claire-element-id="908390"><code data-claire-semantic="javascript">exports.direBonjour = function() { ... };</code></pre><aside id="r-908392" data-claire-element-id="908392" data-claire-semantic="information"><p id="r-908391" data-claire-element-id="908391">Toutes les fonctions que vous n'exportez pas dans votre fichier de module resteront privées. Elles ne pourront pas être appelées de l'extérieur.<br/> En revanche, elles pourront tout à fait être utilisées par d'autres fonctions de votre module.</p></aside><p id="r-908393" data-claire-element-id="908393">Maintenant, dans le fichier principal de votre application (ex : app.js), vous pouvez faire appel à ces fonctions issues du module !</p><pre id="r-908394" data-claire-element-id="908394"><code data-claire-semantic="javascript">var monmodule = require('./monmodule');

monmodule.direBonjour();
monmodule.direByeBye();</code></pre><p id="r-908395" data-claire-element-id="908395"><code data-claire-semantic="javascript">require()</code> renvoie en fait un objet qui contient les fonctions que vous avez exportées dans votre module. Nous stockons cet objet dans une variable du même nom <code data-claire-semantic="javascript">monmodule</code> (mais on aurait pu lui donner n'importe quel autre nom).</p><figure id="r-exportation-d-une-fonction" data-claire-element-id="908398"><img id="r-908396" data-claire-element-id="908396" src="medias/uploads.siteduzero.com_files_421001_422000_421272.png" alt="Exportation d'une fonction"/><figcaption>Exportation d'une fonction</figcaption></figure><p id="r-908399" data-claire-element-id="908399">Voilà, vous savez tout ! Tous les modules de Node.js sont basés sur ce principe très simple. :)</p><p id="r-908400" data-claire-element-id="908400">Cela vous permet de découper votre projet en plusieurs petits fichiers pour répartir les rôles.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">
<span class="arrow"></span>
<span class="next">Les modules Node.js et NPM</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
<span class="next">Utiliser NPM pour installer des modules</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="UtiliserNPMpourinstallerdesmodules"></a><h2>Utiliser NPM pour installer des modules</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
<span class="arrow"></span>
<span class="next">Créer des modules</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
<span class="next">Déclarer et publier son module</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908402" data-claire-element-id="908402">Je vous ai parlé en introduction de NPM (le Node Package Manager). Je vous ai dit que c'était un moyen (formidable) d'installer de nouveaux modules développés par la communauté.</p><p id="r-908403" data-claire-element-id="908403">Imaginez que NPM est un peu l'équivalent d'apt-get sous Linux pour installer des programmes. Une simple commande et le module est téléchargé et installé !<br/> En plus, NPM gère les dépendances. Cela signifie que, si un module a besoin d'un autre module pour fonctionner, NPM ira le télécharger automatiquement !</p><p id="r-908404" data-claire-element-id="908404">NPM possède un site web : <a href="http://npmjs.org/">http://npmjs.org</a></p><figure id="r-le-site-web-de-npm" data-claire-element-id="908407"><img id="r-908405" data-claire-element-id="908405" src="medias/uploads.siteduzero.com_files_421001_422000_421274.png" alt="Le site web de NPM"/><figcaption>Le site web de NPM</figcaption></figure><p id="r-908408" data-claire-element-id="908408">Comme vous pouvez le voir, NPM est très actif. Il y a plusieurs dizaines de milliers de modules disponibles, et on compte plusieurs millions de téléchargements par semaine ! Si vous n'y trouvez pas votre bonheur, c'est que vous le faites exprès. :D</p><p id="r-908409" data-claire-element-id="908409">Comme le dit le site web de NPM, il est aussi simple d'installer de nouveaux modules que de publier ses propres modules. C'est en bonne partie ce qui explique le grand succès de Node.js.</p><div id="r-908411" data-claire-element-id="908411" data-claire-semantic="question"><p id="r-908410" data-claire-element-id="908410">Comment trouver un module là-dedans ? Autant chercher une aiguille dans une botte de foin ! :(</p></div><p id="r-908412" data-claire-element-id="908412">C'est assez facile en fait. Je vais vous montrer plusieurs moyens de trouver des modules !</p><h2 id="r-trouver-un-module" data-claire-element-id="908420">Trouver un module</h2><p id="r-908413" data-claire-element-id="908413">Si vous savez ce que vous cherchez, le site web de NPM vous permet de faire une recherche. Mais NPM, c'est avant tout une commande ! Vous pouvez faire une recherche dans la console, comme ceci :</p><pre id="r-908414" data-claire-element-id="908414"><code data-claire-semantic="console">npm search postgresql</code></pre><p id="r-908415" data-claire-element-id="908415">... ce qui aura pour effet de rechercher tous les modules en rapport avec la base de données PostgreSQL par exemple.</p><p id="r-908416" data-claire-element-id="908416">Si comme moi vous voulez flâner un peu et que vous ne savez pas trop ce que vous recherchez, vous aimerez sûrement <a href="http://nodetoolbox.com/">http://nodetoolbox.com/</a> qui organise les modules par thématique.</p><figure id="r-le-site-node-toolbox-est-un-bon-moyen-de-decouvrir-de-nouveaux-modules" data-claire-element-id="908419"><img id="r-908417" data-claire-element-id="908417" src="medias/uploads.siteduzero.com_files_421001_422000_421275.png" alt="Le site Node Toolbox est un bon moyen de découvrir de nouveaux modules"/><figcaption>Le site Node Toolbox est un bon moyen de découvrir de nouveaux modules</figcaption></figure><h2 id="r-installer-un-module" data-claire-element-id="908434">Installer un module</h2><p id="r-908421" data-claire-element-id="908421">Pour installer un module, rien de plus simple. Placez-vous dans le dossier de votre projet et tapez :</p><pre id="r-908422" data-claire-element-id="908422"><code data-claire-semantic="console">npm install nomdumodule</code></pre><p id="r-908423" data-claire-element-id="908423">Le module sera installé <em>localement</em> spécialement pour votre projet.<br/> Si vous avez un autre projet, il faudra donc relancer la commande pour l'installer à nouveau pour cet autre projet. Cela vous permet d'utiliser des versions différentes d'un même module en fonction de vos projets.</p><p id="r-908424" data-claire-element-id="908424">Allez faisons un test. On va installer le module markdown qui permet de convertir du code markdown en HTML.</p><pre id="r-908425" data-claire-element-id="908425"><code data-claire-semantic="console">npm install markdown</code></pre><p id="r-908426" data-claire-element-id="908426">NPM va télécharger automatiquement la dernière version du module et il va la placer dans un sous-dossier node_modules. Vérifiez donc bien que vous êtes dans le dossier de votre projet Node.js avant de lancer cette commande !</p><p id="r-908427" data-claire-element-id="908427">Une fois que c'est fait, vous avez accès aux fonctions offertes par le module markdown. Lisez la <a href="http://nodetoolbox.com/packages/markdown">doc du module</a> pour savoir comment l'utiliser. On nous apprend qu'il faut faire appel à l'objet markdown à l'intérieur du module et qu'on peut appeler la fonction toHTML pour traduire du Markdown en HTML.</p><p id="r-908428" data-claire-element-id="908428">Essayons ça :</p><pre id="r-908429" data-claire-element-id="908429"><code data-claire-semantic="javascript">var markdown = require('markdown').markdown;

console.log(markdown.toHTML('Un paragraphe en **markdown** !'));</code></pre><p id="r-908430" data-claire-element-id="908430">... affichera dans la console :</p><pre id="r-908431" data-claire-element-id="908431"><code data-claire-semantic="console">&lt;p&gt;Un paragraphe en &lt;strong&gt;markdown&lt;/strong&gt; !&lt;/p&gt;</code></pre><aside id="r-908433" data-claire-element-id="908433" data-claire-semantic="information"><p id="r-908432" data-claire-element-id="908432">Ne soyez pas surpris par le <code data-claire-semantic="javascript">require('markdown').markdown</code>. La doc du module nous dit que les fonctions sont dans l'objet &quot;markdown&quot;, donc on va chercher directement cet objet au sein du module.</p></aside><h2 id="r-l-installation-locale-et-l-installation-globale" data-claire-element-id="908443">L'installation locale et l'installation globale</h2><p id="r-908435" data-claire-element-id="908435">NPM installe les modules localement pour chaque projet. C'est pour cela qu'il crée un sous-dossier node_modules à l'intérieur de votre projet.<br/> Si vous utilisez le même module dans 3 projets différents, il sera téléchargé et copié 3 fois. C'est normal, cela nous permet de gérer les différences de version. C'est donc une bonne chose.</p><p id="r-908436" data-claire-element-id="908436">Par contre, il faut savoir que NPM permet aussi d'installer des modules globaux. Ca ne nous sert que dans de rares cas où le module fournit des exécutables (et pas juste des fichiers .js).</p><p id="r-908437" data-claire-element-id="908437">C'est le cas de notre module markdown par exemple. Pour l'installer globalement, on va ajouter le paramètre -g à la commande npm :</p><pre id="r-908438" data-claire-element-id="908438"><code data-claire-semantic="console">npm install markdown -g</code></pre><p id="r-908439" data-claire-element-id="908439">Vous aurez alors accès à un exécutable md2html dans votre console :</p><pre id="r-908440" data-claire-element-id="908440"><code data-claire-semantic="console">echo 'Hello *World*!' | md2html</code></pre><aside id="r-908442" data-claire-element-id="908442" data-claire-semantic="error"><p id="r-908441" data-claire-element-id="908441">Les modules installés globalement ne peuvent pas être inclus dans vos projets Node.js avec <code data-claire-semantic="javascript">require()</code> ! Ils servent juste à fournir des commandes supplémentaires dans la console.<br/> Si vous voulez les utiliser en JavaScript, vous devez donc aussi les installer normalement (sans le -g) en local.</p></aside><h2 id="r-mettre-a-jour-les-modules" data-claire-element-id="908447">Mettre à jour les modules</h2><p id="r-908444" data-claire-element-id="908444">Avec une simple commande :</p><pre id="r-908445" data-claire-element-id="908445"><code data-claire-semantic="console">npm update</code></pre><p id="r-908446" data-claire-element-id="908446">... NPM va chercher sur les serveurs s'il y a de nouvelles versions des modules, puis mettre à jour les modules installés sur votre machine (en veillant à ne pas casser la compatibilité) et il supprimera les anciennes versions. Bref, c'est la commande magique. :D</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
<span class="arrow"></span>
<span class="next">Créer des modules</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
<span class="next">Déclarer et publier son module</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Dclareretpubliersonmodule"></a><h2>Déclarer et publier son module</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
<span class="arrow"></span>
<span class="next">Utiliser NPM pour installer des modules</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">
<span class="next">Le framework Express.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908449" data-claire-element-id="908449">Si votre programme a besoin de modules externes, vous pouvez les installer un à un comme vous venez d'apprendre à le faire... mais vous allez voir que ça va vite devenir assez compliqué à maintenir. C'est d'autant plus vrai si vous utilisez de nombreux modules. Comme ces modules évoluent de version en version, votre programme pourrait devenir incompatible suite à une mise à jour d'un module externe !</p><p id="r-908450" data-claire-element-id="908450">Heureusement, on peut régler tout ça en définissant les dépendances de notre programme dans un simple fichier JSON. C'est un peu la <strong>carte d'identité</strong> de notre application.</p><p id="r-908451" data-claire-element-id="908451">Créez un fichier <code>package.json</code> dans le même dossier que votre application. Commençons simplement avec ce code :</p><pre id="r-908452" data-claire-element-id="908452"><code data-claire-semantic="javascript">{
    &quot;name&quot;: &quot;mon-app&quot;,
    &quot;version&quot;: &quot;0.1.0&quot;,
    &quot;dependencies&quot;: {
        &quot;markdown&quot;: &quot;~0.4&quot;
    }
}</code></pre><p id="r-908453" data-claire-element-id="908453">Ce fichier JSON contient 3 paires clé-valeur :</p><ul id="r-908460" data-claire-element-id="908460"><li id="r-908455" data-claire-element-id="908455"><p id="r-908454" data-claire-element-id="908454"><strong>name</strong> : c'est le nom de votre application. Restez simple, évitez espaces et accents.</p></li><li id="r-908457" data-claire-element-id="908457"><p id="r-908456" data-claire-element-id="908456"><strong>version</strong> : c'est le numéro de version de votre application. Il est composé d'un numéro de version majeure, de version mineure et de patch. J'y reviens juste après.</p></li><li id="r-908459" data-claire-element-id="908459"><p id="r-908458" data-claire-element-id="908458"><strong>dependencies</strong> : c'est un tableau listant les noms des modules dont a besoin votre application pour fonctionner ainsi que les versions compatibles.</p></li></ul><aside id="r-908462" data-claire-element-id="908462" data-claire-semantic="information"><p id="r-908461" data-claire-element-id="908461">Le fichier peut être beaucoup plus complet que ça, je ne vous ai montré ici que les valeurs essentielles. Pour tout connaître sur le fonctionnement de ce fichier package.json, je vous recommande cette <em>cheat sheet</em> : <a href="http://package.json.nodejitsu.com/">http://package.json.nodejitsu.com/</a></p></aside><h2 id="r-le-fonctionnement-des-numeros-de-version" data-claire-element-id="908482">Le fonctionnement des numéros de version</h2><p id="r-908463" data-claire-element-id="908463">Pour bien gérer les dépendances et savoir mettre à jour le numéro de version de son application, il faut savoir comment fonctionnent les numéros de version avec Node.js. Il y a pour chaque application :</p><ul id="r-908470" data-claire-element-id="908470"><li id="r-908465" data-claire-element-id="908465"><p id="r-908464" data-claire-element-id="908464"><strong>Un numéro de version majeure</strong>. En général on commence à 0 tant que l'application n'est pas considérée comme mature. Ce numéro change très rarement, uniquement quand l'application a subi des changements très profonds.</p></li><li id="r-908467" data-claire-element-id="908467"><p id="r-908466" data-claire-element-id="908466"><strong>Un numéro de version mineure</strong>. Ce numéro est changé à chaque fois que l'application est un peu modifiée.</p></li><li id="r-908469" data-claire-element-id="908469"><p id="r-908468" data-claire-element-id="908468"><strong>Un numéro de patch</strong>. Ce numéro est changé à chaque petite correction de bug ou de faille. Les fonctionnalités de l'application restent les mêmes entre les patchs, il s'agit surtout d'optimisations et de corrections indispensables.</p></li></ul><figure id="r-les-numeros-de-version-d-une-application-node-js" data-claire-element-id="908473"><img id="r-908471" data-claire-element-id="908471" src="medias/uploads.siteduzero.com_files_421001_422000_421284.png" alt="Les numéros de version d'une application Node.js"/><figcaption>Les numéros de version d'une application Node.js</figcaption></figure><p id="r-908474" data-claire-element-id="908474">Ici j'ai donc choisi de commencer à numéroter mon application à la version 0.1.0 (on aurait aussi pu commencer à 1.0.0 mais ç'aurait été prétentieux ;) ).</p><ul id="r-908481" data-claire-element-id="908481"><li id="r-908476" data-claire-element-id="908476"><p id="r-908475" data-claire-element-id="908475">Si je corrige un bug, l'application passera à la version 0.1.1 et il me faudra mettre à jour ce numéro dans le fichier packages.json.</p></li><li id="r-908478" data-claire-element-id="908478"><p id="r-908477" data-claire-element-id="908477">Si j'améliore significativement mon application, elle passera à la version 0.2.0, puis 0.3.0 et ainsi de suite.</p></li><li id="r-908480" data-claire-element-id="908480"><p id="r-908479" data-claire-element-id="908479">Le jour où je considère qu'elle a atteint un jalon important, et qu'elle est mature, je pourrai la passer en version 1.0.0.</p></li></ul><h2 id="r-la-gestion-des-versions-des-dependances" data-claire-element-id="908490">La gestion des versions des dépendances</h2><p id="r-908483" data-claire-element-id="908483">C'est à vous d'indiquer avec quelles versions de ses dépendances votre application fonctionne. Si votre application dépend du module markdown v0.3.5 très précisément, vous écrirez :</p><pre id="r-908484" data-claire-element-id="908484"><code data-claire-semantic="javascript">&quot;dependencies&quot;: {
    &quot;markdown&quot;: &quot;0.3.5&quot; // Version 0.3.5 uniquement
}</code></pre><p id="r-908485" data-claire-element-id="908485">Si vous faites un npm update pour mettre à jour les modules externes, markdown ne sera jamais mis à jour (même si l'application passe en version 0.3.6). Vous pouvez mettre un tilde devant le numéro de version pour autoriser les mises à jour jusqu'à la prochaine version mineure :</p><pre id="r-908486" data-claire-element-id="908486"><code data-claire-semantic="javascript">&quot;dependencies&quot;: {
    &quot;markdown&quot;: &quot;~0.3.5&quot; // OK pour les versions 0.3.5, 0.3.6, 0.3.7, etc. jusqu'à la version 0.4.0 non incluse
}</code></pre><p id="r-908487" data-claire-element-id="908487">Si vous voulez, vous pouvez ne pas indiquer de numéro de patch. Dans ce cas, les modules seront mis à jour même si l'application change de version mineure :</p><pre id="r-908488" data-claire-element-id="908488"><code data-claire-semantic="javascript">&quot;dependencies&quot;: {
    &quot;markdown&quot;: &quot;~0.3&quot; // OK pour les versions 0.3.X, 0.4.X, 0.5.X jusqu'à la version 1.0.0 non incluse
}</code></pre><p id="r-908489" data-claire-element-id="908489">Attention néanmoins : entre deux versions mineures, un module peut changer suffisamment et votre application pourrait être incompatible. Je recommande d'accepter uniquement les mises à jour de patch, c'est le plus sûr.</p><h2 id="r-publier-un-module" data-claire-element-id="908510">Publier un module</h2><p id="r-908491" data-claire-element-id="908491">Avec Node.js, vous pouvez créer une application pour vos besoins, mais vous pouvez aussi créer des modules qui offrent des fonctionnalités. Si vous pensez que votre module pourrait servir à d'autres personnes, n'hésitez pas à le partager ! Vous pouvez très facilement le publier sur NPM pour que d'autres personnes puissent l'installer à leur tour.</p><aside id="r-908493" data-claire-element-id="908493" data-claire-semantic="information"><p id="r-908492" data-claire-element-id="908492">Je rappelle qu'un module n'est rien d'autre qu'une application Node.js qui contient des instructions <code data-claire-semantic="javascript">exports</code> pour partager des fonctionnalités.</p></aside><p id="r-908494" data-claire-element-id="908494">Vous voulez accéder à la gloire éternelle et voir votre module téléchargé des milliers de fois sur NPM ? Rien de plus simple ! :D</p><p id="r-908495" data-claire-element-id="908495">Commencez par vous créer un compte utilisateur sur npm :</p><pre id="r-908496" data-claire-element-id="908496"><code data-claire-semantic="console">npm adduser</code></pre><p id="r-908497" data-claire-element-id="908497">Une fois que c'est fait, placez-vous dans le répertoire de votre projet à publier. Vérifiez que vous avez :</p><ul id="r-908502" data-claire-element-id="908502"><li id="r-908499" data-claire-element-id="908499"><p id="r-908498" data-claire-element-id="908498">Un fichier package.json qui décrit votre module (au moins son nom, sa version et ses dépendances)</p></li><li id="r-908501" data-claire-element-id="908501"><p id="r-908500" data-claire-element-id="908500">Un fichier README.md (écrit en markdown) qui présente votre module de façon un peu détaillée. N'hésitez pas à y inclure un mini-tutoriel expliquant comment utiliser votre module !</p></li></ul><p id="r-908503" data-claire-element-id="908503">Il ne vous reste plus qu'à faire :</p><pre id="r-908504" data-claire-element-id="908504"><code data-claire-semantic="console">npm publish</code></pre><p id="r-908505" data-claire-element-id="908505">Et voilà, c'est fait ! :D</p><p id="r-908506" data-claire-element-id="908506">Il ne vous reste plus qu'à parler de votre module autour de vous, le présenter sur les mailing-lists de Node.js... Les portes de la gloire des geeks barbus vous attendent !</p><figure id="r-votre-module-est-publie-a-vous-la-gloire" data-claire-element-id="908509"><img id="r-908507" data-claire-element-id="908507" src="medias/uploads.siteduzero.com_files_421001_422000_421285.jpg" alt="Votre module est publié, à vous la gloire !"/><figcaption>Votre module est publié, à vous la gloire !</figcaption></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
<span class="arrow"></span>
<span class="next">Utiliser NPM pour installer des modules</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">
<span class="next">Le framework Express.js</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LeframeworkExpress.js"></a><h2>Le framework Express.js</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
<span class="arrow"></span>
<span class="next">Déclarer et publier son module</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
<span class="next">Les routes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<div id="r-908514" data-claire-element-id="908514" data-claire-semantic="question"><p id="r-908513" data-claire-element-id="908513">Bon, coder à bas niveau tous les détails c'est amusant, mais est-ce qu'il n'existe pas des moyens d'aller un peu plus vite par hasard ? Des frameworks par exemple ? :-°</p></div><p id="r-908515" data-claire-element-id="908515">Vous avez bien raison. Tout coder à la main ça va 5 minutes. Ca peut être utile dans certains cas précis d'ailleurs, mais dans la plupart des cas on aime avoir des outils à disposition pour aller plus vite. C'est pour cela qu'on a inventé les <em>bibliothèques</em>, puis les <em>frameworks</em> qui sont des sortes de super-bibliothèques.</p><p id="r-908516" data-claire-element-id="908516">Si vous flânez un peu sur NPM, vous allez vite voir qu'il existe un module plébiscité : Express.js. Il s'agit en fait d'un micro-framework pour Node.js. Il vous fournit des outils de base pour aller plus vite dans la création d'applications Node.js.</p><p id="r-908517" data-claire-element-id="908517">Mais attention : n'allez pas comparer Express.js avec des poids lourds comme Django ou Symfony2 ! Ceux-ci vous offrent des fonctionnalités très complètes et puissantes (comme la génération d'interfaces d'administration), ce qui n'est pas vraiment le cas d'Express.<br/> Pourquoi ? Parce qu'on part de loin avec Node.js. Express vous permet donc d'être &quot;un peu moins bas niveau&quot; et de gérer par exemple plus facilement les routes (URLs) de votre application et d'utiliser des templates. Rien que ça, ça va déjà être une petite révolution pour nous !</p><p id="r-908518" data-claire-element-id="908518">Pour suivre ce chapitre, créez-vous un dossier pour faire une application de test Node.js. Installez-y Express avec la commande :</p><pre id="r-908519" data-claire-element-id="908519"><code data-claire-semantic="console">npm install express</code></pre><p id="r-908520" data-claire-element-id="908520">Vous voilà prêts à utiliser Express !</p>
</div><a name="Lesroutes"></a><h2>Les routes</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">
<span class="arrow"></span>
<span class="next">Le framework Express.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
<span class="next">Les templates</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908521" data-claire-element-id="908521">Nous avons vu à quel point il était fastidieux de vérifier l'URL demandée avec Node.js. On aboutissait à du bon vieux code spaghetti du type :</p><pre id="r-908522" data-claire-element-id="908522"><code data-claire-semantic="javascript">if (page == '/') {
    // ...
}
else if (page == '/sous-sol') {
    // ...
}
else if (page == '/etage/1/chambre') {
    // ...
}</code></pre><p id="r-908523" data-claire-element-id="908523">Lorsqu'on crée des applications web, on manipule des <em>routes</em> comme ici. Ce sont les différentes URLs auxquelles notre application doit répondre.</p><p id="r-908524" data-claire-element-id="908524">La gestion des routes un sujet important qui doit être traité avec sérieux. Si vous avez déjà manipulé des frameworks comme Django ou Symfony2, vous voyez certainement ce que je veux dire. Sinon, retenez juste ceci : bien gérer les URLs de son site est important, surtout lorsque celui-ci grossit. Express nous aide à faire ça bien.</p><h2 id="r-routes-simples" data-claire-element-id="908540">Routes simples</h2><p id="r-908525" data-claire-element-id="908525">Voici une application très basique utilisant Express pour commencer :</p><pre id="r-908526" data-claire-element-id="908526"><code data-claire-semantic="javascript">var express = require('express');

var app = express();

app.get('/', function(req, res) {
    res.setHeader('Content-Type', 'text/plain');
    res.end('Vous êtes à l\'accueil');
});

app.listen(8080);</code></pre><aside id="r-908528" data-claire-element-id="908528" data-claire-semantic="warning"><p id="r-908527" data-claire-element-id="908527">N'oubliez pas de faire <code data-claire-semantic="console">npm install express</code> pour que ce code fonctionne !</p></aside><p id="r-908529" data-claire-element-id="908529">Vous commencez par demander l'inclusion d'Express et vous créez un objet app en appelant la fonction express().</p><p id="r-908530" data-claire-element-id="908530">Ensuite, il vous suffit d'indiquer les différentes routes (les différentes URLs) à laquelle votre application doit répondre. Ici, j'ai créé une seule route, la racine &quot;/&quot;. Une fonction de callback est appelée quand quelqu'un demande cette route.</p><p id="r-908531" data-claire-element-id="908531">Ce système est beaucoup mieux fait que nos &quot;if&quot; imbriqués. On peut écrire autant de routes de cette façon qu'on le souhaite :</p><pre id="r-908532" data-claire-element-id="908532"><code data-claire-semantic="javascript">app.get('/', function(req, res) {
    res.setHeader('Content-Type', 'text/plain');
    res.end('Vous êtes à l\'accueil, que puis-je pour vous ?');
});

app.get('/sous-sol', function(req, res) {
    res.setHeader('Content-Type', 'text/plain');
    res.end('Vous êtes dans la cave à vins, ces bouteilles sont à moi !');
});

app.get('/etage/1/chambre', function(req, res) {
    res.setHeader('Content-Type', 'text/plain');
    res.end('Hé ho, c\'est privé ici !');
});</code></pre><p id="r-908533" data-claire-element-id="908533">Si vous voulez gérer les erreurs 404, vous devez inclure les lignes suivantes <strong>à la fin de votre code</strong> obligatoirement (juste avant app.listen) :</p><pre id="r-908534" data-claire-element-id="908534"><code data-claire-semantic="javascript">// ... Tout le code de gestion des routes (app.get) se trouve au-dessus

app.use(function(req, res, next){
    res.setHeader('Content-Type', 'text/plain');
    res.send(404, 'Page introuvable !');
});

app.listen(8080);</code></pre><p id="r-908535" data-claire-element-id="908535">Ne vous préoccupez pas trop pour l'instant de la syntaxe et des paramètres, on y reviendra un peu plus tard. Nous apprenons juste à gérer les routes avec Express pour le moment.</p><aside id="r-908539" data-claire-element-id="908539" data-claire-semantic="information"><p id="r-908536" data-claire-element-id="908536">Express vous permet de chaîner les appel à get() et use() :</p><pre id="r-908537" data-claire-element-id="908537"><code data-claire-semantic="javascript">app.get('/', function(req, res) {

})
.get('/sous-sol', function(req, res) {

})
.get('/etage/1/chambre', function(req, res) {

})
.use(function(req, res, next){

});</code></pre><p id="r-908538" data-claire-element-id="908538">Cela revient à faire app.get().get().get()... Ca marche parce que ces fonctions se renvoient l'une à l'autre l'objet app, ce qui nous permet de raccourcir notre code. Ne soyez donc pas étonnés si vous voyez des codes utilisant Express écrits sous cette forme.</p></aside><h2 id="r-routes-dynamiques" data-claire-element-id="908556">Routes dynamiques</h2><p id="r-908541" data-claire-element-id="908541">Express vous permet de gérer des routes dynamiques, c'est-à-dire des routes dont certaines portions peuvent varier. Vous devez écrire <code data-claire-semantic="javascript">:nomvariable</code> dans l'URL de la route, ce qui aura pour effet de créer un paramètre accessible depuis <code data-claire-semantic="javascript">req.params.nomvariable</code>. Démonstration :</p><pre id="r-908542" data-claire-element-id="908542"><code data-claire-semantic="javascript">app.get('/etage/:etagenum/chambre', function(req, res) {
    res.setHeader('Content-Type', 'text/plain');
    res.end('Vous êtes à la chambre de l\'étage n°' + req.params.etagenum);
});</code></pre><p id="r-908543" data-claire-element-id="908543">Cela vous permet de créer de belles URLs et vous évite d'avoir à passer par le suffixe (&quot;?variable=valeur&quot;) pour gérer des variables. Ainsi, toutes les routes suivantes sont valides :</p><ul id="r-908552" data-claire-element-id="908552"><li id="r-908545" data-claire-element-id="908545"><p id="r-908544" data-claire-element-id="908544">/etage/1/chambre</p></li><li id="r-908547" data-claire-element-id="908547"><p id="r-908546" data-claire-element-id="908546">/etage/2/chambre</p></li><li id="r-908549" data-claire-element-id="908549"><p id="r-908548" data-claire-element-id="908548">/etage/3/chambre</p></li><li id="r-908551" data-claire-element-id="908551"><p id="r-908550" data-claire-element-id="908550">/etage/nawak/chambre</p></li></ul><div id="r-908554" data-claire-element-id="908554" data-claire-semantic="question"><p id="r-908553" data-claire-element-id="908553">Comment ça, on peut mettre n'importe quoi ? Comment fait-on pour imposer la présence d'un nombre ?</p></div><p id="r-908555" data-claire-element-id="908555">Oui, le visiteur peut écrire n'importe quoi dans l'URL (même &quot;nawak&quot; ;) ). C'est donc à vous de vérifier dans votre fonction de callback que le paramètre est bien un nombre et de renvoyer une erreur (ou une 404) si ce n'est pas le cas.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">
<span class="arrow"></span>
<span class="next">Le framework Express.js</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
<span class="next">Les templates</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lestemplates"></a><h2>Les templates</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
<span class="arrow"></span>
<span class="next">Les routes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
<span class="next">Aller plus loin : Connect et les middlewares</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908558" data-claire-element-id="908558">Jusqu'ici, nous avions renvoyé le code HTML directement en JavaScript. Cela nous avait donné du code lourd et délicat à maintenir qui ressemblait à ça :</p><pre id="r-908559" data-claire-element-id="908559"><code data-claire-semantic="javascript">res.write('&lt;!DOCTYPE html&gt;'+
'&lt;html&gt;'+
'    &lt;head&gt;'+
'        &lt;meta charset=&quot;utf-8&quot; /&gt;'+
'        &lt;title&gt;Ma page Node.js !&lt;/title&gt;'+
'    &lt;/head&gt;'+ 
'    &lt;body&gt;'+
'     	&lt;p&gt;Voici un paragraphe &lt;strong&gt;HTML&lt;/strong&gt; !&lt;/p&gt;'+
'    &lt;/body&gt;'+
'&lt;/html&gt;');</code></pre><p id="r-908560" data-claire-element-id="908560">Horrible, n'est-ce pas ? :D</p><p id="r-908561" data-claire-element-id="908561">Express nous permet d'utiliser des templates pour sortir de cet enfer. Les templates sont en quelque sorte des langages faciles à écrire qui nous permettent de produire du HTML et d'insérer au milieu du contenu variable.</p><p id="r-908562" data-claire-element-id="908562">PHP lui-même est en fait un langage de template qui nous permet de faire ceci :</p><pre id="r-908563" data-claire-element-id="908563"><code data-claire-semantic="html+php">&lt;p&gt;Vous êtes le visiteur n°&lt;?php echo $numvisiteur; ?&gt;&lt;/p&gt;</code></pre><p id="r-908564" data-claire-element-id="908564">Il existe beaucoup d'autres langages de templates, comme Twig, Smarty, Haml, JSP, Jade, EJS... Express vous permet d'utiliser la plupart d'entre eux, chacun ayant son lot d'avantages et d'inconvénients. En général ils gèrent tous l'essentiel, à savoir : les variables, les conditions, les boucles, etc.</p><p id="r-908565" data-claire-element-id="908565">Le principe est le suivant : depuis votre fichier JavaScript, vous appelez le template de votre choix en lui transmettant les variables dont il a besoin pour construire la page.</p><figure id="r-les-templates-avec-node-js" data-claire-element-id="908568"><img id="r-908566" data-claire-element-id="908566" src="medias/uploads.siteduzero.com_files_421001_422000_421341.png" alt="Les templates avec Node.js"/><figcaption>Les templates avec Node.js</figcaption></figure><h2 id="r-les-bases-d-ejs" data-claire-element-id="908576">Les bases d'EJS</h2><p id="r-908569" data-claire-element-id="908569">Comme il existe de nombreux systèmes de templates, je vais en choisir un dans le lot. Je vous propose ici d'utiliser <a href="http://embeddedjs.com/">EJS</a> (Embedded JavaScript). Installez-le pour le projet :</p><pre id="r-908570" data-claire-element-id="908570"><code data-claire-semantic="console">npm install ejs</code></pre><p id="r-908571" data-claire-element-id="908571">Nous pouvons maintenant déléguer la gestion de la vue (du HTML) à notre moteur de template. Plus besoin d'écrire du HTML au milieu du code JavaScript comme un cochon !</p><pre id="r-908572" data-claire-element-id="908572"><code data-claire-semantic="javascript">app.get('/etage/:etagenum/chambre', function(req, res) {
    res.render('chambre.ejs', {etage: req.params.etagenum});
});</code></pre><p id="r-908573" data-claire-element-id="908573">Ce code fait appel à un fichier chambre.ejs <strong>qui doit se trouver dans un sous-dossier appelé &quot;views&quot;</strong>. Créez donc un fichier <code>/views/chambre.ejs</code> et placez-y le code suivant :</p><pre id="r-908574" data-claire-element-id="908574"><code>&lt;h1&gt;Vous êtes dans la chambre&lt;/h1&gt;

&lt;p&gt;Vous êtes à l'étage n°&lt;%= etage %&gt;&lt;/p&gt;</code></pre><p id="r-908575" data-claire-element-id="908575">La balise <code>&lt;%= etage %&gt;</code> sera remplacée par la variable <code>etage</code> que l'on a transmise au template avec <code data-claire-semantic="javascript">{etage: req.params.etagenum}</code> !</p><h2 id="r-plusieurs-parametres-et-des-boucles" data-claire-element-id="908590">Plusieurs paramètres et des boucles</h2><p id="r-908577" data-claire-element-id="908577">Sachez que vous pouvez envoyer plusieurs paramètres à vos templates, y compris des tableaux ! Pour cette démonstration, nous allons faire une application qui compte jusqu'à un nombre envoyé en paramètre et qui affiche un nom au hasard au sein d'un tableau (je suis en manque d'inspiration, je sais).</p><p id="r-908578" data-claire-element-id="908578">Voici le code JavaScript :</p><pre id="r-908579" data-claire-element-id="908579"><code data-claire-semantic="javascript">app.get('/compter/:nombre', function(req, res) {
    var noms = ['Robert', 'Jacques', 'David'];
    res.render('page.ejs', {compteur: req.params.nombre, noms: noms});
});</code></pre><p id="r-908580" data-claire-element-id="908580">On transmet le nombre envoyé en paramètre et une liste de noms sous forme de tableau. Ensuite, dans le template EJS :</p><pre id="r-908581" data-claire-element-id="908581"><code>&lt;h1&gt;Je vais compter jusqu'à &lt;%= compteur %&gt;&lt;/h1&gt;

&lt;p&gt;&lt;%
    for(var i = 1 ; i &lt;= compteur ; i++) {
    %&gt;

    &lt;%= i %&gt;... 

&lt;% } %&gt;&lt;/p&gt;

&lt;p&gt;Tant que j'y suis, je prends un nom au hasard qu'on m'a envoyé :
&lt;%= noms[Math.floor(Math.random() * (noms.length + 1))] %&gt;
&lt;/p&gt;</code></pre><p id="r-908582" data-claire-element-id="908582">Vous voyez qu'on peut faire des boucles avec les templates EJS. En fait, on utilise la même syntaxe que JavaScript (d'où la boucle for).<br/> Ma petite manipulation à la fin du code me permet de prendre un nom au hasard dans le tableau qui a été envoyé au template.</p><p id="r-908583" data-claire-element-id="908583">Résultat (pour <code>/compter/66</code>) :</p><figure id="r-cette-application-est-inutile-je-sais-o" data-claire-element-id="908586"><img id="r-908584" data-claire-element-id="908584" src="medias/uploads.siteduzero.com_files_421001_422000_421331.png" alt="Cette application est inutile, je sais :o)"/><figcaption>Cette application est inutile, je sais :o)</figcaption></figure><p id="r-908587" data-claire-element-id="908587">De la même façon, vous pouvez avoir recours à des conditions (if) et des boucles (while) au sein de vos templates EJS.</p><aside id="r-908589" data-claire-element-id="908589" data-claire-semantic="information"><p id="r-908588" data-claire-element-id="908588">N'hésitez pas à regarder aussi d'autres systèmes de templates comme <a href="http://jade-lang.com/">Jade</a> ou <a href="http://haml.info/">Haml</a> qui proposent une toute autre façon de créer ses pages web !</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
<span class="arrow"></span>
<span class="next">Les routes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
<span class="next">Aller plus loin : Connect et les middlewares</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="AllerplusloinConnectetlesmiddlewares"></a><h2>Aller plus loin : Connect et les middlewares</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
<span class="arrow"></span>
<span class="next">Les templates</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">
<span class="next">TP : la todo list</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908592" data-claire-element-id="908592">Nous venons de voir deux fonctionnalités essentielles d'Express :</p><ul id="r-908597" data-claire-element-id="908597"><li id="r-908594" data-claire-element-id="908594"><p id="r-908593" data-claire-element-id="908593">Les routes : elles permettent de gérer efficacement les URLs</p></li><li id="r-908596" data-claire-element-id="908596"><p id="r-908595" data-claire-element-id="908595">Les vues : elles permettent un accès aux systèmes de templates comme EJS</p></li></ul><p id="r-908598" data-claire-element-id="908598">Tout ceci est déjà très utile et on pourrait être tenté de s'arrêter là... mais ce serait passer à côté du coeur d'Express. Je vous propose d'aller plus loin en découvrant ensemble comment fonctionne Express dans ses entrailles. :pirate:</p><h2 id="r-express-connect-et-les-middlewares" data-claire-element-id="908640">Express, connect et les middlewares</h2><p id="r-908599" data-claire-element-id="908599">Express est un framework construit au-dessus d'un autre module appelé Connect. En fait, Express n'est rien d'autre que le module Connect auquel on a ajouté certaines fonctionnalités comme les routes et les vues.</p><div id="r-908601" data-claire-element-id="908601" data-claire-semantic="question"><p id="r-908600" data-claire-element-id="908600">OK, mais qu'est-ce que Connect dans ce cas ?</p></div><p id="r-908602" data-claire-element-id="908602">C'est un module qui permet à d'autres modules appelés <em>middlewares</em> de communiquer entre eux, d'où son nom &quot;Connect&quot;. Il étend la fonctionnalité <code data-claire-semantic="javascript">http.createServer()</code> fournie de base par Node.js et offre donc de nouvelles fonctionnalités.</p><p id="r-908603" data-claire-element-id="908603">Connect est fourni avec plus de 18 middlewares de base, et d'autres développeurs peuvent bien entendu en proposer d'autres via NPM. Les middlewares livrés avec Connect fournissent chacun des micro-fonctionnalités. Il y a par exemple :</p><ul id="r-908618" data-claire-element-id="908618"><li id="r-908605" data-claire-element-id="908605"><p id="r-908604" data-claire-element-id="908604"><strong>compress</strong> : permet la compression gzip de la page pour un envoi plus rapide au navigateur</p></li><li id="r-908607" data-claire-element-id="908607"><p id="r-908606" data-claire-element-id="908606"><strong>cookieParser</strong> : permet de manipuler les cookies</p></li><li id="r-908609" data-claire-element-id="908609"><p id="r-908608" data-claire-element-id="908608"><strong>session</strong> : permet de gérer des informations de session (durant la visite d'un visiteur)</p></li><li id="r-908611" data-claire-element-id="908611"><p id="r-908610" data-claire-element-id="908610"><strong>static</strong> : permet de renvoyer des fichiers statiques contenus dans un dossier (images, fichiers à télécharger...)</p></li><li id="r-908613" data-claire-element-id="908613"><p id="r-908612" data-claire-element-id="908612"><strong>basicAuth</strong> : permet de demander une authentification HTTP Basic, c'est-à-dire une saisie d'un login et d'un mot de passe avant d'accéder à une section du site</p></li><li id="r-908615" data-claire-element-id="908615"><p id="r-908614" data-claire-element-id="908614"><strong>csrf</strong> : fournit une protection contre les failles CSRF</p></li><li id="r-908617" data-claire-element-id="908617"><p id="r-908616" data-claire-element-id="908616">etc.</p></li></ul><p id="r-908619" data-claire-element-id="908619">Tous ces middlewares offrent vraiment des micro-fonctionnalités. Il y en a des tous petits comme &quot;favicon&quot; par exemple, qui se contente de gérer la favicon de votre site (l'icône qui représente votre site).</p><p id="r-908620" data-claire-element-id="908620">Grâce à Connect, ces middlewares sont interconnectés et peuvent communiquer entre eux. Express ne fait qu'ajouter les routes et les vues par-dessus l'ensemble.</p><figure id="r-les-fonctionnalites-offertes-par-express-viennent-en-grande-partie-de-connect" data-claire-element-id="908623"><img id="r-908621" data-claire-element-id="908621" src="medias/uploads.siteduzero.com_files_421001_422000_421342.png" alt="Les fonctionnalités offertes par Express viennent en grande partie de Connect"/><figcaption>Les fonctionnalités offertes par Express viennent en grande partie de Connect</figcaption></figure><p id="r-908624" data-claire-element-id="908624">Le principe de Connect est que tous ces middlewares communiquent entre eux en se renvoyant jusqu'à 4 paramètres :</p><ul id="r-908633" data-claire-element-id="908633"><li id="r-908626" data-claire-element-id="908626"><p id="r-908625" data-claire-element-id="908625"><code data-claire-semantic="javascript">err</code> : les erreurs</p></li><li id="r-908628" data-claire-element-id="908628"><p id="r-908627" data-claire-element-id="908627"><code data-claire-semantic="javascript">req</code> : la requête du visiteur</p></li><li id="r-908630" data-claire-element-id="908630"><p id="r-908629" data-claire-element-id="908629"><code data-claire-semantic="javascript">res</code> : la réponse à renvoyer (la page HTML et les informations d'en-tête)</p></li><li id="r-908632" data-claire-element-id="908632"><p id="r-908631" data-claire-element-id="908631"><code data-claire-semantic="javascript">next</code> : un callback vers la prochaine fonction à appeler</p></li></ul><p id="r-908634" data-claire-element-id="908634">Si je devais résumer ce que permet de faire Connect dans un schéma, ça donnerait ça :</p><figure id="r-les-middlewares-communiquent-les-parametres-grace-a-connect" data-claire-element-id="908637"><img id="r-908635" data-claire-element-id="908635" src="medias/uploads.siteduzero.com_files_421001_422000_421333.png" alt="Les middlewares communiquent les paramètres grâce à Connect"/><figcaption>Les middlewares communiquent les paramètres grâce à Connect</figcaption></figure><aside id="r-908639" data-claire-element-id="908639" data-claire-semantic="information"><p id="r-908638" data-claire-element-id="908638">N'hésitez pas à lire la <a href="http://www.senchalabs.org/connect/">doc de Connect</a> puis à lire la <a href="http://expressjs.com/api.html">doc d'Express</a>. Vous y trouverez toutes les informations dont vous avez besoin pour utiliser les middlewares. ;)</p></aside><h2 id="r-utiliser-les-fonctionnalites-de-connect-au-sein-d-express" data-claire-element-id="908649">Utiliser les fonctionnalités de Connect au sein d'Express</h2><p id="r-908641" data-claire-element-id="908641">Si je vous raconte tout ça, c'est parce que vous en avez besoin pour tirer pleinement partie d'Express. En effet, vous pouvez appeler les différents modules de Connect avec la méthode <code data-claire-semantic="javascript">app.use()</code>. Par exemple, vous pouvez faire :</p><pre id="r-908642" data-claire-element-id="908642"><code data-claire-semantic="javascript">app.use(express.logger()) // Active le middleware de logging
.use(express.static(__dirname + '/public')) // Indique que le dossier /public contient des fichiers statiques
.use(express.favicon(__dirname + '/public/favicon.ico')) // Active la favicon indiquée
.use(function(req, res){ // Répond enfin
    res.send('Hello');
});</code></pre><aside id="r-908644" data-claire-element-id="908644" data-claire-semantic="error"><p id="r-908643" data-claire-element-id="908643">L'ordre d'appel des middlewares est extrêmement important. Par exemple, on commence par activer le logger. Si on le faisait en dernier, on ne loggerait rien !<br/> Quand vous faites appel aux middlewares, réfléchissez donc à l'ordre, car il peut impacter fortement le fonctionnement de votre application.</p></aside><p id="r-908645" data-claire-element-id="908645">Comme vous le voyez, j'ai fait appel aux middlewares logger, static et favicon dans le cas présent. Chaque middleware va se renvoyer des données (la requête, la réponse, la fonction suivante à appeler...). Chacun a un rôle très précis. Pour savoir les utiliser il suffit de lire la <a href="http://www.senchalabs.org/connect/">doc de Connect</a>.</p><p id="r-908646" data-claire-element-id="908646">Je pourrais m'étendre et présenter les middlewares un à un, mais ce serait long et fastidieux (pour moi, comme pour vous). Je ne souhaite pas rentrer plus dans le détail mais j'estime que vous savez l'essentiel, qui était le plus compliqué à comprendre. ;)</p><p id="r-908647" data-claire-element-id="908647">Je résume : Express utilise Connect qui propose un ensemble de middlewares qui communiquent entre eux. Appelez ces middlewares pour utiliser leurs fonctionnalités et faites attention à l'ordre d'appel qui est important (on n'active pas un logger à la fin des opérations !).</p><p id="r-908648" data-claire-element-id="908648">Vous êtes prêts à affronter le monde terrible et passionnant d'Express, un framework incontournable qui évolue rapidement. Bravo et bonne lecture de la doc maintenant ! :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
<span class="arrow"></span>
<span class="next">Les templates</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">
<span class="next">TP : la todo list</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="TPlatodolist"></a><h2>TP : la todo list</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
<span class="arrow"></span>
<span class="next">Aller plus loin : Connect et les middlewares</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
<span class="next">Besoin d&#039;aide ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-908652" data-claire-element-id="908652">Je crois qu'il est grand temps de pratiquer un peu ! Nous avons fait le tour d'un bon nombre de fonctionnalités de base de Node.js et nous avons même appris à nous servir du micro-framework Express.</p><p id="r-908653" data-claire-element-id="908653">Pourtant, on n'a vraiment le sentiment d'avoir compris que lorsqu'on a pratiqué et réalisé une première vraie application. C'est ce que je vous propose de faire dans ce TP. :)</p><p id="r-908654" data-claire-element-id="908654">Nous allons réaliser ici une todo list (une liste de tâches). Le visiteur pourra simplement ajouter et supprimer des tâches.<br/> Nous ferons donc quelque chose de très simple pour commencer, que vous pourrez ensuite améliorer comme bon vous semble !</p><p id="r-908655" data-claire-element-id="908655">Voici à quoi ressemble la page que nous devons créer :</p><figure id="r-l-application-que-nous-allons-creer-superbe-non-o" data-claire-element-id="908658"><img id="r-908656" data-claire-element-id="908656" src="medias/uploads.siteduzero.com_files_421001_422000_421348.png" alt="L'application que nous allons créer. Superbe non ? ;o)"/><figcaption>L'application que nous allons créer. Superbe non ? ;o)</figcaption></figure><ul id="r-908665" data-claire-element-id="908665"><li id="r-908660" data-claire-element-id="908660"><p id="r-908659" data-claire-element-id="908659">On peut ajouter des éléments à la todolist via le formulaire.</p></li><li id="r-908662" data-claire-element-id="908662"><p id="r-908661" data-claire-element-id="908661">On peut supprimer des éléments en cliquant sur les croix dans la liste.</p></li><li id="r-908664" data-claire-element-id="908664"><p id="r-908663" data-claire-element-id="908663">La liste est stockée dans la session du visiteur. Si quelqu'un d'autre se connecte, il aura sa propre liste.</p></li></ul><p id="r-908666" data-claire-element-id="908666">Les instructions sont simples et le code final ne sera pas très long. En revanche, si c'est votre première app un peu complète avec Node.js vous allez sûrement tâtonner et avancer doucement. Ne prenez pas peur, c'est parfaitement normal ! Persévérez et, si vraiment vous avez besoin d'aide, lisez la section &quot;Un peu d'aide&quot; avant de comparer votre travail avec le mien. ;)</p><aside id="r-908668" data-claire-element-id="908668" data-claire-semantic="information"><p id="r-908667" data-claire-element-id="908667">N'oubliez pas d'ouvrir la <a href="http://expressjs.com/api.html">doc d'Express</a> et la <a href="http://www.senchalabs.org/connect/">doc de Connect</a>. Je n'aurais jamais pu faire ce TP moi-même sans avoir recours à la doc !</p></aside><p id="r-908669" data-claire-element-id="908669">Vous avez toutes les infos, à vous de jouer !</p>
</div><a name="Besoind039aide"></a><h2>Besoin d&#039;aide ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">
<span class="arrow"></span>
<span class="next">TP : la todo list</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
<span class="next">Correction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908670" data-claire-element-id="908670">Allons bon, comme ça vous avez besoin d'aide ? Vous êtes perdus et vous ne savez pas par où commencer ? :p</p><p id="r-908671" data-claire-element-id="908671">Je rappelle à quoi ressemble l'application que nous devons créer. Je vous ai présenté cette capture en introduction du TP :</p><figure id="r-l-application-que-nous-allons-creer-toujours-aussi-belle" data-claire-element-id="908674"><img id="r-908672" data-claire-element-id="908672" src="medias/uploads.siteduzero.com_files_421001_422000_421348.png" alt="L'application que nous allons créer. Toujours aussi belle !"/><figcaption>L'application que nous allons créer. Toujours aussi belle !</figcaption></figure><h2 id="r-les-modules-et-le-package-json" data-claire-element-id="908688">Les modules et le package.json</h2><p id="r-908675" data-claire-element-id="908675">Prenons les choses dans l'ordre en respirant un grand coup. De quoi a-t-on besoin ?</p><ul id="r-908680" data-claire-element-id="908680"><li id="r-908677" data-claire-element-id="908677"><p id="r-908676" data-claire-element-id="908676"><strong>Express</strong> : sans le framework Express la mission sera vraiment très difficile. Maintenant que nous savons utiliser ce framework, ce serait dommage de s'en priver.</p></li><li id="r-908679" data-claire-element-id="908679"><p id="r-908678" data-claire-element-id="908678"><strong>EJS</strong> (ou un autre système de template) : cela nous permettra de construire facilement la page HTML qui affiche la liste des tâches et le formulaire.</p></li></ul><p id="r-908681" data-claire-element-id="908681">A priori ces modules suffisent. Une première bonne pratique serait de se créer un fichier <code>package.json</code> dans le dossier de notre projet :</p><pre id="r-908682" data-claire-element-id="908682"><code data-claire-semantic="javascript">{
    &quot;name&quot;: &quot;ma-todolist&quot;,
    &quot;version&quot;: &quot;0.1.0&quot;,
    &quot;dependencies&quot;: {
        &quot;express&quot;: &quot;~3.2.1&quot;,
        &quot;ejs&quot;: &quot;~0.8.3&quot;
    },
    &quot;author&quot;: &quot;Mateo21 &lt;<a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="701d1104151f424130151d11191c5e131f1d">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>&gt;&quot;,
    &quot;description&quot;: &quot;Un gestionnaire de todolist ultra basique&quot;
}</code></pre><p id="r-908683" data-claire-element-id="908683">Vous pouvez remplacer le nom, l'auteur et la description comme bon vous semble bien sûr. ;)</p><p id="r-908684" data-claire-element-id="908684">Pour les numéros de version d'express et d'ejs, je me suis basé sur les versions disponibles au moment de la rédaction de ce tutoriel. Comme l'univers de Node.js avance vite, vous aurez sûrement des versions plus récentes. Le petit tilde ~ permet d'autoriser les futurs patchs de ces modules mais pas les nouvelles versions mineures ou majeures, ce qui nous garantit que leur API ne changera pas, et donc que notre code continuera à fonctionner même avec ces mises à jour.</p><p id="r-908685" data-claire-element-id="908685">Maintenant que vous avez votre <code>package.json</code>, installez les dépendances avec un simple :</p><pre id="r-908686" data-claire-element-id="908686"><code data-claire-semantic="console">npm install</code></pre><p id="r-908687" data-claire-element-id="908687">Nous sommes prêts à travailler !</p><h2 id="r-les-routes-2" data-claire-element-id="908709">Les routes</h2><p id="r-908689" data-claire-element-id="908689">Je vous avais dit que bien définir ses routes était important quand on construit une application web. Si vous hésitez et ne savez pas par où commencer, je vous invite à lister les routes de votre application. Que doit-elle faire ?</p><ul id="r-908696" data-claire-element-id="908696"><li id="r-908691" data-claire-element-id="908691"><p id="r-908690" data-claire-element-id="908690">Lister les tâches</p></li><li id="r-908693" data-claire-element-id="908693"><p id="r-908692" data-claire-element-id="908692">Ajouter une tâche</p></li><li id="r-908695" data-claire-element-id="908695"><p id="r-908694" data-claire-element-id="908694">Supprimer une tâche</p></li></ul><p id="r-908697" data-claire-element-id="908697">A priori, on peut associer une route à chacune de ces fonctionnalités :</p><ul id="r-908704" data-claire-element-id="908704"><li id="r-908699" data-claire-element-id="908699"><p id="r-908698" data-claire-element-id="908698"><code>/todo</code> : liste les tâches</p></li><li id="r-908701" data-claire-element-id="908701"><p id="r-908700" data-claire-element-id="908700"><code>/todo/ajouter</code> : ajoute une tâche</p></li><li id="r-908703" data-claire-element-id="908703"><p id="r-908702" data-claire-element-id="908702"><code>/todo/supprimer/:id</code> : supprime la tâche n°id</p></li></ul><p id="r-908705" data-claire-element-id="908705">Vous allez donc écrire les routes comme ceci dans votre fichier app.js :</p><pre id="r-908706" data-claire-element-id="908706"><code data-claire-semantic="javascript">.get('/todo', function(req, res) {

});

// ...</code></pre><p id="r-908707" data-claire-element-id="908707">En revanche, il faudrait qu'on se penche un instant sur la question du formulaire. En général, les formulaires envoient les données avec la méthode POST et non la méthode GET. L'ajout d'une tâche va donc se faire sur la route /todo/ajouter mais avec la méthode POST. C'est pour ça qu'au lieu de faire appel à <code data-claire-semantic="javascript">.get()</code> on devra faire appel à <code data-claire-semantic="javascript">.post()</code> pour cette route :</p><pre id="r-908708" data-claire-element-id="908708"><code data-claire-semantic="javascript">.post('/todo/ajouter/', function(req, res) {

})</code></pre><h2 id="r-bien-chainer-les-appels-aux-middlewares" data-claire-element-id="908716">Bien chaîner les appels aux middlewares</h2><p id="r-908710" data-claire-element-id="908710">Nous savons que nous aurons besoin d'un système de sessions. La doc de Connect nous indique <a href="http://www.senchalabs.org/connect/session.html">comment utiliser les sessions</a>. On apprend que les sessions utilisent les cookies, et donc qu'il faut activer les cookies <em>avant</em> d'activer les sessions. Voilà encore un exemple de l'importance de l'ordre d'appel des middlewares !</p><p id="r-908711" data-claire-element-id="908711">Autre chose : nous aurons besoin de récupérer les données du formulaire dans <code>/todo/ajouter</code>. Nous avons appris à récupérer des paramètres depuis l'URL mais pas depuis les formulaires. En fait, c'est vraiment simple : il vous suffit d'inclure le middleware <a href="http://www.senchalabs.org/connect/bodyParser.html">bodyParser</a>. Vous aurez ensuite accès à <code data-claire-semantic="javascript">req.body.nomDuChamp</code>.</p><p id="r-908712" data-claire-element-id="908712">Du coup, le début de notre code JavaScript devrait ressembler à quelque chose comme ça :</p><pre id="r-908713" data-claire-element-id="908713"><code data-claire-semantic="javascript">var express = require('express');

var app = express();

/* On utilise les cookies, les sessions et les formulaires */
app.use(express.cookieParser())
.use(express.session({secret: 'todotopsecret'}))
.use(express.bodyParser())

/* Gestion des routes en-dessous
   ....                         */</code></pre><p id="r-908714" data-claire-element-id="908714">Le paramètre <code>secret</code> envoyé au module de session est obligatoire : il permet de sécuriser les cookies de session. Envoyez la valeur de votre choix. Notez que vous pouvez envoyer <a href="http://www.senchalabs.org/connect/session.html#session">d'autres options</a>, comme la durée de vie du cookie de session (par défaut, la session durera tant que le navigateur restera ouvert).</p><p id="r-908715" data-claire-element-id="908715">Allez, je vous en ai trop donné, à vous de coder ! :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">
<span class="arrow"></span>
<span class="next">TP : la todo list</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
<span class="next">Correction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Correction"></a><h2>Correction</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
<span class="arrow"></span>
<span class="next">Besoin d&#039;aide ?</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-908718" data-claire-element-id="908718">Allez hop hop hop, c'est l'heure de la correction ! Ne lisez cette section que si vous avez réussi ou que toutes vos tentatives ont échoué et que vous êtes désespérés. :p</p><p id="r-908719" data-claire-element-id="908719">Le code n'est pas si difficile à lire au final. Il n'est pas très long non plus, mais il fallait bien réfléchir pour trouver quoi écrire exactement.</p><h2 id="r-la-solution-21" data-claire-element-id="908727">La solution</h2><p id="r-908720" data-claire-element-id="908720">Ci-dessous, vous avez le code JavaScript que j'ai produit dans le fichier principal app.js. Notez bien que c'est <em>une</em> façon de faire et que vous n'êtes pas obligés d'avoir produit un code strictement identique au mien !</p><pre id="r-908721" data-claire-element-id="908721"><code data-claire-semantic="javascript">var express = require('express');

var app = express();

/* On utilise les cookies, les sessions et les formulaires */
app.use(express.cookieParser())
.use(express.session({secret: 'todotopsecret'}))
.use(express.bodyParser())

/* S'il n'y a pas de todolist dans la session,
on en crée une vide sous forme d'array avant la suite */
.use(function(req, res, next){
    if (typeof(req.session.todolist) == 'undefined') {
        req.session.todolist = [];
    }
    next();
})

/* On affiche la todolist et le formulaire */
.get('/todo', function(req, res) { 
    res.render('todo.ejs', {todolist: req.session.todolist});
})

/* On ajoute un élément à la todolist */
.post('/todo/ajouter/', function(req, res) {
    if (req.body.newtodo != '') {
        req.session.todolist.push(req.body.newtodo);
    }
    res.redirect('/todo');
})

/* Supprime un élément de la todolist */
.get('/todo/supprimer/:id', function(req, res) {
    if (req.params.id != '') {
        req.session.todolist.splice(req.params.id, 1);
    }
    res.redirect('/todo');
})

/* On redirige vers la todolist si la page demandée n'est pas trouvée */
.use(function(req, res, next){
    res.redirect('/todo');
})

.listen(8080);</code></pre><p id="r-908722" data-claire-element-id="908722">Beau chaînage de middlewares n'est-ce pas :-°</p><p id="r-908723" data-claire-element-id="908723">Il y a aussi un fichier de template qui va avec. Le fichier <code>todo.ejs</code> :</p><pre id="r-908724" data-claire-element-id="908724"><code data-claire-semantic="javascript">&lt;!DOCTYPE html&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Ma todolist&lt;/title&gt;
        &lt;style&gt;
            a {text-decoration: none; color: black;}
        &lt;/style&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;h1&gt;Ma todolist&lt;/h1&gt;

        &lt;ul&gt;
        &lt;% todolist.forEach(function(todo, index) { %&gt;
            &lt;li&gt;&lt;a href=&quot;/todo/supprimer/&lt;%= index %&gt;&quot;&gt;✘&lt;/a&gt; &lt;%= todo %&gt;&lt;/li&gt;
        &lt;% }); %&gt;
        &lt;/ul&gt;

        &lt;form action=&quot;/todo/ajouter/&quot; method=&quot;post&quot;&gt;
            &lt;p&gt;
                &lt;label for=&quot;newtodo&quot;&gt;Que dois-je faire ?&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;newtodo&quot; id=&quot;newtodo&quot; autofocus /&gt;
                &lt;input type=&quot;submit&quot; /&gt;
            &lt;/p&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-908725" data-claire-element-id="908725">Et avec ça, l'indispensable package.json qui permet d'installer les dépendances avec un simple <code data-claire-semantic="console">npm install</code> :</p><pre id="r-908726" data-claire-element-id="908726"><code data-claire-semantic="javascript">{
    &quot;name&quot;: &quot;ma-todolist&quot;,
    &quot;version&quot;: &quot;0.1.0&quot;,
    &quot;dependencies&quot;: {
        &quot;express&quot;: &quot;~3.2.1&quot;,
        &quot;ejs&quot;: &quot;~0.8.3&quot;
    },
    &quot;author&quot;: &quot;Mateo21 &lt;<a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="264b47524349141766434b474f4a0845494b">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>&gt;&quot;,
    &quot;description&quot;: &quot;Un gestionnaire de todolist ultra basique&quot;
}</code></pre><h2 id="r-les-explications-qui-vont-bien" data-claire-element-id="908739">Les explications qui vont bien</h2><p id="r-908728" data-claire-element-id="908728">Bon, déjà mon code est assez commenté, ce qui devrait vous permettre de vous y retrouver.</p><p id="r-908729" data-claire-element-id="908729">Vous remarquerez que je me suis permis de rediriger le visiteur vers la liste (<code>/todo</code>) après un ajout ou une suppression d'élément, avec <code data-claire-semantic="javascript">res.redirect('/todo')</code>.</p><p id="r-908730" data-claire-element-id="908730">La liste des tâches est stockée dans un array (tableau). C'est d'ailleurs lui qui est la cause de la petite subtilité de ce programme : comme JavaScript n'apprécie pas qu'on essaie de parcourir des arrays qui n'existent pas, j'ai créé un middleware qui crée un array vide si le visiteur n'a pas de todolist (parce qu'il vient de commencer sa session par exemple). C'est le rôle de ce code :</p><pre id="r-908731" data-claire-element-id="908731"><code data-claire-semantic="javascript">.use(function(req, res, next){
    if (typeof(req.session.todolist) == 'undefined') {
        req.session.todolist = [];
    }
    next();
})</code></pre><p id="r-908732" data-claire-element-id="908732">Cette fonction <em>middleware</em> reçoit la requête, la réponse et la prochaine fonction à exécuter. J'ai donc écrit moi-même un middleware à l'instar de cookieParser(), session() et bodyParser(). Son rôle est très simple : il vérifie s'il y a une todolist dans la session et, si ce n'est pas le cas, il crée un array vide (d'où les <code data-claire-semantic="javascript">[]</code>). Ca nous évite beaucoup d'erreurs par la suite.</p><p id="r-908733" data-claire-element-id="908733">Pourquoi avoir créé un middleware ? Parce que c'est le seul moyen à ma disposition pour exécuter des fonctionnalités <em>avant</em> le chargement de n'importe quelle page. Pour que le middleware &quot;passe le bébé à son voisin&quot;, je dois finir impérativement par un appel à <code data-claire-semantic="javascript">next()</code> (la fonction suivante). Dans le cas présent, <code data-claire-semantic="javascript">next()</code> fait référence à <code data-claire-semantic="javascript">.get('/todo', function() {})</code>.</p><p id="r-908734" data-claire-element-id="908734">A part ça, rien de vraiment particulier. J'ajoute des éléments à la fin du tableau <code data-claire-semantic="javascript">avec .push()</code> et je retire des éléments avec <code data-claire-semantic="javascript">.splice()</code>, mais ça c'est du JavaScript de base. ;)</p><p id="r-908735" data-claire-element-id="908735">Du côté du template, qu'est-ce qu'il y a de particulier ? Hmm, pas grand chose... Si ce n'est que je parcours la todolist avec un forEach (là encore, c'est du JavaScript) :</p><pre id="r-908736" data-claire-element-id="908736"><code>&lt;% todolist.forEach(function(todo, index) { %&gt;
    &lt;li&gt;&lt;a href=&quot;/todo/supprimer/&lt;%= index %&gt;&quot;&gt;✘&lt;/a&gt; &lt;%= todo %&gt;&lt;/li&gt;
&lt;% }); %&gt;</code></pre><aside id="r-908738" data-claire-element-id="908738" data-claire-semantic="information"><p id="r-908737" data-claire-element-id="908737">La croix pour supprimer un élément est un simple caractère Unicode (vive Unicode :D ). Vous n'imaginez pas le nombre de symboles Unicode qu'on peut trouver en faisant une recherche Google du type &quot;unicode cross&quot;, &quot;unicode smiley&quot;, &quot;unicode plane&quot;, &quot;unicode arrow&quot;, etc.</p></aside><h2 id="r-telecharger-le-projet-4" data-claire-element-id="908743">Télécharger le projet</h2><p id="r-908740" data-claire-element-id="908740">Je vous ai donné tout le code du projet, mais si vous insistez pour télécharger le tout dans un fichier .zip, alors suivez le lien ci-dessous :</p><p id="r-908741" data-claire-element-id="908741"><a href="http://www.sdz-files.com/cours/nodejs/ma-todolist.zip"><strong>Télécharger le projet Node.js ma-todolist.zip</strong></a></p><p id="r-908742" data-claire-element-id="908742">N'oubliez pas de faire un <code data-claire-semantic="console">npm install</code> pour installer les dépendances avant de l'exécuter !</p><h2 id="r-allez-plus-loin-4" data-claire-element-id="908762">Allez plus loin !</h2><p id="r-908744" data-claire-element-id="908744">Ma petite todolist est très basique. Vous pouvez lui ajouter de nombreuses fonctionnalités :</p><ul id="r-908759" data-claire-element-id="908759"><li id="r-908746" data-claire-element-id="908746"><p id="r-908745" data-claire-element-id="908745">Modification des noms des tâches</p></li><li id="r-908748" data-claire-element-id="908748"><p id="r-908747" data-claire-element-id="908747">Réagencement des tâches entre elles</p></li><li id="r-908750" data-claire-element-id="908750"><p id="r-908749" data-claire-element-id="908749">Exportation CSV</p></li><li id="r-908752" data-claire-element-id="908752"><p id="r-908751" data-claire-element-id="908751">Attribution d'une priorité et d'une date limite</p></li><li id="r-908754" data-claire-element-id="908754"><p id="r-908753" data-claire-element-id="908753">Persistence de la todolist (stockage dans une base de données ou une base NoSQL)</p></li><li id="r-908756" data-claire-element-id="908756"><p id="r-908755" data-claire-element-id="908755">Partage d'une todolist entre plusieurs personnes</p></li><li id="r-908758" data-claire-element-id="908758"><p id="r-908757" data-claire-element-id="908757">Synchronisation de la todolist en temps réel entre les personnes sans avoir besoin de recharger la page</p></li></ul><p id="r-908760" data-claire-element-id="908760">Certaines de ces fonctionnalités sont plus faciles à réaliser que d'autres. Pour d'autres, il vous faudra découvrir et utiliser de nouveaux modules.</p><p id="r-908761" data-claire-element-id="908761">Vous avez de quoi vous amuser pendant un bon petit moment, bon courage ! :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js">Des applications ultra-rapides avec Node.js</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Comprendre Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-mais-a-quoi-ca-sert">Node.js : mais à quoi ça sert ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/du-javascript-a-la-papa-a-node-js">
Du JavaScript &quot;à la papa&quot; à Node.js
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/node-js-le-javascript-cote-serveur">
Node.js : le JavaScript côté serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/pourquoi-node-js-est-il-rapide">
Pourquoi Node.js est-il rapide ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installer-node-js">Installer Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-windows">
Installation de Node.js sous Windows
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-mac-os-x">
Installation de Node.js sous Mac OS X
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/installation-de-node-js-sous-linux">
Installation de Node.js sous Linux
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tester-node-js-avec-un-programme-minimal">
Tester Node.js avec un programme minimal
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/une-premiere-application-avec-node-js">Une première application avec Node.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/des-serveurs-web-et-des-threads">
Des serveurs web et des threads
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/construire-son-serveur-http">
Construire son serveur HTTP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/retourner-du-code-html">
Retourner du code HTML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/determiner-la-page-appelee-et-les-parametres">
Déterminer la page appelée et les paramètres
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Structurer son application Node.js
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-evenements-18">Les évènements</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/ecouter-des-evenements">
Ecouter des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/emettre-des-evenements">
Emettre des évènements
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-modules-node-js-et-npm">Les modules Node.js et NPM</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/creer-des-modules-2">
Créer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/utiliser-npm-pour-installer-des-modules">
Utiliser NPM pour installer des modules
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/declarer-et-publier-son-module">
Déclarer et publier son module
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/le-framework-express-js">Le framework Express.js</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-routes-1">
Les routes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/les-templates-5">
Les templates
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/aller-plus-loin-connect-et-les-middlewares">
Aller plus loin : Connect et les middlewares
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/tp-la-todo-list">TP : la todo list</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
Besoin d&#039;aide ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/correction-220">
Correction
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/des-applications-ultra-rapides-avec-node-js/besoin-d-aide">
<span class="arrow"></span>
<span class="next">Besoin d&#039;aide ?</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/des-applications-ultra-rapides-avec-node-js.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 02:54:37 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/des-applications-ultra-rapides-avec-node-js.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:38:19 GMT -->
</html>