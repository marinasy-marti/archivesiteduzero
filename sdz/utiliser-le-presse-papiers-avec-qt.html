<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/utiliser-le-presse-papiers-avec-qt.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:56:19 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/utiliser-le-presse-papiers-avec-qt.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:13:49 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Utiliser le presse-papiers avec Qt</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Utiliser le presse-papiers avec Qt</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Utiliserlepresse-papiersavecQt">Utiliser le presse-papiers avec Qt</a><br/><a href="#Manipulerlesdonnesduclipboard">Manipuler les données du clipboard</a><br/><a href="#LesdonnesMIME">Les données MIME</a><br/><a href="#Lessignauxdupresse-papiers">Les signaux du presse-papiers</a><br/></div>
<a name="Utiliserlepresse-papiersavecQt"></a><h2>Utiliser le presse-papiers avec Qt</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/manipuler-les-donnees-du-clipboard">
<span class="next">Manipuler les données du clipboard</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-592642" data-claire-element-id="592642">La bibliothèque Qt est très utile et surtout très complète. Elle renferme plusieurs classes intéressantes, comme la classe <strong>QClipboard</strong>. Aujourd'hui, je vais vous montrer comment utiliser cette classe dans ce petit tutoriel. Avant d'aller plus loin, vous devez connaître la <a href="http://www.siteduzero.com/tutoriel-3-11240-introduction-a-qt.html">bibliothèque Qt</a> et savoir comment faire des fenêtres avec celle-ci.</p><p id="r-592643" data-claire-element-id="592643">Le <em>clipboard</em> est très utile lorsqu'on veut stocker, déplacer ou dupliquer des données comme des images, des textes, etc. Dans certaines de vos applications, il est fort probable que vous ayez besoin de manipuler les données dans le presse-papiers. Maintenant, je vais vous montrer comment cela fonctionne. Alors commençons ! :D</p><aside id="r-592645" data-claire-element-id="592645" data-claire-semantic="information"><p id="r-592644" data-claire-element-id="592644"><em>Clipboard</em> veut dire presse-papiers en anglais.</p></aside>
</div><a name="Manipulerlesdonnesduclipboard"></a><h2>Manipuler les données du clipboard</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
<span class="next">Les données MIME</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-les-textes-2" data-claire-element-id="592658">Les textes</h2><p id="r-592646" data-claire-element-id="592646">La manipulation des données du presse-papiers est très simple avec Qt. Le bout de code qui suit stocke le texte contenu dans le <em>clipboard</em> dans un <strong>QString</strong> :</p><pre id="r-592647" data-claire-element-id="592647"><code data-claire-semantic="cpp">QClipboard *pressePapiers = QApplication::clipboard();
QString textePressePapiers = pressePapiers-&gt;text();</code></pre><p id="r-592648" data-claire-element-id="592648">Maintenant, analysons les deux lignes ci-dessus l'une après l'autre.</p><pre id="r-592649" data-claire-element-id="592649"><code data-claire-semantic="cpp">QClipboard *pressePapiers = QApplication::clipboard();</code></pre><p id="r-592650" data-claire-element-id="592650">La méthode statique clipboard() de la classe <strong>QApplication</strong> retourne un pointeur vers le presse-papiers de l'application.</p><pre id="r-592651" data-claire-element-id="592651"><code data-claire-semantic="cpp">QString textePressePapiers = pressePapiers-&gt;text();</code></pre><p id="r-592652" data-claire-element-id="592652">La méthode text() de la classe <strong>QClipboard</strong> retourne le texte contenu dans le presse-papiers. Si vous vous rappelez le tutoriel sur Qt de M@teo21 et Nanoc, vous devriez connaître la syntaxe des accesseurs et des mutateurs avec Qt. La méthode text() est un accesseur, donc le mutateur qui change le texte contenu dans le <em>clipboard</em> est setText(QString text).</p><aside id="r-592654" data-claire-element-id="592654" data-claire-semantic="information"><p id="r-592653" data-claire-element-id="592653">La méthode setText(QString text) prend une <strong>QString</strong> comme argument, celle-ci est bien évidemment le texte qui va être mis dans le presse-papiers.</p></aside><div id="r-592656" data-claire-element-id="592656" data-claire-semantic="question"><p id="r-592655" data-claire-element-id="592655">Oui, mais tu as dit qu'on pouvait stocker plusieurs types de données, comme des images... Ce n'est que du texte, ça ! :euh:</p></div><p id="r-592657" data-claire-element-id="592657">Patience, patience. J'allais justement répondre à votre question. ;)</p><h2 id="r-les-images-22" data-claire-element-id="592669">Les images</h2><p id="r-592659" data-claire-element-id="592659">Pour les images, c'est la même chose que pour le texte — sauf le nom des méthodes bien sûr. :p Mais avec Qt et le <em>clipboard</em>, il y a deux types d'images : le <strong>QImage</strong> et le <strong>QPixmap</strong>.</p><div id="r-592661" data-claire-element-id="592661" data-claire-semantic="question"><p id="r-592660" data-claire-element-id="592660">Quelle est la différence entre les deux ?</p></div><p id="r-592662" data-claire-element-id="592662">La différence, c'est que <strong>QImage</strong> est une classe qui permet un accès direct aux données des pixels de l'image, donc elle est spécialement conçue pour être <a href="http://doc.qt.nokia.com/4.7-snapshot/paintsystem.html">peinte</a>. Tandis que la classe <strong>QPixmap</strong> est conçue pour être affichée. Lorsque vous voulez afficher une image rapidement, utilisez <strong>QPixmap</strong> ; quand vous voulez faire des retouches sur l'image, utilisez <strong>QImage</strong>.</p><p id="r-592663" data-claire-element-id="592663">Comme je l'ai dit plus haut, seuls les noms et les types d'arguments diffèrent avec les images. Ce qui donne pour les accesseurs :</p><pre id="r-592664" data-claire-element-id="592664"><code data-claire-semantic="cpp">image() //Retourne QImage.
pixmap() //Retourne QPixmap.</code></pre><p id="r-592665" data-claire-element-id="592665">Et pour les mutateurs :</p><pre id="r-592666" data-claire-element-id="592666"><code data-claire-semantic="cpp">setImage(QImage image)
setPixmap(QPixmap pixmap)</code></pre><p id="r-592667" data-claire-element-id="592667">C'est simple, non ? ^^ Il y a aussi une méthode pour vider le contenu du presse-papiers : la méthode clear(). Elle est très facile à utiliser.</p><pre id="r-592668" data-claire-element-id="592668"><code data-claire-semantic="cpp">pressePapiers-&gt;clear(); //Vide le presse-papiers</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt">Utiliser le presse-papiers avec Qt</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/manipuler-les-donnees-du-clipboard">
Manipuler les données du clipboard
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
Les données MIME
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-signaux-du-presse-papiers">
Les signaux du presse-papiers
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
<span class="next">Les données MIME</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LesdonnesMIME"></a><h2>Les données MIME</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/manipuler-les-donnees-du-clipboard">
<span class="arrow"></span>
<span class="next">Manipuler les données du clipboard</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-signaux-du-presse-papiers">
<span class="next">Les signaux du presse-papiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-592671" data-claire-element-id="592671">Dans cette sous-partie, nous allons aborder les données MIME.</p><div id="r-592673" data-claire-element-id="592673" data-claire-semantic="question"><p id="r-592672" data-claire-element-id="592672">Mime... Ce n'est pas une sorte de clown ?!</p></div><p id="r-592674" data-claire-element-id="592674">Bien sûr que non ! MIME est l’acronyme de <em>Multipurpose Internet Mail Extensions</em>.</p><p id="r-592675" data-claire-element-id="592675"><cite>Citation : http://fr.wikipedia.org/wiki/Multipurpose_Internet_Mail_Extensions</cite></p><blockquote id="r-592677" data-claire-element-id="592677"><p id="r-592676" data-claire-element-id="592676">« <em>Multipurpose Internet Mail Extensions</em> (MIME) est un standard internet qui étend le format de données des courriels pour supporter des textes en différents codages de caractères autres que l'ASCII, des contenus non textuels, des contenus multiples, et des informations d'en-tête en d'autres codages que l'ASCII. »</p></blockquote><p id="r-592678" data-claire-element-id="592678">Bref, il s'agit d'un format de données polyvalent. La classe qui contient les données MIME dans Qt est <a href="http://doc.qt.nokia.com/latest/qmimedata.html#details">QMimeData</a>. Le presse-papiers peut retourner un pointeur sur le <strong>QMimeData</strong> de celui-ci. Rien de plus simple :</p><pre id="r-592679" data-claire-element-id="592679"><code data-claire-semantic="cpp">QMimeData *mimeData = pressePapiers-&gt;mimeData();</code></pre><p id="r-592680" data-claire-element-id="592680">Voilà ! :)</p><div id="r-592682" data-claire-element-id="592682" data-claire-semantic="question"><p id="r-592681" data-claire-element-id="592681">C'est bien beau tout ça, mais on est supposé faire quoi avec les données MIME ? o_O</p></div><p id="r-592683" data-claire-element-id="592683">Avec ces données, on peut facilement savoir si le <em>clipboard</em> contient du texte en format HTML, des hyperliens ou même une couleur ! Pour savoir cela, la classe <strong>QMimeData</strong> renferme de précieux testeurs. Ces testeurs retournent <em>true</em> si le <strong>QMimeData</strong> contient ce qu'ils testent, sinon ils retournent <em> false</em>.</p><pre id="r-592684" data-claire-element-id="592684"><code data-claire-semantic="cpp">hasText() //Pour savoir s'il contient du texte.
hasHtml() //Pour savoir s'il contient du HTML.
hasUrls() //Pour savoir s'il contient des hyperliens.
hasImage() //Pour savoir s'il contient une image.
hasColor() //Pour savoir s'il contient une couleur.</code></pre><p id="r-592685" data-claire-element-id="592685">Ils sont très faciles à utiliser. Rien de mieux qu'un exemple pour démontrer leur utilité.</p><pre id="r-592686" data-claire-element-id="592686"><code data-claire-semantic="cpp">QClipboard *pressePapiers = QApplication::clipboard();
QMimeData *mimeData = pressePapiers-&gt;mimeData();

if(mimeData-&gt;hasText())
{
    qDebug() &lt;&lt; &quot;Texte&quot;; 
}
else if(mimeData-&gt;hasHtml())
{
    qDebug() &lt;&lt; &quot;HTML&quot;; 
}
else if(mimeData-&gt;hasUrls())
{
    qDebug() &lt;&lt; &quot;Hyperliens&quot;; 
}
else if(mimeData-&gt;hasImage())
{
    qDebug() &lt;&lt; &quot;Image&quot;; 
}
else if(mimeData-&gt;hasColor())
{
    qDebug() &lt;&lt; &quot;Couleur&quot;; 
}
else
{
    qDebug() &lt;&lt; &quot;Données inconnues!&quot;; 
}</code></pre><p id="r-592687" data-claire-element-id="592687">Il y a les testeurs, mais il y a aussi les accesseurs et les mutateurs. Voici un exemple avec le format HTML et texte seulement :</p><pre id="r-592688" data-claire-element-id="592688"><code data-claire-semantic="cpp">QClipboard *pressePapiers = QApplication::clipboard();
QMimeData *mimeData = pressePapiers-&gt;mimeData();

if(mimeData-&gt;hasHtml())
{
    textEdit-&gt;setPlainText(mimeData-&gt;text()); //Met le texte contenu dans le presse-papiers dans le QTextEdit.
}
else if(mimeData-&gt;hasText())
{
    textEdit-&gt;setHtml(mimeData-&gt;html()); //Met le html contenu dans le presse-papiers dans le QTextEdit.
}</code></pre><p id="r-592689" data-claire-element-id="592689">Pour les couleurs et les images c'est un peu différent, car il faut faire des <em>casts</em>.</p><pre id="r-592690" data-claire-element-id="592690"><code data-claire-semantic="cpp">QClipboard *pressePapiers = QApplication::clipboard();
QMimeData *mimeData = pressePapiers-&gt;mimeData();

if(mimeData-&gt;hasImage())
{
    QPixmap image = qvariant_cast&lt;QPixmal&gt;(mimeData-&gt;imageData());
    //Continuer avec l'image obtenue !
}
else if(mimeData-&gt;hasColor())
{
    QColor couleur = qvariant_cast&lt;QColor&gt;(mimeData-&gt;colorData());
    //Continuer avec la couleur obtenue !
}</code></pre><p id="r-592691" data-claire-element-id="592691">Comme vous pouvez le constater, les données MIME sont très utiles quand il faut s'occuper du presse-papiers.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt">Utiliser le presse-papiers avec Qt</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/manipuler-les-donnees-du-clipboard">
Manipuler les données du clipboard
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
Les données MIME
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-signaux-du-presse-papiers">
Les signaux du presse-papiers
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/manipuler-les-donnees-du-clipboard">
<span class="arrow"></span>
<span class="next">Manipuler les données du clipboard</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-signaux-du-presse-papiers">
<span class="next">Les signaux du presse-papiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lessignauxdupresse-papiers"></a><h2>Les signaux du presse-papiers</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
<span class="arrow"></span>
<span class="next">Les données MIME</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-592693" data-claire-element-id="592693">La classe <strong>QClipboard</strong> renferme quelques signaux, mais un seul est intéressant à mon avis : le signal dataChanged. Dans cette sous-partie, je vais vous expliquer son fonctionnement.</p><div id="r-592695" data-claire-element-id="592695" data-claire-semantic="question"><p id="r-592694" data-claire-element-id="592694">Quand je regarde dans la documentation de la classe <strong>QClipboard</strong>, il y a quatre signaux. Pourquoi tu nous en expliques juste un ?! :euh:</p></div><p id="r-592696" data-claire-element-id="592696">La réponse est simple. Le signal findBufferChanged est seulement pour Mac OSX, et le signal selectionChanged pour les systèmes d'exploitation qui supportent les sélections (comme X11). Or Mac OSX et Windows ne supportent pas les sélections. Si ces signaux vous intéressent, vous pouvez lire la <a href="http://doc.qt.nokia.com/latest/qclipboard.html#selectionChanged">documentation</a>. :D</p><h2 id="r-datachanged" data-claire-element-id="592701">dataChanged</h2><p id="r-592697" data-claire-element-id="592697">Ce signal est vraiment simple à comprendre et à utiliser ! Il est émis lorsque les données du presse-papiers sont changées. Comme dans les autres sous-parties, je vais commencer par un exemple.</p><pre id="r-592698" data-claire-element-id="592698"><code data-claire-semantic="cpp">QObject::connect(pressePapiers, SIGNAL(dataChanged()), this, SLOT(pressePapiersChanger()));

.... //Un peu plus loin dans le code.

void pressePapiersChanger()
{
    qDebug() &lt;&lt; &quot;Les données du clipboard ont changé!&quot;;
}</code></pre><p id="r-592699" data-claire-element-id="592699">Si vous ne comprenez pas cela, je vous conseille de lire les sous-parties précédentes du tutoriel et le chapitre sur <a href="http://www.siteduzero.com/tutoriel-3-11268-les-signaux-et-les-slots.html">les signaux et les <em>slots</em></a> du tutoriel de M@teo21 et Nanoc.</p><p id="r-592700" data-claire-element-id="592700">Ainsi se termine mon mini-tutoriel sur le presse-papiers avec la bibliothèque Qt. Ce n'était pas très difficile à comprendre, mais si vous avez des questions auxquelles la <a href="http://doc.qt.nokia.com/latest/qclipboard.html">documentation</a> ne répond pas, n'hésitez pas à les poser.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt">Utiliser le presse-papiers avec Qt</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/manipuler-les-donnees-du-clipboard">
Manipuler les données du clipboard
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
Les données MIME
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-signaux-du-presse-papiers">
Les signaux du presse-papiers
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-le-presse-papiers-avec-qt/les-donnees-mime">
<span class="arrow"></span>
<span class="next">Les données MIME</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/utiliser-le-presse-papiers-avec-qt.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:56:19 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/utiliser-le-presse-papiers-avec-qt.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:13:49 GMT -->
</html>