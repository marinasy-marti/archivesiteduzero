<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/la-balise-canvas-avec-javascript.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:52:57 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/la-balise-canvas-avec-javascript.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:43 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : La balise &lt;canvas&gt; avec JavaScript</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/la-balise-canvas-avec-javascript.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : La balise &lt;canvas&gt; avec JavaScript</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#LabaliseltcanvasgtavecJavaScript">La balise &lt;canvas&gt; avec JavaScript</a><br/><a href="#Miseenplaceducodeminimal">Mise en place du code minimal</a><br/><a href="#Commenonsdessiner">Commençons à dessiner !</a><br/><a href="#Lesbasesdel039animation">Les bases de l&#039;animation</a><br/><a href="#TPCrationd039uneballerebondissantsurlesbordsducanvas">TP: Création d&#039;une balle rebondissant sur les bords du canvas</a><br/></div>
<a name="LabaliseltcanvasgtavecJavaScript"></a><h2>La balise &lt;canvas&gt; avec JavaScript</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
<span class="next">Mise en place du code minimal</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-441951" data-claire-element-id="441951">La balise <code data-claire-semantic="html">&lt;canvas&gt;</code>, introduite avec l'<a href="http://fr.wikipedia.org/wiki/HTML5">HTML5</a> est déjà utilisable sur plusieurs navigateurs tels que <em>Mozilla Firefox</em>, <em>Safari</em>, <em>Google Chrome</em> ou <em>Opera</em>. Elle permet, via moult fonctions de dessin Javascript de générer dans ce dernier, des formes, images ou textes. J'aurais donc pour but dans ce tutoriel de vous apprendre à maîtriser les bases du dessin et de l'animation avec <code data-claire-semantic="html">&lt;canvas&gt;</code>.</p>
</div><a name="Miseenplaceducodeminimal"></a><h2>Mise en place du code minimal</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
<span class="next">Commençons à dessiner !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-441952" data-claire-element-id="441952">Avant de commencer à animer des formes, il nous faut tout d'abord déclarer notre canvas et le lier à notre Javascript. Le code suivant est la structure minimale afin que tout projet <code data-claire-semantic="html">&lt;canvas&gt;</code> fonctionne correctement.</p><pre id="r-441953" data-claire-element-id="441953"><code data-claire-semantic="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Mon projet canvas&lt;/title&gt;
        &lt;script src=&quot;canvas.js&quot;&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;canvas id=&quot;mon_canvas&quot; width=&quot;500&quot; height=&quot;500&quot;&gt;
            Message pour les navigateurs ne supportant pas encore canvas.
        &lt;/canvas&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-441954" data-claire-element-id="441954">Rien de bien compliqué ici, hormis la déclaration du canvas qui peut vous sembler un peu nouvelle.</p><ul id="r-441959" data-claire-element-id="441959"><li id="r-441956" data-claire-element-id="441956"><p id="r-441955" data-claire-element-id="441955"><code data-claire-semantic="html">id=&quot;mon_canvas&quot;</code> : Sert à identifier le &lt;canvas&gt;.</p></li><li id="r-441958" data-claire-element-id="441958"><p id="r-441957" data-claire-element-id="441957"><code data-claire-semantic="html">width=&quot;500&quot; height=&quot;500&quot;</code> : Ce n'est pas indispensable, mais sans çà, le canvas prend la forme d'un rectangle de 100x200 pixels. Notez qu'il est tout de même possible de régler la taille plus tard via Javascript.</p></li></ul><pre id="r-441960" data-claire-element-id="441960"><code data-claire-semantic="javascript">window.onload = function()
{
    var canvas = document.getElementById('mon_canvas');
        if(!canvas)
        {
            alert(&quot;Impossible de récupérer le canvas&quot;);
            return;
        }

    var context = canvas.getContext('2d');
        if(!context)
        {
            alert(&quot;Impossible de récupérer le context du canvas&quot;);
            return;
        }


    //C'est ici que l'on placera tout le code servant à nos dessins.
}</code></pre><p id="r-441961" data-claire-element-id="441961">Un peu plus compliqué ici, mais ça reste tout de même relativement simple ;)</p><ul id="r-441968" data-claire-element-id="441968"><li id="r-441963" data-claire-element-id="441963"><p id="r-441962" data-claire-element-id="441962"><code data-claire-semantic="javascript">window.onload = function(){ ... }</code> : Cela permet d'empêcher l'exécution du code avant le chargement complet de tous les éléments de la page.</p></li><li id="r-441965" data-claire-element-id="441965"><p id="r-441964" data-claire-element-id="441964"><code data-claire-semantic="javascript">var canvas = document.getElementById('mon_canvas');</code> : On récupère l'objet canvas dans la variable <em>canvas</em>, on vérifie ensuite que tout c'est bien passé.</p></li><li id="r-441967" data-claire-element-id="441967"><p id="r-441966" data-claire-element-id="441966"><code data-claire-semantic="javascript">var context = canvas.getContext('2d');</code> : On récupère le <em>context</em> du canvas. Ce sont les méthodes de cet objet que l'on utilisera pour dessiner sur le canvas.</p></li></ul><aside id="r-441970" data-claire-element-id="441970" data-claire-semantic="information"><p id="r-441969" data-claire-element-id="441969">Une fois tout ce code mis en place, vous êtes prêts à faire de beaux dessins.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript">La balise &lt;canvas&gt; avec JavaScript</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
Mise en place du code minimal
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
Commençons à dessiner !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
Les bases de l&#039;animation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/tp-creation-d-une-balle-rebondissant-sur-les-bords-du-canvas">
TP: Création d&#039;une balle rebondissant sur les bords du canvas
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
<span class="next">Commençons à dessiner !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Commenonsdessiner"></a><h2>Commençons à dessiner !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
<span class="arrow"></span>
<span class="next">Mise en place du code minimal</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
<span class="next">Les bases de l&#039;animation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-441972" data-claire-element-id="441972">Comme je l'ai dit plus haut, toutes les méthodes de dessin s'utiliseront sur l'objet <em>context</em>. Nous allons tout d'abord voir les formes les plus simples, et nous terminerons avec les plus complexes.</p><h2 id="r-les-types-de-formes" data-claire-element-id="441984">Les types de formes</h2><p id="r-441973" data-claire-element-id="441973">Avant de tracer la moindre forme, il faut savoir qu'il en existe deux types :</p><ul id="r-441982" data-claire-element-id="441982"><li id="r-441976" data-claire-element-id="441977"><img id="r-441977" data-claire-element-id="441976" src="medias/uploads.siteduzero.com_files_334001_335000_334728.png" alt="Forme pleine"/><img id="r-441974" data-claire-element-id="441974" src="medias/uploads.siteduzero.com_files_334001_335000_334728.png" alt="Forme pleine"/><p id="r-441975" data-claire-element-id="441975">Les formes de type «fill», ce sont des formes pleines.</p></li><li id="r-441980" data-claire-element-id="441981"><img id="r-441981" data-claire-element-id="441980" src="medias/uploads.siteduzero.com_files_334001_335000_334722.png" alt="Contour de la forme"/><img id="r-441978" data-claire-element-id="441978" src="medias/uploads.siteduzero.com_files_334001_335000_334722.png" alt="Contour de la forme"/><p id="r-441979" data-claire-element-id="441979">Les formes de type «stroke», ce sont les contours de la forme qui seront tracés.</p></li></ul><p id="r-441983" data-claire-element-id="441983">Ainsi, pour identifier quel type de forme on tracera avec telle ou telle méthodes, il nous suffira de lire son préfixe, à savoir : «fill» et «stroke».</p><h2 id="r-rappels-sur-les-coordonnees" data-claire-element-id="441999">Rappels sur les coordonnées</h2><figure id="r-441986" data-claire-element-id="441987"><img id="r-441985" data-claire-element-id="441985" src="medias/uploads.siteduzero.com_files_334001_335000_334723.png" alt="Schéma explicatif sur les coordonnées du canvas"/></figure><p id="r-441988" data-claire-element-id="441988">Pour pouvoir tracer quoi que ce soit, il vous faudra comprendre comment sont positionnés les éléments sur le canvas.<br/> Chacun des éléments composant notre dessin est positionné sur un repère imaginaire dont l'origine est le coin supérieur gauche du canvas. <br/> Ainsi, si l'on avait un canvas de 300 pixels sur 300 pixels,</p><ul id="r-441997" data-claire-element-id="441997"><li id="r-441990" data-claire-element-id="441990"><p id="r-441989" data-claire-element-id="441989">Le point [0, 0] se situerait en haut à gauche</p></li><li id="r-441992" data-claire-element-id="441992"><p id="r-441991" data-claire-element-id="441991">Le point [300, 300] se situerait lui tout en bas à droite.</p></li><li id="r-441994" data-claire-element-id="441994"><p id="r-441993" data-claire-element-id="441993">Le point [0, 300] se situerait tout en bas à gauche.</p></li><li id="r-441996" data-claire-element-id="441996"><p id="r-441995" data-claire-element-id="441995">Etc...</p></li></ul><p id="r-441998" data-claire-element-id="441998">Je ne pense pas que ce soit cela qui vous cause le plus de problèmes, à moins bien sûr que vous ayez raté quelques cours de 6eme ;)</p><h2 id="r-les-formes-3" data-claire-element-id="442238">Les formes</h2><h3 id="r-le-rectangle-2" data-claire-element-id="442029">Le rectangle</h3><p id="r-442000" data-claire-element-id="442000">La méthode à utiliser, ici, est <code data-claire-semantic="javascript">fillRect(x, y, largeur, hauteur);</code>. Il va de soi que <code data-claire-semantic="javascript">strokeRect();</code> fonctionne aussi.</p><table id="r-442028" data-claire-element-id="442028"><thead id="r-442006" data-claire-element-id="442006"><tr id="r-442005" data-claire-element-id="442005"><th id="r-442002" data-claire-element-id="442002"><p id="r-442001" data-claire-element-id="442001">Paramètre :</p></th><th id="r-442004" data-claire-element-id="442004"><p id="r-442003" data-claire-element-id="442003">Description :</p></th></tr></thead><tbody id="r-442027" data-claire-element-id="442027"><tr id="r-442011" data-claire-element-id="442011"><td id="r-442008" data-claire-element-id="442008"><p id="r-442007" data-claire-element-id="442007">x</p></td><td id="r-442010" data-claire-element-id="442010"><p id="r-442009" data-claire-element-id="442009">Coordonnées du coin supérieur gauche sur l'abscisse</p></td></tr><tr id="r-442016" data-claire-element-id="442016"><td id="r-442013" data-claire-element-id="442013"><p id="r-442012" data-claire-element-id="442012">y</p></td><td id="r-442015" data-claire-element-id="442015"><p id="r-442014" data-claire-element-id="442014">Coordonnées du coin supérieur gauche sur l'ordonnée</p></td></tr><tr id="r-442021" data-claire-element-id="442021"><td id="r-442018" data-claire-element-id="442018"><p id="r-442017" data-claire-element-id="442017">Largeur</p></td><td id="r-442020" data-claire-element-id="442020"><p id="r-442019" data-claire-element-id="442019">Largeur du rectangle, en pixels.</p></td></tr><tr id="r-442026" data-claire-element-id="442026"><td id="r-442023" data-claire-element-id="442023"><p id="r-442022" data-claire-element-id="442022">Hauteur</p></td><td id="r-442025" data-claire-element-id="442025"><p id="r-442024" data-claire-element-id="442024">Hauteur du rectangle, en pixels.</p></td></tr></tbody></table><h3 id="r-les-lignes-5" data-claire-element-id="442092">Les lignes</h3><p id="r-442030" data-claire-element-id="442030">J'avoue que leurs noms n'ont vraiment rien d'alléchant, pourtant, elles sont assez utiles. Vous aurez quatre méthodes à connaître pour pouvoir exploiter leur potentiel.</p><figure id="r-442032" data-claire-element-id="442033"><img id="r-442031" data-claire-element-id="442031" src="medias/uploads.siteduzero.com_files_334001_335000_334724.png" alt="Illustration d'un exemple de tracé utilisant les lignes"/></figure><pre id="r-442034" data-claire-element-id="442034"><code data-claire-semantic="javascript">//On n'oublie pas de récupérer le canvas et son context.

context.beginPath();//On démarre un nouveau tracé
context.moveTo(0, 300);//On se déplace au coin inférieur gauche
context.lineTo(150, 0);
context.lineTo(300, 300);
context.lineTo(0, 300);
context.stroke();//On trace seulement les lignes.
context.closePath();</code></pre><table id="r-442067" data-claire-element-id="442067"><thead id="r-442040" data-claire-element-id="442040"><tr id="r-442039" data-claire-element-id="442039"><th id="r-442036" data-claire-element-id="442036"><p id="r-442035" data-claire-element-id="442035">Méthode :</p></th><th id="r-442038" data-claire-element-id="442038"><p id="r-442037" data-claire-element-id="442037">Utilité :</p></th></tr></thead><tbody id="r-442066" data-claire-element-id="442066"><tr id="r-442045" data-claire-element-id="442045"><td id="r-442042" data-claire-element-id="442042"><p id="r-442041" data-claire-element-id="442041"><code data-claire-semantic="javascript">context.beginPath();</code></p></td><td id="r-442044" data-claire-element-id="442044"><p id="r-442043" data-claire-element-id="442043">On indique au <em>context</em> que l'on s'apprête à effectuer un nouveau tracé. Quant à <code data-claire-semantic="javascript">context.closePath();</code>, il indique au <em>context</em> que l'on a terminé avec ce tracé.</p></td></tr><tr id="r-442050" data-claire-element-id="442050"><td id="r-442047" data-claire-element-id="442047"><p id="r-442046" data-claire-element-id="442046"><code data-claire-semantic="javascript">context.moveTo(x, y);</code></p></td><td id="r-442049" data-claire-element-id="442049"><p id="r-442048" data-claire-element-id="442048">Par défaut, si l'on trace une ligne, elle commencera aux coord. [0, 0]. Cette fonction déplace le point de départ de chaque ligne.</p></td></tr><tr id="r-442055" data-claire-element-id="442055"><td id="r-442052" data-claire-element-id="442052"><p id="r-442051" data-claire-element-id="442051"><code data-claire-semantic="javascript">context.lineTo(x, y);</code></p></td><td id="r-442054" data-claire-element-id="442054"><p id="r-442053" data-claire-element-id="442053">Cette fonction trace une ligne en partant de la position actuelle, jusqu'aux coordonnées x, y indiquées.</p></td></tr><tr id="r-442060" data-claire-element-id="442060"><td id="r-442057" data-claire-element-id="442057"><p id="r-442056" data-claire-element-id="442056"><code data-claire-semantic="javascript">context.fill();</code></p></td><td id="r-442059" data-claire-element-id="442059"><p id="r-442058" data-claire-element-id="442058">Créer une forme pleine à partir des lignes tracées.</p></td></tr><tr id="r-442065" data-claire-element-id="442065"><td id="r-442062" data-claire-element-id="442062"><p id="r-442061" data-claire-element-id="442061"><code data-claire-semantic="javascript">context.stroke();</code></p></td><td id="r-442064" data-claire-element-id="442064"><p id="r-442063" data-claire-element-id="442063">Créer juste les traits des lignes.</p></td></tr></tbody></table><table id="r-442091" data-claire-element-id="442091"><thead id="r-442075" data-claire-element-id="442075"><tr id="r-442074" data-claire-element-id="442074"><th id="r-442069" data-claire-element-id="442069"><p id="r-442068" data-claire-element-id="442068">Attribut :</p></th><th id="r-442071" data-claire-element-id="442071"><p id="r-442070" data-claire-element-id="442070">Utilité :</p></th><th id="r-442073" data-claire-element-id="442073"><p id="r-442072" data-claire-element-id="442072">Type de valeur accepté :</p></th></tr></thead><tbody id="r-442090" data-claire-element-id="442090"><tr id="r-442082" data-claire-element-id="442082"><td id="r-442077" data-claire-element-id="442077"><p id="r-442076" data-claire-element-id="442076"><code data-claire-semantic="javascript">context.lineWidth = valeur;</code></p></td><td id="r-442079" data-claire-element-id="442079"><p id="r-442078" data-claire-element-id="442078">Change l'épaisseur des lignes</p></td><td id="r-442081" data-claire-element-id="442081"><p id="r-442080" data-claire-element-id="442080">Nombre Entiers</p></td></tr><tr id="r-442089" data-claire-element-id="442089"><td id="r-442084" data-claire-element-id="442084"><p id="r-442083" data-claire-element-id="442083"><code data-claire-semantic="javascript">context.lineJoin = valeur;</code></p></td><td id="r-442086" data-claire-element-id="442086"><p id="r-442085" data-claire-element-id="442085">Change le type de jointure entre les lignes</p></td><td id="r-442088" data-claire-element-id="442088"><p id="r-442087" data-claire-element-id="442087">Chaîne de caractères suivantes : «round» (arrondi), ou «bevel» (en biseau)</p></td></tr></tbody></table><h3 id="r-le-cercle-1" data-claire-element-id="442142">Le cercle</h3><p id="r-442093" data-claire-element-id="442093">En réalité, il n'existe pas de méthode pour créer un cercle seulement. Il faut en fait passer par la fonction permettant le tracé d'un arc de cercle.</p><p id="r-442094" data-claire-element-id="442094">Voilà comment on utilise la fonction «arc» (c'est son p'tit nom :) ) :</p><pre id="r-442095" data-claire-element-id="442095"><code data-claire-semantic="javascript">//On n'oublie pas de récupérer l'objet canvas et son context.

context.beginPath(); //On démarre un nouveau tracé.
context.arc(100, 100, 50, 0, Math.PI*2); //On trace la courbe délimitant notre forme
context.fill(); //On utilise la méthode fill(); si l'on veut une forme pleine
context.closePath();</code></pre><aside id="r-442097" data-claire-element-id="442097" data-claire-semantic="information"><p id="r-442096" data-claire-element-id="442096">On utilisera <code data-claire-semantic="javascript">context.stroke();</code> quand on ne voudra que les contours de la forme.</p></aside><p id="r-442098" data-claire-element-id="442098">Étant donné qu'elle requiert beaucoup de paramètres qui, pour la plupart vous sembleront obscurs, j'ai jugé utile de vous les présenter sous forme de tableau :</p><table id="r-442136" data-claire-element-id="442136"><thead id="r-442104" data-claire-element-id="442104"><tr id="r-442103" data-claire-element-id="442103"><th id="r-442100" data-claire-element-id="442100"><p id="r-442099" data-claire-element-id="442099">Paramètre :</p></th><th id="r-442102" data-claire-element-id="442102"><p id="r-442101" data-claire-element-id="442101">Description :</p></th></tr></thead><tbody id="r-442135" data-claire-element-id="442135"><tr id="r-442109" data-claire-element-id="442109"><td id="r-442106" data-claire-element-id="442106"><p id="r-442105" data-claire-element-id="442105">x</p></td><td id="r-442108" data-claire-element-id="442108"><p id="r-442107" data-claire-element-id="442107">Coordonnées du centre du cercle, sur l'abscisse</p></td></tr><tr id="r-442114" data-claire-element-id="442114"><td id="r-442111" data-claire-element-id="442111"><p id="r-442110" data-claire-element-id="442110">y</p></td><td id="r-442113" data-claire-element-id="442113"><p id="r-442112" data-claire-element-id="442112">Coordonnées du centre du cercle, sur l'ordonnée.</p></td></tr><tr id="r-442119" data-claire-element-id="442119"><td id="r-442116" data-claire-element-id="442116"><p id="r-442115" data-claire-element-id="442115">Rayon</p></td><td id="r-442118" data-claire-element-id="442118"><p id="r-442117" data-claire-element-id="442117">C'est tout simplement le rayon du cercle (exprimé en pixels)</p></td></tr><tr id="r-442124" data-claire-element-id="442124"><td id="r-442121" data-claire-element-id="442121"><p id="r-442120" data-claire-element-id="442120">Angle de départ</p></td><td id="r-442123" data-claire-element-id="442123"><p id="r-442122" data-claire-element-id="442122">C'est l'angle à partir duquel on va commencer notre tracé, il est exprimé en Radians (voir le schéma ci-dessous).</p></td></tr><tr id="r-442129" data-claire-element-id="442129"><td id="r-442126" data-claire-element-id="442126"><p id="r-442125" data-claire-element-id="442125">Angle de fin</p></td><td id="r-442128" data-claire-element-id="442128"><p id="r-442127" data-claire-element-id="442127">C'est l'angle jusqu’au quel on va effectuer notre tracé. Il est lui aussi exprimé en Radians.</p></td></tr><tr id="r-442134" data-claire-element-id="442134"><td id="r-442131" data-claire-element-id="442131"><p id="r-442130" data-claire-element-id="442130"><em>«Anti-clockwise»</em></p></td><td id="r-442133" data-claire-element-id="442133"><p id="r-442132" data-claire-element-id="442132">C'est un booléen qui, quand il vaut <code data-claire-semantic="javascript">true</code> inverse le sens du tracé. Ainsi, l'angle de départ sera l'angle de fin, et l'angle de fin sera, quant à lui, l'angle de départ.</p></td></tr></tbody></table><p id="r-442137" data-claire-element-id="442137">Tout comme me l'a très justement signalé <a href="http://www.siteduzero.com/membres-294-201420.html">Amatewasu</a>, mes explications quant aux angles n'étaient visiblement pas des plus claires, et c'est pourquoi j'ai rajouté ce petit paragraphe explicatif afin que tout le monde s'y retrouve.</p><figure id="r-442139" data-claire-element-id="442140"><img id="r-442138" data-claire-element-id="442138" src="medias/uploads.siteduzero.com_thb_335001_336000_335032.png" alt="Schéma Radians"/></figure><p id="r-442141" data-claire-element-id="442141">Pour définir un angle, il vous suffit de multiplier à <code data-claire-semantic="javascript">Math.PI</code> une valeur comprise entre 0 et 2 afin de définir la position de votre angle. Notez que si le 2 n’apparaît pas sur le schéma, c'est parce qu'il est exactement à la même position que le 0, mais après une révolution complète.</p><h3 id="r-les-images-15" data-claire-element-id="442203">Les images</h3><p id="r-442143" data-claire-element-id="442143">Cette fonction est vraiment très puissante, elle permet via ses neuf paramètres d'afficher une image sur le <code data-claire-semantic="html">&lt;canvas&gt;</code> à certaines coordonnées, en la rognant ou en la déformant si nécessaire.</p><p id="r-442144" data-claire-element-id="442144">Sa forme la plus basique ne comporte que trois paramètres : l'objet &quot;Image&quot; et les coordonnées x et y :</p><pre id="r-442145" data-claire-element-id="442145"><code data-claire-semantic="javascript">//On n'oublie pas de récupérer l'objet canvas et son context.

var mon_image = new Image();
mon_image.src = &quot;mon_image.png&quot;;
context.drawImage(mon_image, 0, 0);</code></pre><p id="r-442146" data-claire-element-id="442146">Sa forme la plus complexe prend, elle, neuf paramètres :</p><table id="r-442199" data-claire-element-id="442199"><thead id="r-442152" data-claire-element-id="442152"><tr id="r-442151" data-claire-element-id="442151"><th id="r-442148" data-claire-element-id="442148"><p id="r-442147" data-claire-element-id="442147">Paramètre :</p></th><th id="r-442150" data-claire-element-id="442150"><p id="r-442149" data-claire-element-id="442149">Description :</p></th></tr></thead><tbody id="r-442198" data-claire-element-id="442198"><tr id="r-442157" data-claire-element-id="442157"><td id="r-442154" data-claire-element-id="442154"><p id="r-442153" data-claire-element-id="442153">image</p></td><td id="r-442156" data-claire-element-id="442156"><p id="r-442155" data-claire-element-id="442155">On lui passe un objet &quot;Image&quot;.</p></td></tr><tr id="r-442162" data-claire-element-id="442162"><td id="r-442159" data-claire-element-id="442159"><p id="r-442158" data-claire-element-id="442158">xSource</p></td><td id="r-442161" data-claire-element-id="442161"><p id="r-442160" data-claire-element-id="442160">Position x dans le fichier, et à partir de laquelle on récupère l'image.</p></td></tr><tr id="r-442167" data-claire-element-id="442167"><td id="r-442164" data-claire-element-id="442164"><p id="r-442163" data-claire-element-id="442163">ySource</p></td><td id="r-442166" data-claire-element-id="442166"><p id="r-442165" data-claire-element-id="442165">Position y dans le fichier, et à partir de laquelle on récupère l'image</p></td></tr><tr id="r-442172" data-claire-element-id="442172"><td id="r-442169" data-claire-element-id="442169"><p id="r-442168" data-claire-element-id="442168">SourceWidth</p></td><td id="r-442171" data-claire-element-id="442171"><p id="r-442170" data-claire-element-id="442170">Largeur de l'image que l'on récupère dans le fichier</p></td></tr><tr id="r-442177" data-claire-element-id="442177"><td id="r-442174" data-claire-element-id="442174"><p id="r-442173" data-claire-element-id="442173">SourceHeight</p></td><td id="r-442176" data-claire-element-id="442176"><p id="r-442175" data-claire-element-id="442175">Hauteur de l'image que l'on récupère dans le fichier</p></td></tr><tr id="r-442182" data-claire-element-id="442182"><td id="r-442179" data-claire-element-id="442179"><p id="r-442178" data-claire-element-id="442178">posX</p></td><td id="r-442181" data-claire-element-id="442181"><p id="r-442180" data-claire-element-id="442180">Position x sur le canvas à partir de laquelle on va dessiner l'image.</p></td></tr><tr id="r-442187" data-claire-element-id="442187"><td id="r-442184" data-claire-element-id="442184"><p id="r-442183" data-claire-element-id="442183">posY</p></td><td id="r-442186" data-claire-element-id="442186"><p id="r-442185" data-claire-element-id="442185">Position y sur le canvas à partir de laquelle on va dessiner l'image.</p></td></tr><tr id="r-442192" data-claire-element-id="442192"><td id="r-442189" data-claire-element-id="442189"><p id="r-442188" data-claire-element-id="442188">Width</p></td><td id="r-442191" data-claire-element-id="442191"><p id="r-442190" data-claire-element-id="442190">Largeur de l'image dessinée sur le canvas.</p></td></tr><tr id="r-442197" data-claire-element-id="442197"><td id="r-442194" data-claire-element-id="442194"><p id="r-442193" data-claire-element-id="442193">Height</p></td><td id="r-442196" data-claire-element-id="442196"><p id="r-442195" data-claire-element-id="442195">Hauteur de l'image dessinée sur le canvas.</p></td></tr></tbody></table><pre id="r-442200" data-claire-element-id="442200"><code data-claire-semantic="javascript">//On n'oublie pas de récupérer l'objet canvas et son context.

var mon_image = new Image();
mon_image.src = &quot;mon_image.png&quot;;
context.drawImage(mon_image, 0, 0, 10, 10, 35, 60, 15, 15);</code></pre><p id="r-442201" data-claire-element-id="442201">Ici, on récupère dans &quot;<em>mon_image</em>&quot;, la portion de 10x10 pixels aux coordonnées [0, 0], et on la place sur le canvas aux coordonnées [35, 60] pour enfin l'agrandir à 15x15 pixels.</p><p id="r-442202" data-claire-element-id="442202">Si vous souhaitez en savoir plus sur la fonction drawImage, sachez que <a href="http://www.siteduzero.com/membres-294-130887.html">sebcap26</a> à publié un tutoriel sur la <a href="http://www.siteduzero.com/tutoriel-3-470482-creer-un-mini-rpg-en-javascript-avec-canvas.html">création d'un mini-rpg utilisant canvas</a> et la fonction drawImage de manière poussée.</p><h3 id="r-le-texte-9" data-claire-element-id="442208">Le texte</h3><p id="r-442204" data-claire-element-id="442204">Par chance, il existe une fonction permettant de dessiner du texte. Elle est vraiment très simple, elle ne prend que trois paramètres et l'on peut même choisir la police. N'est-ce pas merveilleux ? :lol:</p><pre id="r-442205" data-claire-element-id="442205"><code data-claire-semantic="javascript">//On n'oublie pas de récupérer l'objet canvas et son context.

context.font = &quot;18px Helvetica&quot;;//On passe à l'attribut &quot;font&quot; de l'objet context une simple chaîne de caractères composé de la taille de la police, puis de son nom.
context.fillText(&quot;Hello World&quot;, 0, 30);//strokeText(); fonctionne aussi, vous vous en doutez.</code></pre><aside id="r-442207" data-claire-element-id="442207" data-claire-semantic="warning"><p id="r-442206" data-claire-element-id="442206">Notez que j'ai effectué un retrait de 30 pixels sur l'axe des ordonnées, cela est dû au fait que la méthode <code data-claire-semantic="javascript">fillText();</code> trace la chaîne de caractères en partant de son coin inférieur droit. Ainsi, la chaîne se retrouve en dehors du canvas, d'où le retrait.</p></aside><h3 id="r-les-couleurs-13" data-claire-element-id="442222">Les couleurs</h3><p id="r-442209" data-claire-element-id="442209">J'aurais peut-être dû vous en parler avant, mais j'ai pensé qu'étant une notion simple et plus «divertissante» que toutes ces fonctions compliquées, il serait plus agréable de la voir à la fin. Donc oui, vous n'êtes pas obligés de créer vos formes en noir &amp; blanc, il existe un attribut de l'objet <em>context</em> que l'on peut modifier afin de changer les couleurs. Le voici :</p><pre id="r-442210" data-claire-element-id="442210"><code data-claire-semantic="javascript">context.fillStyle = &quot;#ff0000&quot;; //Toutes les prochaines formes pleines seront rouges.
context.strokeStyle = &quot;rgba(0, 0, 255, 0.5)&quot;; //Toutes les prochaines formes &quot;stroke&quot; seront bleues et semi-transparentes.</code></pre><aside id="r-442221" data-claire-element-id="442221" data-claire-semantic="information"><p id="r-442211" data-claire-element-id="442211">On peut assigner à <code data-claire-semantic="javascript">context.fillStyle</code> &amp; à <code data-claire-semantic="javascript">context.strokeStyle</code> les valeurs suivantes :</p><ul id="r-442220" data-claire-element-id="442220"><li id="r-442213" data-claire-element-id="442213"><p id="r-442212" data-claire-element-id="442212">Code couleur hexadécimal</p></li><li id="r-442215" data-claire-element-id="442215"><p id="r-442214" data-claire-element-id="442214">Une valeur rgb()</p></li><li id="r-442217" data-claire-element-id="442217"><p id="r-442216" data-claire-element-id="442216">Une valeur rgba()</p></li><li id="r-442219" data-claire-element-id="442219"><p id="r-442218" data-claire-element-id="442218">Le nom de la couleur en anglais</p></li></ul></aside><h3 id="r-les-degrades-4" data-claire-element-id="442237">Les dégradés</h3><p id="r-442223" data-claire-element-id="442223">Vous en voulez encore n'est-ce pas ? Vous voulez pouvoir faire des graphiques qui en jettent ? Et bien en plus de superbes couleurs, vous pouvez créer de superbes dégradés, ils fonctionnent exactement comme les couleurs, on les passe par l'attribut <code data-claire-semantic="javascript">context.fillStyle</code>.</p><pre id="r-442224" data-claire-element-id="442224"><code data-claire-semantic="javascript">//On n'oublie pas de récupérer le canvas et son context.

var degrade = context.createLinearGradient(0,0,300,100);//Délimitation du début et de la fin du dégradé.
    degrade.addColorStop(0,&quot;#FFFFFF&quot;);//Ajout d'une première couleur.
    degrade.addColorStop(1,&quot;#000000&quot;);//Ajout de la seconde couleur.

context.fillStyle = degrade;//On passe notre dégradé au fillStyle();
context.fillRect(0,0,300,300);//On trace un rectangle plein qui aura pour style le dégradé.</code></pre><p id="r-442225" data-claire-element-id="442225">Dans cet exemple, nous traçons sur un canvas de 300x300 pixels :</p><ul id="r-442234" data-claire-element-id="442234"><li id="r-442228" data-claire-element-id="442229"><img id="r-442229" data-claire-element-id="442228" src="medias/uploads.siteduzero.com_files_334001_335000_334725.png" alt="Schéma explicatif sur le fonctionnement des dégradés"/><img id="r-442226" data-claire-element-id="442226" src="medias/uploads.siteduzero.com_files_334001_335000_334725.png" alt="Schéma explicatif sur le fonctionnement des dégradés"/><p id="r-442227" data-claire-element-id="442227">Ligne 3 : <code data-claire-semantic="javascript">var degrade = context.createLinearGradient(0,0,300,100);</code> nous définissons les limites du dégradé.</p></li><li id="r-442232" data-claire-element-id="442233"><img id="r-442233" data-claire-element-id="442232" src="medias/uploads.siteduzero.com_files_334001_335000_334726.png" alt="Exemple de dégradé"/><img id="r-442230" data-claire-element-id="442230" src="medias/uploads.siteduzero.com_files_334001_335000_334726.png" alt="Exemple de dégradé"/><p id="r-442231" data-claire-element-id="442231">Ligne 4 à 8 : Ensuite, nous y ajoutons deux couleurs. Et nous l'appliquons au fillStyle, et enfin créons le rectangle porteur du dégradé.</p></li></ul><aside id="r-442236" data-claire-element-id="442236" data-claire-semantic="warning"><p id="r-442235" data-claire-element-id="442235">Dans la fonction <code data-claire-semantic="javascript">addColorStop(offset, couleur);</code>, l'ordre des <em>offset</em> est important dans l'ordre des couleurs. En revanche, l'ordre des instructions, lui, n'est pas déterminant.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript">La balise &lt;canvas&gt; avec JavaScript</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
Mise en place du code minimal
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
Commençons à dessiner !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
Les bases de l&#039;animation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/tp-creation-d-une-balle-rebondissant-sur-les-bords-du-canvas">
TP: Création d&#039;une balle rebondissant sur les bords du canvas
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
<span class="arrow"></span>
<span class="next">Mise en place du code minimal</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
<span class="next">Les bases de l&#039;animation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesbasesdel039animation"></a><h2>Les bases de l&#039;animation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
<span class="arrow"></span>
<span class="next">Commençons à dessiner !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/tp-creation-d-une-balle-rebondissant-sur-les-bords-du-canvas">
<span class="next">TP: Création d&#039;une balle rebondissant sur les bords du canvas</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-442240" data-claire-element-id="442240">Dans tous les jeux vidéo dans lesquels vous pouvez distinguer un mouvement, ce que vous voyez est en réalité une suite d'image dessinée très rapidement et qui vous donne une impression de fluidité. Les plus malins d’entre vous ont peut-être déjà une petite idée de ce que je veux dire. Non ? Tant pis, je vais vous expliquer. ;)</p><p id="r-442241" data-claire-element-id="442241">Nous allons devoir mettre en place ce que l'on appelle une <em>boucle de rafraîchissement</em> qui appellera une fonction de dessin qui s'occupera, en fonction des valeurs qu'on lui renvoie, de tracer l'image dans le <em>canvas</em>.</p><h3 id="r-code-minimal-2" data-claire-element-id="442249">Code minimal</h3><pre id="r-442242" data-claire-element-id="442242"><code data-claire-semantic="javascript">window.onload = function()
{
    var canvas = document.getElementById('mon_canvas');
        if(!canvas)
        {
            alert(&quot;Impossible de récupérer le canvas&quot;);
            return;
        }

    var context = canvas.getContext('2d');
        if(!context)
        {
            alert(&quot;Impossible de récupérer le context du canvas&quot;);
            return;
        }

    var myInterval = setInterval(animate, 1000/30);

    function animate()
    {
        //C'est ici que toutes les manipulations sur le canvas se feront.
    } 
}</code></pre><div id="r-442244" data-claire-element-id="442244" data-claire-semantic="question"><p id="r-442243" data-claire-element-id="442243">Mais que se passe-t-il à la ligne 17 ?</p></div><p id="r-442245" data-claire-element-id="442245">Ce simple <code data-claire-semantic="javascript">myInterval = setInterval(animate, 1000/30);</code> appelle la fonction <code data-claire-semantic="javascript">animate()</code> trente fois par seconde. C'est la fréquence approximative à partir de laquelle l'œil humain discerne un mouvement parfaitement fluide.</p><p id="r-442246" data-claire-element-id="442246">Nous allons donc devoir placer nos fonctions de dessin à l'intérieur de cette fonction <em>animate()</em>. Nous allons faire un exemple simple, celui d'un rectangle s'agrandissant jusqu'à faire la taille de notre <em>canvas</em> puis rétrécissant, et ainsi de suite.</p><pre id="r-442247" data-claire-element-id="442247"><code data-claire-semantic="javascript">window.onload = function()
{
    //On n'oublie pas de récupérer le canvas et son context.

    canvas.width = 300;
    canvas.height = 300;

    var myInterval = setInterval(animate, 1000/30); //Notre boucle de rafraîchissement.

    //On défini quelques variables
    var tailleMini = 10;
    var tailleMax = canvas.width;//Tant que notre canvas reste carré, l'agrandissement peut-être égal à un des côtés.
    var tailleActuelle = tailleMini+1;//On initialise la taille actuelle au minimum de ce à quoi elle peut correspondre, puis on y additionne 1 afin de ne pas boucler indéfiniment sur les phases d'agrandissement, rétrécissement.
    var xPos = 0;
    var yPos = 0;
    var vitesse = 1;//La valeur 1 signifie que l'on augmentera la taille du carré, tandis que -1 correspondra à une réduction.

    function animate()
    {
	context.clearRect(0, 0, canvas.width, canvas.height);//Cette fonction permet de réinitialiser notre canvas. Plus rien n'y est affiché.
		
        //On commence par calculer la position à laquelle on doit placer le carré, pour qu'il reste bien au centre du canvas.
        xPos = (canvas.width/2)-(tailleActuelle/2);
        yPos = xPos;//Notre canvas étant un carré, pas besoin de recalculer le milieu de l'ordonnée : c'est le même que l'abscisse.
        
        //On a tout ce qu'il nous faut pour tracer notre carré :
        context.fillRect(xPos, yPos, tailleActuelle, tailleActuelle);

        //On fait les tests pour savoir si l'on va devoir agrandir ou rétrécir notre carré.
        if(tailleActuelle &gt;= tailleMax || tailleActuelle &lt;= tailleMini)
        {
            vitesse *= -1;
        }

        //On applique la vitesse calculée à la taille actuelle pour la modifier.
        tailleActuelle += vitesse;
    } 
}</code></pre><p id="r-442248" data-claire-element-id="442248">Le procédé employé ici est très simple :<br/> A chaque rafraîchissement, on vérifie si on a atteint la taille maximal/minimal, si c'est le cas, on inverse la vitesse, ce qui a pour effet d'inverser le mouvement. Puis, on additionne la vitesse avec la taille actuelle, si elle est négative, dans ce cas le carré rétréci, si elle est positive, il s'agrandit.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript">La balise &lt;canvas&gt; avec JavaScript</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
Mise en place du code minimal
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
Commençons à dessiner !
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
Les bases de l&#039;animation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/tp-creation-d-une-balle-rebondissant-sur-les-bords-du-canvas">
TP: Création d&#039;une balle rebondissant sur les bords du canvas
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
<span class="arrow"></span>
<span class="next">Commençons à dessiner !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/tp-creation-d-une-balle-rebondissant-sur-les-bords-du-canvas">
<span class="next">TP: Création d&#039;une balle rebondissant sur les bords du canvas</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="TPCrationd039uneballerebondissantsurlesbordsducanvas"></a><h2>TP: Création d&#039;une balle rebondissant sur les bords du canvas</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
<span class="arrow"></span>
<span class="next">Les bases de l&#039;animation</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h3 id="r-avant-de-commencer-20" data-claire-element-id="442275">Avant de commencer</h3><p id="r-442251" data-claire-element-id="442251">C'est la dernière partie de ce tutoriel, et je pense que terminer avec un T.P sera bien plus enrichissant pour vous qu'un autre chapitre de théorie.<br/> Ce que nous allons devoir faire ici, c'est créer une balle qui rebondira sur les rebords du canvas, un peu à la manière des économiseurs d'écran Windows.<br/> Voilà un schéma, au cas où vous ne comprendriez pas de quoi je parle, vous expliquant le résultat attendu.</p><figure id="r-schema-sur-le-tp-a-realiser" data-claire-element-id="442254"><img id="r-442252" data-claire-element-id="442252" src="medias/uploads.siteduzero.com_files_334001_335000_334730.png" alt="Schéma sur le TP à réaliser"/><figcaption>Schéma sur le TP à réaliser</figcaption></figure><div id="r-442256" data-claire-element-id="442256" data-claire-semantic="question"><p id="r-442255" data-claire-element-id="442255">Que devrez-vous mettre en place ?</p></div><ul id="r-442265" data-claire-element-id="442265"><li id="r-442258" data-claire-element-id="442258"><p id="r-442257" data-claire-element-id="442257">Un canvas non carré (pour que la balle ne suive pas toujours la même trajectoire).</p></li><li id="r-442260" data-claire-element-id="442260"><p id="r-442259" data-claire-element-id="442259">Une belle balle créée grâce à la fonction <em>arc</em>.</p></li><li id="r-442262" data-claire-element-id="442262"><p id="r-442261" data-claire-element-id="442261">La boucle de rafraîchissement permettant le mouvement de la balle.</p></li><li id="r-442264" data-claire-element-id="442264"><p id="r-442263" data-claire-element-id="442263">Un système de condition gérant les rebonds en cas de collisions avec un des rebords. (2 conditions suffisent, si vous êtes malins, et je n'en doute pas ;) ).</p></li></ul><div id="r-442267" data-claire-element-id="442267" data-claire-semantic="question"><p id="r-442266" data-claire-element-id="442266">A quoi devrez-vous faire attention ?</p></div><ul id="r-442272" data-claire-element-id="442272"><li id="r-442269" data-claire-element-id="442269"><p id="r-442268" data-claire-element-id="442268">Vous devrez faire attention à ce que la balle ne dépasse jamais les bords du canvas. A vous de faire les calculs nécessaires pour que les bonnes coordonnées soient prises en compte en fonction du bord touché par la balle.</p></li><li id="r-442271" data-claire-element-id="442271"><p id="r-442270" data-claire-element-id="442270">Ne pas oublier de réinitialiser le canvas via <em>clearRect()</em>.</p></li></ul><p id="r-442273" data-claire-element-id="442273">Encore une petite chose : L'important n'est pas que vous réussissiez l'exercice, même si cela prouverait que vous avez bien tout suivi. L'important est que vous cherchiez par vous même les solutions à chacune des problématiques. Il ne vous serai donc d'aucun intérêt d'aller voir la correction de suite.</p><p id="r-442274" data-claire-element-id="442274">Bon courage ! ;)</p><h3 id="r-correction-146" data-claire-element-id="442285">Correction</h3><p id="r-442276" data-claire-element-id="442276">Pour ceux qui n'auraient pas réussi, ou pour ceux qui cherchent à améliorer leur code, voici la correction :<br/> Par souci de gain de place, j'ai condensé tout le code en un seul fichier, mais le fonctionnement est le même.</p><pre id="r-442277" data-claire-element-id="442277"><code data-claire-semantic="html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;body&gt;

&lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;300&quot; style=&quot;border:1px solid black;&quot;&gt;
    Votre navigateur ne supporte pas canvas.
&lt;/canvas&gt;


&lt;script type=&quot;text/javascript&quot;&gt;
window.onload = function()
{
    var canvas = document.getElementById(&quot;myCanvas&quot;);
    if(!canvas)
    {
        alert(&quot;Impossible de récupérer le canvas&quot;);
        return;
    }
    
    var context = canvas.getContext(&quot;2d&quot;);
    if(!context)
    {
        alert(&quot;Impossible de récupérer le context&quot;);
        return;
    }
        
    var diametreBalle = 20;
    
    var posX = 1+diametreBalle/2;
    var posY = 1+diametreBalle/2;
    var vitesseX = 3;
    var vitesseY = 3;
    
    var myInterval = setInterval(animate, 1000/30);
    
    function animate()
    {
        context.clearRect(0, 0, canvas.width, canvas.height);
        
        //Tracé de la balle
        context.beginPath();
        context.arc(posX, posY, diametreBalle/2, 0, Math.PI*2);
        context.fill();
        
        //On va vérifier si la balle à toucher l'un des bords du canvas.
        if(posX+diametreBalle/2 &gt;= canvas.width || posX &lt;= 0+diametreBalle/2)//Si on touche le bord gauche ou droit
        {
            vitesseX *= -1;//On inverse la vitesse de déplacement sur l'axe horizontal.
        }

        if(posY+diametreBalle/2 &gt;= canvas.height || posY &lt;= 0+diametreBalle/2)//Si on touche le bord du bas ou du haut
        {
            vitesseY *= -1;//On inverse la vitesse de déplacement sur l'axe vertical.
        }
        
        //On additionne les vitesses de déplacement avec les positions
        posX += vitesseX;
        posY += vitesseY;
    }
    
}

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-442278" data-claire-element-id="442278"><strong><a href="http://geeklaboratories.com/tp-la-balise-canvas-avec-javascript">Voir l'animation</a></strong></p><p id="r-442279" data-claire-element-id="442279"><code data-claire-semantic="javascript">var posX = 1+diametreBalle/2;</code> et <code data-claire-semantic="javascript">var posY = 1+diametreBalle/2;</code> : On initialise les variables de position à leurs valeurs minimales, à savoir le coin supérieur droit. Etant donné que les coordonnées de la balle sont définies par son centre, on additionne son rayon pour que quand la balle soit en [0, 0], elle soit encore dans l'écran. De plus, j'ajoute 1 pour qu'elle ne reste pas coincée sur les rebords.</p><p id="r-442280" data-claire-element-id="442280"><code data-claire-semantic="javascript">if(posX+diametreBalle/2 &gt;= canvas.width || posX &lt;= 0+diametreBalle/2){ ... }</code> : En fait ici, on dit que lorsque le côté droit de la balle touchera le coin (ou dépassera), ou lorsque le côté gauche touchera le côté gauche, on inversera la vitesse horizontale.</p><p id="r-442281" data-claire-element-id="442281"><code data-claire-semantic="javascript">vitesseX *= -1;</code> : C'est la manière la plus simple d'inverser un nombre, qu'il soit négatif ou positif, cela marchera à tous les coups.<br/> (<em>2x-1 = -2</em> et <em>-2x-1 = 2</em>)</p><p id="r-442282" data-claire-element-id="442282"><code data-claire-semantic="javascript">posX += vitesseX;</code> : Ici, on additionne la vitesse de déplacement horizontale avec la position horizontale. Ainsi, si elle est positive, on avancera, tandis que si elle est négative, on reculera.</p><p id="r-442283" data-claire-element-id="442283">Avouez que ce n'était pas si compliqué ? ;)</p><p id="r-442284" data-claire-element-id="442284">Avec tout ce que l'on a vu, je pense que vous devez être largement capable de créer, seul, de très belles choses.<br/> Bon courage. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript">La balise &lt;canvas&gt; avec JavaScript</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/mise-en-place-du-code-minimal">
Mise en place du code minimal
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/commencons-a-dessiner">
Commençons à dessiner !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
Les bases de l&#039;animation
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/tp-creation-d-une-balle-rebondissant-sur-les-bords-du-canvas">
TP: Création d&#039;une balle rebondissant sur les bords du canvas
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/la-balise-canvas-avec-javascript/les-bases-de-l-animation">
<span class="arrow"></span>
<span class="next">Les bases de l&#039;animation</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/la-balise-canvas-avec-javascript.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:53:00 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/la-balise-canvas-avec-javascript.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:45 GMT -->
</html>