<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/un-peu-de-physique-en-actionscript-3.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:52:07 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/un-peu-de-physique-en-actionscript-3.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:12:53 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Un peu de physique en ActionScript 3</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/un-peu-de-physique-en-actionscript-3.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Un peu de physique en ActionScript 3</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#UnpeudephysiqueenActionScript3">Un peu de physique en ActionScript 3</a><br/><a href="#Posonsnosbases">Posons nos bases</a><br/><a href="#Quelagravitsoitetlagravitfut">Que la gravité soit, et la gravité fut !</a><br/><a href="#Faites-moidoncbougertouta">Faites-moi donc bouger tout ça !</a><br/></div>
<a name="UnpeudephysiqueenActionScript3"></a><h2>Un peu de physique en ActionScript 3</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/posons-nos-bases">
<span class="next">Posons nos bases</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-589334" data-claire-element-id="589334">Bonjour !</p><p id="r-589335" data-claire-element-id="589335">Nous allons, dans le cadre de ce tutoriel, découvrir comment appliquer quelques lois de la physique dans nos applications flash. Nous n'allons bien entendu pas voir comment retranscrire en ActionScript toutes les règles de notre univers, ce serait trop fatiguant (et surtout humainement impossible).</p>
</div><a name="Posonsnosbases"></a><h2>Posons nos bases</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
<span class="next">Que la gravité soit, et la gravité fut !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-589338" data-claire-element-id="589338">Commençons tout d'abord par dessiner une balle grâce à l'outil « Ovale » (raccourci touche <kbd>O</kbd>).<br/> Cette dernière aura une taille de cinquante pixels de largeur sur cinquante pixels de hauteur.</p><p id="r-589339" data-claire-element-id="589339">Nous allons à présent réaliser un clip. Pour cela, faites un clic droit sur le dessin obtenu, puis sélectionnez « Convertir en symbole ». Pour faire original, nous allons nommer le clip « Balle ».</p><aside id="r-589341" data-claire-element-id="589341" data-claire-semantic="warning"><p id="r-589340" data-claire-element-id="589340">Veillez à ce que le type de symbole soit bien « clip ».</p></aside><p id="r-589342" data-claire-element-id="589342">Pour ce qui est de l'alignement, cochez le carré du milieu pour placer l'objet au centre du clip.</p><figure id="r-589344" data-claire-element-id="589345"><img id="r-589343" data-claire-element-id="589343" src="medias/uploads.siteduzero.com_files_319001_320000_319849.gif" alt="Image utilisateur"/></figure><p id="r-589346" data-claire-element-id="589346"><em>Création d'un clip pour notre balle.</em></p><p id="r-589347" data-claire-element-id="589347">Cela étant fait, nous nous retrouvons avec un <strong>MovieClip</strong> sur la scène, représentant notre balle. Il ne nous reste plus que la partie la plus importante : le code permettant à notre balle de subir la gravité.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3">Un peu de physique en ActionScript 3</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/posons-nos-bases">
Posons nos bases
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
Que la gravité soit, et la gravité fut !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/faites-moi-donc-bouger-tout-ca">
Faites-moi donc bouger tout ça !
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
<span class="next">Que la gravité soit, et la gravité fut !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Quelagravitsoitetlagravitfut"></a><h2>Que la gravité soit, et la gravité fut !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/posons-nos-bases">
<span class="arrow"></span>
<span class="next">Posons nos bases</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/faites-moi-donc-bouger-tout-ca">
<span class="next">Faites-moi donc bouger tout ça !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<aside id="r-589350" data-claire-element-id="589350" data-claire-semantic="warning"><p id="r-589349" data-claire-element-id="589349">Bien que l'ActionScript 3 soit un langage plutôt orienté objet, nous allons réaliser tout cela en procédural, étant donné que le but de ce tutoriel n'est pas de vous former à la POO.</p></aside><p id="r-589351" data-claire-element-id="589351">Tout d'abord, nous allons donner un nom d'occurrence à notre balle pour pouvoir la manipuler depuis notre code. Cliquez sur le clip de la balle et positionnez-vous au niveau de l'onglet « Propriétés ». Dans le champ nommé <strong>&lt;Nom de l’occurrence&gt;</strong>, saisissez « Balle ».</p><figure id="r-589353" data-claire-element-id="589354"><img id="r-589352" data-claire-element-id="589352" src="medias/uploads.siteduzero.com_files_319001_320000_319855.gif" alt="Image utilisateur"/></figure><p id="r-589355" data-claire-element-id="589355"><em>Paramètres de l'objet <strong>Balle</strong>.</em></p><p id="r-589356" data-claire-element-id="589356">Cela étant fait, nous allons, par le biais du code, positionner notre balle au centre de la scène.</p><p id="r-589357" data-claire-element-id="589357">Pour taper votre code, rendez-vous dans le panneau « Actions ». Si ce dernier n'est pas ouvert, rendez-vous dans le menu « Fenêtre » puis cliquez sur « Actions » (ou pressez tout simplement la touche F9).</p><p id="r-589358" data-claire-element-id="589358">Nous y voilà, centrons notre balle.</p><pre id="r-589359" data-claire-element-id="589359"><code data-claire-semantic="actionscript">Balle.x = stage.stageWidth/2;
Balle.y = stage.stageHeight/2;</code></pre><h3 id="r-explications-52" data-claire-element-id="589390">Explications</h3><ul id="r-589370" data-claire-element-id="589370"><li id="r-589361" data-claire-element-id="589361"><p id="r-589360" data-claire-element-id="589360">Nous manipulons notre objet grâce à l'occurrence que nous lui avons donnée (<strong>Balle</strong>).</p></li><li id="r-589363" data-claire-element-id="589363"><p id="r-589362" data-claire-element-id="589362">Nous modifions ses propriétés <em>x</em> et <em>y</em>, qui représentent sa position sur la scène. La scène démarre à x=0 et y=0 (soit en haut à gauche).</p></li><li id="r-589365" data-claire-element-id="589365"><p id="r-589364" data-claire-element-id="589364">Nous accédons aux informations de la scène grâce à la variable <strong>stage</strong>. Pour ce cas-là, nous lisons la propriété <strong>stageWidth</strong> de la scène qui signifie « largeur de la scène ».</p></li><li id="r-589367" data-claire-element-id="589367"><p id="r-589366" data-claire-element-id="589366">Nous divisons la largeur par deux et l'attribuons à la coordonnée <em>x</em> de notre balle pour placer cette dernière au milieu de la largeur de la scène.</p></li><li id="r-589369" data-claire-element-id="589369"><p id="r-589368" data-claire-element-id="589368">Nous faisons la même chose pour la hauteur (<strong>height</strong>).</p></li></ul><p id="r-589371" data-claire-element-id="589371">Nous allons maintenant déclarer quelques variables qui nous sont indispensables pour gérer les forces.</p><pre id="r-589372" data-claire-element-id="589372"><code data-claire-semantic="actionscript">var friction:Number = 0.98;
var gravite:Number = 0.5;
var vitesseX:Number = 0;
var vitesseY:Number = 0;
var accelerationX:Number = 0;
var accelerationY:Number = 0;</code></pre><p id="r-589373" data-claire-element-id="589373">Détaillons à présent leur utilité.</p><ul id="r-589386" data-claire-element-id="589386"><li id="r-589375" data-claire-element-id="589375"><p id="r-589374" data-claire-element-id="589374">Friction : la friction est le frottement de la balle dans l'air ; sa valeur par défaut est de 0.98 (elle peut osciller entre 0 et 1).</p></li><li id="r-589377" data-claire-element-id="589377"><p id="r-589376" data-claire-element-id="589376">Gravité : c'est le coefficient de la gravité, la force qui s'exercera sur l'objet ; sa valeur par défaut est de 0.5. Plus la valeur est grande, plus la force qui attirera la balle vers le bas sera forte, et au contraire, plus elle est faible, moins cette dernière se fera sentir. Si elle est négative, la force sera exercée vers le haut.</p></li><li id="r-589379" data-claire-element-id="589379"><p id="r-589378" data-claire-element-id="589378">Vitesse <em>x</em> : c'est la valeur de la vitesse sur l'axe des <em>x</em> (abscisses) de la balle. Elle est de 0 par défaut.</p></li><li id="r-589381" data-claire-element-id="589381"><p id="r-589380" data-claire-element-id="589380">Vitesse <em>y</em> : c'est la valeur de la vitesse sur l'axe des <em>y</em> (ordonnées) de la balle. Elle vaut également 0 par défaut.</p></li><li id="r-589383" data-claire-element-id="589383"><p id="r-589382" data-claire-element-id="589382">Accélération <em>x</em> : c'est l'accélération exercée sur la balle sur l'axe des <em>x</em> ; plus la balle tombe de haut, plus cette variable sera incrémentée, et plus elle tombera vite.</p></li><li id="r-589385" data-claire-element-id="589385"><p id="r-589384" data-claire-element-id="589384">Accélération <em>y</em> : c'est l'accélération exercée sur la balle sur l'axe des <em>y</em> ; <em>idem</em>.</p></li></ul><p id="r-589387" data-claire-element-id="589387">Nous allons maintenant placer un écouteur sur notre animation qui sera attentif à l'événement ENTER_FRAME.<br/> (Notre application étant une animation, un certain nombre d'images défilent par seconde ; c'est parfait pour ce que l'on veut faire car cette fonction sera appelée plusieurs fois par seconde).</p><pre id="r-589388" data-claire-element-id="589388"><code data-claire-semantic="actionscript">addEventListener(Event.ENTER_FRAME, moteurGravite);</code></pre><p id="r-589389" data-claire-element-id="589389">À chaque fois que cet événement sera diffusé, la fonction <strong>moteurGravite</strong> sera appelée. :)</p><h3 id="r-notre-fonction-moteurgravite" data-claire-element-id="589416">Notre fonction <strong>moteurGravite</strong></h3><pre id="r-589391" data-claire-element-id="589391"><code data-claire-semantic="actionscript">function moteurGravite(e:Event){
	
}</code></pre><p id="r-589392" data-claire-element-id="589392">Bon, d'accord, elle est actuellement vide et ne fait rien. Voyons voir ce que nous devons faire pour arriver à un résultat probant.</p><p id="r-589393" data-claire-element-id="589393">Nous allons commencer par l'attirance vers le bas (sur l'axe des <em>y</em>, donc). Pour cela, il nous faut incrémenter la variable <strong>vitesseY</strong>. On va commencer par lui imposer la gravité.</p><pre id="r-589394" data-claire-element-id="589394"><code data-claire-semantic="actionscript">vitesseY += gravite;</code></pre><p id="r-589395" data-claire-element-id="589395">Puis nous allons ajouter à cela l'accélération sur l'axe des <em>y</em>.</p><pre id="r-589396" data-claire-element-id="589396"><code data-claire-semantic="actionscript">vitesseY += accelerationY;</code></pre><p id="r-589397" data-claire-element-id="589397">Nous faisons pareil pour l'accélération sur l'axe des <em>x</em> (pour la vitesse <em>x</em>).</p><pre id="r-589398" data-claire-element-id="589398"><code data-claire-semantic="actionscript">vitesseX += accelerationX;</code></pre><p id="r-589399" data-claire-element-id="589399">À présent, il faut prendre en compte la friction (le frottement de la balle dans l'air, qui ralentit cette dernière), nous allons donc multiplier chacune des vitesses par la friction.</p><pre id="r-589400" data-claire-element-id="589400"><code data-claire-semantic="actionscript">vitesseY *= friction;
vitesseX *= friction;</code></pre><p id="r-589401" data-claire-element-id="589401">On applique maintenant ces vitesses sur notre balle de la manière suivante.</p><pre id="r-589402" data-claire-element-id="589402"><code data-claire-semantic="actionscript">Balle.x += vitesseX;
Balle.y += vitesseY;</code></pre><p id="r-589403" data-claire-element-id="589403">Voici donc le code complet de notre fonction.</p><pre id="r-589404" data-claire-element-id="589404"><code data-claire-semantic="actionscript">function moteurGravite(e:Event){
	vitesseY += gravite;
	vitesseY += accelerationY;
	vitesseX += accelerationX;
	
	vitesseY *= friction;
	vitesseX *= friction;
	
	Balle.x += vitesseX;
	Balle.y += vitesseY;
}</code></pre><div id="r-589406" data-claire-element-id="589406" data-claire-semantic="question"><p id="r-589405" data-claire-element-id="589405">Minute, papillon ! Tu te fiches de moi ? La balle tombe dans le vide puis je ne la vois plus !</p></div><p id="r-589407" data-claire-element-id="589407">Hé, doucement ! :D Nous allons corriger ce problème en faisant en sorte que la balle ne puisse pas quitter la scène. Pour cela, nous devons modifier notre fonction <strong>moteurGravite</strong> et tester si la balle va sortir de notre champ de vision, et si c'est le cas, la faire rebondir.</p><p id="r-589408" data-claire-element-id="589408">Pour empêcher la balle de tomber, il faut tester si la position en <em>y</em> de la balle plus sa taille divisée par deux (divisée par deux parce que ses coordonnées sont placées au milieu de la balle, souvenez-vous, nous les avons définies à la création de la balle) est supérieure à la hauteur totale de la scène. Si c'est le cas, on replace la balle à la limite de la scène et on lui donne une petite impulsion pour la faire rebondir.</p><pre id="r-589409" data-claire-element-id="589409"><code data-claire-semantic="actionscript">if(Balle.y + Balle.height/2 &gt; stage.stageHeight){
	Balle.y = stage.stageHeight - Balle.height/2;
	vitesseY *= -1;
}</code></pre><p id="r-589410" data-claire-element-id="589410">Pour ne pas qu'elle dépasse en hauteur, il suffit de faire l'inverse.</p><pre id="r-589411" data-claire-element-id="589411"><code data-claire-semantic="actionscript">if(Balle.y - Balle.height/2 &lt;0){
	Balle.y = Balle.height/2;
	vitesseY *= -1;
}</code></pre><p id="r-589412" data-claire-element-id="589412">Et la démarche pour ne pas dépasser des côtés est sensiblement la même.</p><pre id="r-589413" data-claire-element-id="589413"><code data-claire-semantic="actionscript">if(Balle.x + Balle.width/2 &gt; stage.stageWidth){
	Balle.x = stage.stageWidth - Balle.width/2;
	vitesseX *= -1;
}
if(Balle.x - Balle.width/2 &lt;0){
	Balle.x = Balle.width/2;
	vitesseX *= -1;
}</code></pre><p id="r-589414" data-claire-element-id="589414">Voilà, tout est en ordre, et tout marche correctement.<br/> Voici le code complet.</p><pre id="r-589415" data-claire-element-id="589415"><code data-claire-semantic="actionscript">//Positionnement de notre balle au centre de la scène
Balle.x = stage.stageWidth/2;
Balle.y = stage.stageHeight/2;

//Variables nécessaires à l'application de la gravité
var friction:Number = 0.98;
var gravite:Number = 0.5;
var vitesseX:Number = 0;
var vitesseY:Number = 0;
var accelerationX:Number = 0;
var accelerationY:Number = 0;

//Écoute de l'événement ENTER_FRAME
addEventListener (Event.ENTER_FRAME, moteurGravite);

function moteurGravite(e:Event){
	vitesseY += gravite;
	vitesseY += accelerationY;
	vitesseX += accelerationX;
	
	vitesseY *= friction;
	vitesseX *= friction;
	
	Balle.x += vitesseX;
	Balle.y += vitesseY;
	
	if(Balle.y + Balle.height/2 &gt; stage.stageHeight){
		Balle.y = stage.stageHeight - Balle.height/2;
		vitesseY *= -1;
	}
	if(Balle.y + Balle.height/2 &lt;0){
		Balle.y = Balle.height/2;
		vitesseY *= -1;
	}
	
	if(Balle.x + Balle.width/2 &gt; stage.stageWidth){
		Balle.x = stage.stageWidth - Balle.width/2;
		vitesseX *= -1;
	}
	if(Balle.x + Balle.width/2 &lt;0){
		Balle.x = Balle.width/2;
		vitesseX *= -1;
	}
}</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3">Un peu de physique en ActionScript 3</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/posons-nos-bases">
Posons nos bases
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
Que la gravité soit, et la gravité fut !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/faites-moi-donc-bouger-tout-ca">
Faites-moi donc bouger tout ça !
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/posons-nos-bases">
<span class="arrow"></span>
<span class="next">Posons nos bases</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/faites-moi-donc-bouger-tout-ca">
<span class="next">Faites-moi donc bouger tout ça !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Faites-moidoncbougertouta"></a><h2>Faites-moi donc bouger tout ça !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
<span class="arrow"></span>
<span class="next">Que la gravité soit, et la gravité fut !</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-589418" data-claire-element-id="589418">Nous avons réussi à faire comprendre à notre balle les lois de la pesanteur ! (Si c'est pas beau tout ça. :p ) Seul problème, c'est un peu trop statique à mon goût. C'est vrai quoi, on lance l'animation, on voit une balle tomber, rebondir, puis s'immobiliser… Pas très attrayant, vous ne trouvez pas ?</p><p id="r-589419" data-claire-element-id="589419">Nous allons donc ajouter une autre dimension à notre projet : pouvoir interagir avec la balle à l'aide du clavier (la faire bouger avec les touches directionnelles, si vous préférez).</p><p id="r-589420" data-claire-element-id="589420">Pour cela, rien de plus simple : nous allons écouter les événements en provenance du clavier, qui sont la pression et le relâchement d'une touche.</p><pre id="r-589421" data-claire-element-id="589421"><code data-claire-semantic="actionscript">stage.addEventListener(KeyboardEvent.KEY_DOWN, gestionTouches);
stage.addEventListener(KeyboardEvent.KEY_UP, gestionTouches);</code></pre><aside id="r-589423" data-claire-element-id="589423" data-claire-semantic="information"><p id="r-589422" data-claire-element-id="589422">Nous allons gérer les pressions et relâchements dans la même fonction pour plus de clarté.</p></aside><p id="r-589424" data-claire-element-id="589424">Cela étant fait, créons la fonction.</p><pre id="r-589425" data-claire-element-id="589425"><code data-claire-semantic="actionscript">function gestionTouches(e:KeyboardEvent){
	
}</code></pre><p id="r-589426" data-claire-element-id="589426">Nous devons maintenant déterminer quelles touches sont pressées ou relâchées parmi haut, gauche, bas et droite. Pour savoir quelle touche est concernée, je propose d'utiliser un <strong>switch</strong>.</p><pre id="r-589427" data-claire-element-id="589427"><code data-claire-semantic="actionscript">switch(e.keyCode){
	case Keyboard.UP:
		
	break;
	case Keyboard.DOWN:
		
	break;
	case Keyboard.LEFT:
		
	break;
	case Keyboard.RIGHT:
		
	break;
}</code></pre><p id="r-589428" data-claire-element-id="589428">Nous allons assigner un comportement à chacun de ces cas.</p><pre id="r-589429" data-claire-element-id="589429"><code data-claire-semantic="actionscript">switch (e.keyCode)
{
	case Keyboard.UP :
		gravite = 0;
		accelerationY = -0.5;
		break;
	case Keyboard.DOWN :
		accelerationY = 0.5;
		break;
	case Keyboard.LEFT :
		accelerationX = -0.5;
		break;
	case Keyboard.RIGHT :
		accelerationX = 0.5;
		break;
}</code></pre><p id="r-589430" data-claire-element-id="589430">Je ne pense pas avoir besoin de beaucoup détailler, le code parle de lui-même.</p><ul id="r-589439" data-claire-element-id="589439"><li id="r-589432" data-claire-element-id="589432"><p id="r-589431" data-claire-element-id="589431">La flèche du haut annule la gravité et pousse <em>via</em> une accélération notre balle vers le haut (axe <em>y</em>).</p></li><li id="r-589434" data-claire-element-id="589434"><p id="r-589433" data-claire-element-id="589433">La flèche du bas crée une accélération vers le bas (axe <em>y</em>).</p></li><li id="r-589436" data-claire-element-id="589436"><p id="r-589435" data-claire-element-id="589435">La flèche de gauche crée une accélération vers la gauche (axe <em>x</em>).</p></li><li id="r-589438" data-claire-element-id="589438"><p id="r-589437" data-claire-element-id="589437">La flèche de droite crée une accélération vers… la droite ! Oui ! (Axe <em>x</em> aussi.)</p></li></ul><p id="r-589440" data-claire-element-id="589440">Il faut maintenant prendre en compte le relâchement pour annuler les accélérations et éventuels changements de gravité.</p><p id="r-589441" data-claire-element-id="589441">Pour faire la différence entre l'action « appuyer » et l'action « relâcher », nous allons utiliser la variable <strong>e.type</strong> qui vaudra <code data-claire-semantic="actionscript">KeyboardEvent.KEY_DOWN</code> si la touche est appuyée et <code data-claire-semantic="actionscript">KeyboardEvent.KEY_UP</code> si la touche est relâchée.</p><p id="r-589442" data-claire-element-id="589442">La notation <code data-claire-semantic="actionscript">e.type == KeyboardEvent.KEY_DOWN</code> retourne un <strong>boolean</strong>. Nous aurons donc un <strong>true</strong> si la touche est appuyée et un <strong>false</strong> sinon.</p><p id="r-589443" data-claire-element-id="589443">Voici alors le code de la fonction.</p><pre id="r-589444" data-claire-element-id="589444"><code data-claire-semantic="actionscript">function gestionTouches(e:KeyboardEvent)
{
	if (e.type == KeyboardEvent.KEY_DOWN)
	{
		switch (e.keyCode)
		{
			case Keyboard.UP :
				gravite = 0;
				accelerationY = -0.5;
				break;
			case Keyboard.DOWN :
				accelerationY = 0.5;
				break;
			case Keyboard.LEFT :
				accelerationX = -0.5;
				break;
			case Keyboard.RIGHT :
				accelerationX = 0.5;
				break;
		}
	}
	else
	{
		gravite = 0.5;
		accelerationY = 0;
		accelerationX = 0;
	}
}</code></pre><p id="r-589445" data-claire-element-id="589445">Et voici le code complet.</p><pre id="r-589446" data-claire-element-id="589446"><code data-claire-semantic="actionscript">//Positionnement de notre balle au centre de la scène
Balle.x = stage.stageWidth / 2;
Balle.y = stage.stageHeight / 2;

//Variables nécessaires à l'application de la gravité
var friction:Number = 0.98;
var gravite:Number = 0.5;
var vitesseX:Number = 0;
var vitesseY:Number = 0;
var accelerationX:Number = 0;
var accelerationY:Number = 0;

//Écoute de l'événement ENTER_FRAME
addEventListener(Event.ENTER_FRAME, moteurGravite);

//Écoute du clavier
stage.addEventListener(KeyboardEvent.KEY_DOWN, gestionTouches);
stage.addEventListener(KeyboardEvent.KEY_UP, gestionTouches);

function moteurGravite(e:Event)
{

	vitesseY +=  gravite;
	vitesseY +=  accelerationY;
	vitesseX +=  accelerationX;

	vitesseY *=  friction;
	vitesseX *=  friction;

	Balle.x +=  vitesseX;
	Balle.y +=  vitesseY;

	if (Balle.y + Balle.height / 2 &gt; stage.stageHeight)
	{
		Balle.y = stage.stageHeight - Balle.height / 2;
		vitesseY *=  -1;
	}
	if (Balle.y - Balle.height / 2 &lt; 0)
	{
		Balle.y = Balle.height / 2;
		vitesseY *=  -1;
	}

	if (Balle.x + Balle.width / 2 &gt; stage.stageWidth)
	{
		Balle.x = stage.stageWidth - Balle.width / 2;
		vitesseX *=  -1;
	}
	if (Balle.x - Balle.width / 2 &lt; 0)
	{
		Balle.x = Balle.width / 2;
		vitesseX *=  -1;
	}
}

function gestionTouches(e:KeyboardEvent)
{
	if (e.type == KeyboardEvent.KEY_DOWN)
	{
		switch (e.keyCode)
		{
			case Keyboard.UP :
				gravite = 0;
				accelerationY = -0.5;
				break;
			case Keyboard.DOWN :
				accelerationY = 0.5;
				break;
			case Keyboard.LEFT :
				accelerationX = -0.5;
				break;
			case Keyboard.RIGHT :
				accelerationX = 0.5;
				break;
		}
	}
	else
	{
		gravite = 0.5;
		accelerationY = 0;
		accelerationX = 0;
	}
}</code></pre><p id="r-589447" data-claire-element-id="589447">Nous avons enfin terminé ! Je pense que vous comprenez qu'avec ça, de nouvelles possibilités s'offrent à vous pour vos projets flash.<br/> Si vous voulez télécharger le fichier .fla, le voici : <a href="http://www.play-host.net/files/1310307242.fla">télécharger le fichier .fla de l'application <strong>Balle</strong></a>.</p><p id="r-589448" data-claire-element-id="589448">Nous voici donc à la fin de ce tutoriel.<br/> Vous savez maintenant comment faire pour animer un objet dans flash, et exercer des forces sur ce dernier, telles que la gravité et les accélérations, par exemple.</p><p id="r-589449" data-claire-element-id="589449">Vous pouvez réutiliser ce concept pour mettre en œuvre d'autres principes de la physique sur d'autres applications flash ; les possibilités sont vraiment très nombreuses. Je pense notamment à la création de petits jeux flash : il peut être utile, par exemple, d'employer cette méthode pour animer des personnages, des objets qui tombent du ciel ou autres. :)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3">Un peu de physique en ActionScript 3</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/posons-nos-bases">
Posons nos bases
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
Que la gravité soit, et la gravité fut !
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/faites-moi-donc-bouger-tout-ca">
Faites-moi donc bouger tout ça !
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/un-peu-de-physique-en-actionscript-3/que-la-gravite-soit-et-la-gravite-fut">
<span class="arrow"></span>
<span class="next">Que la gravité soit, et la gravité fut !</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/un-peu-de-physique-en-actionscript-3.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:52:07 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/un-peu-de-physique-en-actionscript-3.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:12:54 GMT -->
</html>