<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/ime-h-et-ses-fonctions.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 03:38:03 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/ime-h-et-ses-fonctions.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:43:58 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : time.h et ses fonctions</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/time-h-et-ses-fonctions.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : time.h et ses fonctions</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#time.hetsesfonctions">time.h et ses fonctions</a><br/><a href="#Obtenirunedateetuneheure">Obtenir une date et une heure</a><br/><a href="#Effectuerdesmanipulationsaveclesinformationsobtenues">Effectuer des manipulations avec les informations obtenues</a><br/><a href="#Afficherl039heureobtenue">Afficher l&#039;heure obtenue</a><br/></div>
<a name="time.hetsesfonctions"></a><h2>time.h et ses fonctions</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/obtenir-une-date-et-une-heure">
<span class="next">Obtenir une date et une heure</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-410698" data-claire-element-id="410698">Bonjour à tous !</p><p id="r-410699" data-claire-element-id="410699">Vous venez de terminer la lecture des deux premiers chapitres du <a href="http://www.siteduzero.com/tutoriel-3-14189-apprenez-a-programmer-en-c.html">cours officiel sur le C</a> ? Mais vous avez peut-être remarqué que la gestion du temps manque à l'appel.</p><p id="r-410700" data-claire-element-id="410700">Effectivement, la gestion du temps (que ce soit créer une attente ou afficher la date) ne fait pas partie du <a href="http://www.siteduzero.com/tutoriel-3-14189-apprenez-a-programmer-en-c.html">tutoriel officiel du C</a> de <a href="http://www.siteduzero.com/membres-294-3.html">M@teo21</a>. Et c'est ce que je vais vous apprendre tout au long de ce cours.</p><p id="r-410701" data-claire-element-id="410701">La gestion du temps en C/C++ passe par la bibliothèque <strong>time.h</strong>, renommée en <strong>ctime</strong> en C++. Donc pour suivre le cours, vous devrez utiliser la directive de préprocesseur correspondant au langage dans lequel vous compilez :</p><pre id="r-410702" data-claire-element-id="410702"><code data-claire-semantic="c">#include &lt;time.h&gt;</code></pre><pre id="r-410703" data-claire-element-id="410703"><code data-claire-semantic="cpp">#include &lt;ctime&gt;</code></pre><p id="r-410704" data-claire-element-id="410704">Grâce à cette directive de préprocesseur, vous serez apte à utiliser l'intégralité des fonctions présentes dans la bibliothèque time.h.</p><p id="r-410705" data-claire-element-id="410705">Bonne lecture !</p><aside id="r-410707" data-claire-element-id="410707" data-claire-semantic="information"><p id="r-410706" data-claire-element-id="410706">Un nouveau standard C++ est sorti il y a peu, nommé C++ 0x.<br/> Il introduit une nouvelle façon de gérer le temps <em>via</em> la classe « chrono ».<br/> Lorsque la norme C++ 0x sera rendue plus facile d'accès, je rédigerai peut-être un cours dessus.</p></aside>
</div><a name="Obtenirunedateetuneheure"></a><h2>Obtenir une date et une heure</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
<span class="next">Effectuer des manipulations avec les informations obtenues</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-410708" data-claire-element-id="410708">Dans cette partie nous allons voir :</p><ul id="r-410713" data-claire-element-id="410713"><li id="r-410710" data-claire-element-id="410710"><p id="r-410709" data-claire-element-id="410709">comment obtenir la date et l'heure actuelle ;</p></li><li id="r-410712" data-claire-element-id="410712"><p id="r-410711" data-claire-element-id="410711">comment situer son programme dans le temps (et ainsi créer un chronomètre, par exemple).</p></li></ul><h2 id="r-struct-tm-structure-du-temps" data-claire-element-id="410802">struct tm : Structure du temps</h2><p id="r-410714" data-claire-element-id="410714">Pour manipuler les dates et les heures, il nous faut de quoi stocker le temps de manière compréhensible, c'est-à-dire qu'au lieu d'une seule variable contenant des secondes (on se retrouverait avec des modulos partout), nous aurons une structure contenant un instant mais utilisant les différentes unités et informations que l'on emploie (année, mois, jour du mois, jour de la semaine, jour de l'année, heure, minute, seconde et si nous sommes en heure d'été ou d'hiver).</p><p id="r-410715" data-claire-element-id="410715"><code data-claire-semantic="c">struct tm</code> répond à ce besoin. Il s'agit d'une structure contenant les variables suivantes.</p><table id="r-410788" data-claire-element-id="410788"><thead id="r-410723" data-claire-element-id="410723"><tr id="r-410722" data-claire-element-id="410722"><th id="r-410717" data-claire-element-id="410717"><p id="r-410716" data-claire-element-id="410716">Variable</p></th><th id="r-410719" data-claire-element-id="410719"><p id="r-410718" data-claire-element-id="410718">Représente</p></th><th id="r-410721" data-claire-element-id="410721"><p id="r-410720" data-claire-element-id="410720">Rang</p></th></tr></thead><tbody id="r-410787" data-claire-element-id="410787"><tr id="r-410730" data-claire-element-id="410730"><td id="r-410725" data-claire-element-id="410725"><p id="r-410724" data-claire-element-id="410724">tm_year</p></td><td id="r-410727" data-claire-element-id="410727"><p id="r-410726" data-claire-element-id="410726">Le nombre d'années depuis 1900.</p></td><td id="r-410729" data-claire-element-id="410729"><p id="r-410728" data-claire-element-id="410728">0 - <strong>?</strong></p></td></tr><tr id="r-410737" data-claire-element-id="410737"><td id="r-410732" data-claire-element-id="410732"><p id="r-410731" data-claire-element-id="410731">tm_mon</p></td><td id="r-410734" data-claire-element-id="410734"><p id="r-410733" data-claire-element-id="410733">Mois écoulés depuis janvier (n° du mois-1).</p></td><td id="r-410736" data-claire-element-id="410736"><p id="r-410735" data-claire-element-id="410735">0 - 11</p></td></tr><tr id="r-410744" data-claire-element-id="410744"><td id="r-410739" data-claire-element-id="410739"><p id="r-410738" data-claire-element-id="410738">tm_yday</p></td><td id="r-410741" data-claire-element-id="410741"><p id="r-410740" data-claire-element-id="410740">Nombre de jours écoulés depuis le 1er janvier (n° jour-1).</p></td><td id="r-410743" data-claire-element-id="410743"><p id="r-410742" data-claire-element-id="410742">0 - 365</p></td></tr><tr id="r-410751" data-claire-element-id="410751"><td id="r-410746" data-claire-element-id="410746"><p id="r-410745" data-claire-element-id="410745">tm_mday</p></td><td id="r-410748" data-claire-element-id="410748"><p id="r-410747" data-claire-element-id="410747">Numéro du jour du mois.</p></td><td id="r-410750" data-claire-element-id="410750"><p id="r-410749" data-claire-element-id="410749">1 - 31</p></td></tr><tr id="r-410758" data-claire-element-id="410758"><td id="r-410753" data-claire-element-id="410753"><p id="r-410752" data-claire-element-id="410752">tm_wday</p></td><td id="r-410755" data-claire-element-id="410755"><p id="r-410754" data-claire-element-id="410754">Nombre de jours écoulés depuis <strong>dimanche</strong> (et non lundi).</p></td><td id="r-410757" data-claire-element-id="410757"><p id="r-410756" data-claire-element-id="410756">0 - 6</p></td></tr><tr id="r-410765" data-claire-element-id="410765"><td id="r-410760" data-claire-element-id="410760"><p id="r-410759" data-claire-element-id="410759">tm_hour</p></td><td id="r-410762" data-claire-element-id="410762"><p id="r-410761" data-claire-element-id="410761">Nombre d'heures écoulées depuis minuit.</p></td><td id="r-410764" data-claire-element-id="410764"><p id="r-410763" data-claire-element-id="410763">0 - 23</p></td></tr><tr id="r-410772" data-claire-element-id="410772"><td id="r-410767" data-claire-element-id="410767"><p id="r-410766" data-claire-element-id="410766">tm_min</p></td><td id="r-410769" data-claire-element-id="410769"><p id="r-410768" data-claire-element-id="410768">Nombre de minutes écoulées depuis le dernier changement d'heure.</p></td><td id="r-410771" data-claire-element-id="410771"><p id="r-410770" data-claire-element-id="410770">0 - 59</p></td></tr><tr id="r-410779" data-claire-element-id="410779"><td id="r-410774" data-claire-element-id="410774"><p id="r-410773" data-claire-element-id="410773">tm_sec</p></td><td id="r-410776" data-claire-element-id="410776"><p id="r-410775" data-claire-element-id="410775">Nombre de secondes écoulées depuis le dernier changement de minute.</p></td><td id="r-410778" data-claire-element-id="410778"><p id="r-410777" data-claire-element-id="410777">0 - 60<strong>*</strong></p></td></tr><tr id="r-410786" data-claire-element-id="410786"><td id="r-410781" data-claire-element-id="410781"><p id="r-410780" data-claire-element-id="410780">tm_isdst</p></td><td id="r-410783" data-claire-element-id="410783"><p id="r-410782" data-claire-element-id="410782">-1 si l'information est indisponible ;<br/> 0 si c'est l'heure d'hiver ;<br/> +1 si c'est l'heure d'été.</p></td><td id="r-410785" data-claire-element-id="410785"><p id="r-410784" data-claire-element-id="410784">-</p></td></tr></tbody></table><p id="r-410789" data-claire-element-id="410789"><strong>?</strong> : Dépend de la façon dont la date est gérée par votre système d'exploitation.<br/><strong>*</strong> : Certains systèmes nécessitent une marge pour éviter des bugs. Néanmoins, retenez 0 - 59. Cette marge n'a pas vraiment d'importance.</p><p id="r-410790" data-claire-element-id="410790">Cette structure correspond donc à la représentation d'un instant avec de nombreuses informations simples à exploiter ! Nous n'allons pas encore la remplir automatiquement suivant l'heure interne de votre ordinateur, mais je vous propose un code d'exemple pour comprendre son utilisation (pas très propre mais c'est pour l'exemple).</p><h3 id="r-exemple-118" data-claire-element-id="410799">Exemple</h3><pre id="r-410791" data-claire-element-id="410791"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    struct tm instant;
    int remplir;

    printf(&quot;Entrez le mois : &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    instant.tm_mon = remplir-1;

    printf(&quot;Entrez le jour : &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    instant.tm_mday = remplir-1;

    printf(&quot;Entrez l'heure : &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    instant.tm_hour = remplir;

    printf(&quot;Entrez la minute : &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    instant.tm_min = remplir;

    printf(&quot;Entrez la seconde : &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    instant.tm_sec = remplir;

    printf(&quot;%d/%d ; %d:%d:%d&quot;, instant.tm_mday+1, instant.tm_mon+1, instant.tm_hour, instant.tm_min, instant.tm_sec);
    return 0;
}</code></pre><p id="r-410792" data-claire-element-id="410792">Pour les directives de préprocesseur, on inclut bien sûr stdio.h pour les fonctions <code data-claire-semantic="c">printf()</code> et <code data-claire-semantic="c">scanf()</code> et time.h pour notre <code data-claire-semantic="c">struct tm</code>. stdlib.h n'est pas nécessaire dans notre cas.</p><p id="r-410793" data-claire-element-id="410793">Dans la fonction <code data-claire-semantic="c">int main(void)</code> (<code data-claire-semantic="c">void</code> signifie que la fonction ne prend rien), on a la déclaration de la structure instant de type <code data-claire-semantic="c">struct tm</code> et la variable « remplir » qui nous servira à supprimer un décalage par la suite. Puis on demande à l'utilisateur d'entrer des valeurs qui seront conservées dans les variables appropriées en passant par « remplir ». Grâce à « remplir », on supprime le décalage présent pour le mois et le jour. Pour les heures, minutes et secondes, ce n'est pas la peine. Pour remplir la structure, on remplit chaque variable en la précédant du nom de la structure et d'un point. <a href="http://www.siteduzero.com/tutoriel-3-14043-creez-vos-propres-types-de-variables.html">Les structures vous sont expliquées dans le cours officiel.</a></p><p id="r-410794" data-claire-element-id="410794">Au sein de la fonction <code data-claire-semantic="c">printf()</code>, on a une mise en forme des valeurs que l'on a remplies. Remarquez que les variables tm_mday et tm_mon ne sont pas affichées telles qu'elles sont mais avec une incrémentation afin d'obtenir les vrais numéros du mois et du jour. En fait, cela sert à remettre tout ça dans les bonnes valeurs. Ces problèmes de décalages peuvent être assez déroutants, mais on comprend très vite grâce au tableau situé au début de cette partie.</p><p id="r-410795" data-claire-element-id="410795">Voici ce que ça peut donner :</p><pre id="r-410796" data-claire-element-id="410796"><code data-claire-semantic="console">Entrez le mois : 11
Entrez le jour : 10
Entrez l'heure : 0
Entrez la minute : 0
Entrez la seconde : 0
10/11 ; 0:0:0</code></pre><aside id="r-410798" data-claire-element-id="410798" data-claire-semantic="information"><p id="r-410797" data-claire-element-id="410797">Il peut être intéressant d'utiliser un pointeur vers une <code data-claire-semantic="c">struct tm</code> plutôt qu'une <code data-claire-semantic="c">struct tm</code> directement car les fonctions de time.h renvoient des pointeurs et non la structure pointée. Pour le remplissage manuel que nous venons d'effectuer, cela reste assez déconseillé. <a href="http://www.siteduzero.com/tutoriel-3-14005-a-l-assaut-des-pointeurs.html">Les pointeurs vous sont expliqués dans le cours officiel.</a></p></aside><h3 id="r-exercice-32" data-claire-element-id="410801">Exercice</h3><p id="r-410800" data-claire-element-id="410800">Ajoutez les années à mon code. <strong>Attention, il y a un piège !</strong></p><h2 id="r-clock-situer-son-programme-dans-le-temps" data-claire-element-id="410841">clock() : Situer son programme dans le temps</h2><p id="r-410803" data-claire-element-id="410803"><code data-claire-semantic="c">clock()</code> est un bidule assez intéressant. Il permet de situer son programme dans le temps. Voici son prototype :</p><pre id="r-410804" data-claire-element-id="410804"><code data-claire-semantic="c">clock_t clock (void);</code></pre><p id="r-410805" data-claire-element-id="410805">Cette fonction ne prend donc aucun paramètre et renvoie un nombre sous un nouveau type : le <code data-claire-semantic="c">clock_t</code>. Le type <code data-claire-semantic="c">clock_t</code> permet d'exprimer un nombre de <em>clock ticks</em>. Utilisez donc ce type lorsque vous souhaitez utiliser des <em>clock ticks</em> (comme le type <code data-claire-semantic="c">size_t</code> fait référence à une taille).</p><p id="r-410806" data-claire-element-id="410806">Le <em><strong>clock tick</strong></em> (ou battement pour les puristes du français) est une unité de mesure du temps interne de votre ordinateur. Qu'est-ce que ça représente par rapport à la seconde ? Eh bien…</p><div id="r-410808" data-claire-element-id="410808"><p id="r-410807" data-claire-element-id="410807">Vous l'avez deviné : ça dépend !</p></div><p id="r-410809" data-claire-element-id="410809">En fait, cette valeur dépend de votre système d'exploitation et de votre processeur. time.h possède une macro permettant savoir combien de <em>clock ticks</em> par seconde votre ordinateur gère. Il s'agit de la macro <strong>CLOCKS_PER_SEC</strong>.</p><aside id="r-410811" data-claire-element-id="410811" data-claire-semantic="information"><p id="r-410810" data-claire-element-id="410810">Il est possible que <code data-claire-semantic="c">clock()</code> retourne -1.<br/> Si c'est le cas, c'est qu'il y a eu une erreur. Prévoyez ce cas dans vos futurs programmes.</p></aside><p id="r-410812" data-claire-element-id="410812">Bon, assez parlé, testons <code data-claire-semantic="c">clock()</code>.</p><pre id="r-410813" data-claire-element-id="410813"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    printf(&quot;%f\n&quot;, (double) clock());
    return 0;
}</code></pre><p id="r-410814" data-claire-element-id="410814">Ce code est un programme tout bête qui affiche la valeur retournée par <code data-claire-semantic="c">clock()</code>. Remarquez le <code data-claire-semantic="c">(double)</code> avant l'appel de la fonction. Il permet de transformer les <code data-claire-semantic="c">clock_t</code> renvoyés en <code data-claire-semantic="c">double</code> afin d'éviter un beau <em>warning</em>. On appelle cette action le <em>cast</em> (un <em>cast</em> en <code data-claire-semantic="c">(int)</code> marche, mais néanmoins il arrive que ce type contienne un nombre décimal, alors on utilise <code data-claire-semantic="c">%f</code> avec un <em>cast</em><code data-claire-semantic="c">(double)</code>, mais attention, ça ne marche pas dans tous les cas).</p><p id="r-410815" data-claire-element-id="410815">Qu'affiche-t-il ?</p><pre id="r-410816" data-claire-element-id="410816"><code data-claire-semantic="console">0</code></pre><div id="r-410818" data-claire-element-id="410818" data-claire-semantic="question"><p id="r-410817" data-claire-element-id="410817">Aïe. Quelque chose ne va pas dans ton code.<br/> Laisse-moi deviner. Comme <code data-claire-semantic="c">clock()</code> est appelée dès le début, elle renvoie le début du programme, soit 0 <em>clock tick</em> ?</p></div><p id="r-410819" data-claire-element-id="410819">Exactement ! Il va donc falloir mettre une attente avant l'appel de <code data-claire-semantic="c">clock()</code>.</p><pre id="r-410820" data-claire-element-id="410820"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    getchar();

    printf(&quot;%f\n&quot;, (double) clock());
    return 0;
}</code></pre><p id="r-410821" data-claire-element-id="410821">Un <code data-claire-semantic="c">getchar()</code> vous demandera d'appuyer sur la touche <kbd>Entrée</kbd> avant de continuer et d'afficher la valeur renvoyée par <code data-claire-semantic="c">clock()</code>.</p><div id="r-410823" data-claire-element-id="410823" data-claire-semantic="question"><p id="r-410822" data-claire-element-id="410822">C'est bien beau, mais tu as dit que cette fonction était intéressante.<br/> Or, ça ne sert à rien.</p></div><p id="r-410824" data-claire-element-id="410824">Bien au contraire ! Réfléchissez bien. Cela permet de faire un chronomètre par exemple ! Voyez cette nouvelle version du <a href="http://www.siteduzero.com/tutoriel-3-13976-tp-plus-ou-moins-votre-premier-jeu.html">Plus ou Moins</a> !</p><pre id="r-410825" data-claire-element-id="410825"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    int mystere, nombreentre;
    clock_t temps;

    srand(time(NULL));
    mystere=rand()%100+1;

    do{
        puts(&quot;Quel est le nombre ? &quot;);
        scanf(&quot;%d&quot;, &amp;nombreentre);

        if(nombreentre&gt;mystere)
            puts(&quot;C'est moins !\n&quot;);
        if(nombreentre&lt;mystere)
            puts(&quot;C'est plus !\n&quot;);
        if(nombreentre==mystere){
            temps=clock();
            printf(&quot;Bravo !\nTu as mis %f secondes a trouver le nombre.\n&quot;, (double) temps/CLOCKS_PER_SEC);
        }
    }while(nombreentre!=mystere);

    return 0;
}</code></pre><p id="r-410826" data-claire-element-id="410826">C'est le même logiciel (je l'ai un peu simplifié mais c'est le même principe) sauf que l'on a ici une variable temps de type <code data-claire-semantic="c">clock_t</code> et lorsque le nombre est trouvé, on lui donne la bonne valeur <em>via</em> la fonction <code data-claire-semantic="c">clock()</code>. Après cela, on affiche les résultats grâce au fameux <code data-claire-semantic="c">%f</code> et une division <code data-claire-semantic="c">temps/CLOCKS_PER_SEC</code> sans oublier le cast <code data-claire-semantic="c">(double)</code> avant pour éviter un <em>warning</em>. Grâce à cette division, on obtient des secondes et non des <em>clock ticks</em>.</p><pre id="r-410827" data-claire-element-id="410827"><code data-claire-semantic="console">Quel est le nombre ?
61
Bravo !
Tu as mis 13.156000 secondes a trouver le nombre.</code></pre><h3 id="r-exercice-33" data-claire-element-id="410840">Exercice</h3><p id="r-410828" data-claire-element-id="410828">On peut faire un chronomètre, mais aussi une attente ! Créez une fonction permettant de faire une attente et qui aura ce prototype :</p><pre id="r-410829" data-claire-element-id="410829"><code data-claire-semantic="c">void attendre(float temps);</code></pre><p id="r-410830" data-claire-element-id="410830">Le temps sera bien sûr en secondes (et pas en siècles…).</p><p id="r-410831" data-claire-element-id="410831">C'est parti !</p><p id="r-410832" data-claire-element-id="410832"><strong>Correction</strong></p><div id="r-410836" data-claire-element-id="410836"><p id="r-410833" data-claire-element-id="410833">Il fallait utiliser une boucle vide se répétant tant que <code data-claire-semantic="c">clock()</code> ne renvoie pas une valeur que l'on a prédite à l'avance <em>via</em> un petit calcul. J'ai réalisé, en plus de cette fonction, un petit programme pour tester.</p><pre id="r-410834" data-claire-element-id="410834"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

void attendre(float temps);

int main(void)
{
    int compteur;

    for(compteur=10;compteur&gt;0;compteur--){
        printf(&quot;%d...\n&quot;, compteur);

        attendre(1);
    }

    puts(&quot;BONNE ANNEE !!!\n&quot;);

    return 0;
}

void attendre(float temps)
{
    clock_t arrivee=clock()+(temps*CLOCKS_PER_SEC); // On calcule le moment où l'attente devra s'arrêter

    while(clock()&lt;arrivee);
}</code></pre><p id="r-410835" data-claire-element-id="410835">Pour calculer le moment où l'attente s'arrête, on prend le moment dans lequel on se trouve (le début de l'attente) puis on y ajoute le temps d'attente en le transformant en <em>clock ticks</em> (d'où la multiplication par CLOCKS_PER_SEC).</p></div><p id="r-410837" data-claire-element-id="410837">Par contre, cette attente n'est pas aussi géniale que l'on pourrait le croire. En effet, elle consomme beaucoup de CPU. Il existe deux fonctions plus propres et moins gourmandes pour faire une attente : <code data-claire-semantic="c">sleep()</code> et <code data-claire-semantic="c">Sleep()</code> (la majuscule fait toute la différence).</p><p id="r-410838" data-claire-element-id="410838"><code data-claire-semantic="c">sleep()</code> est dans le header unistd.h (Linux et Mac uniquement) et <code data-claire-semantic="c">Sleep()</code> dans windows.h (vous savez pour quel système d'exploitation !). De plus elles ne prennent pas la même unité : <code data-claire-semantic="c">Sleep()</code> attend des millisecondes d'après <a href="http://msdn.microsoft.com/en-us/library/ms686298(v=VS.85).aspx">sa page sur la MSDN</a> et <code data-claire-semantic="c">sleep()</code> des secondes. Voici donc un code préprocesseur vous permettant d'obtenir une fonction attendre propre et portable sous forme de macro :</p><pre id="r-410839" data-claire-element-id="410839"><code data-claire-semantic="c">#if defined (WIN32) || defined (WIN64)
#include &lt;windows.h&gt;
#define ATTENDRE(temps) Sleep(temps*1000)
#else
#include &lt;unistd.h&gt;
#define ATTENDRE(temps) sleep(temps)
#endif</code></pre><h2 id="r-time-obtenir-la-date-et-l-heure" data-claire-element-id="410858">time() : Obtenir la date et l'heure</h2><p id="r-410842" data-claire-element-id="410842">Attention, nous allons enfin voir comment remplir une <code data-claire-semantic="c">struct tm</code> avec l'heure interne de votre ordinateur. Mais nous avons besoin de passer par deux fonctions pour ce faire. La première est <code data-claire-semantic="c">time()</code>. Elle est souvent utilisée dans la génération de nombres pseudo-aléatoires (voyez le Plus ou Moins). Mais que fait-elle ? Voyons son prototype…</p><pre id="r-410843" data-claire-element-id="410843"><code data-claire-semantic="c">time_t time(time_t *variable);</code></pre><p id="r-410844" data-claire-element-id="410844">Un nouveau type ! <code data-claire-semantic="c">time_t</code> est un type de variable qui sert à indiquer un nombre de secondes.</p><p id="r-410845" data-claire-element-id="410845">Bon ! En fait, time() a un fonctionnement assez bizarre : faire <code data-claire-semantic="c">variable=time(NULL)</code> revient à faire <code data-claire-semantic="c">time(&amp;variable)</code> (n'oubliez pas le &amp;, sinon, <em>warning</em>). <code data-claire-semantic="c">time()</code> va mettre la valeur à renvoyer directement dans la variable dans les deux cas (d'où l'utilisation du <code data-claire-semantic="c">NULL</code> dans le premier cas, vu qu'il n'y a aucune variable à remplir en paramètre).</p><div id="r-410847" data-claire-element-id="410847" data-claire-semantic="question"><p id="r-410846" data-claire-element-id="410846">Et ce qu'elle renvoie, ça correspond à quoi ?</p></div><p id="r-410848" data-claire-element-id="410848">La valeur renvoyée correspond au nombre de secondes écoulées depuis le premier janvier 1970. Non, cette date ne correspond à rien d'autre que le début du calendrier sur la plupart des systèmes d'exploitation.</p><aside id="r-410850" data-claire-element-id="410850" data-claire-semantic="information"><p id="r-410849" data-claire-element-id="410849">Il est possible que <code data-claire-semantic="c">time()</code> retourne -1.<br/> Si c'est le cas, c'est qu'elle n'a pas réussi à récupérer la valeur de temps.<br/> Prévoyez ce cas dans vos futurs programmes.</p></aside><div id="r-410852" data-claire-element-id="410852" data-claire-semantic="question"><p id="r-410851" data-claire-element-id="410851">Juste comme ça, pourquoi l'utilise-t-on pour générer des nombres pseudo-aléatoires ?</p></div><p id="r-410853" data-claire-element-id="410853"><code data-claire-semantic="c">srand()</code> demande un nombre pour l'initialiser car si on lui donne le même nombre, la fonction génèrera la même suite de nombres. Alors on utilise le temps car il est très rare de lancer deux fois le même programme dans la même seconde.</p><p id="r-410854" data-claire-element-id="410854">Voyons un exemple tout bête de la fonction <code data-claire-semantic="c">time()</code> :</p><pre id="r-410855" data-claire-element-id="410855"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    printf(&quot;Il s'est ecoule %f secondes depuis le 1er janvier 1970.\n&quot;, (double) time(NULL));

    return 0;
}</code></pre><pre id="r-410856" data-claire-element-id="410856"><code data-claire-semantic="console">Il s'est ecoule 1298819112 secondes depuis le 1er janvier 1970.</code></pre><p id="r-410857" data-claire-element-id="410857"><strong>Spécial quizz :</strong> devinez à quel moment j'ai lancé mon programme sans utiliser les fonctions que nous verrons par la suite !</p><h2 id="r-localtime-utiliser-ce-qui-est-renvoye-par-time-pour-remplir-une-struct-tm" data-claire-element-id="410868">localtime() : Utiliser ce qui est renvoyé par time() pour remplir une struct tm</h2><p id="r-410859" data-claire-element-id="410859"><code data-claire-semantic="c">time()</code>, c'est bien, mais on ne peut pas en faire grand chose. <code data-claire-semantic="c">localtime()</code> va nous permettre d'utiliser <code data-claire-semantic="c">time()</code> pour remplir une <code data-claire-semantic="c">struct tm</code>. Voici son prototype :</p><pre id="r-410860" data-claire-element-id="410860"><code data-claire-semantic="c">struct tm* localtime (const time_t *secondes);</code></pre><p id="r-410861" data-claire-element-id="410861">Elle prend un nombre de secondes pour renvoyer un pointeur vers une <code data-claire-semantic="c">struct tm</code>. Et devinez comment on fait pour remplir une <code data-claire-semantic="c">struct tm</code> avec l'heure actuelle ? C'est simple ! On récupère d'abord le temps actuel grâce à <code data-claire-semantic="c">time()</code> puis on remplit notre <code data-claire-semantic="c">struct tm</code><em>via</em><code data-claire-semantic="c">localtime()</code>.</p><p id="r-410862" data-claire-element-id="410862">La valeur renvoyée est un pointeur vers une zone mémoire allouée statiquement et partagée entre les fonctions <code data-claire-semantic="c">gmtime()</code>, <code data-claire-semantic="c">localtime()</code> et <code data-claire-semantic="c">ctime()</code>. Vous pouvez donc utiliser des pointeurs pour ne pas avoir à copier la valeur de cette zone mémoire. Attention cependant à utiliser cela correctement car les précédentes valeurs de la zone mémoire seront écrasées lors des prochains appels de ces fonctions.</p><pre id="r-410863" data-claire-element-id="410863"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    time_t secondes;
    struct tm instant;

    time(&amp;secondes);
    instant=*localtime(&amp;secondes);

    printf(&quot;%d/%d ; %d:%d:%d\n&quot;, instant.tm_mday+1, instant.tm_mon+1, instant.tm_hour, instant.tm_min, instant.tm_sec);
    return 0;
}</code></pre><p id="r-410864" data-claire-element-id="410864">C'est le même code que lorsque je vous ai appris à remplir une <code data-claire-semantic="c">struct tm</code> sauf que, cette fois-ci, les fonctions le font pour nous. Remarquez que pour remplir « instant », j'utilise un pointeur. Si je ne mets pas cet astérisque (*), on renvoie un pointeur dans une <code data-claire-semantic="c">struct tm</code>, ce qui provoque une erreur lors de la compilation.</p><pre id="r-410865" data-claire-element-id="410865"><code data-claire-semantic="console">28/2 ; 16:32:28</code></pre><aside id="r-410867" data-claire-element-id="410867" data-claire-semantic="information"><p id="r-410866" data-claire-element-id="410866">Notez qu'il existe une fonction pour directement mettre notre <code data-claire-semantic="c">struct tm</code> en forme : <code data-claire-semantic="c">asctime()</code>.<br/> Mais nous verrons tout ça dans la troisième partie.</p></aside><h2 id="r-gmtime-obtenir-l-heure-gmt" data-claire-element-id="410886">gmtime() : Obtenir l'heure GMT</h2><p id="r-410869" data-claire-element-id="410869"><a href="http://fr.wikipedia.org/wiki/Temps_moyen_de_Greenwich">Lire l'article GMT sur Wikipédia</a></p><p id="r-410870" data-claire-element-id="410870">L'heure GMT, c'est l'heure qu'il est en Grande Bretagne, chez nos amis les anglais. Or, en France, au Québec ou en Australie ce n'est pas la même heure. Mais en utilisant <code data-claire-semantic="c">gmtime()</code>, on peut récupérer l'heure GMT.</p><pre id="r-410871" data-claire-element-id="410871"><code data-claire-semantic="c">struct tm* gmtime (const time_t *temps);</code></pre><p id="r-410872" data-claire-element-id="410872">Cette fonction prend en paramètre le nombre de secondes depuis le 1er janvier 1970 dans votre fuseau horaire (pas besoin de conversion) et renvoie l’adresse mémoire de time.h destinée aux <code data-claire-semantic="c">struct tm</code> (reportez-vous à la partie sur <code data-claire-semantic="c">localtime()</code>) après l'avoir remplie avec l'heure GMT. Par exemple en France, ce sera une heure avant puisque la France se situe dans le fuseau horaire +1.</p><p id="r-410873" data-claire-element-id="410873">Son utilité ? Imaginez que vous habitiez à Sydney en Australie et que vous souhaitiez prendre l'avion pour New York aux États-Unis. Vous savez combien de temps dure le trajet mais vous voulez arriver dans une fourchette d'heures bien précise (disons entre 13h et 15h, heure de New York). Vous connaissez la durée du trajet, oui mais pas l'heure qu'il est là-bas. <code data-claire-semantic="c">gmtime()</code> vous permettra de la trouver avec des calculs très simples.</p><p id="r-410874" data-claire-element-id="410874">Voici la représentation du monde avec les différents fuseaux horaires.</p><p id="r-410875" data-claire-element-id="410876"><em><a href="medias/uploads.siteduzero.com_files_351001_352000_351566.png"><img id="r-410876" data-claire-element-id="410875" src="medias/uploads.siteduzero.com_thb_351001_352000_351566.png" alt="Représentation du monde avec les différents fuseaux horaires"/></a>Représentation du monde avec les différents fuseaux horaires.<br/> Image tirée de <a href="../../commons.wikimedia.org/wiki/File_Standard_time_zones_of_the_world.html">Wikipédia</a>, œuvre placée dans le domaine public.</em></p><p id="r-410877" data-claire-element-id="410877">Sydney se trouve donc dans un fuseau horaire GST (GMT+10) et New York dans un fuseau horaire EST (GMT-5). Cela signifie que lorsqu'il est minuit à Greenwich — ville où a été placé le méridien d'origine et donc le fuseau horaire UDC (celui correspondant à l'heure GMT) —, il est 10 heures à Sydney et 19h à New York.</p><pre id="r-410878" data-claire-element-id="410878"><code data-claire-semantic="c">#define SYD 10
#define NYC -5</code></pre><p id="r-410879" data-claire-element-id="410879">Un moyen simple est de créer des macros correspondant aux fuseaux horaires (certains fuseaux horaires ont des noms civils et militaires mais pour des raisons de simplicité, j'ai mis les noms des villes Sydney et New York City) correspondant au décalage horaire par rapport à GMT.</p><p id="r-410880" data-claire-element-id="410880"><a href="http://wwp.greenwichmeantime.com/info/timezone.htm">Tableau répertoriant les noms civils et militaires des fuseaux horaires</a></p><pre id="r-410881" data-claire-element-id="410881"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;
#define SYD 10
#define NYC -5

int main(void)
{
    time_t temps;
    struct tm date;

    time(&amp;temps);
    date=*gmtime(&amp;temps);

    printf(&quot;GMT: %d:%d\n&quot;, date.tm_hour, date.tm_min);
    printf(&quot;Sydney: %d:%d\n&quot;, (date.tm_hour+SYD+24)%24, date.tm_min);
    printf(&quot;New-York: %d:%d\n&quot;, (date.tm_hour+NYC+24)%24, date.tm_min);

    return 0;
}</code></pre><p id="r-410882" data-claire-element-id="410882">Après avoir placé nos macros et initialisé nos variables, on récupère l'heure GMT actuelle <em>via</em><code data-claire-semantic="c">time()</code> et <code data-claire-semantic="c">gmtime()</code>. Ensuite, on place des <code data-claire-semantic="c">printf()</code> qui doivent nous indiquer l'heure GMT, l'heure de Sydney et l'heure de New York. Pour la calculer, on fait le calcul <code data-claire-semantic="c">(heure+décalage+24)%24</code>. Le modulo est nécessaire car si on ne le met pas, on pourrait se retrouver avec des heures comme 26:30. Et je n'aimerais pas créer de faille spatio-temporelle. De même pour le +24 avant le modulo. Si avec la soustraction de l'heure pour le fuseau horaire de New York on obtient une heure négative, il va falloir la transformer en un nombre positif entre 0 et 24. Pour ce faire, on ajoute tout simplement 24. Le modulo supprimera les heures en trop s'il y en a.</p><pre id="r-410883" data-claire-element-id="410883"><code data-claire-semantic="console">GMT: 17:1
Sydney: 3:1
New-York: 12:1</code></pre><p id="r-410884" data-claire-element-id="410884">Entre nous, je crois que c'est fichu pour aller à New York aujourd'hui.</p><p id="r-410885" data-claire-element-id="410885">En tout cas, on en a enfin fini avec les différentes manières d'obtenir des informations relatives au temps. La partie 2 porte sur quelques manipulations et calculs réalisables avec les informations obtenues.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions">time.h et ses fonctions</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/obtenir-une-date-et-une-heure">
Obtenir une date et une heure
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
Effectuer des manipulations avec les informations obtenues
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/afficher-l-heure-obtenue">
Afficher l&#039;heure obtenue
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
<span class="next">Effectuer des manipulations avec les informations obtenues</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Effectuerdesmanipulationsaveclesinformationsobtenues"></a><h2>Effectuer des manipulations avec les informations obtenues</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/obtenir-une-date-et-une-heure">
<span class="arrow"></span>
<span class="next">Obtenir une date et une heure</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/afficher-l-heure-obtenue">
<span class="next">Afficher l&#039;heure obtenue</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-410888" data-claire-element-id="410888">Vous savez maintenant obtenir un moment précis et situer votre programme dans le temps. Maintenant, nous allons utiliser les informations obtenues pour effectuer quelques manipulations. Seules deux fonctions seront vues, en fait :</p><ul id="r-410893" data-claire-element-id="410893"><li id="r-410890" data-claire-element-id="410890"><p id="r-410889" data-claire-element-id="410889"><code data-claire-semantic="c">difftime()</code> pour trouver l'intervalle entre deux moments ;</p></li><li id="r-410892" data-claire-element-id="410892"><p id="r-410891" data-claire-element-id="410891"><code data-claire-semantic="c">mktime()</code> pour compléter une <code data-claire-semantic="c">struct tm</code> à partir de seulement 3 variables et/ou exécuter le procédé inverse de <code data-claire-semantic="c">localtime()</code>.</p></li></ul><h2 id="r-difftime-faire-la-difference-entre-deux-instants" data-claire-element-id="410900">difftime() : Faire la différence entre deux instants</h2><p id="r-410894" data-claire-element-id="410894">Ici, nous allons apprendre à faire une différence entre deux moments. Imaginez que vous souhaitiez battre le record du monde du temps d'enfermement dans un carton (oui ; je sais, c'est pourri). N'ayant pas de montre et dormant fréquemment, vous ne savez pas combien de temps vous avez passé dans votre boîte. Mais imaginez qu'à côté vous ayez un ordinateur ayant enregistré le moment où vous êtres entré et celui où vous êtes sorti. Eh bien <code data-claire-semantic="c">difftime()</code> fera automatiquement la différence entre ces deux moments ! Allez, lisez cette partie et tentez le record !</p><pre id="r-410895" data-claire-element-id="410895"><code data-claire-semantic="c">double difftime (time_t arrivee, time_t depart);</code></pre><p id="r-410896" data-claire-element-id="410896">Vous l'aurez remarqué, on fait la différence à partir de deux <code data-claire-semantic="c">time_t</code>, soit deux nombres représentant le nombre de secondes écoulées depuis le 1er janvier 1970. Voyons voir ça.</p><pre id="r-410897" data-claire-element-id="410897"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    time_t depart, arrivee;
    time(&amp;depart);

    puts(&quot;Tu peux maintenant aller faire autre chose...\n&quot;);
    getchar();

    time(&amp;arrivee);
    printf(&quot;Tu t'es absente pendant %f secondes.&quot;, difftime(arrivee, depart));

    return 0;
}</code></pre><p id="r-410898" data-claire-element-id="410898">Voilà, vous pouvez rentrer dans votre carton. Donc on initialise deux variables qui stockeront le départ et l'arrivée et on donne la bonne valeur à « départ ». Un <code data-claire-semantic="c">getchar()</code> sert à faire une attente jusqu'à ce que l'utilisateur appuie sur <kbd>Entrée</kbd>, et on donne la bonne valeur à « arrivee ». Puis viennent les résultats où on affiche ce que renvoie <code data-claire-semantic="c">difftime()</code>, soit le temps qui s'est écoulé entre le départ et l'arrivée. Il y a des avantages par rapport à <code data-claire-semantic="c">clock()</code>, mais pour de petites durées, il vaut mieux un bon <code data-claire-semantic="c">clock()</code> car vous obtiendrez des résultats plus précis en fonction du nombre de <em>clock ticks</em> par seconde.</p><pre id="r-410899" data-claire-element-id="410899"><code data-claire-semantic="console">Tu peux maintenant aller faire autre chose...


Tu t'es absente pendant 411.000000 secondes.</code></pre><h2 id="r-mktime-completer-une-struct-tm" data-claire-element-id="410928">mktime() : Compléter une struct tm</h2><p id="r-410901" data-claire-element-id="410901">Il arrivera souvent que vous remplissiez une <code data-claire-semantic="c">struct tm</code> mais à moitié. Et tout à coup, vous avez besoin d'une valeur que vous n'avez pas remplie. Comment la calculer ? <code data-claire-semantic="c">mktime()</code> va faire tout le boulot à votre place.</p><pre id="r-410902" data-claire-element-id="410902"><code data-claire-semantic="c">time_t mktime (struct tm *structure);</code></pre><p id="r-410903" data-claire-element-id="410903">Cette fonction prend en paramètre une <code data-claire-semantic="c">struct tm</code> et renvoie la valeur <code data-claire-semantic="c">time_t</code> correspondante à celle-ci, soit le procédé inverse de <code data-claire-semantic="c">localtime()</code>. Mais elle ne sert pas qu'à ça. Elle sert en effet à remplir une <code data-claire-semantic="c">struct tm</code> incomplète à partir de ces 3 valeurs :</p><ul id="r-410910" data-claire-element-id="410910"><li id="r-410905" data-claire-element-id="410905"><p id="r-410904" data-claire-element-id="410904"><code data-claire-semantic="c">tm_year</code> ;</p></li><li id="r-410907" data-claire-element-id="410907"><p id="r-410906" data-claire-element-id="410906"><code data-claire-semantic="c">tm_mon</code> ;</p></li><li id="r-410909" data-claire-element-id="410909"><p id="r-410908" data-claire-element-id="410908"><code data-claire-semantic="c">tm_mday</code>.</p></li></ul><p id="r-410911" data-claire-element-id="410911">Toutes les autres valeurs mises à part « tm_hour », « tm_min » et « tm_sec » seront calculées à partir des 3 variables nécessaires. Cette fonction permet notamment de savoir quel jour de la semaine on est à partir du jour du mois, ou alors de connaître quel jour on sera dans <em>x</em> jours. Je pense que l'on peut trouver pas mal d'exemples, alors on va faire tout simple : savoir quel jour de l'année on est à partir d'une date précise !</p><aside id="r-410913" data-claire-element-id="410913" data-claire-semantic="information"><p id="r-410912" data-claire-element-id="410912">Il est possible que <code data-claire-semantic="c">mktime()</code> retourne -1.<br/> Si c'est le cas, c'est qu'il y a eu une erreur. Prévoyez ce cas dans vos futurs programmes.</p></aside><pre id="r-410914" data-claire-element-id="410914"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    time_t temps;
    struct tm date;
    int remplir;

    // On demande à l'utilisateur de remplir les valeurs demandées.
    // Ne pas oublier d'additionner ou de soustraire les bonnes valeurs pour éviter les décalages.
    puts(&quot;Annee ? &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    date.tm_year=remplir-1900;

    puts(&quot;Mois ? &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    date.tm_mon=remplir-1;

    puts(&quot;Jour ? &quot;);
    scanf(&quot;%d&quot;, &amp;remplir);
    date.tm_mday=remplir;

    // On s'assure que l'instant est bien placé à minuit.
    date.tm_hour=0;
    date.tm_min=0;
    date.tm_sec=0;

    temps=mktime(&amp;date);

    printf(&quot;C'est le %deme jour de l'annee !\nEt minuit est la %deme seconde depuis le 1er janvier 1970.\n&quot;, date.tm_yday, (int) temps);

    return 0;
}</code></pre><p id="r-410915" data-claire-element-id="410915">On demande donc à l'utilisateur de remplir les champs « année », « mois » et « jour du mois » pour remplir les autres cases de la structure. Remarquez que j'ai mis les variables de l'heure, minutes et secondes à 0 pour se positionner sur minuit. Ensuite, après <code data-claire-semantic="c">mktime()</code>, on affiche « date.tm_yday » que <code data-claire-semantic="c">mktime()</code> a calculée, et <strong>petit bonus</strong>, la valeur renvoyée par <code data-claire-semantic="c">mktime()</code> qui correspond au nombre de secondes écoulées entre le 1er janvier 1970 à minuit et cette date.</p><pre id="r-410916" data-claire-element-id="410916"><code data-claire-semantic="console">Annee ?
1999
Mois ?
11
Jour ?
10
C'est le 312eme jour de l'annee !
Et minuit est la 942184800eme seconde depuis le 1er janvier 1970.</code></pre><aside id="r-410926" data-claire-element-id="410926" data-claire-semantic="warning"><p id="r-410917" data-claire-element-id="410917">Après vérification, j'ai pu constater que <code data-claire-semantic="c">mktime</code> remplit la <code data-claire-semantic="c">struct tm</code> avec deux jours de décalage en arrière pour les jours de l'année. Je n'ai aucune idée de la cause de ce décalage ni s'il est présent sur tous les systèmes, mais si c'est le cas chez vous (vous pouvez vérifier avec <a href="http://fr.wikipedia.org/wiki/Catégorie%3AJour_de_l%27année">Wikipédia</a>), vous pouvez régler ce problème de deux façons :</p><ul id="r-410924" data-claire-element-id="410924"><li id="r-410920" data-claire-element-id="410920"><p id="r-410918" data-claire-element-id="410918">changer la valeur de <code data-claire-semantic="c">tm_yday</code> après l'usage de <code data-claire-semantic="c">mktime</code> :</p><pre id="r-410919" data-claire-element-id="410919"><code data-claire-semantic="c">temps=mktime(&amp;date);
date.tm_yday+=2;</code></pre></li><li id="r-410923" data-claire-element-id="410923"><p id="r-410921" data-claire-element-id="410921">appeler ensuite les valeurs de cette manière (dans notre cas, la valeur est appelée dans <code data-claire-semantic="c">printf</code>) :</p><pre id="r-410922" data-claire-element-id="410922"><code data-claire-semantic="c">date.tm_yday+2</code></pre></li></ul><p id="r-410925" data-claire-element-id="410925">Je recommande toutefois la première solution car vous n'aurez qu'à rajouter une ligne et pas faire des mois de recherche dans un gros code.</p></aside><p id="r-410927" data-claire-element-id="410927">C'est loin d'être le seul exemple. Soyez créatif, il y a pas mal de possibilités !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions">time.h et ses fonctions</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/obtenir-une-date-et-une-heure">
Obtenir une date et une heure
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
Effectuer des manipulations avec les informations obtenues
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/afficher-l-heure-obtenue">
Afficher l&#039;heure obtenue
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/obtenir-une-date-et-une-heure">
<span class="arrow"></span>
<span class="next">Obtenir une date et une heure</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/afficher-l-heure-obtenue">
<span class="next">Afficher l&#039;heure obtenue</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Afficherl039heureobtenue"></a><h2>Afficher l&#039;heure obtenue</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
<span class="arrow"></span>
<span class="next">Effectuer des manipulations avec les informations obtenues</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-410930" data-claire-element-id="410930">Cette troisième partie n'est pas la plus importante. Elle est cependant intéressante car elle va vous permettre d'écrire les moments obtenus dans vos programmes.</p><div id="r-410932" data-claire-element-id="410932" data-claire-semantic="question"><p id="r-410931" data-claire-element-id="410931">Un coup de <code data-claire-semantic="c">printf()</code> ne suffit-il pas ?</p></div><p id="r-410933" data-claire-element-id="410933">En fait, on va apprendre à placer l'heure écrite dans un format bien précis et directement dans une chaîne de caractères.</p><h2 id="r-asctime-transformer-une-struct-tm-en-char" data-claire-element-id="410962">asctime() : Transformer une struct tm en char[]</h2><p id="r-410934" data-claire-element-id="410934">Ce titre vous semble délirant, et pourtant c'est entièrement vrai : <code data-claire-semantic="c">asctime()</code> vous permet de transformer une <code data-claire-semantic="c">struct tm</code> en <code data-claire-semantic="c">char[]</code>, c'est à dire mettre en forme le contenu de la <code data-claire-semantic="c">struct tm</code> et stocker le résultat dans une chaîne de caractères. Voici la syntaxe de cette fonction.</p><p id="r-410935" data-claire-element-id="410935">À l'image de la zone mémoire dédiée aux <code data-claire-semantic="c">struct tm</code> (reportez-vous à la partie sur <code data-claire-semantic="c">localtime()</code>), la valeur renvoyée par <code data-claire-semantic="c">asctime()</code> est un pointeur vers une zone mémoire de 26 caractères partagée entre <code data-claire-semantic="c">asctime()</code> et <code data-claire-semantic="c">ctime()</code>.</p><pre id="r-410936" data-claire-element-id="410936"><code data-claire-semantic="c">char* asctime (const struct tm* instant);</code></pre><p id="r-410937" data-claire-element-id="410937">Cette fonction prend donc un pointeur vers une <code data-claire-semantic="c">struct tm</code> en paramètre et retourne une chaîne (terminée par un retour à la ligne et un caractère 0) de caractères. La mise en forme obtenue est la suivante :</p><p id="r-410938" data-claire-element-id="410938"><strong>Jjj Mmm jm hh:mm:ss aaaa</strong>.</p><p id="r-410939" data-claire-element-id="410939">Dans l'ordre :</p><ul id="r-410954" data-claire-element-id="410954"><li id="r-410941" data-claire-element-id="410941"><p id="r-410940" data-claire-element-id="410940"><strong>tm_wday</strong>, le jour de la semaine est exprimé en 3 lettres dans son nom anglais (ex : Lundi → Mon) ;</p></li><li id="r-410943" data-claire-element-id="410943"><p id="r-410942" data-claire-element-id="410942"><strong>tm_mon</strong>, le nom du mois exprimé en 3 lettres dans son nom anglais (ex : Juin → Jun) ;</p></li><li id="r-410945" data-claire-element-id="410945"><p id="r-410944" data-claire-element-id="410944"><strong>tm_mday</strong>, le jour du mois ;</p></li><li id="r-410947" data-claire-element-id="410947"><p id="r-410946" data-claire-element-id="410946"><strong>tm_hour</strong>, l'heure ;</p></li><li id="r-410949" data-claire-element-id="410949"><p id="r-410948" data-claire-element-id="410948"><strong>tm_min</strong>, les minutes ;</p></li><li id="r-410951" data-claire-element-id="410951"><p id="r-410950" data-claire-element-id="410950"><strong>tm_sec</strong>, les secondes ;</p></li><li id="r-410953" data-claire-element-id="410953"><p id="r-410952" data-claire-element-id="410952"><strong>tm_year</strong>, l'année.</p></li></ul><p id="r-410955" data-claire-element-id="410955">Voyons voir ça !</p><pre id="r-410956" data-claire-element-id="410956"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    time_t temps;
    struct tm date;

    time(&amp;temps);
    date=*localtime(&amp;temps);

    printf(&quot;%s\n&quot;, asctime(&amp;date));

    return 0;
}</code></pre><p id="r-410957" data-claire-element-id="410957">Donc après avoir donné la bonne valeur à temps, on remplit date <em>via</em><code data-claire-semantic="c">localtime()</code> et on utilise dans <code data-claire-semantic="c">printf()</code> la fonction <code data-claire-semantic="c">asctime()</code> en lui envoyant notre structure date.</p><p id="r-410958" data-claire-element-id="410958">On obtient la date et l'heure écrite dans le format que j'ai indiqué plus haut.</p><pre id="r-410959" data-claire-element-id="410959"><code data-claire-semantic="console">Sun Feb 27 21:39:40 2011</code></pre><h3 id="r-exercice-34" data-claire-element-id="410961">Exercice</h3><p id="r-410960" data-claire-element-id="410960">Avec la fonction (ou la macro, comme vous préférez) attendre, créez une horloge ! Afin d'être la plus précise possible, votre horloge devra comporter une phase de synchronisation, boucle vide qui se répète tant que l'on n'est pas sûr que l'on est tout au début de la seconde.</p><h2 id="r-ctime-transformer-un-time-t-en-char" data-claire-element-id="410971">ctime() : Transformer un time_t en char[]</h2><pre id="r-410963" data-claire-element-id="410963"><code data-claire-semantic="c">char* ctime (const time_t *temps);</code></pre><p id="r-410964" data-claire-element-id="410964"><code data-claire-semantic="c">ctime()</code> est une version raccourcie de <code data-claire-semantic="c">asctime()</code>. Au lieu de lui donner une <code data-claire-semantic="c">struct tm</code>, on lui donne directement un <code data-claire-semantic="c">time_t</code>, ce qui fait gagner du temps. Pour un exemple plus concret :</p><pre id="r-410965" data-claire-element-id="410965"><code data-claire-semantic="c">// Ces deux instructions donnent le même résultat.
asctime(localtime(&amp;temps));
ctime(&amp;temps);</code></pre><p id="r-410966" data-claire-element-id="410966">La valeur renvoyée est un pointeur vers une zone mémoire qui est également utilisée par <code data-claire-semantic="c">asctime()</code>. Ces deux fonctions écraseront donc la chaîne contenue dans cet espace mémoire (à l'image des fonctions utilisant les <code data-claire-semantic="c">struct tm</code>).</p><pre id="r-410967" data-claire-element-id="410967"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    time_t temps;

    time(&amp;temps);

    printf(&quot;%s\n&quot;, ctime(&amp;temps));

    return 0;
}</code></pre><p id="r-410968" data-claire-element-id="410968">Tout est du déjà vu, donc pas besoin de s'acharner là-dessus.</p><aside id="r-410970" data-claire-element-id="410970" data-claire-semantic="information"><p id="r-410969" data-claire-element-id="410969">Le fonctionnement de <code data-claire-semantic="c">ctime()</code> fait en sorte que la zone mémoire destinée aux <code data-claire-semantic="c">struct tm</code> soit modifiée (reportez-vous à la partie sur <code data-claire-semantic="c">localtime()</code>).<br/> Faites attention à cela car cette fonction écrasera le précédent contenu de la zone mémoire.</p></aside><h2 id="r-strftime-creer-son-propre-format" data-claire-element-id="411166">strftime() : Créer son propre format</h2><p id="r-410972" data-claire-element-id="410972">Là ce sera plus dur : Nous allons toujours mettre en forme notre structure dans une chaîne de caractères, mais cette fois, nous allons créer notre propre format. En gros nous allons « créer » notre propre <code data-claire-semantic="c">asctime()</code>.</p><pre id="r-410973" data-claire-element-id="410973"><code data-claire-semantic="c">size_t strftime (char *variable, size_t taillemax, const char *format, const struct tm *date);</code></pre><p id="r-410974" data-claire-element-id="410974">C'est du lourd ! En fait, cette fonction est comme un <code data-claire-semantic="c">printf()</code>. Ses paramètres sont :</p><ul id="r-410983" data-claire-element-id="410983"><li id="r-410976" data-claire-element-id="410976"><p id="r-410975" data-claire-element-id="410975">la chaîne qui contiendra la mise en forme ;</p></li><li id="r-410978" data-claire-element-id="410978"><p id="r-410977" data-claire-element-id="410977">la longueur maximale de la chaîne ;</p></li><li id="r-410980" data-claire-element-id="410980"><p id="r-410979" data-claire-element-id="410979">la mise en forme ;</p></li><li id="r-410982" data-claire-element-id="410982"><p id="r-410981" data-claire-element-id="410981">un pointeur vers la structure à utiliser.</p></li></ul><p id="r-410984" data-claire-element-id="410984">Qu'est-ce qu'elle retourne ? La longueur de la mise en forme si elle ne dépasse pas la longueur maximale autorisée. Si la chaîne mise en forme dépasse la limite que vous autorisez, la fonction retourne 0.</p><p id="r-410985" data-claire-element-id="410985">Donc la variable sera contenue dans une chaîne, il serait déjà bien d'en allouer une. 48 caractères suffiront, à moins que vous ne souhaitiez mettre un roman en tant que mise en forme. Après, à l'image de <code data-claire-semantic="c">printf()</code>, les « % » servent à afficher des valeurs. Voici un tableau pour vous donner une petite idée.</p><table id="r-411149" data-claire-element-id="411149"><thead id="r-410993" data-claire-element-id="410993"><tr id="r-410992" data-claire-element-id="410992"><th id="r-410987" data-claire-element-id="410987"><p id="r-410986" data-claire-element-id="410986">Symbole</p></th><th id="r-410989" data-claire-element-id="410989"><p id="r-410988" data-claire-element-id="410988">Affichera</p></th><th id="r-410991" data-claire-element-id="410991"><p id="r-410990" data-claire-element-id="410990">Exemple</p></th></tr></thead><tbody id="r-411148" data-claire-element-id="411148"><tr id="r-411000" data-claire-element-id="411000"><td id="r-410995" data-claire-element-id="410995"><p id="r-410994" data-claire-element-id="410994">%A</p></td><td id="r-410997" data-claire-element-id="410997"><p id="r-410996" data-claire-element-id="410996">Nom du jour de la semaine.</p></td><td id="r-410999" data-claire-element-id="410999"><p id="r-410998" data-claire-element-id="410998">Monday</p></td></tr><tr id="r-411007" data-claire-element-id="411007"><td id="r-411002" data-claire-element-id="411002"><p id="r-411001" data-claire-element-id="411001">%a</p></td><td id="r-411004" data-claire-element-id="411004"><p id="r-411003" data-claire-element-id="411003">Nom du jour de la semaine en abrégé.</p></td><td id="r-411006" data-claire-element-id="411006"><p id="r-411005" data-claire-element-id="411005">Mon</p></td></tr><tr id="r-411014" data-claire-element-id="411014"><td id="r-411009" data-claire-element-id="411009"><p id="r-411008" data-claire-element-id="411008">%B</p></td><td id="r-411011" data-claire-element-id="411011"><p id="r-411010" data-claire-element-id="411010">Nom du mois.</p></td><td id="r-411013" data-claire-element-id="411013"><p id="r-411012" data-claire-element-id="411012">January</p></td></tr><tr id="r-411021" data-claire-element-id="411021"><td id="r-411016" data-claire-element-id="411016"><p id="r-411015" data-claire-element-id="411015">%b</p></td><td id="r-411018" data-claire-element-id="411018"><p id="r-411017" data-claire-element-id="411017">Nom du mois en abrégé.</p></td><td id="r-411020" data-claire-element-id="411020"><p id="r-411019" data-claire-element-id="411019">Jan</p></td></tr><tr id="r-411028" data-claire-element-id="411028"><td id="r-411023" data-claire-element-id="411023"><p id="r-411022" data-claire-element-id="411022">%c</p></td><td id="r-411025" data-claire-element-id="411025"><p id="r-411024" data-claire-element-id="411024">Représentation de la date et de l'heure classique.</p></td><td id="r-411027" data-claire-element-id="411027"><p id="r-411026" data-claire-element-id="411026">02/27/11 22:05:45</p></td></tr><tr id="r-411035" data-claire-element-id="411035"><td id="r-411030" data-claire-element-id="411030"><p id="r-411029" data-claire-element-id="411029">%d</p></td><td id="r-411032" data-claire-element-id="411032"><p id="r-411031" data-claire-element-id="411031">Numéro du jour dans le mois.</p></td><td id="r-411034" data-claire-element-id="411034"><p id="r-411033" data-claire-element-id="411033">29</p></td></tr><tr id="r-411042" data-claire-element-id="411042"><td id="r-411037" data-claire-element-id="411037"><p id="r-411036" data-claire-element-id="411036">%H</p></td><td id="r-411039" data-claire-element-id="411039"><p id="r-411038" data-claire-element-id="411038">Heure (0-24).</p></td><td id="r-411041" data-claire-element-id="411041"><p id="r-411040" data-claire-element-id="411040">16</p></td></tr><tr id="r-411049" data-claire-element-id="411049"><td id="r-411044" data-claire-element-id="411044"><p id="r-411043" data-claire-element-id="411043">%I</p></td><td id="r-411046" data-claire-element-id="411046"><p id="r-411045" data-claire-element-id="411045">Heure (0-12).</p></td><td id="r-411048" data-claire-element-id="411048"><p id="r-411047" data-claire-element-id="411047">4</p></td></tr><tr id="r-411056" data-claire-element-id="411056"><td id="r-411051" data-claire-element-id="411051"><p id="r-411050" data-claire-element-id="411050">%j</p></td><td id="r-411053" data-claire-element-id="411053"><p id="r-411052" data-claire-element-id="411052">Jour dans l'année.</p></td><td id="r-411055" data-claire-element-id="411055"><p id="r-411054" data-claire-element-id="411054">342</p></td></tr><tr id="r-411063" data-claire-element-id="411063"><td id="r-411058" data-claire-element-id="411058"><p id="r-411057" data-claire-element-id="411057">%m</p></td><td id="r-411060" data-claire-element-id="411060"><p id="r-411059" data-claire-element-id="411059">Numéro du mois.</p></td><td id="r-411062" data-claire-element-id="411062"><p id="r-411061" data-claire-element-id="411061">12</p></td></tr><tr id="r-411070" data-claire-element-id="411070"><td id="r-411065" data-claire-element-id="411065"><p id="r-411064" data-claire-element-id="411064">%M</p></td><td id="r-411067" data-claire-element-id="411067"><p id="r-411066" data-claire-element-id="411066">Minute.</p></td><td id="r-411069" data-claire-element-id="411069"><p id="r-411068" data-claire-element-id="411068">51</p></td></tr><tr id="r-411077" data-claire-element-id="411077"><td id="r-411072" data-claire-element-id="411072"><p id="r-411071" data-claire-element-id="411071">%p</p></td><td id="r-411074" data-claire-element-id="411074"><p id="r-411073" data-claire-element-id="411073">Affiche « AM » le matin et « PM » l'après-midi (utile après un « %I »).</p></td><td id="r-411076" data-claire-element-id="411076"><p id="r-411075" data-claire-element-id="411075">PM</p></td></tr><tr id="r-411084" data-claire-element-id="411084"><td id="r-411079" data-claire-element-id="411079"><p id="r-411078" data-claire-element-id="411078">%S</p></td><td id="r-411081" data-claire-element-id="411081"><p id="r-411080" data-claire-element-id="411080">Secondes.</p></td><td id="r-411083" data-claire-element-id="411083"><p id="r-411082" data-claire-element-id="411082">12</p></td></tr><tr id="r-411091" data-claire-element-id="411091"><td id="r-411086" data-claire-element-id="411086"><p id="r-411085" data-claire-element-id="411085">%U</p></td><td id="r-411088" data-claire-element-id="411088"><p id="r-411087" data-claire-element-id="411087">Numéro de la semaine dans l'année (dimanche = premier jour de la semaine).</p></td><td id="r-411090" data-claire-element-id="411090"><p id="r-411089" data-claire-element-id="411089">53</p></td></tr><tr id="r-411098" data-claire-element-id="411098"><td id="r-411093" data-claire-element-id="411093"><p id="r-411092" data-claire-element-id="411092">%w</p></td><td id="r-411095" data-claire-element-id="411095"><p id="r-411094" data-claire-element-id="411094">Numéro du jour dans la semaine (dimanche = 0).</p></td><td id="r-411097" data-claire-element-id="411097"><p id="r-411096" data-claire-element-id="411096">2</p></td></tr><tr id="r-411105" data-claire-element-id="411105"><td id="r-411100" data-claire-element-id="411100"><p id="r-411099" data-claire-element-id="411099">%W</p></td><td id="r-411102" data-claire-element-id="411102"><p id="r-411101" data-claire-element-id="411101">Numéro de la semaine dans l'année (lundi = premier jour de la semaine).</p></td><td id="r-411104" data-claire-element-id="411104"><p id="r-411103" data-claire-element-id="411103">1</p></td></tr><tr id="r-411112" data-claire-element-id="411112"><td id="r-411107" data-claire-element-id="411107"><p id="r-411106" data-claire-element-id="411106">%x</p></td><td id="r-411109" data-claire-element-id="411109"><p id="r-411108" data-claire-element-id="411108">Affiche la date (format mm/jj/aa).</p></td><td id="r-411111" data-claire-element-id="411111"><p id="r-411110" data-claire-element-id="411110">03/20/05</p></td></tr><tr id="r-411119" data-claire-element-id="411119"><td id="r-411114" data-claire-element-id="411114"><p id="r-411113" data-claire-element-id="411113">%X</p></td><td id="r-411116" data-claire-element-id="411116"><p id="r-411115" data-claire-element-id="411115">Affiche l'heure (format hh:mm:ss).</p></td><td id="r-411118" data-claire-element-id="411118"><p id="r-411117" data-claire-element-id="411117">12:34:56</p></td></tr><tr id="r-411126" data-claire-element-id="411126"><td id="r-411121" data-claire-element-id="411121"><p id="r-411120" data-claire-element-id="411120">%Y</p></td><td id="r-411123" data-claire-element-id="411123"><p id="r-411122" data-claire-element-id="411122">L'année.</p></td><td id="r-411125" data-claire-element-id="411125"><p id="r-411124" data-claire-element-id="411124">2005</p></td></tr><tr id="r-411133" data-claire-element-id="411133"><td id="r-411128" data-claire-element-id="411128"><p id="r-411127" data-claire-element-id="411127">%y</p></td><td id="r-411130" data-claire-element-id="411130"><p id="r-411129" data-claire-element-id="411129">Les deux derniers chiffres de l'année.</p></td><td id="r-411132" data-claire-element-id="411132"><p id="r-411131" data-claire-element-id="411131">05</p></td></tr><tr id="r-411140" data-claire-element-id="411140"><td id="r-411135" data-claire-element-id="411135"><p id="r-411134" data-claire-element-id="411134">%Z</p></td><td id="r-411137" data-claire-element-id="411137"><p id="r-411136" data-claire-element-id="411136">Nom du fuseau horaire.</p></td><td id="r-411139" data-claire-element-id="411139"><p id="r-411138" data-claire-element-id="411138">Paris, Madrid</p></td></tr><tr id="r-411147" data-claire-element-id="411147"><td id="r-411142" data-claire-element-id="411142"><p id="r-411141" data-claire-element-id="411141">%%</p></td><td id="r-411144" data-claire-element-id="411144"><p id="r-411143" data-claire-element-id="411143">Affiche un « % ».</p></td><td id="r-411146" data-claire-element-id="411146"><p id="r-411145" data-claire-element-id="411145">%</p></td></tr></tbody></table><p id="r-411150" data-claire-element-id="411150">Un gros morceau mais qui vous permettra un truc assez <em>custom</em>. Vous pourrez afficher le contenu de la chaîne obtenue avec un <code data-claire-semantic="c">puts()</code> :</p><pre id="r-411151" data-claire-element-id="411151"><code data-claire-semantic="c">puts(format);</code></pre><p id="r-411152" data-claire-element-id="411152">Allez, voici une horloge pour servir d'exemple :</p><pre id="r-411153" data-claire-element-id="411153"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

int main(void)
{
    char format[128];
    time_t temps;
    struct tm date;

    // On récupère la date et l'heure actuelles.
    time(&amp;temps);
    date=*localtime(&amp;temps);

    // On remplit la chaîne avec le format choisi, puis on l'affiche.
    strftime(format, 128, &quot;%a %x\n%X %Z\n&quot;, &amp;date);
    puts(format);

    return 0;
}</code></pre><p id="r-411154" data-claire-element-id="411154">On stocke donc la mise en forme dans la chaîne « format » en accordant une longueur maximale de 128 caractères, puis l'écriture du format et l'adresse de « date » d'où seront tirées les informations.</p><pre id="r-411155" data-claire-element-id="411155"><code data-claire-semantic="console">Sun 02/27/11
22:24:32 Paris, Madrid</code></pre><p id="r-411156" data-claire-element-id="411156">Grâce à cette fonction, vous serez capable de mettre en forme vos dates avec une bonne liberté !</p><p id="r-411157" data-claire-element-id="411157">Vous savez maintenant comment gérer le temps dans vos programmes ! De nouvelles aventures vous attendent ! Datez vos sauvegardes et vos meilleurs scores ! Placez un chronomètre dans vos programmes pour forcer le joueur à se creuser les méninges pour trouver la solution à vos jeux ! Battez le record du plus long enfermement dans un carton ou faites un voyage Sydney-New York sans aucun problème ! Le temps n'a plus de secret pour vous !</p><p id="r-411158" data-claire-element-id="411158">Liens utilisés pour la rédaction du tutoriel :</p><ul id="r-411165" data-claire-element-id="411165"><li id="r-411160" data-claire-element-id="411160"><p id="r-411159" data-claire-element-id="411159"><a href="http://cplusplus.com/reference/clibrary/ctime/">documentation de time.h sur cplusplus.com</a> ;</p></li><li id="r-411162" data-claire-element-id="411162"><p id="r-411161" data-claire-element-id="411161"><a href="http://msdn.microsoft.com/en-us/library/w4ddyt9h(v=vs.71).aspx">documentation de la msdn sur la gestion du temps</a> ;</p></li><li id="r-411164" data-claire-element-id="411164"><p id="r-411163" data-claire-element-id="411163"><a href="http://fr.wikipedia.org/wiki/time.h">page Wikipédia sur time.h</a>.</p></li></ul>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions">time.h et ses fonctions</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/obtenir-une-date-et-une-heure">
Obtenir une date et une heure
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
Effectuer des manipulations avec les informations obtenues
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/afficher-l-heure-obtenue">
Afficher l&#039;heure obtenue
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/time-h-et-ses-fonctions/effectuer-des-manipulations-avec-les-informations-obtenues">
<span class="arrow"></span>
<span class="next">Effectuer des manipulations avec les informations obtenues</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/ime-h-et-ses-fonctions.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 03:38:03 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/ime-h-et-ses-fonctions.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:43:59 GMT -->
</html>