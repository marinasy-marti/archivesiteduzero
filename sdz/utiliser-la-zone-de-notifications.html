<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/utiliser-la-zone-de-notifications.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:14:19 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/utiliser-la-zone-de-notifications.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:27:43 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Utiliser la zone de notifications</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/utiliser-la-zone-de-notifications.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Utiliser la zone de notifications</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Utiliserlazonedenotifications">Utiliser la zone de notifications</a><br/><a href="#LecontrleNotifyIcon">Le contrôle NotifyIcon</a><br/><a href="#Afficherunmessage">Afficher un message</a><br/><a href="#Crerunmenu">Créer un menu</a><br/><a href="#Bonus">Bonus</a><br/></div>
<a name="Utiliserlazonedenotifications"></a><h2>Utiliser la zone de notifications</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
<span class="next">Le contrôle NotifyIcon</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<figure id="r-576979" data-claire-element-id="576980"><img id="r-576978" data-claire-element-id="576978" src="medias/uploads.siteduzero.com_files_283001_284000_283466.png" alt="Image utilisateur"/></figure><div id="r-576982" data-claire-element-id="576982" data-claire-semantic="question"><p id="r-576981" data-claire-element-id="576981">Le <em>system tray</em> ? C'est quoi, ce machin ? o_O</p></div><p id="r-576983" data-claire-element-id="576983">Mais qu'est-ce donc, le <em>system tray</em> ? Quel merveilleux procédé technologique se cache derrière ce nom barbare ?</p><p id="r-576984" data-claire-element-id="576984">Vous n'avez jamais voulu, un jour, voir votre logiciel s'afficher dans la zone de notifications ? Pouvoir enfin frimer et dire :</p><p id="r-576985" data-claire-element-id="576985"><cite>Citation : Un Zéro qui frime</cite></p><blockquote id="r-576987" data-claire-element-id="576987"><p id="r-576986" data-claire-element-id="576986">Eh ben, mon logiciel, il est dans la zone de notifications et il m'affiche une p'tite bubulle !</p></blockquote><p id="r-576988" data-claire-element-id="576988">Comme vous l'aurez compris, ce mini-tutoriel va vous permettre d'afficher votre logiciel dans la zone de notifications ! Au cas où vous ne le sauriez pas, « <em>system tray</em> » signifie « zone de notifications ». Nous aborderons aussi la méthode à utiliser pour créer des menus dans le <em>system tray</em>.</p><aside id="r-576990" data-claire-element-id="576990" data-claire-semantic="warning"><p id="r-576989" data-claire-element-id="576989">Je travaille actuellement avec Visual Basic 2010 (et Visual C# 2010) et je suis sous Windows 7, il se peut donc qu'il y ait certaines différences si vous utilisez un autre IDE ou si vous utilisez Mono sous Linux.</p></aside>
</div><a name="LecontrleNotifyIcon"></a><h2>Le contrôle NotifyIcon</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
<span class="next">Afficher un message</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-576991" data-claire-element-id="576991">Bien : comme vous l'avez compris, nous allons essayer d'afficher l'icône de notre application dans la zone de notifications. Mais où se situe-t-elle ? Afin d'être sûr que vous avez compris, nous allons tout expliquer en détail.</p><h3 id="r-le-menu-demarrer" data-claire-element-id="576996">Le menu Démarrer</h3><figure id="r-576993" data-claire-element-id="576994"><img id="r-576992" data-claire-element-id="576992" src="medias/uploads.siteduzero.com_files_256001_257000_256477.png" alt="Image utilisateur"/></figure><p id="r-576995" data-claire-element-id="576995">Le menu <em>Démarrer</em> s'ouvre en cliquant sur l'icône <em>Windows</em> (encadrée en rouge). Dans ce menu, nous pouvons ouvrir nos programmes favoris, éteindre l'ordinateur, accéder à des dossiers… Bref, le menu Windows classique.</p><h3 id="r-la-barre-des-taches-1" data-claire-element-id="577001">La barre des tâches</h3><figure id="r-576998" data-claire-element-id="576999"><img id="r-576997" data-claire-element-id="576997" src="medias/uploads.siteduzero.com_files_256001_257000_256478.png" alt="Image utilisateur"/></figure><p id="r-577000" data-claire-element-id="577000">La barre des tâches se situe en bas et au milieu de l'écran. Elle permet de classer les programmes ouverts pour faciliter leur accès.</p><h3 id="r-la-zone-de-notifications-2" data-claire-element-id="577040">La zone de notifications</h3><figure id="r-577003" data-claire-element-id="577004"><img id="r-577002" data-claire-element-id="577002" src="medias/uploads.siteduzero.com_files_256001_257000_256479.png" alt="Image utilisateur"/></figure><p id="r-577005" data-claire-element-id="577005">Et voici la fameuse zone de notifications. Dans cette zone située en bas à droite, on peut lire l'heure, la date, choisir la langue, voir l'état des programmes ouverts, cliquer sur les icônes, etc. Ces icônes pratiques permettent de cacher les fenêtres et donc de libérer de la mémoire. Maintenant que vous vous êtes familiarisé avec l'environnement Windows, nous allons pouvoir commencer à programmer !</p><h2 id="r-creation-d-un-projet-5" data-claire-element-id="577010">Création d'un projet</h2><p id="r-577006" data-claire-element-id="577006">Commencez tout d'abord par créer un nouveau projet <em>Application Windows Forms </em>que vous nommerez « NotifyZero » (voyez à quel point je me suis cassé la tête pour trouver un titre cohérent avec le nom du tutoriel :p ). Vous pouvez changer le nom du programme comme bon vous semble, mais faites attention à modifier le code que je vous donne.</p><figure id="r-577008" data-claire-element-id="577009"><img id="r-577007" data-claire-element-id="577007" src="medias/uploads.siteduzero.com_files_256001_257000_256481.png" alt="Image utilisateur"/></figure><h2 id="r-configuration-du-form" data-claire-element-id="577023">Configuration du Form</h2><p id="r-577011" data-claire-element-id="577011">Vous arrivez maintenant sur la page de design du <em>Form</em>. Ajoutez-y un bouton que vous nommerez « bt_cacher » et remplissez la propriété <em>Text</em> par « Cacher ». À présent, vous pouvez voir dans votre boîte à outils que le contrôle <em>NotifyIcon</em> est présent dans le menu <em>Contrôles communs</em> :</p><figure id="r-577013" data-claire-element-id="577014"><img id="r-577012" data-claire-element-id="577012" src="medias/uploads.siteduzero.com_files_256001_257000_256484.png" alt="Image utilisateur"/></figure><p id="r-577015" data-claire-element-id="577015">Comme vous le remarquez, le contrôle <em>NotifyIcon</em> est présent. Déplacez-le par glisser-déposer sur votre <em>Form</em>. Ce contrôle fonctionne de la même manière que les autres : la fenêtre des propriétés est bien remplie !</p><figure id="r-577017" data-claire-element-id="577018"><img id="r-577016" data-claire-element-id="577016" src="medias/uploads.siteduzero.com_files_256001_257000_256485.png" alt="Image utilisateur"/></figure><p id="r-577019" data-claire-element-id="577019">Dès que vous avez réussi à créer un contrôle <em>NotifyIcon</em>, vous n'avez plus qu'à le renommer en « not_zero ». Il ne vous reste donc plus qu'à exécuter le programme !</p><aside id="r-577021" data-claire-element-id="577021" data-claire-semantic="warning"><p id="r-577020" data-claire-element-id="577020"><em>Damned</em>, je n'ai rien dans la zone de notifications !</p></aside><p id="r-577022" data-claire-element-id="577022">C'est tout à fait normal qu'il n'y ait rien, nous n'avons pas encore configuré le contrôle.</p><h2 id="r-place-a-la-programmation" data-claire-element-id="577039">Place à la programmation</h2><p id="r-577024" data-claire-element-id="577024">Nous avons déjà oublié quelque chose de très important. Comment peut-on afficher quelque chose dans la zone de notifications alors que nous n'avons pas d'icône pour le contrôle ? Double-cliquez sur la fenêtre pour générer un événement <em>Load</em>.</p><p id="r-577025" data-claire-element-id="577025">Nous allons associer une icône à notre contrôle. Deux choix s'offrent à nous :</p><ul id="r-577030" data-claire-element-id="577030"><li id="r-577027" data-claire-element-id="577027"><p id="r-577026" data-claire-element-id="577026">utiliser l'icône de notre application ;</p></li><li id="r-577029" data-claire-element-id="577029"><p id="r-577028" data-claire-element-id="577028">utiliser une icône Windows.</p></li></ul><h3 id="r-icone-de-notre-application" data-claire-element-id="577034">Icône de notre application</h3><p id="r-577031" data-claire-element-id="577031">Gardons l'icône par défaut (les trois carrés) pour notre application. Voici comment procéder pour afficher l'icône dans la zone de notifications :</p><pre id="r-577032" data-claire-element-id="577032"><code data-claire-semantic="vbnet">Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    Me.not_zero.Icon = Me.Icon ' L'icône de not_zero est celle de l'application.

End Sub</code></pre><pre id="r-577033" data-claire-element-id="577033"><code data-claire-semantic="csharp">private void Form1_Load(object sender, EventArgs e)
{
    this.not_zero.Icon = this.Icon; // L'icône de not_zero est celle de l'application.
}</code></pre><h3 id="r-icone-de-windows" data-claire-element-id="577038">Icône de Windows</h3><p id="r-577035" data-claire-element-id="577035">Par défaut, Windows possède plusieurs icônes. À vous de choisir :</p><pre id="r-577036" data-claire-element-id="577036"><code data-claire-semantic="vbnet">Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    Me.not_zero.Icon = SystemIcons.Application ' Affiche l'icône par défaut.

    Me.not_zero.Icon = SystemIcons.Error ' Affiche l'icône d'erreur.

    Me.not_zero.Icon = SystemIcons.Warning ' Affiche l'icône de danger.

    Me.not_zero.Icon = SystemIcons.Question ' Affiche l'icône de question.

    Me.not_zero.Icon = SystemIcons.Shield ' Affiche l'icône du bouclier Windows.

End Sub</code></pre><pre id="r-577037" data-claire-element-id="577037"><code data-claire-semantic="csharp">private void Form1_Load(object sender, EventArgs e)
{
    this.not_zero.Icon = SystemIcons.Application; // Affiche l'icône par défaut.

    this.not_zero.Icon = SystemIcons.Error; // Affiche l'icône d'erreur.

    this.not_zero.Icon = SystemIcons.Warning; // Affiche l'icône de danger.

    this.not_zero.Icon = SystemIcons.Question; // Affiche l'icône de question.

    this.not_zero.Icon = SystemIcons.Shield; // Affiche l'icône du bouclier Windows.
}</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications">Utiliser la zone de notifications</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
Le contrôle NotifyIcon
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
Afficher un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
Créer un menu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/bonus-3">
Bonus
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
<span class="next">Afficher un message</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Afficherunmessage"></a><h2>Afficher un message</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
<span class="arrow"></span>
<span class="next">Le contrôle NotifyIcon</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
<span class="next">Créer un menu</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-577042" data-claire-element-id="577042">Nous avons bien notre icône dans la zone de notifications, mais comment afficher un message ? Retournez en mode design, et créez un bouton que vous nommerez « bt_message » ainsi qu'un autre que vous nommerez « bt_erreur ».<br/> Maintenant, place au code. Je vais afficher deux événements (ceux de <em>bt_message</em> et <em>bt_erreur</em>) et les remplir.</p><aside id="r-577044" data-claire-element-id="577044" data-claire-semantic="warning"><p id="r-577043" data-claire-element-id="577043">Ne copiez pas ce code tout de suite sans savoir ce que vous faites ! Attendez d'avoir lu la suite pour comprendre.</p></aside><pre id="r-577045" data-claire-element-id="577045"><code data-claire-semantic="vbnet">Private Sub bt_message_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bt_message.Click

    With not_zero

        .BalloonTipIcon = ToolTipIcon.Info ' Icône information de Windows.
        .BalloonTipTitle = &quot;NotifyZero&quot; ' Titre du message.
        .BalloonTipText = &quot;Ceci est un message de NotifyZero&quot; ' Corps du message.

    End With

    Me.not_zero.ShowBalloonTip(0) ' On affiche le message indéfiniment.

End Sub

Private Sub bt_erreur_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bt_erreur.Click

    With not_zero

        .BalloonTipIcon = ToolTipIcon.Error
        .BalloonTipTitle = &quot;NotifyZero&quot;
        .BalloonTipText = &quot;Une erreur est survenue dans NotifyZero&quot;

    End With

    Me.not_zero.ShowBalloonTip(0)

End Sub</code></pre><pre id="r-577046" data-claire-element-id="577046"><code data-claire-semantic="csharp">private void bt_message_Click(object sender, EventArgs e)
{
    this.not_zero.BalloonTipIcon = ToolTipIcon.Info; // Icône information de Windows.
    this.not_zero.BalloonTipTitle = &quot;NotifyZero&quot;; // Titre du message.
    this.not_zero.BalloonTipText = &quot;Ceci est un message de NotifyZero&quot;; // Corps du message.

    this.not_zero.ShowBalloonTip(0); // On affiche le message indéfiniment.
}

private void bt_error_Click(object sender, EventArgs e)
{
    this.not_zero.BalloonTipIcon = ToolTipIcon.Error;
    this.not_zero.BalloonTipTitle = &quot;NotifyZero&quot;;
    this.not_zero.BalloonTipText = &quot;Une erreur est survenue dans NotifyZero&quot;;

    this.not_zero.ShowBalloonTip(0);
}</code></pre><p id="r-577047" data-claire-element-id="577047">Qu'est-ce que c'est compliqué ! Décortiquons le premier <em>Sub</em>.</p><p id="r-577048" data-claire-element-id="577048">Le fameux <em>With</em> : <code data-claire-semantic="vbnet">With not_zero ... End With</code>. Vous vous en souvenez, j'espère ! Je l'ai utilisé pour éviter d'écrire <em>Me.not_zero</em> devant chaque propriété.</p><p id="r-577049" data-claire-element-id="577049">Nous allons à présent étudier les propriétés <em>Balloon</em> qui permettent de modifier l'apparence de la bulle qui s'affichera dans la zone de notifications.</p><p id="r-577050" data-claire-element-id="577050">Voici la première propriété : <code data-claire-semantic="vbnet">.BalloonTipIcon = ToolTipIcon.Info</code>. La propriété <em>.BalloonTipIcon</em> permet de modifier l'icône <strong>dans</strong> la bulle. Il existe quatre types d'icône :</p><ul id="r-577059" data-claire-element-id="577059"><li id="r-577052" data-claire-element-id="577052"><p id="r-577051" data-claire-element-id="577051"><em>.Error</em> : affiche l'icône d'erreur de Windows ;</p></li><li id="r-577054" data-claire-element-id="577054"><p id="r-577053" data-claire-element-id="577053"><em>.Info</em> : affiche l'icône d'information de Windows ;</p></li><li id="r-577056" data-claire-element-id="577056"><p id="r-577055" data-claire-element-id="577055"><em>.Warning</em> : affiche l'icône de danger de Windows ;</p></li><li id="r-577058" data-claire-element-id="577058"><p id="r-577057" data-claire-element-id="577057"><em>.None</em> : n'affiche aucune icône !</p></li></ul><aside id="r-577061" data-claire-element-id="577061" data-claire-semantic="information"><p id="r-577060" data-claire-element-id="577060">Que vous inscriviez <code data-claire-semantic="vbnet">.BalloonTipIcon = ToolTipIcon.None</code> ou rien du tout, le résultat sera identique.</p></aside><div id="r-577063" data-claire-element-id="577063" data-claire-semantic="question"><p id="r-577062" data-claire-element-id="577062">Pourquoi n'y a-t-il pas <em>.Question</em> comme dans les <em>MessageBox</em> ?</p></div><p id="r-577064" data-claire-element-id="577064">Tout simplement parce que l'utilisateur n'a pas le choix ! Une bulle sert à informer, avertir ou signaler, elle ne peut pas demander quelque chose à l'utilisateur.</p><p id="r-577065" data-claire-element-id="577065">Voyons maintenant la seconde propriété : <code data-claire-semantic="vbnet">.BalloonTipTitle = &quot;NotifyZero&quot;</code>. Cette propriété, qui est d'une difficulté extrême ( :p ), permet d'afficher un titre dans la bulle. J'ai choisi « NotifyZero ».</p><p id="r-577066" data-claire-element-id="577066">Et voici la troisième propriété, la plus difficile qui soit : <code data-claire-semantic="vbnet">.BalloonTipText = &quot;Ceci est un message de NotifyZero&quot;</code>. Vous tapez le texte de la bulle.</p><p id="r-577067" data-claire-element-id="577067">Enfin, comment fait-on pour afficher la bulle ? C'est au tour de la dernière propriété de jouer : <code data-claire-semantic="vbnet">Me.not_zero.ShowBalloonTip(0)</code>. Difficile, non ?</p><div id="r-577069" data-claire-element-id="577069" data-claire-semantic="question"><p id="r-577068" data-claire-element-id="577068">Il y a un truc qui me gêne beaucoup : c'est quoi, ce « 0 » ? Pourquoi n'affiche-t-on pas seulement « () » ?</p></div><p id="r-577070" data-claire-element-id="577070">Cette propriété permet d'afficher le temps d'exécution de la bulle en millisecondes. Par exemple, si j'entre « 5000 », la bulle restera affichée cinq secondes. J'ai mis « 0 » car, par défaut, le temps d'exécution est d'environ trois mille millisecondes.</p><p id="r-577071" data-claire-element-id="577071">Maintenant, vous comprenez le deuxième <em>Sub</em>, vous n'avez pas besoin d'explication ! Voici un petit schéma qui montre le résultat :</p><figure id="r-577073" data-claire-element-id="577074"><img id="r-577072" data-claire-element-id="577072" src="medias/uploads.siteduzero.com_files_256001_257000_256578.png" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications">Utiliser la zone de notifications</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
Le contrôle NotifyIcon
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
Afficher un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
Créer un menu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/bonus-3">
Bonus
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
<span class="arrow"></span>
<span class="next">Le contrôle NotifyIcon</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
<span class="next">Créer un menu</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Crerunmenu"></a><h2>Créer un menu</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
<span class="arrow"></span>
<span class="next">Afficher un message</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/bonus-3">
<span class="next">Bonus</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<figure id="r-577077" data-claire-element-id="577078"><img id="r-577076" data-claire-element-id="577076" src="medias/uploads.siteduzero.com_files_256001_257000_256586.png" alt="Image utilisateur"/></figure><p id="r-577079" data-claire-element-id="577079">Je vous donne un bref aperçu de ce dont vous serez capable à la fin de ce tutoriel :</p><ol id="r-577088" data-claire-element-id="577088"><li id="r-577081" data-claire-element-id="577081"><p id="r-577080" data-claire-element-id="577080">Création d'un menu.</p></li><li id="r-577083" data-claire-element-id="577083"><p id="r-577082" data-claire-element-id="577082">Ajout d'éléments additionnels (images, raccourcis…).</p></li><li id="r-577085" data-claire-element-id="577085"><p id="r-577084" data-claire-element-id="577084">Association du menu à « not_zero ».</p></li><li id="r-577087" data-claire-element-id="577087"><p id="r-577086" data-claire-element-id="577086">Programmation des événements.</p></li></ol><p id="r-577089" data-claire-element-id="577089">J'ai une bonne nouvelle : on a enfin trouvé l'utilité du contrôle <em>ContextMenuStrip</em> ! Commencez par créer un <em>ContextMenuStrip</em> que vous nommerez « mnu_notify » :</p><figure id="r-577091" data-claire-element-id="577092"><img id="r-577090" data-claire-element-id="577090" src="medias/uploads.siteduzero.com_files_256001_257000_256588.png" alt="Image utilisateur"/></figure><p id="r-577093" data-claire-element-id="577093">Maintenant, essayez de créer un menu comme celui affiché plus haut.</p><h3 id="r-afficher-une-image-5" data-claire-element-id="577102">Afficher une image</h3><p id="r-577094" data-claire-element-id="577094">Pour afficher une image à gauche de l'<em>item</em>, sélectionnez-le et cliquez sur le bouton de la propriété <em>Image</em> :</p><figure id="r-577096" data-claire-element-id="577097"><img id="r-577095" data-claire-element-id="577095" src="medias/uploads.siteduzero.com_files_256001_257000_256591.png" alt="Image utilisateur"/></figure><p id="r-577098" data-claire-element-id="577098">Cliquez ensuite sur <em>Ressource locale</em> puis sur <em>Importer</em> :</p><figure id="r-577100" data-claire-element-id="577101"><img id="r-577099" data-claire-element-id="577099" src="medias/uploads.siteduzero.com_files_256001_257000_256594.png" alt="Image utilisateur"/></figure><h3 id="r-afficher-et-utiliser-les-raccourcis-clavier" data-claire-element-id="577136">Afficher et utiliser les raccourcis clavier</h3><p id="r-577103" data-claire-element-id="577103">Veillez bien à ce que la propriété <em>ShowShortcutKeys</em> soit sur <em>True</em> puis cliquez sur la flèche dans la propriété <em>ShortcutKeys</em> :</p><figure id="r-577105" data-claire-element-id="577106"><img id="r-577104" data-claire-element-id="577104" src="medias/uploads.siteduzero.com_files_256001_257000_256598.png" alt="Image utilisateur"/></figure><p id="r-577107" data-claire-element-id="577107">Sélectionnez ensuite vos raccourcis dans la liste déroulante.</p><h2 id="r-associer-le-menu-a-not-zero" data-claire-element-id="577113">Associer le menu à not_zero</h2><p id="r-577108" data-claire-element-id="577108">Vous avez parfaitement configuré votre menu (et vous pouvez en être fier). Mais si vous exécutez le programme, par malheur, rien ne s'affiche ! Pas un petit bout de menu !<br/> Nous avons en fait oublié une étape cruciale : associer « mnu_notify » à « not_zero ». Pour ce faire, sélectionnez « not_zero » et, dans la fenêtre des propriétés, cliquez sur <em>ContextMenuStrip</em> puis choisissez « mnu_notify » :</p><figure id="r-577110" data-claire-element-id="577111"><img id="r-577109" data-claire-element-id="577109" src="medias/uploads.siteduzero.com_files_256001_257000_256606.png" alt="Image utilisateur"/></figure><p id="r-577112" data-claire-element-id="577112">Le menu s'affiche correctement quand je fais un clic gauche.</p><h2 id="r-programmer-les-evenements" data-claire-element-id="577135">Programmer les événements</h2><p id="r-577114" data-claire-element-id="577114">Avoir le menu, c'est bien, mais pouvoir l'utiliser, c'est mieux !</p><h3 id="r-quitter-3" data-claire-element-id="577121">Quitter</h3><p id="r-577115" data-claire-element-id="577115">Commençons par l'<em>item</em> « Quitter » :</p><pre id="r-577116" data-claire-element-id="577116"><code data-claire-semantic="vbnet">Private Sub FermerToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FermerToolStripMenuItem.Click

    Application.Exit() ' On quitte TOTALEMENT l'application.

End Sub</code></pre><p id="r-577117" data-claire-element-id="577117">Lorsque l'on clique sur « Quitter », on quitte l'application grâce à <code data-claire-semantic="vbnet">Application.Exit()</code>.</p><div id="r-577119" data-claire-element-id="577119" data-claire-semantic="question"><p id="r-577118" data-claire-element-id="577118">Pourquoi n'utilise-t-on pas plutôt <code data-claire-semantic="vbnet">Me.Close()</code> ?</p></div><p id="r-577120" data-claire-element-id="577120">C'est vrai, on pourrait le faire, mais <code data-claire-semantic="vbnet">Me.Close()</code> ferme seulement la fenêtre active. Pour fermer totalement et proprement l'application, je vous conseille <code data-claire-semantic="vbnet">Application.Exit()</code>.</p><h3 id="r-cacher" data-claire-element-id="577128">Cacher</h3><p id="r-577122" data-claire-element-id="577122">Lorsque l'on clique sur « Cacher », on cache la fenêtre.</p><aside id="r-577124" data-claire-element-id="577124" data-claire-semantic="warning"><p id="r-577123" data-claire-element-id="577123">On veut cacher la fenêtre, il ne faut donc pas qu'elle soit présente dans la barre des tâches !</p></aside><p id="r-577125" data-claire-element-id="577125">On va cacher la fenêtre grâce à <code data-claire-semantic="vbnet">Me.Hide()</code> :</p><pre id="r-577126" data-claire-element-id="577126"><code data-claire-semantic="vbnet">Private Sub CacherToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CacherToolStripMenuItem.Click

    Me.Hide() ' On cache la fenêtre.

End Sub</code></pre><p id="r-577127" data-claire-element-id="577127">La fenêtre est alors cachée !</p><h3 id="r-ouvrir-1" data-claire-element-id="577134">Ouvrir</h3><p id="r-577129" data-claire-element-id="577129">Grâce au dernier événement, nous allons afficher la fenêtre cachée. Comment dit-on « afficher » en anglais ?</p><pre id="r-577130" data-claire-element-id="577130"><code data-claire-semantic="vbnet">Private Sub OuvrirToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OuvrirToolStripMenuItem.Click

    Me.Show() ' On affiche la fenêtre.

End Sub</code></pre><aside id="r-577132" data-claire-element-id="577132" data-claire-semantic="information"><p id="r-577131" data-claire-element-id="577131">En C#, remplacez <code data-claire-semantic="vbnet">Me</code> par <code data-claire-semantic="csharp">this</code> et vous aurez le même résultat.</p></aside><p id="r-577133" data-claire-element-id="577133">Voilà, vous avez réussi à créer un menu dans la zone de notifications ! Sachez que vous pouvez créer des choses plus poussées, ce ne sont là que des exemples.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications">Utiliser la zone de notifications</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
Le contrôle NotifyIcon
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
Afficher un message
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
Créer un menu
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/bonus-3">
Bonus
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
<span class="arrow"></span>
<span class="next">Afficher un message</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/bonus-3">
<span class="next">Bonus</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Bonus"></a><h2>Bonus</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
<span class="arrow"></span>
<span class="next">Créer un menu</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-577138" data-claire-element-id="577138">Dans cette partie, je classe toutes les petites astuces qui peuvent vous être utiles ; si vous en avez, faites-les-moi parvenir et je me ferai une joie de vous citer !</p><h2 id="r-emettre-un-bip" data-claire-element-id="577143">Émettre un bip</h2><p id="r-577139" data-claire-element-id="577139">Vous pouvez, par exemple lorsqu'un message s'affiche, émettre un bip simple :</p><pre id="r-577140" data-claire-element-id="577140"><code data-claire-semantic="vbnet">Console.Beep() ' Joue un bip simple.</code></pre><p id="r-577141" data-claire-element-id="577141">Vous pouvez aussi modifier la durée (en millisecondes) et la fréquence (en Hz) du bip :</p><pre id="r-577142" data-claire-element-id="577142"><code data-claire-semantic="vbnet">Console.Beep(2000, 1000) ' Joue un bip d'une fréquence de 2000 Hz et d'une durée de 1 seconde.</code></pre><h2 id="r-afficher-l-heure-et-la-date" data-claire-element-id="577147">Afficher l'heure et la date</h2><p id="r-577144" data-claire-element-id="577144">Qu'y a-t-il de plus amusant que d'écrire « Coucou ! Il est 19:05:02 et nous sommes le 29/08/2010 ! » ?</p><pre id="r-577145" data-claire-element-id="577145"><code data-claire-semantic="vbnet">Private Sub bt_message_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bt_message.Click

    Dim jour As String ' On crée le jour.
    Dim heure As String ' On crée l'heure.

    jour = Date.Now.ToString(&quot;dd/MM/yyyy&quot;) ' jour = date du système.
    heure = Date.Now.ToString(&quot;HH:mm:ss&quot;) ' heure = heure du système.

    With not_zero

        .BalloonTipIcon = ToolTipIcon.Info
        .BalloonTipTitle = &quot;NotifyZero&quot;
        .BalloonTipText = &quot;Coucou ! Je me suis affiché à &quot; &amp; heure &amp; &quot; le &quot; &amp; jour &amp; &quot;.&quot; ' On affiche le jour et l'heure lorsque la bulle s'affiche.

    End With

    Me.not_zero.ShowBalloonTip(5000)

End Sub</code></pre><pre id="r-577146" data-claire-element-id="577146"><code data-claire-semantic="csharp">private void bt_message_Click(object sender, EventArgs e)
{
    string jour, heure; // On crée le jour et l'heure.

    jour = DateTime.Now.ToString(&quot;dd/MM/yyyy&quot;); // jour = date du système.
    heure = DateTime.Now.ToString(&quot;HH:mm:ss&quot;); // heure = heure du système.

    this.not_zero.BalloonTipIcon = ToolTipIcon.Info;
    this.not_zero.BalloonTipTitle = &quot;NotifyZero&quot;;
    this.not_zero.BalloonTipText = &quot;Coucou ! Je me suis affiché à &quot; + heure + &quot; le &quot; + jour + &quot;.&quot;; // On affiche le jour et l'heure lorsque la bulle s'affiche.

    this.not_zero.ShowBalloonTip(0);
}</code></pre><h2 id="r-afficher-le-nom-de-l-utilisateur" data-claire-element-id="577154">Afficher le nom de l'utilisateur</h2><p id="r-577148" data-claire-element-id="577148">Pour afficher le nom de l'utilisateur, utiliser la propriété UserName de la classe Environment :</p><pre id="r-577149" data-claire-element-id="577149"><code data-claire-semantic="vbnet">Me.not_zero.BalloonTipText = &quot;Bonjour &quot; &amp; Environment.UserName &amp; &quot; !&quot; ' On affiche le nom de l'utilisateur</code></pre><pre id="r-577150" data-claire-element-id="577150"><code data-claire-semantic="csharp">this.not_zero.BalloonTipText = &quot;Bonjour &quot; + Environment.UserName + &quot; !&quot;; // On affiche le nom de l'utilisateur</code></pre><p id="r-577151" data-claire-element-id="577151">Ainsi s'achève ce mini-tuto traitant de l'affichage de son logiciel dans le <em>system tray</em>.</p><p id="r-577152" data-claire-element-id="577152">Voyez la simplicité pour afficher un petit message en deux lignes ! J'espère donc qu'à partir de maintenant, toutes vos applications seront accompagnées d'un <em>NotifyIcon</em>.</p><p id="r-577153" data-claire-element-id="577153">Si vous aimez ce tutoriel, laissez un petit commentaire ou envoyez-moi un MP. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications">Utiliser la zone de notifications</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/le-controle-notifyicon">
Le contrôle NotifyIcon
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/afficher-un-message-2">
Afficher un message
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
Créer un menu
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/bonus-3">
Bonus
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-la-zone-de-notifications/creer-un-menu-2">
<span class="arrow"></span>
<span class="next">Créer un menu</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/utiliser-la-zone-de-notifications.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:14:55 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/utiliser-la-zone-de-notifications.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:27:46 GMT -->
</html>