<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-des-gif-animes.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:38:50 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-des-gif-animes.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:33:00 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Créer des GIF animés</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/creer-des-gif-animes.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Créer des GIF animés</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#CrerdesGIFanims">Créer des GIF animés</a><br/><a href="#Lesbases">Les bases</a><br/><a href="#Squeletteduscript">Squelette du script</a><br/><a href="#Exemples">Exemples</a><br/></div>
<a name="CrerdesGIFanims"></a><h2>Créer des GIF animés</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/les-bases-33">
<span class="next">Les bases</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-570733" data-claire-element-id="570733">La librairie GD offre de nombreuses possibilités pour manipuler vos images. Cependant, une manque cruellement : l'animation. Pourtant, vous aimeriez bien ajouter de petits effets à vos images. Mais vous avez eu beau chercher une solution, rien de bien concluant. <br/> Vous croyiez que tout était perdu ? Eh bien oui erreur : Phoenix76 est là et, ensemble, nous allons pouvoir défiger GD.</p><p id="r-570734" data-claire-element-id="570734">Prêts ? À l'attaaaaque ! :pirate:</p><aside id="r-570736" data-claire-element-id="570736" data-claire-semantic="information"><p id="r-570735" data-claire-element-id="570735">Pour bien comprendre ce tutoriel, vous devez avoir lu l'ensemble du <a href="http://www.siteduzero.com/tuto-3-4-0-un-site-dynamique-avec-php.html">tutoriel officiel sur le PHP</a>. <br/> Il y aura quelques notions que vous n'aurez certainement pas vues, mais pas de panique : elles seront toutes expliquées.</p></aside>
</div><a name="Lesbases"></a><h2>Les bases</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
<span class="next">Squelette du script</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-c-est-quoi-un-gif-anime" data-claire-element-id="570738">C'est quoi, un GIF animé ?</h2><p id="r-570737" data-claire-element-id="570737">Le GIF animé est une amélioration du format GIF, apparue en 1989. Il permet de stocker une succession d'images auxquelles est associé un temps d'affichage. Autrement dit, il permet d'obtenir une animation.</p><h2 id="r-la-classe-magique" data-claire-element-id="570744">La classe magique</h2><p id="r-570739" data-claire-element-id="570739">GD permet de créer des GIF simples : donc, si l'on suit la définition, il suffirait de « coller » plusieurs GIF entre eux pour obtenir une belle animation. Malheureusement, regrouper des images entre elles n'est pas chose facile, GD en est même incapable. Mais n'ayez crainte, <strong>László Zsidi</strong> a développé une classe comblant cette petite lacune : <strong>GIFEncoder</strong> (rendez-vous <a href="http://pastebin.com/MGfRW9AQ">ici</a> pour la télécharger).</p><aside id="r-570741" data-claire-element-id="570741" data-claire-semantic="information"><p id="r-570740" data-claire-element-id="570740">Une classe permet de créer des objets contenant un ensemble de fonctions (les méthodes) et de variables (les attributs).<br/> Ici la classe GIFEncoder permet de créer des objets « GIF animés » avec lesquels on peut interagir, via des méthodes comme GetAnimation() pour obtenir notre animation.<br/> Si vous voulez en savoir plus sur la POO et tout ce qui en découle (les classes, les méthodes...), direction <a href="http://fr.wikipedia.org/wiki/Orienté_objet">Wikipédia</a>.</p></aside><aside id="r-570743" data-claire-element-id="570743" data-claire-semantic="information"><p id="r-570742" data-claire-element-id="570742">Pour coller les GIF entre eux, GIFEncoder effectue des opérations binaires complexes sur les images. Nous n'étudierons pas cela ici, mais voici un très bon <a href="http://www.siteduzero.com/tutoriel-3-32351-introduction-aux-operateurs-de-bits.html">lien</a> traitant de ce sujet.<br/> Nous nous intéresserons seulement à l'utilisation de deux méthodes (GIFEncoder et GetAnimation) car ce sont les seules à destination de l'utilisateur.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes">Créer des GIF animés</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/les-bases-33">
Les bases
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
Squelette du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/exemples-31">
Exemples
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
<span class="next">Squelette du script</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Squeletteduscript"></a><h2>Squelette du script</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/les-bases-33">
<span class="arrow"></span>
<span class="next">Les bases</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/exemples-31">
<span class="next">Exemples</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-570746" data-claire-element-id="570746">Vous l'aurez sûrement deviné : dans cette partie, nous établirons une base pour vos futures créations.</p><p id="r-570747" data-claire-element-id="570747">Tout d'abord, on va importer notre classe :</p><pre id="r-570748" data-claire-element-id="570748"><code data-claire-semantic="html+php">&lt;?php
require('libs/gif.class.php');
?&gt;</code></pre><p id="r-570749" data-claire-element-id="570749">J'ai l'habitude de placer mes classes dans un dossier libs ; vous n'êtes pas obligés de le faire, le principal est que vous puissiez vous y retrouver.</p><p id="r-570750" data-claire-element-id="570750">Bon, maintenant, on reprend notre définition : <em>« une succession d'images auxquelles sont associé un temps d'affichage »</em>. Comment peut-on traduire ça en PHP ? Avec des tableaux, pardi. ^^</p><pre id="r-570751" data-claire-element-id="570751"><code data-claire-semantic="html+php">&lt;?php
$animation = array(); //Chaque élément de ce tableau sera une image...
$duree = array(); //...avec une durée associée
?&gt;</code></pre><p id="r-570752" data-claire-element-id="570752">On peut maintenant créer nos images :</p><pre id="r-570753" data-claire-element-id="570753"><code data-claire-semantic="html+php">&lt;?php
define('LARGEUR', X);
define('HAUTEUR', Y);

$image = imagecreate(LARGEUR, HAUTEUR);
//À vous de jouer avec les couleurs, les formes...
//On place l'image dans notre tableau animation
ob_start();
imagegif($image);
$animation[] = ob_get_clean();
$duree[] = Z; //Attention, le temps d'affichage des images s'écrit en centième de seconde, 1s = 100cs
 
//On détruit la dernière image pour libérer de la mémoire
imagedestroy($image);
?&gt;</code></pre><aside id="r-570755" data-claire-element-id="570755" data-claire-semantic="information"><p id="r-570754" data-claire-element-id="570754">Vous vous demandez sûrement à quoi servent les fonctions ob_start et ob_get_clean. Plutôt que de vous l'expliquer maintenant dans un long discours abstrait, nous verrons leur rôle dans la partie pratique. Retenez pour l'instant que les trois lignes surlignées placent notre image dans le tableau animation.</p></aside><p id="r-570756" data-claire-element-id="570756">Bon, ça avance bien, on a deux tableaux avec nos images et durées d'affichage. On n'a plus qu'à tout coller. :) <br/> Pour cela, on va utiliser la méthode GIFEncoder.<br/> Voici sa signature et la liste des paramètres :</p><pre id="r-570757" data-claire-element-id="570757"><code>GIFEncoder(array $tab, array $time, int $loops, int $disposal, int $r, int $g, int $b, string $type);


$tab : Les images

$time : Durées associées à chaque image

$loops : L'animation est jouée n fois, 0 &lt;=&gt; infini

$disposal : Si quelqu'un trouve à quoi ça sert...

$r, $g, $b : Permettent d'ajouter de la couleur à des GIF transparents suivant le codage rgb

$type :
        'bin' -&gt; $tab contient des images générées par gd
        'url' -&gt; $tab contient des url vers des fichiers de type image</code></pre><p id="r-570758" data-claire-element-id="570758">Ces paramètres sont tous obligatoires, voici la méthode par défaut :</p><pre id="r-570759" data-claire-element-id="570759"><code data-claire-semantic="html+php">&lt;?php
$gif = new GIFEncoder($animation, $duree, 0, 2, 0, 0, 0, 'bin');
?&gt;</code></pre><p id="r-570760" data-claire-element-id="570760">L'objet gif contient désormais notre animation. Il nous reste à afficher l'image ou à l'enregistrer. Pour ce faire, on va utiliser une autre méthode de notre classe : GetAnimation. Elle retourne notre image sous forme de <strong>chaîne de caractères</strong>.</p><p id="r-570761" data-claire-element-id="570761">Donc, pour afficher, on fait :</p><pre id="r-570762" data-claire-element-id="570762"><code data-claire-semantic="html+php">&lt;?php
header('Content-type: image/gif'); //Indique au navigateur que l'on veut afficher une image GIF et non pas des caractères
echo $gif-&gt;GetAnimation();
?&gt;</code></pre><p id="r-570763" data-claire-element-id="570763">Et pour enregistrer :</p><pre id="r-570764" data-claire-element-id="570764"><code data-claire-semantic="html+php">&lt;?php
$fichier = fopen(IMAGE, 'w+');
fputs($fichier, $gif-&gt;GetAnimation());
fclose($fichier);
?&gt;</code></pre><h3 id="r-notre-squelette-finalise" data-claire-element-id="570766">Notre squelette finalisé</h3><pre id="r-570765" data-claire-element-id="570765"><code data-claire-semantic="html+php">&lt;?php
require('libs/gif.class.php');

define('LARGEUR', X);
define('HAUTEUR', Y);

$animation = array(); //Chaque élément de ce tableau sera une image...
$duree = array(); //...avec une durée associée
 
//On crée les différentes images de l'animation et on définit leur temps d'affichage
$image = imagecreate(LARGEUR, HAUTEUR);
ob_start();
imagegif($image);
$animation[] = ob_get_clean();
$duree[] = Z; //Attention, le temps d'affichage des images s'écrit en centième de seconde, 1s = 100cs.
 
//On détruit la dernière image pour libérer de la mémoire
imagedestroy($image);
 
//On crée le GIF à partir de l'animation.
$gif = new GIFEncoder($animation, $duree, 0, 2, 0, 0, 0, 'bin');
 
//On affiche 
header('Content-type: image/gif'); //Indique au navigateur qu'on veut afficher une image GIF et non pas des caractères
echo $gif-&gt;GetAnimation();
 
//Ou on enregistre
$fichier = fopen(IMAGE, 'w+');
fputs($fichier, $gif-&gt;GetAnimation());
fclose($fichier);
?&gt;</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes">Créer des GIF animés</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/les-bases-33">
Les bases
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
Squelette du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/exemples-31">
Exemples
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/les-bases-33">
<span class="arrow"></span>
<span class="next">Les bases</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/exemples-31">
<span class="next">Exemples</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Exemples"></a><h2>Exemples</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
<span class="arrow"></span>
<span class="next">Squelette du script</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-une-banniere-1" data-claire-element-id="570801">Une bannière</h2><p id="r-570768" data-claire-element-id="570768">Objectif : Appliquer le script précédent.</p><p id="r-570769" data-claire-element-id="570769">Aperçu :</p><figure id="r-570771" data-claire-element-id="570772"><img id="r-570770" data-claire-element-id="570770" src="medias/uploads.siteduzero.com_files_102001_103000_102935.gif" alt="Image utilisateur"/></figure><p id="r-570773" data-claire-element-id="570773">Comme vous pouvez le constater, cette animation est moche, inutile et réalisable en 10s composée de deux images : l'une de fond rouge, l'autre de fond bleu avec un texte identique de couleur blanche. Le temps d'affichage des images est de 1 seconde.</p><p id="r-570774" data-claire-element-id="570774">Première chose à faire : on reprend notre squelette.<br/> Ensuite, on définit un message et des dimensions qui lui sont adaptées :</p><pre id="r-570775" data-claire-element-id="570775"><code data-claire-semantic="html+php">&lt;?php
define('LARGEUR', 210);
define('HAUTEUR', 25);
$message = 'Mon premier gif en php';
?&gt;</code></pre><p id="r-570776" data-claire-element-id="570776">On peut maintenant passer à la création de la première image :</p><pre id="r-570777" data-claire-element-id="570777"><code data-claire-semantic="html+php">&lt;?php
$image = imagecreate(LARGEUR, HAUTEUR);
$fond = imagecolorallocate($image, 255, 0, 0);
$blanc = imagecolorallocate($image, 255, 255, 255);
imagestring($image, 5, 5, 5, $message, $blanc);
ob_start();
imagegif($image);
$animation[] = ob_get_clean();
$duree[] = 100; //Attention, le temps d'affichage des images s'écrit en centième de seconde, 1s = 100cs
imagedestroy($image);
?&gt;</code></pre><p id="r-570778" data-claire-element-id="570778">Si vous ne comprenez pas tout, allez revoir le <a href="http://www.siteduzero.com/tuto-3-166-1-creer-des-images-en-php.html">cours sur GD</a>. <br/> Je vous laisse le soin de créer la deuxième image.<br/> Vous avez fini ? Bien : vous devriez avoir quelque chose qui ressemble à ceci :</p><p id="r-570779" data-claire-element-id="570779"></p><div id="r-570781" data-claire-element-id="570781"><pre id="r-570780" data-claire-element-id="570780"><code data-claire-semantic="html+php">&lt;?php
require('libs/gif.class.php');
$animation = array();
$duree = array();
 
define('LARGEUR', 210);
define('HAUTEUR', 25);
$message = 'Mon premier gif en php';

$blanc = imagecolorallocate($image, 255, 255, 255);
 
$image = imagecreate(LARGEUR, HAUTEUR);
$fond = imagecolorallocate($image, 255, 0, 0);
imagestring($image, 5, 5, 5, $message, $blanc);
ob_start();
imagegif($image);
$animation[] = ob_get_clean();
$duree[] = 100;
imagedestroy($image);
 
$image = imagecreate(LARGEUR, HAUTEUR);
$fond = imagecolorallocate($image, 0, 0, 255);
imagestring($image, 5, 5, 5, $message, $blanc);
ob_start();
imagegif($image);
$animation[] = ob_get_clean();
$duree[] = 100;
imagedestroy($image);
 
$gif = new GIFEncoder($animation, $duree, 0, 2, 0, 0, 0, 'bin');
header (&quot;Content-type: image/gif&quot;);
echo $gif-&gt;GetAnimation();
?&gt;</code></pre></div><p id="r-570782" data-claire-element-id="570782">Et voilà : normalement, une belle image s'affiche sous vos yeux ébahis. Nous pouvons maintenant passer à la seconde partie.</p><div id="r-570784" data-claire-element-id="570784" data-claire-semantic="question"><p id="r-570783" data-claire-element-id="570783">Hé minute, tu ne nous as toujours pas expliqué à quoi servait ob_start et ob_get_clean !</p></div><p id="r-570785" data-claire-element-id="570785">Ah oui, quel étourdi ! :p <br/> Bon, comme l'apprentissage passe par la pratique, enlevez-moi ces deux fonctions :</p><pre id="r-570786" data-claire-element-id="570786"><code data-claire-semantic="html+php">&lt;?php
ob_start();
imagegif($image);
$animation[] = ob_get_clean();
?&gt;</code></pre><p id="r-570787" data-claire-element-id="570787">Cela devient :</p><pre id="r-570788" data-claire-element-id="570788"><code data-claire-semantic="html+php">&lt;?php
$animation[] = imagegif($image);
?&gt;</code></pre><p id="r-570789" data-claire-element-id="570789">Actualisez votre page et... un tas de caractères bizarres apparaissent. Ne vous inquiétez pas, c'est normal.<br/> Lorsque vous exécutez la fonction <a href="http://fr3.php.net/manual/fr/function.imagegif.php">imagegif</a>, celle-ci crée l'image voulue, l'affiche sous forme d'une chaîne de caractères et retourne un booléen pour savoir si tout s'est bien passé.<br/> Ainsi, dans le deuxième code, vous affichez votre image (les caractères louches) et vous créez un tableau de booléen. C'est bien, mais nous, on veut récupérer la chaîne pour l'insérer dans le tableau.</p><p id="r-570790" data-claire-element-id="570790">Dans cet objectif, on va utiliser un tampon. Cette chose énigmatique cache un fabuleux pouvoir d'absorption. En effet, de son ouverture à sa fermeture, il capte une quantité incroyable de flux de toutes les couleurs, mais sans jamais les afficher.<br/> La fonction <a href="http://fr3.php.net/manual/fr/function.ob-start.php">ob_start</a> crée le tampon. Puis on exécute <a href="http://fr3.php.net/manual/fr/function.imagegif.php">imagegif</a> ; le tampon enregistre la chaîne qu'elle affiche (notre image). Enfin, on vide le tampon dans notre tableau.<br/> Bon, je ne vous fais pas de dessin, j'espère avoir été suffisamment clair. :-°</p><h3 id="r-exercices-supplementaires-par-ordre-de-difficulte-croissante" data-claire-element-id="570800">Exercices supplémentaires (par ordre de difficulté croissante)</h3><ul id="r-570799" data-claire-element-id="570799"><li id="r-570792" data-claire-element-id="570792"><p id="r-570791" data-claire-element-id="570791">Au lieu de créer des images, importez-les (utilisez le paramètre 'url').</p></li><li id="r-570794" data-claire-element-id="570794"><p id="r-570793" data-claire-element-id="570793">Ajoutez une image avec un fond vert et un texte en orange.</p></li><li id="r-570796" data-claire-element-id="570796"><p id="r-570795" data-claire-element-id="570795">Donnez un texte différent à chaque image en adaptant sa taille.</p></li><li id="r-570798" data-claire-element-id="570798"><p id="r-570797" data-claire-element-id="570797">Déplacez votre texte d'un coin à un autre.</p></li></ul><h2 id="r-un-flux-rss-en-image" data-claire-element-id="570829">Un flux RSS en image</h2><p id="r-570802" data-claire-element-id="570802">Objectif : réaliser une image pour indiquer sur les forums les dernières news de son site.</p><p id="r-570803" data-claire-element-id="570803">Aperçu :</p><figure id="r-570805" data-claire-element-id="570806"><img id="r-570804" data-claire-element-id="570804" src="medias/uploads.siteduzero.com_files_111001_112000_111939.gif" alt="Image utilisateur"/></figure><p id="r-570807" data-claire-element-id="570807">Pour cette partie, je vais vous donner quelques indications et ce sera à vous de jouer.<br/> Tout d'abord, récupérez <a href="medias/uploads.siteduzero.com_files_111001_112000_111940.png">l'image d'arrière-plan</a> (généreusement fournie par <a href="http://www.siteduzero.com/membres-294-26262.html">Jerry Wham</a>), ou créez votre propre image.<br/> Pour que tout le monde ait la même base, créez une nouvelle table :</p><pre id="r-570808" data-claire-element-id="570808"><code data-claire-semantic="sql">CREATE TABLE IF NOT EXISTS `news_gif` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `titre` varchar(100) NOT NULL,
  `timestamp` int(11) NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `id` (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;
 
INSERT INTO `news_gif` (`id`, `titre`, `timestamp`) VALUES
(1, 'Ouverture du site', 1171298713),
(2, 'Ouverture forum', 1172191293),
(3, 'Test fil rss', 1203603483);</code></pre><p id="r-570809" data-claire-element-id="570809">Pour l'effet « machine à écrire », vous aurez besoin de la fonction <a href="http://fr2.php.net/str_split">str_split</a>. <br/> Si vous n'avez pas php5, vous pouvez la remplacer par : preg_split('//', string, -1, PREG_SPLIT_NO_EMPTY).</p><p id="r-570810" data-claire-element-id="570810">N'oubliez pas d'indiquer la date de la dernière modification.</p><p id="r-570811" data-claire-element-id="570811">Placez votre code dans une fonction car, à chaque ajout / modification / suppression de news, il faudra mettre l'image à jour, et ce serait bête de réécrire trois fois le même code.</p><p id="r-570812" data-claire-element-id="570812">Je vous ai tout dit : à vous de jouer.</p><p id="r-570813" data-claire-element-id="570813"><strong>Correction :</strong></p><p id="r-570814" data-claire-element-id="570814"></p><div id="r-570816" data-claire-element-id="570816"><pre id="r-570815" data-claire-element-id="570815"><code data-claire-semantic="html+php">&lt;?php
function creer_gif_rss()
{
        require('libs/connexion.php'); //Fichier de connexion à la bdd
        require('libs/gif.class.php');

        $animation = array();
        $duree = array();
        
        $retour = mysql_query('SELECT titre, timestamp FROM news_gif ORDER BY id DESC LIMIT 0, 1') or die(mysql_error()); //Sélectionne le dernier article
        $donnees = mysql_fetch_array($retour);

	/* La chaîne correspondra au dernier titre du blog.
	 * L'espace blanc crée une image vide afin de rendre l'animation plus fluide (essayez de l'enlever).
	 */

        $chaine = ' '.$donnees['titre'];
        $taille_chaine = strlen($chaine);
        $chaine = str_split($chaine); //Transforme la chaîne en tableau.

        $image = imagecreatefrompng('fond_rss.png'); //Notre joli fond :p
        
        $fond = imagecolorallocate($image, 249, 249, 249);
        $bleu = imagecolorallocate($image, 0, 0, 255);
        $noir = imagecolorallocate($image, 9, 9, 9);
        
        imagestring($image, 5, 120, 5, &quot;Bob's home&quot;, $bleu); //Un petit titre
        imagestring($image, 3, 70, 40, 'Le '.date('d/m/Y \a H\hi', $donnees['timestamp']), $noir); //Affiche la date de la dernière modification sur l'article
        
        foreach($chaine as $i =&gt; $carac) //Pour chaque lettre de la chaîne, on crée une nouvelle image
        {
                $txt .= $carac; //On affiche jusqu'au caractère actuel
                imagestring($image, 4, 60, 23, $txt, $noir);
        
                ob_start(); //Je ne vous explique pas : vous devriez avoir compris ^^
                imagegif($image);
                $animation[] = ob_get_clean();
        
		if($i == 0) //Pause lorsque rien ne s'est affiché (plus esthétique)
			$duree[] = 45;
		else if($i+1 == $taille_chaine) //Si on est à la fin de la chaîne, on marque une pause
                        $duree[] = 200;
                else
                        $duree[] = 15;
        }
        imagedestroy($image); //On détruit l'image pour libérer de la mémoire
        
        $gif = new GIFEncoder($animation, $duree, 0, 2, 0, 0, 0, 'bin'); //On génère l'animation
        $fichier = fopen(IMAGE, 'w+');
        fputs($fichier, $gif-&gt;GetAnimation()); //On enregistre
        fclose($fichier);
}
?&gt;</code></pre></div><p id="r-570817" data-claire-element-id="570817">Et voilà, notre fonction est terminée ; vous pouvez vérifier qu'elle effectue bien son travail en éditant votre table. ;)</p><h3 id="r-exercices-supplementaires-par-ordre-de-difficulte-croissante-1" data-claire-element-id="570828">Exercices supplémentaires (par ordre de difficulté croissante)</h3><ul id="r-570826" data-claire-element-id="570826"><li id="r-570819" data-claire-element-id="570819"><p id="r-570818" data-claire-element-id="570818">Écrivez le titre de la droite vers la gauche.</p></li><li id="r-570821" data-claire-element-id="570821"><p id="r-570820" data-claire-element-id="570820">Faites varier la durée entre l'affichage des différentes lettres pour améliorer l'effet « machine à écrire ».</p></li><li id="r-570823" data-claire-element-id="570823"><p id="r-570822" data-claire-element-id="570822">Créez un effet de disparition lorsque le titre est affiché en entier.</p></li><li id="r-570825" data-claire-element-id="570825"><p id="r-570824" data-claire-element-id="570824">Modifiez la fonction pour pouvoir afficher les trois dernières news et leur date de création.</p></li></ul><p id="r-570827" data-claire-element-id="570827">Vous voici arrivés à la fin de ce tutoriel : vous êtes désormais capables de créer de beaux GIF animés. Attention ! <strong>Restez dans la sobriété</strong> : c'est toujours très désagréable d'assister à un feu d'artifice sur une page Web.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes">Créer des GIF animés</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/les-bases-33">
Les bases
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
Squelette du script
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/exemples-31">
Exemples
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-des-gif-animes/squelette-du-script">
<span class="arrow"></span>
<span class="next">Squelette du script</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-des-gif-animes.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:38:51 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-des-gif-animes.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:33:01 GMT -->
</html>