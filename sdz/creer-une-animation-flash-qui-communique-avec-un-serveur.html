<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-une-animation-flash-qui-communique-avec-un-serveur.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:27:32 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-une-animation-flash-qui-communique-avec-un-serveur.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:07:52 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Créer une animation flash qui communique avec un serveur</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Créer une animation flash qui communique avec un serveur</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Creruneanimationflashquicommuniqueavecunserveur">Créer une animation flash qui communique avec un serveur</a><br/><a href="#XMLSocketqu039est-cequec039est">XMLSocket : qu&#039;est-ce que c&#039;est ?</a><br/><a href="#Connexionauserveur">Connexion au serveur</a><br/><a href="#Envoi_rceptiondedonnes">Envoi / réception de données</a><br/></div>
<a name="Creruneanimationflashquicommuniqueavecunserveur"></a><h2>Créer une animation flash qui communique avec un serveur</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/xmlsocket-qu-est-ce-que-c-est">
<span class="next">XMLSocket : qu&#039;est-ce que c&#039;est ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-584053" data-claire-element-id="584053">Bonjour à tous. :)</p><p id="r-584054" data-claire-element-id="584054">Pour commencer, je dois vous prévenir que pour lire ce tutoriel, il faut des connaissances en AS (ActionScript) 2.0. Si vous voulez l'apprendre, un tuto a déjà été créé : <a href="http://www.siteduzero.com/tuto-3-276-0-introduction-a-l-actionscript.html">Tuto AS 2.0</a>.</p><p id="r-584055" data-claire-element-id="584055">Si vous avez ces connaissances, ce tuto devrait être très simple ou tout du moins, pas très compliqué.</p>
</div><a name="XMLSocketqu039est-cequec039est"></a><h2>XMLSocket : qu&#039;est-ce que c&#039;est ?</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
<span class="next">Connexion au serveur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-584056" data-claire-element-id="584056">XMLSocket permet de faire dialoguer plusieurs animations (ici, des animations Flash).<br/> Ces animations vont envoyer des données au serveur qui sera chargé de les renvoyer aux autres.</p><p id="r-584057" data-claire-element-id="584057">Animation 1 envoie : &quot;je suis l'anim 1&quot;</p><p id="r-584058" data-claire-element-id="584058">Animation 1 reçoit &gt; &quot;je suis l'anim 1&quot;<br/> Animation 2 reçoit &gt; &quot;je suis l'anim 1&quot;<br/> Animation 3 reçoit &gt; &quot;je suis l'anim 1&quot;<br/> Animation 4 reçoit &gt; &quot;je suis l'anim 1&quot;<br/> Animation X reçoit &gt; &quot;je suis l'anim 1&quot;<br/> Etc.</p><p id="r-584059" data-claire-element-id="584059">Si vous avez bien compris comment étaient réparties les données, la suite ne devrait pas poser de problèmes.</p><div id="r-584061" data-claire-element-id="584061" data-claire-semantic="question"><p id="r-584060" data-claire-element-id="584060">Un serveur ? Quel serveur ?</p></div><p id="r-584062" data-claire-element-id="584062">Il existe beaucoup de serveurs XMLSocket : personnellement, j'utilise AquaServer, que vous pouvez télécharger <a href="http://www.worldlegend.fr/oly/flash/aqua.zip">ICI</a>.<br/> Ou bien vous pouvez en choisir un autre, il n'y a aucune différence pour la partie du code.</p><p id="r-584063" data-claire-element-id="584063">Si vous avez choisi AquaServer, il suffit d'ouvrir le répertoire <em>server</em> et de lancer le fichier lance.bat. Une fenêtre va s'ouvrir et vous indiquer quel port le serveur écoute.</p><p id="r-584064" data-claire-element-id="584064">Vous avez deux commandes :</p><ul id="r-584069" data-claire-element-id="584069"><li id="r-584066" data-claire-element-id="584066"><p id="r-584065" data-claire-element-id="584065"><strong>List</strong> : affiche la liste des clients connectés au serveur ;</p></li><li id="r-584068" data-claire-element-id="584068"><p id="r-584067" data-claire-element-id="584067"><strong>Quit</strong> : arrête le serveur.</p></li></ul>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur">Créer une animation flash qui communique avec un serveur</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/xmlsocket-qu-est-ce-que-c-est">
XMLSocket : qu&#039;est-ce que c&#039;est ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
Connexion au serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/envoi-reception-de-donnees">
Envoi / réception de données
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
<span class="next">Connexion au serveur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Connexionauserveur"></a><h2>Connexion au serveur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/xmlsocket-qu-est-ce-que-c-est">
<span class="arrow"></span>
<span class="next">XMLSocket : qu&#039;est-ce que c&#039;est ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/envoi-reception-de-donnees">
<span class="next">Envoi / réception de données</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-584071" data-claire-element-id="584071">Maintenant, nous allons nous occuper du code.</p><p id="r-584072" data-claire-element-id="584072">Pour vous connecter au serveur, il vous faut créer un objet XMLSocket, comme ceci :</p><pre id="r-584073" data-claire-element-id="584073"><code data-claire-semantic="actionscript">var serveur:XMLSocket = new XMLSocket();</code></pre><p id="r-584074" data-claire-element-id="584074">C'est cet objet qui va nous servir pour communiquer avec le serveur.</p><h3 id="r-connexion-10" data-claire-element-id="584088">Connexion</h3><p id="r-584075" data-claire-element-id="584075">Pour vous connecter au serveur, il va vous falloir deux choses :</p><ul id="r-584080" data-claire-element-id="584080"><li id="r-584077" data-claire-element-id="584077"><p id="r-584076" data-claire-element-id="584076">l'adresse IP du serveur ;</p></li><li id="r-584079" data-claire-element-id="584079"><p id="r-584078" data-claire-element-id="584078">le port écouté par le serveur.</p></li></ul><p id="r-584081" data-claire-element-id="584081">Si le serveur est lancé sur votre PC et si l'animation est elle aussi sur ce PC, l'adresse IP à fournir sera alors 127.0.0.1 (l'adresse IP locale).<br/> Si vous avez choisi AquaServer, il y a de grandes chances pour que le port soit 1024, sinon regardez sur le serveur : il devrait vous l'indiquer.</p><p id="r-584082" data-claire-element-id="584082">À présent, le code :</p><pre id="r-584083" data-claire-element-id="584083"><code data-claire-semantic="actionscript">serveur.connect(&quot;127.0.0.1&quot;,1024);</code></pre><p id="r-584084" data-claire-element-id="584084">Si vous aviez des informations différentes, il suffit de modifier les paramètres envoyés.</p><p id="r-584085" data-claire-element-id="584085">Il va maintenant falloir vérifier si la connexion a bien été établie. Pour cela, on utilise le gestionnaire d'évènement onConnect.</p><pre id="r-584086" data-claire-element-id="584086"><code data-claire-semantic="actionscript">serveur.onConnect = function(etat) // la variable etat va nous dire si la connexion s'est terminée avec succès
{

if(etat) // Si la connexion a été établie 
{ 
  trace(&quot;Connexion établie&quot;);
}else{
  trace(&quot;Erreur de connexion&quot;);
}

};</code></pre><p id="r-584087" data-claire-element-id="584087">À partir de maintenant, il vous suffit de connaître deux fonctions et vous serez à même de créer un <em>chat</em> en Flash ! <br/> (Je sais, je ne suis pas très original, mais c'est le plus simple.)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur">Créer une animation flash qui communique avec un serveur</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/xmlsocket-qu-est-ce-que-c-est">
XMLSocket : qu&#039;est-ce que c&#039;est ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
Connexion au serveur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/envoi-reception-de-donnees">
Envoi / réception de données
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/xmlsocket-qu-est-ce-que-c-est">
<span class="arrow"></span>
<span class="next">XMLSocket : qu&#039;est-ce que c&#039;est ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/envoi-reception-de-donnees">
<span class="next">Envoi / réception de données</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Envoi_rceptiondedonnes"></a><h2>Envoi / réception de données</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
<span class="arrow"></span>
<span class="next">Connexion au serveur</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h3 id="r-envoi" data-claire-element-id="584096">Envoi</h3><p id="r-584090" data-claire-element-id="584090">Pour envoyer des données au serveur XMLSocket sous forme de chaînes de caractères, il vous suffit d'utiliser une méthode simple de la classe XMLSocket : send.</p><p id="r-584091" data-claire-element-id="584091">Imaginons pour notre <em>chat</em> un message tout simple :</p><pre id="r-584092" data-claire-element-id="584092"><code data-claire-semantic="actionscript">var msg:String = &quot;Vive le SdZ !&quot;;?
serveur.send(msg);</code></pre><div id="r-584094" data-claire-element-id="584094" data-claire-semantic="question"><p id="r-584093" data-claire-element-id="584093">C'est aussi simple que ça ?</p></div><p id="r-584095" data-claire-element-id="584095">Oui, et on ne va pas s'en plaindre car la réception est un tout petit peu plus complexe, mais sans grandes difficultés.</p><h3 id="r-reception" data-claire-element-id="584108">Réception</h3><p id="r-584097" data-claire-element-id="584097">La réception est, elle, un tout petit peu plus compliquée.<br/> On va commencer par un code erroné, pour finalement mieux comprendre le fonctionnement.</p><p id="r-584098" data-claire-element-id="584098">Pour la réception, on utilise un gestionnaire d'évènement : onData.</p><pre id="r-584099" data-claire-element-id="584099"><code data-claire-semantic="actionscript">serveur.onData = function(msg_recu)
{

 trace(msg_recu);

}</code></pre><p id="r-584100" data-claire-element-id="584100">Maintenant, créez deux animations, les deux se connectent au même serveur, l'une envoie des messages tandis que l'autre les réceptionne et les affiche.</p><p id="r-584101" data-claire-element-id="584101">... et là, malheur ! Ça ne fonctionne pas !</p><div id="r-584103" data-claire-element-id="584103" data-claire-semantic="question"><p id="r-584102" data-claire-element-id="584102">Pourquoi ?</p></div><p id="r-584104" data-claire-element-id="584104">Parce que onData vérifie à l'instant même si des messages ont été envoyés par le serveur : sinon il ne fait rien, une fois exécuté, il ne vérifie plus l'arrivée des données.</p><div id="r-584106" data-claire-element-id="584106" data-claire-semantic="question"><p id="r-584105" data-claire-element-id="584105">Comment faire pour remédier à ça ?</p></div><p id="r-584107" data-claire-element-id="584107">C'est tout simple, on va l'appeler à chaque frame.</p><h3 id="r-code-complet-15" data-claire-element-id="584112"><em>Code complet</em></h3><pre id="r-584109" data-claire-element-id="584109"><code data-claire-semantic="actionscript">var serveur:XMLSocket = new XMLSocket();

serveur.connect(&quot;127.0.0.1&quot;,1024) // Connexion au &lt;italique&gt;serveur&lt;/italique&gt;

serveur.onConnect = function(etat)
{
 if(etat)
 {
  _root.onEnterFrame = function()
  {
    serveur.onData = function(msg_recu)
    {
    
     trace(msg_recu);

    }
  };
 
  }else{
 
    trace(&quot;Erreur lors de la connexion avec le serveur&quot;);
  }
 
};</code></pre><p id="r-584110" data-claire-element-id="584110">Voilà : vous savez tout ; maintenant, à la pratique !</p><p id="r-584111" data-claire-element-id="584111">Le tuto est fini mais qui sait... ^^</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur">Créer une animation flash qui communique avec un serveur</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/xmlsocket-qu-est-ce-que-c-est">
XMLSocket : qu&#039;est-ce que c&#039;est ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
Connexion au serveur
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/envoi-reception-de-donnees">
Envoi / réception de données
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creer-une-animation-flash-qui-communique-avec-un-serveur/connexion-au-serveur">
<span class="arrow"></span>
<span class="next">Connexion au serveur</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/creer-une-animation-flash-qui-communique-avec-un-serveur.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:27:32 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creer-une-animation-flash-qui-communique-avec-un-serveur.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:07:53 GMT -->
</html>