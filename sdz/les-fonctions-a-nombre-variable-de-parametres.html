<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/les-fonctions-a-nombre-variable-de-parametres.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 11:05:28 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-fonctions-a-nombre-variable-de-parametres.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:47:24 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Les fonctions à nombre variable de paramètres</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Les fonctions à nombre variable de paramètres</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Lesfonctionsnombrevariabledeparamtres">Les fonctions à nombre variable de paramètres</a><br/><a href="#Prototypeetappeldelafonction">Prototype et appel de la fonction</a><br/><a href="#Contenudelafonction">Contenu de la fonction</a><br/><a href="#Exercices">Exercices</a><br/></div>
<a name="Lesfonctionsnombrevariabledeparamtres"></a><h2>Les fonctions à nombre variable de paramètres</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/prototype-et-appel-de-la-fonction">
<span class="next">Prototype et appel de la fonction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-346010" data-claire-element-id="346010">Bonjour à tous ! Soyez les bienvenus dans ce tutoriel sur les fonctions à nombre variable de paramètres.</p><div id="r-346012" data-claire-element-id="346012" data-claire-semantic="question"><p id="r-346011" data-claire-element-id="346011">Que sont les fonctions à nombre variable de paramètres ?</p></div><p id="r-346013" data-claire-element-id="346013">Eh bien ce sont des fonctions dont le nombre de paramètres n'est pas fixé dans leurs prototypes. Ainsi, on peut envoyer plus ou moins de paramètres à ces fonctions selon les circonstances :waw: . Et ces fonctions peuvent s'avérer très utiles lorsqu'on les connaît !</p><p id="r-346014" data-claire-element-id="346014">Les pré-requis sont : maîtriser le cours de <a href="http://www.siteduzero.com/tuto-3-8-0-apprenez-a-programmer-en-c.html">C de M@teo21</a> jusqu'au <strong>chapitre 7 de la partie 2</strong>.</p><aside id="r-346016" data-claire-element-id="346016" data-claire-semantic="information"><p id="r-346015" data-claire-element-id="346015">Derrière le nom barbare :diable: de 'fonction à nombre variable de paramètres' se cache une notion relativement simple, et très agréable à utiliser, rassurez-vous ^^ .</p></aside>
</div><a name="Prototypeetappeldelafonction"></a><h2>Prototype et appel de la fonction</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
<span class="next">Contenu de la fonction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-parametres-et-prototype" data-claire-element-id="346033">Paramètres et prototype</h2><p id="r-346017" data-claire-element-id="346017">Une fonction à nombre variable de paramètres (fonction <em>variadic</em>) contiendra deux types de paramètres :</p><ul id="r-346022" data-claire-element-id="346022"><li id="r-346019" data-claire-element-id="346019"><p id="r-346018" data-claire-element-id="346018">les paramètres obligatoires,</p></li><li id="r-346021" data-claire-element-id="346021"><p id="r-346020" data-claire-element-id="346020">les paramètres optionnels.</p></li></ul><p id="r-346023" data-claire-element-id="346023">Je vous présente donc ces paramètres sans plus tarder :magicien: .</p><h3 id="r-parametres-obligatoires" data-claire-element-id="346025">Paramètres obligatoires</h3><p id="r-346024" data-claire-element-id="346024">Les paramètres obligatoires sont comparables aux paramètres d'une fonction classique (en C) : ils devront toujours être appelés lors de l'utilisation de la fonction. Une fonction à nombre variable de paramètres doit contenir <strong>un paramètre obligatoire ou plus</strong>.</p><h3 id="r-parametres-optionnels" data-claire-element-id="346028">Paramètres optionnels</h3><p id="r-346026" data-claire-element-id="346026">Les paramètres optionnels sont ceux qui font l'intérêt de la fonction... On pourra en envoyer 0, 1, 2, 40 ou 100 000 à la même fonction selon les circonstances. Du fait que l'on ne peut pas déclarer chaque paramètre dans le prototype, on déclarera seulement la présence de paramètres optionnels grâce à une <em>&quot;ellipse&quot;</em> :</p><pre id="r-346027" data-claire-element-id="346027"><code data-claire-semantic="c">... // 3 points sans espace entre eux (ellipse)</code></pre><h3 id="r-prototype-de-la-fonction" data-claire-element-id="346032">Prototype de la fonction</h3><p id="r-346029" data-claire-element-id="346029">Maintenant que l'on a vu les paramètres obligatoires et optionnels, rassemblons les deux :p !</p><p id="r-346030" data-claire-element-id="346030">On mettra d'abord le(s) paramètre(s) obligatoire(s), et ensuite les paramètres optionnels. C'est la seule particularité du prototype d'une fonction à nombre variable de paramètres. On a donc un prototype du type :</p><pre id="r-346031" data-claire-element-id="346031"><code data-claire-semantic="c">type nomFonction(int parametreA, ...);
type nomFonction(int parametreA, int parametreB, ...);</code></pre><h2 id="r-un-petit-probleme-vraiment-genant" data-claire-element-id="346053">Un petit problème vraiment gênant...</h2><p id="r-346034" data-claire-element-id="346034">Voici ce qui va se passer lorsque votre ordinateur va obtenir les paramètres optionnels :</p><ul id="r-346041" data-claire-element-id="346041"><li id="r-346036" data-claire-element-id="346036"><p id="r-346035" data-claire-element-id="346035">obtention du premier paramètre optionnel, puis action(s) sur ce paramètre,</p></li><li id="r-346038" data-claire-element-id="346038"><p id="r-346037" data-claire-element-id="346037">obtention du paramètre optionnel suivant, puis action(s) sur ce paramètre,</p></li><li id="r-346040" data-claire-element-id="346040"><p id="r-346039" data-claire-element-id="346039">...</p></li></ul><p id="r-346042" data-claire-element-id="346042">Ce schéma n'est réalisable qu'au moyen d'une boucle. Mais voilà, l'ordinateur ne saura pas quand arrêter de lire les paramètres optionnels... Il faut donc sortir de la boucle à un moment, et pensez à cela dès que vous écrirez le prototype de votre fonction ! Il existe plusieurs solutions, les voici.</p><h3 id="r-premiere-solution-passer-en-parametre-obligatoire-le-nombre-de-parametres-optionnels" data-claire-element-id="346046">Première solution : passer en paramètre obligatoire le nombre de paramètres optionnels</h3><p id="r-346043" data-claire-element-id="346043">Le principe est ici de faire le tour de la boucle un certain nombre de fois. Ce nombre est le nombre de paramètres optionnels.</p><p id="r-346044" data-claire-element-id="346044">L'ordinateur doit absolument connaître ce nombre, ce sera donc un nombre passé en paramètre obligatoire :</p><pre id="r-346045" data-claire-element-id="346045"><code data-claire-semantic="c">void multiplication(int *resultat, int nombreNombresAMultiplier, ...); //cette fonction pourrait multiplier ses paramètres optionnels</code></pre><h3 id="r-deuxieme-solution-envoyer-comme-dernier-parametre-optionnel-une-certaine-valeur" data-claire-element-id="346052">Deuxième solution : envoyer comme dernier paramètre optionnel une certaine valeur</h3><p id="r-346047" data-claire-element-id="346047">Ici, le principe est de faire des tours de boucle, tant que l'ordinateur ne lit pas dans les paramètres optionnels, une certaine valeur donnée.</p><p id="r-346048" data-claire-element-id="346048">Dès que l'ordinateur obtiendra le paramètre optionnel ayant une certaine valeur, on sort de la boucle. Cette valeur est en réalité toujours <strong>NULL</strong> :</p><pre id="r-346049" data-claire-element-id="346049"><code data-claire-semantic="c">void multiplication(int *resultat, ...); //cette fonction pourrait multiplier ses paramètres optionnels, mais il ne faut pas oublier d'envoyer NULL comme dernier paramètre optionnel</code></pre><aside id="r-346051" data-claire-element-id="346051" data-claire-semantic="information"><p id="r-346050" data-claire-element-id="346050">Bien sûr, vous n'aurez pas toujours à prendre la première ou la deuxième solution. Vous pourrez faire appel à d'autres alternatives, comme pour la fonction printf par exemple : à chaque %ld, %c, %s... la fonction va obtenir un paramètre optionnel. En effet, chaque %ld, %c, %s... correspond à un paramètre optionnel ;) .</p></aside><h2 id="r-appel-de-la-fonction-1" data-claire-element-id="346057">Appel de la fonction</h2><p id="r-346054" data-claire-element-id="346054">Je ne devrais même pas faire cette partie, c'est tellement simple d'appeler une fonction à nombre variable de paramètres :lol: !</p><p id="r-346055" data-claire-element-id="346055">Voici donc des exemples d'utilisation de fonctions :</p><pre id="r-346056" data-claire-element-id="346056"><code data-claire-semantic="c">// Avec comme paramètre obligatoire le nombre de paramètres optionnels :
void multiplication(int *resultat, int nombreNombresAMultiplier, ...); //prototype
multiplication(&amp;variable, 2, 5, 3); // 2 nombres à multiplier : 5 et 3
multiplication(pointeur, 4, 5, 3, 7, 9); // 4 nombres à multiplier : 5, 3, 7 et 9

// Avec NULL comme dernier paramètre optionnel
void multiplication(int *resultat, ...);
multiplication(&amp;variable, 5, 3, NULL);
multiplication(pointeur, 5, 3, 7, 9, NULL);

// En &quot;détournant&quot; une des deux premières solutions pour lire tous les paramètres optionnels
void fprintf(FILE *fichier, char texte[], ...);
fprintf(fichier, &quot;Entre %s et %s, il y a %ld km&quot;, &quot;Lille&quot;, &quot;Marseille&quot;, 1004);
fprintf(fichier, &quot;Entre %s et %s, il y a %ld km, c'est %s !&quot;, &quot;Lille&quot;, &quot;Marseille&quot;, 1004, &quot;beaucoup&quot;);</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres">Les fonctions à nombre variable de paramètres</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/prototype-et-appel-de-la-fonction">
Prototype et appel de la fonction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
Contenu de la fonction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/exercices-20">
Exercices
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
<span class="next">Contenu de la fonction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Contenudelafonction"></a><h2>Contenu de la fonction</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/prototype-et-appel-de-la-fonction">
<span class="arrow"></span>
<span class="next">Prototype et appel de la fonction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/exercices-20">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-346059" data-claire-element-id="346059">C'est fini pour la théorie, place à la pratique :pirate: ! Pour vous apprendre à créer une fonction à nombre variable de paramètres, je vous propose d'écrire ma fameuse fonction <code>multiplication</code>.</p><aside id="r-346061" data-claire-element-id="346061" data-claire-semantic="information"><p id="r-346060" data-claire-element-id="346060">La réalisation de la fonction nécessite un nouveau type de variable et trois macros définis dans le fichier stdarg.h de la bibliothèque standard du C. Incluez donc le code #include &lt;stdarg.h&gt; dans le fichier qui contient la fonction ;) .</p></aside><p id="r-346062" data-claire-element-id="346062">Vous pouvez déjà commencer par créer cette fonction.</p><pre id="r-346063" data-claire-element-id="346063"><code data-claire-semantic="c">void multiplication(int *resultat, int nombreNombresAMultiplier, ...){
	// Contenu de la fonction
}</code></pre><h2 id="r-la-variable-de-type-va-list" data-claire-element-id="346066">La variable de type va_list</h2><p id="r-346064" data-claire-element-id="346064">Nous allons d'abord déclarer une variable qui permettra de repérer le paramètre lu actuellement par l'ordinateur. Cette variable est souvent appelée <strong>ap</strong> par les pros , ce qui signifie <strong>argument pointer</strong> ;) . Cette variable un peu spéciale sera de type <code>va_list</code>. Voici donc notre code :</p><pre id="r-346065" data-claire-element-id="346065"><code data-claire-semantic="c">void multiplication(int *resultat, int nombreNombresAMultiplier, ...){
	va_list ap;
}</code></pre><h2 id="r-la-macro-va-start" data-claire-element-id="346069">La macro va_start</h2><p id="r-346067" data-claire-element-id="346067">Il va maintenant falloir indiquer à l'ordinateur le premier paramètre qu'il va devoir lire : ce sera le premier paramètre optionnel. Pour indiquer cela à l'ordinateur, il faudra utiliser une autre macro : <code>va_start</code>. Cette macro prend en paramètres la variable <strong>ap</strong> et le nom du dernier paramètre obligatoire. Ainsi notre code sera :</p><pre id="r-346068" data-claire-element-id="346068"><code data-claire-semantic="c">void multiplication(int *resultat, int nombreNombresAMultiplier, ...){
        va_list ap;

        va_start(ap, nombreNombresAMultiplier);
}</code></pre><h2 id="r-la-macro-va-arg" data-claire-element-id="346082">La macro va_arg</h2><p id="r-346070" data-claire-element-id="346070">Et maintenant, il faut obtenir la valeur de chaque paramètre optionnel. Chaque appel à la macro <code>va_arg</code> va nous retourner un paramètre optionnel. Le premier appel à cette macro va nous retourner le premier paramètre optionnel, le deuxième appel nous retournera le paramètre optionnel suivant, et ainsi de suite... Cette macro prend en compte 2 paramètres : <strong>ap</strong> et le type du paramètre à obtenir.</p><aside id="r-346072" data-claire-element-id="346072" data-claire-semantic="information"><p id="r-346071" data-claire-element-id="346071">Le type du paramètre à obtenir n'est pas forcément le même pour chaque paramètre optionnel. Mais il faut d'une manière ou d'une autre obtenir son type. D'ailleurs, nous construirons tout à l'heure une fonction dont les paramètres optionnels ne sont pas tous du même type.</p></aside><p id="r-346073" data-claire-element-id="346073">Notre petit algorithme consistera à multiplier un produit par le paramètre optionnel lu.</p><h3 id="r-avec-le-nombre-de-parametres-optionnels-en-parametre-obligatoire" data-claire-element-id="346076">Avec le nombre de paramètres optionnels en paramètre obligatoire</h3><p id="r-346074" data-claire-element-id="346074">Pour lire tous les paramètres nous allons utiliser une boucle de type <strong>for</strong>, qui sera lue tant qu'une variable initialisée à 0 et incrémentée à chaque tour de boucle sera strictement inférieure au nombre de paramètres optionnels. Voici donc notre code :</p><pre id="r-346075" data-claire-element-id="346075"><code data-claire-semantic="c">void multiplication(int *resultat, int nombreNombresAMultiplier, ...){
	int i;
	*resultat = 1;
	va_list ap;

	va_start(ap, nombreNombresAMultiplier);

	for( i = 0 ; i &lt; nombreNombresAMultiplier ; i++){
		*resultat *= va_arg(ap, int);
	}
}</code></pre><h3 id="r-avec-null-comme-dernier-parametre-optionnel" data-claire-element-id="346081">Avec NULL comme dernier paramètre optionnel</h3><p id="r-346077" data-claire-element-id="346077">On utilisera maintenant une boucle de type <strong>do{}while;</strong> ou <strong>while{}</strong> qui vérifiera à chaque tour si le paramètre lu n'est pas <strong>NULL</strong>. Voici donc la fonction :</p><pre id="r-346078" data-claire-element-id="346078"><code data-claire-semantic="c">void multiplication(int *resultat, ...){
	int parametre = 1; // Valeur du paramètre actuel
	*resultat = 1;
	va_list ap;

	va_start(ap, resultat);
	
	do{ // On fait ce qui suit...
		*resultat *= parametre; // on multiplie le produit par le paramètre actuel
		parametre = va_arg(ap, int); // on obtient le paramètre actuel
		
	}while(parametre != NULL); // ...Tant qu'on ne trouve pas le paramètre NULL
}</code></pre><aside id="r-346080" data-claire-element-id="346080" data-claire-semantic="error"><p id="r-346079" data-claire-element-id="346079">Ne partez pas déjà lancer vos compilateurs, MALHEUREUX :diable: ! Il reste encore une petite chose à faire !</p></aside><h2 id="r-la-macro-va-end" data-claire-element-id="346090">La macro va_end</h2><p id="r-346083" data-claire-element-id="346083">On doit (encore) appeler une macro, cette macro doit être utilisée après <code>va_arg</code>, il s'agit de <code>va_end</code>. Cette macro n'admet qu'un paramètre : <strong>ap</strong>. Et voilà notre fonction finale...</p><h3 id="r-si-le-nombre-de-parametres-optionnels-est-envoye-en-parametre-obligatoire" data-claire-element-id="346085">...si le nombre de paramètres optionnels est envoyé en paramètre obligatoire</h3><pre id="r-346084" data-claire-element-id="346084"><code data-claire-semantic="c">void multiplication(int *resultat, int nombreNombresAMultiplier, ...){
	int i;
	*resultat = 1;
	va_list ap;

	va_start(ap, nombreNombresAMultiplier);

	for( i = 0 ; i &lt; nombreNombresAMultiplier ; i++){
		*resultat *= va_arg(ap, int);
	}

	va_end(ap);
}</code></pre><h3 id="r-si-le-dernier-parametre-optionnel-est-null" data-claire-element-id="346089">...si le dernier paramètre optionnel est NULL</h3><pre id="r-346086" data-claire-element-id="346086"><code data-claire-semantic="c">void multiplication(int *resultat, ...){
	int parametre = 1; // Valeur du paramètre actuel
	*resultat = 1;
	va_list ap;

	va_start(ap, resultat);
	
	do{ // On fait ce qui suit...
		*resultat *= parametre; // on multiplie le produit par le paramètre actuel
		parametre = va_arg(ap, int); // on obtient le paramètre actuel
		
	}while(parametre != NULL); // ...Tant qu'on ne trouve pas le paramètre NULL
	
	va_end(ap);
}</code></pre><aside id="r-346088" data-claire-element-id="346088" data-claire-semantic="information"><p id="r-346087" data-claire-element-id="346087">Maintenant vous pouvez lancer vos compilateurs MALHEUREUX :diable: ! Le codage de la fonction à nombre variable de paramètres est désormais terminé ;) !</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres">Les fonctions à nombre variable de paramètres</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/prototype-et-appel-de-la-fonction">
Prototype et appel de la fonction
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
Contenu de la fonction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/exercices-20">
Exercices
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/prototype-et-appel-de-la-fonction">
<span class="arrow"></span>
<span class="next">Prototype et appel de la fonction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/exercices-20">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Exercices"></a><h2>Exercices</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
<span class="arrow"></span>
<span class="next">Contenu de la fonction</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-346092" data-claire-element-id="346092">Vous savez désormais utiliser des fonctions à nombre variable de paramètres. Mais je vous conseille fortement de faire les exercices suivants afin de vous entraîner et progresser :) .</p><h2 id="r-exercices-non-corriges" data-claire-element-id="346107">Exercices non-corrigés</h2><h3 id="r-addition-de-plusieurs-termes" data-claire-element-id="346096">Addition de plusieurs termes</h3><p id="r-346093" data-claire-element-id="346093">On commence par quelque chose de très facile. En effet on veut ajouter plusieurs termes, c'est presque la même chose qu'avec le produit.</p><aside id="r-346095" data-claire-element-id="346095" data-claire-semantic="warning"><p id="r-346094" data-claire-element-id="346094">Si vous n'y arrivez pas, je vous conseille fortement de relire ce tutoriel.<br/> Et si vous avez besoin d'aide pour les exercices suivants, ou autre chose en rapport avec ce tutoriel, n'hésitez pas à m'envoyer un MP ou à consulter et poster un topic sur le forum !</p></aside><h3 id="r-concatener-plusieurs-chaines-de-caracteres" data-claire-element-id="346101">Concaténer plusieurs chaînes de caractères</h3><p id="r-346097" data-claire-element-id="346097">Il s'agit d'ajouter plusieurs chaînes les unes à la suite des autres. Libre à vous d'ajouter toutes les chaînes dans la première ou dans une nouvelle chaîne vierge ;) .</p><p id="r-346098" data-claire-element-id="346098">Je vous préviens, il y a une astuce qui permet de faire cet exercice très facilement...</p><div id="r-346100" data-claire-element-id="346100"><p id="r-346099" data-claire-element-id="346099">Croyiez-vous vraiment que j'allais donner cette astuce :diable: ? Bon... Un indice : rendez-vous au chapitre sur les chaînes de caractères du tutoriel en C de M@teo21.</p></div><h3 id="r-jeu-de-questions-reponses" data-claire-element-id="346106">Jeu de questions/réponses</h3><p id="r-346102" data-claire-element-id="346102">Le principe du jeu est de poser une question avec plus ou moins de réponses possibles. L'utilisateur choisit la réponse, puis l'ordinateur dit si la réponse est bonne ou non.</p><p id="r-346103" data-claire-element-id="346103">Grâce à une fonction de ce type... :</p><pre id="r-346104" data-claire-element-id="346104"><code data-claire-semantic="c">void poserQuestionTresDifficileNiark(char *question, int score, int numeroBonneReponse, int nbreReponses, ...);</code></pre><p id="r-346105" data-claire-element-id="346105">...ajouter, supprimer ou modifier une question sera alors un jeu d'enfant :lol: . Ce qui rendra le travail du programmeur (vous) bien plus simple (après avoir fait cette fonction), bien plus rapide ! En effet votre fonction, où se trouve le jeu, ne sera qu'une succession d'appels à <code>poserQuestionTresDifficileNiark</code>, alors que ça aurait été un codage bien plus complexe autrement !</p><h2 id="r-exercice-corrige" data-claire-element-id="346181">Exercice corrigé</h2><h3 id="r-principe-de-mon-exercice" data-claire-element-id="346159">Principe de mon exercice</h3><p id="r-346108" data-claire-element-id="346108">Le principe de mon exercice est assez simple : créer une fonction similaire à la fonction fprintf.</p><aside id="r-346110" data-claire-element-id="346110" data-claire-semantic="information"><p id="r-346109" data-claire-element-id="346109">Si vous ne vous rappelez plus de cette fonction, allez vous renseigner <a href="http://www.siteduzero.com/tuto-3-4522-1-lire-et-ecrire-dans-des-fichiers.html#ss_part_2">ici</a> !</p></aside><p id="r-346111" data-claire-element-id="346111">J'ai appelé la fonction <code>ecff</code> (pour : <strong>É</strong>crire une <strong>C</strong>haîne <strong>F</strong>ormatée dans un <strong>F</strong>ichier), elle doit avoir un prototype du type :</p><pre id="r-346112" data-claire-element-id="346112"><code data-claire-semantic="c">void ecff(FILE *fichier, char texte[], ...);</code></pre><p id="r-346113" data-claire-element-id="346113">J'ai remplacé les %ld, %lf, %s... par d'autres signes :</p><table id="r-346151" data-claire-element-id="346151"><thead id="r-346119" data-claire-element-id="346119"><tr id="r-346118" data-claire-element-id="346118"><th id="r-346115" data-claire-element-id="346115"><p id="r-346114" data-claire-element-id="346114">type de variable</p></th><th id="r-346117" data-claire-element-id="346117"><p id="r-346116" data-claire-element-id="346116">signe à inclure dans la chaîne</p></th></tr></thead><tbody id="r-346150" data-claire-element-id="346150"><tr id="r-346124" data-claire-element-id="346124"><td id="r-346121" data-claire-element-id="346121"><p id="r-346120" data-claire-element-id="346120">int</p></td><td id="r-346123" data-claire-element-id="346123"><p id="r-346122" data-claire-element-id="346122">%a</p></td></tr><tr id="r-346129" data-claire-element-id="346129"><td id="r-346126" data-claire-element-id="346126"><p id="r-346125" data-claire-element-id="346125">long</p></td><td id="r-346128" data-claire-element-id="346128"><p id="r-346127" data-claire-element-id="346127">%b</p></td></tr><tr id="r-346134" data-claire-element-id="346134"><td id="r-346131" data-claire-element-id="346131"><p id="r-346130" data-claire-element-id="346130">float</p></td><td id="r-346133" data-claire-element-id="346133"><p id="r-346132" data-claire-element-id="346132">%c</p></td></tr><tr id="r-346139" data-claire-element-id="346139"><td id="r-346136" data-claire-element-id="346136"><p id="r-346135" data-claire-element-id="346135">double</p></td><td id="r-346138" data-claire-element-id="346138"><p id="r-346137" data-claire-element-id="346137">%d</p></td></tr><tr id="r-346144" data-claire-element-id="346144"><td id="r-346141" data-claire-element-id="346141"><p id="r-346140" data-claire-element-id="346140">une chaîne</p></td><td id="r-346143" data-claire-element-id="346143"><p id="r-346142" data-claire-element-id="346142">%e</p></td></tr><tr id="r-346149" data-claire-element-id="346149"><td id="r-346146" data-claire-element-id="346146"><p id="r-346145" data-claire-element-id="346145">faire apparaître le '%'</p></td><td id="r-346148" data-claire-element-id="346148"><p id="r-346147" data-claire-element-id="346147">%%</p></td></tr></tbody></table><p id="r-346152" data-claire-element-id="346152">Ainsi, cet appel à la fonction <code>ecff</code>... :</p><pre id="r-346153" data-claire-element-id="346153"><code data-claire-semantic="c">ecff(fichier, &quot;Pour aller de %e a %e en %e, il faut %ah%a.&quot;, &quot;Rennes&quot;, &quot;Paris&quot;, &quot;TGV&quot;, 2, 15);</code></pre><p id="r-346154" data-claire-element-id="346154">...donnera le fichier suivant :</p><figure id="r-346156" data-claire-element-id="346157"><img id="r-346155" data-claire-element-id="346155" src="medias/uploads.siteduzero.com_files_153001_154000_153921.png" alt="Image utilisateur"/></figure><p id="r-346158" data-claire-element-id="346158">À vous de jouer ;) !</p><h3 id="r-correction-117" data-claire-element-id="346180">Correction</h3><p id="r-346160" data-claire-element-id="346160">Le principe de la fonction est très simple... On va lire chaque caractère du paramètre obligatoire <code>texte</code> et :</p><ul id="r-346170" data-claire-element-id="346170"><li id="r-346167" data-claire-element-id="346167"><p id="r-346161" data-claire-element-id="346161">Si l'on rencontre un '%' :</p><ul id="r-346166" data-claire-element-id="346166"><li id="r-346163" data-claire-element-id="346163"><p id="r-346162" data-claire-element-id="346162">Si le caractère est suivi d'un 'a', 'b', 'c', 'd' ou 'e', on écrit le paramètre optionnel correspondant dans le fichier,</p></li><li id="r-346165" data-claire-element-id="346165"><p id="r-346164" data-claire-element-id="346164">Si le caractère est suivi d'un '%', on écrit le '%' dans le fichier.</p></li></ul></li><li id="r-346169" data-claire-element-id="346169"><p id="r-346168" data-claire-element-id="346168">Si l'on rencontre un caractère normal, on l'écrit dans le fichier.</p></li></ul><aside id="r-346172" data-claire-element-id="346172" data-claire-semantic="warning"><p id="r-346171" data-claire-element-id="346171">Attention cependant, il ne faut pas directement écrire les nombres dans le fichier : il faut passer par l'intermédiaire d'une chaîne de caractères !</p></aside><p id="r-346173" data-claire-element-id="346173">Ainsi on obtient ce code :</p><pre id="r-346174" data-claire-element-id="346174"><code data-claire-semantic="c">void ecff(FILE* fichier, char texte[], ...){
	int tailleChaine = 0, i;
	char chaineUtilisable[16] = {0}; //chaîne intermédiaire pour écrire dans le fichier
	va_list ap;
	va_start(ap, texte);
	
	// calcul de la taille de la chaîne à écrire dans un fichier
	tailleChaine = strlen(texte);
		
	// parcours de chaque caractère
	for(i = 0; i &lt; tailleChaine; i++){
		if(texte[i] == '%'){
			i++; // on se place au caractère suivant pour savoir ce que c'est
			switch(texte[i]){
				case 'a' :
					sprintf(chaineUtilisable, &quot;%ld&quot;, va_arg(ap, int));
					fputs(chaineUtilisable, fichier);
					break;
				case 'b' :
					sprintf(chaineUtilisable, &quot;%ld&quot;, va_arg(ap, long));
					fputs(chaineUtilisable, fichier);
					break;
				case 'c' :
					sprintf(chaineUtilisable, &quot;%lf&quot;, va_arg(ap, float));
					fputs(chaineUtilisable, fichier);
					break;
				case 'd' :
					sprintf(chaineUtilisable, &quot;%lf&quot;, va_arg(ap, double));
					fputs(chaineUtilisable, fichier);
					break;
				case 'e' :
					fputs(va_arg(ap, char*), fichier);
					break;
				case '%' :
					fputc('%', fichier);
					break;
			}
		}
		else{
			fputc(texte[i], fichier);
		}
	}
	va_end(ap);
}</code></pre><aside id="r-346176" data-claire-element-id="346176" data-claire-semantic="information"><p id="r-346175" data-claire-element-id="346175">Bien sûr vous n'avez peut-être pas fait pareil, et je ne prétends pas avoir fait le meilleur code possible :honte: ! En réalité, la fonction <code>printf</code> est plus complexe : les spécificateurs de formats (%s, %ld ...) sont composés d'un % suivi d'une combinaison de caractères (par exemple %s, %ld, %#X ou %8.2f). Je ne vais pas m'étendre là-dessus car ça n'est pas le sujet du tutoriel, bien que cela soit très intéressant ^^ . Sachez en tout cas que l'on peut trouver pleins de trucs sur cette fonction en recherchant &quot;printf&quot; sur notre ami Google :-° .</p></aside><p id="r-346177" data-claire-element-id="346177">N'hésitez pas à continuer à vous entraîner ! Et même si vous ne voyez pas l'intérêt des fonctions à nombre variable de paramètres dans l'immédiat, ne les oubliez pas ! Vous trouverez cela bien pratique quand vous en aurez besoin ! Pour ma part, j'en ai déjà utilisé ;) .</p><p id="r-346178" data-claire-element-id="346178">N'hésitez pas non plus à poster des commentaires, et si vous le faites, n'hésitez pas à me dire quel(s) point(s) améliorer dans mon tutoriel ;) .</p><p id="r-346179" data-claire-element-id="346179">Voilà, ce tutoriel est maintenant fini. Vous savez tout sur les fonctions à nombre variable de paramètres :D ! J'espère que mon tutoriel vous à plu :) .</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres">Les fonctions à nombre variable de paramètres</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/prototype-et-appel-de-la-fonction">
Prototype et appel de la fonction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
Contenu de la fonction
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/exercices-20">
Exercices
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-fonctions-a-nombre-variable-de-parametres/contenu-de-la-fonction-1">
<span class="arrow"></span>
<span class="next">Contenu de la fonction</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/les-fonctions-a-nombre-variable-de-parametres.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 11:05:28 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-fonctions-a-nombre-variable-de-parametres.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:47:24 GMT -->
</html>