<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/utiliser-les-bonnes-fonctions-d-entree.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:27:32 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/utiliser-les-bonnes-fonctions-d-entree.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:07:53 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Utiliser les bonnes fonctions d&#039;entrée</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Utiliser les bonnes fonctions d&#039;entrée</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Utiliserlesbonnesfonctionsd039entre">Utiliser les bonnes fonctions d&#039;entrée</a><br/><a href="#Lafonctionscanf">La fonction scanf()</a><br/><a href="#Lesalternativesscanfpourrcuprerunechane">Les alternatives à scanf() pour récupérer une chaîne</a><br/><a href="#Lesalternativesscanfpourrcuprerunnombre">Les alternatives à scanf() pour récupérer un nombre</a><br/></div>
<a name="Utiliserlesbonnesfonctionsd039entre"></a><h2>Utiliser les bonnes fonctions d&#039;entrée</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/la-fonction-scanf">
<span class="next">La fonction scanf()</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-340618" data-claire-element-id="340618">Salut à tous.<br/>Dans ce mini tuto je vais vous expliquer pourquoi il faut éviter d'utiliser la fonction scanf() en C pour récupérer les entrées du clavier. Je vous expliquerai aussi ce qu'il faut utiliser à la place. Vous verrez que ce n'est pas plus compliqué. Ces méthodes sont utilisées par les professionnels alors pourquoi pas par vous. ;) <br/> Après la lecture de ce tuto vous serez normalement capable de:</p><ul id="r-340625" data-claire-element-id="340625"><li id="r-340620" data-claire-element-id="340620"><p id="r-340619" data-claire-element-id="340619">comprendre les désavantages de scanf(),</p></li><li id="r-340622" data-claire-element-id="340622"><p id="r-340621" data-claire-element-id="340621">gérer les entrées de chaînes et de caractères,</p></li><li id="r-340624" data-claire-element-id="340624"><p id="r-340623" data-claire-element-id="340623">gérer les entrées de nombres.</p></li></ul><p id="r-340626" data-claire-element-id="340626">Comme base pour lire et comprendre ce tuto, vous devez juste avoir lu le début du <a href="http://www.siteduzero.com/tuto-3-8-0-apprenez-a-programmer-en-c-c.html">cours C/C++</a> de <a href="http://www.siteduzero.com/membres-294-3.html">M@teo21</a>. Il vaut mieux aussi connaître le principe des chaînes de caractères en C.</p><p id="r-340627" data-claire-element-id="340627">Voilà, bonne lecture.</p>
</div><a name="Lafonctionscanf"></a><h2>La fonction scanf()</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
<span class="next">Les alternatives à scanf() pour récupérer une chaîne</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-340628" data-claire-element-id="340628">Le problème principal de la fonctions scanf() est qu'elle est compliquée à utiliser correctement. Cela vient du fait qu'elle attend des données formatées. Voici son prototype:</p><pre id="r-340629" data-claire-element-id="340629"><code data-claire-semantic="c">int scanf(const char *format, ... );</code></pre><p id="r-340630" data-claire-element-id="340630">La fonction retourne le nombre de valeurs lues. Le premier paramètre est une chaîne de formats (%d, %c, ...) et ensuite viennent les pointeurs vers les variables que l'on souhaite remplir.</p><p id="r-340631" data-claire-element-id="340631">Mais vous pauvre programmeur, vous ne savez pas ce que va rentrer l'utilisateur de votre programme. Prenez cet exemple:</p><pre id="r-340632" data-claire-element-id="340632"><code data-claire-semantic="c">double a = 12.0;
int b = 0;
printf(&quot;Entrez un double: &quot;);
b = scanf(&quot;%lf&quot;, &amp;a);
printf(&quot;Vous avez entre: %lf, valeurs lues: %d&quot;, a, b);</code></pre><p id="r-340633" data-claire-element-id="340633">Bon très bien, vous entrez un double, pas de problème. Mais l'utilisateur de votre programme n'est pas très malin (aïe, pas taper :-° ), on lui demande de taper un double et lui il va entrer une chaîne de caractères.<br/> Et là, votre scanf ne va pas aimer:</p><pre id="r-340634" data-claire-element-id="340634"><code data-claire-semantic="console">Entrez un double:

coucou

Vous avez entre: 12.000000, valeurs lues: 0

Appuyez sur une touche pour continuer...</code></pre><p id="r-340635" data-claire-element-id="340635">Vous voyez bien que scanf() n'a pas lu ce qui a été entré. En effet lorsque scanf() rencontre quelque chose qui ne correspond pas au format, la fonction s'arrête. Et ce qui n'a pas été lu reste dans le tampon qu'il faudrait donc vider.</p><p id="r-340636" data-claire-element-id="340636">Un autre inconvénient de la fonction scanf() est qu'on ne peut pas saisir facilement une chaîne de caractère contenant des espaces.<br/> Voilà pourquoi il vaut mieux ne pas utiliser scanf() pour les saisies clavier.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree">Utiliser les bonnes fonctions d&#039;entrée</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/la-fonction-scanf">
La fonction scanf()
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
Les alternatives à scanf() pour récupérer une chaîne
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-un-nombre">
Les alternatives à scanf() pour récupérer un nombre
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
<span class="next">Les alternatives à scanf() pour récupérer une chaîne</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesalternativesscanfpourrcuprerunechane"></a><h2>Les alternatives à scanf() pour récupérer une chaîne</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/la-fonction-scanf">
<span class="arrow"></span>
<span class="next">La fonction scanf()</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-un-nombre">
<span class="next">Les alternatives à scanf() pour récupérer un nombre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-340638" data-claire-element-id="340638">En fait dans cette partie, comme le titre l'indique, je vais vous montrer comment récupérer une chaîne de caractère sans utiliser scanf(). Et comme je suis partageur, je vous montrerais aussi comment récupérer un seul caractère (ça vous le savez peut-être déjà mais on ne sais jamais :) ).</p><h3 id="r-recuperer-une-chaine" data-claire-element-id="340658">Récupérer une chaîne</h3><p id="r-340639" data-claire-element-id="340639">Nous allons d'abord voir les saisies de chaînes. Alors quelles fonctions va t'on utiliser ?<br/> Et bien la première vous la connaissez, c'est la fonction fgets().</p><p id="r-340640" data-claire-element-id="340640">o_O Quoi ? Mais fgets() ne sert pas à lire une ligne d'un fichier ?</p><p id="r-340641" data-claire-element-id="340641">Si mais en C le flux d'entrée, stdin, est aussi considéré comme un fichier et il est ouvert automatiquement au début du programme. La fonction fgets() va permettre de lire ce flux et donc de récupérer les entrées clavier. Voici le prototype de cette fonction:</p><pre id="r-340642" data-claire-element-id="340642"><code data-claire-semantic="c">char* fgets(char *s, int n, FILE *stream);</code></pre><p id="r-340643" data-claire-element-id="340643">La fonction fgets() prends comme premier paramètre la chaîne dans laquelle elle va placer la saisie. Le deuxième paramètre est le nombre maximal de caractères (n-1 plus exactement) qui seront lus et le dernier paramètre est le flux à lire. Ici se sera stdin.</p><p id="r-340644" data-claire-element-id="340644">Mais comment connaît-on le nombre de bits à lire ? Tout simplement en utilisant sizeof qui permet de connaître le nombre de bytes d'une variable. Voilà un exemple d'utilisation de la fonction fgets pour récupérer une chaîne:</p><pre id="r-340645" data-claire-element-id="340645"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 
int main ( int argc, char* argv[] )
{
    char chaine[20] = &quot;&quot;;
 
    printf(&quot;Entrez une chaine:\n&quot;);
    fgets(chaine, sizeof(chaine), stdin);
    printf(&quot;Chaine: %s.\n&quot;, chaine);
 
    return 0;
}</code></pre><p id="r-340646" data-claire-element-id="340646">Votre console affiche:</p><pre id="r-340647" data-claire-element-id="340647"><code data-claire-semantic="console">Entrez une chaine:

Je suis un zero

Chaine: Je suis un zero

.

 

Appuyez sur une touche pour continuer...</code></pre><p id="r-340648" data-claire-element-id="340648">Ici il y a deux choses à remarquer. Premièrement, la fonction fgets permet la saisie de chaînes contenant des espaces, ce que scanf() ne permet pas.<br/> Et deuxièmement, il y a un saut de ligne à la fin de la chaîne. En effet, vous avez appuyé sur entrée pour saisir votre chaîne. Le caractère est donc à la fin de la chaîne. <br/> Il y a un autre problème, on dit à la fonction fgets() de lire 19 caractères mais rien n'empêche l'utilisateur de rentrer 50 caractères. À ce-moment là un deuxième appel à la fonction fgets() récupérera la suite de l'entrée.</p><p id="r-340649" data-claire-element-id="340649">Il faut donc corriger ce problème.<br/> Pour cela il faut utiliser une fonction, la fonction clean(). Elle n'est pas de moi et je l'ai tellement vue sur le forum que je suis incapable de vous donner son auteur.</p><pre id="r-340650" data-claire-element-id="340650"><code data-claire-semantic="c">void clean(const char *buffer, FILE *fp)
{
    char *p = strchr(buffer,'\n');
    if (p != NULL)
        *p = 0;
    else
    {
        int c;
        while ((c = fgetc(fp)) != '\n' &amp;&amp; c != EOF);
    }
}</code></pre><p id="r-340651" data-claire-element-id="340651">Je suppose que je dois vous expliquer cette fonction ?<br/> Oui, bon d'accord. Alors cette fonction prend en paramètre la chaîne que vous avez récupérée avec fgets() et le flux qui est comme précédemment stdin. Cette fonction ne retourne rien.</p><p id="r-340652" data-claire-element-id="340652">D'abord, on cherche le caractère dans la chaîne à l'aide de la fonction strchr() (donc il faudra penser à inclure string.h). Si on trouve le , on le supprime de la chaîne et si on ne le trouve pas on vide le buffer avec une boucle while. Cette boucle ne s'arrête pas tant qu'elle lit un caractère différent de et que celui ci n'est pas le caractère de fin de flux (&quot;Ctrl&quot; + &quot;Z&quot; sur Windows ou &quot;Ctrl&quot; + &quot;D&quot; sur GNU/Linux).</p><p id="r-340653" data-claire-element-id="340653">Donc voici comment récupérer correctement une chaîne de caractère en C:</p><pre id="r-340654" data-claire-element-id="340654"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
 
void clean(const char *buffer, FILE *fp);
 
int main ( int argc, char* argv[] )
{
    char chaine[20] = &quot;&quot;;
 
    printf(&quot;Entrez une chaine:\n&quot;);
    fgets(chaine, sizeof(chaine), stdin);
    clean(chaine, stdin);
    printf(&quot;Chaine: %s.\n&quot;, chaine);
 
    return 0;
}
 
void clean(const char *buffer, FILE *fp)
{
    char *p = strchr(buffer,'\n');
    if (p != NULL)
        *p = 0;
    else
    {
        int c;
        while ((c = fgetc(fp)) != '\n' &amp;&amp; c != EOF);
    }
}</code></pre><p id="r-340655" data-claire-element-id="340655">Et voici le résultat:</p><pre id="r-340656" data-claire-element-id="340656"><code data-claire-semantic="console">Entrez une chaine:

Je suis un zero

Chaine: Je suis un zero.

 

Appuyez sur une touche pour continuer...</code></pre><p id="r-340657" data-claire-element-id="340657">Vous pouvez enfin dire au revoir à scanf().</p><h3 id="r-recuperer-un-caractere" data-claire-element-id="340670">Récupérer un caractère</h3><p id="r-340659" data-claire-element-id="340659">Alors pourquoi je n'utilise pas fgets() + clean() ? C'est simple, il existe une fonction permettant de ne récupérer qu'un seul caractère et non une chaîne. Cette fonction c'est getchar().<br/> Bien sur ce n'est pas si simple. Si vous n'utilisez que getchar() vous pourrez rencontrer des problèmes. En effet, cette fonction prend le dernier caractère tapé par l'utilisateur. Donc voyez ce code:</p><pre id="r-340660" data-claire-element-id="340660"><code data-claire-semantic="c">a = getchar();
printf(&quot;Vous avez tape la lettre %c\n&quot;, a);
b = getchar();
printf(&quot;Vous avez tape la lettre %c\n&quot;, b);</code></pre><p id="r-340661" data-claire-element-id="340661">Avec ce code la console affiche:</p><pre id="r-340662" data-claire-element-id="340662"><code data-claire-semantic="console">d

Vous avez tape la lettre d

Vous avez tape la lettre

 

Appuyez sur une touche pour continuer...</code></pre><p id="r-340663" data-claire-element-id="340663">Vous voyez que votre programme ne vous demande pas de rentrer le deuxième caractère. C'est parce que lors du deuxième appel à la fonction getchar() celle ci récupère le caractère qui correspond à l'appui que vous avez fait sur la touche entrée après avoir tapé la lettre d. Cela se produit parce que le est toujours dans le &quot;buffer&quot;.<br/> Il faut donc enlever ce du buffer. Pour cela on fait juste une boucle comme ceci:</p><pre id="r-340664" data-claire-element-id="340664"><code data-claire-semantic="c">while (getchar() != '\n');</code></pre><p id="r-340665" data-claire-element-id="340665">Cela permet de vider le flux entrant. En effet, la boucle lit les caractères jusqu'à ce qu'elle ait lu le . Celui ci n'est donc plus dans le buffer. Essayez le code suivant:</p><pre id="r-340666" data-claire-element-id="340666"><code data-claire-semantic="c">a = getchar();
while (getchar() != '\n');
printf(&quot;Vous avez tape la lettre %c\n&quot;, a);
b = getchar();
while (getchar() != '\n');
printf(&quot;Vous avez tape la lettre %c\n&quot;, b);</code></pre><p id="r-340667" data-claire-element-id="340667">Vous pouvez voir que cette fois ci le programme vous demande bien les deux caractères:</p><pre id="r-340668" data-claire-element-id="340668"><code data-claire-semantic="console">d

Vous avez tape la lettre d

s

Vous avez tape la lettre s

 

Appuyez sur une touche pour continuer...</code></pre><p id="r-340669" data-claire-element-id="340669">Vous savez maintenant récupérer un caractère en C.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree">Utiliser les bonnes fonctions d&#039;entrée</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/la-fonction-scanf">
La fonction scanf()
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
Les alternatives à scanf() pour récupérer une chaîne
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-un-nombre">
Les alternatives à scanf() pour récupérer un nombre
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/la-fonction-scanf">
<span class="arrow"></span>
<span class="next">La fonction scanf()</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-un-nombre">
<span class="next">Les alternatives à scanf() pour récupérer un nombre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesalternativesscanfpourrcuprerunnombre"></a><h2>Les alternatives à scanf() pour récupérer un nombre</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
<span class="arrow"></span>
<span class="next">Les alternatives à scanf() pour récupérer une chaîne</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-340672" data-claire-element-id="340672">Alors vous allez me dire, oui c'est bien ton truc, on peut récupérer des chaînes de caractères mais pour les nombres comment on fait ? o_O</p><p id="r-340673" data-claire-element-id="340673">Et bien il suffit d'utiliser des fonctions qui convertissent les chaînes en nombres. Cela tombe bien parce qu'en C il y en a plusieurs, je vais vous présenter celles ci:<br/> sscanf(), strtol(), strtod, strtoul()</p><h2 id="r-strtol" data-claire-element-id="340678">strtol()</h2><p id="r-340674" data-claire-element-id="340674">Tout d'abord le prototype de la fonction:</p><pre id="r-340675" data-claire-element-id="340675"><code data-claire-semantic="c">long int strtol(const char *str, char **endptr, int base);</code></pre><p id="r-340676" data-claire-element-id="340676">La fonction strtol() permet de convertir une chaîne en un nombre de type long int.<br/> Le premier paramètre de la fonction est la chaîne de caractère que l'on souhaite convertir, le second paramètre contiendra l'adresse où la conversion s'est arrêtée. Enfin le dernier paramètre est la base dans laquelle on souhaite convertir la chaîne. En général on utilise la base 10 (celle de la vie de tous les jours). Voici un exemple d'utilisation de cette fonction:</p><pre id="r-340677" data-claire-element-id="340677"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 
int main ( int argc, char* argv[] )
{
    char chaine[10] = &quot;255&quot;;
    long int nombre = 0;
    char* fin = NULL;
 
    nombre = strtol(chaine, &amp;fin, 10);
    printf(&quot;Chaine: %s, nombre: %ld\n&quot;, chaine, nombre);
 
    return 0;
}</code></pre><h2 id="r-strtod" data-claire-element-id="340683">strtod()</h2><p id="r-340679" data-claire-element-id="340679">Le prototype de la fonction:</p><pre id="r-340680" data-claire-element-id="340680"><code data-claire-semantic="c">double strtod(const char *str, char **endptr);</code></pre><p id="r-340681" data-claire-element-id="340681">La fonction strtod() permet de convertir une chaîne en double.<br/> Comme pour la fonction précédente, le premier paramètre de la fonction est la chaîne de caractère que l'on souhaite convertir, le second paramètre contiendra l'adresse où la conversion s'est arrêtée. Un exemple d'utilisation:</p><pre id="r-340682" data-claire-element-id="340682"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 
int main ( int argc, char* argv[] )
{
    char chaine[10] = &quot;345.632&quot;;
    double nombre = 0;
    char* fin = NULL;
 
    nombre = strtod(chaine, &amp;fin);
    printf(&quot;Chaine: %s, nombre: %lf\n&quot;, chaine, nombre);
 
    return 0;
}</code></pre><h2 id="r-strtoul" data-claire-element-id="340757">strtoul()</h2><p id="r-340684" data-claire-element-id="340684">Le prototype de la fonction:</p><pre id="r-340685" data-claire-element-id="340685"><code data-claire-semantic="c">unsigned long int strtoul(const char *str, char **endptr, int base);</code></pre><p id="r-340686" data-claire-element-id="340686">La fonction strtoul() permet encore de convertir une chaîne en un nombre de type long int mais cette fois il est unsigned c'est à dire qu'il doit être positif.<br/> Le premier paramètre de la fonction est la chaîne de caractère que l'on souhaite convertir, le second paramètre contiendra l'adresse où la conversion s'est arrêtée. Comme pour strtol() le dernier paramètre est la base dans laquelle on souhaite convertir la chaîne. Voici un exemple d'utilisation de cette fonction:</p><pre id="r-340687" data-claire-element-id="340687"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 
int main ( int argc, char* argv[] )
{
    char chaine[10] = &quot;255&quot;;
    unsigned long int nombre = 0;
    char* fin = NULL;
 
    nombre = strtol(chaine, &amp;fin, 10);
    printf(&quot;Chaine: %s, nombre: %u\n&quot;, chaine, nombre);
 
    return 0;
}</code></pre><p id="r-340688" data-claire-element-id="340688">Vous remarquerez que l'on utilise %u pour afficher un unsigned long int et non %ld comme pour un long int. D'ailleurs M@teo21 ne donnant pas tous les codes de format dans son cours, je vous les donne ici:</p><table id="r-340756" data-claire-element-id="340756"><thead id="r-340694" data-claire-element-id="340694"><tr id="r-340693" data-claire-element-id="340693"><th id="r-340690" data-claire-element-id="340690"><p id="r-340689" data-claire-element-id="340689">Code de format</p></th><th id="r-340692" data-claire-element-id="340692"><p id="r-340691" data-claire-element-id="340691">Variable associée</p></th></tr></thead><tbody id="r-340755" data-claire-element-id="340755"><tr id="r-340699" data-claire-element-id="340699"><td id="r-340696" data-claire-element-id="340696"><p id="r-340695" data-claire-element-id="340695">c</p></td><td id="r-340698" data-claire-element-id="340698"><p id="r-340697" data-claire-element-id="340697">char</p></td></tr><tr id="r-340704" data-claire-element-id="340704"><td id="r-340701" data-claire-element-id="340701"><p id="r-340700" data-claire-element-id="340700">d</p></td><td id="r-340703" data-claire-element-id="340703"><p id="r-340702" data-claire-element-id="340702">int</p></td></tr><tr id="r-340709" data-claire-element-id="340709"><td id="r-340706" data-claire-element-id="340706"><p id="r-340705" data-claire-element-id="340705">u</p></td><td id="r-340708" data-claire-element-id="340708"><p id="r-340707" data-claire-element-id="340707">unsigned int</p></td></tr><tr id="r-340714" data-claire-element-id="340714"><td id="r-340711" data-claire-element-id="340711"><p id="r-340710" data-claire-element-id="340710">hd</p></td><td id="r-340713" data-claire-element-id="340713"><p id="r-340712" data-claire-element-id="340712">short int</p></td></tr><tr id="r-340719" data-claire-element-id="340719"><td id="r-340716" data-claire-element-id="340716"><p id="r-340715" data-claire-element-id="340715">hu</p></td><td id="r-340718" data-claire-element-id="340718"><p id="r-340717" data-claire-element-id="340717">unsigned short</p></td></tr><tr id="r-340724" data-claire-element-id="340724"><td id="r-340721" data-claire-element-id="340721"><p id="r-340720" data-claire-element-id="340720">ld</p></td><td id="r-340723" data-claire-element-id="340723"><p id="r-340722" data-claire-element-id="340722">long int</p></td></tr><tr id="r-340729" data-claire-element-id="340729"><td id="r-340726" data-claire-element-id="340726"><p id="r-340725" data-claire-element-id="340725">lu</p></td><td id="r-340728" data-claire-element-id="340728"><p id="r-340727" data-claire-element-id="340727">unsigned long</p></td></tr><tr id="r-340734" data-claire-element-id="340734"><td id="r-340731" data-claire-element-id="340731"><p id="r-340730" data-claire-element-id="340730">f</p></td><td id="r-340733" data-claire-element-id="340733"><p id="r-340732" data-claire-element-id="340732">float (notation décimale)</p></td></tr><tr id="r-340739" data-claire-element-id="340739"><td id="r-340736" data-claire-element-id="340736"><p id="r-340735" data-claire-element-id="340735">e</p></td><td id="r-340738" data-claire-element-id="340738"><p id="r-340737" data-claire-element-id="340737">float (notation exponentielle)</p></td></tr><tr id="r-340744" data-claire-element-id="340744"><td id="r-340741" data-claire-element-id="340741"><p id="r-340740" data-claire-element-id="340740">lf</p></td><td id="r-340743" data-claire-element-id="340743"><p id="r-340742" data-claire-element-id="340742">double (notation décimale)</p></td></tr><tr id="r-340749" data-claire-element-id="340749"><td id="r-340746" data-claire-element-id="340746"><p id="r-340745" data-claire-element-id="340745">le</p></td><td id="r-340748" data-claire-element-id="340748"><p id="r-340747" data-claire-element-id="340747">double (notation exponentielle)</p></td></tr><tr id="r-340754" data-claire-element-id="340754"><td id="r-340751" data-claire-element-id="340751"><p id="r-340750" data-claire-element-id="340750">s</p></td><td id="r-340753" data-claire-element-id="340753"><p id="r-340752" data-claire-element-id="340752">chaîne de caractère</p></td></tr></tbody></table><h2 id="r-sscanf" data-claire-element-id="340775">sscanf()</h2><p id="r-340758" data-claire-element-id="340758">La fonction sscanf() est très intéressante puisqu'elle peut remplacer les trois autres(ah j'aurais dû vous le dire avant ? :p ), voici son prototype:</p><pre id="r-340759" data-claire-element-id="340759"><code data-claire-semantic="c">int sscanf(const char *s, const char *format, ... );</code></pre><p id="r-340760" data-claire-element-id="340760">Comme son nom l'indique un peu cette fonction a une utilisation proche de celle de scanf(). Le premier paramètre est la chaîne de caractère à convertir, le deuxième est le format (%ld, %lf, ...). Et enfin il y a un ou plusieurs paramètres représentant les nombres que l'on veut &quot;extraire&quot; de la chaîne.</p><p id="r-340761" data-claire-element-id="340761">Alors là je vous vois venir, vous allez me dire mais pourquoi on utilise sscanf() alors que tu nous a dit de ne pas utiliser scanf() ?<br/> Mais là c'est très différent, en effet ici c'est vous qui décidez du contenu de la chaîne (contrairement aux entrées issues du clavier). Donc en principe vous savez ce que vous faites.</p><p id="r-340762" data-claire-element-id="340762">Donc comme je suppose que vous savez vous servir de scanf() (sinon je vous invite fortement à relire le cours de M@teo21), je ne vais prendre qu'un exemple puis vous testerez toutes les possibilités de sscanf():</p><pre id="r-340763" data-claire-element-id="340763"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 
int main(int argc, char* argv[])
{
    char chaine[20] = &quot;9999 45.56&quot;;
    int nombre1 = 0;
    double nombre2 = 0.0;
 
    sscanf(chaine, &quot;%d %lf&quot;, &amp;nombre1, &amp;nombre2);
    printf(&quot;Chaine: %s, nombre1: %d, nombre2: %lf\n&quot;, chaine, nombre1, nombre2);
 
    return 0;
}</code></pre><p id="r-340764" data-claire-element-id="340764">On obtient le résultat suivant:</p><pre id="r-340765" data-claire-element-id="340765"><code data-claire-semantic="console">Chaine: 9999 45.56, nombre1: 9999, nombre2: 45.56000</code></pre><aside id="r-340767" data-claire-element-id="340767" data-claire-semantic="warning"><p id="r-340766" data-claire-element-id="340766">Alors là j'insiste beaucoup, beaucoup, ...</p></aside><p id="r-340768" data-claire-element-id="340768"><cite>Citation : moi</cite></p><blockquote id="r-340770" data-claire-element-id="340770"><p id="r-340769" data-claire-element-id="340769">sscanf(chaine, &quot;%d %lf&quot;, <strong>&amp;</strong>nombre1, <strong>&amp;</strong>nombre2);</p></blockquote><p id="r-340771" data-claire-element-id="340771">En effet, pareil que pour scanf(), c'est un pointeur sur la variable que l'on passe à la fonction sscanf(). En effet pour pouvoir modifier la valeur de la variable, il faut donner à la fonction l'adresse de la variable. Si on ne donne que la variable elle-même, celle-ci sera dupliquée mais sa valeur ne sera pas modifiée.</p><p id="r-340772" data-claire-element-id="340772">Et voilà c'est fini. <br/> J'espère vous avoir appris quelques choses et que vous n'utiliserez plus l'horrible scanf(). :) <br/> Si vous êtes bilingues (ou un peu moins ;) ) et que vous voulez en savoir plus sur les fonctions que je vous ai présentées (ou d'autres), vous pouvez aller voir <a href="http://www.opengroup.org/pubs/online/7908799/xshix.html">ce lien</a> ou sont présentées les fonctions systèmes d'Unix. Beaucoup de fonctions C sont équivalentes.</p><p id="r-340773" data-claire-element-id="340773">Si vous avez des questions ou des suggestions (voire des corrections) vous pouvez me contacter par <a href="http://www.siteduzero.com/mp-273-16292.html">MP</a> ou laisser un commentaire.<br/> Ce tuto est sous licence <a href="http://www.gnu.org/licenses/fdl.txt">GNU/FDL</a>. Vous pouvez donc le modifier ou le redistribuer.</p><p id="r-340774" data-claire-element-id="340774">Seb13.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree">Utiliser les bonnes fonctions d&#039;entrée</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/la-fonction-scanf">
La fonction scanf()
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
Les alternatives à scanf() pour récupérer une chaîne
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-un-nombre">
Les alternatives à scanf() pour récupérer un nombre
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/utiliser-les-bonnes-fonctions-d-entree/les-alternatives-a-scanf-pour-recuperer-une-chaine">
<span class="arrow"></span>
<span class="next">Les alternatives à scanf() pour récupérer une chaîne</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/utiliser-les-bonnes-fonctions-d-entree.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 23:27:32 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/utiliser-les-bonnes-fonctions-d-entree.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:07:54 GMT -->
</html>