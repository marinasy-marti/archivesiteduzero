<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/les-deplacements-de-la-souris.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 06:36:04 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-deplacements-de-la-souris.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:10:24 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Les déplacements de la souris</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/les-deplacements-de-la-souris.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Les déplacements de la souris</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Lesdplacementsdelasouris">Les déplacements de la souris</a><br/><a href="#Lescoordonnesdelasouris">Les coordonnées de la souris</a><br/><a href="#Lavariableevent">La variable event</a><br/><a href="#Lescoordonnes">Les coordonnées</a><br/><a href="#Positionabsolue">Position absolue</a><br/><a href="#Filrougegestiondesfentres">Fil rouge : gestion des fenêtres</a><br/><a href="#Lescoordonnesdesblocs">Les coordonnées des blocs</a><br/><a href="#Centrer">Centrer</a><br/><a href="#Coordonnes">Coordonnées</a><br/><a href="#Filrougedcalageinitial">Fil rouge : décalage initial</a><br/><a href="#Lescibles">Les cibles</a><br/><a href="#Lapropagationdesvnements">La propagation des évènements</a><br/><a href="#Rcuprerlacible">Récupérer la cible</a><br/><a href="#Avecdesclasses">Avec des classes</a><br/><a href="#Filrougesansajoutd039vnement">Fil rouge : sans ajout d&#039;évènement</a><br/><a href="#Finalisationduscriptdefentres">Finalisation du script de fenêtres</a><br/><a href="#Unehistoired039ordre">Une histoire d&#039;ordre</a><br/><a href="#LevraistyleCSS">Le vrai style CSS</a><br/><a href="#Maximiser">Maximiser</a><br/><a href="#Cloisonnement">Cloisonnement</a><br/><a href="#Unelisteordonneoriginale">Une liste ordonnée originale !</a><br/><a href="#Codedebase">Code de base</a><br/><a href="#Ajoutduscript">Ajout du script</a><br/><a href="#Lelifantme">Le li fantôme</a><br/><a href="#Comptageetcamouflage">Comptage et camouflage</a><br/></div>
<a name="Lesdplacementsdelasouris"></a><h2>Les déplacements de la souris</h2><div class="content" role="article">
<p id="r-411169" data-claire-element-id="411169">Bonjour, bonjour. :)</p><p id="r-411170" data-claire-element-id="411170">Vous avez sûrement déjà vu ces sites web où certaines icônes ou fenêtres sont déplaçables à la souris, ou alors où un texte suit le curseur. Vous vous êtes peut-être demandé comment réaliser ce genre d'effet. Avec du Javascript oui, mais encore ? Le sujet semble parfois complexe car tous les navigateurs ne sont pas compatibles.</p><p id="r-411171" data-claire-element-id="411171">Mais ne fuyez pas ! Attendez ! Je vais expliquer (du moins, essayer) clairement comment déplacer des éléments dans une page web grâce aux déplacements de la souris et j'espère bien vous voir devenir des pros de cette technique qu'on appelle parfois le &quot;drag &amp; drop&quot;. :soleil:</p><p id="r-411172" data-claire-element-id="411172">Vous devriez être déjà assez à l'aise avec le <em>HTML</em>, le <em>Javascript</em> et le <em>DOM</em> pour bien comprendre ce tutoriel. ;)</p>
</div>
<div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script>
</div><a name="Lescoordonnesdelasouris"></a><h2>Les coordonnées de la souris</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
<span class="next">La variable event</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-411174" data-claire-element-id="411174">Si vous avez déjà eu l'occasion de travailler dans un repère en maths (<em>nan! ne partez pas !</em>), vous savez sûrement déjà ce que sont les coordonnées.<br/> Les coordonnées sont composées de deux nombres ici :</p><ul id="r-411179" data-claire-element-id="411179"><li id="r-411176" data-claire-element-id="411176"><p id="r-411175" data-claire-element-id="411175">l'<em>abscisse</em>, que l'on va souvent nommer <strong>x</strong> qui contient la distance par rapport au bord gauche de la page ;</p></li><li id="r-411178" data-claire-element-id="411178"><p id="r-411177" data-claire-element-id="411177">l'<em>ordonnée</em>, qui sera contenue dans la variable <strong>y</strong> qui contient la distance par rapport au bord supérieur de la page.</p></li></ul><p id="r-411180" data-claire-element-id="411181"><a href="http://b2moo.free.fr/tutorials/mouse/coord.htm"><img id="r-411181" data-claire-element-id="411180" src="medias/uploads.siteduzero.com_files_77001_78000_77392.png" alt="Image utilisateur"/>Voir un exemple animé</a></p><p id="r-411182" data-claire-element-id="411182">Pour connaître la position de la souris sur l'écran, on va chercher à récupérer ces deux distances. :)</p>
</div><a name="Lavariableevent"></a><h2>La variable event</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">
<span class="arrow"></span>
<span class="next">Les coordonnées de la souris</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
<span class="next">Les coordonnées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-la-variable-event" data-claire-element-id="411205">La variable event</h4><p id="r-411183" data-claire-element-id="411183">La position de la souris se récupère via une variable particulière qui s'appelle <strong>event</strong>. Mais n'essayez pas d'utiliser cette variable directement : elle n'existe pas d'habitude. Pour l'utiliser, il faut déclencher un évènement.<br/> Tous les évènements qui ont un rapport avec la souris marchent :<br/>onclick, ondbclick, onmousemove, onmousedown, onmouseup, etc.</p><p id="r-411184" data-claire-element-id="411184">La variable <strong>event</strong> indiquera donc la position de la souris au moment du <strong>onclick</strong> au moment où cet évènement est déclenché (donc à chaque clic, cela va créer une nouvelle variable event).</p><p id="r-411185" data-claire-element-id="411185">Trois cas se présentent suivant la façon dont vous associez des évènements aux objets HTML de votre page.</p><h6 id="r-cas-ndeg1-assigner-un-evenement-en-html" data-claire-element-id="411190">Cas n°1 : assigner un évènement en HTML</h6><p id="r-411186" data-claire-element-id="411186">Si pour ajouter un évènement à votre page, vous l'écriviez dans le code HTML :</p><pre id="r-411187" data-claire-element-id="411187"><code data-claire-semantic="html">&lt;script type=&quot;text/javascript&quot;&gt;
function onclick_page()
{
  
}
&lt;/script&gt;&lt;input type=&quot;button&quot; id=&quot;bouton_click&quot; onclick=&quot;onclick_page();&quot; value=&quot;Click!&quot; /&gt;</code></pre><p id="r-411188" data-claire-element-id="411188">vous avez juste à rajouter cette nouvelle variable :</p><pre id="r-411189" data-claire-element-id="411189"><code data-claire-semantic="html">&lt;script type=&quot;text/javascript&quot;&gt;
function onclick_page(event)
{
  //ici, on va se servir de la variable event ^^
  alert(event);
}
&lt;/script&gt;
&lt;input type=&quot;button&quot; id=&quot;bouton_click&quot; onclick=&quot;onclick_page(event);&quot; value=&quot;Click!&quot; /&gt;</code></pre><h6 id="r-cas-ndeg2-assigner-un-evenement-dynamiquement-avec-la-methode-dom-0" data-claire-element-id="411195">Cas n°2 : assigner un évènement dynamiquement avec la méthode DOM-0</h6><p id="r-411191" data-claire-element-id="411191">Le DOM-0 permet d'ajouter des évènements en modifiant une variable :</p><pre id="r-411192" data-claire-element-id="411192"><code data-claire-semantic="javascript">document.getElementById('bouton_click').onclick = onclick_page;</code></pre><p id="r-411193" data-claire-element-id="411193">Il va falloir modifier légèrement le début de la fonction. La plupart des navigateurs transmettent bien une variable <strong>event</strong> à la fonction, sauf Internet Explorer où la variable <strong>event</strong> est globale. Pour concilier tous les navigateurs, il va falloir préciser tous les cas possibles :</p><pre id="r-411194" data-claire-element-id="411194"><code data-claire-semantic="javascript">function onclick_page(event)
{
  if( window.event)
    event = window.event;
  //On peut aussi écrire: event = event || window.event;
  //ici, on va se servir de la variable event ^^
  alert(event);
}</code></pre><h6 id="r-cas-ndeg3-assigner-un-evenement-dynamiquement-avec-addeventlistener-dom-2" data-claire-element-id="411204">Cas n°3 : assigner un évènement dynamiquement avec addEventListener (DOM-2)</h6><p id="r-411196" data-claire-element-id="411196">Si vous utilisez la fonction <strong>addEventListener</strong> (et <strong>attachEvent</strong> pour Internet Explorer), il n'y a pas grand-chose à modifier :</p><pre id="r-411197" data-claire-element-id="411197"><code data-claire-semantic="javascript">function onclick_page(event)
{
  //ici, on va se servir de la variable event ^^
  alert(event);
}
var objet = document.getElementById('bouton_click');
if( objet.addEventListener)
  objet.addEventListener('click',onclick_page,true);
else  //pour ie
  objet.attachEvent('onclick',onclick_page);</code></pre><p id="r-411198" data-claire-element-id="411198">Personnellement, j'ai écrit une petite fonction pour ne pas avoir à toujours taper cette condition :</p><pre id="r-411199" data-claire-element-id="411199"><code data-claire-semantic="javascript">function addEvent(obj,event,fct)
{
        if( obj.attachEvent)
                obj.attachEvent('on' + event,fct);
        else
                obj.addEventListener(event,fct,true);
}</code></pre><p id="r-411200" data-claire-element-id="411200">Comme ça, on pourra utiliser cette fonction à chaque fois que l'on veut rajouter un évènement, proprement. :)</p><pre id="r-411201" data-claire-element-id="411201"><code data-claire-semantic="javascript">addEvent(document.getElementById('bouton_click'),'click',onclick_page);</code></pre><aside id="r-411203" data-claire-element-id="411203" data-claire-semantic="information"><p id="r-411202" data-claire-element-id="411202">Je vous conseille d'utiliser cette dernière méthode le plus souvent possible car elle permet d'éviter les conflits entre les scripts. Contrairement à la précédente, on peut mettre plusieurs fonctions sur une même balise HTML.<br/> Je l'utiliserai souvent dans ce tutoriel, donc retenez (ou copiez-collez) bien cette fonction. ;)</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">
<span class="arrow"></span>
<span class="next">Les coordonnées de la souris</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
<span class="next">Les coordonnées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lescoordonnes"></a><h2>Les coordonnées</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
<span class="arrow"></span>
<span class="next">La variable event</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
<span class="next">Position absolue</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-les-coordonnees-1" data-claire-element-id="411220">Les coordonnées</h4><p id="r-411206" data-claire-element-id="411206">Notre but principal est de récupérer les coordonnées de la souris ; pour cela, on a récupéré la variable <strong>event</strong> et celle-ci possède les propriétés qui nous intéressent : <strong>clientX</strong> et <strong>clientY</strong>.</p><aside id="r-411208" data-claire-element-id="411208" data-claire-semantic="information"><p id="r-411207" data-claire-element-id="411207">Il y a d'autres propriétés qui nous permettent d'obtenir des informations de ce genre, mais nous ne verrons dans ce tutoriel que ces deux-là, car elles ont le mérite de fonctionner sur tous les navigateurs de la même façon.</p></aside><p id="r-411209" data-claire-element-id="411209">Aller, un premier exemple avec onclick :</p><pre id="r-411210" data-claire-element-id="411210"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;test coordonnées&lt;/title&gt;
&lt;script type=&quot;text/javascript&quot;&gt;function onclick_page(event)
{
  var x = event.clientX;
  var y = event.clientY;
  alert('Vous avez cliqué au point de coordonnés: ' + x + ', ' + y );
}&lt;/script&gt;

&lt;/head&gt;
&lt;body onclick=&quot;onclick_page(event);&quot;&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-411211" data-claire-element-id="411211"><a href="http://b2moo.free.fr/tutorials/mouse/ex_1.htm">Tester ce code</a></p><h5 id="r-exercice-35" data-claire-element-id="411213">Exercice</h5><p id="r-411212" data-claire-element-id="411212">Au lieu d'ouvrir une boîte de dialogue (alert), faites en sorte que le message apparaisse dans une zone de texte dans la page web. Ensuite, remplacez l'évènement <strong>onclick</strong> par un évènement <strong>onmousemove</strong>. Les coordonnées vont être mises à jour à chaque déplacement de la souris !</p><h5 id="r-correction-135" data-claire-element-id="411219">Correction</h5><aside id="r-411215" data-claire-element-id="411215" data-claire-semantic="warning"><p id="r-411214" data-claire-element-id="411214">N'utilisez jamais la fonction <strong>alert</strong> avec un évènement <strong>onmousemove</strong> !<br/> Comme cet évènement est appelé à chaque déplacement de la souris, vous vous seriez retrouvés bombardés d'alert. (Si vous l'avez déjà fait maintenant, vous comprenez de quoi je parle.)</p></aside><p id="r-411216" data-claire-element-id="411216">Si vous avez besoin d'un moyen pour connaître l'état d'une variable (pour déboguer), il faudra utiliser des fonctions comme console.debug (pour firebug).</p><pre id="r-411217" data-claire-element-id="411217"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;test coordonnées&lt;/title&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
function souris(event)
{
  var x = event.clientX;
  var y = event.clientY;
  document.getElementById('coordonnes').value = x + ', ' + y;
}
&lt;/script&gt;

&lt;/head&gt;
&lt;body onmousemove=&quot;souris(event);&quot;&gt;
  &lt;div id=&quot;info&quot;&gt;
    Coordonnées de la souris : &lt;input type=&quot;text&quot; id=&quot;coordonnes&quot; value=&quot;inconnues&quot; readonly=&quot;readonly&quot; /&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-411218" data-claire-element-id="411218"><a href="http://b2moo.free.fr/tutorials/mouse/ex_2.htm">Tester ce code</a></p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
<span class="arrow"></span>
<span class="next">La variable event</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
<span class="next">Position absolue</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Positionabsolue"></a><h2>Position absolue</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
<span class="arrow"></span>
<span class="next">Les coordonnées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
<span class="next">Fil rouge : gestion des fenêtres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-position-absolue" data-claire-element-id="411246">Position absolue</h4><p id="r-411221" data-claire-element-id="411221">On peut placer une balise HTML exactement là où on le souhaite grâce au style CSS et à l'utilisation des positions absolues. Il suffit alors d'indiquer à l'aide des propriétés <strong>left</strong> et <strong>top</strong> l'abscisse et l'ordonnée de l'élément.<br/> Par exemple, pour placer le div qui porte l'id info (dans l'exemple précédent), à 30 pixels du bord gauche et à 100 pixels en dessous de la page, on ferait :</p><pre id="r-411222" data-claire-element-id="411222"><code data-claire-semantic="css">#info
{
  position: absolute;
  left: 30px;
  top: 100px;
}</code></pre><p id="r-411223" data-claire-element-id="411223">Oui, oui, mais on va faire ce placement en Javascript grâce au DOM !</p><h6 id="r-petits-rappels-2" data-claire-element-id="411245">Petits rappels</h6><ul id="r-411230" data-claire-element-id="411230"><li id="r-411226" data-claire-element-id="411226"><p id="r-411224" data-claire-element-id="411224">Pour récupérer l'élément HTML qui porte l'id blabla :</p><pre id="r-411225" data-claire-element-id="411225"><code data-claire-semantic="javascript">var element = document.getElementById('blabla');</code></pre></li><li id="r-411229" data-claire-element-id="411229"><p id="r-411227" data-claire-element-id="411227">Pour modifier le style CSS d'un élément, par exemple <strong>background-color</strong> :</p><pre id="r-411228" data-claire-element-id="411228"><code data-claire-semantic="javascript">element.style.backgroundColor = '#FFF'; //Pour chaque tiret, on remplace la lettre suivante par une majuscule</code></pre></li></ul><p id="r-411231" data-claire-element-id="411231">Modifiez le dernier exemple pour qu'en plus d'afficher les coordonnées de la souris, il déplace le <strong>&lt;div id=&quot;info&quot;&gt;</strong> au même endroit que la souris.</p><aside id="r-411240" data-claire-element-id="411240" data-claire-semantic="information"><p id="r-411232" data-claire-element-id="411232">Derniers (petits) conseils :</p><ul id="r-411239" data-claire-element-id="411239"><li id="r-411234" data-claire-element-id="411234"><p id="r-411233" data-claire-element-id="411233">indiquez toujours les unités en CSS, ici ça sera px ;</p></li><li id="r-411236" data-claire-element-id="411236"><p id="r-411235" data-claire-element-id="411235">pensez bien à indiquer que l'élément est en position absolute ;</p></li><li id="r-411238" data-claire-element-id="411238"><p id="r-411237" data-claire-element-id="411237">pour mieux vérifier que le div bouge, vous pouvez placer des bordures ou une couleur d'arrière plan.</p></li></ul></aside><h5 id="r-correction-136" data-claire-element-id="411244">Correction</h5><p id="r-411241" data-claire-element-id="411241">Bon, avec tous les indices que je vous ai donnés, ça n'a pas dû être très dur. :p</p><pre id="r-411242" data-claire-element-id="411242"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;test coordonnées&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
#info
{
        background-color: #DDD;
        border: 1px solid #000;
}
&lt;/style&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
function souris(event)
{
  var x = event.clientX;
  var y = event.clientY;
  document.getElementById('coordonnes').value = x + ', ' + y;
  //Nouveau code :
  var element = document.getElementById('info');
  element.style.position = 'absolute';
  element.style.left = x + 'px';
  element.style.top = y + 'px';
}
&lt;/script&gt;

&lt;/head&gt;
&lt;body onmousemove=&quot;souris(event);&quot;&gt;
        &lt;div id=&quot;info&quot;&gt;
                Coordonnées de la souris : &lt;input type=&quot;text&quot; id=&quot;coordonnes&quot; value=&quot;inconnues&quot; readonly=&quot;readonly&quot; /&gt;
        &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-411243" data-claire-element-id="411243"><a href="http://b2moo.free.fr/tutorials/mouse/ex_3.htm">Tester</a> : le bloc suit la souris</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
<span class="arrow"></span>
<span class="next">Les coordonnées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
<span class="next">Fil rouge : gestion des fenêtres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Filrougegestiondesfentres"></a><h2>Fil rouge : gestion des fenêtres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
<span class="arrow"></span>
<span class="next">Position absolue</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">
<span class="next">Les coordonnées des blocs</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-fil-rouge-gestion-des-fenetres" data-claire-element-id="411286">Fil rouge : gestion des fenêtres</h4><p id="r-411247" data-claire-element-id="411247">On va commencer notre script qui imite des fenêtres. Il nous faut déjà un bloc (div) jouant le rôle de fenêtre déplaçable ainsi qu'un autre bloc pour la barre de titre. Enfin, un petit bouton pour minimiser pourrait également servir.</p><p id="r-411248" data-claire-element-id="411248">On obtient donc un code HTML de ce genre :</p><pre id="r-411249" data-claire-element-id="411249"><code data-claire-semantic="html">&lt;div id=&quot;fenetre&quot;&gt;
  &lt;div class=&quot;barre&quot; onmousedown=&quot;start_drag(document.getElementById('fenetre'), event);&quot;&gt;
    &lt;button class=&quot;close&quot; onclick=&quot;document.getElementById('fenetre').parentNode.removeChild(document.getElementById('fenetre'));&quot;&gt;X&lt;/button&gt;
    Titre
  &lt;/div&gt;
  Contenu de la page !!
&lt;/div&gt;</code></pre><aside id="r-411251" data-claire-element-id="411251" data-claire-semantic="information"><p id="r-411250" data-claire-element-id="411250">Ce n'est pas grave si vous ne comprenez pas le code Javascript du bouton de fermeture. En gros, il fait disparaître le &lt;div id=&quot;fenetre&quot;&gt; de la page.</p></aside><p id="r-411252" data-claire-element-id="411252">J'ai déjà rajouté un évènement <strong>onmousedown</strong> sur la barre de titre, qui va appeler notre fonction et déclencher le début du déplacement.</p><p id="r-411253" data-claire-element-id="411253">On stockera l'élément en cours de déplacement dans une variable : dragged (c'est moi qui ai décidé de l'appeler comme ça :p ) et on va avoir besoin de deux autres évènements :</p><ul id="r-411258" data-claire-element-id="411258"><li id="r-411255" data-claire-element-id="411255"><p id="r-411254" data-claire-element-id="411254"><strong>onmousemove</strong> pour déplacer l'élément à chaque mouvement de souris ;</p></li><li id="r-411257" data-claire-element-id="411257"><p id="r-411256" data-claire-element-id="411256"><strong>onmouseup</strong> qui se chargera d'arrêter le déplacement lorsqu'on lâchera la souris.</p></li></ul><p id="r-411259" data-claire-element-id="411259">Je vous laisse essayer un peu avant de vous montrer comment j'ai fait (il y a sûrement plusieurs méthodes).</p><h5 id="r-correction-137" data-claire-element-id="411270">Correction</h5><p id="r-411260" data-claire-element-id="411260">Ci-dessous le style CSS ajouté ; sûrement une question de goût et le mien est assez mauvais.<br/> Voilà mon résultat (avec les artistes que vous êtes, je suis sûr que vous avez fait mieux :p ) :</p><figure id="r-411262" data-claire-element-id="411263"><img id="r-411261" data-claire-element-id="411261" src="medias/uploads.siteduzero.com_files_77001_78000_77394.png" alt="Image utilisateur"/></figure><pre id="r-411264" data-claire-element-id="411264"><code data-claire-semantic="css">#fenetre
{
        position: absolute;
        width: 400px;
        height: 200px;
        background-color: #DDD;
        border: 1px solid #000;
}

.close
{
        float: right;
        background-color: #EEE;
}

.barre
{
        width: 100%;
        height: 30px;
        background-color: #00D;
        color: #FFF;
        cursor: hand;
}</code></pre><p id="r-411265" data-claire-element-id="411265">Pour le code Javascript, j'ai décidé de commencer à rajouter les évènements (onmousemove et onmousedown) dynamiquement sans avoir à toucher au code HTML.<br/> Pour &quot;capter&quot; le maximum de déplacement, on va fixer ces évènements sur l'élément HTML le plus haut possible : <strong>document</strong>.</p><aside id="r-411267" data-claire-element-id="411267" data-claire-semantic="error"><p id="r-411266" data-claire-element-id="411266">On ne peut pas récupérer les évènements qui se produisent en dehors de <strong>document</strong> et d'une certaine manière, c'est meilleur pour notre sécurité sur Internet. :-° <br/> Cela signifie que le déplacement d'un bloc va se retrouver perturbé si la souris sort de la fenêtre du navigateur et on ne peut rien y faire.</p></aside><pre id="r-411268" data-claire-element-id="411268"><code data-claire-semantic="javascript">var dragged = null; //L'élément en cours de drag
//Lorsque dragged = null, il n'y a rien en cours de déplacement


function start_drag(objet,event)
{
  dragged = objet; //On le place comme objet en cours
}

function drag_onmousemove(event)  //Lorsque la souris se déplace
{
  if( dragged ) //s'il n'y a pas d'élément en cours de déplacement, inutile de le déplacer :) 
  {
    var x = event.clientX;
    var y = event.clientY;
    dragged.style.position = 'absolute';
    dragged.style.left = x + 'px';
    dragged.style.top = y + 'px';
  }
}

function drag_onmouseup(event)  //Lorsque le bouton de la souris est relâché
{
  dragged = null; //On arrête le drag &amp; drop
}

//Ma petite fonction &quot;magique&quot; pour ajouter des évènements
function addEvent(obj,event,fct)
{
  if( obj.attachEvent)
     obj.attachEvent('on' + event,fct);
  else
     obj.addEventListener(event,fct,true);
}

//On ajoute les deux évènements avec la méthode
addEvent(document,'mousemove',drag_onmousemove);
addEvent(document,'mouseup',drag_onmouseup);</code></pre><p id="r-411269" data-claire-element-id="411269"><a href="http://b2moo.free.fr/tutorials/mouse/win_1.htm">Tester</a> la première version du script de fenêtres</p><h5 id="r-comportement-par-defaut-2" data-claire-element-id="411276">Comportement par défaut</h5><p id="r-411271" data-claire-element-id="411271">Un bug assez gênant apparaît pendant le déplacement : le texte est sélectionné, et c'est assez moche comme effet. :-° <br/> De la part du navigateur, c'est assez logique : quand on enfonce un bouton de la souris et qu'on la déplace, c'est pour sélectionner du texte, c'est ce qu'il doit se passer par défaut.<br/> Ici, ce n'est pas ce qu'on souhaite faire et il faut donc annuler ce comportement par défaut :</p><pre id="r-411272" data-claire-element-id="411272"><code data-claire-semantic="javascript">//des lignes à rajouter dans start_drag:
event.returnValue = false; //Pour Internet Explorer
if( event.preventDefault ) event.preventDefault();</code></pre><p id="r-411273" data-claire-element-id="411273">(Cela ressemble beaucoup à return false; que l'on voit souvent.)</p><aside id="r-411275" data-claire-element-id="411275" data-claire-semantic="information"><p id="r-411274" data-claire-element-id="411274"><strong>returnValue</strong> est nécessaire pour Internet Explorer, alors que la plupart des autres navigateurs utilisent la fonction <strong>preventDefault()</strong>. ;)</p></aside><h5 id="r-prendre-en-compte-le-scroll" data-claire-element-id="411285">Prendre en compte le scroll</h5><p id="r-411277" data-claire-element-id="411277">Si vous avez eu l'occasion de tester ce code et que vous avez <em>scrollé</em> (bougé l'ascenseur, vertical ou horizontal), vous avez sûrement remarqué un décalage . Il faut donc rajouter à x et y la position actuelle des ascenseurs (horizontaux et verticaux):</p><pre id="r-411278" data-claire-element-id="411278"><code data-claire-semantic="javascript">var x = event.clientX + (document.body.scrollLeft || document.documentElement.scrollLeft);
var y = event.clientY + (document.body.scrollTop || document.documentElement.scrollTop);</code></pre><aside id="r-411280" data-claire-element-id="411280" data-claire-semantic="information"><p id="r-411279" data-claire-element-id="411279">On est obligé d'utiliser deux valeurs : suivant le <em>doctype</em> du document. Avec XHTML, on a toujours <strong>document.body</strong>.scrollTop (et Left) = 0, sinon <strong>document.documentElement</strong>.scrollTop (et Left) = 0. Dans le doute, on indique les deux.</p></aside><p id="r-411281" data-claire-element-id="411281">Et voilà, on sait déplacer un bloc en fonction des mouvements de la souris mais ...</p><div id="r-411283" data-claire-element-id="411283" data-claire-semantic="question"><p id="r-411282" data-claire-element-id="411282">Oui mais... la souris reste toujours accrochée au même endroit, c'est nul !! :(</p></div><p id="r-411284" data-claire-element-id="411284">Il faut garder le même décalage entre la souris et le bloc tout au long du déplacement !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
<span class="arrow"></span>
<span class="next">Position absolue</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">
<span class="next">Les coordonnées des blocs</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lescoordonnesdesblocs"></a><h2>Les coordonnées des blocs</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
<span class="arrow"></span>
<span class="next">Fil rouge : gestion des fenêtres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
<span class="next">Centrer</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-411288" data-claire-element-id="411288">On a vu comment connaître la position de la souris mais non la position (initiale) d'un élément. <br/> Dans la plupart des cas, il faut effectuer un décalage vers la gauche et le haut, donc enlever (soustraire) aux coordonnées de la souris une certaine valeur.</p><p id="r-411289" data-claire-element-id="411289">On peut procéder par tâtonnement. Par exemple pour décaler de 100 et 60 pixels :</p><pre id="r-411290" data-claire-element-id="411290"><code data-claire-semantic="javascript">element.style.left = x - 100 + 'px';
element.style.top = y - 60 + 'px';</code></pre><p id="r-411291" data-claire-element-id="411291">Mais ça serait mieux avec des valeurs exactes.</p><figure id="r-411293" data-claire-element-id="411294"><img id="r-411292" data-claire-element-id="411292" src="medias/uploads.siteduzero.com_files_77001_78000_77391.png" alt="Image utilisateur"/></figure><p id="r-411295" data-claire-element-id="411295">À la fin de ce tutoriel, on saura comment centrer un bloc au-dessus de la souris et comment conserver le décalage initial entre la souris et nos &quot;fenêtres&quot;.</p>
</div><a name="Centrer"></a><h2>Centrer</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">
<span class="arrow"></span>
<span class="next">Les coordonnées des blocs</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
<span class="next">Coordonnées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-centrer" data-claire-element-id="411308">Centrer</h4><p id="r-411296" data-claire-element-id="411296">On veut centrer le bloc autour de la souris lors du déplacement.</p><p id="r-411297" data-claire-element-id="411297">Il faut donc connaître la largeur et hauteur du bloc pour les diviser par 2 et obtenir le décalage permettant de centrer le bloc.</p><p id="r-411298" data-claire-element-id="411298"><cite>Citation</cite></p><blockquote id="r-411300" data-claire-element-id="411300"><p id="r-411299" data-claire-element-id="411299">Cool, et bah on a juste à utiliser <strong>style.width</strong> et <strong>style.heigth</strong>. :-°</p></blockquote><p id="r-411301" data-claire-element-id="411301">Non! J'ai une meilleure méthode à vous proposer !</p><p id="r-411302" data-claire-element-id="411302">Premièrement, si on s'appuie sur le style CSS, on n'est pas sûr qu'il s'agisse de la bonne largeur (elle peut ne pas être définie ou le texte peut déborder). Il vaut mieux utiliser les propriétés <strong>offsetWidth</strong> et <strong>offsetHeight</strong>.</p><p id="r-411303" data-claire-element-id="411303">Je vous laisse modifier le code de notre script de fenêtre pour que le bloc reste centré :</p><div id="r-411306" data-claire-element-id="411306"><div id="r-411305" data-claire-element-id="411305"><pre id="r-411304" data-claire-element-id="411304"><code data-claire-semantic="javascript">x -= dragged.offsetWidth / 2; //On décale vers la gauche, donc -
y -= dragged.offsetHeight / 2;</code></pre></div></div><p id="r-411307" data-claire-element-id="411307"><a href="http://b2moo.free.fr/tutorials/mouse/win_2.htm">Tester cet exemple</a> : la souris reste au centre de la fenêtre</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">
<span class="arrow"></span>
<span class="next">Les coordonnées des blocs</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
<span class="next">Coordonnées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Coordonnes"></a><h2>Coordonnées</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
<span class="arrow"></span>
<span class="next">Centrer</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
<span class="next">Fil rouge : décalage initial</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-coordonnees" data-claire-element-id="411320">Coordonnées</h4><p id="r-411309" data-claire-element-id="411309">Comment connaître la position initiale d'un bloc ? On pourrait utiliser <strong>.style.top</strong> et <strong>.style.left</strong> mais si je vous en parle, c'est qu'il y a forcément mieux. :-°</p><p id="r-411310" data-claire-element-id="411310">On va utiliser <strong>offsetLeft</strong> et <strong>offsetTop</strong> qui nous donnent les coordonnées x et y d'un élément HTML par rapport à son conteneur (<strong>offsetParent</strong>). <br/> Là où ça se complique, c'est que le conteneur lui-même possède des propriétés <strong>offsetLeft</strong> et <strong>offsetTop</strong> par rapport à un autre conteneur ! :p</p><figure id="r-411312" data-claire-element-id="411313"><img id="r-411311" data-claire-element-id="411311" src="medias/uploads.siteduzero.com_files_77001_78000_77411.png" alt="Image utilisateur"/></figure><p id="r-411314" data-claire-element-id="411314"><em>Il faut donc tout additionner en remontant de conteneur en conteneur jusqu'à arriver à la page entière elle-même.</em></p><pre id="r-411315" data-claire-element-id="411315"><code data-claire-semantic="javascript">var elementX = 0;
var elementY = 0;
var element = objet;
while(element)
{
  //On rajoute des coordonnées
  elementX += element.offsetLeft;
  elementY += element.offsetTop;
  element = element.offsetParent;
}</code></pre><p id="r-411316" data-claire-element-id="411316">En réalité, on va s'arrêter dans la boucle dès que l'on trouve un premier élément en position absolue.</p><aside id="r-411318" data-claire-element-id="411318" data-claire-semantic="information"><p id="r-411317" data-claire-element-id="411317">Quand on place un bloc en position absolue, les propriétés left et top des éléments qu'il contient s'appliquent par rapport à ce bloc, et non pas par rapport à la page entière.</p></aside><pre id="r-411319" data-claire-element-id="411319"><code data-claire-semantic="javascript">do //On utilise un do-while au lieu d'un while car la cible elle-même est en position absolue (vu qu'on va la déplacer)
{
  //On rajoute des coordonnées
  elementX += element.offsetLeft;
  elementY += element.offsetTop;
  element = element.offsetParent;
}while(element &amp;&amp; element.style.position != 'absolute');</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
<span class="arrow"></span>
<span class="next">Centrer</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
<span class="next">Fil rouge : décalage initial</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Filrougedcalageinitial"></a><h2>Fil rouge : décalage initial</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
<span class="arrow"></span>
<span class="next">Coordonnées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">
<span class="next">Les cibles</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-fil-rouge-decalage-initial" data-claire-element-id="411331">Fil rouge : décalage initial</h4><p id="r-411321" data-claire-element-id="411321">Maintenant que l'on possède les coordonnées, on peut connaître le décalage initial qui existe entre la souris et le bloc lui-même. Décalage qu'il va falloir conserver au cours du déplacement :</p><figure id="r-411323" data-claire-element-id="411324"><img id="r-411322" data-claire-element-id="411322" src="medias/uploads.siteduzero.com_files_77001_78000_77412.png" alt="Image utilisateur"/></figure><p id="r-411325" data-claire-element-id="411325">Pas besoin de plus d'explications je pense, vous pouvez essayer par vous-mêmes (ou... si vous êtes paresseux, regarder directement comment faire :-° ).</p><h5 id="r-correction-138" data-claire-element-id="411330">Correction</h5><p id="r-411326" data-claire-element-id="411326">Ce décalage, on le calcule au départ (fonction start_drag) et on le stocke dans deux variables (dX et dY).<br/> On le réapplique ensuite lors du déplacement.</p><pre id="r-411327" data-claire-element-id="411327"><code data-claire-semantic="javascript">//Partie du code ayant changé
var dX, dY;

function start_drag(objet,event)
{
  dragged = objet;

  event.returnValue = false;
  if( event.preventDefault ) event.preventDefault();
        
  //Coordonnées de la souris
  var x = event.clientX + (document.documentElement.scrollLeft + document.body.scrollLeft);
  var y = event.clientY + (document.documentElement.scrollTop + document.body.scrollTop);
        

  //Coordonnées de l'élément
  var eX = 0;
  var eY = 0;
  var element = objet;
  do
  {
    eX += element.offsetLeft;
    eY += element.offsetTop;
    element = element.offsetParent;
  } while( element &amp;&amp; element.style.position != 'absolute');

  //Calcul du décallage
  dX = x - eX;
  dY = y - eY;

}

function drag_onmousemove(event) 
{
  if( dragged ) 
  {
    var x = event.clientX + (document.documentElement.scrollLeft + document.body.scrollLeft);
    var y = event.clientY + (document.documentElement.scrollTop + document.body.scrollTop);
                
    //On applique le décalage
    x -= dX;
    y -= dY;

    dragged.style.position = 'absolute';
    dragged.style.left = x + 'px';
    dragged.style.top = y + 'px';
  }
}</code></pre><p id="r-411328" data-claire-element-id="411328"><a href="http://b2moo.free.fr/tutorials/mouse/win_3.htm">Notre petite fenêtre</a> en cours de déplacement :magicien:</p><p id="r-411329" data-claire-element-id="411329">On sait récupérer les coordonnées de la souris, des éléments, leur décalage. À partir de là, on peut imaginer plein d'applications. :) Il faut surtout un peu d'imagination et... parfois un peu de mathématiques !<br/> Mais comme vous avez pu le voir, la plupart du temps, c'est surtout des additions, soustractions, multiplications et divisions. :-°</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
<span class="arrow"></span>
<span class="next">Coordonnées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">
<span class="next">Les cibles</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lescibles"></a><h2>Les cibles</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
<span class="arrow"></span>
<span class="next">Fil rouge : décalage initial</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
<span class="next">La propagation des évènements</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-411333" data-claire-element-id="411333">Dans tous nos scripts précédents, on était obligés de mettre des évènements <strong>onmousedown</strong> partout, sur chaque élément que l'on voulait déplacer. En règle générale, il est normalement déconseillé de mélanger le Javascript avec le code HTML à l'intérieur d'une page, car il faut séparer le contenu (HTML), de la présentation (CSS) et du comportement (Javascript).</p><p id="r-411334" data-claire-element-id="411334">Alors, au chargement de la page, on pourrait assigner dynamiquement chaque évènement sur chaque bloc :</p><pre id="r-411335" data-claire-element-id="411335"><code data-claire-semantic="javascript">function rendre_deplacable(objet)
{
  addEvent(objet,'mousedown',function (event) {
    start_drag(objet, event);
  });
}

window.onload = function ()
{
  var elements = document.getElementsByTagName('div'); //on va rendre déplaçables toutes les div
  for( var i = 0; i &lt; elements.length; i++)
  {
    rendre_deplacable(elements.item(i));
  }
}</code></pre><div id="r-411337" data-claire-element-id="411337" data-claire-semantic="question"><p id="r-411336" data-claire-element-id="411336">Mais ensuite, si on rajoute de nouveaux div dans notre page (dynamiquement), ils ne seront pas déplaçables ?</p></div><p id="r-411338" data-claire-element-id="411338">Eh non. :( À chaque nouveau div, il faudra rajouter l'évènement Javascript qui va avec. On pourrait utiliser la fonction <em>rendre_deplacable()</em> mais on va apprendre ici une nouvelle méthode.</p>
</div><a name="Lapropagationdesvnements"></a><h2>La propagation des évènements</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">
<span class="arrow"></span>
<span class="next">Les cibles</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
<span class="next">Récupérer la cible</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-la-propagation-des-evenements" data-claire-element-id="411351">La propagation des évènements</h4><p id="r-411339" data-claire-element-id="411339">Essayons d'imbriquer deux éléments qui réagissent tous deux au même évènement :</p><pre id="r-411340" data-claire-element-id="411340"><code data-claire-semantic="html">&lt;div onmousedown=&quot;start_drag(this,event);&quot; style=&quot;width: 500px; height: 500px; background-color: green;&quot;&gt;
  &lt;div onmousedown=&quot;start_drag(this,event);&quot; style=&quot;width: 200px; height: 200px; background-color: yellow;&quot;&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre><p id="r-411341" data-claire-element-id="411341"><a href="http://b2moo.free.fr/tutorials/mouse/bub_1.htm">Tester</a> cet exemple qui contient un bogue</p><div id="r-411343" data-claire-element-id="411343" data-claire-semantic="question"><p id="r-411342" data-claire-element-id="411342">On a placé un évènement <strong>onmousedown</strong> sur le div jaune, pourtant, il ne se déplace jamais ! C'est toujours le vert qui bouge !?</p></div><p id="r-411344" data-claire-element-id="411344">C'est dû à la propagation des évènements. Lorsqu'on clique sur le div jaune, on clique également sur le div vert conteneur. La fonction start_drag est donc immédiatement appelée pour le div jaune puis pour le vert.</p><figure id="r-411346" data-claire-element-id="411347"><img id="r-411345" data-claire-element-id="411345" src="medias/uploads.siteduzero.com_files_77001_78000_77414.png" alt="Image utilisateur"/></figure><p id="r-411348" data-claire-element-id="411348"><em>La fonction</em>onmousedown<em> du bloc jaune est d'abord lue, puis celle du </em>div<em> vert, puis le </em>onmousedown<em> présent sur la page entière.</em><br/> Pour éviter, cette propagation, appelée &quot;bubbling&quot; (bouillonnement) car l'évènement se propage comme une bulle, il faut rajouter une ligne à la fin de start_drag :</p><pre id="r-411349" data-claire-element-id="411349"><code data-claire-semantic="javascript">event.cancelBubble = true;</code></pre><p id="r-411350" data-claire-element-id="411350"><a href="http://b2moo.free.fr/tutorials/mouse/bub_2.htm">Et voilà</a> l'exemple précédent fonctionnel</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">
<span class="arrow"></span>
<span class="next">Les cibles</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
<span class="next">Récupérer la cible</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Rcuprerlacible"></a><h2>Récupérer la cible</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
<span class="arrow"></span>
<span class="next">La propagation des évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
<span class="next">Avec des classes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-recuperer-la-cible" data-claire-element-id="411365">Récupérer la cible</h4><p id="r-411352" data-claire-element-id="411352">On a vu que les évènements se propagent jusqu'à arriver sur l'objet <strong>document</strong>. Soyons fainéants (les programmeurs sont des fainéants :p ) et attendons qu'il arrive jusqu'au document plutôt que de placer des <strong>onmousedown</strong> partout.</p><aside id="r-411354" data-claire-element-id="411354" data-claire-semantic="information"><p id="r-411353" data-claire-element-id="411353">Mais si on place l'évènement sur le document lui-même, comment savoir sur quel objet s'est produit l'évènement ?</p></aside><p id="r-411355" data-claire-element-id="411355">C'est là qu'il falloir utiliser une autre propriété de l'objet <strong>event</strong> :) Sur la plupart des navigateurs, on utilisera <strong>event.target</strong><br/> alors que sur Internet Explorer, il faudra utiliser <strong>event.srcElement</strong>.</p><p id="r-411356" data-claire-element-id="411356">Pour un code qui marche partout, on va donc créer une variable universelle :</p><pre id="r-411357" data-claire-element-id="411357"><code data-claire-semantic="javascript">var target = event.target || event.srcElement</code></pre><p id="r-411358" data-claire-element-id="411358">Grâce à elle, on peut savoir sur quel élément précis on a cliqué (ou bougé) :</p><pre id="r-411359" data-claire-element-id="411359"><code data-claire-semantic="javascript">document.onclick = function (event)
{
  event = event || window.event;
  var target = event.target || event.srcElement;
  
  var type;
  if(target.nodeType == 1)
    type = 'Tag: ' + target.tagName;
  else
    type = target;
   alert('Vous avez cliqué sur ' + type);
};</code></pre><p id="r-411360" data-claire-element-id="411360"><a href="http://b2moo.free.fr/tutorials/mouse/target_1.htm">Ce script</a> permet de savoir sur quelle balise on a cliqué</p><p id="r-411361" data-claire-element-id="411361">Grâce à cela, on peut lancer directement un déplacement de bloc, sans avoir à ajouter un évènement sur le bloc en question :</p><pre id="r-411362" data-claire-element-id="411362"><code data-claire-semantic="javascript">addEvent(document,'mousedown',function (event)
{
  var target = event.target || event.srcElement;
  start_drag(target, event);
});</code></pre><p id="r-411363" data-claire-element-id="411363"><a href="http://b2moo.free.fr/tutorials/mouse/target_2.htm">Ce code</a> démarre un déplacement de la balise HTML situé juste en dessous de la souris</p><p id="r-411364" data-claire-element-id="411364">Ce n'est pas exactement ce qu'on veut faire mais on va voir comment corriger ce bogue. ;)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
<span class="arrow"></span>
<span class="next">La propagation des évènements</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
<span class="next">Avec des classes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Avecdesclasses"></a><h2>Avec des classes</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
<span class="arrow"></span>
<span class="next">Récupérer la cible</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
<span class="next">Fil rouge : sans ajout d&#039;évènement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-avec-des-classes" data-claire-element-id="411378">Avec des classes</h4><p id="r-411366" data-claire-element-id="411366">Il va donc falloir trouver un moyen d'identifier les objets HTML que l'on a le droit de bouger et ceux qui sont fixes. Je vous propose donc d'utiliser les classes pour identifier ce qui est déplaçable.</p><aside id="r-411368" data-claire-element-id="411368" data-claire-semantic="information"><p id="r-411367" data-claire-element-id="411367">Pour connaître la classe d'un élément en Javascript, il faut utiliser <strong>element.className</strong>. ;)</p></aside><p id="r-411369" data-claire-element-id="411369">On va placer une classe sur les éléments de la page qui ont le droit d'être déplacés. Par exemple, on va mettre la classe deplacable.<br/> Lorsqu'on clique sur un élément, on clique aussi sur son parent. Il va falloir tester l'existence de la classe sur tous les parents de la cible jusqu'à en trouver un qui possède la classe que l'on désire ou si on n'en trouve aucun, ne rien faire :</p><pre id="r-411370" data-claire-element-id="411370"><code data-claire-semantic="javascript">addEvent(document,'mousedown',function (event)
{
  var target = event.target || event.srcElement;
  
  var element = target;
  while(element)
  {
    if( element.className &amp;&amp; element.className == 'deplacable')
    {
      start_drag(element, event);
      element = false; //On stoppe la boucle : sinon, on va se retrouver avec le même problème que le bubbling car le déplacement va aussi se déclencher pour les parents 
    }
    else
      element = element.parentNode; //Sinon, on continue à remonter dans les ancêtres de la cible
  }

});</code></pre><p id="r-411371" data-claire-element-id="411371"><a href="http://b2moo.free.fr/tutorials/mouse/target_3.htm">Tester</a> : pensez aussi à rajouter class=&quot;deplacable&quot; sur le div de la fenêtre.</p><h5 id="r-plusieurs-classes" data-claire-element-id="411377">Plusieurs classes</h5><p id="r-411372" data-claire-element-id="411372">Et si on profitait du fait qu'il est possible de mettre plusieurs classes sur un même tag HTML ? Il suffit de séparer par un espace :</p><pre id="r-411373" data-claire-element-id="411373"><code data-claire-semantic="html">&lt;div class=&quot;classe1 classe2 classe3&quot;&gt;&lt;/div&gt;</code></pre><p id="r-411374" data-claire-element-id="411374">Avec une regex, on peut savoir si tel ou tel objet possède telle classe :</p><pre id="r-411375" data-claire-element-id="411375"><code data-claire-semantic="javascript">if( bloc.className &amp;&amp; bloc.className.match(/\bclasse1\b/g) )
{
  alert( 'Ce bloc possède bien la classe &quot;classe1&quot; !');
}</code></pre><p id="r-411376" data-claire-element-id="411376">(Les \b sont des assertions pour indiquer un espace entre deux mots. ;) )<br/> Comme on peut mettre plusieurs classes, on peut indiquer d'un côté le comportement Javascript de l'élément, et d'un autre côté l'apparence qu'il aura grâce au style CSS.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
<span class="arrow"></span>
<span class="next">Récupérer la cible</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
<span class="next">Fil rouge : sans ajout d&#039;évènement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Filrougesansajoutd039vnement"></a><h2>Fil rouge : sans ajout d&#039;évènement</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
<span class="arrow"></span>
<span class="next">Avec des classes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">
<span class="next">Finalisation du script de fenêtres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-fil-rouge-sans-ajout-d-evenement" data-claire-element-id="411405">Fil rouge : sans ajout d'évènement</h4><p id="r-411379" data-claire-element-id="411379">Nous allons modifier notre script de &quot;fausses fenêtres&quot; pour le rendre plus universel, nous n'aurons plus besoin de taper une seule ligne de code Javascript dans notre code HTML. Juste rajouter des classes pour identifier chaque élément de la fenêtre.</p><p id="r-411380" data-claire-element-id="411380">Je vous propose cette liste de classes :</p><ul id="r-411389" data-claire-element-id="411389"><li id="r-411382" data-claire-element-id="411382"><p id="r-411381" data-claire-element-id="411381">window-base à placer sur la fenêtre elle-même pour indiquer que c'est elle qui bouge ;</p></li><li id="r-411384" data-claire-element-id="411384"><p id="r-411383" data-claire-element-id="411383">window-move à placer sur les objets qui vont déclencher un déplacement (la barre des titres par exemple) ;</p></li><li id="r-411386" data-claire-element-id="411386"><p id="r-411385" data-claire-element-id="411385">window-close à placer sur les boutons qui vont fermer la fenêtre.</p></li><li id="r-411388" data-claire-element-id="411388"><p id="r-411387" data-claire-element-id="411387">window-min-max à placer sur les boutons qui vont maximiser ou non la fenêtre.</p></li></ul><aside id="r-411391" data-claire-element-id="411391" data-claire-semantic="information"><p id="r-411390" data-claire-element-id="411390">Vous pouvez en rajoutez ou en enlever si vous ne trouvez pas les miennes utiles :p ; il est assez basique, mon système.<br/> Cet exo' est assez libre.</p></aside><p id="r-411392" data-claire-element-id="411392">(On pourrait par exemple faire un système de barre des tâches, mais honnêtement, je suis trop paresseux ; je n'ai donc pas proposé le bouton &quot;réduire&quot; :p .)</p><h5 id="r-correction-139" data-claire-element-id="411404">Correction</h5><p id="r-411393" data-claire-element-id="411393">On possède déjà une fonction start_drag mais il nous faut aussi des fonctions pour fermer et maximiser les fenêtres.</p><pre id="r-411394" data-claire-element-id="411394"><code data-claire-semantic="javascript">function min_max(fenetre)
{
  if( fenetre.style.width != '100%' &amp;&amp; fenetre.style.height != '100%') //si la fenêtre n'est pas déjà maximisée
  {
     fenetre.style.width = '100%'; //maximum largeur et hauteur
     fenetre.style.height = '100%';
     fenetre.style.position = 'absolute';
     fenetre.style.left = 0;  //à partir du coin en haut à gauche
     fenetre.style.top = 0;
  }
  else
  {
    fenetre.style.width = '';
    fenetre.style.height = '';
  }
}

function close(fenetre)
{
  fenetre.parentNode.removeChild(fenetre);  //On peut enlever le bloc du document
  //ou: fenetre.style.display = 'none';     //ou alors le cacher avec du style CSS
}</code></pre><p id="r-411395" data-claire-element-id="411395">Une fois ces fonctions créées, il faut rajouter un évènement <strong>onmousedown</strong> sur la page entière pour tout récupérer. On récupère dans un premier temps la fenêtre mais aussi les boutons pour savoir quelle action on doit faire.</p><pre id="r-411396" data-claire-element-id="411396"><code data-claire-semantic="javascript">function drag_onmousedown (event)
{
  var target = event.target || event.srcElement;
  
  //On commence par trouver la fenêtre elle-même
  var fenetre = target;
  while( fenetre)
  {
    if( fenetre.className &amp;&amp; fenetre.className.match(/bwindow-baseb/g))
    {
       break; //On arrête la boucle
    }
    fenetre = fenetre.parentNode;
  }
  if( !fenetre) //Si on est sortis de la boucle mais qu'on n'a trouvé aucune fenêtre, on abandonne
    return;

  //Maintenant, on part à la recherche d'un bouton déclencheur
  var element = target;
  while(element)
  {
    if( element.className)
    {
      if( element.className.match(/\bwindow-close\b/g))
      {
        close(fenetre);
        break;
      }
      else if( element.className.match(/\bwindow-min-max\b/g) )
      {
        min_max(fenetre);
        break;
      }
      else if( element.className.match(/\bwindow-move\b/g) )
      {
        start_drag(fenetre, event);
        break;
      }
    }
    element = element.parentNode;
  }
}
addEvent(document,'mousedown',drag_onmousedown);</code></pre><p id="r-411397" data-claire-element-id="411397"><a href="http://b2moo.free.fr/tutorials/mouse/win_4.htm">J'ai légèrement modifié</a> le code de la feuille de style pour ne plus faire référence à des id mais uniquement à des classes. On peut alors créer plusieurs fenêtres avec un simple copier-coller sans avoir de problèmes au niveau des id qui doivent être uniques.</p><p id="r-411398" data-claire-element-id="411398">En assignant un seul évènement Javascript : <strong>onmousedown</strong> sur la page entière, on a pu créer un système qui déplace juste certains blocs.<br/> Il n'y a plus de code Javascript parasite à l'intérieur du code HTML, les attributs classes permettent de dire comment va se comporter tel ou tel élément.</p><p id="r-411399" data-claire-element-id="411399">Notre système sépare le contenu de la présentation et du comportement. :)</p><aside id="r-411401" data-claire-element-id="411401" data-claire-semantic="information"><p id="r-411400" data-claire-element-id="411400">On ne pourra pas toujours utiliser cette méthode, mais quand elle est possible, elle est plus pratique que de placer des évènements sur chaque élément HTML.</p></aside><p id="r-411402" data-claire-element-id="411402">La première partie du tutoriel est terminée. On sait déplacer un objet, pour qu'il suive la souris. On a vu comment obtenir un décalage et aussi comment connaître l'élément qui est survolé par la souris.</p><p id="r-411403" data-claire-element-id="411403">Pour faire des scripts plus évolués, c'est surtout une histoire d'innovation (ou plutôt d'imagination ? :p ).</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
<span class="arrow"></span>
<span class="next">Avec des classes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">
<span class="next">Finalisation du script de fenêtres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Finalisationduscriptdefentres"></a><h2>Finalisation du script de fenêtres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
<span class="arrow"></span>
<span class="next">Fil rouge : sans ajout d&#039;évènement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
<span class="next">Une histoire d&#039;ordre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-411409" data-claire-element-id="411409">Ce dernier chapitre sur la gestion des fenêtres n'est pas essentiel pour la suite. Nous allons juste faire quelques petites améliorations pour avoir un script terminé totalement.<br/> Passez votre chemin si vous n'êtes pas intéressés par le système de fenêtres ou si vous voulez juste vous servir du script sans rien comprendre, lisez la conclusion. :p</p>
</div><a name="Unehistoired039ordre"></a><h2>Une histoire d&#039;ordre</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">
<span class="arrow"></span>
<span class="next">Finalisation du script de fenêtres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
<span class="next">Le vrai style CSS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-une-histoire-d-ordre" data-claire-element-id="411415">Une histoire d'ordre</h4><p id="r-411410" data-claire-element-id="411410">On peut créer toute une armée de fenêtres uniquement avec les classes et les styles CSS. Mais il se pose un dernier problème (si vous avez testé le dernier exemple) : la fenêtre en cours de déplacement ne passe pas au-dessus des autres.</p><p id="r-411411" data-claire-element-id="411411">Pour régler l'ordre de superposition des blocs, on utilise la propriété CSS <strong>z-index</strong>. Plus <strong>z-index</strong> est grand, plus il est placé devant les autres blocs. Pour faire revenir un bloc au premier plan, il faut connaître le z-index maximum sur la page pour placer notre nouveau bloc au-dessus des autres.</p><p id="r-411412" data-claire-element-id="411412">On va donc faire une boucle pour récupérer le plus grand <strong>z-index</strong> et en trouver un encore plus grand :</p><pre id="r-411413" data-claire-element-id="411413"><code data-claire-semantic="javascript">//à rajouter dans drag_onmousedown
var elements = document.getElementsByTagName('*'); //On récupère tous les éléments de la page
var zIndex = 0;
for( var i=0; i &lt; elements.length; i++)
{
  zIndex = Math.max(zIndex,elements[i].style.zIndex);
}
fenetre.style.zIndex = zIndex + 1; //toujours plus haut que le plus haut</code></pre><p id="r-411414" data-claire-element-id="411414"><a href="http://b2moo.free.fr/tutorials/mouse/win_5.htm">Tester</a> : les blocs passent les uns au-dessus des autres</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">
<span class="arrow"></span>
<span class="next">Finalisation du script de fenêtres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
<span class="next">Le vrai style CSS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LevraistyleCSS"></a><h2>Le vrai style CSS</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
<span class="arrow"></span>
<span class="next">Une histoire d&#039;ordre</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
<span class="next">Maximiser</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-le-vrai-style-css" data-claire-element-id="411428">Le vrai style CSS</h4><p id="r-411416" data-claire-element-id="411416">Je vous avais dit que les styles CSS <strong>left</strong> et <strong>top</strong> indiquent la position horizontale et verticale du bloc par rapport au premier ancêtre en position absolue. C'est pour cela qu'on avait mis la condition :</p><pre id="r-411417" data-claire-element-id="411417"><code data-claire-semantic="javascript">element.style.position != 'absolute'</code></pre><p id="r-411418" data-claire-element-id="411418">Seulement, cette condition est fausse car la propriété style ne prend pas en compte les feuilles de style externes.<br/> Voilà un exemple :</p><pre id="r-411419" data-claire-element-id="411419"><code data-claire-semantic="html">&lt;style type=&quot;text/css&quot;&gt;
#bloc
{
  position: absolute;
}&lt;/style&gt;
&lt;!-- ... --&gt;
&lt;div id=&quot;bloc&quot;&gt;contenu&lt;/div&gt;
&lt;button onclick=&quot;alert(document.getElementById('bloc').style.position);&quot;&gt;Tester&lt;/button&gt;</code></pre><p id="r-411420" data-claire-element-id="411420">Le alert va afficher une chaîne vide &quot;&quot;, car <strong>position</strong> a été indiqué dans la feuille de style et non pas dans l'attribut HTML <strong>style</strong>.</p><p id="r-411421" data-claire-element-id="411421">Il nous faut donc récupérer la véritable valeur du style (ici, la position), et je vous propose cette fonction (sans vraiment vous expliquer comment elle fonctionne :p ) :</p><pre id="r-411422" data-claire-element-id="411422"><code data-claire-semantic="javascript">//utilisation : au lieu d'écrire element.style.position, on écrira getCssStyleValue(element,&quot;position&quot;);
function getCssStyleValue(element /*element html*/, style/*style recherché*/)
{
  if( element.currentStyle )
  {
    return element.currentStyle[style];
  }
  else
  {
    return window.getComputedStyle(element,null).getPropertyValue(style);
  }
}</code></pre><aside id="r-411424" data-claire-element-id="411424" data-claire-semantic="information"><p id="r-411423" data-claire-element-id="411423">Si vous voulez vraiment savoir d'où ça vient, voilà <a href="http://www.quirksmode.org/dom/getstyles.html">l'article</a> sur Quirksmode (en anglais !).</p></aside><p id="r-411425" data-claire-element-id="411425">Notre boucle qui calcule le décalage horizontal (variable eX) et vertical (variable eY) devient donc :</p><pre id="r-411426" data-claire-element-id="411426"><code data-claire-semantic="javascript">//Coordonnées de l'élément
  var eX = 0;
  var eY = 0;
  var element = objet;
  do
  {
    eX += element.offsetLeft;
    eY += element.offsetTop;
    element = element.offsetParent;
  } while( element &amp;&amp; getCssStyleValue(element, 'position') != 'absolute'); //&lt;--</code></pre><p id="r-411427" data-claire-element-id="411427">Pensez aussi à copier-coller la fonction getCssStyleValue dans votre code source ;) .</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
<span class="arrow"></span>
<span class="next">Une histoire d&#039;ordre</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
<span class="next">Maximiser</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Maximiser"></a><h2>Maximiser</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
<span class="arrow"></span>
<span class="next">Le vrai style CSS</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
<span class="next">Cloisonnement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-maximiser-2" data-claire-element-id="411433">Maximiser</h4><p id="r-411429" data-claire-element-id="411429">Le script pour maximiser / minimiser était assez simplet, en voilà une version améliorée qui conserve les anciennes positions et dimensions initiales (avant maximisation) :</p><p id="r-411430" data-claire-element-id="411430">(en fait, il n'y a pas grand-chose à expliquer, le code parle de lui-même)</p><pre id="r-411431" data-claire-element-id="411431"><code data-claire-semantic="javascript">//Nouvelle fonction min_max
function min_max(fenetre)
{
  if( ! fenetre.max )
  {
    fenetre.max = true;
    fenetre.oldTop = fenetre.style.top;
    fenetre.oldLeft = fenetre.style.left;
    fenetre.oldWidth = fenetre.style.width;
    fenetre.oldHeight = fenetre.style.height;
     
    fenetre.style.top = 0;
    fenetre.style.left = 0;
    fenetre.style.width = '100%';
    fenetre.style.height = '100%';
  }
  else
  {
    fenetre.max = false;
    fenetre.style.top = fenetre.oldTop;
    fenetre.style.left = fenetre.oldLeft;
    fenetre.style.width = fenetre.oldWidth;
    fenetre.style.height = fenetre.oldHeight;
  }
}
 
//À modifier aussi, pour empêcher le déplacement lorsque maximisé :
//Au début de start_drag():
function start_drag(objet,event)
{
  if( objet.max) return; //on quitte la fonction
 
  dragged = objet;
  //[...]</code></pre><p id="r-411432" data-claire-element-id="411432"><a href="http://b2moo.free.fr/tutorials/mouse/win_6.htm">Tester</a> :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
<span class="arrow"></span>
<span class="next">Le vrai style CSS</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
<span class="next">Cloisonnement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Cloisonnement"></a><h2>Cloisonnement</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
<span class="arrow"></span>
<span class="next">Maximiser</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">
<span class="next">Une liste ordonnée originale !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-cloisonnement" data-claire-element-id="411456">Cloisonnement</h4><p id="r-411434" data-claire-element-id="411434">Pour éviter les conflits entre plusieurs scripts, on a utilisé <strong>addEventLister</strong> (et attachEvent). Les variables et les fonctions que l'on utilise ne sont pas utilisées (de l'extérieur) car on se base uniquement sur les classes ; il n'est donc pas utile de rendre les variables globales et on évitera ainsi des problèmes de compatibilité avec d'autres scripts.</p><p id="r-411435" data-claire-element-id="411435">Les variables (et fonctions) déclarées à l'intérieur d'une fonction sont inaccessibles de l'extérieur : c'est le principe des cloisons en Javascript. On va créer une fonction anonyme qui va contenir tout notre code. Et cette fonction anonyme sera lue immédiatement :</p><pre id="r-411436" data-claire-element-id="411436"><code data-claire-semantic="javascript">(function () { //Début du cloisonnement
  
  //Code invisible de l'extérieur
 
})(); //Fin du cloisonnement</code></pre><p id="r-411437" data-claire-element-id="411437"><a href="http://css.alsacreations.com/Tutoriels-JavaScript/JavaScript-organiser-son-code-en-modules#tuto3">Plus d'informations</a> sur Alsacreations.</p><p id="r-411438" data-claire-element-id="411438">Notre script est fini ! :) <br/> On aurait pu aussi gérer le redimensionnement mais c'est assez répétitif à coder (droite, gauche, haut, bas, diagonales...) et pas très dur, alors je vous laisse le faire. :p</p><p id="r-411439" data-claire-element-id="411439">Récapitulons le fonctionnement de ce script.<br/> Il fonctionne sur la base des classes (attribut <strong>class</strong> en HTML) que l'on place sur chaque balise HTML.<br/> Il y a au total 4 classes :</p><ul id="r-411448" data-claire-element-id="411448"><li id="r-411441" data-claire-element-id="411441"><p id="r-411440" data-claire-element-id="411440">window-base qui est à placer sur la balise de la fenêtre elle-même.</p></li><li id="r-411443" data-claire-element-id="411443"><p id="r-411442" data-claire-element-id="411442">window-move à placer sur les balises qui vont déclencher le déplacement de la fenêtre (barre de titre par ex.) ;</p></li><li id="r-411445" data-claire-element-id="411445"><p id="r-411444" data-claire-element-id="411444">window-min-max qui indique un bouton pour maximiser / restaurer une fenêtre ;</p></li><li id="r-411447" data-claire-element-id="411447"><p id="r-411446" data-claire-element-id="411446">window-close pour les boutons qui ferment la fenêtre.</p></li></ul><p id="r-411449" data-claire-element-id="411449">Ce qui donne par exemple le code HTML suivant :</p><pre id="r-411450" data-claire-element-id="411450"><code data-claire-semantic="html">&lt;div class=&quot;window-base&quot;&gt;
  &lt;div class=&quot;window-move&quot; &gt;
    &lt;button class=&quot;window-close&quot;&gt;X&lt;/button&gt;
    &lt;button class=&quot;window-min-max&quot;&gt;[]&lt;/button&gt;
    Barre de titre
  &lt;/div&gt;
  Contenu
&lt;/div&gt;</code></pre><p id="r-411451" data-claire-element-id="411451">Avec le code CSS suivant :</p><pre id="r-411452" data-claire-element-id="411452"><code data-claire-semantic="css">.window-base
{
        position: absolute;
        width: 400px;
        height: 200px;
        background-color: #DDD;
        border: 1px solid #000;
}
 
.window-close , .window-min-max
{
        float: right;
        background-color: #EEE;
}
 
.window-move
{
        width: 100%;
        height: 30px;
        background-color: #00D;
        color: #FFF;
        cursor: move;
}</code></pre><p id="r-411453" data-claire-element-id="411453">Pour utiliser le script dans la page, il suffit de l'insérer (dans la partie &lt;head&gt;) avec le code HTML :</p><pre id="r-411454" data-claire-element-id="411454"><code data-claire-semantic="html">&lt;script type=&quot;text/javascript&quot; src=&quot;fenetres.js&quot;&gt;&lt;/script&gt;</code></pre><p id="r-411455" data-claire-element-id="411455">Et voilà le <a href="../../b2moo.free.fr/tutorials/mouse/fenetres_final.js">fichier complet</a>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
<span class="arrow"></span>
<span class="next">Maximiser</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">
<span class="next">Une liste ordonnée originale !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Unelisteordonneoriginale"></a><h2>Une liste ordonnée originale !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
<span class="arrow"></span>
<span class="next">Cloisonnement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
<span class="next">Code de base</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-411458" data-claire-element-id="411458">Un élément souvent bien pratique dans les formulaires manque à la panoplie des balises (x)html : les listes ordonnées. Par exemple, pour choisir l'ordre dans lequel des menus apparaissent, ou alors établir une liste des préférences ou des priorités d'un visiteur.</p><p id="r-411459" data-claire-element-id="411459">Des solutions en html pur, sans javascript, existent, mais ne sont pas toujours très pratiques.</p><aside id="r-411461" data-claire-element-id="411461" data-claire-semantic="warning"><p id="r-411460" data-claire-element-id="411460">Même si notre solution se basant sur le drag&amp;drop est plus pratique et conviviale pour les utilisateurs, il ne faut pas oublier le cas où javascript ne marchera pas. Notre script se base donc sur le code html d'une liste ordonnée &quot;classique&quot;.</p></aside><p id="r-411462" data-claire-element-id="411462">Ainsi, notre formulaire sera accessible, avec ou sans javascript :) !</p>
</div><a name="Codedebase"></a><h2>Code de base</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">
<span class="arrow"></span>
<span class="next">Une liste ordonnée originale !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
<span class="next">Ajout du script</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-de-base-2" data-claire-element-id="411473">Code de base</h4><p id="r-411463" data-claire-element-id="411463">Sans javascript et juste avec du html, on pourrait bricoler un formulaire de ce genre :</p><pre id="r-411464" data-claire-element-id="411464"><code data-claire-semantic="html">&lt;ol class=&quot;liste&quot;&gt;
  &lt;li&gt;
    &lt;input class=&quot;ordre&quot; type=&quot;text&quot; id=&quot;accueil&quot; name=&quot;accueil&quot; value=&quot;1&quot; /&gt;
    &lt;label for=&quot;accueil&quot;&gt;Accueil&lt;/label&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;input class=&quot;ordre&quot; type=&quot;text&quot; id=&quot;forum&quot; name=&quot;forum&quot; value=&quot;2&quot; /&gt;
    &lt;label for=&quot;forum&quot;&gt;Forum&lt;/label&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;input class=&quot;ordre&quot; type=&quot;text&quot; id=&quot;livredor&quot; name=&quot;livredor&quot; value=&quot;3&quot; /&gt;
    &lt;label for=&quot;livredor&quot;&gt;Livre d'or&lt;/label&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;input class=&quot;ordre&quot; type=&quot;text&quot; id=&quot;options&quot; name=&quot;options&quot; value=&quot;4&quot; /&gt;
    &lt;label for=&quot;options&quot;&gt;Mes options&lt;/label&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;input class=&quot;ordre&quot; type=&quot;text&quot; id=&quot;faq&quot; name=&quot;faq&quot; value=&quot;5&quot; /&gt;
    &lt;label for=&quot;faq&quot;&gt;Faq&lt;/label&gt;
  &lt;/li&gt;
&lt;/ol&gt;</code></pre><p id="r-411465" data-claire-element-id="411465">(la classe &quot;ordre&quot; est à placer sur l'input qui indique la position dans la liste)</p><p id="r-411466" data-claire-element-id="411466">On va aussi décorer un peu cette liste avec du code css :</p><pre id="r-411467" data-claire-element-id="411467"><code data-claire-semantic="css">ol.liste
{
  width: 400px;
  border: 1px solid #111;
  background-color: #CCF;
  padding: 0; margin: 0;
  list-style: none;
}

ol.liste li
{
  margin: 10px 10px 10px 10px;
  border: 1px solid #222;
  background-color: #EEF;
  height: 30px;
}

ol.liste input.ordre
{
  width: 3em;
}</code></pre><p id="r-411468" data-claire-element-id="411468"><a href="http://b2moo.free.fr/tutorials/mouse/list_1.htm">Cliquez ici</a> pour voir le rendu, uniquement avec du code html.</p><p id="r-411469" data-claire-element-id="411469">Chaque input contient l'ordre d'affichage de chaque élément et l'utilisateur peut les modifier pour changer l'ordre.</p><aside id="r-411471" data-claire-element-id="411471" data-claire-semantic="information"><p id="r-411470" data-claire-element-id="411470">Nous ne sommes pas sûrs que l'utilisateur va rentrer des nombres distincts, on n'est même pas sûr que ce sera un nombre. Mais toutes les vérifications qui en découlent seront à faire côté serveur (par php par exemple).<br/> Rappelez-vous, &quot;Never trust user input&quot; ;) .</p></aside><p id="r-411472" data-claire-element-id="411472">Ce sera également au script serveur de réordonner ensuite la liste, de mettre à jour la base de données, mais ce n'est pas ici le but du tutoriel.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">
<span class="arrow"></span>
<span class="next">Une liste ordonnée originale !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
<span class="next">Ajout du script</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Ajoutduscript"></a><h2>Ajout du script</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
<span class="arrow"></span>
<span class="next">Code de base</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
<span class="next">Le li fantôme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-ajout-du-script" data-claire-element-id="411504">Ajout du script</h4><p id="r-411474" data-claire-element-id="411474">Notre script va beaucoup ressembler à notre bon vieux code de gestions de &quot;fausses fenêtres&quot;.<br/> On aura besoin des fonctions :</p><ul id="r-411481" data-claire-element-id="411481"><li id="r-411476" data-claire-element-id="411476"><p id="r-411475" data-claire-element-id="411475"><strong>onmousedown</strong>, chargée de chercher les classes concernées et commencer le déplacement.</p></li><li id="r-411478" data-claire-element-id="411478"><p id="r-411477" data-claire-element-id="411477"><strong>onmousemove</strong>, pour déplacer le div en cours de déplacement.</p></li><li id="r-411480" data-claire-element-id="411480"><p id="r-411479" data-claire-element-id="411479"><strong>onmouseup</strong>, qui va arrêter le déplacement.</p></li></ul><p id="r-411482" data-claire-element-id="411482">Et des variables :</p><ul id="r-411489" data-claire-element-id="411489"><li id="r-411484" data-claire-element-id="411484"><p id="r-411483" data-claire-element-id="411483"><em>dX</em> et <em>dY</em>, les décalages entre le haut du bloc en déplacement et la souris</p></li><li id="r-411486" data-claire-element-id="411486"><p id="r-411485" data-claire-element-id="411485"><em>dragged</em>, l'objet en déplacement (objet <strong>li</strong>).</p></li><li id="r-411488" data-claire-element-id="411488"><p id="r-411487" data-claire-element-id="411487"><em>liste</em>, la liste ordonnée (objet <strong>ol</strong>, <em>className=&quot;liste&quot;</em>) qui contient <em>dragged</em>.</p></li></ul><p id="r-411490" data-claire-element-id="411490">Dans un premier temps, on se contentera d'enlever la position absolue du bloc en déplacement lors du relâchement de la souris. Cela aura pour effet de faire revenir le bloc à sa position initiale. Comme cette partie a un petit air de déjà-vu (le code ressemble fortement à celui du chapitre précédent :p ), je vous laisse essayer de faire ce script ;) .</p><h5 id="r-correction-140" data-claire-element-id="411503">Correction</h5><p id="r-411491" data-claire-element-id="411491">La fonction de click de souris est un peu plus compliquée: il faut récupérer deux balises à partir de leur <strong>className</strong>. Mais finalement le code n'est pas méchant, quoique un peu long... :-°</p><pre id="r-411492" data-claire-element-id="411492"><code data-claire-semantic="javascript">//addEvent et getCssStyleValue sont définies comme dans les chapitres précédents

var dragged = null; //balise li en cours de déplacement
var liste = null; //balise ol en cours de modification

var dX, dY; //Décalages

function list_onmousedown(event)
{
	var target = event.target || event.srcElement;
	
	//S'il y a déjà un li en déplacement, on &quot;simule&quot; un évènement onmouseup en premier
	if( dragged ) list_onmouseup(event);

	//A la recherche d'une balise ol class=&quot;liste&quot;
	var element = target;
	while(element)
	{
		if( element == null ) //si element = null, alors on n'a rien trouvé, on quitte cette fonction
			return;
		else if( element.className &amp;&amp; element.className.match(/\bliste\b/) )
			break;
		element = element.parentNode;
	}
	liste = element;

	//Reste maintenant à trouver le &quot;li&quot; déplacé
	var element = target;
	while(element)
	{
		if( element == liste) //On est remonté jusqu'à la liste elle-même, cela signifie que l'on n'a pas cliqué sur une balise li
			return;
		else if ( element.tagName &amp;&amp; element.tagName.toLowerCase() == 'li' )
			break;
		element = element.parentNode;
	}
	dragged = element;
	
	//On annule le comportement par défaut:
	event.returnValue = false;
	event.preventDefault &amp;&amp; event.preventDefault();
	
	//On calcule les décalages
	dX = event.clientX + document.documentElement.scrollLeft + document.body.scrollLeft;
	dY = event.clientY + document.documentElement.scrollTop + document.body.scrollTop;
	var element = dragged;
	do
	{
		dX -= element.offsetLeft;
		dY -= element.offsetTop;
		element = element.offsetParent;
	} while( element &amp;&amp; getCssStyleValue(element, 'position') != 'top');
	
	dragged.style.width = dragged.offsetWidth + 'px';
	dragged.style.height = dragged.offsetHeight + 'px';

	//On simule un premier déplacement
	list_onmousemove(event);
}</code></pre><p id="r-411493" data-claire-element-id="411493"><a href="http://b2moo.free.fr/tutorials/mouse/list_2.htm">Tester !</a> Pas d'inquiétude, on va s'occuper de l'insertion !<br/> Il y quand-même quelques remarques sur ce code :</p><ul id="r-411500" data-claire-element-id="411500"><li id="r-411495" data-claire-element-id="411495"><p id="r-411494" data-claire-element-id="411494">Afin de corriger quelques petits bugs (par exemple, un bloc qui reste en position absolue), on simule le déplacement de la souris ou le relâchement du bouton en appelant nous-mêmes certaines fonctions lignes 12 et 58.</p></li><li id="r-411497" data-claire-element-id="411497"><p id="r-411496" data-claire-element-id="411496">J'utilise <em>tagName.toLowerCase()</em> pour être sûr que le tag est comparable à &quot;li&quot; ( &quot;LI&quot; != &quot;li&quot;) ligne 33.</p></li><li id="r-411499" data-claire-element-id="411499"><p id="r-411498" data-claire-element-id="411498">Lorsqu'un élément est en position absolue, il perd sa largeur (<a href="http://b2moo.free.fr/tutorials/mouse/list_2.1.htm">voici le problème</a>).<br/> Ce n'est pas très beau alors on fixe manuellement la largeur (et la hauteur, tant qu'on y est) lignes 54-55.</p></li></ul><p id="r-411501" data-claire-element-id="411501">Pour les deux autres fonctions, c'est la routine :soleil: :</p><pre id="r-411502" data-claire-element-id="411502"><code data-claire-semantic="javascript">function list_onmousemove(event)
{
	if( dragged)
	{
		dragged.style.position = 'absolute';
		dragged.style.left = event.clientX + document.documentElement.scrollLeft + document.body.scrollLeft - dX + 'px';
		dragged.style.top = event.clientY + document.documentElement.scrollTop + document.body.scrollTop - dY + 'px';
	}
}

function list_onmouseup(event)
{
	if( dragged)
	{
		dragged.style.position = dragged.style.width = dragged.style.height = '';
		dragged = null;
	}
}
addEvent(document,'mousedown',list_onmousedown);
addEvent(document,'mousemove',list_onmousemove);
addEvent(document,'mouseup',list_onmouseup);</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
<span class="arrow"></span>
<span class="next">Code de base</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
<span class="next">Le li fantôme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lelifantme"></a><h2>Le li fantôme</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
<span class="arrow"></span>
<span class="next">Ajout du script</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
<span class="next">Comptage et camouflage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-le-li-fantome" data-claire-element-id="411549">Le li fantôme</h4><figure id="r-411506" data-claire-element-id="411507"><img id="r-411505" data-claire-element-id="411505" src="medias/uploads.siteduzero.com_files_212001_213000_212475.png" alt="Image utilisateur"/></figure><p id="r-411508" data-claire-element-id="411508"><em>Pour ce genre de drag&amp;drop, il est utile de savoir où le bloc en déplacement va atterrir.</em></p><p id="r-411509" data-claire-element-id="411509">Ce bloc &quot;fantôme&quot; va aussi nous servir pour placer facilement le <strong>li</strong> en déplacement au bon endroit à la fin du drag&amp;drop (il suffira d'utiliser la méthode dom <strong>replaceChild</strong>). De façon totalement originale ^^ , j'ai nommé la variable correspondante <em>ghost</em> :</p><pre id="r-411510" data-claire-element-id="411510"><code data-claire-semantic="javascript">var ghost = document.createElement('li');
//Pour le différencier un peu des vraies &quot;div&quot;
ghost.style.backgroundColor = 'transparent';
ghost.style.borderStyle = 'dashed';</code></pre><p id="r-411511" data-claire-element-id="411511">On pourrait aussi lui attribuer une classe spéciale (<em>className=&quot;ghost&quot;</em> par exemple) et modifier la feuille de style.</p><h5 id="r-insertion-initiale" data-claire-element-id="411516">Insertion initiale</h5><p id="r-411512" data-claire-element-id="411512">Pour placer ce <em>fantôme</em>, on va utiliser la méthode dom <strong>insertBefore</strong> qui s'utilise comme suit :</p><pre id="r-411513" data-claire-element-id="411513"><code data-claire-semantic="javascript">parent.insertBefore(element_a_inserer, element_de_reference);</code></pre><p id="r-411514" data-claire-element-id="411514">Il faut l'insérer dans la liste au moment du début du déplacement (<strong>onmousedown</strong>) :</p><pre id="r-411515" data-claire-element-id="411515"><code data-claire-semantic="javascript">liste.insertBefore(ghost, dragged); //On insère le fantôme juste avant le div que l'on déplace</code></pre><h5 id="r-deplacement-2" data-claire-element-id="411544">Déplacement</h5><p id="r-411517" data-claire-element-id="411517">Ensuite, à chaque déplacement de la souris (<strong>onmousemove</strong>), il va falloir déplacer de nouveau ce bloc fantôme, pour indiquer la position d'arrivée du drag&amp;drop. On va encore utiliser <strong>insertBefore</strong>.</p><div id="r-411519" data-claire-element-id="411519" data-claire-semantic="question"><p id="r-411518" data-claire-element-id="411518">Mais avant <em>quel bloc</em> faut-il l'insérer ?</p></div><p id="r-411520" data-claire-element-id="411520">Pour le savoir, on va comparer le <strong>offsetTop</strong> appartenant au bloc aux autres <strong>offsetTop</strong>, et on s'arrêtera au premier qui est supérieur.</p><h6 id="r-exemple-119" data-claire-element-id="411543">Exemple</h6><figure id="r-411522" data-claire-element-id="411523"><img id="r-411521" data-claire-element-id="411521" src="medias/uploads.siteduzero.com_files_212001_213000_212476.png" alt="Image utilisateur"/></figure><p id="r-411524" data-claire-element-id="411524">On parcourt la liste de haut en bas :</p><ul id="r-411533" data-claire-element-id="411533"><li id="r-411526" data-claire-element-id="411526"><p id="r-411525" data-claire-element-id="411525">Le premier bloc est le fantôme, on l'ignore.</p></li><li id="r-411528" data-claire-element-id="411528"><p id="r-411527" data-claire-element-id="411527">Le bloc 2 est situé plus haut que le curseur, on passe.</p></li><li id="r-411530" data-claire-element-id="411530"><p id="r-411529" data-claire-element-id="411529">Le bloc 3 est situé plus haut que le curseur, on passe (bis).</p></li><li id="r-411532" data-claire-element-id="411532"><p id="r-411531" data-claire-element-id="411531">Le bloc 4 est situé plus bas, on s'arrête ici.</p></li></ul><p id="r-411534" data-claire-element-id="411534">Tout cette succession se résume par une boucle, et une condition d'arrêt (plutôt longue !) :</p><pre id="r-411535" data-claire-element-id="411535"><code data-claire-semantic="javascript">var avant = null; //La balise que l'on va utiliser pour insertBefore()
//On va parcourir tous les enfants direct de notre liste
for( var i = 0; i &lt; liste.childNodes.length; i++)
{
  var el = liste.childNodes.item(i);

  //Premièrement il faut s'assurer qu'il s'agit bien d'une balise (tagName) puis d'une balise li
  //Ensuite, on exclut de nos tests la balise ghost elle-même ainsi que la balise en cours de déplacement
  //Enfin, on vérifie les valeurs de offsetTop
  if( el.tagName.toLowerCase() == 'li' &amp;&amp; el != dragged &amp;&amp; el != ghost &amp;&amp; el.offsetTop &gt; dragged.offsetTop )
  {
    avant = el;
    break; //On a trouvé où insérer le fantôme, on arrête la boucle
  }
}</code></pre><div id="r-411537" data-claire-element-id="411537" data-claire-semantic="question"><p id="r-411536" data-claire-element-id="411536">Et si l'élément qui se déplace est situé tout en bas, et qu'il n'y a rien après ? On ne peut pas trouver de <strong>div</strong> pour insérer <em>avant</em> ?</p></div><p id="r-411538" data-claire-element-id="411538">Dans ce cas, la variable <em>avant</em> vaut <strong>null</strong> et on utilisera la fonction <strong>appendChild</strong> à la place :</p><pre id="r-411539" data-claire-element-id="411539"><code data-claire-semantic="javascript">liste.removeChild(ghost); //Il faut déjà l'enlever, pour pouvoir le mettre ailleurs
if( avant == null )
  liste.appendChild(ghost);
else
  liste.insertBefore(ghost, avant);</code></pre><p id="r-411540" data-claire-element-id="411540">Dernière optimisation : il serait bête d'enlever la balise fantôme pour la remettre au même endroit, ça va clignoter (beurk !). On peut utiliser la propriété <strong>ghost.nextSibling</strong> (next sibling = noeud/balise suivante) pour vérifier qu'elle n'est pas déjà au bon endroit :</p><pre id="r-411541" data-claire-element-id="411541"><code data-claire-semantic="javascript">if( avant != ghost.nextSibling )  //Si ghost est déjà bien placé
{
  liste.removeChild(ghost);
  if( avant == null )
    liste.appendChild(ghost);
  else
    liste.insertBefore(ghost, avant);
}</code></pre><p id="r-411542" data-claire-element-id="411542">Dans le cas où <em>avant = null</em>, cela marche aussi car <strong>nextSibling</strong> vaut aussi null.</p><h5 id="r-remplacement-final" data-claire-element-id="411548">Remplacement final</h5><p id="r-411545" data-claire-element-id="411545">On a passé le plus dur :) <br/> Lorsque l'on relâche la souris (<em>drag_onmouseup</em>), il n'y a plus qu'à remplacer le bloc fantôme par le vrai bloc. Inutile de faire un dessin :p pour expliquer comment marche la fonction <strong>replaceChild</strong> (&quot;remplacer nœud&quot;) :</p><pre id="r-411546" data-claire-element-id="411546"><code data-claire-semantic="javascript">liste.replaceChild(dragged, ghost);  //remplace ghost par dragged (attention à l'ordre des paramètres)</code></pre><p id="r-411547" data-claire-element-id="411547"><a href="http://b2moo.free.fr/tutorials/mouse/list_3.htm">Tester le script</a> avec les trois ajouts de code (<strong>onmousedown</strong>, <strong>onmousemove</strong> et <strong>onmouseup</strong>).</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
<span class="arrow"></span>
<span class="next">Ajout du script</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
<span class="next">Comptage et camouflage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Comptageetcamouflage"></a><h2>Comptage et camouflage</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
<span class="arrow"></span>
<span class="next">Le li fantôme</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-comptage-et-camouflage" data-claire-element-id="411575">Comptage et camouflage</h4><p id="r-411550" data-claire-element-id="411550">Les balises <strong>li</strong> ont été déplacées mais les champs <strong>input</strong> à l'intérieur n'ont pas été changés pour indiquer le nouvel ordre. Comme l'ordre d'affichage des éléments correspond (en position non absolue !) à l'ordre des éléments dans l'arbre html, il suffit de les compter dans l'ordre :</p><pre id="r-411551" data-claire-element-id="411551"><code data-claire-semantic="javascript">var inputs = liste.getElementsByTagName('input');
var n = 1; //Compteur
for(var i = 0; i &lt; inputs.length; i++)
{
  if( inputs.item(i).className.match(/\bordre\b/) )
  {
    inputs.item(i).value = n++;
  }
}</code></pre><p id="r-411552" data-claire-element-id="411552"><a href="http://b2moo.free.fr/tutorials/mouse/list_3.5.htm">Tester</a> cette version avec décompte.<br/> Ce code, qui doit s'exécuter après avoir remplacé le fantôme par le <strong>li</strong> déplacé, prend toutes les balises input, qui contiennent des informations d'ordre (<em>class=&quot;ordre&quot;</em>) et renumérote tout. C'est un peu bourrin, mais après tous les efforts que l'on a fourni, on peut bien se le permettre :-° .</p><p id="r-411553" data-claire-element-id="411553">Une fois que l'on a vérifié que ce script marche, les champs input deviennent inutiles (visuellement parlant). On va donc les cacher, avec javascript et cette nouvelle fonction pour rajouter des règles css dans la page :</p><pre id="r-411554" data-claire-element-id="411554"><code data-claire-semantic="javascript">//Fonction &quot;magique&quot; pour ajouter une règle css:
function insertCss(selector,rule)
{
  if( document.styleSheets &amp;&amp; document.styleSheets[0] )
  {
    var feuille = document.styleSheets[0];
    if( feuille.insertRule )  //internet explorer
        feuille.insertRule(selector + &quot; { &quot; + rule + &quot; } &quot;, feuille.cssRules.length);
    else if( feuille.addRule )  //Pour firefox
        feuille.addRule(selector,rule);
  }
  else  //Pour le reste
  {
        var ss        =       document.createElement('style');
        ss.setAttribute('type','text/css');
        ss.appendChild(document.createTextNode(selector + &quot; { &quot; + rule + &quot; } &quot;) );
        document.getElementsByTagName('head')[0].appendChild(ss);
  }
}</code></pre><p id="r-411555" data-claire-element-id="411555">Elle s'utilise ainsi :</p><pre id="r-411556" data-claire-element-id="411556"><code data-claire-semantic="javascript">insertCss('.ordre','display: none;');
//On en profite pour rajouter un curseur &quot;spécial&quot; pour le drag&amp;drop
insertCss('.liste li', 'cursor: move;');</code></pre><p id="r-411557" data-claire-element-id="411557"><a href="http://b2moo.free.fr/tutorials/mouse/list_4.htm">Tester</a> le code final.</p><aside id="r-411559" data-claire-element-id="411559" data-claire-semantic="information"><p id="r-411558" data-claire-element-id="411558">Et voilà, votre premier script de drag&amp;drop !</p></aside><p id="r-411560" data-claire-element-id="411560">On peut remarquer que sans javascript, le formulaire fonctionnera toujours et c'est bien la force de ce système : on s'est basé sur un code html qui marchait, et on a rajouté du javascript autour sans toucher à la structure de la page ! Les styles css propres au javascript, pour cacher les input, ont été rajoutés par javascript. On ne risque ainsi pas de cacher des éléments nécessaires à l'utilisation de la page.</p><p id="r-411561" data-claire-element-id="411561">Si vous avez déjà utilisé des framework javascript qui réalisent ce genre de scripts, vous aurez remarqué qu'en général ces considérations sont mises de côtés : les pages webs nécessitent toujours javascript pour fonctionner.</p><p id="r-411562" data-claire-element-id="411562">Je ne blâme pas ces framework pour cela, car s'affranchir de ces contraintes permet de faire des pages &quot;web 2.0&quot; beaucoup plus puissantes et plus simplement surtout mais je tenais toutefois à montrer une autre méthode, plus artisanale :pirate: .</p><h6 id="r-idees-d-amelioration-6" data-claire-element-id="411574">Idées d'amélioration</h6><ul id="r-411573" data-claire-element-id="411573"><li id="r-411564" data-claire-element-id="411564"><p id="r-411563" data-claire-element-id="411563">Faire un style css plus joli !</p></li><li id="r-411566" data-claire-element-id="411566"><p id="r-411565" data-claire-element-id="411565">Rendre l'élément déplacé transparent.</p></li><li id="r-411568" data-claire-element-id="411568"><p id="r-411567" data-claire-element-id="411567">Faire une petite animation, pour le déplacement d'un élément vers sa position finale.</p></li><li id="r-411570" data-claire-element-id="411570"><p id="r-411569" data-claire-element-id="411569">Faire du drag&amp;drop entre plusieurs listes.</p></li><li id="r-411572" data-claire-element-id="411572"><p id="r-411571" data-claire-element-id="411571">Vérifier si l'on peut imbriquer les listes (après quelques petites corrections, <a href="http://b2moo.free.fr/tutorials/mouse/list_4.2.htm">ça fonctionne</a> !).</p></li></ul>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris">Les déplacements de la souris</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-de-la-souris">Les coordonnées de la souris</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-variable-event">
La variable event
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-1">
Les coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/position-absolue">
Position absolue
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-gestion-des-fenetres">
Fil rouge : gestion des fenêtres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-coordonnees-des-blocs">Les coordonnées des blocs</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/centrer">
Centrer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/coordonnees">
Coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-decalage-initial">
Fil rouge : décalage initial
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/les-cibles">Les cibles</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/la-propagation-des-evenements">
La propagation des évènements
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/recuperer-la-cible">
Récupérer la cible
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/avec-des-classes">
Avec des classes
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/fil-rouge-sans-ajout-d-evenement">
Fil rouge : sans ajout d&#039;évènement
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Applications
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/finalisation-du-script-de-fenetres">Finalisation du script de fenêtres</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-histoire-d-ordre">
Une histoire d&#039;ordre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-vrai-style-css">
Le vrai style CSS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/maximiser-2">
Maximiser
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/cloisonnement">
Cloisonnement
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/une-liste-ordonnee-originale">Une liste ordonnée originale !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/code-de-base-2">
Code de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/ajout-du-script">
Ajout du script
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
Le li fantôme
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/comptage-et-camouflage">
Comptage et camouflage
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-deplacements-de-la-souris/le-li-fantome">
<span class="arrow"></span>
<span class="next">Le li fantôme</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/les-deplacements-de-la-souris.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 06:36:09 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-deplacements-de-la-souris.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:10:26 GMT -->
</html>