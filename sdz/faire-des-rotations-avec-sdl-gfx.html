<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/faire-des-rotations-avec-sdl-gfx.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 19:50:08 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/faire-des-rotations-avec-sdl-gfx.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 03:34:32 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Faire des rotations avec SDL_gfx</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Faire des rotations avec SDL_gfx</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#FairedesrotationsavecSDL_gfx">Faire des rotations avec SDL_gfx</a><br/><a href="#C039estquoiSDL_gfx">C&#039;est quoi SDL_gfx ?</a><br/><a href="#InstallationdeSDL_gfx">Installation de SDL_gfx</a><br/><a href="#Faireunerotation">Faire une rotation</a><br/></div>
<a name="FairedesrotationsavecSDL_gfx"></a><h2>Faire des rotations avec SDL_gfx</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/c-est-quoi-sdl-gfx">
<span class="next">C&#039;est quoi SDL_gfx ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-576113" data-claire-element-id="576113">Bonjour à tous. :D</p><p id="r-576114" data-claire-element-id="576114">Bienvenue dans ce mini-tuto où vous allez apprendre à faire des rotations sur des surfaces grâce à... SDL_gfx. :o</p><aside id="r-576116" data-claire-element-id="576116" data-claire-semantic="information"><p id="r-576115" data-claire-element-id="576115">Ce tuto nécessite que vous connaissiez un peu la SDL. Donc ça ne sert à rien d'essayer de comprendre ce tuto si vous n'avez pas une petite connaissance de cette bibliothèque graphique. Si vous ne connaissez pas la SDL, vous pouvez suivre les cours de M@teo21 <a href="http://www.siteduzero.com/tuto-3-8-0-apprenez-a-programmer-en-c-c.html#part_1544">ici</a>.</p></aside><p id="r-576117" data-claire-element-id="576117">Bon, commençons...</p>
</div><a name="C039estquoiSDL_gfx"></a><h2>C&#039;est quoi SDL_gfx ?</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
<span class="next">Installation de SDL_gfx</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-576118" data-claire-element-id="576118">SDL_gfx est une bibliothèque qui nécessite que la SDL soit installée.<br/> Vous en avez sûrement déjà entendu parler dans les cours de M@teo21, je pense au chapitre <a href="http://www.siteduzero.com/tuto-3-5432-1-afficher-des-images.html#ss_part_3">SDL_image</a> ou <a href="http://www.siteduzero.com/tuto-3-7420-1-ecrire-du-texte-avec-sdl_ttf.html">SDL_ttf</a>.</p><p id="r-576119" data-claire-element-id="576119">SDL_gfx sert à faire des rotations mais aussi des figures géométriques, filtrer des images, gérer le temps de rafraîchissement de l'écran, etc...<br/> Mais nous, ce qui nous intéresse, c'est la rotation, alors au boulot ! :pirate:</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx">Faire des rotations avec SDL_gfx</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/c-est-quoi-sdl-gfx">
C&#039;est quoi SDL_gfx ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
Installation de SDL_gfx
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/faire-une-rotation">
Faire une rotation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
<span class="next">Installation de SDL_gfx</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="InstallationdeSDL_gfx"></a><h2>Installation de SDL_gfx</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/c-est-quoi-sdl-gfx">
<span class="arrow"></span>
<span class="next">C&#039;est quoi SDL_gfx ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/faire-une-rotation">
<span class="next">Faire une rotation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-telechargement-41" data-claire-element-id="576131">Téléchargement</h2><p id="r-576121" data-claire-element-id="576121">Tout d'abord, il faut télécharger le fichier zip de SDL_gfx <a href="http://www.aaroncox.net/tutorials/2dtutorials/sdlshapes.html">ici</a><em>(merci à <a href="http://www.siteduzero.com/membres-294-56104.html">transfear</a> pour le lien)</em>.</p><p id="r-576122" data-claire-element-id="576122">Quand vous arriverez sur la page, cliquez sur <strong>&quot;Click here&quot;</strong> dans le paragraphe <strong>&quot;Setting Up SDL_gfx in Visual Studio .NET 2003&quot;</strong>.</p><aside id="r-576124" data-claire-element-id="576124" data-claire-semantic="information"><p id="r-576123" data-claire-element-id="576123">Ce que vous avez téléchargé est un fichier zip contenant SDL_gfx déjà compilé. Normalement, on aurait dû télécharger les sources sur le site officiel et les compiler, mais je ne sais pas le faire. C'est donc beaucoup plus pratique pour moi et pour vous de télécharger ce zip.</p></aside><p id="r-576125" data-claire-element-id="576125">C'est téléchargé ? Bon maintenant, il faut décompresser ce zip.</p><p id="r-576126" data-claire-element-id="576126">Voici comment faire :</p><p id="r-576127" data-claire-element-id="576127">Faites un clic droit sur le fichier et cliquez sur <strong>&quot;Extraire tout...&quot;</strong>, ensuite laissez-vous guider par l'assistant d'extraction qui va vous décompresser ça en moins de deux.</p><p id="r-576128" data-claire-element-id="576128">Maintenant que vous avez décompressé le fichier, allez dans le dossier issu de la décompression.</p><p id="r-576129" data-claire-element-id="576129">Dans le dossier <strong>lib</strong> se trouvent les fichiers <strong>sdlgfx.dll</strong> et <strong>sdlgfx.lib</strong>.<br/> Dans le dossier <strong>include</strong> se trouvent les fichiers d'en-tête ou <strong>headers (*.h)</strong>.</p><p id="r-576130" data-claire-element-id="576130">Nous aurons besoin de ces fichiers pour l'installation...</p><h2 id="r-installation-sous-code-blocks" data-claire-element-id="576145">Installation sous Code::Blocks</h2><p id="r-576132" data-claire-element-id="576132">Je vous rappelle les fichiers dont nous avons besoin :</p><ul id="r-576139" data-claire-element-id="576139"><li id="r-576134" data-claire-element-id="576134"><p id="r-576133" data-claire-element-id="576133"><strong>sdlgfx.dll</strong> : placez ce fichier dans le dossier de votre projet ;</p></li><li id="r-576136" data-claire-element-id="576136"><p id="r-576135" data-claire-element-id="576135"><strong>sdlgfx.lib</strong> : ce fichier va dans le dossier <strong>&quot;C:\Program Files\CodeBlocks\mingw32\lib&quot;</strong> ;</p></li><li id="r-576138" data-claire-element-id="576138"><p id="r-576137" data-claire-element-id="576137">et les <strong>headers (*.h)</strong> : ils vont dans le dossier <strong>&quot;C:\Program Files\CodeBlocks\mingw32\include\SDL&quot;</strong>.</p></li></ul><p id="r-576140" data-claire-element-id="576140">OK ! Les fichiers sont bien placés !</p><p id="r-576141" data-claire-element-id="576141">Maintenant il faut... configurer votre projet pour utiliser SDL_gfx.</p><p id="r-576142" data-claire-element-id="576142">Créez d'abord votre projet si ce n'est pas déjà fait, en configurant comme pour un projet SDL normal. Si vous ne vous souvenez plus comment faire, rendez-vous <a href="http://www.siteduzero.com/tuto-3-5252-1-installation-de-la-sdl.html#ss_part_3">ici</a>.</p><p id="r-576143" data-claire-element-id="576143">Puis sous Code::Blocks, allez dans le menu <strong>&quot;Projects&quot;</strong>, <strong>&quot;Build options&quot;</strong>.<br/> Dans l'onglet <strong>&quot;Linker&quot;</strong>, cliquez sur le bouton <strong>&quot;Add&quot;</strong> et indiquez où se trouve le fichier <strong>&quot;sdlgfx.lib&quot;</strong>.<br/> Si on vous demande <strong>&quot;Keep as a relative path ?&quot;</strong>, répondez <strong>Non</strong>.</p><p id="r-576144" data-claire-element-id="576144">C'est bon, l'installation sous Code::Blocks est terminée.</p><h2 id="r-installation-sous-visual-studio" data-claire-element-id="576163">Installation sous Visual Studio</h2><p id="r-576146" data-claire-element-id="576146">Pour Visual, voici la démarche :magicien: :</p><ul id="r-576157" data-claire-element-id="576157"><li id="r-576148" data-claire-element-id="576148"><p id="r-576147" data-claire-element-id="576147">Allez dans le <strong>dossier de Visual</strong> (chez moi : &quot;C:\Program Files\Microsoft Visual Studio 9.0&quot;).</p></li><li id="r-576150" data-claire-element-id="576150"><p id="r-576149" data-claire-element-id="576149">Ensuite allez dans le dossier <strong>VC</strong>.</p></li><li id="r-576152" data-claire-element-id="576152"><p id="r-576151" data-claire-element-id="576151">Mettez <strong>sdlgfx.lib</strong> dans le dossier <strong>lib</strong>.</p></li><li id="r-576154" data-claire-element-id="576154"><p id="r-576153" data-claire-element-id="576153">Allez dans le dossier include et mettez les <strong>headers (*.h)</strong> dans le dossier SDL.</p></li><li id="r-576156" data-claire-element-id="576156"><p id="r-576155" data-claire-element-id="576155">Et évidemment, <strong>sdlgfx.dll</strong> dans le dossier de votre projet. ;)</p></li></ul><p id="r-576158" data-claire-element-id="576158">Pour configurer Visual pour SDL_gfx, cliquez sur le menu <strong>&quot;Projet&quot;</strong>, puis sur <strong>&quot;Propriété <em>nom du projet</em>&quot;</strong>, puis allez dans <strong>&quot;Editeur de liens&quot;</strong>, puis sur <strong>&quot;Entrée&quot;</strong> et dans dépendances supplémentaire mettez <strong>sdlgfx.lib</strong> en plus des autres .lib.</p><p id="r-576159" data-claire-element-id="576159">Voilà vous avez SDL_gfx pour Visual Studio. :)</p><p id="r-576160" data-claire-element-id="576160"><em>( merci Dark Patate )</em></p><div id="r-576162" data-claire-element-id="576162"><p id="r-576161" data-claire-element-id="576161">( merci <a href="http://www.siteduzero.com/membres-294-27919.html">Dark Patate</a> )</p></div>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx">Faire des rotations avec SDL_gfx</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/c-est-quoi-sdl-gfx">
C&#039;est quoi SDL_gfx ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
Installation de SDL_gfx
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/faire-une-rotation">
Faire une rotation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/c-est-quoi-sdl-gfx">
<span class="arrow"></span>
<span class="next">C&#039;est quoi SDL_gfx ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/faire-une-rotation">
<span class="next">Faire une rotation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Faireunerotation"></a><h2>Faire une rotation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
<span class="arrow"></span>
<span class="next">Installation de SDL_gfx</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-576165" data-claire-element-id="576165">On entre maintenant dans la partie la plus intéressante. :)</p><aside id="r-576167" data-claire-element-id="576167" data-claire-semantic="warning"><p id="r-576166" data-claire-element-id="576166">Surtout n'oubliez pas de mettre le fichier sdlgfx.dll dans le dossier de votre <br/> projet !</p></aside><p id="r-576168" data-claire-element-id="576168">Tout d'abord, le main.c devrait ressembler à ça :</p><pre id="r-576169" data-claire-element-id="576169"><code data-claire-semantic="c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;SDL/SDL.h&gt;
 
int main(int argc, char *argv[])
{
    SDL_Surface *ecran = NULL;
    SDL_Event event;
    int continuer = 1;
 
    SDL_Init(SDL_INIT_VIDEO);
 
    ecran = SDL_SetVideoMode(500, 500, 32, SDL_HWSURFACE);
    SDL_WM_SetCaption(&quot;Faire des rotations avec SDL_gfx&quot;, NULL);
 
    while(continuer)
    {
        SDL_PollEvent(&amp;event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = 0;
                break;
        }
 
        SDL_FillRect(ecran, NULL, SDL_MapRGB(ecran-&gt;format, 255, 255, 255));
        SDL_Flip(ecran);
    }
 
    SDL_FreeSurface(ecran);    
    SDL_Quit();
 
    return EXIT_SUCCESS;
}</code></pre><p id="r-576170" data-claire-element-id="576170">La première chose à faire c'est d'inclure le fichier header :</p><pre id="r-576171" data-claire-element-id="576171"><code data-claire-semantic="c">#include &lt;SDL/SDL_rotozoom.h&gt;</code></pre><div id="r-576173" data-claire-element-id="576173" data-claire-semantic="question"><p id="r-576172" data-claire-element-id="576172">Mais il me semble que j'ai copié 5 fichiers header ? Non ?</p></div><p id="r-576174" data-claire-element-id="576174">Oui c'est vrai. Mais comme je l'ai déjà dit dans la première partie, SDL_gfx ne sert pas qu'à faire des rotations et dans notre cas, nous n'avons besoin que de <strong>SDL_rotozoom.h</strong>.</p><p id="r-576175" data-claire-element-id="576175">Maintenant regardons le prototype de la fonction permettant de faire une rotation :</p><pre id="r-576176" data-claire-element-id="576176"><code data-claire-semantic="c">SDL_Surface * rotozoomSurface (SDL_Surface *src, double angle, double zoom, int smooth);</code></pre><p id="r-576177" data-claire-element-id="576177">Le premier argument est en fait le nom de la surface à modifier.<br/> Le deuxième est l'angle de rotation.<br/> Le troisième est le zoom à appliquer sur la surface.</p><div id="r-576179" data-claire-element-id="576179" data-claire-semantic="question"><p id="r-576178" data-claire-element-id="576178">Hein ! Mais qu'est-ce que le zoom vient faire ici ?</p></div><p id="r-576180" data-claire-element-id="576180">Eh bien cette fonction permet de faire une rotation mais aussi un zoom.<br/> C'est vrai que ce n'est pas terrible comme fonctionnement, mais il doit sûrement y avoir une raison. Si vous ne voulez pas faire de zoom, mettez <strong>1.0</strong>.</p><p id="r-576181" data-claire-element-id="576181">Et enfin le quatrième argument sert à lisser la surface tournée, comme ça c'est plus joli. :) <br/> Mettez <strong>1</strong> pour lisser, sinon mettez <strong>0</strong>.</p><p id="r-576182" data-claire-element-id="576182">Maintenant qu'on a tout expliqué, voilà le code complet :</p><pre id="r-576183" data-claire-element-id="576183"><code data-claire-semantic="c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;SDL/SDL.h&gt;
#include &lt;SDL/SDL_rotozoom.h&gt;
 
#define TEMPS       30 // Le temps qu'il y a entre chaque augmentation de l'angle.
 
int main(int argc, char *argv[])
{
    SDL_Surface *ecran = NULL, *image = NULL, *rotation = NULL;
    SDL_Rect rect;
    SDL_Event event;
    double angle = 0;
 
    int continuer = 1;
    int tempsPrecedent = 0, tempsActuel = 0;
 
    SDL_Init(SDL_INIT_VIDEO);
 
    ecran = SDL_SetVideoMode(500, 500, 32, SDL_HWSURFACE);
    SDL_WM_SetCaption(&quot;Faire des rotations avec SDL_gfx&quot;, NULL);
 
    image = SDL_LoadBMP(&quot;image.bmp&quot;);
 
    rect.x =  150;
    rect.y =  150;
 
    while(continuer)
    {
        SDL_PollEvent(&amp;event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = 0;
                break;
        }
 
        tempsActuel = SDL_GetTicks();
        if (tempsActuel - tempsPrecedent &gt; TEMPS)
        {
            angle += 2; //On augmente l'angle pour que l'image tourne sur elle-même.
 
            tempsPrecedent = tempsActuel;
        }
        else
        {
            SDL_Delay(TEMPS - (tempsActuel - tempsPrecedent));
        }
 
 
        SDL_FillRect(ecran, NULL, SDL_MapRGB(ecran-&gt;format, 255, 255, 255));
 
        rotation = rotozoomSurface(image, angle, 1.0, 1); //On transforme la surface image.
 
        SDL_BlitSurface(rotation , NULL, ecran, &amp;rect); //On affiche la rotation de la surface image.
        SDL_FreeSurface(rotation); //On efface la surface rotation car on va la redéfinir dans la prochaine boucle. Si on ne le fait pas, cela crée une fuite de mémoire. 
 
        SDL_Flip(ecran);
    }
 
    SDL_FreeSurface(ecran);
    SDL_FreeSurface(image);
    SDL_Quit();
 
    return EXIT_SUCCESS;
}</code></pre><p id="r-576184" data-claire-element-id="576184">Surtout n'oubliez pas d'ajouter une image dans le dossier de votre projet. ;)</p><aside id="r-576186" data-claire-element-id="576186" data-claire-semantic="information"><p id="r-576185" data-claire-element-id="576185">J'ai mis ici le code qui permet de gérer le temps qu'il y a entre chaque augmentation de l'angle, cela permet de gérer la vitesse de rotation. M@teo21 en a parlé <a href="http://www.siteduzero.com/tuto-3-6996-1-maitrisez-le-temps.html">ici</a>.</p></aside><p id="r-576187" data-claire-element-id="576187">Maintenant vous pouvez compiler et lancer votre programme.</p><aside id="r-576189" data-claire-element-id="576189" data-claire-semantic="error"><p id="r-576188" data-claire-element-id="576188">Quand je lance mon programme, l'image bouge en même temps qu'elle tourne !!!</p></aside><p id="r-576190" data-claire-element-id="576190">Ah oui, j'ai oublié de vous dire : quand nous plaçons notre image, sa taille change à cause de la rotation ce qui la fait bouger.</p><div id="r-576192" data-claire-element-id="576192" data-claire-semantic="question"><p id="r-576191" data-claire-element-id="576191">La surface rotation change de taille ?</p></div><p id="r-576193" data-claire-element-id="576193">Oui, regardez ceci pour comprendre :</p><figure id="r-576195" data-claire-element-id="576196"><img id="r-576194" data-claire-element-id="576194" src="medias/uploads.siteduzero.com_files_48001_49000_48535.jpg" alt="erreurRotation1"/></figure><p id="r-576197" data-claire-element-id="576197">Ici on a fait une rotation, donc la taille de la surface a changé.</p><p id="r-576198" data-claire-element-id="576198">En revanche ici, l'image n'est pas tournée, donc la surface garde sa taille normale :</p><figure id="r-576200" data-claire-element-id="576201"><img id="r-576199" data-claire-element-id="576199" src="medias/uploads.siteduzero.com_files_48001_49000_48536.jpg" alt="erreurRotation2"/></figure><p id="r-576202" data-claire-element-id="576202">Donc il faut placer notre image en fonction de sa taille.</p><p id="r-576203" data-claire-element-id="576203">Voici le code :</p><pre id="r-576204" data-claire-element-id="576204"><code data-claire-semantic="c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;SDL/SDL.h&gt;
#include &lt;SDL/SDL_rotozoom.h&gt;
 
#define TEMPS       30 // Le temps qu'il y a entre chaque augmentation de l'angle.
 
int main(int argc, char *argv[])
{
    SDL_Surface *ecran = NULL, *image = NULL, *rotation = NULL;
    SDL_Rect rect;
    SDL_Event event;
    double angle = 0;
 
    int continuer = 1;
    int tempsPrecedent = 0, tempsActuel = 0;
 
    SDL_Init(SDL_INIT_VIDEO);
 
    ecran = SDL_SetVideoMode(500, 500, 32, SDL_HWSURFACE);
    SDL_WM_SetCaption(&quot;Faire des rotations avec SDL_gfx&quot;, NULL);
 
    image = SDL_LoadBMP(&quot;image.bmp&quot;);
 
    while(continuer)
    {
        SDL_PollEvent(&amp;event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = 0;
                break;
        }
 
        tempsActuel = SDL_GetTicks();
        if (tempsActuel - tempsPrecedent &gt; TEMPS)
        {
            angle += 2; //On augmente l'angle pour que l'image tourne sur elle-même.
 
            tempsPrecedent = tempsActuel;
        }
        else
        {
            SDL_Delay(TEMPS - (tempsActuel - tempsPrecedent));
        }
 
        SDL_FillRect(ecran, NULL, SDL_MapRGB(ecran-&gt;format, 255, 255, 255));
 
        rotation = rotozoomSurface(image, angle, 1.0, 1); //On transforme la surface image.
 
        //On positionne l'image en fonction de sa taille.
        rect.x =  200 - rotation-&gt;w / 2;
        rect.y =  200 - rotation-&gt;h / 2;
 
        SDL_BlitSurface(rotation , NULL, ecran, &amp;rect); //On affiche la rotation de la surface image.
        SDL_FreeSurface(rotation); //On efface rotation car on va la redéfinir dans la prochaine boucle. Si on ne le fait pas, cela crée une fuite de mémoire. 
 
        SDL_Flip(ecran);
    }
 
    SDL_FreeSurface(ecran);
    SDL_FreeSurface(image);
    SDL_Quit();
 
    return EXIT_SUCCESS;
}</code></pre><p id="r-576205" data-claire-element-id="576205">Et voilà ! On a réussi à faire notre rotation. Alors, des questions ?</p><div id="r-576207" data-claire-element-id="576207" data-claire-semantic="question"><p id="r-576206" data-claire-element-id="576206">Euh... oui. Dans la fonction rotozoomSurface, est-ce qu'on n'aurait pas pu mettre &quot;image = rotozoomSurface(image, angle, 1.0, 1);&quot; ?</p></div><p id="r-576208" data-claire-element-id="576208">C'est une très bonne question. En fait oui, normalement on aurait pu le faire, mais on ne peut pas à cause du zoom parce que si à chaque fois on refait un zoom sur la même surface, alors l'image va gRANDIR jusqu'à l'infini, voilà pourquoi.<br/> Quand dans la fonction on met <strong>1.0</strong>, c'est pour agrandir l'image à sa taille normale. Si on met <strong>0</strong>, l'image ne s'affiche pas, car on ne fait pas de zoom.</p><h3 id="r-un-petit-exercice-5" data-claire-element-id="576210">Un petit exercice</h3><p id="r-576209" data-claire-element-id="576209">Maintenant on pourrait ajouter un petit gadget dans notre programme pour que vous vous rendiez compte de ce que l'on peut faire d'intéressant avec SDL_gfx.<br/> Par exemple, ça serait bien que l'image bouge avec la souris. Et pour faire encore mieux, on pourrait aussi ajouter un effet de zoom.</p><h3 id="r-correction-magicien" data-claire-element-id="576216">Correction :magicien: :</h3><div id="r-576212" data-claire-element-id="576212"><pre id="r-576211" data-claire-element-id="576211"><code data-claire-semantic="c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;SDL/SDL.h&gt;
#include &lt;SDL/SDL_rotozoom.h&gt;
 
#define TEMPS       30 // Le temps qu'il y a entre chaque augmentation de l'angle.
 
int main(int argc, char *argv[])
{
    SDL_Surface *ecran = NULL, *image = NULL, *rotation = NULL;
    SDL_Rect rect;
    SDL_Event event;
    double angle = 0;
    double zoom = 1;
    int sens = 1;
 
    int continuer = 1;
    int tempsPrecedent = 0, tempsActuel = 0;
 
    SDL_Init(SDL_INIT_VIDEO);
 
    ecran = SDL_SetVideoMode(500, 500, 32, SDL_HWSURFACE);
    SDL_WM_SetCaption(&quot;Faire des rotations avec SDL_gfx&quot;, NULL);
 
    image = SDL_LoadBMP(&quot;image.bmp&quot;);
 
    while(continuer)
    {
        SDL_PollEvent(&amp;event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = 0;
                break;
        }
 
        tempsActuel = SDL_GetTicks();
        if (tempsActuel - tempsPrecedent &gt; TEMPS)
        {
            angle += 2; //On augmente l'angle pour que l'image tourne sur elle-même.
 
            tempsPrecedent = tempsActuel;
        }
        else
        {
            SDL_Delay(TEMPS - (tempsActuel - tempsPrecedent));
        }
 
        SDL_FillRect(ecran, NULL, SDL_MapRGB(ecran-&gt;format, 255, 255, 255));
 
        rotation = rotozoomSurface(image, angle, zoom, 0); //On transforme la surface image.
        
        //On repositionne l'image en fonction de sa taille.
        rect.x =  event.button.x - rotation-&gt;w / 2;
        rect.y =  event.button.y - rotation-&gt;h / 2;
 
        SDL_BlitSurface(rotation , NULL, ecran, &amp;rect); //On affiche la rotation de la surface image.
        SDL_FreeSurface(rotation); //On efface la surface rotation car on va la redéfinir dans la prochaine boucle. Si on ne le fait pas, cela crée une fuite de mémoire. 
 
        if(zoom &gt;= 2){sens = 0;}
        else if(zoom &lt;= 0.5){sens = 1;}
 
        if(sens == 0){zoom -= 0.02;}
        else{zoom += 0.02;}
 
        SDL_Flip(ecran);
    }
 
    SDL_FreeSurface(ecran);
    SDL_FreeSurface(image);
    SDL_Quit();
 
    return EXIT_SUCCESS;
}</code></pre></div><p id="r-576213" data-claire-element-id="576213">Voilà, c'est fini. :D</p><p id="r-576214" data-claire-element-id="576214">Maintenant vous savez faire des rotations !<br/> Et donc grâce à cela, vous allez pouvoir réaliser plein de super trucs.</p><p id="r-576215" data-claire-element-id="576215">Bonne programmation ! :)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx">Faire des rotations avec SDL_gfx</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/c-est-quoi-sdl-gfx">
C&#039;est quoi SDL_gfx ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
Installation de SDL_gfx
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/faire-une-rotation">
Faire une rotation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-des-rotations-avec-sdl-gfx/installation-de-sdl-gfx">
<span class="arrow"></span>
<span class="next">Installation de SDL_gfx</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/faire-des-rotations-avec-sdl-gfx.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 19:50:11 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/faire-des-rotations-avec-sdl-gfx.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 03:34:32 GMT -->
</html>