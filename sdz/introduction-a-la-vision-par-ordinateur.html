<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/introduction-a-la-vision-par-ordinateur.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:28:44 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/introduction-a-la-vision-par-ordinateur.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:31:22 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Introduction à la vision par ordinateur</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/introduction-a-la-vision-par-ordinateur.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Introduction à la vision par ordinateur</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Introductionlavisionparordinateur">Introduction à la vision par ordinateur</a><br/><a href="#Avantdecommencer">Avant de commencer…</a><br/><a href="#Cadreetportedececours">Cadre et portée de ce cours</a><br/><a href="#Prsentationd039OpenCV">Présentation d&#039;OpenCV</a><br/><a href="#InstalleretconfigurerOpenCV">Installer et configurer OpenCV</a><br/><a href="#Premierspas">Premiers pas</a><br/><a href="#Helloworld">Hello, world!</a><br/><a href="#Chargeretsauvegarderdesimages">Charger et sauvegarder des images</a><br/><a href="#Uneinterfacesimplemaispratique">Une interface simple, mais pratique</a><br/><a href="#Qu039est-cequ039uneimage">Qu&#039;est-ce qu&#039;une image ?</a><br/><a href="#Reprsentationformelle">Représentation formelle</a><br/><a href="#LastructureIplImage">La structure IplImage</a><br/><a href="#Parcouriruneimage">Parcourir une image</a><br/><a href="#Exercices">Exercices</a><br/><a href="#Unnouveaumondeencouleurs">Un nouveau monde en couleurs…</a><br/><a href="#Reprsentationthoriquedescouleurs">Représentation théorique des couleurs</a><br/><a href="#Travailleravecdesimagesencouleur">Travailler avec des images en couleur</a><br/><a href="#Exercices">Exercices</a><br/><a href="#tirementetgalisationd039histogramme">Étirement et égalisation d&#039;histogramme</a><br/><a href="#Histogrammed039uneimage">Histogramme d&#039;une image</a><br/><a href="#Normalisationd039uneimage">Normalisation d&#039;une image</a><br/><a href="#galisationd039histogramme">Égalisation d&#039;histogramme</a><br/></div>
<a name="Introductionlavisionparordinateur"></a><h2>Introduction à la vision par ordinateur</h2><div class="content" role="article">
<p id="r-208812" data-claire-element-id="208812"><em>Qu'est-ce que la vision ?</em></p><p id="r-208813" data-claire-element-id="208813">Elle semble toute simple, cette question, mais si vous aviez à y répondre avec vos propres mots, que diriez-vous ?</p><p id="r-208814" data-claire-element-id="208814">Allez, je vous aide un peu. « Voir » c'est, entre autres, discerner et reconnaître les formes, les couleurs et les textures du monde qui nous entoure.</p><p id="r-208815" data-claire-element-id="208815">On pourrait croire, à tort, que nous avons besoin uniquement de nos yeux pour cela, mais la réalité est tout autre : nos yeux ne servent qu'à <em>capter le signal</em> contenu dans les rayons lumineux qui viennent frapper nos rétines, pas à en <em>extraire des informations</em>. Ça, c'est le travail de la zone de notre cerveau que nous appelons le <em>cortex visuel</em>, dont les « <em>bugs</em> » ne sont rien de moins que les illusions d'optique ! Cela veut dire que la <strong>vision</strong>, c'est l'association entre le <strong>sens de la vue</strong> et un ensemble de <strong>processus cognitifs</strong> pour lesquels nous avons besoin d'utiliser notre cerveau.</p><p id="r-208816" data-claire-element-id="208816">Aujourd'hui, cela fait déjà bien longtemps que nous avons donné le sens de la vue aux ordinateurs grâce aux caméras numériques, mais si l'on se fie à la définition que nous venons de formuler, cela ne suffit pas à les doter de <em>vision</em> : il leur manque encore la capacité à <strong>extraire des informations</strong> des images et des flux vidéo, de manière à <strong>percevoir</strong>, <strong>analyser</strong> et <strong>comprendre</strong> le monde qu'ils observent.</p><p id="r-208817" data-claire-element-id="208817">C'est ici qu'intervient ce vaste domaine de recherche qu'est la <strong>vision par ordinateur</strong>, à la croisée des chemins entre les mathématiques, le traitement du signal et l'intelligence artificielle.</p><p id="r-208818" data-claire-element-id="208818">Dans ce cours, nous allons découvrir ensemble les notions de base du traitement d'images et de flux vidéo, ainsi que les principales problématiques de la vision par ordinateur. Et elles sont nombreuses, vous pouvez me croire ! Entre le filtrage, la segmentation d'objets, la reconnaissance de formes, la détection du mouvement, le suivi de cibles et autres joyeusetés, nous aurons l'occasion de découvrir ensemble un large spectre de problèmes divers et variés, ainsi que des éléments de réponse pour les résoudre.</p><p id="r-208819" data-claire-element-id="208819">Pour suivre, vous aurez besoin d'être à l'aise avec <strong>le langage C</strong>, que nous utiliserons avec la bibliothèque <strong>OpenCV</strong> pour réaliser nos programmes. Quelques connaissances de base en mathématiques vous seront aussi demandées, mais un effort particulier a été fourni pour rendre les explications compréhensibles par le plus grand nombre.</p>
</div>
<div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script>
</div><a name="Avantdecommencer"></a><h2>Avant de commencer…</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
<span class="next">Cadre et portée de ce cours</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-208821" data-claire-element-id="208821">Avant de nous plonger corps et âme dans la vision par ordinateur, attardons-nous un moment sur quelques considérations d'ordre général, et préparons notre matériel.</p>
</div><a name="Cadreetportedececours"></a><h2>Cadre et portée de ce cours</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">
<span class="arrow"></span>
<span class="next">Avant de commencer…</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
<span class="next">Présentation d&#039;OpenCV</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-cadre-et-portee-de-ce-cours" data-claire-element-id="208846">Cadre et portée de ce cours</h4><h5 id="r-objectif-9" data-claire-element-id="208825">Objectif</h5><p id="r-208822" data-claire-element-id="208822">Ce cours a pour but de vous introduire les notions fondamentales de la vision par ordinateur. Plus précisément, son objectif premier est de vous aider à acquérir une certaine intuition du traitement d'images et de flux vidéo, ainsi que des diverses problématiques de l'intelligence artificielle qui y sont liées.</p><p id="r-208823" data-claire-element-id="208823">Tout cela passe par l'acquisition de connaissances en informatique et en traitement du signal (à tout le moins, comment sont représentés les images numériques et les flux vidéo dans un ordinateur…) et des notions de base concernant plusieurs outils mathématiques très utilisés dans ce domaine (la manipulation de matrices, la morphologie, les géométries discrète, projective et épipolaire, quelques notions de statistiques…).</p><p id="r-208824" data-claire-element-id="208824">Il s'agit, pour résumer, de faire avec vous un tour d'horizon de la vision par ordinateur, que vous pourrez approfondir par la suite en vous intéressant à une littérature plus spécialisée dans le domaine.</p><h5 id="r-public-et-connaissances-requises" data-claire-element-id="208828">Public et connaissances requises</h5><p id="r-208826" data-claire-element-id="208826">Si <strong>d'un point de vue théorique</strong>, la vision par ordinateur est un domaine nécessitant d'ordinaire une culture scientifique certaine, un effort particulier de vulgarisation a été fourni de manière à rendre ce tutoriel accessible pour des lecteurs ayant <strong>un bagage mathématique pré-baccalauréat</strong>. Néanmoins, ponctuellement, certaines parties facultatives du cours, portant sur des points qu'il est intéressant d'aborder mais non fondamentaux, pourront requérir un niveau de connaissances plus avancé. Ces parties, ainsi que les connaissances requises pour les suivre, vous seront systématiquement signalées.</p><p id="r-208827" data-claire-element-id="208827"><strong>D'un point de vue technique</strong>, afin que les explications ne soient pas noyées dans un flot d'informations périphériques inutiles, ce tutoriel part du principe que <strong>vous savez programmer en C, configurer votre environnement de développement, utiliser votre compilateur et lire une documentation</strong> en anglais. Des liens vers de la documentation annexe seront fournis lorsque ce sera nécessaire. En ce qui concerne votre niveau de programmation, les deux premières parties du <a href="http://www.siteduzero.com/tutoriel-3-14189-apprenez-a-programmer-en-c.html">cours de C de Mathieu Nebra</a> devraient suffire, en considérant toutefois dans ce cas que vous n'avez rien contre le fait de découvrir et acquérir, ponctuellement, des pratiques dont vous n'avez pas forcément l'habitude.</p><h5 id="r-organisation-1" data-claire-element-id="208845">Organisation</h5><p id="r-208829" data-claire-element-id="208829">Ce cours est organisé de la façon suivante :</p><ul id="r-208834" data-claire-element-id="208834"><li id="r-208831" data-claire-element-id="208831"><p id="r-208830" data-claire-element-id="208830"><strong>La première partie</strong> aborde les notions préliminaires fondamentales à la compréhension de tout le reste. Ses chapitres sont écrits de façon à être lus dans l'ordre.</p></li><li id="r-208833" data-claire-element-id="208833"><p id="r-208832" data-claire-element-id="208832"><strong>Les parties suivantes</strong> abordent chacune une problématique particulière de la vision par ordinateur. Le premier chapitre de chaque partie donne la formulation d'un verrou théorique (par exemple : « <em>détecter les objets en mouvement sur une vidéo</em> », « <em>reconnaître un objet dans une image</em> », …) ainsi qu'une première approche naïve pour tenter de lever ce dernier, et les chapitres suivants abordent différentes approches alternatives, permettant bien souvent d'améliorer les résultats, ou d'aborder le problème selon un angle différent. A priori, ces parties peuvent être lues dans n'importe quel ordre.</p></li></ul><p id="r-208835" data-claire-element-id="208835">Chaque fois que cela sera possible, les diverses notions abordées seront présentées de la façon suivante :</p><ul id="r-208844" data-claire-element-id="208844"><li id="r-208837" data-claire-element-id="208837"><p id="r-208836" data-claire-element-id="208836">Formulation de la notion sous la forme d'un verrou technique ou théorique,</p></li><li id="r-208839" data-claire-element-id="208839"><p id="r-208838" data-claire-element-id="208838">Résolution d'un point de vue théorique,</p></li><li id="r-208841" data-claire-element-id="208841"><p id="r-208840" data-claire-element-id="208840">Implémentation de la solution,</p></li><li id="r-208843" data-claire-element-id="208843"><p id="r-208842" data-claire-element-id="208842">Exercices d'application.</p></li></ul>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">
<span class="arrow"></span>
<span class="next">Avant de commencer…</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
<span class="next">Présentation d&#039;OpenCV</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Prsentationd039OpenCV"></a><h2>Présentation d&#039;OpenCV</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
<span class="arrow"></span>
<span class="next">Cadre et portée de ce cours</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
<span class="next">Installer et configurer OpenCV</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-presentation-d-opencv" data-claire-element-id="208866">Présentation d'OpenCV</h4><p id="r-208847" data-claire-element-id="208847"><a href="http://opencv.willowgarage.com/wiki/Welcome">OpenCV</a> (<strong>Open</strong> Source <strong>C</strong>omputer <strong>V</strong>ision) est une bibliothèque proposant un ensemble de plus de 2500 algorithmes de vision par ordinateur, accessibles au travers d'API pour les langages C, C++, et Python. Elle est distribuée sous une <a href="http://creativecommons.org/licenses/BSD/">licence BSD</a> (libre) pour les plate-formes Windows, GNU/Linux, Android et MacOS.</p><p id="r-208848" data-claire-element-id="208848">Initialement écrite en C il y a 10 ans par des chercheurs de la société Intel, OpenCV est aujourd'hui développée, maintenue, documentée et utilisée par une communauté de plus de 40 000 membres actifs. C'est <strong>la</strong> bibliothèque de référence pour la vision par ordinateur, aussi bien dans le monde de la recherche que celui de l'industrie.</p><p id="r-208849" data-claire-element-id="208849">Afin de mieux vous présenter son étendue et ce qu'elle permet de faire, jetons un œil aux principaux modules accessibles au travers de son API C.</p><ul id="r-208864" data-claire-element-id="208864"><li id="r-208851" data-claire-element-id="208851"><p id="r-208850" data-claire-element-id="208850"><strong>core</strong> : les fonctionnalités de base.<br/> Cette bibliothèque permet de manipuler les structures de base, réaliser des opérations sur des matrices, dessiner sur des images, sauvegarder et charger des données dans des fichiers XML…</p></li><li id="r-208853" data-claire-element-id="208853"><p id="r-208852" data-claire-element-id="208852"><strong>imgproc</strong> : traitement d'image.<br/> Nous entrons dans le cœur du sujet. Les fonctions et structures de ce module ont trait aux transformations d'images, au filtrage, à la détection de contours, de points d'intérêt…</p></li><li id="r-208855" data-claire-element-id="208855"><p id="r-208854" data-claire-element-id="208854"><strong>features2d</strong> : descripteurs.<br/> Ce module concerne principalement l'extraction de descripteurs selon deux approches courantes (SURF et StarDetector), que nous aborderons lorsque nous nous intéresserons à la caractérisation d'images.</p></li><li id="r-208857" data-claire-element-id="208857"><p id="r-208856" data-claire-element-id="208856"><strong>objdetect</strong> : détection d'objets.<br/> Cette bibliothèque permet de faire de la reconnaissance d'objets dans une image au moyen de l'algorithme Adaboost (Viola &amp; Jones, 2001). Nous y reviendrons lorsque nous parlerons d'apprentissage et de reconnaissance de formes.</p></li><li id="r-208859" data-claire-element-id="208859"><p id="r-208858" data-claire-element-id="208858"><strong>video</strong> : traitement de flux vidéo. <br/> Ces fonctions servent à segmenter et suivre les objets en mouvement dans une vidéo.</p></li><li id="r-208861" data-claire-element-id="208861"><p id="r-208860" data-claire-element-id="208860"><strong>highgui</strong> : entrées-sorties et interface utilisateur.<br/> OpenCV intègre sa propre bibliothèque haut-niveau pour ouvrir, enregistrer et afficher des images et des flux vidéo. Celle-ci contient aussi un certain nombre de fonctions permettant de réaliser des interfaces graphiques très simples, mais largement suffisantes pour tester nos programmes.</p></li><li id="r-208863" data-claire-element-id="208863"><p id="r-208862" data-claire-element-id="208862"><strong>calib3d</strong> : calibration, estimation de pose et stéréovision.<br/> Ce module contient des fonctions permettant de reconstruire une scène en 3D à partir d'images acquises avec plusieurs caméras simultanément.</p></li></ul><p id="r-208865" data-claire-element-id="208865">En ce qui concerne la documentation, vous trouverez tout ce dont vous aurez besoin sur <a href="http://opencv.willowgarage.com/documentation/c/index.html">cette page</a>. Sachez que l'API C est stable. Cela signifie qu'il est très peu probable que grand-chose ne soit modifié ou retiré de son côté dans les versions 2.x d'OpenCV, et c'est la raison pour laquelle j'ai choisi d'utiliser cette API dans ce cours, plutôt que l'interface C++ qui, elle, est un peu moins mature.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
<span class="arrow"></span>
<span class="next">Cadre et portée de ce cours</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
<span class="next">Installer et configurer OpenCV</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="InstalleretconfigurerOpenCV"></a><h2>Installer et configurer OpenCV</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
<span class="arrow"></span>
<span class="next">Présentation d&#039;OpenCV</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">
<span class="next">Premiers pas</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-installer-et-configurer-opencv" data-claire-element-id="208902">Installer et configurer OpenCV</h4><h5 id="r-installation-23" data-claire-element-id="208882">Installation</h5><h6 id="r-sous-windows-13" data-claire-element-id="208870">Sous Windows</h6><p id="r-208867" data-claire-element-id="208867">Sous windows, la méthode d'installation dépend de l'environnement que vous utilisez pour développer. <a href="http://sourceforge.net/projects/opencvlibrary/files/opencv-win/2.3/">Rendez-vous sur cette page</a>.</p><p id="r-208868" data-claire-element-id="208868"><strong>Si vous utilisez Microsoft Visual Studio</strong>, vous avez tout intérêt à utiliser l'installeur exécutable, puisqu'il contient les bibliothèques compilées spécialement pour votre IDE.</p><p id="r-208869" data-claire-element-id="208869"><strong>Si vous utilisez un autre IDE</strong> (Code::Blocks, Eclipse, etc.), il faudra que vous téléchargiez le paquet OpenCV-2.X.Y-win-src.zip, et que vous génériez les bibliothèques d'OpenCV avec CMake, en suivant simplement les instructions de <a href="http://opencv.itseez.com/doc/tutorials/introduction/windows_install/windows_install.html#installation-by-making-your-own-libraries-from-the-source-files">cette page</a>, qui vous montre comment faire en vidéo, en plus des explications détaillées.</p><h6 id="r-sous-gnu-linux-unix" data-claire-element-id="208879">Sous GNU/Linux, Unix</h6><p id="r-208871" data-claire-element-id="208871">Sous Linux et Unix, OpenCV 2 se trouve nécessairement dans les dépôts de votre distribution, quelle qu'elle soit, en version 2.</p><p id="r-208872" data-claire-element-id="208872">Sous Ubuntu, il vous suffit de taper la commande suivante dans un terminal :</p><pre id="r-208873" data-claire-element-id="208873"><code data-claire-semantic="console">sudo apt-get install libcv-dev libcvaux-dev libhighgui-dev</code></pre><p id="r-208874" data-claire-element-id="208874">Sous Archlinux, ce sera :</p><pre id="r-208875" data-claire-element-id="208875"><code data-claire-semantic="console">pacman -S opencv</code></pre><p id="r-208876" data-claire-element-id="208876">Sous Fedora :</p><pre id="r-208877" data-claire-element-id="208877"><code data-claire-semantic="console">yum install opencv</code></pre><p id="r-208878" data-claire-element-id="208878"><strong>Si toutefois vous désirez compiler OpenCV vous-même</strong>, pour obtenir une version plus récente que celle de vos dépôts (même si cela ne fera aucune différence pour suivre ce tutoriel), vous pouvez vous rendre sur <a href="http://opencv.itseez.com/doc/tutorials/introduction/linux_install/linux_install.html#linux-installation">cette page</a>, et suivre les indications pas à pas.</p><h6 id="r-sous-macos" data-claire-element-id="208881">Sous MacOS</h6><p id="r-208880" data-claire-element-id="208880">Sous MacOS, vous avez deux possibilités, la simple et la compliquée. :) <br/> En vous rendant sur <a href="http://vislab.cs.vt.edu/~vislab/wiki/index.php?title=Vision">cette page</a>, vous trouverez un installeur (.dmg) tout prêt pour OpenCV 2.0 ou OpenCV 1.1, qui se chargera de tout régler pour vous. Je vous rappelle qu'en ce qui nous concerne, étant donné que nous allons utiliser l'API C, OpenCV 2.0 suffira très largement pour suivre ce tutoriel (même la version 1.1 suffit, pour tout vous avouer).<br/> Si vous tenez quand même à rester à la pointe, vous pouvez compiler OpenCV avec CMake pour votre machine en suivant <a href="http://opencv.willowgarage.com/wiki/Mac_OS_X_OpenCV_Port">les instructions de cette page</a>.</p><h5 id="r-configuration-de-votre-environnement" data-claire-element-id="208897">Configuration de votre environnement</h5><p id="r-208883" data-claire-element-id="208883">Devant le grand nombre de possibilités que vous avez suivant l'environnement que vous utilisez pour travailler, il ne serait pas pertinent de vous décrire en détail la marche à suivre pour chacune d'entre elles. En revanche, voici quelques rappels simples, qui, moyennant le fait que vous sachiez utiliser votre IDE, devraient suffire à vous pointer dans la bonne direction.</p><p id="r-208884" data-claire-element-id="208884">La génération des programmes en C se fait en deux étapes : la compilation du code et l'édition des liens. De façon à pouvoir utiliser une bibliothèque tierce, votre compilateur doit savoir où il peut trouver les fichiers d'en-tête d'OpenCV, et l'éditeur de lien (<em>linker</em>) doit savoir dans quelles bibliothèques se trouvent les symboles des fonctions qu'il utilise.</p><p id="r-208885" data-claire-element-id="208885"><strong><em>La configuration de votre environnement consiste ni plus, ni moins, à dire au compilateur où se trouvent les en-têtes, et à l'éditeur de liens où se trouvent les bibliothèques</em></strong>.</p><h6 id="r-sous-windows-14" data-claire-element-id="208889">Sous Windows</h6><p id="r-208886" data-claire-element-id="208886">Les fichiers d'en-tête se trouvent dans le sous-répertoire <code>include</code> du dossier où OpenCV est installée. Il faut donc ajouter le chemin de ce répertoire dans les paramètres du compilateur.</p><p id="r-208887" data-claire-element-id="208887">Pour les bibliothèques, celles-ci se trouvent dans le sous-répertoire <code>libs</code> du même dossier. Il faudra donc, suivant votre IDE, préciser le chemin de ce sous-répertoire, ou bien donner un à un les noms des fichiers .lib (ou .dll) qu'il contient, dans les options de l'éditeur de liens.</p><p id="r-208888" data-claire-element-id="208888"><strong>Si vous utilisez Microsoft Visual Studio</strong>, vous trouverez des informations détaillées pour votre IDE <a href="http://opencv.itseez.com/doc/tutorials/introduction/windows_visual_studio_Opencv/windows_visual_studio_Opencv.html#windows-visual-studio-how-to">sur cette page</a> de la documentation.<br/><strong>Si vous utilisez Code::Blocks</strong>, vous pouvez suivre <a href="http://opencv.willowgarage.com/wiki/CodeBlocks">ces instructions</a> qui vous montreront comment configurer votre IDE pour qu'il utilise opencv avec <a href="http://www.freedesktop.org/wiki/Software/pkg-config">pkg-config</a>.</p><h6 id="r-sous-gnu-linux-et-unix" data-claire-element-id="208896">Sous GNU/Linux et Unix</h6><p id="r-208890" data-claire-element-id="208890">Sous GNU/Linux et Unix, les fichiers d'en-tête et les bibliothèques sont installés dans des emplacements standards. OpenCV s'utilise et se configure donc, sur ces OS, strictement de la même manière que toutes les autres bibliothèques.</p><p id="r-208891" data-claire-element-id="208891"><strong>Si vous utilisez Code::Blocks</strong>, vous pouvez configurer ce dernier en suivant les indications de <a href="http://opencv.willowgarage.com/wiki/CodeBlocks">cette page</a>.</p><p id="r-208892" data-claire-element-id="208892"><strong>Si vous compilez vos fichiers manuellement</strong>, voici un exemple de compilation d'un programme (helloworld.c) avec opencv dans la console :</p><pre id="r-208893" data-claire-element-id="208893"><code data-claire-semantic="console"># compilation
gcc -c helloworld.c -Wall `pkg-config opencv --cflags`

# édition des liens
gcc helloworld.o -o helloworld `pkg-config opencv --libs`</code></pre><p id="r-208894" data-claire-element-id="208894"><strong>Si vous utilisez CMake</strong> (la solution que je privilégie personnellement), voici un exemple de fichier CMakeLists.txt minimaliste pour le même programme :</p><pre id="r-208895" data-claire-element-id="208895"><code data-claire-semantic="cmake"># Ajustez en fonction de votre version de CMake
cmake_minimum_required (VERSION 2.8)

# Nom du projet
project (hello)

find_package (OpenCV REQUIRED)

# Exécutable &quot;hello&quot;, compilé à partir du fichier helloworld.c
add_executable (hello helloworld.c)

# Hello sera linké avec les bibliothèques d'OpenCV
target_link_libraries (hello ${OpenCV_LIBS})</code></pre><h5 id="r-test-de-votre-installation" data-claire-element-id="208901">Test de votre installation</h5><p id="r-208898" data-claire-element-id="208898">Pour tester votre installation et votre configuration, essayez de compiler le programme suivant (inutile de le lancer ou de chercher à le comprendre pour l'instant, nous verrons cela dans le prochain chapitre) :</p><pre id="r-208899" data-claire-element-id="208899"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;opencv/highgui.h&gt;

int main (int argc, char* argv[])
{
  IplImage* img = NULL; 
  const char* window_title = &quot;Hello, OpenCV!&quot;;

  if (argc &lt; 2)
  {
    fprintf (stderr, &quot;usage: %s IMAGE\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }
  img = cvLoadImage(argv[1], CV_LOAD_IMAGE_UNCHANGED);

  if (img == NULL)
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, argv[1]);
    return EXIT_FAILURE;
  }
  cvNamedWindow (window_title, CV_WINDOW_AUTOSIZE);
  cvShowImage (window_title, img);
  cvWaitKey(0);
  cvDestroyAllWindows();
  cvReleaseImage(&amp;img);

  return EXIT_SUCCESS;
}</code></pre><p id="r-208900" data-claire-element-id="208900">Si votre compilateur ne vous envoie pas sur les roses, c'est gagné !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
<span class="arrow"></span>
<span class="next">Présentation d&#039;OpenCV</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">
<span class="next">Premiers pas</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Premierspas"></a><h2>Premiers pas</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
<span class="arrow"></span>
<span class="next">Installer et configurer OpenCV</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
<span class="next">Hello, world!</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-208904" data-claire-element-id="208904">Dans ce chapitre, nous allons nous découvrir nos premières structures et fonctions d'OpenCV en apprenant à ouvrir, afficher et sauvegarder des images au moyen du module <code>highgui</code>. Bien qu'elles ne soient pas spécialement intéressantes sur le plan théorique, ces quelques fonctions fondamentales seront réutilisées pratiquement dans tous nos programmes par la suite.</p>
</div><a name="Helloworld"></a><h2>Hello, world!</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">
<span class="arrow"></span>
<span class="next">Premiers pas</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
<span class="next">Charger et sauvegarder des images</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-hello-world-2" data-claire-element-id="208931">Hello, world!</h4><h5 id="r-votre-premier-programme-3" data-claire-element-id="208912">Votre premier programme</h5><p id="r-208905" data-claire-element-id="208905">Sans autre forme d'introduction, reprenons le code que je vous ai montré à la fin du chapitre précédent, auquel j'ai ajouté des commentaires.</p><pre id="r-208906" data-claire-element-id="208906"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;opencv/highgui.h&gt;

int main (int argc, char* argv[])
{
  IplImage* img = NULL; 
  const char* window_title = &quot;Hello, OpenCV!&quot;;

  /* Vérification: au moins un argument doit être passé au programme.*/
  if (argc &lt; 2)
  {
    fprintf (stderr, &quot;usage: %s IMAGE\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }

  /* Chargement de l'image passée en argument */
  img = cvLoadImage(argv[1], CV_LOAD_IMAGE_UNCHANGED);

  if (!img)
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, argv[1]);
    return EXIT_FAILURE;
  }

  /* Création d'une fenêtre intitulée &quot;Hello, OpenCV!&quot; */
  cvNamedWindow (window_title, CV_WINDOW_AUTOSIZE);

  /* Affichage de l'image */
  cvShowImage (window_title, img);

  /* Pause le temps que l'utilisateur appuie sur une touche */
  cvWaitKey (0);

  /* Destruction de la fenêtre */
  cvDestroyAllWindows ();
  
  /* Libération de la mémoire */
  cvReleaseImage (&amp;img);

  return EXIT_SUCCESS;
}</code></pre><p id="r-208907" data-claire-element-id="208907">Comme vous vous en êtes très probablement rendu compte, ce programme attend que vous lui passiez un argument : le chemin d'un fichier d'image sur votre ordinateur.</p><p id="r-208908" data-claire-element-id="208908">Sous Windows, il vous suffit, graphiquement, de prendre un fichier image et de le glisser-déposer sur l'exécutable de votre programme.</p><p id="r-208909" data-claire-element-id="208909">Sinon, vous pouvez passer cette image en ligne de commande. Par exemple, sous GNU/Linux :</p><pre id="r-208910" data-claire-element-id="208910"><code data-claire-semantic="console">arnaud@netbook$ cd prg/c/vpo/helloworld
arnaud@netbook$ ./hello
usage: ./hello IMAGE
arnaud@netbook$ ./hello /home/arnaud/img/vpo/lena.jpg</code></pre><p id="r-208911" data-claire-element-id="208911">Appuyez sur une touche du clavier pour que la fenêtre se ferme et que le programme s'arrête.</p><h5 id="r-analyse-du-code" data-claire-element-id="208930">Analyse du code</h5><p id="r-208913" data-claire-element-id="208913">Pour commencer, prenons ce code pas à pas, et analysons les étapes ensemble.</p><pre id="r-208914" data-claire-element-id="208914"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

/* ... */

int main (int argc, char* argv[])
{
  /* ... */

  /* Vérification: au moins un argument doit être passé au programme.*/
  if (argc &lt; 2)
  {
    fprintf (stderr, &quot;usage: %s IMAGE\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }</code></pre><p id="r-208915" data-claire-element-id="208915">C'est grâce à ce morceau de code que l'on passe un argument au programme. Pour rappel, les arguments passés au programme sont contenus sous forme de chaînes de caractères dans le tableau <code data-claire-semantic="c">argv</code> (pour &quot;<strong>arg</strong><em>argument <strong>v</strong>alues</em>&quot;) et la longueur de ce tableau est contenue dans l'entier <code data-claire-semantic="c">argc</code> (pour &quot;<em><strong>arg</strong>ument <strong>c</strong>ount</em>&quot;). Pour plus d'informations à ce sujet, je vous renvoie à ce <a href="http://www.siteduzero.com/tutoriel-3-37162-les-parametres-de-la-fonction-main.html">tutoriel de FFMx sur les paramètres de la fonction main</a>.</p><p id="r-208916" data-claire-element-id="208916">Le tout premier élément d'<code>argv</code> (<code>argv[0]</code>) est le nom grâce auquel le programme a été appelé. On s'en sert ici pour afficher le message d'aide (&quot;usage&quot;), dans la sortie d'erreur standard si le programme a été invoqué sans argument.</p><p id="r-208917" data-claire-element-id="208917">Passons à la suite, où l'on utilise clairement OpenCV.</p><pre id="r-208918" data-claire-element-id="208918"><code data-claire-semantic="c">#include &lt;opencv/highgui.h&gt;

IplImage* img = NULL; 

/* Chargement de l'image passée en argument */
img = cvLoadImage(argv[1], CV_LOAD_IMAGE_UNCHANGED);

if (!img)
{
  fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, argv[1]);
  return EXIT_FAILURE;
}</code></pre><p id="r-208919" data-claire-element-id="208919">Ici, on fait deux choses intéressantes. La première, c'est déclarer que l'on va utiliser un pointeur sur une structure <code>IplImage</code>. Cette structure, nous allons la considérer comme une « boîte noire » dans ce chapitre, et nous commencerons à la disséquer dans le chapitre suivant. Pour l'instant, retenez simplement qu'il s'agit d'<strong>une image</strong> dans OpenCV.</p><p id="r-208920" data-claire-element-id="208920">Nous utilisons ensuite la fonction <code>cvLoadImage</code>, à laquelle on passe le premier argument du programme (le chemin d'un fichier image sur votre ordinateur), ainsi qu'une constante dont nous nous occuperons plus tard. Cette fonction ouvre l'image dont on lui passe le chemin en argument, et retourne un <code>IplImage*</code> contenant ses données. En cas d'échec de l'ouverture, comme matérialisé par la condition qui suit, la fonction <code>cvLoadImage</code> retourne le pointeur <code>NULL</code>.</p><p id="r-208921" data-claire-element-id="208921">Voici le comportement du programme si je lui passe en argument le chemin d'un fichier qu'il ne peut pas charger, ou celui d'un fichier qui n'existe pas :</p><pre id="r-208922" data-claire-element-id="208922"><code data-claire-semantic="console">arnaud@netbook$ ./hello world
couldn't open image file: world</code></pre><p id="r-208923" data-claire-element-id="208923">Bien, maintenant, la suite :</p><pre id="r-208924" data-claire-element-id="208924"><code data-claire-semantic="c">const char* window_title = &quot;Hello, OpenCV!&quot;;

/* Création d'une fenêtre intitulée &quot;Hello, OpenCV!&quot; */
cvNamedWindow (window_title, CV_WINDOW_AUTOSIZE);

/* Affichage de l'image */
cvShowImage (window_title, img);</code></pre><p id="r-208925" data-claire-element-id="208925">Voici ce qui va faire de la <code>highgui</code> votre meilleure amie pour tester vos programmes. Ces deux lignes suffisent à créer une fenêtre et à afficher une image dedans ! Les fenêtres, dans cette bibliothèque, sont identifiées par leur <strong>titre</strong>. Cela signifie que vous ne pouvez pas avoir deux fenêtres qui ont le même titre, mais vous conviendrez que cette limitation en vaut largement la peine, puisqu'en dehors de cela, vous n'avez même pas à vous inquiéter des détails de l'affichage ; tout est géré pour vous !</p><p id="r-208926" data-claire-element-id="208926">Enfin, la fin du programme :</p><pre id="r-208927" data-claire-element-id="208927"><code data-claire-semantic="c">/* Pause le temps que l'utilisateur appuie sur une touche */
cvWaitKey (0);

/* Destruction de la fenêtre */
cvDestroyAllWindows ();
  
/* Libération de la mémoire */
cvReleaseImage (&amp;img);</code></pre><p id="r-208928" data-claire-element-id="208928">La fonction <code>cvWaitKey</code>, <strong>lorsqu'une fenêtre est affichée à l'écran</strong>, permet de marquer une pause dans le programme en attendant que l'utilisateur appuie sur une touche du clavier. L'argument <code data-claire-semantic="c">0</code>, ici, permet d'attendre indéfiniment.</p><p id="r-208929" data-claire-element-id="208929">Les deux fonctions suivantes sont explicites. Notez simplement que la fonction <code>cvReleaseImage</code> attend en paramètre un <code>IplImage**</code> et non un <code>IplImage*</code>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">
<span class="arrow"></span>
<span class="next">Premiers pas</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
<span class="next">Charger et sauvegarder des images</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Chargeretsauvegarderdesimages"></a><h2>Charger et sauvegarder des images</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
<span class="arrow"></span>
<span class="next">Hello, world!</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
<span class="next">Une interface simple, mais pratique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-charger-et-sauvegarder-des-images" data-claire-element-id="208975">Charger et sauvegarder des images</h4><p id="r-208932" data-claire-element-id="208932">Commençons par le commencement.</p><p id="r-208933" data-claire-element-id="208933">Pour travailler avec des images, il nous faut un moyen de charger celles-ci dans nos programmes, et éventuellement de sauvegarder le résultat.</p><h5 id="r-charger-une-image" data-claire-element-id="208946">Charger une image</h5><p id="r-208934" data-claire-element-id="208934">Nous avons vu plus haut la fonction <code data-claire-semantic="c">cvLoadImage</code>. Voici sa signature :</p><pre id="r-208935" data-claire-element-id="208935"><code data-claire-semantic="c">/**
 * Charge une image
 * arguments: 
 * - filename: chemin de l'image à charger
 * - iscolor: option permettant de charger l'image en couleur ou en 
 *            niveaux de gris
 * retourne: 
 * Un pointeur sur la structure IplImage dans laquelle le fichier a 
 * été chargé. NULL en cas d'échec.
 */
IplImage* cvLoadImage (const char* filename, int iscolor);</code></pre><p id="r-208936" data-claire-element-id="208936">OpenCV peut charger plusieurs formats d'image différents. Je ne saurais vous donner une liste <em>exacte</em> des formats qui fonctionneront chez vous étant donné que cela dépend de votre système, et des paramètres de compilation si vous avez compilé OpenCV vous-même, mais en principe, vous devriez sans problème pouvoir ouvrir des images au format <code>.jpg</code>, <code>.png</code>, <code>.bmp</code>, et <code>.tif</code>.</p><p id="r-208937" data-claire-element-id="208937">Regardons maintenant cet argument <code data-claire-semantic="c">iscolor</code> d'un peu plus près et en particulier les différentes constantes que l'on peut utiliser :</p><ul id="r-208944" data-claire-element-id="208944"><li id="r-208939" data-claire-element-id="208939"><p id="r-208938" data-claire-element-id="208938">CV_LOAD_IMAGE_COLOR : Le fichier sera chargé en mode &quot;couleur&quot;, même si l'image est en niveaux de gris.</p></li><li id="r-208941" data-claire-element-id="208941"><p id="r-208940" data-claire-element-id="208940">CV_LOAD_IMAGE_GRAYSCALE : L'image sera chargée en niveaux de gris.</p></li><li id="r-208943" data-claire-element-id="208943"><p id="r-208942" data-claire-element-id="208942">CV_LOAD_IMAGE_UNCHANGED : L'image sera chargée telle qu'elle</p></li></ul><p id="r-208945" data-claire-element-id="208945">Ces considérations sur le mode couleur ou niveaux de gris feront du sens dans le prochain chapitre, lorsque nous verrons plus en détail la structure <code data-claire-semantic="c">IplImage</code>. Retenez simplement que cette fonction permet de faire automatiquement la conversion si nécessaire lors du chargement du fichier.</p><h5 id="r-sauvegarder-une-image" data-claire-element-id="208964">Sauvegarder une image</h5><p id="r-208947" data-claire-element-id="208947">Voici maintenant la fonction qui nous permettra d'enregistrer une image sur le disque dur :</p><pre id="r-208948" data-claire-element-id="208948"><code data-claire-semantic="c">/**
 * Sauvegarde une image sur le disque dur
 * arguments:
 * - filename: chemin du fichier à sauvegarder
 * - image: image à sauvegarder
 * - params: paramètres optionnels
 * retourne:
 * 1 si le fichier a bien été sauvegardé, 0 sinon.
 */
int cvSaveImage (const char* filename, const CvArr* image, const int* params);</code></pre><div id="r-208950" data-claire-element-id="208950" data-claire-semantic="question"><p id="r-208949" data-claire-element-id="208949"><code data-claire-semantic="c">CvArr*</code> ? C'est une structure que je ne connais pas, ça ! o_O</p></div><p id="r-208951" data-claire-element-id="208951">Pas de panique ! En consultant la documentation d'OpenCV, vous vous rendrez compte que <a href="http://opencv.willowgarage.com/documentation/c/core_basic_structures.html#cvarr">la définition de CvArr</a> est un petit peu troublante :</p><pre id="r-208952" data-claire-element-id="208952"><code data-claire-semantic="c">typedef void CvArr;</code></pre><p id="r-208953" data-claire-element-id="208953">En fait, OpenCV contient plusieurs structures pour représenter les images, les matrices, ou les tableaux en général, mais comme son API est bien faite, la plupart des fonctions peuvent prendre en arguments n'importe laquelle de ces structures. En l'occurrence, le « Arr » de <code data-claire-semantic="c">CvArr</code> signifie « array » (tableau).</p><p id="r-208954" data-claire-element-id="208954">Nous verrons dans le prochain chapitre que <em>les images sont en réalité des tableaux</em>. Vous pouvez donc, lorsque vous lirez la documentation d'OpenCV, vous dire que chaque fois qu'une fonction prend un <code data-claire-semantic="c">CvArr*</code> en argument, vous pouvez lui passer un <code data-claire-semantic="c">IplImage*</code>.</p><div id="r-208956" data-claire-element-id="208956" data-claire-semantic="question"><p id="r-208955" data-claire-element-id="208955">Et c'est quoi, ces paramètres optionnels ?</p></div><p id="r-208957" data-claire-element-id="208957">En réalité, il s'agit de paramètres que l'on utilise pour choisir, par exemple, la qualité de l'image pour du JPEG, ou la force de compression pour du PNG, soit des paramètres qui, dans le cadre de ce cours, ne nous intéressent absolument pas ! En ce qui nous concerne, on se contentera de laisser cet argument à <code data-claire-semantic="c">NULL</code> pour utiliser les paramètres par défaut qui sont largement suffisants.</p><p id="r-208958" data-claire-element-id="208958"></p><div id="r-208960" data-claire-element-id="208960"><p id="r-208959" data-claire-element-id="208959"><em>Si vous êtes courageux ou bien extrêmement déterminé</em> et que la compréhension de cet argument est absolument vitale pour vous, sachez que la documentation d'OpenCV souffre d'une légère errance à ce sujet. Pour vous pointer dans la bonne direction, le comportement de cette fonction est le même que celui de la fonction <a href="http://opencv.willowgarage.com/documentation/cpp/reading_and_writing_images_and_video.html#imwrite">cv::imwrite</a> de l'API C++. Vous trouverez les bonnes constantes à passer en fouillant un petit peu dans les headers d'OpenCV (<code>opencv2/highgui/highgui_c.h</code>, aux alentours de la ligne 220). Je vous encourage donc à effectuer cette petite recherche par vous-même sur ce point de détail si le cœur vous en dit, car elle est plutôt formatrice, et que c'est à mon avis une très bonne habitude à prendre. ;)</p></div><div id="r-208962" data-claire-element-id="208962" data-claire-semantic="question"><p id="r-208961" data-claire-element-id="208961">JPEG ? PNG ? Mais… comment on détermine quel format sauvegarder ?!</p></div><p id="r-208963" data-claire-element-id="208963">Encore une preuve que la <code>highgui</code> est maligne : le format de l'image enregistrée sera déterminé <strong>par l'extension que vous lui donnerez</strong> ! Par exemple, si vous lui passez en argument la chaîne <code data-claire-semantic="c">&quot;image.bmp&quot;</code>, votre image sera automatiquement sauvegardée dans le format <em>Windows Bitmap</em>.</p><h5 id="r-exemple-d-utilisation-6" data-claire-element-id="208974">Exemple d'utilisation</h5><p id="r-208965" data-claire-element-id="208965">De manière à vous montrer comment fonctionne cette fonction d'enregistrement, voici un programme très simple, qui prend deux arguments en ligne de commande (si vous ne désirez pas utiliser votre console, vous pouvez toujours donner &quot;en dur&quot; les chemins de deux images sur votre ordinateur), et qui convertit une image d'un format vers un autre :</p><pre id="r-208966" data-claire-element-id="208966"><code data-claire-semantic="c">/**
 * Conversion d'une image d'un format vers un autre
 * par exemple: jpg -&gt; png
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;opencv/highgui.h&gt;

/**
 * Le programme prend deux arguments:
 * - l'image à convertir (SRC_IMAGE)
 * - l'image dans laquelle écrire le résultat (DST_IMAGE)
 */
int main (int argc, char* argv[])
{
  IplImage* img = NULL;
  int error = 0;

  /* Vérification des arguments */
  if (argc &lt; 3)
  {
    fprintf (stderr, &quot;usage: %s SRC_IMAGE DST_IMAGE\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }

  /* Chargement du fichier image à convertir */
  if (!(img = cvLoadImage (argv[1], CV_LOAD_IMAGE_UNCHANGED)))
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, argv[1]);
    return EXIT_FAILURE;
  }

  /* Écriture du fichier converti */
  if (!cvSaveImage (argv[2], img, NULL))
  {
    fprintf (stderr, &quot;couldn't write image file: %s\n&quot;, argv[2]); 
    error = 1;
  }
    
  /* Libération de la mémoire */
  cvReleaseImage (&amp;img);

  return (error ? EXIT_FAILURE : EXIT_SUCCESS);
}</code></pre><p id="r-208967" data-claire-element-id="208967">Essayons dans une console sous GNU/Linux :</p><pre id="r-208968" data-claire-element-id="208968"><code data-claire-semantic="console">arnaud@netbook$ ./cvtimg ~/img/vpo/lena.jpg ~/img/vpo/lena.png
arnaud@netbook$ file ~/img/vpo/lena.jpg ~/img/vpo/lena.png
/home/arnaud/img/vpo/lena.jpg: JPEG image data, JFIF standard 1.01
/home/arnaud/img/vpo/lena.png: PNG image data, 512 x 512, 8-bit/color RGB, non-interlaced</code></pre><p id="r-208969" data-claire-element-id="208969">Visiblement, selon la commande <code data-claire-semantic="console">file</code>, cela a parfaitement fonctionné, l'image a bien été convertie du format JPEG vers le format PNG.</p><div id="r-208971" data-claire-element-id="208971" data-claire-semantic="question"><p id="r-208970" data-claire-element-id="208970">Mais qui est cette &quot;Lena&quot; dont tu as la photo sur ton ordinateur ? :p</p></div><p id="r-208972" data-claire-element-id="208972">Patience, petit curieux ! Lena est une image utilisée conventionnellement pour tester les algorithmes de traitement d'image dans le milieu de la recherche. Je vous la montrerai, et vous conterai la curieuse histoire de cette Joconde de la vision par ordinateur, dans le prochain chapitre. Vous ne serez pas déçus ! ;)</p><p id="r-208973" data-claire-element-id="208973">En attendant, on reste concentrés, et on passe aux fonctions qu'il nous reste à voir, allez !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
<span class="arrow"></span>
<span class="next">Hello, world!</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
<span class="next">Une interface simple, mais pratique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Uneinterfacesimplemaispratique"></a><h2>Une interface simple, mais pratique</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
<span class="arrow"></span>
<span class="next">Charger et sauvegarder des images</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">
<span class="next">Qu&#039;est-ce qu&#039;une image ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-une-interface-simple-mais-pratique" data-claire-element-id="208998">Une interface simple, mais pratique</h4><p id="r-208976" data-claire-element-id="208976">À quoi cela servirait-il de travailler sur des images si l'on ne pouvait pas les afficher ?</p><p id="r-208977" data-claire-element-id="208977">Les quelques fonctions qui suivent permettent de créer des fenêtres dans lesquelles afficher les résultats de nos traitements. Comme vous vous en êtes rendus compte dans le programme « <em>Hello, world!</em> », celles-ci sont très simples à utiliser, et ça tombe bien, parce que c'est tout ce que l'on leur demande !</p><h5 id="r-creer-des-fenetres-et-afficher-des-images" data-claire-element-id="208990">Créer des fenêtres et afficher des images</h5><p id="r-208978" data-claire-element-id="208978">Pour créer une fenêtre, il nous suffit d'appeler la fonction suivante :</p><pre id="r-208979" data-claire-element-id="208979"><code data-claire-semantic="c">/**
 * Crée une fenêtre
 * arguments:
 * - name: titre de la fenêtre
 * - flags: paramètres optionnels
 */
int cvNamedWindow(const char* name, int flags);</code></pre><p id="r-208980" data-claire-element-id="208980">Comme nous l'avons déjà vu plus haut, les fenêtres dans OpenCV sont identifiées par leur titre. Pour ce qui est de l'argument <code data-claire-semantic="c">flags</code>, sachez que le seul qui soit supporté par l'API C est <code data-claire-semantic="c">CV_WINDOW_AUTOSIZE</code>. Celui-ci signifie que <strong>la fenêtre sera automatiquement redimensionnée pour s'adapter à la taille de l'image</strong> affichée.</p><p id="r-208981" data-claire-element-id="208981">En parlant d'afficher des images, voici la seule fonction dont nous aurons besoin pour cela :</p><pre id="r-208982" data-claire-element-id="208982"><code data-claire-semantic="c">/**
 * Affiche une image.
 * arguments:
 * - name: titre de la fenêtre dans laquelle afficher l'image
 * - image: image à afficher
 */
void cvShowImage(const char* name, const CvArr* image);</code></pre><p id="r-208983" data-claire-element-id="208983">Aucune difficulté ici. Comme pour la fonction <code data-claire-semantic="c">cvSaveImage</code>, on peut passer des pointeurs sur plusieurs types de structures différents en second argument de cette fonction, dont <code data-claire-semantic="c">IplImage</code>.</p><p id="r-208984" data-claire-element-id="208984">Voici enfin les deux dernières fonctions à connaître sur la gestion des fenêtres, à savoir celles qui permettent de les détruire :</p><pre id="r-208985" data-claire-element-id="208985"><code data-claire-semantic="c">/**
 * Détruire une fenêtre.
 * arguments:
 * - name: titre de la fenêtre à détruire
 */
void cvDestroyWindow(const char* name);

/**
 * Détruire toutes les fenêtres HighGUI affichées à l'écran.
 */
void cvDestroyAllWindows(void);</code></pre><p id="r-208986" data-claire-element-id="208986">Je pense qu'il n'y a rien à ajouter si ce n'est cette petite remarque, par soucis d'exhaustivité :</p><aside id="r-208988" data-claire-element-id="208988" data-claire-semantic="information"><p id="r-208987" data-claire-element-id="208987">Si vous compilez votre programme en C++, l'interface graphique peut être gérée par un <em>backend</em> plus moderne, combinant Qt et OpenGL.</p></aside><p id="r-208989" data-claire-element-id="208989">Bien que cela dépasse de loin le cadre de ce cours, c'est une chose qu'il est bon de savoir, car cette nouvelle interface Qt intègre quelques <em>features</em> très intéressantes (la possibilité de zoomer, etc.). En ce qui nous concerne, nous nous contenterons de l'interface de base, largement suffisante pour combler tous nos besoins. La <a href="http://opencv.willowgarage.com/documentation/c/highgui_user_interface.html">documentation d'OpenCV</a> vous en dira plus à ce sujet.</p><h5 id="r-gestion-des-evenements-clavier-et-temporisation" data-claire-element-id="208997">Gestion des évènements clavier et temporisation</h5><p id="r-208991" data-claire-element-id="208991">Voici une fonction comme je les aime : <a href="http://opencv.willowgarage.com/documentation/c/highgui_user_interface.html#cvWaitKey">cvWaitKey</a> !</p><pre id="r-208992" data-claire-element-id="208992"><code data-claire-semantic="c">/**
 * Met le programme en pause pendant un certain temps, 
 * en attendant que l'utilisateur appuie sur une touche.
 * arguments:
 * - delay: durée maximale de la pause (en millisecondes)
 * retourne: 
 * Le code (ASCII lorsqu'applicable) de la touche pressée
 * ou bien -1 si rien ne s'est passé.
 */
int cvWaitKey(int delay);</code></pre><p id="r-208993" data-claire-element-id="208993">Cette petite fonction passe-partout va nous permettre de gérer beaucoup de choses à la fois dans nos interfaces graphiques, comme nous le découvrirons au fur et à mesure de ce cours. Je tiens à vous rappeler (une seconde fois), par contre, qu'elle ne fonctionne <strong>qu'à partir du moment où une fenêtre est affichée à l'écran</strong>. ;)</p><p id="r-208994" data-claire-element-id="208994">Voilà qui conclut notre premier aperçu d'OpenCV au travers de la HighGUI.</p><p id="r-208995" data-claire-element-id="208995">Je vous fais une fleur : il n'y aura pas d'exercice ni de QCM pour ce chapitre. Le but n'est pas que vous connaissiez ces fonctions par cœur dès le départ, mais simplement de vous les <em>introduire</em>. Nous aurons suffisamment l'occasion de les utiliser dans toute la suite de ce cours pour qu'à la longue, leur utilisation devienne une seconde respiration pour vous !</p><p id="r-208996" data-claire-element-id="208996">Rendez-vous dans le prochain chapitre, dans lequel nous allons commencer à jouer avec des images. :p</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
<span class="arrow"></span>
<span class="next">Charger et sauvegarder des images</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">
<span class="next">Qu&#039;est-ce qu&#039;une image ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Qu039est-cequ039uneimage"></a><h2>Qu&#039;est-ce qu&#039;une image ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
<span class="arrow"></span>
<span class="next">Une interface simple, mais pratique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
<span class="next">Représentation formelle</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-209000" data-claire-element-id="209000">Encore une question simple en apparence, mais dont la réponse ne s'invente pas : <em>qu'est-ce qu'une image ?</em></p><p id="r-209001" data-claire-element-id="209001">Selon le contexte dans lequel on se place, cette question accepte plusieurs réponses très différentes. Dans ce chapitre nous allons y répondre à la fois du point de vue théorique et du point de vue technique. Nous apprendrons donc à représenter les images <em>en niveaux de gris</em> en mathématiques, ainsi que dans la mémoire de votre ordinateur, et nous découvrirons comment celles-ci peuvent être manipulées avec OpenCV.</p><p id="r-209002" data-claire-element-id="209002">Ah ! Et puis comme je vous l'ai promis dans le chapitre précédent, vous ferez aussi la connaissance de Lena, notre charmante nouvelle assistante et cobaye. :p</p>
</div><a name="Reprsentationformelle"></a><h2>Représentation formelle</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">
<span class="arrow"></span>
<span class="next">Qu&#039;est-ce qu&#039;une image ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
<span class="next">La structure IplImage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-representation-formelle" data-claire-element-id="209051">Représentation formelle</h4><h5 id="r-une-fonction-d-intensites-lumineuses" data-claire-element-id="209014">Une « <em>fonction d'intensités lumineuses</em> »</h5><p id="r-209003" data-claire-element-id="209003">Qu'il s'agisse de ce que capte la rétine au fond de l'œil ou le capteur photosensible d'une webcam, une <em>image</em>, ce n'est rien d'autre que <strong>la projection de rayons lumineux</strong> provenant du monde extérieur <strong>sur un plan</strong>.</p><p id="r-209004" data-claire-element-id="209004">S'il ne nous appartient pas dans ce chapitre d'étudier les notions d'optique ou de géométrie projective qui sous-tendent ce phénomène (ce qui viendra dans une partie bien plus avancée de ce cours), cette définition a quand même son importance pour comprendre la façon dont les images sont modélisées en mathématiques.</p><p id="r-209005" data-claire-element-id="209005">Dans un premier temps, nous allons faire l'hypothèse que les rayons lumineux qui viennent frapper le plan de l'image sont <em>caractérisés par leur intensité</em> uniquement. Cela signifie que sur notre plan, que l'on munit d'un repère en bons cartésiens que nous sommes, on associe à chaque paire de coordonnées (x,y) une valeur I(x,y) que l'on appellera un <strong><em>niveau de gris</em></strong> : plus le point est lumineux, plus la valeur du niveau de gris est élevée. On peut donc considérer qu'une image est une fonction définie comme ceci :</p><p id="r-209006" data-claire-element-id="209006">\begin{matrix}I\;: &amp; \mathbb{R}^2 &amp; ightarrow &amp; \mathbb{R} \\ &amp; (x,y) &amp; \mapsto &amp; I(x,y)\end{matrix}</p><p id="r-209007" data-claire-element-id="209007">Voilà qui est bien commode ! Grâce à cette définition, nous allons être en mesure de représenter les images de façon abstraite, et de formuler des traitements d'image dans le langage mathématique, soit de la façon la plus précise et la moins ambiguë qui soit.</p><p id="r-209008" data-claire-element-id="209008">Mais attendez un peu…</p><p id="r-209009" data-claire-element-id="209009">À moins que nous ne vivions vous et moi dans un monde parfaitement mathématique, cette définition, aussi précise et rigoureuse soit-elle, reste quand même très limitée. Pouvez-vous deviner pourquoi ?</p><div id="r-209011" data-claire-element-id="209011" data-claire-semantic="question"><p id="r-209010" data-claire-element-id="209010">Euuh, je sais pas si c'est ça, mais j'ai quand même une question… <br/> Je veux bien croire qu'une image c'est juste une fonction, mais dans ce cas, <strong>c'est quoi la formule de la photo de tata Simone à Noël dernier ?</strong> :euh:</p></div><p id="r-209012" data-claire-element-id="209012">Bingo !<br/> Aussi simple la définition mathématique d'une image soit-elle, <strong>nous sommes absolument incapables d'obtenir les « formules » des images du monde réel</strong>. En fait, d'un point de vue mathématique, lorsque nous observons une image, ce que nous voyons est en quelque sorte la courbe (ou plutôt, ici, la « <em>surface</em> ») d'une fonction, c'est-à-dire les valeurs qu'elle prend selon x et y.</p><p id="r-209013" data-claire-element-id="209013">Cela signifie que pour étudier les images du monde réel, nous allons devoir observer non pas des fonctions en tant que telles, mais le résultat, ou plutôt, pour utiliser le terme mathématique exact, les <em>images</em> de ces fonctions…</p><h5 id="r-une-matrice-de-pixels" data-claire-element-id="209050">Une « <em>matrice de pixels</em> »</h5><p id="r-209015" data-claire-element-id="209015">Même si nous ne pouvons pas trouver de belle formule pour chaque photo du monde réel, et que nous devons nous contenter d'observer des intensités lumineuses sur un plan, n'abandonnons pas les mathématiques trop tôt pour autant, mais profitons-en pour faire quelques ajustements de façon à faire tenir des images dans la mémoire de nos ordinateurs.</p><p id="r-209016" data-claire-element-id="209016">Tout d'abord, <strong>débarrassons-nous de l'infiniment petit</strong> !</p><p id="r-209017" data-claire-element-id="209017">En effet, il n'est ni utile, ni réalisable d'observer la totalité d'une surface dans le plan \mathbb{R}^2 pour avoir une image. Intuitivement, cela voudrait dire que nous pourrions connaître l'intensité lumineuse au point (3,5) aussi bien que celle au point (3.0029, 4.9987), et même que nous pourrions encore capter <em>l'infinité</em> des intensités lumineuses sur le segment reliant ces deux points, ce qui n'est pas possible même dans le monde réel, vu que les capteurs des caméras, tout comme nos rétines, sont composés d'un nombre <em>fini</em> de cellules…</p><p id="r-209018" data-claire-element-id="209018">Ainsi, nos observations sur le plan de l'image se feront sur des points de coordonnées entières, ce qui veut dire que l'on peut ranger tous les niveaux de gris que l'on capte dans un joli tableau comme le suivant :</p><p id="r-209019" data-claire-element-id="209019">\begin{pmatrix}I(0,0) &amp; I(1,0) &amp; I(2,0) &amp; \dots &amp; I(w-1,0) \\I(0,1) &amp; I(1,1) &amp; I(2,1) &amp; \dots &amp; I(w-1,1) \\I(0,2) &amp; I(1,2) &amp; I(2,2) &amp; \dots &amp; I(w-1,2) \\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\I(0,h-1) &amp; I(1,h-1) &amp; I(2,h-1) &amp; \dots &amp; I(w-1,h-1)\end{pmatrix},</p><p id="r-209020" data-claire-element-id="209020">où w est la largeur (<em>width</em>) de l'image et h sa hauteur (<em>height</em>). En mathématiques, de tels tableaux à deux dimensions s'appellent des <strong>matrices</strong>. Nous pouvons donc formuler notre nouvelle définition, celle que nous garderons tout au long de ce cours : <strong>une image numérique est une matrice de pixels</strong>.</p><div id="r-209022" data-claire-element-id="209022" data-claire-semantic="question"><p id="r-209021" data-claire-element-id="209021">Hum, OK, mais c'est quoi un pixel ?</p></div><p id="r-209023" data-claire-element-id="209023">Un pixel, c'est littéralement « un élément d'une image » : le mot pixel vient de l'anglais &quot;<em>picture element</em>&quot;. Dans un premier temps, nous allons simplement considérer qu'un pixel est <em>un niveau de gris</em>, mais vous verrez dans le prochain chapitre que ce n'est pas toujours le cas.</p><h6 id="r-quelques-considerations-sur-les-matrices" data-claire-element-id="209035">Quelques considérations sur les matrices</h6><p id="r-209024" data-claire-element-id="209024">Étant donné que vous n'êtes pas supposés avoir déjà manipulé des matrices en maths, voici quelques considérations d'ordre général sur les matrices.</p><p id="r-209025" data-claire-element-id="209025">Si M est une matrice à n lignes et p colonnes :</p><ul id="r-209034" data-claire-element-id="209034"><li id="r-209027" data-claire-element-id="209027"><p id="r-209026" data-claire-element-id="209026">On dit que M est une matrice n imes p et on peut la noter M_{n imes p}.</p></li><li id="r-209029" data-claire-element-id="209029"><p id="r-209028" data-claire-element-id="209028">Ses éléments, notés m_{i,j} pour 0 \leq i &lt; n et 0 \leq j &lt; p sont appelés des <strong>scalaires</strong>.</p></li><li id="r-209031" data-claire-element-id="209031"><p id="r-209030" data-claire-element-id="209030"><strong>Attention à l'indexation</strong>. Dans la notation m_{i,j}, on donne <em>d'abord</em> le numéro de ligne i<em>puis</em> le numéro de colonne j. Cela veut dire que dans l'image que nous avons au-dessus, <strong>le niveau de gris I(x,y) est porté par le pixel m_{y,x}</strong>.</p></li><li id="r-209033" data-claire-element-id="209033"><p id="r-209032" data-claire-element-id="209032">Son « <em>origine</em> », le scalaire m_{0,0}, se trouve conventionnellement <strong>en haut à gauche</strong>.</p></li></ul><h6 id="r-exemple-64" data-claire-element-id="209049">Exemple</h6><p id="r-209036" data-claire-element-id="209036">Afin de bien vous montrer le lien entre une image et une matrice, prenons le tout petit bout d'image suivant :</p><figure id="r-209038" data-claire-element-id="209039"><img id="r-209037" data-claire-element-id="209037" src="medias/uploads.siteduzero.com_files_345001_346000_345394.png" alt="sample_mini"/></figure><p id="r-209040" data-claire-element-id="209040">Le voici agrandi 20 fois :</p><figure id="r-209042" data-claire-element-id="209043"><img id="r-209041" data-claire-element-id="209041" src="medias/uploads.siteduzero.com_files_345001_346000_345395.png" alt="Image utilisateur"/></figure><p id="r-209044" data-claire-element-id="209044">Et voici maintenant la matrice correspondante :</p><p id="r-209045" data-claire-element-id="209045">\begin{pmatrix}94 &amp; 211 &amp; 0 &amp; 0 &amp; 50 &amp; 205 &amp; 0 &amp; 125 \\211 &amp; 206 &amp; 94 &amp; 211 &amp; 70 &amp; 191 &amp; 15 &amp; 106 \\255 &amp; 206 &amp; 206 &amp; 0 &amp; 158 &amp; 191 &amp; 50 &amp; 0 \\205 &amp; 94 &amp; 211 &amp; 0 &amp; 37 &amp; 154 &amp; 0 &amp; 255 \\8 &amp; 36 &amp; 230 &amp; 255 &amp; 191 &amp; 191 &amp; 205 &amp; 50 \\0 &amp; 152 &amp; 148 &amp; 211 &amp; 205 &amp; 25 &amp; 128 &amp; 205 \\0 &amp; 31 &amp; 53 &amp; 94 &amp; 211 &amp; 49 &amp; 205 &amp; 50 \\0 &amp; 39 &amp; 64 &amp; 50 &amp; 76 &amp; 211 &amp; 128 &amp; 128 \\\end{pmatrix}</p><p id="r-209046" data-claire-element-id="209046">Comme vous le constatez, les pixels blancs correspondent au niveau de gris 255 alors que les pixels noirs correspondent au niveau 0. On dit que l'intensité lumineuse est <em>échantillonnée</em> sur 256 valeurs. Nous reviendrons sur cette notion plus loin.</p><p id="r-209047" data-claire-element-id="209047">Je pense que cela doit faire assez de mathématiques pour le moment. Que diriez-vous de passer à la pratique et de voir comment cela se passe dans la mémoire de votre ordinateur ?</p><p id="r-209048" data-claire-element-id="209048">Oui bon, en fait, je ne vous laisse pas le choix. :p <br/> Allez, la suite !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">
<span class="arrow"></span>
<span class="next">Qu&#039;est-ce qu&#039;une image ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
<span class="next">La structure IplImage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LastructureIplImage"></a><h2>La structure IplImage</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
<span class="arrow"></span>
<span class="next">Représentation formelle</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
<span class="next">Parcourir une image</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-la-structure-iplimage" data-claire-element-id="209172">La structure IplImage</h4><p id="r-209052" data-claire-element-id="209052">Maintenant que nous avons établi que les images numériques sont des matrices de pixels, penchons-nous quelques instants sur la structure <code data-claire-semantic="c">IplImage</code> dans OpenCV.</p><h5 id="r-representation-des-donnees" data-claire-element-id="209083">Représentation des données</h5><p id="r-209053" data-claire-element-id="209053">De quel type sont les données de l'image à l'intérieur d'une <code data-claire-semantic="c">IplImage</code> ? <br/> Réflexe : un petit coup d'oeil sur <a href="http://opencv.willowgarage.com/documentation/c/core_basic_structures.html#iplimage">la documentation</a> vous donnera la réponse. Voici ce que vous devriez trouver :</p><pre id="r-209054" data-claire-element-id="209054"><code data-claire-semantic="c">typedef struct _IplImage
{
  // ...
  char *imageData;
  // ...
} 
IplImage;</code></pre><div id="r-209056" data-claire-element-id="209056" data-claire-semantic="question"><p id="r-209055" data-claire-element-id="209055">Quoi ?! Une chaîne de caractères ? o_O</p></div><p id="r-209057" data-claire-element-id="209057">Ben oui ! <code data-claire-semantic="c">&quot;dessine-moi un mouton&quot;</code>… Hum, non ! &gt;_<br/> Le type <code data-claire-semantic="c">char</code> est utilisé ici parce qu'il représente exactement un octet en mémoire. Il faut donc lire que les données de l'image sont contenues de la façon la plus naturelle du monde dans un tableau d'octets, <em>même si les pixels ne tiennent pas forcément sur un octet</em> (nous reviendrons sur ce point dans quelques instants).</p><p id="r-209058" data-claire-element-id="209058">Ainsi, que ce soit en mathématiques ou dans la RAM de votre machine, je vous le répète encore une fois : <strong>une image n'est ni plus ni moins qu'un tableau</strong>.</p><p id="r-209059" data-claire-element-id="209059">Bien ! Mais cela ne nous dit pas encore dans quel ordre est stocké ce tableau en mémoire. Pour cela, nous allons devoir observer un peu plus en détail la structure <code data-claire-semantic="c">IplImage</code> :</p><pre id="r-209060" data-claire-element-id="209060"><code data-claire-semantic="c">typedef struct _IplImage
{
  // ...
  int  width;      // nb de colonnes de la matrice
  int  height;     // nb de lignes de la matrice
  // ... 
  int  imageSize;  // taille totale des données en octets 
  char *imageData; // pointeur sur les données
  int  widthStep;  // largeur d'une ligne en octets
  // ...
}
IplImage;</code></pre><p id="r-209061" data-claire-element-id="209061">Bien que cela ne soit pas forcément évident au premier abord (mais je vous invite à y réfléchir à titre d'exercice), on peut déduire de ce morceau de déclaration que les images, dans OpenCV, sont stockées en mémoire <strong>ligne par ligne</strong>. En anglais, on parle de <em><a href="http://en.wikipedia.org/wiki/Row-major_order">row-major order</a></em>.</p><p id="r-209062" data-claire-element-id="209062">Le schéma suivant vous montre mes piètres talents de dessinateur une image en niveau de gris avec quelques pixels remarquables, ainsi que la façon dont elle sera stockée en mémoire par OpenCV :</p><figure id="r-209064" data-claire-element-id="209065"><img id="r-209063" data-claire-element-id="209063" src="medias/uploads.siteduzero.com_files_345001_346000_345093.png" alt="Image utilisateur"/></figure><p id="r-209066" data-claire-element-id="209066">De manière à bien comprendre ce schéma, voici quelques exemples qui vous rappelleront votre amour profond pour l'arithmétique des pointeurs. Si <code data-claire-semantic="c">img</code> est un <code data-claire-semantic="c">IplImage*</code> contenant une image en niveaux de gris dont les pixels sont des <code data-claire-semantic="c">char</code>, alors :</p><ul id="r-209077" data-claire-element-id="209077"><li id="r-209068" data-claire-element-id="209068"><p id="r-209067" data-claire-element-id="209067"><code data-claire-semantic="c">img-&gt;imageData</code> est l'adresse du pixel de coordonnées (0,0), le premier pixel de l'image ;</p></li><li id="r-209070" data-claire-element-id="209070"><p id="r-209069" data-claire-element-id="209069"><code data-claire-semantic="c">(img-&gt;imageData + 7)</code> est l'adresse du pixel de coordonnées (7,0), le huitième pixel de la première ligne ;</p></li><li id="r-209072" data-claire-element-id="209072"><p id="r-209071" data-claire-element-id="209071"><code data-claire-semantic="c">(img-&gt;imageData + img-&gt;widthStep)</code> est l'adresse du pixel de coordonnées (0,1), le premier pixel de la seconde ligne ;</p></li><li id="r-209074" data-claire-element-id="209074"><p id="r-209073" data-claire-element-id="209073"><code data-claire-semantic="c">(img-&gt;imageData + (3 * img-&gt;widthStep) + 12)</code> est l'adresse du pixel de coordonnées (12,3), le treizième pixel de la quatrième ligne ;</p></li><li id="r-209076" data-claire-element-id="209076"><p id="r-209075" data-claire-element-id="209075"><code data-claire-semantic="c">(img-&gt;imageData + img-&gt;imageSize)</code> est l'adresse de l'octet se situant <strong>juste après</strong> le dernier pixel de l'image.</p></li></ul><div id="r-209079" data-claire-element-id="209079" data-claire-semantic="question"><p id="r-209078" data-claire-element-id="209078">Heu, y'a un truc que je comprends pas, pourquoi est-ce que la structure a un champ <code>width</code> et un champ <code>widthStep</code> ? C'est pas la même chose ?</p></div><p id="r-209080" data-claire-element-id="209080">Bien vu ! Dans le cas des images en niveaux de gris dont les pixels sont des <code data-claire-semantic="c">char</code>, il est <em>très probable</em> en effet que les champs <code data-claire-semantic="c">width</code> et <code>widthStep</code> soient égaux. Cela dit, il y a deux raisons majeures pour lesquelles on ne peut pas supposer que ce soit le cas.</p><p id="r-209081" data-claire-element-id="209081">La première raison, c'est qu'OpenCV, en interne, peut décider que <em>les lignes de l'image ne seront pas forcément contiguës en mémoire</em>, mais qu'elles seront alignées sur un nombre d'octets précis, de façon à améliorer les performances. Quand c'est le cas, cet alignement de quelques octets est ajouté au champ <code>widthStep</code> alors que <code>width</code> sera toujours exactement le nombre de colonnes de l'image.</p><p id="r-209082" data-claire-element-id="209082">La seconde raison, plus simple, est que <em>les niveaux de gris ne sont pas toujours des</em><code data-claire-semantic="c">char</code>, et c'est ce que nous allons voir juste maintenant.</p><h5 id="r-la-profondeur-des-images" data-claire-element-id="209160">La « <em>profondeur</em> » des images</h5><p id="r-209084" data-claire-element-id="209084">Il est possible que vous ayez déjà entendu parler d'« images 8, 16 ou 32 bits ». Dans cette expression, le nombre de bits désigne la taille d'un pixel en mémoire. On appelle cela <strong>la profondeur (<em>depth</em>) de l'image</strong>.</p><p id="r-209085" data-claire-element-id="209085">Si vous regardez à nouveau la définition mathématique que nous avons formulée au début de ce chapitre, vous vous apercevrez que rien, dans ce que nous avons dit, ne nous donne <em>le type des niveaux de gris</em>, ni même les valeurs que peuvent prendre ces intensités lumineuses. C'est tout simplement parce que l'on peut utiliser plusieurs types différents pour décrire un niveau de gris, et c'est la profondeur de l'image qui détermine le type utilisé.</p><p id="r-209086" data-claire-element-id="209086">En toute rigueur, la profondeur d'une image décrit <em>le nombre de valeurs sur lequel l'intensité lumineuse est échantillonnée</em>. Par exemple, sur une image en niveaux de gris 8 bits (non signés), l'intensité lumineuse sera échantillonnée sur 256 valeurs, avec 0 pour le noir et 255 pour le blanc, alors que sur une image 16 bits, l'intensité lumineuse pourra prendre 65536 valeurs différentes (0 pour le noir et 65535 pour le blanc), ce qui permet d'être 256 fois plus précis qu'en 8 bits, mais prend deux fois plus de place en mémoire…</p><p id="r-209087" data-claire-element-id="209087">Cette profondeur, dans OpenCV, est décrite par le champ <code>depth</code> de la structure <code data-claire-semantic="c">IplImage</code>. Ce champ contient une constante définie par OpenCV sous la forme suivante :</p><p id="r-209088" data-claire-element-id="209088"><code>IPL_DEPTH_[Nombre de bits][Type]</code>.</p><p id="r-209089" data-claire-element-id="209089">Le tableau suivant décrit les correspondances entre les types des pixels, leurs tailles, les ensembles de valeurs possibles et les constantes de profondeur dans OpenCV :</p><table id="r-209155" data-claire-element-id="209155"><thead id="r-209099" data-claire-element-id="209099"><tr id="r-209098" data-claire-element-id="209098"><th id="r-209091" data-claire-element-id="209091"><p id="r-209090" data-claire-element-id="209090">Type des pixels</p></th><th id="r-209093" data-claire-element-id="209093"><p id="r-209092" data-claire-element-id="209092">Taille</p></th><th id="r-209095" data-claire-element-id="209095"><p id="r-209094" data-claire-element-id="209094">Valeurs</p></th><th id="r-209097" data-claire-element-id="209097"><p id="r-209096" data-claire-element-id="209096">Constante OpenCV</p></th></tr></thead><tbody id="r-209154" data-claire-element-id="209154"><tr id="r-209108" data-claire-element-id="209108"><td id="r-209101" data-claire-element-id="209101"><p id="r-209100" data-claire-element-id="209100"><code data-claire-semantic="c">unsigned char</code> (ou <code data-claire-semantic="c">uchar</code>)</p></td><td id="r-209103" data-claire-element-id="209103"><p id="r-209102" data-claire-element-id="209102">8 bits</p></td><td id="r-209105" data-claire-element-id="209105"><p id="r-209104" data-claire-element-id="209104">0, 1, ..., 255</p></td><td id="r-209107" data-claire-element-id="209107"><p id="r-209106" data-claire-element-id="209106"><code data-claire-semantic="c">IPL_DEPTH_8U</code></p></td></tr><tr id="r-209117" data-claire-element-id="209117"><td id="r-209110" data-claire-element-id="209110"><p id="r-209109" data-claire-element-id="209109"><code data-claire-semantic="c">signed char</code> (ou <code data-claire-semantic="c">schar</code>)</p></td><td id="r-209112" data-claire-element-id="209112"><p id="r-209111" data-claire-element-id="209111">8 bits</p></td><td id="r-209114" data-claire-element-id="209114"><p id="r-209113" data-claire-element-id="209113">-127, -126, ..., 128</p></td><td id="r-209116" data-claire-element-id="209116"><p id="r-209115" data-claire-element-id="209115"><code data-claire-semantic="c">IPL_DEPTH_8S</code></p></td></tr><tr id="r-209126" data-claire-element-id="209126"><td id="r-209119" data-claire-element-id="209119"><p id="r-209118" data-claire-element-id="209118"><code data-claire-semantic="c">unsigned short</code> (ou <code data-claire-semantic="c">ushort</code>)</p></td><td id="r-209121" data-claire-element-id="209121"><p id="r-209120" data-claire-element-id="209120">16 bits</p></td><td id="r-209123" data-claire-element-id="209123"><p id="r-209122" data-claire-element-id="209122">0, 1, ..., 65535</p></td><td id="r-209125" data-claire-element-id="209125"><p id="r-209124" data-claire-element-id="209124"><code data-claire-semantic="c">IPL_DEPTH_16U</code></p></td></tr><tr id="r-209135" data-claire-element-id="209135"><td id="r-209128" data-claire-element-id="209128"><p id="r-209127" data-claire-element-id="209127"><code data-claire-semantic="c">signed short</code> (ou <code data-claire-semantic="c">short</code>)</p></td><td id="r-209130" data-claire-element-id="209130"><p id="r-209129" data-claire-element-id="209129">16 bits</p></td><td id="r-209132" data-claire-element-id="209132"><p id="r-209131" data-claire-element-id="209131">-32767, ..., 32768</p></td><td id="r-209134" data-claire-element-id="209134"><p id="r-209133" data-claire-element-id="209133"><code data-claire-semantic="c">IPL_DEPTH_16S</code></p></td></tr><tr id="r-209144" data-claire-element-id="209144"><td id="r-209137" data-claire-element-id="209137"><p id="r-209136" data-claire-element-id="209136"><code data-claire-semantic="c">float</code></p></td><td id="r-209139" data-claire-element-id="209139"><p id="r-209138" data-claire-element-id="209138">32 bits</p></td><td id="r-209141" data-claire-element-id="209141"><p id="r-209140" data-claire-element-id="209140">[0,1]</p></td><td id="r-209143" data-claire-element-id="209143"><p id="r-209142" data-claire-element-id="209142"><code data-claire-semantic="c">IPL_DEPTH_32F</code></p></td></tr><tr id="r-209153" data-claire-element-id="209153"><td id="r-209146" data-claire-element-id="209146"><p id="r-209145" data-claire-element-id="209145"><code data-claire-semantic="c">double</code></p></td><td id="r-209148" data-claire-element-id="209148"><p id="r-209147" data-claire-element-id="209147">64 bits</p></td><td id="r-209150" data-claire-element-id="209150"><p id="r-209149" data-claire-element-id="209149">[0,1]</p></td><td id="r-209152" data-claire-element-id="209152"><p id="r-209151" data-claire-element-id="209151"><code data-claire-semantic="c">IPL_DEPTH_64F</code></p></td></tr></tbody></table><div id="r-209157" data-claire-element-id="209157" data-claire-semantic="question"><p id="r-209156" data-claire-element-id="209156">Ouh là làààà ! Mais ça fait beaucoup de trucs à retenir, tout ça ! Tu nous prends pour des machines ?!</p></div><p id="r-209158" data-claire-element-id="209158">« PAS DE PANIQUE ! » nous dit le Guide.<br/> En réalité, nous allons travailler quasi-exclusivement avec des images de profondeur <code>8U</code>, c'est-à-dire avec des intensités comprises entre 0 et 255. Vous n'êtes donc absolument pas obligés d'apprendre ce tableau par cœur : maintenant que vous l'avez vu, vous savez qu'il est ici, et vous pourrez vous y référer le jour où vous en aurez besoin ! ;)</p><p id="r-209159" data-claire-element-id="209159">Ceci dit, j'ai le plaisir de vous annoncer que nous en avons quasiment terminé avec la dissection de la structure <code data-claire-semantic="c">IplImage</code>. Il ne nous reste plus que quelques fonctions utilitaires à découvrir avant de faire une petite pause.</p><h5 id="r-quelques-fonctions-utilitaires-avant-la-pause" data-claire-element-id="209171">Quelques fonctions utilitaires avant la pause</h5><p id="r-209161" data-claire-element-id="209161">Comme vous l'avez probablement remarqué en lisant la documentation, la structure <code data-claire-semantic="c">IplImage</code> est bien plus grosse que ce que nous en avons vu pour le moment. En réalité, beaucoup de ses champs ne nous seront pas utiles avant un bon moment, et ceux que nous avons vus sont pratiquement les seuls que vous avez besoin de connaître pour suivre ce cours.</p><p id="r-209162" data-claire-element-id="209162">Maintenant que l'heure de jouer avec des images se rapproche à grands pas, regardons ensemble comment on crée une de ces structures. Encore une fois (oui, je sais, je radote), la <a href="http://opencv.willowgarage.com/documentation/c/core_operations_on_arrays.html#createimage">documentation</a> est notre meilleure amie, et nous fournit la fonction suivante :</p><pre id="r-209163" data-claire-element-id="209163"><code data-claire-semantic="c">/**
 * Alloue une structure IplImage
 * arguments:
 * - size: la taille de l'image à allouer 
 * - depth: profondeur de l'image
 * - channels: nombre de canaux de l'image
 * retourne:
 * un pointeur sur l'IplImage allouée
 */
IplImage* cvCreateImage(CvSize size, int depth, int channels);</code></pre><p id="r-209164" data-claire-element-id="209164">La structure <code data-claire-semantic="c">CvSize</code> n'est autre que l'association de deux entiers décrivant la largeur et la hauteur de l'image. Quant au nombre de canaux, nous n'en utiliserons qu'un seul pour le moment, mais verrons la signification de ce champ dans le prochain chapitre.</p><p id="r-209165" data-claire-element-id="209165">Voici un exemple dans lequel je crée une image de largeur 640 et de hauteur 480, et dont les pixels seront des <code data-claire-semantic="c">unsigned char</code> :</p><pre id="r-209166" data-claire-element-id="209166"><code data-claire-semantic="c">IplImage* img;
img = cvCreateImage (cvSize (640, 480), IPL_DEPTH_8U, 1);</code></pre><p id="r-209167" data-claire-element-id="209167">Simple, non ?<br/> Avant de passer à la suite, je vous rappelle juste la signature de la fonction permettant de désallouer une structure <code data-claire-semantic="c">IplImage</code> ainsi que ses données.</p><pre id="r-209168" data-claire-element-id="209168"><code data-claire-semantic="c">/**
 * Désalloue la mémoire occupée par une IplImage
 */
void cvReleaseImage(IplImage** image);</code></pre><p id="r-209169" data-claire-element-id="209169">Aucune difficulté ici, si ce n'est, je vous le rappelle, qu'il faut bien penser à passer <em>un pointeur sur pointeur sur </em><code data-claire-semantic="c">IplImage</code> à cette fonction.</p><p id="r-209170" data-claire-element-id="209170">Sur ces bonnes paroles, l'heure est venue pour nous de souffler un peu !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
<span class="arrow"></span>
<span class="next">Représentation formelle</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
<span class="next">Parcourir une image</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Parcouriruneimage"></a><h2>Parcourir une image</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
<span class="arrow"></span>
<span class="next">La structure IplImage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-parcourir-une-image" data-claire-element-id="209220">Parcourir une image</h4><h5 id="r-notre-image-de-test" data-claire-element-id="209184">Notre image de test</h5><p id="r-209173" data-claire-element-id="209173">Avant de commencer à jouer avec des images, laissez-moi, en guise de pause étant donné que le début de ce chapitre était plutôt dense, vous présenter l'image que nous allons utiliser pour la plupart de nos tests, <strong>Lena</strong>.</p><figure id="r-209175" data-claire-element-id="209176"><img id="r-209174" data-claire-element-id="209174" src="medias/uploads.siteduzero.com_files_345001_346000_345136.jpg" alt="Image utilisateur"/></figure><p id="r-209177" data-claire-element-id="209177">Cette image, comme je vous l'ai déjà dit dans le précédent chapitre, est le petit carré de 512×512 pixels le plus célèbre du monde de la recherche et de l'ingénierie en imagerie, ce qui lui vaut certainement le titre de « Joconde de la vision par ordinateur ». Voici son histoire.</p><p id="r-209178" data-claire-element-id="209178">Tout commença dans le laboratoire SIPI de la prestigieuse <em>University of Southern California</em>, au sein duquel étaient alors menés les travaux de recherche qui finiraient par aboutir aux standards de compression JPEG et MPEG que nous connaissons tous aujourd'hui.</p><p id="r-209179" data-claire-element-id="209179">Par un beau jour de l'été 1973, trois chercheurs de ce laboratoire étaient affairés, dans l'urgence, à la recherche d'une image d'exemple qui soit nouvelle et suffisamment sympathique pour être publiée dans l'article de conférence de l'un de leur collègues, concernant les derniers résultats de ses recherches dans le domaine de la compression d'images. C'est alors qu'une personne entra dans leur bureau un magazine entre les mains, magazine en page centrale duquel se trouvait la photo d'une femme, nommée Lena. La décision ne fut pas longue à prendre : nos chercheurs arrachèrent la photographie dudit magazine, la numérisèrent avec les moyens de l'époque, et retaillèrent le résultat pour obtenir l'image carrée de 512×512 pixels que vous avez sous les yeux.</p><p id="r-209180" data-claire-element-id="209180">L'histoire aurait pu s'arrêter ici, si ce n'était qu'une vingtaine d'années plus tard, alors que cette image était devenue un standard grâce auquel les chercheurs pouvaient comparer leurs algorithmes de compression, et distribuée de façon payante par le SIPI, le magazine d'origine de la photo se manifesta, relativement fâché de voir sa propriété réutilisée sans lui verser ses droits, ce qui marqua aussi, par ailleurs, le début d'une bruyante polémique au sein de la communauté scientifique. En effet, Lena Sjööblom n'est autre que la <em>miss Playboy</em> du mois de novembre 1972 ! :)</p><p id="r-209181" data-claire-element-id="209181">Aujourd'hui, cette photo est accessible librement et gratuitement, et continue d'être la plus utilisée pour tester des algorithmes de traitement d'image, non pas à cause du regard énigmatique de la demoiselle, mais plutôt en raison du panel complet de textures fines, de surfaces relativement uniformes, de contours et de détails qui font sa richesse (… Bon, probablement aussi parce qu'elle est jolie, quand même).</p><p id="r-209182" data-claire-element-id="209182">Vous pourrez trouver l'image originale au format TIFF (donc non compressé) <a href="http://www.cs.cmu.edu/~chuck/lennapg/lena_std.tif">ici</a>. C'est celle que je vous recommande d'utiliser pour tester vos algos en tous genres, plutôt que le JPEG, étant donné que dans certains cas, la compression JPEG fera apparaître des artéfacts indésirables dans vos résultats.</p><p id="r-209183" data-claire-element-id="209183">Sur ce, la pause est terminée.</p><h5 id="r-plusieurs-methodes-differentes" data-claire-element-id="209219">Plusieurs méthodes différentes</h5><p id="r-209185" data-claire-element-id="209185">Dans le reste de cette sous-partie, nous allons coder, de plusieurs façons possibles, un petit programme qui ouvre une image en niveaux de gris 8 bits, et qui en <em>inverse</em> les pixels.</p><p id="r-209186" data-claire-element-id="209186">Cela signifie que la transformation que nous allons réaliser sera la fonction suivante, où \mathrm{dst} est l'image de résultat et \mathrm{src} l'image d'origine :</p><p id="r-209187" data-claire-element-id="209187">\mathrm{dst}(x,y) = 255 - \mathrm{src} (x,y)</p><p id="r-209188" data-claire-element-id="209188">Voici le résultat attendu, dans tous les cas, sur la photo de Lena :</p><figure id="r-209190" data-claire-element-id="209191"><img id="r-209189" data-claire-element-id="209189" src="medias/uploads.siteduzero.com_files_345001_346000_345216.jpg" alt="Image utilisateur"/></figure><p id="r-209192" data-claire-element-id="209192">Pour nous simplifier la vie, nous allons simplement écrire une fonction <code data-claire-semantic="c">inverse</code> qui prend en argument une <code data-claire-semantic="c">IplImage*</code> et inverse l'image contenue <em>en place</em>.</p><p id="r-209193" data-claire-element-id="209193">Voici le corps du programme sur lequel nous allons travailler.</p><pre id="r-209194" data-claire-element-id="209194"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;assert.h&gt;
#include &lt;opencv/cv.h&gt;
#include &lt;opencv/highgui.h&gt;

/**
 * Inverse une image &quot;en place&quot;
 */
void invert (IplImage* img)
{
  assert (img-&gt;depth == IPL_DEPTH_8U &amp;&amp; img-&gt;nChannels == 1);
  // TODO 
}

/**
 * Ce programme prend deux arguments dont un optionnel:
 * IMAGE:     l'image à inverser
 * SAVE_PATH: (optionnel) l'image dans laquelle sauvegarder le résultat
 */
int main (int argc, char* argv[])
{
  IplImage* img = NULL; 
  const char* src_path = NULL;
  const char* dst_path = NULL;
  const char* window_title = &quot;Inverse&quot;;

  if (argc &lt; 2)
  {
    fprintf (stderr, &quot;usage: %s IMAGE [SAVE_PATH]\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }

  src_path = argv[1];

   // optionnel: sauvegarde du résultat 
   // si un second chemin est passé au programme
  if (argc &gt; 2) 
    dst_path = argv[2];

  if (!(img = cvLoadImage (src_path, CV_LOAD_IMAGE_GRAYSCALE)))
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, argv[1]);
    return EXIT_FAILURE;
  }

  invert (img);

  cvNamedWindow (window_title, CV_WINDOW_AUTOSIZE);
  cvShowImage   (window_title, img);
  cvWaitKey (0);
  cvDestroyAllWindows ();
  
  if (dst_path &amp;&amp; !cvSaveImage (dst_path, img, NULL))
  {
    fprintf (stderr, &quot;couldn't write image to file: %s\n&quot;, dst_path);
  }
  
  cvReleaseImage(&amp;img);
  return EXIT_SUCCESS;
}</code></pre><p id="r-209195" data-claire-element-id="209195">Comme vous le voyez, j'ai pris soin de m'occuper de tout l'aspect cosmétique à votre place (chargement de l'image et conversion en niveaux de gris, enregistrement optionnel, affichage du résultat…), de façon que nous n'ayons besoin de nous occuper ensemble que de la fonction <code data-claire-semantic="c">invert</code>.</p><p id="r-209196" data-claire-element-id="209196">Vous remarquerez que j'ai surligné la ligne 12, car j'y utilise la fonction assert que vous n'avez peut-être pas encore croisée. Cette fonction toute simple prend <em>une condition</em> en argument et plante le programme si celle-ci n'est pas remplie. C'est une sécurité qui permet de détecter tout de suite si quelque chose ne fonctionne pas normalement dans votre code. Son autre intérêt, c'est qu'une fois que vous avez terminé de tester votre programme dans tous les sens, vous pouvez gagner un peu en performances en désactivant cette fonction (qui deviendra &quot;invisible&quot; pour le compilateur), simplement en utilisant la constante <code>NDEBUG</code> à la compilation. Vous trouverez plus d'informations à ce sujet <a href="http://en.wikipedia.org/wiki/Assert.h">ici</a>.</p><p id="r-209197" data-claire-element-id="209197">Dans notre code, cette ligne permet de s'assurer que l'image passée en argument à la fonction <code>invert</code> est bel et bien une image en niveaux de gris 8 bits.</p><h6 id="r-la-methode-simple-les-fonctions-cvptr-d" data-claire-element-id="209209">La méthode simple : les fonctions cvPtr*D</h6><p id="r-209198" data-claire-element-id="209198">Pour inverser notre image, il n'y a pas 36 façons possibles : il nous suffit, pour chaque paire de coordonnées (x,y), de récupérer un pointeur sur le pixel correspondant, et d'opérer la modification dessus. Ce que nous allons voir jusqu'à la fin de cette sous-partie, ce sont trois méthodes de plus en plus bas niveau pour cela.</p><p id="r-209199" data-claire-element-id="209199">Pour récupérer un pointeur sur un pixel donné d'une image en niveaux de gris, nous pouvons utiliser la fonction <a href="http://opencv.willowgarage.com/documentation/c/core_operations_on_arrays.html#cvPtr2D">cvPtr2D</a> dont voici la signature :</p><pre id="r-209200" data-claire-element-id="209200"><code data-claire-semantic="c">/**
 * Récupérer un pointeur sur un élément donné d'un tableau.
 * arguments:
 * - arr: image (ou matrice) à parcourir
 * - idx0: numéro de ligne du pixel
 * - idx1: numéro de colonne du pixel
 * - type: paramètre optionnel de sortie, décrivant la profondeur
 *         du tableau
 * retourne:
 * un pointeur sur l'élément du tableau visé.
 */
uchar* cvPtr2D (const CvArr* arr, int idx0, int idx1, int* type);</code></pre><p id="r-209201" data-claire-element-id="209201"><strong>Attention à l'ordre des arguments</strong> : il faut d'abord passer à cette fonction <em>le numéro de ligne</em> du pixel (soit la coordonnée y) puis le numéro de colonne (la coordonnée x). Le paramètre optionnel <code>type</code> ne nous intéresse pas pour l'instant : on pourra le laisser à <code data-claire-semantic="c">NULL</code> la plupart du temps.</p><p id="r-209202" data-claire-element-id="209202">Voici une implémentation de la fonction <code data-claire-semantic="c">invert</code> en utilisant cvPtr2D pour parcourir l'image.</p><pre id="r-209203" data-claire-element-id="209203"><code data-claire-semantic="c">void invert (IplImage* img)
{
  int x,y;
  uchar *p;
  assert (img-&gt;depth == IPL_DEPTH_8U &amp;&amp; img-&gt;nChannels == 1);

  for (y = 0; y &lt; img-&gt;height; ++y)
  {
    for (x = 0; x &lt; img-&gt;width; ++x)
    {
      // récupération d'un pointeur sur le pixel de coordonnées (x,y)
      p = cvPtr2D (img, y, x, NULL);
      *p = 255 - *p;
    }
  }
}</code></pre><p id="r-209204" data-claire-element-id="209204">Comme vous le constatez, le code est plutôt direct. Ce qui est intéressant à noter, c'est que la fonction <code data-claire-semantic="c">cvPtr2D</code> réalise exactement le petit calcul sur les pointeurs que je vous ai montré plus haut. Cela peut être mis en évidence en utilisant à la place la fonction <code data-claire-semantic="c">cvPtr1D</code> :</p><pre id="r-209205" data-claire-element-id="209205"><code data-claire-semantic="c">/**
 * Retourne un pointeur sur le pixel de coordonnée idx.
 */
uchar* cvPtr1D (const CvArr* arr, int idx, int* type);</code></pre><p id="r-209206" data-claire-element-id="209206">Cette fonction réalise la même opération que la précédente, mais en considérant cette fois que le tableau passé en argument n'a qu'une seule dimension. Pour l'utiliser, il nous faut donc calculer l'emplacement du pixel visé nous-mêmes, comme ceci :</p><pre id="r-209207" data-claire-element-id="209207"><code data-claire-semantic="c">void invert (IplImage* img)
{
  int x,y;
  uchar *p;
  assert (img-&gt;depth == IPL_DEPTH_8U &amp;&amp; img-&gt;nChannels == 1);

  for (y = 0; y &lt; img-&gt;height; ++y)
  {
    for (x = 0; x &lt; img-&gt;width; ++x)
    {
      // récupération d'un pointeur sur le pixel de coordonnées (x,y)
      p = cvPtr1D (img, y * img-&gt;widthStep + x, NULL);
      *p = 255 - *p;
    }
  }
}</code></pre><p id="r-209208" data-claire-element-id="209208">La seule ligne qui change dans ce code est celle surlignée. Comme vous le voyez, le calcul de l'indice du pixel reprend exactement ce qui précède dans ce chapitre.</p><h6 id="r-la-methode-rapide-l-acces-direct-au-pointeur" data-claire-element-id="209214">La méthode rapide : l'accès direct au pointeur</h6><p id="r-209210" data-claire-element-id="209210">Le seul inconvénient de la méthode précédente pour parcourir une image, c'est que l'indice du pixel est entièrement recalculé à chaque passage dans la deuxième boucle. Il ne devrait pas être bien compliqué de trouver un moyen plus direct pour <em>scanner</em> toute une image, sans avoir besoin d'une fonction pour cela.</p><p id="r-209211" data-claire-element-id="209211">Voici la dernière implémentation complète de la fonction <code data-claire-semantic="c">invert</code> que nous verrons dans ce chapitre :</p><pre id="r-209212" data-claire-element-id="209212"><code data-claire-semantic="c">void invert (IplImage* img)
{
  uchar *p, *line;
  assert (img-&gt;depth == IPL_DEPTH_8U &amp;&amp; img-&gt;nChannels == 1);

  // parcours des lignes de l'image
  // on positionne le pointeur &quot;line&quot; sur le début de l'image
  // et on le fait avancer de la taille d'une ligne à chaque itération
  // jusqu'à tomber sur l'octet suivant le dernier pixel de l'image
  for (line = (uchar*) img-&gt;imageData; 
       line &lt; (uchar*) img-&gt;imageData + img-&gt;imageSize; 
       line += img-&gt;widthStep)
  {
    // parcours de la ligne &quot;line&quot;
    // on positionne le pointeur p sur le début de la ligne
    // et on le fait avancer de la taille d'un pixel à chaque itération
    // jusqu'à tomber sur le dernier pixel de la ligne
    for (p = line; p &lt; line + img-&gt;width; ++p)
    {
      *p = 255 - *p;
    }
  }
}</code></pre><p id="r-209213" data-claire-element-id="209213">Ce code, quoique relativement déroutant de prime abord si vous n'avez pas l'habitude de jouer avec les pointeurs de cette façon, n'est pas spécialement compliqué (les commentaires sont là pour vous guider). Je vous conseille de le dérouler lentement dans votre tête jusqu'à ce qu'il soit clair pour vous, car c'est ainsi que nous parcourrons nos matrices chaque fois que nous aurons besoin de réaliser un « <em>full-scan</em> ».</p><h6 id="r-la-methode-qui-tue" data-claire-element-id="209218">La méthode qui tue</h6><p id="r-209215" data-claire-element-id="209215">Pour les plus coriaces d'entre vous, voici quand même une dernière implémentation de la fonction <code>invert</code>, très en marge du cadre de ce chapitre, mais que je vous laisse analyser à titre d'exercice en vous aidant de la documentation de la fonction <a href="http://opencv.willowgarage.com/documentation/c/core_operations_on_arrays.html#not"><code data-claire-semantic="c">cvNot</code></a> :</p><pre id="r-209216" data-claire-element-id="209216"><code data-claire-semantic="c">void invert (IplImage* img)
{
  cvNot (img, img);
}</code></pre><p id="r-209217" data-claire-element-id="209217">:p</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
<span class="arrow"></span>
<span class="next">La structure IplImage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Exercices"></a><h2>Exercices</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
<span class="arrow"></span>
<span class="next">Parcourir une image</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">
<span class="next">Un nouveau monde en couleurs…</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-exercices-15" data-claire-element-id="209251">Exercices</h4><p id="r-209221" data-claire-element-id="209221">Afin de bien faire rentrer tout ce que nous avons vu jusqu'à présent, voici un petit exercice corrigé.</p><h5 id="r-superposition-de-deux-images" data-claire-element-id="209250">Superposition de deux images</h5><p id="r-209222" data-claire-element-id="209222">Voici deux photos de Lena très bruitées :</p><figure id="r-209224" data-claire-element-id="209225"><img id="r-209223" data-claire-element-id="209223" src="medias/uploads.siteduzero.com_files_345001_346000_345257.jpg" alt="Image utilisateur"/></figure><figure id="r-209227" data-claire-element-id="209228"><img id="r-209226" data-claire-element-id="209226" src="medias/uploads.siteduzero.com_files_345001_346000_345256.jpg" alt="Image utilisateur"/></figure><p id="r-209229" data-claire-element-id="209229">Ces deux images peuvent vous paraître identiques à première vue, mais elles sont plutôt <strong>totalement complémentaires</strong>. En effet, si vous les <em>superposez</em>, vous obtiendrez l'image d'origine.</p><p id="r-209230" data-claire-element-id="209230">Le but de l'exercice sera pour vous de réaliser un programme qui calculera la <strong>moyenne</strong> de ces deux images, c'est-à-dire le traitement que l'on peut résumer par la formule suivante :</p><p id="r-209231" data-claire-element-id="209231">\mathrm{dst(x,y)} = \dfrac{\mathrm{src1}(x,y) + \mathrm{src2}(x,y)}{2}</p><p id="r-209232" data-claire-element-id="209232">Vous pourrez vérifier votre programme simplement en regardant si celui-ci reconstruit correctement l'image d'origine ou non. ;)</p><h6 id="r-avant-de-commencer-a-coder" data-claire-element-id="209237">Avant de commencer à coder</h6><p id="r-209233" data-claire-element-id="209233">Avant que vous ne vous mettiez au travail, il reste une dernière considération d'ordre pratique qu'il faut que nous voyions ensemble, <strong>a fortiori si vous travaillez sous Windows</strong>. Sous cet OS, la fonction <code data-claire-semantic="c">cvLoadImage</code> a la fâcheuse tendance de ne pas placer l'origine des images au bon endroit. En effet, il arrive que les images sous Windows soient chargées avec l'origine <strong>en bas à gauche</strong>, ce qui fait que sans y faire attention, votre image de résultat risque de se retrouver la tête en bas.</p><p id="r-209234" data-claire-element-id="209234">Voici une petite fonction grâce à laquelle vous pourrez pallier ce problème :</p><pre id="r-209235" data-claire-element-id="209235"><code data-claire-semantic="c">/**
 * Corrige l'origine de l'image si nécessaire
 */
void fix_origin (IplImage* img)
{
  if (img-&gt;origin == IPL_ORIGIN_BL)
  {
    cvConvertImage(img, img, CV_CVTIMG_FLIP);
    img-&gt;origin = IPL_ORIGIN_TL;
  }
}</code></pre><p id="r-209236" data-claire-element-id="209236">Sur ce, au travail !</p><h6 id="r-solution-s" data-claire-element-id="209249">Solution(s)</h6><p id="r-209238" data-claire-element-id="209238">Voici une solution possible pour cet exercice :</p><p id="r-209239" data-claire-element-id="209239"></p><div id="r-209241" data-claire-element-id="209241"><pre id="r-209240" data-claire-element-id="209240"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;assert.h&gt;
#include &lt;opencv/cv.h&gt;
#include &lt;opencv/highgui.h&gt;

/**
 * Calcule la moyenne des images src1 et src2.
 * Stocke le résultat dans l'image dst.
 */
void superpose (const IplImage *src1, const IplImage *src2, IplImage* dst)
{
  int x, y;
  uchar *p_dst, *p_src1, *p_src2;

  assert (src1-&gt;width == src2-&gt;width);
  assert (src1-&gt;height == src2-&gt;height);

  for (y = 0; y &lt; dst-&gt;height; ++y)
  {
    for (x = 0; x &lt; dst-&gt;width; ++x)
    {
      p_src1 = cvPtr2D (src1, y, x, NULL);
      p_src2 = cvPtr2D (src2, y, x, NULL);
      p_dst  = cvPtr2D (dst , y, x, NULL);

      *p_dst  = *p_src1 / 2 + *p_src2 / 2;
    }
  }
}

/**
 * Corrige l'origine de l'image si nécessaire
 */
void fix_origin (IplImage* img)
{
  if (img-&gt;origin == IPL_ORIGIN_BL)
  {
    cvConvertImage(img, img, CV_CVTIMG_FLIP);
    img-&gt;origin = IPL_ORIGIN_TL;
  }
}

/**
 * Ce programme prend deux arguments : les deux images à superposer.
 */
int main (int argc, char* argv[])
{
  IplImage* src1 = NULL; 
  IplImage* src2 = NULL; 
  IplImage* dst  = NULL; 
  const char* src1_path = NULL;
  const char* src2_path = NULL;
  const char* window_title = &quot;Superpose&quot;;

  if (argc &lt; 3)
  {
    fprintf (stderr, &quot;usage: %s SRC1 SRC2\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }

  src1_path = argv[1];
  src2_path = argv[2];

  if (!(src1 = cvLoadImage (src1_path, CV_LOAD_IMAGE_GRAYSCALE)))
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, src1_path);
    return EXIT_FAILURE;
  }

  if (!(src2 = cvLoadImage (src2_path, CV_LOAD_IMAGE_GRAYSCALE)))
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, src2_path);
    return EXIT_FAILURE;
  }

  fix_origin (src1);
  fix_origin (src2);

  dst = cvCreateImage (cvGetSize (src1), IPL_DEPTH_8U, 1);

  superpose (src1, src2, dst);

  cvNamedWindow (window_title, CV_WINDOW_AUTOSIZE);
  cvShowImage (window_title, dst);
  cvWaitKey(0);
  cvDestroyAllWindows();

  cvReleaseImage(&amp;src1);
  cvReleaseImage(&amp;src2);
  cvReleaseImage(&amp;dst);

  return EXIT_SUCCESS;
}</code></pre></div><p id="r-209242" data-claire-element-id="209242">Cependant, il est intéressant de noter que ce genre de fonction existe déjà dans OpenCV, avec <a href="http://opencv.willowgarage.com/documentation/c/core_operations_on_arrays.html#addweighted">cvAddWeighted</a> :</p><p id="r-209243" data-claire-element-id="209243"></p><div id="r-209245" data-claire-element-id="209245"><pre id="r-209244" data-claire-element-id="209244"><code data-claire-semantic="c">void superpose (const IplImage *src1, const IplImage *src2, IplImage* dst)
{
  cvAddWeighted (src1, 0.5, src2, 0.5, 0.0, dst);
}</code></pre></div><p id="r-209246" data-claire-element-id="209246">Soufflez ! Ce chapitre était dense. Très dense, même.</p><p id="r-209247" data-claire-element-id="209247">Je vous recommande vivement de le relire à nouveau quand vous aurez digéré le Doliprane que vous venez d'avaler. Les notions que nous venons de voir sont fondamentales pour la suite !</p><p id="r-209248" data-claire-element-id="209248">Aussi, vous pouvez être rassurés : si vous avez correctement assimilé ce que nous venons de voir, le reste de ce cours vous paraîtra sûrement bien plus facile. ;)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
<span class="arrow"></span>
<span class="next">Parcourir une image</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">
<span class="next">Un nouveau monde en couleurs…</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Unnouveaumondeencouleurs"></a><h2>Un nouveau monde en couleurs…</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
<span class="arrow"></span>
<span class="next">Exercices</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
<span class="next">Représentation théorique des couleurs</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-209253" data-claire-element-id="209253">« <em>Ce rêve bleuuuuu…</em> » <br/> Ah ! Vous êtes là ?… Hum !… Bonjour ! Je ne vous avais pas <em>vu</em>… :-°</p><p id="r-209254" data-claire-element-id="209254">Vous l'avez probablement deviné : aujourd'hui, nous allons parler de couleurs.</p><p id="r-209255" data-claire-element-id="209255">Dans le chapitre précédent, nous avons découvert ensemble la nature des images dans le cas le plus simple : celui d'images en niveaux de gris. Or nous savons très bien, vous et moi, qu'à moins d'avoir le <em>blues</em> ou de souffrir d'une forme très sérieuse de daltonisme, le monde que nous voyons n'est pas gris mais coloré.</p><p id="r-209256" data-claire-element-id="209256">Pour corriger cela, nous allons maintenant affiner notre représentation de la lumière de façon à y faire entrer la notion de couleur (ou plutôt de <em>chrominance</em>), et nous verrons comment cela se traduit sur les images numériques. Si vous avez bien suivi ce que nous avons abordé jusqu'à maintenant, ce chapitre devrait vous sembler beaucoup plus facile que le précédent.</p>
</div><a name="Reprsentationthoriquedescouleurs"></a><h2>Représentation théorique des couleurs</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">
<span class="arrow"></span>
<span class="next">Un nouveau monde en couleurs…</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
<span class="next">Travailler avec des images en couleur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-representation-theorique-des-couleurs" data-claire-element-id="209327">Représentation théorique des couleurs</h4><h5 id="r-la-luminance-et-la-chrominance" data-claire-element-id="209263">La luminance et la chrominance</h5><p id="r-209257" data-claire-element-id="209257">Comme je vous l'ai dit plus tôt, les niveaux de gris dans une image représentent une intensité lumineuse en chaque pixel. On dit qu'ils décrivent la <strong>luminance</strong>, c'est-à-dire l'<em>information relative à l'intensité de la lumière</em>. Cela revient à considérer la lumière comme porteuse d'une seule information, descriptible par un seul nombre : le niveau de gris. Si l'on raisonne en termes d'ondes lumineuses, on peut considérer, grosso-modo, que cette information se traduit par l'<em>amplitude</em> de l'onde.</p><figure id="r-209259" data-claire-element-id="209260"><img id="r-209258" data-claire-element-id="209258" src="medias/uploads.siteduzero.com_files_345001_346000_345516.png" alt="Image utilisateur"/></figure><p id="r-209261" data-claire-element-id="209261">Seulement, dans le monde réel, la lumière ne se réduit pas à son intensité, tout comme une onde ne se décrit pas seulement par son amplitude, mais aussi par sa <em>fréquence</em> (ou sa <em>longueur d'onde</em>, mais ce sont deux mesures de la même information). Vous savez probablement que la fréquence d'une onde lumineuse influence la couleur que nous percevons lorsque le rayon vient frapper notre rétine : du rouge au violet en passant par tous les tons de l'arc-en-ciel. Cette seconde information portée par la lumière, nous l'appelons la <strong>chrominance</strong>.</p><p id="r-209262" data-claire-element-id="209262">C'est en ceci qu'une image couleur va différer des images en niveaux de gris : chaque pixel sera porteur non plus d'une seule information (la luminance), mais de deux (la luminance et la chrominance).<br/> Dans la pratique, vous comprendrez aisément que pour contenir plusieurs informations différentes, les pixels doivent être composés de plusieurs nombres… autrement dit, les images doivent être composées de <strong>plusieurs canaux</strong>.</p><h5 id="r-les-espaces-de-couleurs" data-claire-element-id="209326">Les espaces de couleurs</h5><p id="r-209264" data-claire-element-id="209264">Contrairement à ce que vous devez penser et bien que nous considérons maintenant la lumière comme porteuse de deux informations, nous n'allons pas travailler avec des pixels composés de deux nombres mais <em>trois</em>. Ceci est dû au fait que les rayons lumineux sont un petit peu plus complexes en réalité que de simples ondes, et qu'une seule dimension ne suffit pas à décrire efficacement l'information de chrominance, en particulier.</p><p id="r-209265" data-claire-element-id="209265">Mathématiquement parlant, cela revient considérer que nos pixels sont <em>des vecteurs dans un espace à trois dimensions</em>. En fait, il existe plusieurs façons de coder les couleurs sur trois nombres, et chacune de ces façons de définir les couleurs décrit <strong>un espace de couleurs</strong> différent. Étant donné que nous débutons, nous commencerons par travailler dans un seul espace pour le moment, mais vous aurez l'occasion d'en découvrir plusieurs autres dans ce tutoriel, chacun ayant sa propre manière de coder les couleurs, son histoire, ses qualités et ses défauts.</p><h6 id="r-l-espace-rgb" data-claire-element-id="209318">L'espace RGB</h6><p id="r-209266" data-claire-element-id="209266">Pour faire le rapprochement entre la lumière physique et le modèle RGB, imaginons que nous fassions une petite expérience d'optique.</p><p id="r-209267" data-claire-element-id="209267">Comme vous le savez peut-être, la lumière blanche résulte de la superposition d'ondes de toutes les fréquences visibles dans un même rayon. Imaginons que nous fassions passer un rayon de lumière blanche à travers un filtre absorbant le <strong>bleu</strong> (c'est-à-dire que nous supprimons toutes la gamme des hautes fréquences lumineuses), nous obtiendrions alors un rayon jaune. Si, maintenant, nous retirions toutes les ondes lumineuses de basse fréquence de ce rayon jaune, au moyen d'un filtre qui absorbe le <strong>rouge</strong>, nous obtiendrions un rayon <strong>vert</strong>.</p><p id="r-209268" data-claire-element-id="209268">Que retenir de cette expérience ?<br/> Simplement que la couleur de la lumière peut être perçue comme un savant dosage entre trois composantes de base : le rouge (<em>red</em>, R), le vert (<em>green</em>, G) et le bleu (<em>blue</em>, B). Nous venons de décrire le principe de l'<strong>espace de couleurs RGB</strong>.</p><figure id="r-209270" data-claire-element-id="209271"><img id="r-209269" data-claire-element-id="209269" src="medias/uploads.siteduzero.com_files_345001_346000_345527.png" alt="Image utilisateur"/></figure><p id="r-209272" data-claire-element-id="209272"><em>Le principe de la superposition des couleurs dans l'espace RGB.</em></p><p id="r-209273" data-claire-element-id="209273">Mathématiquement parlant, nous allons représenter une couleur dans l'espace RGB par un vecteur (r,g,b) comprenant les niveaux de rouge, de vert et de bleu correspondants. Étant donné que nous travaillons pour l'instant sur des nombres tenant sur un octet, ces valeurs, de manière analogue aux niveaux de gris, seront comprises entre 0 et 255.</p><p id="r-209274" data-claire-element-id="209274">Par exemple, on peut associer les couleurs suivantes à leurs représentations dans l'espace RGB :</p><table id="r-209317" data-claire-element-id="209317"><thead id="r-209280" data-claire-element-id="209280"><tr id="r-209279" data-claire-element-id="209279"><th id="r-209276" data-claire-element-id="209276"><p id="r-209275" data-claire-element-id="209275">Couleur</p></th><th id="r-209278" data-claire-element-id="209278"><p id="r-209277" data-claire-element-id="209277">Représentation RGB</p></th></tr></thead><tbody id="r-209316" data-claire-element-id="209316"><tr id="r-209285" data-claire-element-id="209285"><td id="r-209282" data-claire-element-id="209282"><p id="r-209281" data-claire-element-id="209281">Rouge</p></td><td id="r-209284" data-claire-element-id="209284"><p id="r-209283" data-claire-element-id="209283">(255,0,0)</p></td></tr><tr id="r-209290" data-claire-element-id="209290"><td id="r-209287" data-claire-element-id="209287"><p id="r-209286" data-claire-element-id="209286">Vert</p></td><td id="r-209289" data-claire-element-id="209289"><p id="r-209288" data-claire-element-id="209288">(0,255,0)</p></td></tr><tr id="r-209295" data-claire-element-id="209295"><td id="r-209292" data-claire-element-id="209292"><p id="r-209291" data-claire-element-id="209291">Bleu</p></td><td id="r-209294" data-claire-element-id="209294"><p id="r-209293" data-claire-element-id="209293">(0,0,255)</p></td></tr><tr id="r-209300" data-claire-element-id="209300"><td id="r-209297" data-claire-element-id="209297"><p id="r-209296" data-claire-element-id="209296">Noir</p></td><td id="r-209299" data-claire-element-id="209299"><p id="r-209298" data-claire-element-id="209298">(0,0,0)</p></td></tr><tr id="r-209305" data-claire-element-id="209305"><td id="r-209302" data-claire-element-id="209302"><p id="r-209301" data-claire-element-id="209301">Blanc</p></td><td id="r-209304" data-claire-element-id="209304"><p id="r-209303" data-claire-element-id="209303">(255,255,255)</p></td></tr><tr id="r-209310" data-claire-element-id="209310"><td id="r-209307" data-claire-element-id="209307"><p id="r-209306" data-claire-element-id="209306">Jaune</p></td><td id="r-209309" data-claire-element-id="209309"><p id="r-209308" data-claire-element-id="209308">(255,255,0)</p></td></tr><tr id="r-209315" data-claire-element-id="209315"><td id="r-209312" data-claire-element-id="209312"><p id="r-209311" data-claire-element-id="209311">Gris 50%</p></td><td id="r-209314" data-claire-element-id="209314"><p id="r-209313" data-claire-element-id="209313">(127,127,127)</p></td></tr></tbody></table><h6 id="r-rgb-et-la-luminance" data-claire-element-id="209325">RGB et la luminance</h6><p id="r-209319" data-claire-element-id="209319">Bien que l'espace RGB soit extrêmement utilisé en informatique (c'est même le plus utilisé), il se caractérise par un assez gros défaut qu'il est judicieux de soulever dès maintenant : dans cet espace, <strong>les informations de luminance et de chrominance sont entremêlées</strong>, c'est-à-dire que l'on ne trouvera pas, par exemple, l'information de luminance complète sur un canal et celle de chrominance sur les deux autres. En vision par ordinateur, il arrive que cela pose un réel problème, par exemple lorsque l'on cherche à créer un algorithme indépendant des variations de luminosité (ce qui implique parfois de ne travailler que sur la chrominance, comme nous le verrons lorsque nous aborderons, beaucoup plus loin, la segmentation colorimétrique).</p><p id="r-209320" data-claire-element-id="209320">Plutôt que de répondre immédiatement à cette problématique en introduisant un nouvel espace de couleur (ce qui ne serait pas pertinent à ce niveau du tutoriel), je pense que le plus important est de vous montrer comment extraire l'information de luminance d'un pixel codé dans l'espace RGB. Autrement dit, <em>comment jongler entre le RGB et les niveaux de gris</em>.</p><p id="r-209321" data-claire-element-id="209321">Pour passer d'un niveau de gris à sa valeur dans l'espace RGB, la conversion est évidente. Si p_{\mathrm{gris}} = y, alors son équivalent sera p_{\mathrm{RGB}} = (y,y,y) : il suffit de répliquer le niveau de gris sur les canaux rouge, vert et bleu pour obtenir le même ton.</p><p id="r-209322" data-claire-element-id="209322">Pour la transition inverse, en revanche, c'est un petit peu plus compliqué. On pourrait croire, un peu naïvement, que le niveau de gris est simplement la moyenne des niveaux de rouge, de vert et de bleu d'une couleur donnée. Bien que cela constitue une approximation acceptable de la luminance, cela revient aussi à négliger le fait que les gammes de fréquence correspondant aux tons rouge, vert et bleu de la lumière <em>n'occupent pas la même place sur le spectre visible</em>, donc que les trois composantes ne contribuent pas toutes de la même manière à la luminosité. En fait, la composante verte contribue beaucoup plus à la luminance que les deux autres. Ainsi, pour en tenir compte lors de l'extraction de la luminance, on affecte des <strong>poids</strong> aux composantes RGB. La formule classique de conversion est la suivante :</p><p id="r-209323" data-claire-element-id="209323">p_{\mathrm{gris}} = 0.299 imes r + 0.587 imes g + 0.114 imes b</p><p id="r-209324" data-claire-element-id="209324">Dans la pratique, bien sûr, vous n'aurez pas à connaitre cette formule par cœur, puisqu'OpenCV se chargera de l'appliquer pour vous, comme nous le verrons plus bas.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">
<span class="arrow"></span>
<span class="next">Un nouveau monde en couleurs…</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
<span class="next">Travailler avec des images en couleur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Travailleravecdesimagesencouleur"></a><h2>Travailler avec des images en couleur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
<span class="arrow"></span>
<span class="next">Représentation théorique des couleurs</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-travailler-avec-des-images-en-couleur" data-claire-element-id="209385">Travailler avec des images en couleur</h4><h5 id="r-representation-des-donnees-1" data-claire-element-id="209347">Représentation des données</h5><p id="r-209328" data-claire-element-id="209328">Comme je vous l'ai laissé entendre au début du chapitre, les images en couleur diffèrent de celles en niveaux de gris par le fait qu'elles sont composées de <strong>plusieurs canaux</strong>. Pour dire les choses simplement, une image en RGB sera composée de trois canaux : un canal rouge, un canal vert et un canal bleu. Cette information est accessible sur la structure <code data-claire-semantic="c">IplImage</code> grâce à son champ <code data-claire-semantic="c">nChannels</code>.</p><p id="r-209329" data-claire-element-id="209332"><em><a href="medias/uploads.siteduzero.com_files_346001_347000_346269.jpg"><img id="r-209330" data-claire-element-id="209329" src="medias/uploads.siteduzero.com_thb_346001_347000_346269.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_346001_347000_346270.jpg"><img id="r-209331" data-claire-element-id="209330" src="medias/uploads.siteduzero.com_thb_346001_347000_346270.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_346001_347000_346268.jpg"><img id="r-209332" data-claire-element-id="209331" src="medias/uploads.siteduzero.com_thb_346001_347000_346268.jpg" alt="Image utilisateur"/></a>Décomposition des canaux rouge, vert et bleu de Lena (cliquez sur les images pour les agrandir).<br/>Notez au passage qu'en 1973, le scanner bleu du SIPI était de piètre qualité…<br/> Autre détail amusant : la compression JPEG des miniatures tient visiblement compte des poids des composantes RGB dans la luminance…</em></p><p id="r-209333" data-claire-element-id="209333">En réalité, cette histoire de canaux ne reflète pas vraiment ce qui se passe en mémoire : l'image en question ne sera pas composée de trois tableaux de dimensions identiques, mais d'un seul dont les pixels prennent trois fois plus de place. On dit que <em>les canaux sont <strong>entrelacés</strong></em>. Une autre chose importante à savoir est que <strong>dans OpenCV, l'espace couleur par défaut n'est pas RGB, mais BGR</strong>. Le second se démarque du premier simplement par le fait que les canaux rouge et bleu sont inversés. Le schéma suivant résume la situation :</p><figure id="r-209335" data-claire-element-id="209336"><img id="r-209334" data-claire-element-id="209334" src="medias/uploads.siteduzero.com_files_345001_346000_345558.png" alt="Image utilisateur"/></figure><p id="r-209337" data-claire-element-id="209337">Si vous vous souvenez du schéma du chapitre précédent sur les images en niveaux de gris, vous vous apercevrez que la <strong>seule</strong> chose qui change, finalement, lorsque l'on veut accéder à l'adresse d'un pixel donné, c'est qu'il faut multiplier sa coordonnée x par 3.</p><p id="r-209338" data-claire-element-id="209338">Au final, travailler en couleurs à bas niveau, c'est simplement tenir compte du fait que si l'on raisonne en termes de <code data-claire-semantic="c">char*</code> sur une image BGR 8 bits :</p><ul id="r-209345" data-claire-element-id="209345"><li id="r-209340" data-claire-element-id="209340"><p id="r-209339" data-claire-element-id="209339"><code data-claire-semantic="c">(img-&gt;imageData + (2 * img-&gt;widthStep) + 12 * 3)</code> est l'adresse de la composante bleue du pixel de coordonnées (12,2),</p></li><li id="r-209342" data-claire-element-id="209342"><p id="r-209341" data-claire-element-id="209341"><code data-claire-semantic="c">(img-&gt;imageData + (2 * img-&gt;widthStep) + 12 * 3 + 1)</code> est l'adresse de la composante verte de ce même pixel,</p></li><li id="r-209344" data-claire-element-id="209344"><p id="r-209343" data-claire-element-id="209343"><code data-claire-semantic="c">(img-&gt;imageData + (2 * img-&gt;widthStep) + 12 * 3 + 2)</code> est l'adresse de sa composante rouge.</p></li></ul><p id="r-209346" data-claire-element-id="209346">Maintenant que ceci est posé, découvrons ensemble les deux façons possibles d'aborder le traitement d'images en couleur.</p><h5 id="r-l-approche-un-pixel-une-couleur" data-claire-element-id="209371">L'approche « un pixel = une couleur »</h5><p id="r-209348" data-claire-element-id="209348">La première manière d'aborder les images multi-canaux dans OpenCV est de continuer à considérer l'image comme une matrice dont les pixels sont des vecteurs. Pour cela, et ce dans le simple but de faire écho au chapitre précédent, introduisons de nouvelles fonctions d'OpenCV, qui permettent de récupérer et de modifier les valeurs des pixels ainsi que la structure <code data-claire-semantic="c">CvScalar</code> qui représente un pixel dans une image en couleur.</p><pre id="r-209349" data-claire-element-id="209349"><code data-claire-semantic="c">typedef struct CvScalar
{
    double val[4];
}
CvScalar;</code></pre><p id="r-209350" data-claire-element-id="209350">Comme vous le voyez, cette structure est on ne peut plus simple. Si celle-ci permet de contenir jusqu'à quatre valeurs, c'est simplement parce qu'OpenCV supporte des images qui peuvent avoir jusqu'à 4 canaux, bien que ce quatrième canal ne serve presque jamais dans la pratique.</p><p id="r-209351" data-claire-element-id="209351">Pour créer un scalaire vous pouvez utiliser les constructeurs suivants :</p><pre id="r-209352" data-claire-element-id="209352"><code data-claire-semantic="c">/* Construit un CvScalar en utilisant les quatre valeurs indiquées */
CvScalar cvScalar (double val0, double val1, double val2, double val3);

/* Construit un CvScalar en initialisant les quatre valeurs à val0123 */
CvScalar cvScalarAll (double val0123);

/* Construit un CvScalar en initialisant val[0] à val0, et les trois autres valeurs à 0 */
CvScalar cvRealScalar (double val0);</code></pre><p id="r-209353" data-claire-element-id="209353">Ou bien, de façon plus sémantique et probablement plus directe dans bien des cas, la macro suivante :</p><pre id="r-209354" data-claire-element-id="209354"><code data-claire-semantic="c">#define CV_RGB( r, g, b )  cvScalar( (b), (g), (r), 0 )</code></pre><p id="r-209355" data-claire-element-id="209355">Pour interagir avec une image au moyen de cette structure, vous pourrez utiliser les deux fonctions suivantes :</p><pre id="r-209356" data-claire-element-id="209356"><code data-claire-semantic="c">/**
 * Récupère le pixel de coordonnées (idx1, idx0) sous forme d'un CvScalar
 */
CvScalar cvGet2D (const CvArr* arr, int idx0, int idx1);

/**
 * Remplace le pixel de coordonnées (idx1, idx0) par 'value'
 */
void cvSet2D (CvArr* arr, int idx0, int idx1, CvScalar value);</code></pre><p id="r-209357" data-claire-element-id="209357">Comme pour la fonction <code data-claire-semantic="c">cvPtr2D</code> (qu'il est tout à fait possible d'utiliser aussi), ces fonctions prennent d'abord en argument la coordonnée y, puis la coordonnée x du pixel visé.</p><h6 id="r-exemple-65" data-claire-element-id="209370">Exemple</h6><p id="r-209358" data-claire-element-id="209358">À titre d'exemple d'utilisation de ces fonctions, voici une fonction <code data-claire-semantic="c">invert_color</code> qui inverse une image en couleur.</p><pre id="r-209359" data-claire-element-id="209359"><code data-claire-semantic="c">void invert_color (IplImage* img)
{
  CvScalar p;
  int x, y, k;

  assert (img-&gt;depth == IPL_DEPTH_8U);

  for (y = 0; y &lt; img-&gt;height; ++y)
  {
    for (x = 0; x &lt; img-&gt;width; ++x)
    {
      p = cvGet2D (img, y, x);
      for (k = 0; k &lt; img-&gt;nChannels; ++k)
      {
        p.val[k] = 255 - p.val[k];
      }
      cvSet2D (img, y, x, p);
    }
  }
}</code></pre><p id="r-209360" data-claire-element-id="209360">Cette approche est relativement simple, même si le passage obligatoire par la structure <code data-claire-semantic="c">CvScalar</code> est plutôt verbeux, et surtout <em>assez lent</em> par rapport à un accès direct aux pointeurs, notamment parce que cette fonction réalise, en interne, des <em>casts</em>, des copies, et des vérifications dans tous les sens.</p><p id="r-209361" data-claire-element-id="209361">Voici maintenant la même fonction implémentée cette fois de façon directe et plus efficace.</p><pre id="r-209362" data-claire-element-id="209362"><code data-claire-semantic="c">void invert_color (IplImage* img)
{
  uchar *p, *line;

  assert (img-&gt;depth == IPL_DEPTH_8U);

  for (line =  (uchar*) img-&gt;imageData;
       line &lt;  (uchar*) img-&gt;imageData + img-&gt;imageSize;
       line += img-&gt;widthStep)
  {
    for (p = line; p &lt; line + img-&gt;width * img-&gt;nChannels; ++p)
    {
      *p = 255 - *p;   
    }
  }
}</code></pre><p id="r-209363" data-claire-element-id="209363">Comme vous le constatez, cette fonction diffère très, très peu de celle que nous avons vue dans le chapitre précédent. La seule chose que l'on a rajoutée, c'est la multiplication du nombre de colonnes de l'image par son nombre de canaux afin de parcourir toute la ligne. Encore une fois, je vous recommande de privilégier ce genre de méthode par rapport à l'utilisation des fonctions de l'API d'OpenCV pour accéder aux pixels de vos images. Le fait de ne pas avoir à réaliser des appels aux fonctions d'une bibliothèque à chaque itération pour interagir avec les données est un avantage certain du point de vue des performances.</p><p id="r-209364" data-claire-element-id="209364">De manière à ce que cela reste clair dans votre esprit, gardez ce petit classement en tête en ce qui concerne les méthodes d'accès aux pixels :</p><p id="r-209365" data-claire-element-id="209365"><code>cvGet2D</code> &lt; <code>cvPtr2D</code> &lt; accès direct</p><p id="r-209366" data-claire-element-id="209366">Voici le résultat des deux fonctions précédentes sur Lena :</p><figure id="r-209368" data-claire-element-id="209369"><img id="r-209367" data-claire-element-id="209367" src="medias/uploads.siteduzero.com_files_346001_347000_346309.jpg" alt="Image utilisateur"/></figure><h5 id="r-l-approche-diviser-pour-regner" data-claire-element-id="209379">L'approche « Diviser pour régner »</h5><p id="r-209372" data-claire-element-id="209372">Bien que, de prime abord, les approches précédentes soient celles qui semblent les plus logiques pour traiter des images en couleur, celles-ci ne peuvent se révéler parfois insuffisantes ou inadaptées pour généraliser certains traitements sur les niveaux de gris à des images en couleur (par exemple, le filtrage, ou l'égalisation d'histogrammes, comme vous le verrez bientôt). En fait, il s'avère parfois nécessaire de traiter chaque canal de l'image indépendamment des deux autres. Pour cela, on devra <strong>séparer</strong> les trois canaux dans trois images différentes (<em>split</em>), appliquer les traitements sur chaque canal, puis <strong>refondre</strong> les trois canaux en une seule image (<em>merge</em>).</p><p id="r-209373" data-claire-element-id="209373">Pour cela, OpenCV nous propose les deux fonctions suivantes :</p><pre id="r-209374" data-claire-element-id="209374"><code data-claire-semantic="c">/**
 * Sépare une image multi-canaux en plusieurs images à un seul canal.
 * Arguments :
 * - src : image à séparer
 * - dst0, dst1, dst2, dst3: images dans lesquels placer les canaux
 */
void cvSplit (const CvArr* src, CvArr* dst0, CvArr* dst1, CvArr* dst2, CvArr* dst3);

/**
 * Fusionne plusieurs images à un seul canal en une image multi-canaux.
 */
void cvMerge (const CvArr* src0, const CvArr* src1, const CvArr* src2, const CvArr* src3, CvArr* dst);</code></pre><p id="r-209375" data-claire-element-id="209375">Dans ces deux fonctions, les arguments qui ne sont pas utilisés (classiquement <code data-claire-semantic="c">dst3</code> et <code>src3</code> la plupart du temps) seront laissés à NULL.</p><p id="r-209376" data-claire-element-id="209376">Afin d'illustrer l'utilisation de ces fonctions, voici une dernière implémentation de la fonction <code>invert_color</code> :</p><pre id="r-209377" data-claire-element-id="209377"><code data-claire-semantic="c">void invert_color (IplImage* img)
{
  IplImage* chans[3];
  int i = 0;

  assert (img-&gt;nChannels == 3);
  assert (img-&gt;depth == IPL_DEPTH_8U);

  for (i = 0; i &lt; 3; ++i)
  {
    chans[i] = cvCreateImage (cvGetSize (img), IPL_DEPTH_8U, 1);
  }

  // Séparation des canaux
  cvSplit (img, chans[0], chans[1], chans[2], NULL);

  for (i = 0; i &lt; 3; ++i)
  {
    // utilisation de la fonction invert du chapitre précédent
    invert (chans[i]);
  }

  // Refonte des canaux
  cvMerge (chans[0], chans[1], chans[2], NULL, img);

  // Libération des trois images de travail
  for (i = 0; i &lt; 3; ++i)
  {
    cvReleaseImage(chans + i);
  }
}</code></pre><p id="r-209378" data-claire-element-id="209378">Cette fonction est un petit peu plus compliquée que les précédentes. En revanche, elle illustre un avantage non-négligeable de la méthode « <em>split &amp; merge</em> » : si vous avez accès à une fonction donnée traitant un seul canal, vous pouvez de cette façon l'appliquer sur des images en couleur sans avoir à en connaître les tenants et les aboutissants. Bien sûr, l'utilisation de cette approche fait encore plus de sens lorsque les traitements à appliquer sur les trois canaux ne sont pas les mêmes…</p><h5 id="r-une-derniere-fonction-pour-la-route" data-claire-element-id="209384">Une dernière fonction pour la route</h5><p id="r-209380" data-claire-element-id="209380">Avant de passer aux exercices de ce chapitre, il me reste une dernière fonction à vous montrer, et pas des moindres ! Voyez par vous-même :</p><pre id="r-209381" data-claire-element-id="209381"><code data-claire-semantic="c">/**
 * Conversion entre deux espaces de couleur.
 * arguments:
 * - src, dst: images source et destination de la conversion
 * - code: code décrivant l'algorithme de conversion à utiliser
 */
void cvCvtColor(const CvArr* src, CvArr* dst, int code);</code></pre><p id="r-209382" data-claire-element-id="209382">L'argument <code>code</code> est géré par des constantes d'OpenCV qui prennent la forme :<br/><code>CV_[espace de départ]2[espace d'arrivée]</code>.</p><p id="r-209383" data-claire-element-id="209383">Par exemple, pour convertir une image BGR en niveaux de gris, le code sera <code>CV_BGR2GRAY</code>, et la transformation inverse est <code>CV_GRAY2BGR</code>. <a href="http://opencv.willowgarage.com/documentation/c/imgproc_miscellaneous_image_transformations.html#cvCvtColor">La documentation de cette fonction</a> décrit les formules employées pour réaliser les conversions les plus courantes.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
<span class="arrow"></span>
<span class="next">Représentation théorique des couleurs</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Exercices"></a><h2>Exercices</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
<span class="arrow"></span>
<span class="next">Travailler avec des images en couleur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">
<span class="next">Étirement et égalisation d&#039;histogramme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-exercices-16" data-claire-element-id="209397">Exercices</h4><h5 id="r-reinvention-de-la-roue" data-claire-element-id="209396">Réinvention de la roue</h5><p id="r-209386" data-claire-element-id="209386">Bien que cet exercice ne vous fera rien faire de spectaculaire, je trouve que le meilleur moyen de vous faire « sentir » les images en couleur est encore de vous les faire manipuler en réinventant la roue, c'est-à-dire en ré-implémentant les fonctions <code data-claire-semantic="c">cvSplit</code> et <code data-claire-semantic="c">cvMerge</code>.</p><p id="r-209387" data-claire-element-id="209387">Le but de l'exercice est de vous faire coder le petit programme que j'ai utilisé pour vous montrer la décomposition en canaux de Lena un peu plus haut dans le chapitre. Pour cela, vous allez d'abord devoir coder les fonctions suivantes :</p><pre id="r-209388" data-claire-element-id="209388"><code data-claire-semantic="c">/**
 * Sépare les canaux d'une image BGR 8 bits en trois images mono-canal 8 bits.
 */
void my_split (const IplImage* src, IplImage* blue, IplImage* green, IplImage* red);

/**
 * Assemble une image BGR 8 bits à partir de trois images mono-canal 8 bits.
 */
void my_merge (const IplImage* blue, const IplImage* green, const IplImage* red, IplImage* dst);</code></pre><p id="r-209389" data-claire-element-id="209389">Je vous recommande chaudement l'utilisation de la fonction <code data-claire-semantic="c">cvPtr2D</code> pour parcourir les images à l'intérieur de ces fonctions.</p><p id="r-209390" data-claire-element-id="209390">Ensuite, vous pourrez utiliser ces fonctions dans un programme qui va désassembler une image couleur, et réassembler trois nouvelles images représentant les canaux rouge, vert, et bleu de l'image d'origine, c'est-à-dire que pour le canal bleu, par exemple, vous devrez fournir à <code data-claire-semantic="c">my_merge</code> une image 8 bits mono-canal <strong>noire</strong> pour les canaux vert et rouge (la fonction <a href="http://opencv.willowgarage.com/documentation/c/core_operations_on_arrays.html?highlight=cvsetzero#cvSetZero">cvSetZero</a> devrait vous être utile).</p><h6 id="r-correction-80" data-claire-element-id="209395">Correction</h6><div id="r-209392" data-claire-element-id="209392"><pre id="r-209391" data-claire-element-id="209391"><code data-claire-semantic="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;assert.h&gt;
#include &lt;opencv/cv.h&gt;
#include &lt;opencv/highgui.h&gt;

/**
 * Sépare les canaux d'une image BGR 8 bits en trois images mono-canal 8 bits.
 */
void my_split (const IplImage* src, IplImage* blue, IplImage* green, IplImage* red)
{
  int x,y;
  uchar *p_src, *p_red, *p_green, *p_blue;

  for (y = 0; y &lt; src-&gt;height; ++y)
  {
    for (x = 0; x &lt; src-&gt;width; ++x)
    {
      p_src   = cvPtr2D (src,   y, x, NULL);
      p_blue  = cvPtr2D (blue,  y, x, NULL);
      p_green = cvPtr2D (green, y, x, NULL);
      p_red   = cvPtr2D (red,   y, x, NULL);

      *p_blue  = *p_src;
      *p_green = *(p_src + 1);
      *p_red   = *(p_src + 2);
    }
  }
}

/**
 * Assemble une image BGR 8 bits à partir de trois images mono-canal 8 bits.
 */
void my_merge (const IplImage* blue, const IplImage* green, const IplImage* red, IplImage* dst)
{
  int x,y;
  uchar *p_dst, *p_red, *p_green, *p_blue;

  for (y = 0; y &lt; dst-&gt;height; ++y)
  {
    for (x = 0; x &lt; dst-&gt;width; ++x)
    {
      p_dst   = cvPtr2D (dst,   y, x, NULL);
      p_blue  = cvPtr2D (blue,  y, x, NULL);
      p_green = cvPtr2D (green, y, x, NULL);
      p_red   = cvPtr2D (red,   y, x, NULL);

      *p_dst       = *p_blue;
      *(p_dst + 1) = *p_green;
      *(p_dst + 2) = *p_red;
    }
  }
}

/** 
 * usage: IMG B G R
 * - IMG: image dont les canaux sont à séparer
 * - B:   sortie du canal bleu
 * - G:           &quot;       vert
 * - R:           &quot;       rouge
 */
int main (int argc, char* argv[])
{
  int i;

  const char* rgb_path;
  const char* c_path[3];

  IplImage* rgb;
  IplImage* black;
  IplImage* chans[3];
  IplImage* tmp;

  if (argc != 5)
  {
    fprintf(stderr, &quot;usage: %s IMG B G R\n&quot;, argv[0]);
    return EXIT_FAILURE;
  }

  rgb_path = argv[1];

  if (!(rgb = cvLoadImage (rgb_path, CV_LOAD_IMAGE_COLOR)))
  {
    fprintf (stderr, &quot;couldn't open image file: %s\n&quot;, rgb_path);
    return EXIT_FAILURE;
  }
  
  /* Initialisation des images de travail */
  black = cvCreateImage (cvGetSize (rgb), IPL_DEPTH_8U, 1);
  tmp = cvCreateImage (cvGetSize (rgb), IPL_DEPTH_8U, 3);
  cvSetZero (black);

  for (i = 0; i &lt; 3; ++i)
  {
    c_path[i] = argv[2+i];
    chans[i] = cvCreateImage (cvGetSize (rgb), rgb-&gt;depth, 1); 
  }

  /* Séparation des canaux */
  my_split (rgb, chans[0], chans[1], chans[2]);

  /* Reconstruction dans des images couleur */
  my_merge     (chans[0], black, black, tmp);
  cvSaveImage (c_path[0], tmp, NULL);
  my_merge     (black, chans[1], black, tmp);
  cvSaveImage (c_path[1], tmp, NULL);
  my_merge     (black, black, chans[2], tmp);
  cvSaveImage (c_path[2], tmp, NULL);

  /* Libération de la mémoire */
  for (i = 0; i &lt; 3; ++i)
  {
    cvReleaseImage (chans + i);
  }
  cvReleaseImage (&amp;black);
  cvReleaseImage (&amp;tmp);
  cvReleaseImage (&amp;rgb);

  return EXIT_SUCCESS;
}</code></pre></div><p id="r-209393" data-claire-element-id="209393">Nous en avons maintenant terminé avec les notions de base sur les images. Maintenant que vous savez comment travailler avec, que ce soit en maths ou dans vos programmes, vous pouvez commencer à lire les parties de ce cours ayant trait au traitement d'image.</p><p id="r-209394" data-claire-element-id="209394">Cette partie n'est pas encore terminée. D'autres chapitres viendront l'enrichir au fur et à mesure. Néanmoins, avec les chapitres déjà présents, vous pouvez déjà suivre la suite de ce cours.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
<span class="arrow"></span>
<span class="next">Travailler avec des images en couleur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">
<span class="next">Étirement et égalisation d&#039;histogramme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="tirementetgalisationd039histogramme"></a><h2>Étirement et égalisation d&#039;histogramme</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
<span class="arrow"></span>
<span class="next">Exercices</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
<span class="next">Histogramme d&#039;une image</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-209401" data-claire-element-id="209401">Dans ce chapitre, nous allons nous intéresser à ce que l'on appelle l'<em>histogramme</em> d'une image.</p><p id="r-209402" data-claire-element-id="209402">Nous découvrirons aussi deux algorithmes permettant d'améliorer automatiquement la qualité d'une image en intervenant sur la distribution de ses pixels.</p>
</div><a name="Histogrammed039uneimage"></a><h2>Histogramme d&#039;une image</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">
<span class="arrow"></span>
<span class="next">Étirement et égalisation d&#039;histogramme</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
<span class="next">Normalisation d&#039;une image</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-histogramme-d-une-image" data-claire-element-id="209459">Histogramme d'une image</h4><h5 id="r-des-statistiques-au-traitement-d-image" data-claire-element-id="209406">Des statistiques au traitement d'image</h5><p id="r-209403" data-claire-element-id="209403">Comme je vous l'ai dit dans le chapitre « <a href="http://www.siteduzero.com/tutoriel-3-563433-qu-est-ce-qu-une-image.html">Qu'est-ce qu'une image ?</a> », on peut définir une image comme <em>une fonction dont on ignore la formule, mais dont on peut observer le résultat sur un ensemble de valeurs donné</em> (en l'occurrence, un plan). Il existe une branche des mathématiques qui porte sur l'étude de ce genre de fonctions « boîtes noires », et que vous avez probablement déjà abordée (mais pas forcément sous cet angle-là) : <strong>les statistiques</strong>.</p><p id="r-209404" data-claire-element-id="209404">En effet, lorsque l'on fait des statistiques d'un point de vue formel (en général, cela va de pair avec les probabilités), on modélise les phénomènes que l'on étudie par des fonctions dont on ne peut qu'observer le résultat, en leur donnant le nom de <em>variables aléatoires</em>. Le but du jeu est d'extraire des informations de ces variables en observant des données qui décrivent leur comportement.</p><p id="r-209405" data-claire-element-id="209405">Rassurez-vous cependant, cela ne signifie pas que nous allons faire des probabilités ni des statistiques dans ce chapitre ; cette remarque sur l'analogie entre les images et les variables aléatoires est surtout là pour vous expliquer qu'il est possible (et même relativement courant) d'employer des notions et des outils provenant des statistiques en traitement d'image. <strong>L'histogramme</strong> est un de ces outils.</p><h5 id="r-histogramme-et-histogramme-cumule" data-claire-element-id="209450">Histogramme et histogramme cumulé</h5><h6 id="r-histogramme" data-claire-element-id="209429">Histogramme</h6><p id="r-209407" data-claire-element-id="209407">En statistiques, l'histogramme est un graphique que l'on utilise pour observer la répartition des valeurs que prend une variable aléatoire. En ce qui nous concerne, nous allons l'utiliser pour observer la répartition des valeurs que prennent les pixels d'une image.</p><p id="r-209408" data-claire-element-id="209408">Concrêtement sur une image mono-canal 8 bits, cela signifie que nous allons <em>compter</em>, pour chaque niveau de gris i compris entre 0 et 255, le nombre de pixels qui portent la valeur i. On notera ce nombre h_i. On pourra ensuite représenter cet histogramme par un diagramme en bâtons, qui prend en abscisse les valeurs de i (de 0 à 255, donc), et en ordonnée les h_i correspondants.</p><p id="r-209409" data-claire-element-id="209409">Par exemple, pour l'image de Lena inversée en niveaux de gris :</p><p id="r-209410" data-claire-element-id="209411"><a href="medias/uploads.siteduzero.com_files_346001_347000_346863.jpg"><img id="r-209411" data-claire-element-id="209410" src="medias/uploads.siteduzero.com_thb_346001_347000_346863.jpg" alt="Image utilisateur"/></a></p><p id="r-209412" data-claire-element-id="209412">Nous obtenons l'histogramme suivant :</p><figure id="r-209414" data-claire-element-id="209415"><img id="r-209413" data-claire-element-id="209413" src="medias/uploads.siteduzero.com_files_346001_347000_346864.png" alt="Image utilisateur"/></figure><p id="r-209416" data-claire-element-id="209416">Alors que pour l'image suivante, qui est très sombre (ce à quoi nous allons remédier dans la suite de ce chapitre…) :</p><figure id="r-209418" data-claire-element-id="209419"><img id="r-209417" data-claire-element-id="209417" src="medias/uploads.siteduzero.com_files_346001_347000_346867.png" alt="Image utilisateur"/></figure><p id="r-209420" data-claire-element-id="209420">Nous obtenons un histogramme « ratatiné » vers la gauche, c'est-à-dire vers les niveaux de gris les plus proches du noir :</p><figure id="r-209422" data-claire-element-id="209423"><img id="r-209421" data-claire-element-id="209421" src="medias/uploads.siteduzero.com_files_346001_347000_346866.png" alt="Image utilisateur"/></figure><p id="r-209424" data-claire-element-id="209424">Ce diagramme fait donc clairement apparaître la façon dont sont répartis les niveaux de gris dans l'image.</p><p id="r-209425" data-claire-element-id="209425">Bien sûr, on peut aussi dessiner l'histogramme d'une image en couleur, en superposant les histogrammes ses canaux. Par exemple, pour Lena :</p><figure id="r-209427" data-claire-element-id="209428"><img id="r-209426" data-claire-element-id="209426" src="medias/uploads.siteduzero.com_files_346001_347000_346871.png" alt="Image utilisateur"/></figure><h6 id="r-histogramme-cumule" data-claire-element-id="209449">Histogramme cumulé</h6><p id="r-209430" data-claire-element-id="209430">En plus de l'histogramme classique, il peut être intéressant dans certains cas de travailler sur l'histogramme <em>cumulé</em>. Ce dernier s'obtient en associant à chaque niveau de gris i le nombre h_i^c de pixels de l'image qui ont une valeur inférieure ou égale à i. En quelque sorte, cela revient à calculer l'histogramme de l'image et d'associer à chaque niveau i la somme des h_j pour j \leq i.</p><p id="r-209431" data-claire-element-id="209431">En formule, cela donne :</p><p id="r-209432" data-claire-element-id="209432">h_i^c = \sum_{0 \leq j \leq i}{h_j} = h_0 + h_1 + \cdots + h_i</p><p id="r-209433" data-claire-element-id="209433">Sur l'image de lena inversée, cela donne une courbe dont l'allure ressemble à ceci :</p><figure id="r-209435" data-claire-element-id="209436"><img id="r-209434" data-claire-element-id="209434" src="medias/uploads.siteduzero.com_files_346001_347000_346877.png" alt="Image utilisateur"/></figure><p id="r-209437" data-claire-element-id="209437">Et sur l'image très sombre :</p><figure id="r-209439" data-claire-element-id="209440"><img id="r-209438" data-claire-element-id="209438" src="medias/uploads.siteduzero.com_files_346001_347000_346879.png" alt="Image utilisateur"/></figure><p id="r-209441" data-claire-element-id="209441">Comme vous le voyez, la courbe grimpe ici très vite vers les 100%, alors que sur une image plus « regardable », sa pente est plus régulièrement croissante.</p><p id="r-209442" data-claire-element-id="209442">Enfin, voici l'histogramme cumulé de Lena en couleur :</p><figure id="r-209444" data-claire-element-id="209445"><img id="r-209443" data-claire-element-id="209443" src="medias/uploads.siteduzero.com_files_346001_347000_346878.png" alt="Image utilisateur"/></figure><p id="r-209446" data-claire-element-id="209446">L'avantage de cet histogramme cumulé est qu'il permet de calculer très facilement le nombre de pixels ayant une valeur comprise entre deux niveaux de gris donnés a et b : il suffit pour cela de calculer la différence h_b^c - h_a^c . <br/> En mathématiques, cela revient à calculer <strong>l'intégrale</strong> de l'histogramme entre les points a et b ; c'est la raison pour laquelle l'histogramme cumulé s'appelle aussi « <em>histogramme intégral</em> ».</p><aside id="r-209448" data-claire-element-id="209448" data-claire-semantic="information"><p id="r-209447" data-claire-element-id="209447">Si vous n'avez jamais étudié le calcul intégral en mathématiques, vous pouvez vous empresser d'oublier cette dernière remarque, car celle-ci est bien au-delà du cadre de ce chapitre.</p></aside><h5 id="r-calcul-d-un-histogramme" data-claire-element-id="209458">Calcul d'un histogramme</h5><p id="r-209451" data-claire-element-id="209451">Afin de bien faire rentrer les notions d'histogramme et d'histogramme cumulé, créons une petite fonction chargée de calculer l'histogramme d'une image en niveaux de gris 8 bits.</p><pre id="r-209452" data-claire-element-id="209452"><code data-claire-semantic="c">/**
 * Calcule l'histogramme d'une image en niveaux de gris 8 bits
 * arguments:
 * - img: image dont on calcule l'histogramme
 * - bins: tableau destiné à contenir l'histogramme
 * - cumul: 1 pour l'histogramme cumulé, 0 sinon
 * retourne:
 * la valeur maximale de l'histogramme
 */
long compute_hist_8U (const IplImage* img, long* bins, int cumul);</code></pre><p id="r-209453" data-claire-element-id="209453">Cette fonction attend en second argument un tableau qui est déjà alloué, par exemple de la façon suivante :</p><pre id="r-209454" data-claire-element-id="209454"><code data-claire-semantic="c">long bins[256];</code></pre><p id="r-209455" data-claire-element-id="209455">En voici le code :</p><pre id="r-209456" data-claire-element-id="209456"><code data-claire-semantic="c">#include &lt;strings.h&gt;
#include &lt;opencv/cv.h&gt;

long compute_hist_8U (const IplImage* img, long* bins, int cumul)
{
  uchar *p, *line;
  long* b;
  long max = 0;
  
  assert (img-&gt;nChannels == 1);
  assert (img-&gt;depth == IPL_DEPTH_8U);
  
  /* initialisation du tableau &quot;bins&quot; */
  memset (bins, 0, 256 * sizeof(long));
  
  /* calcul de l'histogramme et de sa valeur maximale */
  for (line = (uchar*) img-&gt;imageData;
       line &lt; (uchar*) img-&gt;imageData + img-&gt;imageSize;
       line += img-&gt;widthStep)
  {
    for (p = line; p &lt; line + img-&gt;width; ++p)
    {
      /* Pour chaque pixel, on incrémente le compteur 
       * correspondant à son niveau de gris.
       * On met à jour la variable &quot;max&quot; si besoin.
       */
      if (++bins[*p] &gt; max)
      {
        max = bins[*p];
      }
    }
  }

  /* calcul de l'histogramme cumulé */
  if (cumul)
  {
    for (b = bins; b &lt; bins + 255; ++b)
    {
      *(b+1) += *b;
    }
  }
  /* la valeur max d'un histogramme cumulé est nécessairement 
   * la dernière.
   */
  return (cumul ? bins[255] : max);
}</code></pre><p id="r-209457" data-claire-element-id="209457">Nous nous servirons de cette fonction lorsque nous implémenterons l'égalisation d'histogrammes.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">
<span class="arrow"></span>
<span class="next">Étirement et égalisation d&#039;histogramme</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
<span class="next">Normalisation d&#039;une image</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Normalisationd039uneimage"></a><h2>Normalisation d&#039;une image</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
<span class="arrow"></span>
<span class="next">Histogramme d&#039;une image</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
<span class="next">Égalisation d&#039;histogramme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-normalisation-d-une-image" data-claire-element-id="209518">Normalisation d'une image</h4><p id="r-209460" data-claire-element-id="209460">Il arrive que certaines images réelles soient trop sombres ou trop claires, un petit peu comme la suivante dans un cas extrême :</p><figure id="r-209462" data-claire-element-id="209463"><img id="r-209461" data-claire-element-id="209461" src="medias/uploads.siteduzero.com_files_346001_347000_346867.png" alt="Image utilisateur"/></figure><p id="r-209464" data-claire-element-id="209464">Comme je vous l'ai montré un peu plus haut, l'histogramme de cette image se retrouve tout aplati dans la zone des valeurs sombres :</p><figure id="r-209466" data-claire-element-id="209467"><img id="r-209465" data-claire-element-id="209465" src="medias/uploads.siteduzero.com_files_346001_347000_346866.png" alt="Image utilisateur"/></figure><p id="r-209468" data-claire-element-id="209468">Cela s'explique par le fait que dans cette image, les niveaux de gris n'occupent pas tout l'intervalle des valeurs qu'ils peuvent prendre. Au lieu de ça, ils sont tous compris entre deux valeurs \mathrm{min} et \mathrm{max} telles que 0 \leq \mathrm{min} &lt; \mathrm{max} &lt; 256.</p><p id="r-209469" data-claire-element-id="209469">Pour remédier à cela, on peut simplement essayer de <em>normaliser</em> cette image, c'est-à-dire ajuster l'échelle de ses niveaux de gris de façon qu'elle occupe tout l'intervalle disponible. Pour faire simple, il s'agit d'appliquer une <em>règle de trois</em> aux pixels de l'image, qui sont tous compris dans l'intervalle \left[\mathrm{min}, \mathrm{max} ight], pour les ajuster à l'intervalle \left[0,255 ight].</p><p id="r-209470" data-claire-element-id="209470">Cette règle de proportionnalité est donnée par la formule suivante :</p><p id="r-209471" data-claire-element-id="209471">\mathrm{dst}(x,y) = \dfrac{\left(\mathrm{src}(x,y) - \mathrm{min} ight) imes 255}{\left(\mathrm{max} - \mathrm{min} ight)}</p><p id="r-209472" data-claire-element-id="209472">Si l'on applique mentalement les opérations dans l'ordre, on se rend compte que ce traitement commence par ramener toutes les valeurs de l'intervalle \left[\mathrm{min}, \mathrm{max} ight] vers l'intervalle \left[0, \mathrm{max}-\mathrm{min} ight], puis qu'il étend ces valeurs à \left[0,255 ight].</p><h6 id="r-implementation-manuelle" data-claire-element-id="209490">Implémentation manuelle</h6><p id="r-209473" data-claire-element-id="209473">Essayons d'implémenter ce traitement nous-mêmes, pour une image en niveaux de gris. Il semble évident que l'algorithme comporte deux étapes :</p><ul id="r-209478" data-claire-element-id="209478"><li id="r-209475" data-claire-element-id="209475"><p id="r-209474" data-claire-element-id="209474">D'abord on détermine les valeurs \mathrm{min} et \mathrm{max} des niveaux de gris de l'image ;</p></li><li id="r-209477" data-claire-element-id="209477"><p id="r-209476" data-claire-element-id="209476">Ensuite, on applique la formule que nous venons de voir.</p></li></ul><p id="r-209479" data-claire-element-id="209479">Bien qu'OpenCV contienne déjà ces deux fonctions, voici comment l'on pourrait réaliser tout cela « manuellement » :</p><pre id="r-209480" data-claire-element-id="209480"><code data-claire-semantic="c">void normalize_manual (IplImage* img)
{
  double scale;
  uchar min = 255, max = 0;
  uchar *p, *line;

  assert (img-&gt;depth == IPL_DEPTH_8U);
  assert (img-&gt;nChannels == 1);

  /**
   * Recherche des valeurs min et max,
   * et calcul du facteur d'échelle 
   */
  for (line = (uchar*) img-&gt;imageData;
       line &lt; (uchar*) img-&gt;imageData + img-&gt;imageSize;
       line += img-&gt;widthStep)
  {
    for (p = line; p &lt; line + img-&gt;width; ++p)
    {
      if (*p &lt; min) min = *p;
      if (*p &gt; max) max = *p;
    }
  }

  scale = 255.0 / (max - min);

  /**
   * Normalisation des niveaux de gris
   */
  for (p = (uchar*) img-&gt;imageData;
       p &lt; (uchar*) img-&gt;imageData + img-&gt;imageSize;
       ++p)
  {
    *p -= min;
    *p *= scale;
  }
}</code></pre><p id="r-209481" data-claire-element-id="209481">Voici le résultat que vous devriez obtenir :</p><figure id="r-209483" data-claire-element-id="209484"><img id="r-209482" data-claire-element-id="209482" src="medias/uploads.siteduzero.com_files_352001_353000_352119.png" alt="Image utilisateur"/></figure><p id="r-209485" data-claire-element-id="209485">Et voici son histogramme :</p><figure id="r-209487" data-claire-element-id="209488"><img id="r-209486" data-claire-element-id="209486" src="medias/uploads.siteduzero.com_files_352001_353000_352118.png" alt="Image utilisateur"/></figure><p id="r-209489" data-claire-element-id="209489">Je suppose que vous comprenez maintenant pourquoi la normalisation d'une image s'appelle aussi « étirement d'histogramme ». ;)</p><h6 id="r-utilisons-opencv" data-claire-element-id="209517">Utilisons OpenCV</h6><p id="r-209491" data-claire-element-id="209491">Bien que la précédente fonction soit en elle-même assez simple, il est bon d'avoir le réflexe de se demander systématiquement si les opérations de base que nous réalisons ne sont pas déjà implémentées par OpenCV. Ici, la réponse est bien évidemment « oui ».</p><p id="r-209492" data-claire-element-id="209492">Pour rechercher les valeurs minimales et maximales des niveaux de gris d'une image, OpenCV nous propose la fonction <a href="null.html">cvMinMaxLoc</a> :</p><pre id="r-209493" data-claire-element-id="209493"><code data-claire-semantic="c">/**
 * Recherche des niveaux de gris min et max d'une image.
 * Arguments:
 * - arr : l'image
 * - minVal : pointeur sur la valeur min
 * - maxVal : pointeur sur la valeur max
 * - minLoc : pointeur sur le premier point de l'image de valeur min
 * - maxLoc : pointeur sur le premier point de l'image de valeur max
 * - mask :   masque optionnel déterminant la zone de l'image,
 *            où effectuer la recherche
 */
void cvMinMaxLoc (const CvArr* arr, double* minVal, double* maxVal, 
                  CvPoint* minLoc, CvPoint* maxLoc, const CvArr* mask);</code></pre><p id="r-209494" data-claire-element-id="209494">Les trois derniers arguments de cette fonction sont optionnels. Dans notre cas, nous pourrons les laisser à <code data-claire-semantic="c">NULL</code>.</p><p id="r-209495" data-claire-element-id="209495">Ainsi, nous pouvons remplacer la première boucle de notre fonction par ceci :</p><pre id="r-209496" data-claire-element-id="209496"><code data-claire-semantic="c">double min, max;
cvMinMaxLoc (img, &amp;min, &amp;max, NULL, NULL, NULL);</code></pre><p id="r-209497" data-claire-element-id="209497">Pour l'application d'un facteur d'échelle, nous avons à notre disposition la fonction suivante :</p><pre id="r-209498" data-claire-element-id="209498"><code data-claire-semantic="c">/**
 * Changement d'échelle d'une image selon la formule :
 * dst(x,y) = alpha * src(x,y) + beta
 *
 * arguments :
 * - src : image source
 * - dst : image destination
 * - alpha, beta : paramètres de la formule
 */
void cvScale (CvArr* src, CvArr* dst, double alpha, double beta);</code></pre><p id="r-209499" data-claire-element-id="209499">Pour utiliser cette fonction dans notre cas, nous allons avoir besoin de modifier notre formule, de manière à déterminer les paramètres <code>alpha</code> et <code>beta</code>, comme ceci :</p><p id="r-209500" data-claire-element-id="209500">\begin{align}\mathrm{dst}(x,y) &amp;= \dfrac{\left(\mathrm{src}(x,y) - \mathrm{min} ight) imes 255}{\left(\mathrm{max} - \mathrm{min} ight)} \\&amp;= \mathrm{src}(x,y) imes \underbrace{\left(\dfrac{255}{\mathrm{max} - \mathrm{min}} ight)}_{\alpha} - \mathrm{min} imes \left(\dfrac{255}{\mathrm{max} - \mathrm{min}} ight)\\&amp;= \mathrm{src}(x,y) imes \alpha + \underbrace{\left(- \mathrm{min} ight) imes \alpha}_{\beta}\\&amp;= \alpha imes \mathrm{src}(x,y) + \beta\;,\end{align}</p><p id="r-209501" data-claire-element-id="209501">d'où les valeurs :</p><p id="r-209502" data-claire-element-id="209502">\begin{align}\alpha &amp;= \dfrac{255}{\mathrm{max} - \mathrm{min}}\;,\\\beta &amp;= \left(- \mathrm{min} ight) imes \alpha\;.\end{align}</p><p id="r-209503" data-claire-element-id="209503">Cela nous amène à la fonction complète suivante :</p><pre id="r-209504" data-claire-element-id="209504"><code data-claire-semantic="c">void normalize_gray (IplImage* img)
{
  double min, max, alpha, beta;

  assert (img-&gt;depth == IPL_DEPTH_8U);
  assert (img-&gt;nChannels == 1);

  cvMinMaxLoc (img, &amp;min, &amp;max, NULL, NULL, NULL);

  alpha = 255.0 / (max - min);
  beta  = -min * alpha;
  cvScale (img, img, alpha, beta);
}</code></pre><p id="r-209505" data-claire-element-id="209505">Comme vous vous en doutez, on peut généraliser ce traitement à des images en couleurs, en appliquant la méthode <em>split &amp; merge</em>. Je vous laisse le soin d'implémenter ce traitement à titre d'exercice.</p><p id="r-209506" data-claire-element-id="209506">Voici le résultat sur lena (avant/après) :</p><p id="r-209507" data-claire-element-id="209509"><a href="medias/uploads.siteduzero.com_files_345001_346000_345136.jpg"><img id="r-209508" data-claire-element-id="209507" src="medias/uploads.siteduzero.com_thb_345001_346000_345136.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_352001_353000_352133.png"><img id="r-209509" data-claire-element-id="209508" src="medias/uploads.siteduzero.com_thb_352001_353000_352133.png" alt="Image utilisateur"/></a></p><p id="r-209510" data-claire-element-id="209510">Ainsi que les histogrammes associés :</p><figure id="r-209512" data-claire-element-id="209513"><img id="r-209511" data-claire-element-id="209511" src="medias/uploads.siteduzero.com_files_346001_347000_346871.png" alt="Image utilisateur"/></figure><figure id="r-209515" data-claire-element-id="209516"><img id="r-209514" data-claire-element-id="209514" src="medias/uploads.siteduzero.com_files_352001_353000_352134.png" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
<span class="arrow"></span>
<span class="next">Histogramme d&#039;une image</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
<span class="next">Égalisation d&#039;histogramme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="galisationd039histogramme"></a><h2>Égalisation d&#039;histogramme</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
<span class="arrow"></span>
<span class="next">Normalisation d&#039;une image</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-egalisation-d-histogramme" data-claire-element-id="209556">Égalisation d'histogramme</h4><p id="r-209519" data-claire-element-id="209519">Il peut arriver que les pixels une image, bien qu'occupant tout l'espace de valeurs disponible entre 0 et 255, soient « agglutinés », c'est-à-dire que l'histogramme n'est pas uniforme. C'est le cas, par exemple, sur les photographies en contre-jour comme la suivante :</p><figure id="r-209521" data-claire-element-id="209522"><img id="r-209520" data-claire-element-id="209520" src="medias/uploads.siteduzero.com_files_352001_353000_352137.png" alt="Image utilisateur"/></figure><p id="r-209523" data-claire-element-id="209523">Ce qui saute très vite aux yeux, c'est que cette image contient beaucoup de pixels très sombres ou très clairs, et relativement peu de pixels d'une luminosité « moyenne ». Voici l'histogramme et l'histogramme cumulé de cette photographie :</p><figure id="r-209525" data-claire-element-id="209526"><img id="r-209524" data-claire-element-id="209524" src="medias/uploads.siteduzero.com_files_352001_353000_352138.png" alt="Image utilisateur"/></figure><figure id="r-209528" data-claire-element-id="209529"><img id="r-209527" data-claire-element-id="209527" src="medias/uploads.siteduzero.com_files_352001_353000_352139.png" alt="Image utilisateur"/></figure><p id="r-209530" data-claire-element-id="209530">Comme vous le constatez, tout l'espace de valeurs disponible est déjà utilisé, la normalisation n'aurait donc strictement aucun effet sur cette image. C'est ici qu'entre en jeu l'égalisation d'histogramme, dont le but est d'uniformiser la distribution des valeurs des pixels, c'est-à-dire obtenir une image qui contient à peu près autant de pixels très sombres que de pixels moyens que de pixels très clairs, et dont l'histogramme cumulé ressemblerait à quelque chose comme ceci :</p><figure id="r-209532" data-claire-element-id="209533"><img id="r-209531" data-claire-element-id="209531" src="medias/uploads.siteduzero.com_files_352001_353000_352140.png" alt="Image utilisateur"/></figure><p id="r-209534" data-claire-element-id="209534">Pour ce faire, nous allons <em>rétro-projeter</em> l'histogramme cumulé de l'image originale. Ce terme peut vous sembler barbare, mais vous allez voir qu'il cache en réalité une astuce assez magique, résumée par la formule suivante :</p><p id="r-209535" data-claire-element-id="209535">\mathrm{dst}(x,y) = h_{\mathrm{src}(x,y)}^c</p><h6 id="r-algorithme-d-egalisation" data-claire-element-id="209555">Algorithme d'égalisation</h6><p id="r-209536" data-claire-element-id="209536">Pour égaliser l'histogramme d'une image, nous commençons par calculer l'histogramme cumulé de cette image, et nous normalisons ses valeurs entre 0 et 255.</p><p id="r-209537" data-claire-element-id="209537">Ensuite vient la phase de rétro-projection. Pour chaque pixel de l'image, on récupère la valeur que l'histogramme cumulé associe avec niveau de gris qu'il porte. En temps normal, l'histogramme cumulé devrait contenir le nombre (ou le pourcentage) de pixels de l'image qui sont plus sombres que lui. Ici, il nous donnera un rang, compris entre 0 et 255, par lequel on remplacera le pixel.</p><p id="r-209538" data-claire-element-id="209538">Par exemple, si 60% des pixels de l'image sont plus sombres que le niveau de gris 40 (ce qui signifie que l'image contient beaucoup de pixels sombres), on remplacera tous les pixels portant le niveau 40 par h_{40}^c = 0.6 imes 255 = 153. Cela aura pour effet de rehausser le contraste dans les zones très sombres de l'image.</p><p id="r-209539" data-claire-element-id="209539">Voici une implémentation de cet algorithme :</p><pre id="r-209540" data-claire-element-id="209540"><code data-claire-semantic="c">void equalize_gray (IplImage* img)
{
  long bins[256];
  double ratio;
  uchar* p;

  assert (img-&gt;nChannels == 1);
  assert (img-&gt;depth == IPL_DEPTH_8U);

  ratio = 255.0 / (img-&gt;height * img-&gt;width);
  
  /* calcul de l'histogramme cumulé */
  compute_hist_8U (img, bins, 1);

  /* rétro-projection de l'histogramme sur l'image */
  for (p = (uchar*) img-&gt;imageData;
       p &lt; (uchar*) img-&gt;imageData + img-&gt;imageSize;
       ++p)
  {
    *p = bins[*p] * ratio;
  }
}</code></pre><p id="r-209541" data-claire-element-id="209541">Et voici maintenant le résultat sur la photo précédente :</p><figure id="r-209543" data-claire-element-id="209544"><img id="r-209542" data-claire-element-id="209542" src="medias/uploads.siteduzero.com_files_352001_353000_352141.png" alt="Image utilisateur"/></figure><p id="r-209545" data-claire-element-id="209545">Comme vous le constatez, l'égalisation d'histogramme fait apparaître beaucoup de détails qui étaient invisibles à l'œil nu dans les zones les plus sombres de l'image, comme le morceau de forêt à gauche et son reflet dans l'eau. Ces détails figuraient déjà sur l'image d'origine, mais la très forte luminosité du reste de la scène a poussé le mécanisme de balance des blancs de l'appareil à attribuer à ces pixels des valeurs bien plus faibles que la normale.</p><p id="r-209546" data-claire-element-id="209546">À droite de l'image, en revanche, beaucoup moins de détails sont apparus, laissant la place à du <em>bruit</em>. Typiquement, cela est dû aux rayons du soleil qui ont frappé le capteur plus directement à cet endroit, « éblouissant » ainsi les cellules photosensibles.</p><p id="r-209547" data-claire-element-id="209547">Pas de miracle, donc. Cet algorithme tout simple ne fait apparaître que des détails déjà captés par l'appareil lors de la prise de vue, et ne peut naturellement pas remplacer un capteur de bonne qualité. ;)</p><p id="r-209548" data-claire-element-id="209548">Comme pour la normalisation, je vous laisse à titre d'exercice le soin d'implémenter une fonction d'égalisation sur des images en couleur. Vous pourrez utiliser la fonction suivante d'OpenCV :</p><pre id="r-209549" data-claire-element-id="209549"><code data-claire-semantic="c">/**
 * Égalisation de l'histogramme d'une image en niveaux de gris.
 */
cvEqualizeHist(CvArr* src, CvArr* dst);</code></pre><p id="r-209550" data-claire-element-id="209550">Vous pourrez ainsi vous amuser à égaliser toutes les images qui vous passent à portée de main, et faire apparaître de façon horriblement visible les défauts de la compression jpeg. :D</p><p id="r-209551" data-claire-element-id="209551">Nous venons de découvrir deux traitements destinés à faire apparaître des détails sur la plupart des images naturelles. Comme vous avez pu vous en rendre compte sur les exemples que j'ai utilisés dans ce chapitre, il n'y a malheureusement pas que les détails intéressants qui deviennent visibles, mais aussi beaucoup de <em>bruit</em>.</p><p id="r-209552" data-claire-element-id="209552">C'est la raison pour laquelle nous allons découvrir, dans les prochains chapitres de cette partie, plusieurs méthodes de « filtrage » permettant d'éliminer au mieux le bruit des images.</p><p id="r-209553" data-claire-element-id="209553">Ce tutoriel est en cours d'écriture.</p><p id="r-209554" data-claire-element-id="209554">Vous pouvez suivre l'avancement de la rédaction et discuter des chapitres à venir dans le <a href="http://www.siteduzero.com/forum-83-703430-p1-beta-on-introduction-a-la-vision-par-ordinateur.html#r6794253">topic dédié sur le forum</a>.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur">Introduction à la vision par ordinateur</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Notions de base
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/avant-de-commencer-8">Avant de commencer…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/cadre-et-portee-de-ce-cours">
Cadre et portée de ce cours
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/presentation-d-opencv">
Présentation d&#039;OpenCV
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/installer-et-configurer-opencv">
Installer et configurer OpenCV
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/premiers-pas-9">Premiers pas</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/hello-world-2">
Hello, world!
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/charger-et-sauvegarder-des-images">
Charger et sauvegarder des images
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/une-interface-simple-mais-pratique">
Une interface simple, mais pratique
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/qu-est-ce-qu-une-image">Qu&#039;est-ce qu&#039;une image ?</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-formelle">
Représentation formelle
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/la-structure-iplimage">
La structure IplImage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/parcourir-une-image">
Parcourir une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-15">
Exercices
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/un-nouveau-monde-en-couleurs">Un nouveau monde en couleurs…</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/representation-theorique-des-couleurs">
Représentation théorique des couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/travailler-avec-des-images-en-couleur">
Travailler avec des images en couleur
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/exercices-16">
Exercices
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Traitement d&#039;image
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/etirement-et-egalisation-d-histogramme">Étirement et égalisation d&#039;histogramme</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/histogramme-d-une-image">
Histogramme d&#039;une image
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
Normalisation d&#039;une image
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/egalisation-d-histogramme">
Égalisation d&#039;histogramme
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/introduction-a-la-vision-par-ordinateur/normalisation-d-une-image">
<span class="arrow"></span>
<span class="next">Normalisation d&#039;une image</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/introduction-a-la-vision-par-ordinateur.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:29:19 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/introduction-a-la-vision-par-ordinateur.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:31:31 GMT -->
</html>