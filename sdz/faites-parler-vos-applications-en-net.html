<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/faites-parler-vos-applications-en-net.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:50:50 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/faites-parler-vos-applications-en-net.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:08 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Faites parler vos applications en .NET</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/faites-parler-vos-applications-en-net.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Faites parler vos applications en .NET</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Faitesparlervosapplicationsen.NET">Faites parler vos applications en .NET</a><br/><a href="#Enavantmoussaillon">En avant moussaillon</a><br/><a href="#Crationdel039interface">Création de l&#039;interface</a><br/><a href="#Coderlaparoledevotreapplication">Coder la parole de votre application</a><br/><a href="#Encoreplusloin">Encore plus loin</a><br/></div>
<a name="Faitesparlervosapplicationsen.NET"></a><h2>Faites parler vos applications en .NET</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
<span class="next">En avant moussaillon</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-576219" data-claire-element-id="576219">Peut-être pensiez vous que votre application ne pouvait pas communiquer d'une façon autre que par le texte ? Ce temps est révolu ! Dès maintenant, vous pouvez aisément convertir un texte en voix synthétique.<br/> Cette technologie s'appelle Text-to-Speech soit en français « texte à la parole ».</p><p id="r-576220" data-claire-element-id="576220">Dans ce tutoriel, nous verrons comment utiliser cette méthode dans deux langages .NET à savoir :</p><ul id="r-576225" data-claire-element-id="576225"><li id="r-576222" data-claire-element-id="576222"><p id="r-576221" data-claire-element-id="576221">le C#;</p></li><li id="r-576224" data-claire-element-id="576224"><p id="r-576223" data-claire-element-id="576223">le VB.NET.</p></li></ul><p id="r-576226" data-claire-element-id="576226">À la fin de ce tutoriel, vous saurez faire communiquer votre application avec l'utilisateur via une voix de synthèse française.</p>
</div><a name="Enavantmoussaillon"></a><h2>En avant moussaillon</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
<span class="next">Création de l&#039;interface</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<aside id="r-576228" data-claire-element-id="576228" data-claire-semantic="warning"><p id="r-576227" data-claire-element-id="576227">Ce tutoriel utilise le VB.NET ainsi que le C#, il est vivement recommandé de connaître au moins l'un de ces deux langages de programmation.</p></aside><p id="r-576229" data-claire-element-id="576229">Si vous ne maîtrisez aucun de ces deux langages de programmation, je vous renvoie aux tutoriels officiels correspondants :</p><p id="r-576230" data-claire-element-id="576230"></p><div id="r-576236" data-claire-element-id="576236"><ul id="r-576235" data-claire-element-id="576235"><li id="r-576232" data-claire-element-id="576232"><p id="r-576231" data-claire-element-id="576231"><a href="http://www.siteduzero.com/tutoriel-3-523498-apprenez-a-developper-en-c.html">apprendre le C#</a> ;</p></li><li id="r-576234" data-claire-element-id="576234"><p id="r-576233" data-claire-element-id="576233"><a href="http://www.siteduzero.com/tutoriel-3-134798-visual-basic-net.html">apprendre le VB.net</a>.</p></li></ul></div><p id="r-576237" data-claire-element-id="576237">Si vous suivez toujours, voici ma petite liste des prérequis :</p><aside id="r-576245" data-claire-element-id="576245" data-claire-semantic="information"><ul id="r-576244" data-claire-element-id="576244"><li id="r-576239" data-claire-element-id="576239"><p id="r-576238" data-claire-element-id="576238">une version de Visual Studio (<a href="http://msdn.microsoft.com/fr-fr/gg699324">Visual Studio Express</a> est gratuit) ;</p></li><li id="r-576241" data-claire-element-id="576241"><p id="r-576240" data-claire-element-id="576240">un ordinateur avec haut parleur ou tout autre sortie audio ;</p></li><li id="r-576243" data-claire-element-id="576243"><p id="r-576242" data-claire-element-id="576242">un petit supplément que l'on verra plus tard.</p></li></ul></aside><p id="r-576246" data-claire-element-id="576246">Comme je vous avais dit, un petit supplément fort agréable serait très utile pour nous. Sans vous faire attendre, emparons-nous de cet ajout.<br/> Si vous voulez que votre application parle en français, il va vous falloir une voix française, pour cela cliquez <a href="http://www.mediafire.com/?4603wo0w2dcw4nk">ici</a>, téléchargez et installez cette voix. Il s'agit de la voix française de Virginie qui est la voix française qui possède certainement la meilleure intonation et prononciation.</p><p id="r-576247" data-claire-element-id="576247">Maintenant que nous avons la voix française de Virginie, nous devons ajouter une référence à notre projet. Lancez votre logiciel préféré (oui , je parle bien de Visual Studio ;) ), puis créez un nouveau projet :</p><ul id="r-576260" data-claire-element-id="576260"><li id="r-576249" data-claire-element-id="576249"><p id="r-576248" data-claire-element-id="576248">Onglet <strong>Fichier</strong> ;</p></li><li id="r-576251" data-claire-element-id="576251"><p id="r-576250" data-claire-element-id="576250"><strong>Nouveau projet...</strong> ;</p></li><li id="r-576253" data-claire-element-id="576253"><p id="r-576252" data-claire-element-id="576252">Choisissez <strong>Visual Basic</strong> ou <strong>C#</strong> (selon votre préférence) ;</p></li><li id="r-576255" data-claire-element-id="576255"><p id="r-576254" data-claire-element-id="576254"><strong>Application Windows Forms</strong> ;</p></li><li id="r-576257" data-claire-element-id="576257"><p id="r-576256" data-claire-element-id="576256">Choisissez un nom ;</p></li><li id="r-576259" data-claire-element-id="576259"><p id="r-576258" data-claire-element-id="576258">Appuyez sur OK, mais vous devez normalement être assez grand pour savoir le faire... :D</p></li></ul><p id="r-576261" data-claire-element-id="576261">À présent, vous devriez être devant un Form vide, entièrement vide. Nous allons, comme convenu, ajouter une référence à notre projet pour pouvoir utiliser le <em>Text-to-Speech</em>.<br/> Cliquez sur l'onglet <strong>Projet</strong> puis choisissez <strong>Ajouter une référence ...</strong><br/> Une nouvelle fenêtre apparaît, celle-ci liste toutes les références disponibles. Sélectionnez l'onglet <strong>.NET</strong> et recherchez dans la liste ci-dessous le composant nommé <strong>System.Speech</strong>.</p><figure id="r-576263" data-claire-element-id="576264"><img id="r-576262" data-claire-element-id="576262" src="medias/uploads.siteduzero.com_files_390001_391000_390922.png" alt="Image utilisateur"/></figure><p id="r-576265" data-claire-element-id="576265">Vous êtes maintenant prêt à faire parler votre application !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net">Faites parler vos applications en .NET</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
En avant moussaillon
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
Création de l&#039;interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
Coder la parole de votre application
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/encore-plus-loin-2">
Encore plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
<span class="next">Création de l&#039;interface</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Crationdel039interface"></a><h2>Création de l&#039;interface</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
<span class="arrow"></span>
<span class="next">En avant moussaillon</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
<span class="next">Coder la parole de votre application</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<aside id="r-576268" data-claire-element-id="576268" data-claire-semantic="information"><p id="r-576267" data-claire-element-id="576267">Vous vous doutez bien que nous allons pas faire <strong>The interface</strong> mais juste une interface simple et complète. Ainsi, nous disposerons d'une zone de texte et des boutons d'actions.</p></aside><p id="r-576269" data-claire-element-id="576269">Commençons dès maintenant à créer la zone de texte où l'utilisateur éditera le texte, qui sera ensuite convertie en parole par l'application :</p><ul id="r-576276" data-claire-element-id="576276"><li id="r-576271" data-claire-element-id="576271"><p id="r-576270" data-claire-element-id="576270">ajoutez un <strong>RichTextBox</strong> ;</p></li><li id="r-576273" data-claire-element-id="576273"><p id="r-576272" data-claire-element-id="576272">changez son nom (propriété <strong>Name</strong>) en &quot;champtexte&quot; ;</p></li><li id="r-576275" data-claire-element-id="576275"><p id="r-576274" data-claire-element-id="576274">écrivez &quot;Ceci est un texte&quot; en texte (propriété <strong>Text</strong>) ;</p></li></ul><p id="r-576277" data-claire-element-id="576277">Voici le résultat, rien de bien trop compliqué :</p><figure id="r-576279" data-claire-element-id="576280"><img id="r-576278" data-claire-element-id="576278" src="medias/uploads.siteduzero.com_files_390001_391000_390923.png" alt="Image utilisateur"/></figure><p id="r-576281" data-claire-element-id="576281">Même si la zone de texte est très importante, il ne faut pas oublier les boutons, car ce sont eux qui vont nous permette d'effectuer des actions, et en l’occurrence, de lire le contenu de la zone de texte :</p><ul id="r-576288" data-claire-element-id="576288"><li id="r-576283" data-claire-element-id="576283"><p id="r-576282" data-claire-element-id="576282">ajoutez un bouton (<strong>Button</strong>) ;</p></li><li id="r-576285" data-claire-element-id="576285"><p id="r-576284" data-claire-element-id="576284">changez son nom (propriété <strong>Name</strong>) en <strong>lecture</strong> ;</p></li><li id="r-576287" data-claire-element-id="576287"><p id="r-576286" data-claire-element-id="576286">écrivez &quot;Lecture synchrone&quot; (nous verrons pourquoi plus tard) en texte (Propriété <strong>text</strong>).</p></li></ul><p id="r-576289" data-claire-element-id="576289">Voici le résultat final :</p><figure id="r-576291" data-claire-element-id="576292"><img id="r-576290" data-claire-element-id="576290" src="medias/uploads.siteduzero.com_files_390001_391000_390924.png" alt="Image utilisateur"/></figure><p id="r-576293" data-claire-element-id="576293">Maintenant que nous avons nos principaux éléments, nous allons pouvoir rentrer dans le vif du sujet, à savoir le code.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net">Faites parler vos applications en .NET</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
En avant moussaillon
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
Création de l&#039;interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
Coder la parole de votre application
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/encore-plus-loin-2">
Encore plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
<span class="arrow"></span>
<span class="next">En avant moussaillon</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
<span class="next">Coder la parole de votre application</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Coderlaparoledevotreapplication"></a><h2>Coder la parole de votre application</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
<span class="arrow"></span>
<span class="next">Création de l&#039;interface</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/encore-plus-loin-2">
<span class="next">Encore plus loin</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-576295" data-claire-element-id="576295">Nous voilà enfin au moment tant attendu. Nous allons enfin pouvoir coder !</p><aside id="r-576303" data-claire-element-id="576303" data-claire-semantic="information"><p id="r-576296" data-claire-element-id="576296">Avant de commencer, je dois vous signaler qu'il y a deux méthodes d'utilisation.<br/> C'est deux méthodes sont :</p><ul id="r-576301" data-claire-element-id="576301"><li id="r-576298" data-claire-element-id="576298"><p id="r-576297" data-claire-element-id="576297">la méthode synchrone ;</p></li><li id="r-576300" data-claire-element-id="576300"><p id="r-576299" data-claire-element-id="576299">la méthode asynchrone.</p></li></ul><p id="r-576302" data-claire-element-id="576302">Il y a une différence fondamentale sur l'aspect de votre application entre ces deux méthodes. Nous verrons cette différence par la suite.</p></aside><p id="r-576304" data-claire-element-id="576304">Tout d'abord, il va falloir faire quelques petits <strong>Imports</strong> en VB.NET ou <strong>using</strong> en C# :</p><pre id="r-576305" data-claire-element-id="576305"><code data-claire-semantic="vbnet">Imports System.Speech.Synthetizer
Imports System.Speech.Synthesis</code></pre><pre id="r-576306" data-claire-element-id="576306"><code data-claire-semantic="csharp">using System.Speech;
using System.Speech.Synthesis;</code></pre><p id="r-576307" data-claire-element-id="576307">Pour lancer notre lecture et entendre la douce voix de Virginie, il va falloir créer un <strong>SpeechSynthesizer</strong> (synthétiseur vocal en français), ainsi que demander à celui-ci de nous lire des données de type <strong>string</strong> (chaîne de caractères) :</p><pre id="r-576308" data-claire-element-id="576308"><code data-claire-semantic="vbnet">Dim parole As SpeechSynthesizer = New SpeechSynthesizer()
parole.Speak(champtexte.Text)</code></pre><pre id="r-576309" data-claire-element-id="576309"><code data-claire-semantic="csharp">SpeechSynthesizer parole = new SpeechSynthesizer();
parole.Speak(champtexte.Text);</code></pre><div id="r-576311" data-claire-element-id="576311" data-claire-semantic="question"><p id="r-576310" data-claire-element-id="576310">Yeah, mon application parle enfin, mais (il y a toujours un mais ;) ) pourquoi parle-t-elle avec un accent horrible ? Tu avais dit que la voix de Virginie était la meilleure ...</p></div><p id="r-576312" data-claire-element-id="576312">En effet, la voix que nous entendons est la voix d’<em>Anna</em>, la voix par défaut de Windows qui est une voix anglaise.<br/> Pour choisir la voix de Virginie, il va falloir attribuer à notre <strong>SpeechSynthesizer</strong> la voix de Virginie, mais ça reste relativement simple :</p><pre id="r-576313" data-claire-element-id="576313"><code data-claire-semantic="vbnet">parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;)</code></pre><pre id="r-576314" data-claire-element-id="576314"><code data-claire-semantic="csharp">parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;);</code></pre><p id="r-576315" data-claire-element-id="576315">Nous obtenons donc un simple code de trois lignes, nous permettant de déclarer notre <strong>SpeechSynthesizer</strong>, attribuer à celui-ci une voix et de le faire parler :</p><pre id="r-576316" data-claire-element-id="576316"><code data-claire-semantic="vbnet">Dim parole As SpeechSynthesizer = New SpeechSynthesizer()
parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;)
parole.Speak(champtexte.Text)</code></pre><pre id="r-576317" data-claire-element-id="576317"><code data-claire-semantic="csharp">SpeechSynthesizer parole = new SpeechSynthesizer();
parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;);
parole.Speak(champtexte.Text);</code></pre><p id="r-576318" data-claire-element-id="576318">Maintenant, vous avez donc la jolie et douce voix de Virginie. :ange:</p><div id="r-576320" data-claire-element-id="576320" data-claire-semantic="question"><p id="r-576319" data-claire-element-id="576319">Avez-vous remarqué que votre application se figeait au moment de la lecture ?</p></div><p id="r-576321" data-claire-element-id="576321">C'est à ce moment qu’intervient la notion <em>synchrone </em>et <em>asynchrone</em>, à laquelle j'avais fait allusion plus haut. Je vous avais dit qu'il y aurait une différence fondamentale. En effet, avec la méthode asynchrone, votre application ne se figera pas pendant la lecture, et vous aurez la possibilité de mettre en pause, de reprendre ou de stopper la lecture, chose infaisable avec la méthode synchrone.</p><p id="r-576322" data-claire-element-id="576322">C'est donc pour cela que je vous conseille vivement la méthode asynchrone qui est beaucoup plus avantageuse.<br/> Pour l'utiliser, il faut déclarer notre <strong>SpeechSynthesizer</strong> en <strong>Public</strong> de façon à interagir avec lui par l'intérmédiaire de plusieurs contrôles :</p><pre id="r-576323" data-claire-element-id="576323"><code data-claire-semantic="vbnet">Public parole As SpeechSynthesizer = New SpeechSynthesizer()</code></pre><pre id="r-576324" data-claire-element-id="576324"><code data-claire-semantic="csharp">public SpeechSynthesizer parole = new SpeechSynthesizer();</code></pre><p id="r-576325" data-claire-element-id="576325">Maintenant que notre <strong>SpeechSynthesizer </strong> est déclaré publiquement, nous pouvons recommencer la lecture mais cette fois-ci de façon asynchrone et comme le framework .NET est très bien fait, il n'y a pas besoin de plus de code par rapport a la méthode synchrone :</p><ul id="r-576332" data-claire-element-id="576332"><li id="r-576327" data-claire-element-id="576327"><p id="r-576326" data-claire-element-id="576326">créez un nouveau bouton (<strong>Button</strong>) ;</p></li><li id="r-576329" data-claire-element-id="576329"><p id="r-576328" data-claire-element-id="576328">changez sa propriété <strong>Text</strong> en lecture asynchrone ;</p></li><li id="r-576331" data-claire-element-id="576331"><p id="r-576330" data-claire-element-id="576330">changez sa propriété <strong>Name</strong> en &quot;lectureasynchrone&quot;.</p></li></ul><p id="r-576333" data-claire-element-id="576333">Voici le résultat :</p><figure id="r-576335" data-claire-element-id="576336"><img id="r-576334" data-claire-element-id="576334" src="medias/uploads.siteduzero.com_files_390001_391000_390926.png" alt="Image utilisateur"/></figure><p id="r-576337" data-claire-element-id="576337">Dans l'événement <strong>Clic</strong> de notre nouveau bouton, nous allons lui demander la même chose qu'avec notre bouton de lecture précédent :</p><ul id="r-576342" data-claire-element-id="576342"><li id="r-576339" data-claire-element-id="576339"><p id="r-576338" data-claire-element-id="576338">sélection de la voix ;</p></li><li id="r-576341" data-claire-element-id="576341"><p id="r-576340" data-claire-element-id="576340">lui demander de lire notre chaîne de caractère qui se trouve dans notre exemple le texte contenu dans notre <strong>textbox</strong>.</p></li></ul><pre id="r-576343" data-claire-element-id="576343"><code data-claire-semantic="vbnet">parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;)
parole.SpeakAsync(champtexte.Text)</code></pre><pre id="r-576344" data-claire-element-id="576344"><code data-claire-semantic="csharp">parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;);
parole.SpeakAsync(champtexte.Text);</code></pre><p id="r-576345" data-claire-element-id="576345">Comme vous pouvez le constater, il n' y a pas de grosse différence au niveau du code de ces deux méthodes pour un résultat phénoménal, car vous avez pu remarquer que l'application ne s'est pas figée et nous allons pouvoir effectuer plusieurs actions sur notre <strong>SpeechSynthesizer</strong>.<br/> Pour poursuivre, nous allons voire comment faire nos fameux boutons de pause, de reprise et de stoppage de la lecture.</p><figure id="r-576347" data-claire-element-id="576348"><img id="r-576346" data-claire-element-id="576346" src="medias/uploads.siteduzero.com_files_390001_391000_390927.png" alt="Image utilisateur"/></figure><p id="r-576349" data-claire-element-id="576349">Ces actions sont facilement réalisables, elles tiennent en une simple et unique ligne de code :</p><pre id="r-576350" data-claire-element-id="576350"><code data-claire-semantic="vbnet">parole.Pause() ' Pour mettre en pause
parole.Resume() ' Pour reprendre la lecture
parole.SpeakAsyncCancelAll() ' Et pour stopper la lecture</code></pre><pre id="r-576351" data-claire-element-id="576351"><code data-claire-semantic="csharp">parole.Pause(); // Pour mettre en pause
parole.Resume(); // Pour reprendre la lecture
parole.SpeakAsyncCancelAll(); // Et pour stopper la lecture</code></pre><p id="r-576352" data-claire-element-id="576352">Pour ce qui n'ont pas tout suivi, voici le code complet :</p><p id="r-576353" data-claire-element-id="576353"></p><div id="r-576356" data-claire-element-id="576356"><pre id="r-576354" data-claire-element-id="576354"><code data-claire-semantic="vbnet">Imports System.Speech.Synthetizer
Imports System.Speech.Synthesis
Public Class Form1

    Public parole As SpeechSynthesizer = New SpeechSynthesizer()

    Private Sub lecture_Click(sender As System.Object, e As System.EventArgs) Handles lecture.Click
        parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;)
        parole.Speak(champtexte.Text)
    End Sub

    Private Sub lectureasynchrone_Click(sender As System.Object, e As System.EventArgs) Handles lectureasynchrone.Click

        parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;)
        parole.SpeakAsync(champtexte.Text)
    End Sub

    Private Sub pause_Click(sender As System.Object, e As System.EventArgs) Handles pause.Click
        parole.Pause()
    End Sub

    Private Sub reprendre_Click(sender As System.Object, e As System.EventArgs) Handles reprendre.Click
        parole.Resume()
    End Sub

    Private Sub stopper_Click(sender As System.Object, e As System.EventArgs) Handles stopper.Click
        parole.SpeakAsyncCancelAll()
    End Sub
End Class</code></pre><pre id="r-576355" data-claire-element-id="576355"><code data-claire-semantic="csharp">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Speech;
using System.Speech.Synthesis;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {

        public SpeechSynthesizer parole = new SpeechSynthesizer();

        public Form1()
        {
            InitializeComponent();
        }

        private void lecture_Click(object sender, EventArgs e)
        {
            parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;);
            parole.Speak(champtexte.Text);
        }

        private void lectureasynchrone_Click(object sender, EventArgs e)
        {
            parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;);
            parole.SpeakAsync(champtexte.Text);
        }

        private void pause_Click(object sender, EventArgs e)
        {
            parole.Pause();
        }

        private void reprendre_Click(object sender, EventArgs e)
        {
            parole.Resume();
        }

        private void stopper_Click(object sender, EventArgs e)
        {
            parole.SpeakAsyncCancelAll();
        }

    }
}</code></pre></div>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net">Faites parler vos applications en .NET</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
En avant moussaillon
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
Création de l&#039;interface
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
Coder la parole de votre application
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/encore-plus-loin-2">
Encore plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
<span class="arrow"></span>
<span class="next">Création de l&#039;interface</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/encore-plus-loin-2">
<span class="next">Encore plus loin</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Encoreplusloin"></a><h2>Encore plus loin</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
<span class="arrow"></span>
<span class="next">Coder la parole de votre application</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-576358" data-claire-element-id="576358">Maintenant que vous savez effectuer les actions principales, il me doit de vous dire qu'il existe d'autre actions qui ne sont pas très souvent utilisées mais qui peuvent être utiles dans certains cas ou suivant l'utilisation de notre fameuse voix synthétique.</p><h3 id="r-recuperer-la-liste-des-voix-installees-sur-l-ordinateur" data-claire-element-id="576371">Récupérer la liste des voix installées sur l'ordinateur</h3><p id="r-576359" data-claire-element-id="576359">Récupérer la liste de voix installées sur notre ordinateur est assez simple et le mieux pour travailler avec cette liste est de la lister dans une <strong>ListBox</strong>.<br/> Créez donc cette <strong>ListBox </strong>que vous nommerez <strong>malistbox</strong> ainsi qu'un bouton :</p><figure id="r-576361" data-claire-element-id="576362"><img id="r-576360" data-claire-element-id="576360" src="medias/uploads.siteduzero.com_files_390001_391000_390928.png" alt="Image utilisateur"/></figure><p id="r-576363" data-claire-element-id="576363">Dans l'événement <strong>Clic</strong> du bouton qui vient d'être créé, nous lui demandons d'ajouter un <strong>Item</strong> à notre <strong>ListBox </strong>pour chaque voix installée et d'y insérer le nom (<strong>Name</strong>) de cette voix.</p><pre id="r-576364" data-claire-element-id="576364"><code data-claire-semantic="vbnet">For Each unevoix As InstalledVoice In parole.GetInstalledVoices
    malistBox.Items.Add(unevoix.VoiceInfo.Name)
Next</code></pre><pre id="r-576365" data-claire-element-id="576365"><code data-claire-semantic="csharp">foreach (InstalledVoice unevoix in parole.GetInstalledVoices())
{
    malistBox.Items.Add(unevoix.VoiceInfo.Name);
}</code></pre><p id="r-576366" data-claire-element-id="576366">Si vous n'avez pas installé d'autre voix que Virginie, vous obtiendrez :</p><figure id="r-576368" data-claire-element-id="576369"><img id="r-576367" data-claire-element-id="576367" src="medias/uploads.siteduzero.com_files_390001_391000_390267.png" alt="Image utilisateur"/></figure><p id="r-576370" data-claire-element-id="576370">Il s'agit de la voix par défaut d’Anna ainsi que la voix de Virginie que nous avions installée.</p><h3 id="r-connaitre-l-etat-de-notre-voix-de-synthese" data-claire-element-id="576389">Connaitre l'état de notre voix de synthèse</h3><p id="r-576372" data-claire-element-id="576372">Nous allons maintenant voir comment récupérer l'état actuel de notre voix synthétique.<br/> Il existe trois états :</p><ul id="r-576379" data-claire-element-id="576379"><li id="r-576374" data-claire-element-id="576374"><p id="r-576373" data-claire-element-id="576373">L'état 0 qui est l'état <strong>Ready</strong> : notre voix synthétique n'est pas en cours d'utilisation et donc celle-ci est prête à être utilisée ;</p></li><li id="r-576376" data-claire-element-id="576376"><p id="r-576375" data-claire-element-id="576375">L'état 1 qui est l'état <strong>Speaking</strong> : notre voix est actuellement en cours d'utilisation ;</p></li><li id="r-576378" data-claire-element-id="576378"><p id="r-576377" data-claire-element-id="576377">L'état 2 qui est l'état <strong>Paused</strong> : notre voix est actuellement en pause.</p></li></ul><p id="r-576380" data-claire-element-id="576380">Pour effectuer cela, nous aurons besoin d'un bouton ainsi que d'une zone de texte (<strong>TextBox</strong>) que vous nommerez &quot;etat&quot; :</p><figure id="r-576382" data-claire-element-id="576383"><img id="r-576381" data-claire-element-id="576381" src="medias/uploads.siteduzero.com_files_390001_391000_390929.png" alt="Image utilisateur"/></figure><p id="r-576384" data-claire-element-id="576384">Au niveau du code, nous n'avons qu'à comparer la valeur de l'état :</p><pre id="r-576385" data-claire-element-id="576385"><code data-claire-semantic="vbnet">Select Case parole.State
    Case Is = SynthesizerState.Ready
        etat.Text = &quot;Ready&quot;
    Case Is = SynthesizerState.Speaking
        etat.Text = &quot;Speaking&quot;
    Case Is = SynthesizerState.Paused
        etat.Text = &quot;Paused&quot;
End Select</code></pre><pre id="r-576386" data-claire-element-id="576386"><code data-claire-semantic="csharp">switch (parole.State)
{
    case SynthesizerState.Ready:
        etat.Text = &quot;Ready&quot;;
        break;
    case SynthesizerState.Speaking:
        etat.Text = &quot;Speaking&quot;;
        break;
    case SynthesizerState.Paused:
        etat.Text = &quot;Paused&quot;;
        break;
}</code></pre><p id="r-576387" data-claire-element-id="576387">En VB.NET les différents états possèdent un numéro d'état, ils correspondent aux états 0, 1 et 2 comme cité un peu plus haut. Nous pouvons donc comparer l'indice de ces numéros d'états :</p><pre id="r-576388" data-claire-element-id="576388"><code data-claire-semantic="vbnet">Select Case parole.State
            Case Is = 0
                etat.Text = &quot;Ready&quot;
            Case Is = 1
                etat.Text = &quot;Speaking&quot;
            Case Is = 2
                etat.Text = &quot;Paused&quot;
        End Select</code></pre><h3 id="r-verifier-si-une-voix-est-bien-installee" data-claire-element-id="576404">Vérifier si une voix est bien installée</h3><p id="r-576390" data-claire-element-id="576390">Si vous demandez à votre application de lire un texte avec une voix qui n'est pas installée sur l'ordinateur, votre application ne pourra malheureusement que planter.<br/> C'est pour cela que je vais vous donner ce minuscule morceau de code qui empêchera tout problème. Pour la lisibilité ainsi que pour réduire le code de votre application, ici le mieux à faire est de créer une fonction :</p><pre id="r-576391" data-claire-element-id="576391"><code data-claire-semantic="vbnet">Public Function verifvoix(voix As String)
    For Each unevoix As InstalledVoice In parole.GetInstalledVoices ' Je liste les voix installées
        If unevoix.VoiceInfo.Name = voix Then ' Je vérifie ici que la voix est égale à celle de la variable voix
            Return True ' Si la voix correspond bien alors la fonction renvoie True
        End If
    Next
    Return False' Je renvoi la valeur False si la voix ne correspond pas
End Function</code></pre><pre id="r-576392" data-claire-element-id="576392"><code data-claire-semantic="csharp">public bool verifvoix(string voix)
{
    foreach (InstalledVoice unevoix in parole.GetInstalledVoices()) // Je liste les voix installées
    {
        if (unevoix.VoiceInfo.Name == voix) // Je vérifie ici que la voix est égale à celle de la variable voix
            return true; // Si la voix correspond bien alors la fonction retourne true
    }
    return false; // Je renvoi la valeur false si la voix ne correspond pas
}</code></pre><p id="r-576393" data-claire-element-id="576393">Pour effectuer cette vérification, il suffit d'appeler notre fonction <strong>verifvoix</strong> avec la voix que nous souhaitons en argument :</p><aside id="r-576395" data-claire-element-id="576395" data-claire-semantic="information"><p id="r-576394" data-claire-element-id="576394">Dans notre exemple, nous vérifions la voix de Virginie.</p></aside><pre id="r-576396" data-claire-element-id="576396"><code data-claire-semantic="vbnet">Dim voix As String = &quot;ScanSoft Virginie_Dri40_16kHz&quot;
If verifvoix(voix) = True Then ' Si la voix est installée
     parole.SelectVoice(&quot;ScanSoft Virginie_Dri40_16kHz&quot;) ' Alors on l'utilise
End If</code></pre><pre id="r-576397" data-claire-element-id="576397"><code data-claire-semantic="csharp">string voix = &quot;ScanSoft Virginie_Dri40_16kHz&quot;;

if (verifvoix(voix)) // Si la voix est installée
    parole.SelectVoice(voix); // Alors on l'utilise</code></pre><p id="r-576398" data-claire-element-id="576398">Si vous souhaitez obtenir le projet final et commenté, vous pouvez télécharger les deux versions ci-dessous :</p><p id="r-576399" data-claire-element-id="576399"><a href="http://www.mediafire.com/?ze5pu1032pf309e">Télécharger le projet Text-to-Speech VB.NET</a></p><p id="r-576400" data-claire-element-id="576400"><a href="http://www.mediafire.com/?xi37domhxqv8d1l">Télécharger le projet Text-to-Speech C#</a></p><aside id="r-576402" data-claire-element-id="576402" data-claire-semantic="information"><p id="r-576401" data-claire-element-id="576401">En cas de problème (lien mort, etc.), merci de me le signaler.</p></aside><p id="r-576403" data-claire-element-id="576403">Dans ce tutoriel, nous avons pu remarquer la simplicité d'utilisation du système de voix de synthèse en .NET.<br/> Ainsi, que vous programmez en C# ou en VB.NET, vous n'aurez plus aucune excuse pour ne pas faire parler votre application.<br/> J’espère que ce court tutoriel vous sera utile !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net">Faites parler vos applications en .NET</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/en-avant-moussaillon">
En avant moussaillon
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/creation-de-l-interface">
Création de l&#039;interface
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
Coder la parole de votre application
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/encore-plus-loin-2">
Encore plus loin
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faites-parler-vos-applications-en-net/coder-la-parole-de-votre-application">
<span class="arrow"></span>
<span class="next">Coder la parole de votre application</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/faites-parler-vos-applications-en-net.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:50:59 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/faites-parler-vos-applications-en-net.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:10 GMT -->
</html>