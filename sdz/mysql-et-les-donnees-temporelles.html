<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/mysql-et-les-donnees-temporelles.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 20:34:11 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/mysql-et-les-donnees-temporelles.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 03:52:48 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : MySQL et les données temporelles</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/mysql-et-les-donnees-temporelles.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : MySQL et les données temporelles</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#MySQLetlesdonnestemporelles">MySQL et les données temporelles</a><br/><a href="#Enregistrerlesdonnes">Enregistrer les données</a><br/><a href="#Fonctionsdedatesetd039heures">Fonctions de dates et d&#039;heures</a><br/><a href="#Exercices">Exercices</a><br/><a href="#Optimisationduscriptdenews">Optimisation du script de news</a><br/></div>
<a name="MySQLetlesdonnestemporelles"></a><h2>MySQL et les données temporelles</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
<span class="next">Enregistrer les données</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-454774" data-claire-element-id="454774">Bonjour à tous !</p><p id="r-454775" data-claire-element-id="454775">Ce tutoriel vous explique comment enregistrer correctement vos données temporelles dans votre Base De Données et propose plusieurs fonctions pour les exploiter.</p><p id="r-454776" data-claire-element-id="454776">Bonne lecture !</p>
</div><a name="Enregistrerlesdonnes"></a><h2>Enregistrer les données</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
<span class="next">Fonctions de dates et d&#039;heures</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-454777" data-claire-element-id="454777">Voici les <strong>bonnes</strong> solutions pour stocker vos données temporelles (dates et heures) dans votre Base De Données : les types de champ DATE pour la date, TIME pour l'heure et DATETIME pour les deux, assemblées.</p><h2 id="r-la-date" data-claire-element-id="454784">La date</h2><h3 id="r-type-de-champ" data-claire-element-id="454780">Type de champ</h3><p id="r-454778" data-claire-element-id="454778">Il faut utiliser le type DATE pour stocker une date au format &quot;AAAA-MM-JJ&quot;.</p><pre id="r-454779" data-claire-element-id="454779"><code data-claire-semantic="sql">votre_date date NOT NULL DEFAULT '0000-00-00'</code></pre><h3 id="r-enregistrement-4" data-claire-element-id="454783">Enregistrement</h3><p id="r-454781" data-claire-element-id="454781">Les fonctions CURDATE() et CURRENT_DATE() retournent la date courante au format voulu, soit &quot;AAAA-MM-JJ&quot;.</p><pre id="r-454782" data-claire-element-id="454782"><code data-claire-semantic="sql">INSERT INTO votre_table (votre_date) VALUES (CURDATE());</code></pre><h2 id="r-l-heure" data-claire-element-id="454791">L'heure</h2><h3 id="r-type-de-champ-1" data-claire-element-id="454787">Type de champ</h3><p id="r-454785" data-claire-element-id="454785">Il faut utiliser le type TIME pour stocker une heure au format &quot;HH:MM:SS&quot;.</p><pre id="r-454786" data-claire-element-id="454786"><code data-claire-semantic="sql">votre_heure time NOT NULL DEFAULT '00:00:00'</code></pre><h3 id="r-enregistrement-5" data-claire-element-id="454790">Enregistrement</h3><p id="r-454788" data-claire-element-id="454788">Les fonctions CURTIME() et CURRENT_TIME() retournent l'heure courante au format voulu, soit &quot;HH:MM:SS&quot;.</p><pre id="r-454789" data-claire-element-id="454789"><code data-claire-semantic="sql">INSERT INTO votre_table (votre_heure) VALUES (CURTIME());</code></pre><h2 id="r-la-date-et-l-heure" data-claire-element-id="454799">La date et l'heure</h2><h3 id="r-type-de-champ-2" data-claire-element-id="454794">Type de champ</h3><p id="r-454792" data-claire-element-id="454792">Si vous voulez enregistrer une date complète, c'est-à-dire comprenant aussi l'heure, il faut utiliser le type de champ DATETIME. Le format de votre date est : &quot;AAAA-MM-JJ HH:MM:SS&quot;.</p><pre id="r-454793" data-claire-element-id="454793"><code data-claire-semantic="sql">date_complete datetime NOT NULL DEFAULT '0000-00-00 00:00:00'</code></pre><h3 id="r-enregistrement-6" data-claire-element-id="454798">Enregistrement</h3><p id="r-454795" data-claire-element-id="454795">La fonction NOW() ainsi que ses innombrables synonymes comme CURRENT_TIMESTAMP() retournent la date complète au format &quot;AAAA-MM-JJ HH:MM:SS&quot;.</p><pre id="r-454796" data-claire-element-id="454796"><code data-claire-semantic="sql">INSERT INTO votre_table (date_complete) VALUES (NOW());</code></pre><p id="r-454797" data-claire-element-id="454797">Maintenant, vous savez stocker <strong>correctement</strong> vos données temporelles dans votre BDD.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles">MySQL et les données temporelles</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
Enregistrer les données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
Fonctions de dates et d&#039;heures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
Exercices
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/optimisation-du-script-de-news">
Optimisation du script de news
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
<span class="next">Fonctions de dates et d&#039;heures</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Fonctionsdedatesetd039heures"></a><h2>Fonctions de dates et d&#039;heures</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
<span class="arrow"></span>
<span class="next">Enregistrer les données</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-454801" data-claire-element-id="454801">Vous allez découvrir différentes fonctions de dates et d'heures méconnues et pourtant tellement pratiques !</p><h2 id="r-datediff-difference-entre-deux-dates" data-claire-element-id="454806">DATEDIFF() : différence entre deux dates</h2><h3 id="r-datediff-date1-date2" data-claire-element-id="454803"><strong>DATEDIFF(date1, date2)</strong></h3><p id="r-454802" data-claire-element-id="454802">Cette fonction calcule le nombre de jours entre la date1 et la date2. Les dates sont de type DATE ou DATETIME (dans ce dernier cas, l'heure est ignorée).</p><h3 id="r-exemple-125" data-claire-element-id="454805">Exemple</h3><pre id="r-454804" data-claire-element-id="454804"><code data-claire-semantic="sql">SELECT DATEDIFF('2007-01-02', '2007-01-08');
=&gt; 6</code></pre><h2 id="r-date-format-et-son-contraire-str-to-date" data-claire-element-id="454816">DATE_FORMAT() et son contraire, STR_TO_DATE()</h2><h3 id="r-date-format-date-format" data-claire-element-id="454808"><strong>DATE_FORMAT(date, format)</strong></h3><p id="r-454807" data-claire-element-id="454807">Cette fonction transforme une date donnée au format indiqué.<br/> La liste des formats est longue, voici les principaux :<br/> - %d/%m/%Y =&gt; 01/12/2006 (le format français) ;<br/> - %W %e %M =&gt; Monday 5 December (les noms sont en anglais) ;<br/> - %X %V =&gt; 2007 51 (année et numéro de la semaine).<br/> Retrouvez le reste des formats dans <a href="http://dev.mysql.com/doc/refman/5.0/fr/date-and-time-functions.html">la documentation</a>.</p><h3 id="r-exemple-126" data-claire-element-id="454810">Exemple</h3><pre id="r-454809" data-claire-element-id="454809"><code data-claire-semantic="sql">SELECT DATE_FORMAT('2006-10-25 14:27:39', '%d/%m/%Y');
=&gt; 25/10/2006</code></pre><h3 id="r-str-to-date-date-format" data-claire-element-id="454812">STR_TO_DATE(date, format)</h3><p id="r-454811" data-claire-element-id="454811">Cette fonction est l'inverse de DATE_FORMAT(). Elle transforme la date donnée avec son format que vous devez indiquer en une date de type DATETIME (AAAA-MM-JJ).</p><h3 id="r-exemple-127" data-claire-element-id="454815">Exemple</h3><pre id="r-454813" data-claire-element-id="454813"><code data-claire-semantic="sql">SELECT STR_TO_DATE('25/10/2006 14:27:39', '%d/%m/%Y %T');
=&gt; 2006-10-25 14:27:39</code></pre><p id="r-454814" data-claire-element-id="454814">Remarque : %T est l'heure au format HH:MM:SS.</p><h2 id="r-time-to-sec-convertir-une-heure-en-secondes" data-claire-element-id="454821">TIME_TO_SEC() : convertir une heure en secondes</h2><h3 id="r-time-to-sec-heure" data-claire-element-id="454818">TIME_TO_SEC(heure)</h3><p id="r-454817" data-claire-element-id="454817">Cette fonction convertit une heure donnée en secondes.</p><h3 id="r-exemple-128" data-claire-element-id="454820">Exemple</h3><pre id="r-454819" data-claire-element-id="454819"><code data-claire-semantic="sql">SELECT TIME_TO_SEC('05:30:00')
=&gt; 19800</code></pre><h2 id="r-unix-timestamp-convertir-une-date-en-timestamp" data-claire-element-id="454827">UNIX_TIMESTAMP() : convertir une date en timestamp</h2><h3 id="r-unix-timestamp-date" data-claire-element-id="454823">UNIX_TIMESTAMP(date)</h3><p id="r-454822" data-claire-element-id="454822">Cette fonction retourne le timestamp correspondant à une date donnée (type DATE ou DATETIME).</p><h3 id="r-exemple-129" data-claire-element-id="454826">Exemple</h3><pre id="r-454824" data-claire-element-id="454824"><code data-claire-semantic="sql">SELECT UNIX_TIMESTAMP('1997-10-04 22:23:00');
=&gt; 875996580</code></pre><p id="r-454825" data-claire-element-id="454825">[Exemple de la documentation]</p><h2 id="r-makedate-et-maketime-creation-de-dates" data-claire-element-id="454836">MAKEDATE() et MAKETIME() : création de dates</h2><h3 id="r-makedate-annee-jourdelannee" data-claire-element-id="454829"><strong>MAKEDATE(année, jourdelannee)</strong></h3><p id="r-454828" data-claire-element-id="454828">Cette fonction crée une date au format DATE (AAAA-MM-JJ) à partir de deux éléments : l'année et le jour de l'année.</p><h3 id="r-exemple-130" data-claire-element-id="454831">Exemple</h3><pre id="r-454830" data-claire-element-id="454830"><code data-claire-semantic="sql">SELECT MAKEDATE(2004,365);
=&gt; 2004-12-31</code></pre><h3 id="r-maketime-heure-minutes-secondes" data-claire-element-id="454833"><strong>MAKETIME(heure, minutes, secondes)</strong></h3><p id="r-454832" data-claire-element-id="454832">De la même manière, cette fonction crée une heure au format TIME (HH:MM:SS) à partir de 3 éléments : l'heure, les minutes et les secondes.</p><h3 id="r-exemple-131" data-claire-element-id="454835">Exemple</h3><pre id="r-454834" data-claire-element-id="454834"><code data-claire-semantic="sql">SELECT MAKETIME(14,55,20);
=&gt; 14:55:20</code></pre><h2 id="r-date-add-et-date-sub-calculs-arithmetiques-sur-les-dates" data-claire-element-id="454848">DATE_ADD() et DATE_SUB() : calculs arithmétiques sur les dates</h2><h3 id="r-date-add-date-interval-expression-type" data-claire-element-id="454838">DATE_ADD(date, INTERVAL expression type)</h3><p id="r-454837" data-claire-element-id="454837">Cette fonction ajoute l'intervalle de temps <strong>expression</strong> du type <strong>type</strong> à la date donnée.<br/> La date peut être au format DATE ou au format DATETIME.<br/> L'argument type accepte les valeurs suivantes :<br/> - HOUR (<em>heure</em>) ;<br/> - DAY (<em>jour</em>) ;<br/> - WEEK (<em>semaine</em>) ;<br/> - MONTH (<em>mois</em>) ;<br/> - YEAR (<em>année</em>).<br/> Retrouvez la liste complète des types possibles dans <a href="http://dev.mysql.com/doc/refman/5.0/fr/date-and-time-functions.html">la documentation</a>.</p><h3 id="r-exemple-132" data-claire-element-id="454840">Exemple</h3><pre id="r-454839" data-claire-element-id="454839"><code data-claire-semantic="sql">SELECT DATE_ADD('2005-05-15 12:00:00', INTERVAL 5 DAY);
=&gt; 2005-05-20 12:00:00
SELECT DATE_ADD('2000-01-01', INTERVAL 7 YEAR);
=&gt; 2007-01-01
SELECT DATE_ADD('2007-06-15 12:00:00', INTERVAL '2:30:00' HOUR_SECOND);
=&gt; 2007-06-15 14:30:00</code></pre><h3 id="r-date-sub-date-interval-expression-type" data-claire-element-id="454842">DATE_SUB(date, INTERVAL expression type)</h3><p id="r-454841" data-claire-element-id="454841">Cette fonction fait le contraire de DATE_ADD() : elle soustrait l'intervalle de temps <strong>expression</strong> du <strong>type</strong><strong>type</strong> à la date donnée.<br/> Les arguments sont les mêmes que pour la fonction DATE_ADD().</p><h3 id="r-exemple-133" data-claire-element-id="454847">Exemple</h3><pre id="r-454843" data-claire-element-id="454843"><code data-claire-semantic="sql">SELECT DATE_SUB('2004-01-05', INTERVAL 31 DAY);
=&gt; 2003-12-05
SELECT DATE_SUB('2006-10-01', INTERVAL '6-5' YEAR_MONTH);
=&gt; 2000-05-01</code></pre><aside id="r-454845" data-claire-element-id="454845" data-claire-semantic="error"><p id="r-454844" data-claire-element-id="454844">Il ne faut surtout pas faire les accords du pluriel !<br/> Exemple : INTERVAL 5 DAYS =&gt; <strong>INTERVAL 5 DAY</strong></p></aside><p id="r-454846" data-claire-element-id="454846">Il existe bien d'autres fonctions mais je vous présente seulement les principales, du moins à mes yeux.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles">MySQL et les données temporelles</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
Enregistrer les données
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
Fonctions de dates et d&#039;heures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
Exercices
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/optimisation-du-script-de-news">
Optimisation du script de news
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
<span class="arrow"></span>
<span class="next">Enregistrer les données</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
<span class="next">Exercices</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Exercices"></a><h2>Exercices</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
<span class="arrow"></span>
<span class="next">Fonctions de dates et d&#039;heures</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/optimisation-du-script-de-news">
<span class="next">Optimisation du script de news</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-454850" data-claire-element-id="454850">Je vous propose de créer quelques requêtes SQL.</p><h2 id="r-exercice-1-19" data-claire-element-id="454862">Exercice 1</h2><p id="r-454851" data-claire-element-id="454851">Imaginons que vous souhaitez réaliser une requête sélectionnant le(s) pseudo(s) dans votre table membres à condition que l'heure d'inscription du membre (champ inscription) soit égale à 22, c'est-à-dire qu'il se soit inscrit à 22 heures.</p><p id="r-454852" data-claire-element-id="454852">Pour réaliser cette requête, il est nécessaire de connaître quelques nouvelles fonctions.</p><p id="r-454853" data-claire-element-id="454853">- <strong>HOUR(heure)</strong><br/> Cette fonction retourne le nombre d'heures uniquement d'une heure que vous donnez au format TIME ou DATETIME.<br/><strong><em>Exemple</em></strong></p><pre id="r-454854" data-claire-element-id="454854"><code data-claire-semantic="sql">SELECT HOUR('15:30:00');
=&gt; 15</code></pre><p id="r-454855" data-claire-element-id="454855">- <strong>MINUTE(heure)</strong><br/> Cette fonction retourne le nombre de minutes uniquement d'une heure que vous donnez au format TIME ou DATETIME.<br/><em><strong>Exemple</strong></em></p><pre id="r-454856" data-claire-element-id="454856"><code data-claire-semantic="sql">SELECT MINUTE('2007-01-05 10:25:30');
=&gt; 25</code></pre><p id="r-454857" data-claire-element-id="454857">- <strong>SECOND(heure)</strong><br/> Même principe pour cette fonction qui retourne quant à elle les secondes uniquement.<br/><em><strong>Exemple</strong></em></p><pre id="r-454858" data-claire-element-id="454858"><code data-claire-semantic="sql">SELECT SECOND('12:56:43');
=&gt; 43</code></pre><p id="r-454859" data-claire-element-id="454859">Vous avez maintenant tous les éléments nécessaires pour créer la requête : au travail !</p><h3 id="r-correction-155" data-claire-element-id="454861">Correction</h3><pre id="r-454860" data-claire-element-id="454860"><code data-claire-semantic="sql">SELECT pseudo FROM membres WHERE HOUR(inscription) = 22;</code></pre><h2 id="r-exercice-2-19" data-claire-element-id="454873">Exercice 2</h2><p id="r-454863" data-claire-element-id="454863">Passons à une requête un peu plus utile : vous devez réaliser une requête permettant de sélectionner le(s) pseudo(s) dans votre table membres qui se sont inscrits (champ inscription) depuis plus de 100 jours, c'est-à-dire les membres ayant plus de 100 jours d'ancienneté.</p><p id="r-454864" data-claire-element-id="454864">Je dois pour cela vous présenter une fonction qui vous sera bien utile.</p><p id="r-454865" data-claire-element-id="454865">- <strong>TO_DAYS(date)</strong><br/> Cette fonction retourne le nombre de jours depuis la date 0 jusqu'à la date indiquée.<br/><em><strong>Exemple</strong></em></p><pre id="r-454866" data-claire-element-id="454866"><code data-claire-semantic="sql">TO_DAYS('1997-10-07');
=&gt; 729669</code></pre><p id="r-454867" data-claire-element-id="454867">À vous de jouer !</p><h3 id="r-correction-156" data-claire-element-id="454869">Correction</h3><pre id="r-454868" data-claire-element-id="454868"><code data-claire-semantic="sql">SELECT pseudo FROM membres WHERE TO_DAYS(NOW()) - TO_DAYS(inscription) &gt; 100 ;</code></pre><h3 id="r-explications-35" data-claire-element-id="454872">Explications</h3><p id="r-454870" data-claire-element-id="454870">On calcule la différence entre le nombre de jours au moment de la requête et le nombre de jours au moment de l'inscription : on obtient ainsi le nombre de jours d'ancienneté du membre.</p><p id="r-454871" data-claire-element-id="454871">Ces requêtes ne sont pas réellement indispensables mais elles vous permettent d'appliquer concrètement les fonctions, et de parvenir à cette conclusion : ces fonctions concernant les dates et les heures sont à utiliser dans les éléments SELECT et WHERE.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles">MySQL et les données temporelles</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
Enregistrer les données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
Fonctions de dates et d&#039;heures
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
Exercices
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/optimisation-du-script-de-news">
Optimisation du script de news
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
<span class="arrow"></span>
<span class="next">Fonctions de dates et d&#039;heures</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/optimisation-du-script-de-news">
<span class="next">Optimisation du script de news</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Optimisationduscriptdenews"></a><h2>Optimisation du script de news</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
<span class="arrow"></span>
<span class="next">Exercices</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-454875" data-claire-element-id="454875">Vous allez maintenant utiliser vos nouvelles connaissances pour coder un script de news. En réalité, je vous propose de vous baser sur <a href="http://www.siteduzero.com/tuto-3-184-1-tp-des-news-sur-votre-site.html">ce script qui provient du cours PHP</a>.<br/> Je vous rappelle qu'il est très bien codé, hormis tout ce qui touche aux données temporelles.</p><p id="r-454876" data-claire-element-id="454876">Voilà ce que je vous propose : reprenez ce script et optimisez-le grâce aux connaissances en SQL que vous avez acquises.<br/> Bonne chance !</p><h2 id="r-correction-157" data-claire-element-id="454902">Correction</h2><p id="r-454877" data-claire-element-id="454877">Pour commencer, je vous propose de revoir structure de la table news.<br/> Pour stocker la date à laquelle la news est postée, il faut utiliser un champ de type <strong>DATETIME</strong>.</p><p id="r-454878" data-claire-element-id="454878">Voilà le code pour créer la table news :</p><pre id="r-454879" data-claire-element-id="454879"><code data-claire-semantic="sql">CREATE TABLE `news` (
id int(11) NOT NULL AUTO_INCREMENT,
titre varchar(255) NOT NULL,
contenu text NOT NULL,
temps datetime NOT NULL DEFAULT '0000-00-00 00:00:00'
);</code></pre><aside id="r-454881" data-claire-element-id="454881" data-claire-semantic="warning"><p id="r-454880" data-claire-element-id="454880">J'ai nommé le champ qui contient la date temps mais vous pouvez lui donner le nom que vous désirez.<br/> Toutefois, ne le nommez pas date pour éviter toute confusion avec le type de champ DATE.</p></aside><p id="r-454882" data-claire-element-id="454882">Il faut désormais enregistrer les dates au format voulu, soit &quot;<strong>AAAA-MM-JJ HH-MM-SS</strong>&quot;.<br/> Dans le fichier liste_news.php, il faut modifier la requête SQL pour enregistrer la date courante grâce à la fonction NOW() :</p><pre id="r-454883" data-claire-element-id="454883"><code data-claire-semantic="html+php">// Ce n'est pas une modification, on crée une nouvelle entrée dans la table
mysql_query(&quot;INSERT INTO news VALUES('', '&quot; . $titre . &quot;', '&quot; . $contenu . &quot;', NOW())&quot;);</code></pre><p id="r-454884" data-claire-element-id="454884">Enfin, il faut modifier l'affichage des news.<br/> En réalité, seule cette partie nécessite une amélioration :</p><pre id="r-454885" data-claire-element-id="454885"><code data-claire-semantic="html+php">&lt;h3&gt;
    &lt;?php echo $donnees['titre']; ?&gt;
    &lt;em&gt;le &lt;?php echo date('d/m/Y à H\hi', $donnees['timestamp']); ?&gt;&lt;/em&gt;
&lt;/h3&gt;</code></pre><p id="r-454886" data-claire-element-id="454886">Il faut formater la date au format français : &quot;<strong>JJ-MM-AAAA HH:MM:SS</strong>&quot;.<br/> Vous savez le faire grâce à la fonction DATE_FORMAT(), cependant il est préférable de formater les données du côté php : c'est bien plus rapide !</p><p id="r-454887" data-claire-element-id="454887">Il existe de nombreuses solutions pour formater une date, je vais vous en présenter quelques-unes.</p><h3 id="r-pour-formater-tres-simplement-une-date-seule" data-claire-element-id="454889">Pour formater très simplement une date seule</h3><pre id="r-454888" data-claire-element-id="454888"><code data-claire-semantic="html+php">$madate = explode('-', $madate); 
echo $madate[2].'/'.$madate[1].'/'.$madate[0];</code></pre><h3 id="r-pour-formater-une-date-seule-encore-source-expreg-com" data-claire-element-id="454891">Pour formater une date seule encore (source : <a href="http://www.expreg.com/lire-Date-source">Expreg.com</a>)</h3><pre id="r-454890" data-claire-element-id="454890"><code data-claire-semantic="html+php">$madate = &quot;2003-06-19&quot;; 
$motif = '`(\d{4})-(\d{1,2})-(\d{1,2})`'; 
$afficher = '$3-$2-$1'; 
echo preg_replace($motif,$afficher,$madate);</code></pre><h3 id="r-pour-formater-une-date-complete" data-claire-element-id="454901">Pour formater une date complète</h3><pre id="r-454892" data-claire-element-id="454892"><code data-claire-semantic="html+php">sscanf($madate, &quot;%4s-%2s-%2s %2s:%2s&quot;, $annee, $mois, $jour, $heure, $minute);
echo $jour.'/'.$mois.'/'.$annee.' '.$heure.':'.$minute;</code></pre><aside id="r-454894" data-claire-element-id="454894" data-claire-semantic="information"><p id="r-454893" data-claire-element-id="454893">Vous pouvez très bien utiliser d'autres méthodes pour formater vos dates.<br/> N'hésitez pas à consulter les différentes possibilités présentées sur le site <a href="http://www.expreg.com/lire-Date-source">Expreg.com</a> ou à créer les vôtres !</p></aside><p id="r-454895" data-claire-element-id="454895">Revenons à nos moutons !<br/> Voilà le code pour afficher la date de notre news :</p><pre id="r-454896" data-claire-element-id="454896"><code data-claire-semantic="html+php">&lt;h3&gt;
&lt;?php 
// À placer n'importe où avant.
sscanf($donnees['temps'], &quot;%4s-%2s-%2s %2s:%2s&quot;, $annee, $mois, $jour, $heure, $minute); ?&gt;
    
    &lt;?php echo $donnees['titre']; ?&gt;
    &lt;em&gt;le &lt;?php echo $jour.'/'.$mois.'/'.$annee.' à '.$heure.':'.$minute; ?&gt;&lt;/em&gt;
&lt;/h3&gt;</code></pre><p id="r-454897" data-claire-element-id="454897">Maintenant, votre code est bien optimisé !</p><p id="r-454898" data-claire-element-id="454898">Vous pouvez retrouver d'autres fonctions qui peuvent éventuellement vous servir dans la documentation MySQL : <a href="http://dev.mysql.com/doc/refman/5.0/fr/date-and-time-functions.html">accéder à la page</a>.</p><p id="r-454899" data-claire-element-id="454899">Pour conclure, je tiens à faire quelques précisions au sujet des formats de dates :<br/> - le format &quot;AAAA-MM-JJ&quot; n'est en aucun cas le format américain mais le format <strong><a href="http://fr.wikipedia.org/wiki/Organisation_internationale_de_normalisation">ISO</a> 8601</strong> (norme internationale) ;<br/> - <strong>le format américain</strong> est &quot;MM/JJ/AAAA&quot; ;<br/> - <a href="http://fr.wikipedia.org/wiki/Date">en savoir plus sur les différents formats de date dans le monde</a>.</p><p id="r-454900" data-claire-element-id="454900">Merci d'avoir lu ce tutoriel en espérant qu'il vous ait apporté des connaissances supplémentaires.<br/> Machin</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles">MySQL et les données temporelles</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/enregistrer-les-donnees">
Enregistrer les données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/fonctions-de-dates-et-d-heures">
Fonctions de dates et d&#039;heures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
Exercices
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/optimisation-du-script-de-news">
Optimisation du script de news
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/mysql-et-les-donnees-temporelles/exercices-29">
<span class="arrow"></span>
<span class="next">Exercices</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/mysql-et-les-donnees-temporelles.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 20:34:11 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/mysql-et-les-donnees-temporelles.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 03:52:48 GMT -->
</html>