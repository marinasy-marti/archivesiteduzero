<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/systeme-d-inscription-avec-validation-par-l-administrateur.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 11:05:32 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/systeme-d-inscription-avec-validation-par-l-administrateur.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:47:26 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Système d&#039;inscription avec validation par l&#039;administrateur</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Système d&#039;inscription avec validation par l&#039;administrateur</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Systmed039inscriptionavecvalidationparl039administrateur">Système d&#039;inscription avec validation par l&#039;administrateur</a><br/><a href="#Crerleformulaired039inscription">Créer le formulaire d&#039;inscription</a><br/><a href="#Traiterlesdonnesduformulaired039inscription">Traiter les données du formulaire d&#039;inscription</a><br/><a href="#Lapagedevalidationdesnouveauxinscrits">La page de validation des nouveaux inscrits</a><br/><a href="#Scriptpourlaconnexion">Script pour la connexion</a><br/><a href="#Scriptpourlavrificationdeconnexion">Script pour la vérification de connexion</a><br/></div>
<a name="Systmed039inscriptionavecvalidationparl039administrateur"></a><h2>Système d&#039;inscription avec validation par l&#039;administrateur</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
<span class="next">Créer le formulaire d&#039;inscription</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-368050" data-claire-element-id="368050">Quelquefois, nous voulons faire un site privé pour quelque raison que ce soit. Grâce au script que je vous montrerai, il est possible de demander une inscription qui devra ensuite être activée par le webmaster. Ainsi, même après une inscription, l'internaute ne peut toujours pas se connecter au site…</p><p id="r-368051" data-claire-element-id="368051">Un système semblable est d'ailleurs utilisé sur plusieurs forums phpBB2 (si vous demandez l'activation par l'administrateur ;) ). Cependant, le codage est peut-être différent, car je ne l'ai pas regardé. :-°</p><p id="r-368052" data-claire-element-id="368052">Alors voilà, c'est parti ! :)</p>
</div><a name="Crerleformulaired039inscription"></a><h2>Créer le formulaire d&#039;inscription</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
<span class="next">Traiter les données du formulaire d&#039;inscription</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-368053" data-claire-element-id="368053">La première étape, c'est bien entendu de créer un formulaire d'inscription. Sinon, comment l'internaute fera pour demander l'activation de son compte ? ;)</p><div id="r-368055" data-claire-element-id="368055" data-claire-semantic="question"><p id="r-368054" data-claire-element-id="368054">Quels sont les prérequis pour faire ce formulaire ?</p></div><p id="r-368056" data-claire-element-id="368056">Je ne pense pas avoir besoin de vous expliquer que CRÉER le formulaire n'est pas très compliqué… Vous n'avez besoin que de l'HTML (à la base, car il est possible de faire un bouton afin de s'assurer de l'action en JavaScript, etc. ^^ ).</p><p id="r-368057" data-claire-element-id="368057">Si vous ne savez pas comment faire du HTML, allez voir le <a href="http://www.siteduzero.com/tuto-3-6-0-apprenez-a-creer-votre-site-web.html">tutoriel de M@teo21</a>. Vous aurez certaines choses beaucoup plus compliquées à faire plus tard… :-°</p><div id="r-368059" data-claire-element-id="368059" data-claire-semantic="question"><p id="r-368058" data-claire-element-id="368058">Quels sont les champs que nous devrions mettre dans notre formulaire ?</p></div><p id="r-368060" data-claire-element-id="368060">Bien entendu, je ne peux pas vous indiquer exactement quels champs demander à l'internaute lors de l'inscription, tout dépend de vous. Donc, je vais vous montrer un exemple à partir des formulaires d'inscription que je crée habituellement, mais si vous comprenez bien le principe, vous pourrez FACILEMENT faire des modifications. Si vous ne comprenez pas le principe, vous devrez tout faire comme moi ! :p</p><p id="r-368061" data-claire-element-id="368061">Pour ce tutoriel, on va faire un formulaire avec une demande de pseudo, de mot de passe (ainsi que la confirmation pour voir si c'est le bon ;) ), l'adresse e-mail et un beau petit bouton M'inscrire.</p><aside id="r-368063" data-claire-element-id="368063" data-claire-semantic="warning"><p id="r-368062" data-claire-element-id="368062">Pour cette partie de mon tutoriel, je donnerai un peu moins d'explications, car tout est expliqué dans le tutoriel de M@teo21 dont j'ai déjà donné le lien plus haut. Je reviendrai tout de même sur certaines notions.</p></aside><p id="r-368064" data-claire-element-id="368064">Je manque souvent d'imagination… Je vais donc prendre le nom inscription.php pour la page d'inscription.</p><aside id="r-368066" data-claire-element-id="368066" data-claire-semantic="information"><p id="r-368065" data-claire-element-id="368065">Même si le formulaire est en HTML, je trouve plus simple de faire l'action <strong>vers la même page</strong>. Donc, il y aura aussi du PHP d'où le <strong>.php</strong>.</p></aside><pre id="r-368067" data-claire-element-id="368067"><code data-claire-semantic="html">&lt;form method=&quot;post&quot;&gt;
&lt;/form&gt;</code></pre><p id="r-368068" data-claire-element-id="368068">Ce petit bout de code représente uniquement l'ouverture du formulaire. Cela indique que le contenu entre les balises désignera un formulaire.</p><p id="r-368069" data-claire-element-id="368069">Passons maintenant à la création des différents champs. Je vous montre le code, et je vous explique une certaine partie par la suite.</p><pre id="r-368070" data-claire-element-id="368070"><code data-claire-semantic="html">&lt;form method=&quot;post&quot;&gt;
&lt;label&gt;Pseudo: &lt;input type=&quot;text&quot; name=&quot;pseudo&quot;/&gt;&lt;/label&gt;&lt;br/&gt;
&lt;label&gt;Mot de passe: &lt;input type=&quot;password&quot; name=&quot;passe&quot;/&gt;&lt;/label&gt;&lt;br/&gt;
&lt;label&gt;Confirmation du mot de passe: &lt;input type=&quot;password&quot; name=&quot;passe2&quot;/&gt;&lt;/label&gt;&lt;br/&gt;
&lt;label&gt;Adresse e-mail: &lt;input type=&quot;text&quot; name=&quot;email&quot;/&gt;&lt;/label&gt;&lt;br/&gt;
&lt;input type=&quot;submit&quot; value=&quot;M'inscrire&quot;/&gt;
&lt;/form&gt;</code></pre><p id="r-368071" data-claire-element-id="368071">Voilà, c'est à cela que ressemble notre formulaire. Bien entendu, cela a l'air compliqué comme ça, mais c'est un formulaire simple à déchiffrer… :-°</p><p id="r-368072" data-claire-element-id="368072">Commençons par les label qui entourent chaque champ du formulaire. Si vous ne vous en souvenez pas (j'étais pareil au début :-° ), cela sert à relier le mot écrit avant la case du formulaire. Ainsi, en cliquant sur Pseudo, vous verrez automatiquement apparaître votre curseur dans le champ pseudo.</p><p id="r-368073" data-claire-element-id="368073">Ensuite, j'ai mis des &lt;br /&gt; afin que chaque champ soit en dessous de l'autre, ça donne, d'après moi, un formulaire plus propre. ;)</p><p id="r-368074" data-claire-element-id="368074">Vous avez pu remarquer que j'ai mis le type text dans chacun des input. Par contre, pour le mot de passe, j'ai mis password. Grâce à ça, l'internaute ne verra pas le texte, mais seulement des étoiles (*).</p><p id="r-368075" data-claire-element-id="368075">Maintenant, vous savez comment créer le formulaire d'inscription. Nous allons donc passer à quelque chose de plus intéressant dans quelques secondes (à moins que vous arrêtiez de lire o_O ).</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur">Système d&#039;inscription avec validation par l&#039;administrateur</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
Créer le formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
Traiter les données du formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
La page de validation des nouveaux inscrits
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
Script pour la connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
Script pour la vérification de connexion
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
<span class="next">Traiter les données du formulaire d&#039;inscription</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Traiterlesdonnesduformulaired039inscription"></a><h2>Traiter les données du formulaire d&#039;inscription</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
<span class="arrow"></span>
<span class="next">Créer le formulaire d&#039;inscription</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
<span class="next">La page de validation des nouveaux inscrits</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-368077" data-claire-element-id="368077">Maintenant, vous avez fait un formulaire pour l'inscription. Par contre, comme vous le savez sûrement, il ne sert à rien pour l'instant…</p><div id="r-368079" data-claire-element-id="368079" data-claire-semantic="question"><p id="r-368078" data-claire-element-id="368078">Quoi ??? Tu nous as fait une sous-partie complète qui ne sert absolument à rien ???</p></div><p id="r-368080" data-claire-element-id="368080">En fait, cela servira une fois cette partie lue… Pour l'instant, l'internaute remplit le formulaire, mais rien ne se passe par la suite. Là, on enregistrera les données dans la base de données.</p><p id="r-368081" data-claire-element-id="368081">Premièrement, il faut que vous sachiez que les codes PHP que je vous montrerai ici doivent se trouver sur la même page. L'absence de action signifie prendre la même page quand on valide (un développeur est toujours paresseux ^^ ).</p><div id="r-368083" data-claire-element-id="368083" data-claire-semantic="question"><p id="r-368082" data-claire-element-id="368082">Que faut-il savoir pour cette section ?</p></div><p id="r-368084" data-claire-element-id="368084">Bien entendu, je vous suggère fortement d'avoir de bonnes bases en <strong><a href="http://www.siteduzero.com/tuto-3-4-0-un-site-dynamique-avec-php.html">PHP</a></strong>. Une connaissance des deux premières parties serait, d'après moi, suffisante.</p><p id="r-368085" data-claire-element-id="368085">Passons maintenant au codage ! :D</p><p id="r-368086" data-claire-element-id="368086">Deuxièmement, si vous ne voulez pas avoir une erreur en plein devant vous en arrivant sur la page, il faut vérifier si le formulaire a été rempli. Pour ce faire, j'espère que vous le savez ^^ , on va utiliser une condition. Voici le code à écrire :</p><pre id="r-368087" data-claire-element-id="368087"><code data-claire-semantic="html+php">&lt;?php
if(!empty($_POST['pseudo']))
{
// …
// Votre code
// …
}
?&gt;</code></pre><p id="r-368088" data-claire-element-id="368088">Avec ce bout de code, je vérifie si l'information sur le champ pseudo a été envoyée et qu'elle est non nulle. J'aurais pu mettre n'importe quel champ, mais un seul suffit. J'aurais aussi pu tous les mettre avec un AND entre chaque, mais le script devient plus long (et moins compréhensible ;) ). Le reste du code de cette partie se place entre les accolades.</p><p id="r-368089" data-claire-element-id="368089">Maintenant, nous allons enregistrer les données reçues du formulaire dans notre base de données.</p><div id="r-368091" data-claire-element-id="368091" data-claire-semantic="question"><p id="r-368090" data-claire-element-id="368090">Oui, mais je n'ai pas de table prête pour ça. Où vais-je enregistrer mes données ?</p></div><p id="r-368092" data-claire-element-id="368092">J'y arrivais justement. Lors de mon tutoriel, on va devoir créer deux tables dans la base de données. Nous sommes arrivés à la première.</p><p id="r-368093" data-claire-element-id="368093">Je vous conseille d'appeler cette table validation. Un mauvais nom à donner serait connexion, car ce n'est pas cette table qui servira à se connecter... Elle vous servira, comme son nom l'indique, à valider le nouvel utilisateur.</p><p id="r-368094" data-claire-element-id="368094">Dans notre cas, voici les informations sur les champs de la table validation :</p><p id="r-368095" data-claire-element-id="368095">1. id de type INT avec auto_increment et index. Pas besoin d'explications, vous avez dû voir plusieurs explications dans le cadre du cours de M@teo21 ;<br/> 2. pseudo de type VARCHAR ;<br/> 3. passe de type VARCHAR ;<br/> 4. email de type VARCHAR.</p><p id="r-368096" data-claire-element-id="368096">Afin de créer votre table, je vous offre le code SQL :</p><pre id="r-368097" data-claire-element-id="368097"><code data-claire-semantic="sql">CREATE TABLE `validation` (
`id` INT( 255 ) NOT NULL AUTO_INCREMENT ,
`pseudo` VARCHAR( 255 ) NOT NULL ,
`passe` VARCHAR( 255 ) NOT NULL ,
`email` VARCHAR( 255 ) NOT NULL ,
INDEX ( `id` )
);</code></pre><p id="r-368098" data-claire-element-id="368098">Comme vous pouvez le remarquer, j'ai mis un attribut pour chaque champ du formulaire que nous avons créer.</p><aside id="r-368100" data-claire-element-id="368100" data-claire-semantic="information"><p id="r-368099" data-claire-element-id="368099">Je n'ai pas mis de champ dans la table servant à la confirmation du mot de passe. En fait, cette confirmation sera vérifiée grâce au code PHP et non pas dans la base de données, ce qui n'aurait en fait aucun sens…</p></aside><p id="r-368101" data-claire-element-id="368101">Maintenant que votre table est prête, nous allons passer au codage de la page.</p><p id="r-368102" data-claire-element-id="368102">Pour commencer, on va vérifier si les deux mots de passe entrés sont les mêmes. S'ils sont pareils, on va enregistrer les informations dans la base de données. Sinon, on va écrire un message qui indique une erreur. Voici le code à écrire :</p><pre id="r-368103" data-claire-element-id="368103"><code data-claire-semantic="html+php">&lt;?php
// D'abord, je me connecte à la base de données.
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);

// Je mets aussi certaines sécurités ici…
$passe = mysql_real_escape_string(htmlspecialchars($_POST['passe']));
$passe2 = mysql_real_escape_string(htmlspecialchars($_POST['passe2']));
if($passe == $passe2)
{
// Ne vous inquiétez pas, le script arrive…
}
 
else
{
echo 'Les deux mots de passe que vous avez rentrés ne correspondent pas…';
}
?&gt;</code></pre><pre id="r-368104" data-claire-element-id="368104"><code data-claire-semantic="html+php">&lt;?php
if(!empty($_POST['pseudo']))
{
// D'abord, je me connecte à la base de données.
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);


// Je mets aussi certaines sécurités ici…
$passe = mysql_real_escape_string(htmlspecialchars($_POST['passe']));
$passe2 = mysql_real_escape_string(htmlspecialchars($_POST['passe2']));

if($passe == $passe2)
{
 
}
else
{
echo 'Les deux mots de passe que vous avez rentrés ne correspondent pas…';
}
}
?&gt;</code></pre><p id="r-368105" data-claire-element-id="368105">Comme vous avez pu le remarquer, nous nous sommes connectés à la base de données. Les informations que j'ai inscrites sont faites pour EasyPHP ou Wamp, mais vous pouvez très bien les changer par vous-mêmes.</p><aside id="r-368107" data-claire-element-id="368107" data-claire-semantic="information"><p id="r-368106" data-claire-element-id="368106">Pour le reste de la partie, le code donné se mettra dans l'accolade de la condition vérifiant que les mots de passe sont équivalents. Je ne vous remettrai pas le reste, car ce sera une page beaucoup trop longue. Je la mettrai en entier (résumé de la partie) à la fin de celle-ci.</p></aside><p id="r-368108" data-claire-element-id="368108">Bon, continuons. Ne lâchez pas, il en reste pas gros à cette partie du tutoriel. :D Tout ce qui reste à faire, c'est enregistrer les informations reçues par le formulaire de la partie 1 dans notre base de données.</p><pre id="r-368109" data-claire-element-id="368109"><code data-claire-semantic="html+php">&lt;?php
$pseudo = mysql_real_escape_string(htmlspecialchars($_POST['pseudo']));
$email = mysql_real_escape_string(htmlspecialchars($_POST['email']));

// Je vais crypter le mot de passe.
$passe = sha1($passe);
?&gt;</code></pre><p id="r-368110" data-claire-element-id="368110">Je mets une variable normale (et non pas super globale), car je me retrouve toujours avec des erreurs incompréhensibles dans le cas contraire. C'est pour le bien-être de tous. J'ai aussi crypté le mot de passe grâce à la fonction sha1. Bien entendu, il est possible de le faire avec d'autres fonctions, mais il s'agit de celle que j'aime utiliser. En effet, un bon webmaster devrait toujours crypter ses mots de passe. ;)</p><p id="r-368111" data-claire-element-id="368111">Maintenant, nous allons faire la requête SQL afin d'insérer les informations. N'oubliez pas non plus que nous avons un champ id en auto_increment. Donc, il ne faut mettre aucune donnée au début pour le champ id (on met seulement '').</p><pre id="r-368112" data-claire-element-id="368112"><code data-claire-semantic="html+php">&lt;?php
mysql_query(&quot;INSERT INTO validation VALUES('', '$pseudo', '$passe', '$email')&quot;);
?&gt;</code></pre><p id="r-368113" data-claire-element-id="368113">Voilà, les informations sont maintenant enregistrées. Cette sous-partie tire à sa fin… Je vais donc vous donner, comme promis, le code complet vu lors de la sous-partie 2 (je ne mettrai pas celui de la sous-partie 1).</p><pre id="r-368114" data-claire-element-id="368114"><code data-claire-semantic="html+php">&lt;?php
if(!empty($_POST['pseudo']))
{
// D'abord, je me connecte à la base de données.
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);

// Je mets aussi certaines sécurités ici…
$passe = mysql_real_escape_string(htmlspecialchars($_POST['passe']));
$passe2 = mysql_real_escape_string(htmlspecialchars($_POST['passe2']));
if($passe == $passe2)
{
$pseudo = mysql_real_escape_string(htmlspecialchars($_POST['pseudo']));
$email = mysql_real_escape_string(htmlspecialchars($_POST['email']));
// Je vais crypter le mot de passe.
$passe = sha1($passe);

mysql_query(&quot;INSERT INTO validation VALUES('', '$pseudo', '$passe', '$email')&quot;);
}
 
else
{
echo 'Les deux mots de passe que vous avez rentrés ne correspondent pas…';
}
}
?&gt;</code></pre><p id="r-368115" data-claire-element-id="368115">J'ai une bonne nouvelle pour vous… On en a enfin fini avec la page inscription.php ! Là, on va rapidement entrer dans le vif du sujet pour la validation (en d'autres mots, on en arrive enfin au but du tutoriel :) ).</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur">Système d&#039;inscription avec validation par l&#039;administrateur</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
Créer le formulaire d&#039;inscription
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
Traiter les données du formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
La page de validation des nouveaux inscrits
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
Script pour la connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
Script pour la vérification de connexion
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
<span class="arrow"></span>
<span class="next">Créer le formulaire d&#039;inscription</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
<span class="next">La page de validation des nouveaux inscrits</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lapagedevalidationdesnouveauxinscrits"></a><h2>La page de validation des nouveaux inscrits</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
<span class="arrow"></span>
<span class="next">Traiter les données du formulaire d&#039;inscription</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
<span class="next">Script pour la connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-368117" data-claire-element-id="368117">Pour résumer ce qui a été fait jusqu'à présent, l'internaute s'est inscrit. Ensuite, si vous êtes sur ce tutoriel, c'est que vous voulez avoir à valider le membre avant qu'il puisse se connecter. C'est ici où vous apprendrez à faire la page de validation.</p><div id="r-368119" data-claire-element-id="368119" data-claire-semantic="question"><p id="r-368118" data-claire-element-id="368118">Comment allons-nous former cette page ?</p></div><p id="r-368120" data-claire-element-id="368120">Lorsque nous programmons, il est toujours important d'avoir le modèle et le fonctionnement de la page en tête. Je vais donc maintenant vous faire une petite description du fonctionnement de la page que je vous montrerai. Si vous êtes forts en programmation, vous pourrez faire comme je fais toujours. Vous lisez et vous vous inspirez de mon tutoriel, et après vous faites des modifications pour qu'il soit vraiment à votre goût.</p><p id="r-368121" data-claire-element-id="368121">La page fonctionnera très simplement. Nous afficherons un membre par ligne. Sur chaque ligne, il y aura son pseudo, son mot de passe et son adresse e-mail (libre à vous de changer les informations que l'on voit) et il y aura des textes-liens (nouveau mot :lol: ) : Accepter et Refuser. Est-ce que j'ai besoin de vous expliquer ce qui se passe lorsque nous cliquons sur l'un des textes-liens ?</p><div id="r-368123" data-claire-element-id="368123" data-claire-semantic="question"><p id="r-368122" data-claire-element-id="368122">Quelles sont les propriétés de la page de validation ?</p></div><p id="r-368124" data-claire-element-id="368124">Premièrement, le nom de la page devra s'appeler, d'après l'exemple de mon tutoriel, validation.php. Aussi, cette page devra être protégée par un .htaccess et un .htpasswd. À moins que vous ne vouliez que n'importe qui puisse valider les membres ? :-° Pour savoir comment créer ces deux types de fichiers, voici le lien vers <a href="http://www.siteduzero.com/tuto-3-152-1-proteger-un-dossier-avec-un-htaccess.html">le cours sur les htaccess de M@teo21</a>.</p><p id="r-368125" data-claire-element-id="368125">Il est enfin l'heure de commencer le codage de notre page de validation ! :p</p><p id="r-368126" data-claire-element-id="368126">D'abord, on va aller chercher les informations de chaque nouveau membre auquel vous n'avez pas encore rendu de verdict (accepté ou refusé).</p><pre id="r-368127" data-claire-element-id="368127"><code data-claire-semantic="html+php">&lt;?php
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);
$quete = mysql_query(&quot;SELECT * FROM validation&quot;);
?&gt;</code></pre><p id="r-368128" data-claire-element-id="368128">Encore une fois, cela n'est pas trop compliqué. On commence d'abord par se connecter à notre base de données. Ensuite, je vais chercher toutes les entrées dans la table créée un peu plus tôt lors de mon tutoriel : validation. Vous devriez aller voir le <a href="http://www.siteduzero.com/tuto-3-4-0-un-site-dynamique-avec-php.html">cours PHP de M@teo21</a> si vous ne comprenez pas le code que je viens de vous donner. Comme je l'ai dit en début de cours, la connaissance de MySQL est requise pour bien comprendre mon tutoriel.</p><p id="r-368129" data-claire-element-id="368129">Maintenant, on va afficher chaque membre en attente de verdict. Pour l'instant, je ne mettrai pas les liens Accepter et Refuser, car c'est un peu plus complexe. Je préfère donc les mettre séparément pour bien les expliquer. Je mettrai tout de même un commentaire pour que vous sachiez où placer les liens que nous verrons très bientôt.</p><pre id="r-368130" data-claire-element-id="368130"><code data-claire-semantic="html+php">&lt;?php
while($validation = mysql_fetch_array($quete))
{
echo 'Pseudo: ';
echo $validation['pseudo'];
echo ' E-mail: ';
echo $validation['email'];
// Les liens « Accepter » et « Refuser » se placent ici.
echo '&lt;br/&gt;';
}
?&gt;</code></pre><p id="r-368131" data-claire-element-id="368131">Je sais, ce script semble bizarre à première vue. :-° Par contre, sachez que l'affichage est bon lorsque tout est placé sur la page. Premièrement, sachez que bien que j'aie fait des entrées dans le code PHP, tout est inscrit en une seule ligne lorsque vous naviguez sur le Web. Aussi, les différentes espaces placées servent à ne pas créer la « phrase » (entre guillemets, car elle est mal formée :-° ) en un seul mot.</p><p id="r-368132" data-claire-element-id="368132">D'abord, il y a le while suivi de mysql_fetch_array. Cela sert à afficher de la façon inscrite chaque entrée de ma table. Ensuite, je commence à écrire ce que l'on voit réellement sur la page grâce à la fonction echo. Je mets donc Pseudo: suivi du pseudo du membre. C'est la même chose partout. Pour finir, je change de ligne pour que la prochaine entrée sur la page (s'il y en a une) soit affichée sur la ligne suivante.</p><p id="r-368133" data-claire-element-id="368133">Maintenant, bien que la tâche puisse sembler compliquée, je vais vous montrer comment mettre les liens Accepter et Refuser. Regardez bien le href, c'est la partie la plus importante dans ce bout de code.</p><pre id="r-368134" data-claire-element-id="368134"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;a href=&quot;validation.php?action=accepter&amp;id='.$validation['id'].'&quot;&gt;Accepter&lt;/a&gt;'; // Il y a une espace pour séparer les liens.
echo '&lt;a href=&quot;validation.php?action=refuser&amp;id='.$validation['id'].'&quot;&gt;Refuser&lt;/a&gt;';
?&gt;</code></pre><p id="r-368135" data-claire-element-id="368135">Là, vous avez le droit de vous poser des questions. C'est justement pour cette raison que j'ai mis du rouge et du bleu. C'est afin de vous aider à comprendre ce que je viens de faire. Commençons par le début. ;) Je commence avec un echo suivi d'une apostrophe. Pour ne pas faire d'erreur, je mets aussi l'apostrophe qui ferme immédiatement ainsi que le point-virgule. Ensuite, entre les apostrophes, je mets la balise HTML de lien. Je commence donc avec un lien comme d'habitude. Je me rends donc sur la page validation.php (la même page). Sautons ensuite les couleurs. Vous pouvez voir, bien que collés, les guillemets. Avant ces guillemets se trouve une apostrophe en bleu. Ces guillemets ferment l'attribut href. Ensuite, j'écris ce qui sera affiché en tant que lien (accepter ou refuser). Je referme ensuite la balise a, qui sert à créer un lien. Veuillez noter l'espace, comme mentionné dans le commentaire. Celle-ci sert à écrire Accepter Refuser plutôt que AccepterRefuser.</p><p id="r-368136" data-claire-element-id="368136">On passe maintenant aux couleurs… Soyez prêts, car c'est la partie difficile ! :euh:</p><p id="r-368137" data-claire-element-id="368137">Rouge : premièrement, il y a un point d'interrogation qui annonce une variable $_GET. D'abord, j'ai action qui est le nom de la variable. L'action sert simplement à savoir quoi effectuer. Je mets ensuite le signe égal (=) qui met la valeur de la variable. Je ne me suis pas trop creusé la tête, j'ai mis <em>accepter</em> et <em>refuser</em> dépendamment du cas.</p><p id="r-368138" data-claire-element-id="368138">Ensuite, vous voyez un signe prononcé et (&amp;). Celui-ci sert à dire qu'il y a une autre variable de type $_GET. Celle-ci est bleue.</p><p id="r-368139" data-claire-element-id="368139">Bleu : j'ai d'abord nommé la variable id. C'est l'id de l'utilisateur (enregistré dans la BDD) à qui on va rendre le verdict. Donc, je mets ensuite &quot;'.&quot; pour faire une concaténation. Cela sert à rajouter une variable. Encore une fois, il s'agit d'un array, et j'écris donc $validation['id']. Je finis en refermant la concaténation avec le contraire de l'ouverture : &quot;.'&quot;.</p><p id="r-368140" data-claire-element-id="368140">Maintenant, notre script est prêt à afficher nos choix et les utilisateurs. À présent, il faudra coder afin de faire quelque chose lorsque action (Accepter ou Refuser) est effectuée. La première chose à faire est de vérifier si un choix a été effectué. Ensuite, on vérifie si l'action est d'accepter ou de refuser le membre. Voici comment :</p><pre id="r-368141" data-claire-element-id="368141"><code data-claire-semantic="html+php">&lt;?php
if(isset($_GET['action']) AND isset($_GET['id']))
{
$action = $_GET['action'];
if($action == &quot;accepter&quot;)
{
// C'est ici que l'on mettra l'action à effectuer si le verdict est « accepter ».
}
elseif($action == &quot;refuser&quot;)
{
// C'est ici que l'on mettra l'action à effectuer si le verdict est « refuser ».
}
}
?&gt;</code></pre><p id="r-368142" data-claire-element-id="368142">Donc, en gros, on commence par regarder si l'URL de la barre de navigation contient les deux variables (ce n'est pas bon s'il n'y en a qu'une). Ensuite, on vérifie si la valeur de la variable action est accepter ou refuser, tout dépend du lien sur lequel vous avez cliqué.</p><p id="r-368143" data-claire-element-id="368143">Nous allons maintenant préparer le code si l'action est accepter. Il faudra donc commencer par rajouter les informations du membre dans une table qui sert de connexion, et ensuite les supprimer de la table validation pour ne pas activer le compte d'un même membre deux fois. ;)</p><div id="r-368145" data-claire-element-id="368145" data-claire-semantic="question"><p id="r-368144" data-claire-element-id="368144">Peux-tu au moins nous dire quoi mettre dans notre nouvelle table pour la connexion ?</p></div><p id="r-368146" data-claire-element-id="368146">Cette fois, la réponse sera très courte. Nommez la table connexion ou un nom semblable et mettez-y les mêmes champs que dans la table validation, car les informations seront simplement transférées si le membre est accepté.</p><aside id="r-368148" data-claire-element-id="368148" data-claire-semantic="warning"><p id="r-368147" data-claire-element-id="368147">L'id ne doit pas avoir d'auto_increment dans la table connexion, car nous mettrons le même id que dans la table validation.</p></aside><p id="r-368149" data-claire-element-id="368149">D'abord, nous allons enregistrer toutes les informations dans la table connexion grâce au code suivant :</p><pre id="r-368150" data-claire-element-id="368150"><code data-claire-semantic="html+php">&lt;?php
$id = $_GET['id'];
$quete2 = mysql_query(&quot;SELECT * FROM validation WHERE id='$id'&quot;);
$connexion = mysql_fetch_array($quete2);
 
$pseudo = $connexion['pseudo'];
$passe = $connexion['passe'];
$email = $connexion['email'];
 
mysql_query(&quot;INSERT INTO connexion VALUES('$id', '$pseudo', '$passe', '$email')&quot;);
?&gt;</code></pre><p id="r-368151" data-claire-element-id="368151">Donc, on commence par se connecter à la base de données. Ensuite, on met dans la variable $id l'information prise dans l'URL, puis on va chercher les informations du membre dont l'id est celui de l'URL. On met ensuite le tout dans des variables normales (sans array), et on finit avec une inclusion des informations dans la table connexion. Veuillez noter que le mot de passe envoyé dans la table connexion est lui aussi crypté grâce à la fonction sha1 de PHP. En effet, nous avons pris la même valeur que dans la table validation, sans le décrypter.</p><p id="r-368152" data-claire-element-id="368152">Maintenant, il ne nous reste qu'à supprimer les informations de la table validation.</p><pre id="r-368153" data-claire-element-id="368153"><code data-claire-semantic="html+php">&lt;?php
mysql_query(&quot;DELETE FROM validation WHERE id='$id'&quot;);
?&gt;</code></pre><p id="r-368154" data-claire-element-id="368154">Passons maintenant au script à écrire si jamais l'action était refuser. Cette action est très simple : nous n'avons qu'à supprimer les informations de la table validation. Voici donc le code à inscrire.</p><pre id="r-368155" data-claire-element-id="368155"><code data-claire-semantic="html+php">&lt;?php
$id = $_GET['id'];
mysql_query(&quot;DELETE FROM validation WHERE id='$id'&quot;);
?&gt;</code></pre><p id="r-368156" data-claire-element-id="368156">La page validation.php est maintenant terminée. Puisque la sous-partie est longue et que l'assemblage doit être compliqué, je vais vous assembler la page moi-même. En d'autres mots, je vais faire le travail pour vous… :-°</p><pre id="r-368157" data-claire-element-id="368157"><code data-claire-semantic="html+php">&lt;?php
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);
$quete = mysql_query(&quot;SELECT * FROM validation&quot;);
while($validation = mysql_fetch_array($quete))
{
echo 'Pseudo: ';
echo $validation['pseudo'];
echo ' Mot de passe: ';
echo $validation['passe'];
echo ' E-mail: ';
echo $validation['email'];
echo '&lt;a href=&quot;validation.php?action=accepter&amp;id='.$validation['id'].'&quot;&gt;Accepter&lt;/a&gt;';
echo '&lt;a href=&quot;validation.php?action=refuser&amp;id='.$validation['id'].'&quot;&gt;Refuser&lt;/a&gt;';
echo '&lt;br/&gt;';
}
 
if(isset($_GET['action']) AND isset($_GET['id']))
{
$action = $_GET['action'];
if($action == &quot;accepter&quot;)
{
$id = $_GET['id'];
$quete2 = mysql_query(&quot;SELECT * FROM validation WHERE id='$id'&quot;);
$connexion = mysql_fetch_array($quete2);
$pseudo = $connexion['pseudo'];
$passe = $connexion['passe'];
$email = $connexion['email'];
mysql_query(&quot;INSERT INTO connexion VALUES('$id', '$pseudo', '$passe', '$email')&quot;);
mysql_query(&quot;DELETE FROM validation WHERE id='$id'&quot;);
}
elseif($action == &quot;refuser&quot;)
{
$id = $_GET['id'];
mysql_query(&quot;DELETE FROM validation WHERE id='$id'&quot;);
}
}
?&gt;</code></pre><p id="r-368158" data-claire-element-id="368158">Voilà, cette sous-partie est terminée. On se rejoint dans la prochaine !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur">Système d&#039;inscription avec validation par l&#039;administrateur</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
Créer le formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
Traiter les données du formulaire d&#039;inscription
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
La page de validation des nouveaux inscrits
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
Script pour la connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
Script pour la vérification de connexion
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
<span class="arrow"></span>
<span class="next">Traiter les données du formulaire d&#039;inscription</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
<span class="next">Script pour la connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Scriptpourlaconnexion"></a><h2>Script pour la connexion</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
<span class="arrow"></span>
<span class="next">La page de validation des nouveaux inscrits</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
<span class="next">Script pour la vérification de connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-368160" data-claire-element-id="368160">Premièrement, il vous faut un petit formulaire afin de demander le pseudo et le mot de passe du membre. Je vais vous laisser le créer seuls, car sinon, mon tutoriel sera beaucoup trop long et cela ressemble beaucoup à ma sous-partie parlant de la création du formulaire d'inscription. Supposons maintenant que vous ayez créé ce formulaire et que les noms des champs sont pseudo et passe. J'utiliserai ces noms, mais veillez à les remplacer par les noms que vous avez choisis.</p><p id="r-368161" data-claire-element-id="368161">Premièrement, nous devons nous connecter à la base de données.</p><pre id="r-368162" data-claire-element-id="368162"><code data-claire-semantic="html+php">&lt;?php
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);
?&gt;</code></pre><p id="r-368163" data-claire-element-id="368163">Par la suite, nous allons vérifier si le couple pseudo / mot de passe correspond. Il faudra donc aller chercher les vraies informations dans la base de données. Par contre, pour ne pas afficher une erreur incompréhensible, il faudra vérifier si le pseudo existe bel et bien. Avant de tester les variables, soit lors de la déclaration de celles-ci, je dois mettre la sécurité nécessaire afin de protéger le site.</p><aside id="r-368165" data-claire-element-id="368165" data-claire-semantic="warning"><p id="r-368164" data-claire-element-id="368164">Il est fort important de ne pas oublier d'utiliser la fonction <strong>sha1</strong> afin de crypter le mot de passe que l'utilisateur envoie lorsqu'il rentre ses informations dans la barre de connexion. En effet, pour que les deux mots de passe concordent, il faudrait crypter celui qui est envoyé ou décrypter celui de la base de données. Puisque la fonction <strong>sha1</strong> ne permet pas le décryptage, nous devons ainsi absolument crypter celui que l'utilisateur nous envoie, comme je le montre dans le code source.</p></aside><p id="r-368166" data-claire-element-id="368166">Voici donc le code PHP à écrire :</p><pre id="r-368167" data-claire-element-id="368167"><code data-claire-semantic="html+php">&lt;?php
$pseudo = mysql_real_escape_string(htmlspecialchars($_POST['pseudo']));
$passe = mysql_real_escape_string(htmlspecialchars($_POST['passe']));
//Je crypte $passe avec la fonction &quot;sha1&quot;
$passe = sha1($passe);
$nbre = mysql_query(&quot;SELECT COUNT(*) AS exist FROM connexion WHERE pseudo='$pseudo'&quot;);
$donnees = mysql_fetch_array($nbre);
if($donnees['exist'] != 0) //si le pseudo existe
{
// C'est ici que l'on met le reste du script servant à se connecter.
}
?&gt;</code></pre><p id="r-368168" data-claire-element-id="368168">Donc, on calcule le nombre de fois que l'on a le pseudo dans la BDD. Si ce n'est pas égal à 0, on peut tenter de se connecter sans risquer une erreur disant que le pseudo n'est pas dans la BDD. Voici donc le script afin de vérifier si le couple pseudo / mot de passe est bon.</p><pre id="r-368169" data-claire-element-id="368169"><code data-claire-semantic="html+php">&lt;?php
$quete = mysql_query(&quot;SELECT * FROM connexion WHERE pseudo='$pseudo'&quot;);
$infos = mysql_fetch_array($quete);
if($passe == $infos['passe'])
{
// C'est ici que je mets le code servant à effectuer la connexion, car le mot de passe est bon.
}
else // Si le couple pseudo / mdp n'est pas bon.
{
echo 'Vous n\'avez pas rentré les bons identifiants';
}
?&gt;</code></pre><p id="r-368170" data-claire-element-id="368170">Je vais donc chercher dans la BDD le mot de passe associé au pseudo entré. Si le mot de passe de la BDD et le mot de passe entré s'égalent, je continue la connexion. Sinon, j'affiche un message d'erreur.</p><p id="r-368171" data-claire-element-id="368171">Pour la suite du code, je vais vous envoyer vers un autre tutoriel qui m'a d'ailleurs permis d'être capable de faire le script de mon tutoriel. Voici le lien vers le tutoriel <a href="http://www.siteduzero.com/tutoriel-3-69651-creer-un-espace-membre-pour-son-site.html">afin de finir la connexion</a>.</p><p id="r-368172" data-claire-element-id="368172">Je vous montre maintenant le script complet de cette sous-partie, en incluant les commentaires.</p><pre id="r-368173" data-claire-element-id="368173"><code data-claire-semantic="html+php">&lt;?php
mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;&quot;);
mysql_select_db(&quot;nom_db&quot;);
$pseudo = mysql_real_escape_string(htmlspecialchars($_POST['pseudo']));
$passe = mysql_real_escape_string(htmlspecialchars($_POST['passe']));
// Je crypte $passe avec la fonction &quot;sha1&quot;.
$passe = sha1($passe);
$nbre = mysql_query(&quot;SELECT COUNT(*) AS exist FROM connexion WHERE pseudo='$pseudo'&quot;);
$donnees = mysql_fetch_array($nbre);
if($donnees['exist'] != 0) // Si le pseudo existe.
{
$quete = mysql_query(&quot;SELECT * FROM connexion WHERE pseudo='$pseudo'&quot;);
$infos = mysql_fetch_array($quete);
if($passe == $infos['passe'])
{
// C'est ici que je mets le code servant à effectuer la connexion, car le mot de passe est bon.
}
else // Si le couple pseudo/ mot de passe n'est pas bon.
{
echo 'Vous n\'avez pas rentré les bons identifiants';
}
}
?&gt;</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur">Système d&#039;inscription avec validation par l&#039;administrateur</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
Créer le formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
Traiter les données du formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
La page de validation des nouveaux inscrits
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
Script pour la connexion
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
Script pour la vérification de connexion
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
<span class="arrow"></span>
<span class="next">La page de validation des nouveaux inscrits</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
<span class="next">Script pour la vérification de connexion</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Scriptpourlavrificationdeconnexion"></a><h2>Script pour la vérification de connexion</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
<span class="arrow"></span>
<span class="next">Script pour la connexion</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-368175" data-claire-element-id="368175">À présent, la grosse partie du tutoriel est terminée. Par contre, bien que vous puissiez faire un formulaire d'inscription et valider un membre, celui-ci n'a toujours pas de restrictions pour entrer sur une certaine page. Je vais donc vous montrer dans cette courte sous-partie comment créer ce script. Je vous conseille en fait de créer une page qui vérifie la connexion et de l'inclure sur chaque page à protéger. Dans mon cas, j'appellerai cette page verification.php.</p><p id="r-368176" data-claire-element-id="368176">Je vous mets le code PHP et je vous explique après.</p><pre id="r-368177" data-claire-element-id="368177"><code data-claire-semantic="html+php">&lt;?php
session_start();
if(!isset($_SESSION['pseudo']))
{
}
?&gt;</code></pre><p id="r-368178" data-claire-element-id="368178">D'abord, on commence par ouvrir la session, comme l'explique le tutoriel pour un membre simple dont j'ai donné le lien à la fin de la précédente sous-partie. Ensuite, je prends pour acquis que vous avez créé une session nommée pseudo. Je demande de vérifier si elle n'existe PAS. En effet, cela est plus simple pour la suite que si on regarde si elle existe.</p><p id="r-368179" data-claire-element-id="368179">Voici la suite à mettre entre accolades « { » :</p><pre id="r-368180" data-claire-element-id="368180"><code data-claire-semantic="html+php">&lt;?php
echo 'Vous n\'êtes pas connecté au site. Vous ne pouvez donc pas venir sur cette page.';
exit;
?&gt;</code></pre><p id="r-368181" data-claire-element-id="368181">Premièrement, on affiche un message d'erreur, car si on en arrive là, c'est que la personne n'est PAS connectée. Ensuite, je mets la fonction exit, ce qui fait que la page cesse de se faire. Donc, vous n'avez pas besoin de mettre un else.</p><p id="r-368182" data-claire-element-id="368182">C'est déjà tout, mais je vais vous montrer la page complète ainsi que ce qu'il faut mettre sur chaque page à protéger pour que tout fonctionne convenablement (vous verrez, c'est TRÈS facile ;) ).</p><pre id="r-368183" data-claire-element-id="368183"><code data-claire-semantic="html+php">&lt;?php
session_start();
if(!isset($_SESSION['pseudo']))
{
echo 'Vous n\'êtes pas connecté au site. Vous ne pouvez donc pas venir sur cette page.';
exit;
}
?&gt;</code></pre><p id="r-368184" data-claire-element-id="368184">Et le code à inscrire sur chaque page :</p><pre id="r-368185" data-claire-element-id="368185"><code data-claire-semantic="html+php">&lt;?php
include(&quot;verification.php&quot;);
?&gt;</code></pre><p id="r-368186" data-claire-element-id="368186">Vous savez maintenant comment faire la validation d'un membre avant qu'il puisse se connecter. En cas de question ou de problème, vous pouvez me contacter. Par contre, je ne pense pas qu'il devrait y avoir de problème, car j'ai testé tout ce que j'ai écrit et cela a fonctionné.</p><p id="r-368187" data-claire-element-id="368187">Je vous souhaite donc bonne chance pour votre futur site !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur">Système d&#039;inscription avec validation par l&#039;administrateur</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/creer-le-formulaire-d-inscription">
Créer le formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/traiter-les-donnees-du-formulaire-d-inscription">
Traiter les données du formulaire d&#039;inscription
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/la-page-de-validation-des-nouveaux-inscrits">
La page de validation des nouveaux inscrits
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
Script pour la connexion
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-verification-de-connexion">
Script pour la vérification de connexion
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/systeme-d-inscription-avec-validation-par-l-administrateur/script-pour-la-connexion">
<span class="arrow"></span>
<span class="next">Script pour la connexion</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/systeme-d-inscription-avec-validation-par-l-administrateur.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 11:05:32 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/systeme-d-inscription-avec-validation-par-l-administrateur.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:47:27 GMT -->
</html>