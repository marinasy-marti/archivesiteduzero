<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/faire-une-image-anti-robots-ou-captcha-facilement.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:52:56 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/faire-une-image-anti-robots-ou-captcha-facilement.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:41 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Faire une image anti-robots (ou captcha) facilement</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Faire une image anti-robots (ou captcha) facilement</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Faireuneimageanti-robotsoucaptchafacilement">Faire une image anti-robots (ou captcha) facilement</a><br/><a href="#Caractristiquesetexplicationducode">Caractéristiques et explication du code</a><br/><a href="#Crationduscriptprincipal">Création du script principal</a><br/><a href="#Crationdenotreformulairedevrification">Création de notre formulaire de vérification</a><br/><a href="#Crationdelapagedeconfirmation">Création de la page de confirmation</a><br/></div>
<a name="Faireuneimageanti-robotsoucaptchafacilement"></a><h2>Faire une image anti-robots (ou captcha) facilement</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
<span class="next">Caractéristiques et explication du code</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-447487" data-claire-element-id="447487">Bien le bonjour !</p><p id="r-447488" data-claire-element-id="447488">Dans ce tutoriel, nous allons réaliser un générateur de captchas en PHP. Tout d'abord, je réponds à tous ceux qui se posent encore la question :</p><div id="r-447490" data-claire-element-id="447490" data-claire-semantic="question"><p id="r-447489" data-claire-element-id="447489">Qu'est-ce qu'un captcha ?</p></div><p id="r-447491" data-claire-element-id="447491">Un captcha est une image contenant un code que doit composer l'utilisateur lors d'une inscription, dans un formulaire de contact, etc. Ce concept n'est pas sans utilité, évidemment. En effet, cela empêche les robots de poster des messages de spam : sur votre site, sur vos forums, dans votre boîte mail, etc. ;)</p><div id="r-447493" data-claire-element-id="447493" data-claire-semantic="question"><p id="r-447492" data-claire-element-id="447492">C'est compliqué à réaliser ?</p></div><p id="r-447494" data-claire-element-id="447494">Comment dire… Prenez le module GD, une session, une condition, et le compte devrait être bon ! :p <br/> Plus sérieusement, il est extrêmement simple de réaliser une image de ce type. ;)</p><p id="r-447495" data-claire-element-id="447495">Commençons ! :D</p>
</div><a name="Caractristiquesetexplicationducode"></a><h2>Caractéristiques et explication du code</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
<span class="next">Création du script principal</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-447496" data-claire-element-id="447496">Bien, nous allons voir que ce script ne requiert pas beaucoup de choses en soi, étant donné qu'il ne nécessite que GD…</p><div id="r-447498" data-claire-element-id="447498" data-claire-semantic="question"><p id="r-447497" data-claire-element-id="447497">Euh… c'est bien tout ça, mais c'est quoi GD ? o_O</p></div><p id="r-447499" data-claire-element-id="447499"><strong>Vous, vous n'avez pas lu le <a href="tutoriel-3-14668-un-site-dynamique-avec-php.html">tutoriel PHP / MySQL de M@teo 21</a> en entier ! &gt;_</strong></p><p id="r-447500" data-claire-element-id="447500">GD, si vous ne savez pas ce que c'est (et c'est bien dommage ! :p ), est un <strong>module PHP</strong> qui permet de programmer des images dites <em><strong>dynamiques</strong></em>.</p><p id="r-447501" data-claire-element-id="447501">Par exemple, une image de cette sorte peut afficher la date et l'heure actuelles, et tout ce qui est affichable (donc à peu près tout ^^ ) sur une page XHTML.<br/> La différence est que vous affichez ces informations sur… une image ! :o</p><p id="r-447502" data-claire-element-id="447502">Pour plus d'informations sur GD, allez voir <a href="tuto-3-166-1-creer-des-images-en-php.html">le tuto PHP GD de M@teo21</a> qui explique parfaitement toutes les bases. :) <br/> Le module GD est présent chez tous les hébergeurs aujourd'hui. Très rares sont ceux qui ne le prennent pas en charge. ;)</p><h3 id="r-c-est-pas-tout-mais-codons-un-peu" data-claire-element-id="447505">C'est pas tout, mais codons un peu !</h3><p id="r-447503" data-claire-element-id="447503">Ce petit script va s'occuper de créer une variable qui va nous être fort utile : c'est une session, et elle se nomme <strong>aleat_nbr</strong>. :) <br/> Nous comparerons ensuite celle-ci avec une autre variable, comme <strong>$_POST['code_verif']</strong> par exemple…</p><p id="r-447504" data-claire-element-id="447504">Alors sortez tous vos éditeurs, bande de bachi-bouzouks ! :pirate:</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement">Faire une image anti-robots (ou captcha) facilement</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
Caractéristiques et explication du code
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
Création du script principal
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
Création de notre formulaire de vérification
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-la-page-de-confirmation">
Création de la page de confirmation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
<span class="next">Création du script principal</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Crationduscriptprincipal"></a><h2>Création du script principal</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
<span class="arrow"></span>
<span class="next">Caractéristiques et explication du code</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
<span class="next">Création de notre formulaire de vérification</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-447507" data-claire-element-id="447507">Nous allons créer, ici, le script principal de notre image ! :) <br/> En effet, nous allons, avec quelques lignes, créer une image dynamique et aléatoire.</p><p id="r-447508" data-claire-element-id="447508">Pour commencer, créez un fichier nommé <strong>verif_code_gen.php</strong> dans un répertoire vierge.<br/> Ensuite, enregistrez dans le même répertoire <a href="medias/uploads.siteduzero.com_files_11001_12000_11717.png">cette image</a>, que vous appellerez <strong>fond_verif_img.png</strong> (Clic droit &gt; <em>Enregistrer la cible sous…</em>).</p><p id="r-447509" data-claire-element-id="447509">Nous allons tout d'abord ouvrir le fichier verif_code_gen.php, que vous avez normalement créé tout à l'heure.<br/> Il nous faut donc maintenant démarrer la session <strong>avant tout</strong>. Nous devrons ensuite créer une image depuis <strong>fond_verif_img.png</strong>.</p><p id="r-447510" data-claire-element-id="447510">Je vous ajoute en prime dans ce code le header(), pour afficher une image, et la variable $nbr_chiffres, qui contient le nombre de chiffres aléatoires à afficher.</p><p id="r-447511" data-claire-element-id="447511">Voici ce début de code :</p><pre id="r-447512" data-claire-element-id="447512"><code data-claire-semantic="html+php">&lt;?php
// On crée la session avant tout
session_start();

// On définit la configuration :
$nbr_chiffres = 6; // Nombre de chiffres qui formeront le nombre

// Là, on définit le header de la page pour la transformer en image
header (&quot;Content-type: image/png&quot;);
// Là, on crée notre image
$_img = imagecreatefrompng('fond_verif_img.png');</code></pre><p id="r-447513" data-claire-element-id="447513">Il nous faut aussi définir les couleurs de l'image :</p><pre id="r-447514" data-claire-element-id="447514"><code data-claire-semantic="html+php">&lt;?php
// On définit maintenant les couleurs
// Couleur de fond :
$arriere_plan = imagecolorallocate($_img, 0, 0, 0); // Au cas où on n'utiliserait pas d'image de fond, on utilise cette couleur-là.
// Autres couleurs :
$avant_plan = imagecolorallocate($_img, 255, 255, 255); // Couleur des chiffres
?&gt;</code></pre><p id="r-447515" data-claire-element-id="447515">Maintenant, nous allons ajouter le module de &quot;montage&quot; du nombre aléatoire, qui fonctionne grâce à un array et à un <a href="http://fr3.php.net/foreach">foreach()</a>.<br/> Le nombre généré sera ensuite enregistré dans <strong>$_SESSION['aleat_nbr']</strong>.</p><p id="r-447516" data-claire-element-id="447516">À la fin de la génération du code, on détruit toutes les variables inutiles avec la fonction <a href="http://fr3.php.net/unset">unset()</a>.</p><pre id="r-447517" data-claire-element-id="447517"><code data-claire-semantic="html+php">&lt;?php
##### Ici on crée la variable qui contiendra le nombre aléatoire #####
$i = 0;
while($i &lt; $nbr_chiffres) {
        $chiffre = mt_rand(0, 9); // On génère le nombre aléatoire
        $chiffres[$i] = $chiffre;
        $i++;
}
$nombre = null;
// On explore le tableau $chiffres afin d'y afficher toutes les entrées qui s'y trouvent
foreach ($chiffres as $caractere) {
        $nombre .= $caractere;
}
##### On a fini de créer le nombre aléatoire, on le rentre maintenant dans une variable de session #####
$_SESSION['aleat_nbr'] = $nombre;
// On détruit les variables inutiles :
unset($chiffre);
unset($i);
unset($caractere);
unset($chiffres);
?&gt;</code></pre><div id="r-447519" data-claire-element-id="447519" data-claire-semantic="question"><p id="r-447518" data-claire-element-id="447518">Mais ? Pourquoi s'embêter à faire un monstre pareil pour afficher un nombre aléatoire de 6 chiffres ?<br/> Pourquoi ne pas utiliser tout simplement un mt_rand(0, 999999); ?</p></div><p id="r-447520" data-claire-element-id="447520">Ah oui ! :) <br/> Cette question est souvent posée, mais cette technique a pourtant un but.</p><p id="r-447521" data-claire-element-id="447521">En fait, cette méthode n'est pas très fiable. Si le nombre sélectionné est 007865, le code s'affichera comme suit : 7865.<br/> Cela fait donc 2 caractères en moins ! Imaginez que notre mt_rand() sélectionne le nombre 0… Nous nous retrouverions avec un code à 1 caractère… Ça ferait fouillis ! :p</p><p id="r-447522" data-claire-element-id="447522">Donc, pour garder le nombre de caractères, nous devons inscrire 6 entrées dans un array, qui contiendront chacune un nombre aléatoire entre 0 et 9. Or, le chiffre 0 est affiché s'il est seul.</p><div id="r-447524" data-claire-element-id="447524" data-claire-semantic="question"><p id="r-447523" data-claire-element-id="447523">Comment va se dépatouiller notre script dans ce cas ?</p></div><p id="r-447525" data-claire-element-id="447525">Pour résumer, dans ce code, PHP va générer ça différemment.</p><ol id="r-447536" data-claire-element-id="447536"><li id="r-447527" data-claire-element-id="447527"><p id="r-447526" data-claire-element-id="447526">Je crée l'entrée 0 dans l'array, et je sélectionne aléatoirement un chiffre entre 0 et 9.</p></li><li id="r-447529" data-claire-element-id="447529"><p id="r-447528" data-claire-element-id="447528">Je crée l'entrée 1 dans l'array, et je sélectionne aléatoirement un chiffre entre 0 et 9.</p></li><li id="r-447531" data-claire-element-id="447531"><p id="r-447530" data-claire-element-id="447530">Je crée l'entrée 2 dans l'array, et je sélectionne aléatoirement un chiffre entre 0 et 9.</p></li><li id="r-447533" data-claire-element-id="447533"><p id="r-447532" data-claire-element-id="447532">Je crée l'entrée 3 dans l'array, et je sélectionne aléatoirement un chiffre entre 0 et 9.</p></li><li id="r-447535" data-claire-element-id="447535"><p id="r-447534" data-claire-element-id="447534">etc.</p></li></ol><p id="r-447537" data-claire-element-id="447537">Tout simplement ! ;) <br/> Désormais, notre code affichera <strong>007865</strong> au lieu de <strong>7865</strong>. ;)</p><p id="r-447538" data-claire-element-id="447538">Pour terminer notre code, nous allons afficher la variable $nombre (qui je vous le rappelle contient le code généré) dans notre image. Ensuite, nous afficherons notre image, comme ceci :</p><pre id="r-447539" data-claire-element-id="447539"><code data-claire-semantic="html+php">&lt;?php
imagestring($_img, 5, 18, 8, $nombre, $avant_plan);

imagepng($_img);
?&gt;</code></pre><p id="r-447540" data-claire-element-id="447540">Et je vous informe désormais que notre script est… terminé ! :D</p><p id="r-447541" data-claire-element-id="447541">Si vous n'avez grillé aucune étape, et bien écouté en classe, vous devriez avoir un script ressemblant à celui-ci :</p><pre id="r-447542" data-claire-element-id="447542"><code data-claire-semantic="html+php">&lt;?php
// On crée la session avant tout
session_start();

// On définit la configuration :
$nbr_chiffres = 6; // Nombre de chiffres qui formeront le nombre

// Là, on définit le header de la page pour la transformer en image
header (&quot;Content-type: image/png&quot;);
// Là, on crée notre image
$_img = imagecreatefrompng('fond_verif_img.png');

// On définit maintenant les couleurs
// Couleur de fond :
$arriere_plan = imagecolorallocate($_img, 0, 0, 0); // Au cas où on n'utiliserait pas d'image de fond, on utilise cette couleur-là.
// Autres couleurs :
$avant_plan = imagecolorallocate($_img, 255, 255, 255); // Couleur des chiffres

##### Ici on crée la variable qui contiendra le nombre aléatoire #####
$i = 0;
while($i &lt; $nbr_chiffres) {
        $chiffre = mt_rand(0, 9); // On génère le nombre aléatoire
        $chiffres[$i] = $chiffre;
        $i++;
}
$nombre = null;
// On explore le tableau $chiffres afin d'y afficher toutes les entrées qui s'y trouvent
foreach ($chiffres as $caractere) {
        $nombre .= $caractere;
}
##### On a fini de créer le nombre aléatoire, on le rentre maintenant dans une variable de session #####
$_SESSION['aleat_nbr'] = $nombre;
// On détruit les variables inutiles :
unset($chiffre);
unset($i);
unset($caractere);
unset($chiffres);

imagestring($_img, 5, 18, 8, $nombre, $avant_plan);

imagepng($_img);
?&gt;</code></pre><p id="r-447543" data-claire-element-id="447543">Ce simple script vous permet de protéger vos formulaires des vilains robots en soif de spam et autres. :pirate: Avouez que ça fait peur, non ? :p</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement">Faire une image anti-robots (ou captcha) facilement</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
Caractéristiques et explication du code
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
Création du script principal
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
Création de notre formulaire de vérification
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-la-page-de-confirmation">
Création de la page de confirmation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
<span class="arrow"></span>
<span class="next">Caractéristiques et explication du code</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
<span class="next">Création de notre formulaire de vérification</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Crationdenotreformulairedevrification"></a><h2>Création de notre formulaire de vérification</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
<span class="arrow"></span>
<span class="next">Création du script principal</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-la-page-de-confirmation">
<span class="next">Création de la page de confirmation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-447545" data-claire-element-id="447545">Stop !<br/> Voici une partie XHTML que je ne traiterai pas ici. J'estime que si vous en êtes au PHP, vous savez déjà faire du XHTML.</p><aside id="r-447547" data-claire-element-id="447547" data-claire-semantic="information"><p id="r-447546" data-claire-element-id="447546">Si ce n'est pas chose faite, je vous invite à aller lire sans plus attendre <a href="tutoriel-3-13666-apprenez-a-creer-votre-site-web.html">le tutoriel sur le XHTML/CSS de M@teo21</a> ou, si vous le préférez, le livre du même auteur : <a href="http://www.eyrolles.com/Informatique/Livre/reussir-son-site-web-avec-xhtml-et-css-9782212119480">Réussir son site web avec XHTML et CSS</a>. ;)</p></aside><p id="r-447548" data-claire-element-id="447548">Créez tout d'abord le fichier <strong>inscription.html</strong> que vous mettrez dans le même répertoire que tous les autres fichiers créés.</p><p id="r-447549" data-claire-element-id="447549">Ensuite, mettez-y ce code HTML :</p><pre id="r-447550" data-claire-element-id="447550"><code data-claire-semantic="html">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Inscription&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action=&quot;verif_insc.php&quot; method=&quot;post&quot;&gt;
&lt;p&gt;&lt;label&gt;Pseudo&lt;/label&gt; : &lt;input type=&quot;text&quot; name=&quot;pseudo&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;label&gt;Mot de passe&lt;/label&gt; : &lt;input type=&quot;password&quot; name=&quot;mdp&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;label&gt;Retapez votre MdP&lt;/label&gt; : &lt;input type=&quot;password&quot; name=&quot;mdpv&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;label&gt;E-Mail&lt;/label&gt; : &lt;input type=&quot;text&quot; name=&quot;email&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;label&gt;Retapez votre E-Mail&lt;/label&gt; : &lt;input type=&quot;text&quot; name=&quot;emailv&quot; /&gt;&lt;/p&gt;
&lt;!-- On affiche l'image générée par notre script --&gt;
&lt;p&gt;&lt;img src=&quot;verif_code_gen.php&quot; alt=&quot;Code de vérification&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;label&gt;Merci de retaper le code de l'image ci-dessus&lt;/label&gt; : &lt;input type=&quot;text&quot; name=&quot;verif_code&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Inscription&quot; /&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-447551" data-claire-element-id="447551">Rien ne vous empêche de personnaliser ce code comme bon vous semble, ce n'est évidemment qu'un exemple parmi tant d'autres ! :D</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement">Faire une image anti-robots (ou captcha) facilement</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
Caractéristiques et explication du code
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
Création du script principal
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
Création de notre formulaire de vérification
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-la-page-de-confirmation">
Création de la page de confirmation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
<span class="arrow"></span>
<span class="next">Création du script principal</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-la-page-de-confirmation">
<span class="next">Création de la page de confirmation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Crationdelapagedeconfirmation"></a><h2>Création de la page de confirmation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
<span class="arrow"></span>
<span class="next">Création de notre formulaire de vérification</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-447553" data-claire-element-id="447553">Nous voici face à notre visiteur, qui a gentiment lu notre image, et a tout aussi gentiment rempli le champ correspondant, avant de poster le formulaire. :D <br/> Nous nous intéressons à présent au traitement de notre image de vérification.</p><p id="r-447554" data-claire-element-id="447554">Vous devez créer le fichier <strong>verif_insc.php</strong> dans le même répertoire que inscription.html.</p><p id="r-447555" data-claire-element-id="447555">Maintenant, entrez-y ce code :</p><pre id="r-447556" data-claire-element-id="447556"><code data-claire-semantic="html+php">&lt;?php
session_start(); // L'image utilise les sessions. On les active donc ici, car on a besoin de ces informations.
$debut_html = '&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Inscription&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;';
$milieu_html = NULL;
$fin_html = '&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;';

if(IsSet($_POST['verif_code']) AND !Empty($_POST['verif_code'])) { // Le champ du code de confirmation a été rempli
     if($_POST['verif_code']==$_SESSION['aleat_nbr']) { // Si le champ est égal au code généré par l'image
          $milieu_html = 'Vous avez entré le bon code de confirmation !';
     }
     else {
          $milieu_html = 'Votre code de confirmation n\'est pas bon ! Merci de réessayer.&lt;br /&gt;&lt;a href=&quot;#&quot; onclick=&quot;history.go(-1);&quot;&gt;Retour&lt;/a&gt;';
     }
}
else {
    $milieu_html = 'Vous devez remplir le champ du code de confirmation !';
}

// Là, on affiche toute la source générée :
echo $debut_html . $milieu_html . $fin_html;

?&gt;</code></pre><p id="r-447557" data-claire-element-id="447557">La ligne 15, qui a été surlignée, nous intéresse tout particulièrement :</p><pre id="r-447558" data-claire-element-id="447558"><code data-claire-semantic="html+php">&lt;?php
     if($_POST['verif_code']==$_SESSION['aleat_nbr']) { // Si le champ est égal au code généré par l'image
?&gt;</code></pre><p id="r-447559" data-claire-element-id="447559">Cette condition, aussi simple soit-elle, nous permet tout simplement de vérifier si le code qu'a entré l'utilisateur (<strong>$_POST['verif_code']</strong>) est identique à celui de notre image (<strong>$_SESSION['aleat_nbr']</strong>). :)</p><p id="r-447560" data-claire-element-id="447560">Vous pouvez modifier ce script comme bon vous semble, selon vos besoins. ;)</p><p id="r-447561" data-claire-element-id="447561">Vous avez donc vu la facilité de créer une image captcha pour votre site. :D <br/> Il suffit juste de savoir manier les sessions et le GD ! ^^</p><aside id="r-447563" data-claire-element-id="447563" data-claire-semantic="warning"><p id="r-447562" data-claire-element-id="447562">Cependant, sachez que les robots sont de plus en plus sophistiqués dans l'analyse des images de protection.<br/> Ce tuto n'est qu'une première approche dans le domaine.</p></aside><p id="r-447564" data-claire-element-id="447564">Faites-en bon usage. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement">Faire une image anti-robots (ou captcha) facilement</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/caracteristiques-et-explication-du-code">
Caractéristiques et explication du code
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-du-script-principal">
Création du script principal
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
Création de notre formulaire de vérification
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-la-page-de-confirmation">
Création de la page de confirmation
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/faire-une-image-anti-robots-ou-captcha-facilement/creation-de-notre-formulaire-de-verification">
<span class="arrow"></span>
<span class="next">Création de notre formulaire de vérification</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/faire-une-image-anti-robots-ou-captcha-facilement.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:52:57 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/faire-une-image-anti-robots-ou-captcha-facilement.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:42 GMT -->
</html>