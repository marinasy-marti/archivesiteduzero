<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/geolocalisez-vos-visiteurs-grace-a-leur-ip.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:52:37 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/geolocalisez-vos-visiteurs-grace-a-leur-ip.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:37 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Géolocalisez vos visiteurs grâce à leur IP</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Géolocalisez vos visiteurs grâce à leur IP</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#GolocalisezvosvisiteursgrceleurIP">Géolocalisez vos visiteurs grâce à leur IP</a><br/><a href="#RcuprerlabasededonnesGeoLiteMaxMind">Récupérer la base de données GeoLite MaxMind</a><br/><a href="#Utiliserl039APIPHP">Utiliser l&#039;API PHP</a><br/><a href="#ObtenezuneadressegrceGoogleMaps">Obtenez une adresse grâce à Google Maps</a><br/></div>
<a name="GolocalisezvosvisiteursgrceleurIP"></a><h2>Géolocalisez vos visiteurs grâce à leur IP</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/recuperer-la-base-de-donnees-geolite-maxmind">
<span class="next">Récupérer la base de données GeoLite MaxMind</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-452751" data-claire-element-id="452751">N'avez-vous jamais eu envie de géolocaliser vos visiteurs ? Pour faire des statistiques, préremplir des formulaires, détecter des multicomptes, placer vos membres sur une carte, ou bien tout juste par curiosité ?<br/> Peu importe votre motif, vous apprendrez à géolocaliser vos visiteurs très simplement, et sans dépendre directement de services externes.</p>
</div><a name="RcuprerlabasededonnesGeoLiteMaxMind"></a><h2>Récupérer la base de données GeoLite MaxMind</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
<span class="next">Utiliser l&#039;API PHP</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-452752" data-claire-element-id="452752"><a href="http://www.maxmind.com/">MaxMind</a> est une société qui propose un service de géolocalisation. Si cette entreprise propose une version payante de ses services, elle propose également une version gratuite pour les personnes ne pouvant se permettre de se payer une licence ou souhaitant tester leur solution. Celle-ci, bien que moins précise, apporte tout de même une bonne précision au niveau de la ville. C'est donc à partir de GeoLite (le nom de la version gratuite) que se basera ce tutoriel, mais rien ne vous empêche de faire de même avec la version payante.</p><p id="r-452753" data-claire-element-id="452753">Tout le système repose sur une base de données, c'est ce que GeoLite fournit. Mais que contient cette base de données ? Eh bien elle relie des plages d'adresses IP à des locations.</p><aside id="r-452755" data-claire-element-id="452755" data-claire-semantic="warning"><p id="r-452754" data-claire-element-id="452754">Seules les IP fixes, c'est-à-dire qui ne changent pas, peuvent être géolocalisées. Les IP dynamiques retourneront des résultats très différents de la réalité.</p></aside><p id="r-452756" data-claire-element-id="452756">Il faut donc tout d'abord télécharger cette base de données d'environ 20 Mo. Celle-ci sera utilisée à l'aide d'une API. Différentes API sont disponibles (C, PHP, Java, Perl, Python...) dont vous trouverez de l'aide, en anglais, <a href="http://www.maxmind.com/app/city#api">ici</a>. Dans ce tutoriel, je vous expliquerai comment utiliser l'API PHP.</p><p id="r-452757" data-claire-element-id="452757">Voici maintenant, le lien que vous attendez tous... le lien de téléchargement de la base de données GeoLite. Eh bien, le <a href="http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz">voici</a> !</p><div id="r-452759" data-claire-element-id="452759" data-claire-semantic="question"><p id="r-452758" data-claire-element-id="452758">Heu merci, mais j'en fais quoi de ton fichier après ?</p></div><p id="r-452760" data-claire-element-id="452760">Du calme, du calme !<br/> On va commencer par le décompresser, ce sera déjà un bon début. :p <br/> Pour ce faire, vous devez utiliser un logiciel tel que Winzip, Winrar, ou <strong>7-Zip que vous pouvez trouver en version portable <a href="http://framakey.org/Portables/7zipPortable?from=Portables.Portable7zip">ici</a></strong>.</p><aside id="r-452765" data-claire-element-id="452765" data-claire-semantic="information"><p id="r-452761" data-claire-element-id="452761"><cite>Citation : Site web de GeoLite</cite></p><blockquote id="r-452763" data-claire-element-id="452763"><p id="r-452762" data-claire-element-id="452762">Under the license agreement, all advertising materials and documentation mentioning features or use of this database must display the following acknowledgment: &quot;This product includes GeoLite data created by MaxMind, available from http://www.maxmind.com/.&quot;</p></blockquote><p id="r-452764" data-claire-element-id="452764">Vous devez donc préciser sur votre site que vous utilisez la base de données Geolite et faire un lien vers <a href="http://www.maxmind.com/">maxmind</a>.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip">Géolocalisez vos visiteurs grâce à leur IP</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/recuperer-la-base-de-donnees-geolite-maxmind">
Récupérer la base de données GeoLite MaxMind
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
Utiliser l&#039;API PHP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/obtenez-une-adresse-grace-a-google-maps">
Obtenez une adresse grâce à Google Maps
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
<span class="next">Utiliser l&#039;API PHP</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Utiliserl039APIPHP"></a><h2>Utiliser l&#039;API PHP</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/recuperer-la-base-de-donnees-geolite-maxmind">
<span class="arrow"></span>
<span class="next">Récupérer la base de données GeoLite MaxMind</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/obtenez-une-adresse-grace-a-google-maps">
<span class="next">Obtenez une adresse grâce à Google Maps</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-452767" data-claire-element-id="452767">Je vous conseille avant toute chose de créer un dossier <code>geoloc</code> où l'on y mettra tous les fichiers nécessaires à la géolocalisation, cela évitera de vous perdre surtout si vous êtes aussi bordéliques que moi.</p><p id="r-452768" data-claire-element-id="452768">Tout d'abord, <em>uploadez</em> votre fichier GeoLiteCity.dat dans votre dossier.</p><aside id="r-452770" data-claire-element-id="452770" data-claire-semantic="warning"><p id="r-452769" data-claire-element-id="452769">GeoLiteCity.dat est un fichier binaire, si l'<em>upload</em> échoue, choisissez le type de transfert « binaire » dans votre logiciel FTP. Pensez à le remettre en mode ASCII juste après.</p></aside><p id="r-452771" data-claire-element-id="452771">Maintenant, téléchargez <a href="http://geolite.maxmind.com/download/geoip/api/php/php-1.11.tar.gz">l'API PHP</a> et décompressez là. Nous allons avoir besoins des fichiers suivant :</p><ul id="r-452778" data-claire-element-id="452778"><li id="r-452773" data-claire-element-id="452773"><p id="r-452772" data-claire-element-id="452772">geoip.inc</p></li><li id="r-452775" data-claire-element-id="452775"><p id="r-452774" data-claire-element-id="452774">geoipcity.inc</p></li><li id="r-452777" data-claire-element-id="452777"><p id="r-452776" data-claire-element-id="452776">geoipregionvars.php</p></li></ul><p id="r-452779" data-claire-element-id="452779">Ces fichiers sont nécessaires pour extraire les informations de la base de données, et vous permettre de les récupérer facilement. Mettez-les dans votre dossier <code>geoloc</code>.</p><p id="r-452780" data-claire-element-id="452780">Créez maintenant, toujours dans le dossier <code>geoloc</code>, un fichier exemple.php qui contient le code suivant.</p><pre id="r-452781" data-claire-element-id="452781"><code data-claire-semantic="html+php">&lt;?php
include(&quot;geoipcity.inc&quot;);
include(&quot;geoipregionvars.php&quot;);

$gi = geoip_open(realpath(&quot;GeoLiteCity.dat&quot;),GEOIP_STANDARD);

$record = geoip_record_by_addr($gi,$_SERVER['REMOTE_ADDR']);

echo $record-&gt;country_name . &quot;\n&quot;;
echo $GEOIP_REGION_NAME[$record-&gt;country_code][$record-&gt;region] . &quot;\n&quot;;
echo $record-&gt;city . &quot;\n&quot;;
echo $record-&gt;postal_code . &quot;\n&quot;;
echo $record-&gt;latitude . &quot;\n&quot;;
echo $record-&gt;longitude . &quot;\n&quot;;

geoip_close($gi);

?&gt;</code></pre><p id="r-452782" data-claire-element-id="452782">Et accédez à ce fichier via votre navigateur, vous devriez voir votre localisation ou dans le cas d'une IP dynamique, des informations erronées.</p><aside id="r-452784" data-claire-element-id="452784" data-claire-semantic="warning"><p id="r-452783" data-claire-element-id="452783">Si votre site tourne en local, à l'aide de <a href="http://www.wampserver.com/">Wamp</a> par exemple, vous vous retrouverez face à une page vide vu que <code data-claire-semantic="html+php">&lt;?php $_SERVER['REMOTE_ADDR'] ; ?&gt;</code> retournera <a href="http://fr.wikipedia.org/wiki/127.0.0.1">127.0.0.1</a>.</p></aside><h3 id="r-quelques-precisions-2" data-claire-element-id="452806">Quelques précisions...</h3><pre id="r-452785" data-claire-element-id="452785"><code data-claire-semantic="html+php">&lt;?php
$record = geoip_record_by_addr($gi,$_SERVER['REMOTE_ADDR']);</code></pre><p id="r-452786" data-claire-element-id="452786">Cette fonction nous permet de créer un objet contenant toutes les informations de localisation. Cette fonction prend deux paramètres :</p><ul id="r-452791" data-claire-element-id="452791"><li id="r-452788" data-claire-element-id="452788"><p id="r-452787" data-claire-element-id="452787">la variable contenant la base de données ;</p></li><li id="r-452790" data-claire-element-id="452790"><p id="r-452789" data-claire-element-id="452789">l'adresse IP à géolocaliser.</p></li></ul><aside id="r-452793" data-claire-element-id="452793" data-claire-semantic="information"><p id="r-452792" data-claire-element-id="452792">Ici, <code data-claire-semantic="html+php">&lt;?php $_SERVER['REMOTE_ADDR']; ?&gt;</code> est utilisée. Cette <a href="http://www.siteduzero.com/tutoriel-3-14563-variables-superglobales-sessions-et-cookies.html#ss_part_1">variable superglobale</a> contient l'adresse IP de la personne qui affiche la page.</p></aside><p id="r-452794" data-claire-element-id="452794">Mais nous aurions tout aussi bien pu mettre par exemple l'adresse IP <code>12.210.21.121</code> :</p><pre id="r-452795" data-claire-element-id="452795"><code data-claire-semantic="html+php">&lt;?php
$record = geoip_record_by_addr($gi,&quot;12.210.21.121&quot;);</code></pre><p id="r-452796" data-claire-element-id="452796">Les informations offertes par la géolocalisation sont les suivantes :</p><pre id="r-452797" data-claire-element-id="452797"><code data-claire-semantic="html+php">&lt;?php
echo $record-&gt;country_name . &quot;\n&quot;; // nom du pays
echo $GEOIP_REGION_NAME[$record-&gt;country_code][$record-&gt;region] . &quot;\n&quot;; // nom de la region
echo $record-&gt;city . &quot;\n&quot;; // nom de la ville
echo $record-&gt;postal_code . &quot;\n&quot;; // code postal
echo $record-&gt;latitude . &quot;\n&quot;; // latitude
echo $record-&gt;longitude . &quot;\n&quot;; // longitude</code></pre><aside id="r-452799" data-claire-element-id="452799" data-claire-semantic="error"><p id="r-452798" data-claire-element-id="452798">$record-&gt;region ne retourne pas le nom de la région !</p></aside><p id="r-452800" data-claire-element-id="452800">En effet, il faut utiliser <code data-claire-semantic="html+php">&lt;?php $GEOIP_REGION_NAME[$record-&gt;country_code][$record-&gt;region]; ?&gt;</code> qui se base sur <code>$record-&gt;country_code</code> ainsi que sur <code>$record-&gt;region</code> qui lui renvoie un identifiant de région.</p><p id="r-452801" data-claire-element-id="452801">Il existe également <code>$record-&gt;country_code</code>, <code>$record-&gt;country_code3</code>, <code>$record-&gt;area_code</code>, <code>$record-&gt;metro_code</code> et <code>$record-&gt;continent_code</code>.</p><aside id="r-452803" data-claire-element-id="452803" data-claire-semantic="warning"><p id="r-452802" data-claire-element-id="452802">Certaine information, comme <code>$record-&gt;postal_code</code> ne fonctionne pas dans tous les pays. En l'ocurance, si vous souhaitez récupérer le code postal d'un internaute français, c'est impossible avec cette méthode. ¨Mais ne vous inquiétez pas, vous trouverez une solution grâce à google dans la suite du tutoriel.</p></aside><p id="r-452804" data-claire-element-id="452804">Si vous n'avez besoin que du pays de l'internaute, vous pouvez directement utiliser cette fonction :</p><pre id="r-452805" data-claire-element-id="452805"><code data-claire-semantic="html+php">&lt;?php
echo geoip_country_name_by_addr($gi, $_SERVER['REMOTE_ADDR']);
?&gt;</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip">Géolocalisez vos visiteurs grâce à leur IP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/recuperer-la-base-de-donnees-geolite-maxmind">
Récupérer la base de données GeoLite MaxMind
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
Utiliser l&#039;API PHP
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/obtenez-une-adresse-grace-a-google-maps">
Obtenez une adresse grâce à Google Maps
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/recuperer-la-base-de-donnees-geolite-maxmind">
<span class="arrow"></span>
<span class="next">Récupérer la base de données GeoLite MaxMind</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/obtenez-une-adresse-grace-a-google-maps">
<span class="next">Obtenez une adresse grâce à Google Maps</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ObtenezuneadressegrceGoogleMaps"></a><h2>Obtenez une adresse grâce à Google Maps</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
<span class="arrow"></span>
<span class="next">Utiliser l&#039;API PHP</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-452808" data-claire-element-id="452808">Il est possible d'obtenir une localisation plus précise grâce à Google Maps.<br/> Bien sûr, ce n'est pas précis à 100 % mais c'est toujours mieux que le nom d'une ville.<br/> Pour commencer, l'URL magique :<br/>http:<em>/</em>/maps.google.com/maps/geo?output=csv&amp;q=latitude,longitude</p><p id="r-452809" data-claire-element-id="452809">Par exemple, rendez-vous ici :<br/>http:<em>/</em>/maps.google.com/maps/geo?output=csv&amp;q=48.8566667,2.3609871<br/> Que voit-on ?</p><p id="r-452810" data-claire-element-id="452810"><cite>Citation : Google Map</cite></p><blockquote id="r-452812" data-claire-element-id="452812"><p id="r-452811" data-claire-element-id="452811">200,8,&quot;13-17 Rue Pavée, 75004 Paris, France&quot;</p></blockquote><p id="r-452813" data-claire-element-id="452813">200 veut dire que tout va bien, 8 c'est la précision, et, voilà enfin ce qui nous intéresse... l'adresse !</p><p id="r-452814" data-claire-element-id="452814">Voici donc le script pour récupérer l'adresse :</p><pre id="r-452815" data-claire-element-id="452815"><code data-claire-semantic="html+php">&lt;?php
include(&quot;geoipcity.inc&quot;);
include(&quot;geoipregionvars.php&quot;);

$gi = geoip_open(realpath(&quot;GeoLiteCity.dat&quot;),GEOIP_STANDARD);

$record = geoip_record_by_addr($gi,$_SERVER['REMOTE_ADDR']);

$la = $record-&gt;latitude;
$lo = $record-&gt;longitude;

$url = &quot;http://maps.google.com/maps/geo?output=csv&amp;q=&quot;.$la.&quot;,&quot;.$lo;

if($csv = file_get_contents($url))
{
   if(substr($csv,0,3)!=200)
   {
      die(&quot;Erreur&quot;);
   }
   else
   {
      $adresse = substr($csv, 7, -1);
      echo $adresse;
   }
}
else
{
   echo &quot;Erreur&quot;;
}


geoip_close($gi);

?&gt;</code></pre><p id="r-452816" data-claire-element-id="452816">C'est très simple, on récupère la latitude et longitude comme on a vu précédemment, puis on récupère les infos via l'url magique, et on supprime l'inutile en tronquant la chaîne avec la fonction <a href="http://php.net/manual/fr/function.substr.php">substr</a>.<br/> Et nous avons donc affiché, par exemple : <code>13-17 Rue Pavée, 75004 Paris, France</code>.</p><h3 id="r-obtenir-des-informations-plus-poussees" data-claire-element-id="452825">Obtenir des informations plus poussées</h3><p id="r-452817" data-claire-element-id="452817">Il existe un moyen d'obtenir encore plus d'informations. Hélas, cela ne fonctionne que sur une version de php ultérieure à 5.2.0 à cause de la fonction <strong>json_decode</strong> qui n'existe que depuis cette version. Si vous avez une version antérieure à cette dernière, vous devriez trouver des bibliothèques qui permettent de simuler cette fonction.<br/> Ce coup-ci, nous allons utiliser l'url suivante : http:<em>/</em>/maps.google.com/maps/geo?output=json&amp;q=latitude,longitude<br/> Si vous avez testé cette url (en lui fournissant une latitude et longitude), vous avez dû voir plein d'informations sous une structure particulière (c'est du JSON pour ceux que ça intéresse). Seul problème, php ne connait pas cette structure qui devrait vous faire penser aux <a href="http://www.siteduzero.com/tutoriel-3-14479-les-tableaux.html">tableaux php</a>.<br/> D’ailleurs, nous allons justement transformer ce code JSON en tableau php, et si vous avez suivi le cours, vous avez dû deviner comment nous allons faire.<br/> Comment ? Eh bien avec la fameuse fonction <a href="http://www.php.net/manual/fr/function.json-decode.php">json_decode</a> !<br/> Nous allons d'ailleurs afficher ce tableau afin que vous voyez quelles informations vous sont accessibles (si vous connaissez le JSON, faites attention, le code fourni par google est très mal indenté et vous risquez de vous tromper en récupérant les valeurs).</p><pre id="r-452818" data-claire-element-id="452818"><code data-claire-semantic="html+php">&lt;?php
include(&quot;geoipcity.inc&quot;);
include(&quot;geoipregionvars.php&quot;);

$gi = geoip_open(realpath(&quot;GeoLiteCity.dat&quot;),GEOIP_STANDARD);

$record = geoip_record_by_addr($gi,$_SERVER['REMOTE_ADDR']);

$la = $record-&gt;latitude;
$lo = $record-&gt;longitude;

$url = &quot;http://maps.google.com/maps/geo?output=json&amp;q=&quot;.$la.&quot;,&quot;.$lo;
if($json = file_get_contents($url))
{
$informations = json_decode($json, true);
   if($informations['Status']['code']!=200)
   {
      die(&quot;Erreur&quot;);
   }
   else
   {
      print_r($informations);
   }
}
else
{
   echo &quot;Erreur&quot;;
}


geoip_close($gi);

?&gt;</code></pre><p id="r-452819" data-claire-element-id="452819">Rendez-vous sur la page et regardez le panel d'informations auquel vous avez accès ! Et bonne nouvelle, elles sont sous la forme d'un simple tableau php. Ainsi, si vous souhaitez récupérer le code postal il faut faire comme cela :</p><pre id="r-452820" data-claire-element-id="452820"><code data-claire-semantic="html+php">&lt;?php
include(&quot;geoipcity.inc&quot;);
include(&quot;geoipregionvars.php&quot;);

$gi = geoip_open(realpath(&quot;GeoLiteCity.dat&quot;),GEOIP_STANDARD);

$record = geoip_record_by_addr($gi,$_SERVER['REMOTE_ADDR']);

$la = $record-&gt;latitude;
$lo = $record-&gt;longitude;

$url = &quot;http://maps.google.com/maps/geo?output=json&amp;q=&quot;.$la.&quot;,&quot;.$lo;
if($json = file_get_contents($url))
{
$informations = json_decode($json, true);
   if($informations['Status']['code']!=200)
   {
      die(&quot;Erreur&quot;);
   }
   else
   {
      echo $informations[&quot;Placemark&quot;][0][&quot;AddressDetails&quot;][&quot;Country&quot;][&quot;AdministrativeArea&quot;][&quot;SubAdministrativeArea&quot;][&quot;Locality&quot;][&quot;DependentLocality&quot;][&quot;PostalCode&quot;][&quot;PostalCodeNumber&quot;];
   }
}
else
{
   echo &quot;Erreur&quot;;
}


geoip_close($gi);

?&gt;</code></pre><div id="r-452822" data-claire-element-id="452822" data-claire-semantic="question"><p id="r-452821" data-claire-element-id="452821">Pourquoi utiliser <code>$info[&quot;Placemark&quot;][0]</code> et pas <code>$info[&quot;Placemark&quot;][1]</code> par exemple ?</p></div><p id="r-452823" data-claire-element-id="452823">Très bonne question ! Vous avez du remarquer que vous receviez plusieurs informations de géolocalisation. Eh bien c'est pour la simple et bonne raison que google détecte plusieurs lieux disponibles en fonction des coordonnées que vous lui avez passées. On prend tout simplement la première localisation car c'est la plus précise ;-)</p><p id="r-452824" data-claire-element-id="452824">Le tutoriel est enfin fini, vous allez pouvoir réaliser votre rêve :<br/> Géolocaliser la belle Cyntia69, membre de votre site depuis trois mois, et ainsi pouvoir lui déclarer votre flamme en bas de son immeuble. :lol: <br/> En tout cas, j'espère que vous avez aimé mon tutoriel.<br/> Si vous avez des questions ou des problèmes, n'hésitez pas (mais ça ne devrait pas arriver).</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip">Géolocalisez vos visiteurs grâce à leur IP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/recuperer-la-base-de-donnees-geolite-maxmind">
Récupérer la base de données GeoLite MaxMind
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
Utiliser l&#039;API PHP
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/obtenez-une-adresse-grace-a-google-maps">
Obtenez une adresse grâce à Google Maps
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/geolocalisez-vos-visiteurs-grace-a-leur-ip/utiliser-l-api-php">
<span class="arrow"></span>
<span class="next">Utiliser l&#039;API PHP</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/geolocalisez-vos-visiteurs-grace-a-leur-ip.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:52:37 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/geolocalisez-vos-visiteurs-grace-a-leur-ip.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:29:37 GMT -->
</html>