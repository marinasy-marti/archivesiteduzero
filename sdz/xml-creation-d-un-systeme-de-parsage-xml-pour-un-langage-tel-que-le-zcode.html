<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 02:45:09 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:36:45 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : [XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : [XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#XMLCrationd039unsystmedeparsageXMLpourunlangagetelquelezCode">[XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</a><br/><a href="#Introductionqu039est-cequ039unsystmedeparsage">Introduction : qu&#039;est-ce qu&#039;un système de parsage ?</a><br/><a href="#LestandardXML">Le standard XML</a><br/><a href="#ApprenonsrecrerlezCode">Apprenons à recréer le zCode !</a><br/><a href="#Unpeuplusloinlesattributsdesbalises">Un peu plus loin : les attributs des balises</a><br/></div>
<a name="XMLCrationd039unsystmedeparsageXMLpourunlangagetelquelezCode"></a><h2>[XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
<span class="next">Introduction : qu&#039;est-ce qu&#039;un système de parsage ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-338090" data-claire-element-id="338090">Bonjour à toi, ami zéro ! Si tu viens par ici, c'est que le titre de ce tutoriel t'a accroché, et je vais essayer de ne pas te décevoir. Tu as sûrement l'habitude des cours simples et clairs de <a href="http://www.siteduzero.com/membres-294-3.html">M@teo21</a>, et je vais essayer de faire aussi bien que lui (bien que je n'aie pas autant d'expérience dans ce domaine).</p><p id="r-338091" data-claire-element-id="338091">Comme son nom l'indique, ce magnifique tutoriel va s'appuyer sur le zCode, donc avant de lire celui-ci, tu dois connaître le zCode.<br/> Si tu ne le connais pas, va d'abord lire <a href="http://www.siteduzero.com/tuto-3-198-1-bien-utiliser-le-zcode.html">le premier chapitre rédigé par l'auteur du zCode</a>.</p><p id="r-338092" data-claire-element-id="338092">C'est un mini-tuto assez long, mais le sujet est vaste, et surtout <strong>vous pourrez réaliser votre propre système de zCode complet à la fin</strong> : ça en vaut donc la chandelle !</p>
</div><a name="Introductionqu039est-cequ039unsystmedeparsage"></a><h2>Introduction : qu&#039;est-ce qu&#039;un système de parsage ?</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
<span class="next">Le standard XML</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-un-peu-d-histoire-11" data-claire-element-id="338099">Un peu d'histoire</h2><h3 id="r-definitions-5" data-claire-element-id="338096">Définitions</h3><p id="r-338093" data-claire-element-id="338093">Le mot <strong>parsage</strong> nous vient du verbe anglais <em>to parse</em>, qui signifie littéralement <em>analyser</em> et a donné naissance au néologisme français « parser », qui est un simple synonyme d'analyser. C'est une francisation employée couramment dans le monde de la programmation d'aujourd'hui.<br/> Le <strong>parsage</strong> est le fait d'analyser quelque chose.<br/> Le <strong>parseur</strong> est le script qui analyse une donnée d'entrée.<br/> Un système de parsage est donc un système d'analyse. Un système de parsage XML est un système d'analyse XML.</p><div id="r-338095" data-claire-element-id="338095" data-claire-semantic="question"><p id="r-338094" data-claire-element-id="338094">Analyse, c'est bien gentil, mais ça sert à quoi d’analyser ?</p></div><h3 id="r-generalisation" data-claire-element-id="338098">Généralisation</h3><p id="r-338097" data-claire-element-id="338097">Un système d'analyse de code en soi ne sert à rien. En effet, ça ne sert à rien de savoir qu'il y a une variable, une chaîne de caractères ou encore un bloc d'instructions à un endroit : il faut bien faire quelque chose de ce code !<br/> C'est pourquoi un système de parsage va rarement seul, et sert à appliquer un traitement à l'objet d'analyse.<br/> De cette façon, beaucoup de personnes ont étendu le mot parsage à système de transformation. Ce système de parsage utilise un parseur, qui fait la moitié du travail : l'analyse de la donnée d'entrée. Reste la deuxième moitié : la transformation.</p><h2 id="r-le-tout-en-schema" data-claire-element-id="338103">Le tout en schéma</h2><figure id="r-338101" data-claire-element-id="338102"><img id="r-338100" data-claire-element-id="338100" src="medias/uploads.siteduzero.com_files_104001_105000_104879.gif" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode">[XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
Introduction : qu&#039;est-ce qu&#039;un système de parsage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
Le standard XML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
Apprenons à recréer le zCode !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/un-peu-plus-loin-les-attributs-des-balises">
Un peu plus loin : les attributs des balises
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
<span class="next">Le standard XML</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LestandardXML"></a><h2>Le standard XML</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
<span class="arrow"></span>
<span class="next">Introduction : qu&#039;est-ce qu&#039;un système de parsage ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
<span class="next">Apprenons à recréer le zCode !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-definition-buts-et-origine" data-claire-element-id="338123">Définition, buts et origine</h2><h3 id="r-definition-41" data-claire-element-id="338106">Définition</h3><p id="r-338105" data-claire-element-id="338105">XML est un langage de description de données. XML est l'abréviation de <em>eXtensible Markup Language</em>. C'est un langage de balises (<em>markup language</em>) extensible, c'est-à-dire que l'on peut définir ses propres balises et leur signification.</p><h3 id="r-buts-et-origine" data-claire-element-id="338122">Buts et origine</h3><p id="r-338107" data-claire-element-id="338107">À l'origine de XML, il y a le W3C, qui a créé un groupe de travail en 1996. La norme XML 1.0 a été publiée le 10 février 1998.<br/> XML avait pour but d'être utilisable sans difficulté sur Internet et de soutenir un grand nombre d'applications. Le langage devait être clair, facile et rapide à écrire tout en étant compréhensible par l'homme.<br/> La dernière norme XML est la 1.1 (2e version), publiée le 16 août 2006.</p><p id="r-338108" data-claire-element-id="338108">Comme tu peux le voir, XML avait de grandes ambitions... qui ont été réalisées avec succès ! XML est aujourd'hui un standard reconnu !<br/> Grâce à son succès, un vrai monde s'est formé autour de XML (on l'appelle la galaxie XML). En voici les composantes les plus connues :</p><ul id="r-338121" data-claire-element-id="338121"><li id="r-338110" data-claire-element-id="338110"><p id="r-338109" data-claire-element-id="338109">XPath ;</p></li><li id="r-338112" data-claire-element-id="338112"><p id="r-338111" data-claire-element-id="338111">XLink ;</p></li><li id="r-338114" data-claire-element-id="338114"><p id="r-338113" data-claire-element-id="338113">XSL ;</p></li><li id="r-338116" data-claire-element-id="338116"><p id="r-338115" data-claire-element-id="338115">XQuery ;</p></li><li id="r-338118" data-claire-element-id="338118"><p id="r-338117" data-claire-element-id="338117">DOM ;</p></li><li id="r-338120" data-claire-element-id="338120"><p id="r-338119" data-claire-element-id="338119">RDF.</p></li></ul><h2 id="r-les-notions-du-langage" data-claire-element-id="338139">Les notions du langage</h2><p id="r-338124" data-claire-element-id="338124">La base du langage est le nœud, ce qui permet de représenter un document XML sous forme d'un arbre.</p><p id="r-338125" data-claire-element-id="338125">XML définit des nœuds de 3 types :</p><ul id="r-338132" data-claire-element-id="338132"><li id="r-338127" data-claire-element-id="338127"><p id="r-338126" data-claire-element-id="338126">élément ;</p></li><li id="r-338129" data-claire-element-id="338129"><p id="r-338128" data-claire-element-id="338128">attribut ;</p></li><li id="r-338131" data-claire-element-id="338131"><p id="r-338130" data-claire-element-id="338130">texte simple.</p></li></ul><p id="r-338133" data-claire-element-id="338133">Un nœud élément peut contenir ou non des nœuds attributs. L'ensemble composé d'un nœud élément, et des nœuds attributs associés au nœud élément s'appelle une <strong>balise</strong>.<br/> Seuls les nœuds éléments peuvent contenir des sous-nœuds, mais ils peuvent en contenir une infinité.</p><aside id="r-338135" data-claire-element-id="338135" data-claire-semantic="warning"><p id="r-338134" data-claire-element-id="338134">Ce qui vient d'être dit est très important : relis-le pour être sûr d'avoir tout compris et ne pas confondre les termes nœud, élément et attribut !</p></aside><p id="r-338136" data-claire-element-id="338136">Un document XML possède un prologue (obligatoire depuis la norme 1.1) : le DTD (définition du type de document en français). Cette DTD sert à définir les éléments de la page, ainsi que leurs attributs et les éléments qu'ils peuvent contenir.<br/> D'autres prologues sont disponibles, comme le XML Schema, qui intègre toutes les nouveautés de la norme 1.1, mais ils sont encore peu utilisés.</p><aside id="r-338138" data-claire-element-id="338138" data-claire-semantic="information"><p id="r-338137" data-claire-element-id="338137">XHTML est une DTD qui définit tous les éléments que vous connaissez : &lt;html&gt;, &lt;head&gt;, &lt;title&gt;, &lt;body&gt;, &lt;div&gt;, etc.</p></aside><h2 id="r-en-bref-4" data-claire-element-id="338141">En bref</h2><p id="r-338140" data-claire-element-id="338140">La norme XML a suscité un grand engouement et possède maintenant une grande communauté active. Le monde XML est éprouvé et peut être utilisé dans beaucoup de langages, dont le PHP, qui intègre pas moins de 6 extensions différentes pour faire du XML.<br/> Le XML t'intéresse ? Tu peux aller lire <a href="http://www.siteduzero.com/tuto-3-2882-1-le-point-sur-xml.html">ce tutoriel</a> qui le décrit plus longuement.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode">[XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
Introduction : qu&#039;est-ce qu&#039;un système de parsage ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
Le standard XML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
Apprenons à recréer le zCode !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/un-peu-plus-loin-les-attributs-des-balises">
Un peu plus loin : les attributs des balises
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
<span class="arrow"></span>
<span class="next">Introduction : qu&#039;est-ce qu&#039;un système de parsage ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
<span class="next">Apprenons à recréer le zCode !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ApprenonsrecrerlezCode"></a><h2>Apprenons à recréer le zCode !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
<span class="arrow"></span>
<span class="next">Le standard XML</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/un-peu-plus-loin-les-attributs-des-balises">
<span class="next">Un peu plus loin : les attributs des balises</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-338143" data-claire-element-id="338143">Il est maintenant temps d'entrer dans le vif du sujet : la réalisation du parseur pour le zCode !</p><p id="r-338144" data-claire-element-id="338144">Regardons les outils à notre disposition pour traiter du XML sur <a href="http://fr.php.net/">php.net</a>.<br/> Recherchons « XML », nous tombons sur <a href="http://fr.php.net/manual/fr/ref.xml.php">cette page</a>.</p><p id="r-338145" data-claire-element-id="338145">Voici un parseur XML pour PHP ! La popularité de XML est donc au rendez-vous et nous trouvons des librairies officielles toutes prêtes. :) En vrai, il en existe encore d'autres pour PHP : XMLReader, XMLWriter, DOM, DOMXML et XMLRPC. Mais nous utiliserons XML (la première citée), car elle est utilisable sans installation et dans toutes les versions de PHP.</p><p id="r-338146" data-claire-element-id="338146">Regardons maintenant ce qu'elle permet de faire. Lisons un peu la documentation, et nous tombons sur <a href="http://fr.php.net/manual/fr/ref.xml.php">cet exemple</a> :</p><p id="r-338147" data-claire-element-id="338147"><cite>Citation : http://fr.php.net/manual/fr/ref.xml.php</cite></p><blockquote id="r-338149" data-claire-element-id="338149"><p id="r-338148" data-claire-element-id="338148">Example#2 Transtypage XML -&gt; HTML</p></blockquote><p id="r-338150" data-claire-element-id="338150">Voici quelque chose de très intéressant : cette exemple transforme les balises &lt;BOLD&gt; en &lt;B&gt;, les balises &lt;EMPHASIS&gt; en &lt;I&gt;, les balises &lt;LITERAL&gt; en &lt;TT&gt;, et ignorent toutes les autres balises ! Nous n'avons pas encore réfléchi quant au comportement à adopter avec les balises inconnues, mais les ignorer semble pas mal : cela règle un bon nombre de problèmes de sécurité.</p><p id="r-338151" data-claire-element-id="338151">C'est presque ce qu'on veut (pas tout à fait, quand même...) : on veut transformer &lt;gras&gt; en &lt;span style=&quot;gras&quot;&gt;, par exemple !</p><p id="r-338152" data-claire-element-id="338152">Attardons-nous donc deux secondes sur le code pour voir comment il fonctionne.</p><p id="r-338153" data-claire-element-id="338153">Dans l'exemple, nous pouvons voir la ligne suivante :</p><pre id="r-338154" data-claire-element-id="338154"><code data-claire-semantic="html+php">&lt;?php xml_set_element_handler($xml_parser, &quot;startElement&quot;, &quot;endElement&quot;);</code></pre><p id="r-338155" data-claire-element-id="338155">Cette ligne indique en fait au parseur des fonctions de « callback » à appeler lorsqu'il rencontre un tag d'ouverture ou de fermeture d'une balise (il faut spécifier les deux). Ici, la fonction de callback pour un élément ouvrant est startElement(), et celle pour un élément fermant est endElement().</p><p id="r-338156" data-claire-element-id="338156">La fonction de callback pour un tag d'ouverture prend 3 arguments en paramètre. Le premier vous fournit une référence vers le parseur, le deuxième vous fournit le nom de la balise (BOLD, EMPHASIS, LITERAL, ... ), et enfin les attributs de cette balise (comme par exemple son ID).<br/> La fonction de callback pour les tags de fermeture prend les deux mêmes premiers arguments que la fonction de callback pour les tags d'ouverture.</p><aside id="r-338158" data-claire-element-id="338158" data-claire-semantic="warning"><p id="r-338157" data-claire-element-id="338157">Par défaut, les noms des balises et des attributs sont convertis en majuscules par le parseur : faites bien attention !</p></aside><p id="r-338159" data-claire-element-id="338159">Vous pouvez changer ce comportement en utilisant la commande ci-dessous :</p><pre id="r-338160" data-claire-element-id="338160"><code data-claire-semantic="html+php">&lt;?php xml_parser_set_option($xml_parser, XML_OPTION_CASE_FOLDING, false);</code></pre><aside id="r-338162" data-claire-element-id="338162" data-claire-semantic="information"><p id="r-338161" data-claire-element-id="338161">Cette fonction permet également de modifier d'autres options telles que l'encodage de sortie notamment (référez-vous à la documentation pour une liste exhaustive).</p></aside><p id="r-338163" data-claire-element-id="338163">La ligne suivante de l'exemple est :</p><pre id="r-338164" data-claire-element-id="338164"><code data-claire-semantic="html+php">&lt;?php xml_set_character_data_handler($xml_parser, &quot;characterData&quot;);</code></pre><p id="r-338165" data-claire-element-id="338165">Cette ligne indique également une fonction de callback, mais ce coup-ci, c'est pour le texte littéral, c'est-à-dire ce qu'il y a entre les balises.<br/> Cette fonction de callback prend deux paramètres : une référence vers le parseur et les données (le texte).</p><p id="r-338166" data-claire-element-id="338166">Ces fonctions de callback jouent un rôle déterminant dans le traitement à appliquer aux données de départ.</p><p id="r-338167" data-claire-element-id="338167">Dans la fonction startElement(), nous avons le code suivant :</p><pre id="r-338168" data-claire-element-id="338168"><code data-claire-semantic="html+php">&lt;?php if (isset($map_array[$name]))</code></pre><p id="r-338169" data-claire-element-id="338169">Cette condition permet de repérer si la balise rencontrée doit être remplacée par notre parseur ou non. Cette condition sert à traiter uniquement les balises contenues dans le tableau $map_array, et d'ignorer les autres.</p><p id="r-338170" data-claire-element-id="338170">La même condition est présente dans la fonction endElement().</p><aside id="r-338172" data-claire-element-id="338172" data-claire-semantic="information"><p id="r-338171" data-claire-element-id="338171">Pour garder un document cohérent, il est indispensable de traiter les mêmes balises dans les deux fonctions. Si vous traitez la balise &lt;gras&gt; et que vous la transformez en &lt;span class=&quot;gras&quot;&gt;, il faudra alors afficher &lt;/span&gt; dans la fonction qui traite les fins de balise afin que le document final soit cohérent.</p></aside><p id="r-338173" data-claire-element-id="338173">Nous avons compris le principe de fonctionnement du script ; modifions maintenant le tableau $map_array et les deux fonctions startElement et endElement afin qu'elles correspondent à notre besoin : afficher &lt;span style=&quot;notre_style_personnalise&quot;&gt; au lieu de nos balises &lt;gras&gt; et &lt;italique&gt; !</p><pre id="r-338174" data-claire-element-id="338174"><code data-claire-semantic="html+php">&lt;?php
// Fichier source
$file = &quot;data.xml&quot;;
 
$map_array = array(
   &quot;GRAS&quot;    =&gt; &quot;font-weight: bold;&quot;,
   &quot;ITALIQUE&quot; =&gt; &quot;font-style: italic;&quot;,
);
 
function startElement($parser, $name, $attrs)
{
   global $map_array;
   if (isset($map_array[$name])) {
       echo '&lt;span style=&quot;'.$map_array[$name].'&quot;&gt;';
       // ou echo '&lt;span class=&quot;'.$name.'&quot;&gt;';
   }
}
 
function endElement($parser, $name)
{
   global $map_array;
   if (isset($map_array[$name])) {
       echo &quot;&lt;/span&gt;&quot;;
   }
}
 
function characterData($parser, $data)
{
   echo $data;
}
 
$xml_parser = xml_parser_create();
// Utilisons la gestion de casse, de manière à être sûrs de trouver la balise dans $map_array
xml_parser_set_option($xml_parser, XML_OPTION_CASE_FOLDING, true);
xml_set_element_handler($xml_parser, &quot;startElement&quot;, &quot;endElement&quot;);
xml_set_character_data_handler($xml_parser, &quot;characterData&quot;);
if (!($fp = fopen($file, &quot;r&quot;))) {
   die(&quot;Impossible de trouver le fichier XML&quot;);
}
 
while ($data = fread($fp, 4096)) {
   if (!xml_parse($xml_parser, $data, feof($fp))) {
       die(sprintf(&quot;erreur XML : %s à la ligne %d&quot;,
                   xml_error_string(xml_get_error_code($xml_parser)),
                   xml_get_current_line_number($xml_parser)));
   }
}
xml_parser_free($xml_parser);
?&gt;</code></pre><p id="r-338175" data-claire-element-id="338175">Nous n'avons donc pas modifié le reste de l'exemple, juste le tableau $map_array et les fonctions startElement et endElement. Cet exemple traite le cas d'un fichier source, mais nous verrons l'intégration d'un formulaire dans une prochaine partie.</p><p id="r-338176" data-claire-element-id="338176">Nous pouvons (une fois de plus, si vous avez l'habitude de travailler avec la documentation) démontrer la puissance de la documentation PHP : nous avons fait un début de parseur XML pour un langage tel que le zCode en moins de 10 minutes !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode">[XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
Introduction : qu&#039;est-ce qu&#039;un système de parsage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
Le standard XML
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
Apprenons à recréer le zCode !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/un-peu-plus-loin-les-attributs-des-balises">
Un peu plus loin : les attributs des balises
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
<span class="arrow"></span>
<span class="next">Le standard XML</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/un-peu-plus-loin-les-attributs-des-balises">
<span class="next">Un peu plus loin : les attributs des balises</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Unpeuplusloinlesattributsdesbalises"></a><h2>Un peu plus loin : les attributs des balises</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
<span class="arrow"></span>
<span class="next">Apprenons à recréer le zCode !</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-338178" data-claire-element-id="338178">Dans cette partie, nous allons regarder de plus près l'utilisation du 3e argument de la fonction de callback pour le parsage des tags d'ouverture de balises.<br/> Il va nous permettre de gérer les balises qui ont des attributs, telles que &lt;couleur nom=&quot;rose&quot;&gt;, par exemple (dont l'attribut nom, vaut « rose »).</p><p id="r-338179" data-claire-element-id="338179">Nous allons nous appuyer sur cette balise dans la suite, mais les balises telles que &lt;taille valeur=&quot;gros&quot;&gt;, &lt;police nom=&quot;times&quot;&gt;, &lt;lien type=&quot;wikipedia&quot;&gt; ou encore &lt;citation nom=&quot;Savageman&quot;&gt; fonctionnent exactement sur le même principe et vous devriez pouvoir les reproduire sans aucun problème.</p><p id="r-338180" data-claire-element-id="338180">Dans le cas de &lt;couleur nom=&quot;rose&quot;&gt;, le nom de la balise serait « COULEUR », et le tableau $attrs contiendrait la paire (clé, valeur) (NOM, rose).</p><p id="r-338181" data-claire-element-id="338181">Il faut donc que lorsqu'on rencontre la balise « COULEUR », nous vérifions si le nom de la couleur est connu et, si c'est le cas, que nous remplacions la balise par le code (x)HTML qui permettrait au navigateur d'interpréter cette couleur. Je vais personnellement utiliser les styles CSS pour gérer tous les éléments du zCode. Ainsi, &lt;span class=&quot;couleur-rose&quot;&gt;texte&lt;/span&gt; me permet d'afficher un texte rose. Le style CSS associé est le suivant :</p><pre id="r-338182" data-claire-element-id="338182"><code data-claire-semantic="css">.couleur-rose { color: pink; }</code></pre><p id="r-338183" data-claire-element-id="338183">Le parsage de la balise couleur pourrait donc se passer de cette façon :</p><pre id="r-338184" data-claire-element-id="338184"><code data-claire-semantic="html+php">&lt;?php
// Liste des couleurs que l'on souhaite gérer
$liste_couleurs = array('rose', 'noir', 'blanc', 'rouge', 'vert', 'bleu');
 
function startElement($parser, $name, $attrs)
{
    global $liste_couleurs;
    if ('COULEUR' == $name &amp;&amp; array_key_exists('NOM', $attrs) &amp;&amp; in_array($attrs['NOM'], $liste_couleurs)) {
        echo '&lt;span class=&quot;couleur-'.$attrs['NOM'].'&quot;&gt;';
    }
}</code></pre><p id="r-338185" data-claire-element-id="338185"><strong>Explications :</strong><code data-claire-semantic="html+php">&lt;?php ('COULEUR' == $name) </code> permet de vérifier que la balise que l'on va traiter est la balise &lt;couleur&gt; (c'est ce qu'on a vu dans la partie précédente).</p><p id="r-338186" data-claire-element-id="338186"><code data-claire-semantic="html+php">&lt;?php (array_key_exists('NOM', $attrs)) </code> permet de vérifier que notre balise &lt;couleur&gt; a bien un attribut nom, et donc qu'elle est bien de la forme &lt;couleur nom=&quot;___&quot;&gt;.<br/> On vérifie que la balise s'appelle COULEUR, puis qu'elle a un attribut NOM, dont nous avons besoin pour récupérer la couleur.</p><pre id="r-338187" data-claire-element-id="338187"><code data-claire-semantic="html+php">&lt;?php (in_array($attrs['NOM'], $liste_couleurs))</code></pre><p id="r-338188" data-claire-element-id="338188">Enfin, on vérifie que l'attribut NOM (je vous rappelle que le parseur met des majuscules automatiquement) existe dans la liste des couleurs autorisées. Si c'est le cas, alors on peut effectuer la transformation.</p><p id="r-338189" data-claire-element-id="338189">Ce tutoriel touche à sa fin. J'espère avoir été clair, qu'il vous aura plu, et que vous aurez compris le principe de la transformation.<br/> Maintenant c'est à vous de travailler pour faire votre propre zCode personnalisé avec les balises que vous aurez choisies, alors au travail !</p><p id="r-338190" data-claire-element-id="338190">Pour toute question, n'hésitez pas à <a href="http://www.siteduzero.com/mp-273-395.html">m'envoyer un message privé</a> !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode">[XML] Création d&#039;un système de parsage XML pour un langage tel que le zCode</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/introduction-qu-est-ce-qu-un-systeme-de-parsage">
Introduction : qu&#039;est-ce qu&#039;un système de parsage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/le-standard-xml">
Le standard XML
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
Apprenons à recréer le zCode !
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/un-peu-plus-loin-les-attributs-des-balises">
Un peu plus loin : les attributs des balises
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode/apprenons-a-recreer-le-zcode">
<span class="arrow"></span>
<span class="next">Apprenons à recréer le zCode !</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 02:45:09 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/xml-creation-d-un-systeme-de-parsage-xml-pour-un-langage-tel-que-le-zcode.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:36:45 GMT -->
</html>