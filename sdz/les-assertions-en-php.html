<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/les-assertions-en-php.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 04:35:31 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-assertions-en-php.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:55:55 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Les assertions en PHP</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/les-assertions-en-php.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Les assertions en PHP</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#LesassertionsenPHP">Les assertions en PHP</a><br/><a href="#Lesassertions">Les assertions</a><br/><a href="#Activonslesassertions">Activons les assertions</a><br/><a href="#Utilisationd039assertions">Utilisation d&#039;assertions</a><br/><a href="#Petitesastuces">Petites astuces</a><br/></div>
<a name="LesassertionsenPHP"></a><h2>Les assertions en PHP</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
<span class="next">Les assertions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-335173" data-claire-element-id="335173">Dans ce tuto, je vais vous présenter des petites bestioles bien utiles aux programmeurs, les <strong>assertions</strong>.</p>
</div><a name="Lesassertions"></a><h2>Les assertions</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
<span class="next">Activons les assertions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-335174" data-claire-element-id="335174">Une assertion est une affirmation logique définie par le développeur. Par exemple : « <em>Le nombre de membres inscrits ne peut être négatif.</em> ».<br/> À l'exécution, PHP évalue toutes les assertions et renvoie une erreur si l'une d'entre elles est fausse.<br/> Les assertions permettent donc de vérifier que des données sont cohérentes et de repérer d'éventuels comportements anormaux.</p><aside id="r-335176" data-claire-element-id="335176" data-claire-semantic="warning"><p id="r-335175" data-claire-element-id="335175">Les assertions sont une sécurité supplémentaire et ne doivent en aucun cas faire partie de votre logique de gestion ; elles ne doivent être utilisées que pour s'assurer de la validité des données.<br/> Les assertions ne doivent pas servir à vérifier des données externes (reçues de l'utilisateur par exemple), dans ces cas-là un <strong>if()</strong> est bien plus adapté.</p></aside><p id="r-335177" data-claire-element-id="335177">Je répète : les assertions ne doivent servir qu'à vérifier des <strong>données internes</strong> à un script.<br/> Elles ne devraient pas être nécessaires au bon fonctionnement de votre application. Elles ne sont là que pour s'assurer que tout se passe bien.</p><p id="r-335178" data-claire-element-id="335178">Les assertions servent surtout pendant la phase de développement pour contrôler un maximum les données utilisées. C'est là leur gros avantage par rapport à une simple condition ; il devient possible de contrôler un maximum sans penser aux performances.<br/> Effectivement, une fois que vous serez sûr(e)s du bon fonctionnement de votre application et que vous aurez besoin de performances, vous pourrez les désactiver (PHP les ignorera silencieusement et le code ne subira aucun ralentissement) ! :magicien:</p><p id="r-335179" data-claire-element-id="335179">C'est pour cela qu'il est conseillé d'utiliser autant que possible les assertions, même aux endroits où vous êtes sûr(e)s de votre code. Le but est de traquer les comportements anormaux. Plus vous aurez d'assertions dans votre code, plus vous aurez de chances de repérer un comportement imprévu. :)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php">Les assertions en PHP</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
Les assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
Activons les assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
Utilisation d&#039;assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/petites-astuces">
Petites astuces
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
<span class="next">Activons les assertions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Activonslesassertions"></a><h2>Activons les assertions</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
<span class="arrow"></span>
<span class="next">Les assertions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
<span class="next">Utilisation d&#039;assertions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-335181" data-claire-element-id="335181">Avant de pouvoir utiliser les assertions, il faut s'assurer qu'elles sont activées ! ;) <br/> Par défaut, elles le sont mais on ne sait jamais. ^^ <br/> Pour activer les assertions, il existe deux méthodes.</p><h3 id="r-dans-le-code" data-claire-element-id="335184">Dans le code</h3><p id="r-335182" data-claire-element-id="335182">Directement dans le code, via la fonction <a href="http://fr.php.net/assert_options">assert_options()</a>.</p><pre id="r-335183" data-claire-element-id="335183"><code data-claire-semantic="html+php">&lt;?php
if(assert_options(ASSERT_ACTIVE)) { // Avec comme argument la constante ASSERT_ACTIVE, assert_options renvoie TRUE si les assertions sont activées, sinon FALSE.
        echo &quot;Les assertions sont déjà activées.&quot;;
}
else
{
        assert_options(ASSERT_ACTIVE, 1); // Avec comme argument un booléen : s'il est vrai, les assertions sont activées, sinon non.
        echo &quot;Les assertions sont désormais activées.&quot;;
}
?&gt;</code></pre><h3 id="r-dans-le-fichier-de-configuration" data-claire-element-id="335191">Dans le fichier de configuration</h3><p id="r-335185" data-claire-element-id="335185">La seconde méthode consiste à modifier le fichier de configuration de PHP, le <em>php.ini</em>.<br/> Cette méthode permet à votre application d'avoir un comportement par défaut. Pendant l'analyse du code, PHP vérifie si la directive assert.active est activée. Si c'est le cas, les assertions sont utilisées, sinon elles sont ignorées.</p><p id="r-335186" data-claire-element-id="335186"><cite>Citation : php.ini</cite></p><blockquote id="r-335188" data-claire-element-id="335188"><p id="r-335187" data-claire-element-id="335187"><strong>assert.active = On ;</strong> les assertions sont prises en compte.<br/><strong>assert.active = Off ;</strong> les assertions sont ignorées.</p></blockquote><aside id="r-335190" data-claire-element-id="335190" data-claire-semantic="information"><p id="r-335189" data-claire-element-id="335189">Les deux méthodes peuvent être utilisées ensemble. La directive définit un comportement par défaut mais, pour une page par exemple, vous pouvez redéfinir le comportement avec la fonction assert_options.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php">Les assertions en PHP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
Les assertions
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
Activons les assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
Utilisation d&#039;assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/petites-astuces">
Petites astuces
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
<span class="arrow"></span>
<span class="next">Les assertions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
<span class="next">Utilisation d&#039;assertions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Utilisationd039assertions"></a><h2>Utilisation d&#039;assertions</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
<span class="arrow"></span>
<span class="next">Activons les assertions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/petites-astuces">
<span class="next">Petites astuces</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-comment-declarer-une-assertion" data-claire-element-id="335203">Comment déclarer une assertion</h2><p id="r-335193" data-claire-element-id="335193">Pour déclarer une nouvelle assertion, il faut utiliser la fonction <a href="http://fr.php.net/assert">assert()</a>. Cette fonction prend en argument l'affirmation <strong>entre apostrophes</strong>.</p><p id="r-335194" data-claire-element-id="335194">Exemple :</p><pre id="r-335195" data-claire-element-id="335195"><code data-claire-semantic="html+php">&lt;?php
assert_options(ASSERT_ACTIVE, 1); // On active les assertions (au cas où).
 
$nombre_news = 50;
$vitesse = 100;
assert('$nombre_news &gt;= 0'); // Le nombre de news ne peut être négatif.
assert('$vitesse &gt; 10 &amp;&amp; $vitesse &lt; 150'); // La vitesse est comprise entre 10 et 150 km/h.
?&gt;</code></pre><aside id="r-335197" data-claire-element-id="335197" data-claire-semantic="warning"><p id="r-335196" data-claire-element-id="335196">Si vous utilisez des guillemets pour contenir votre affirmation, PHP interprète d'abord les variables contenues dedans avant de la fournir en paramètre à la fonction assert(). <br/> L'assertion assert(&quot;!empty($vitesse)&quot;) deviendrait par exemple : assert('!empty(90)'), ce qui poserait problème car empty attend une variable et non une valeur en paramètre.</p></aside><p id="r-335198" data-claire-element-id="335198">Si vous testez ce code, vous allez vous rendre compte que... rien ne se passe ! o_O <br/> Et c'est normal ! On crée une assertion disant que le nombre de news ne peut être négatif et justement, $nombre_news est positif. :D</p><p id="r-335199" data-claire-element-id="335199">Bon : comme ça, ça peut paraître inutile, mais il faut imaginer que la variable utilisée dans l'assertion est le résultat de calcul et n'est pas définie juste avant. ;)</p><aside id="r-335201" data-claire-element-id="335201" data-claire-semantic="warning"><p id="r-335200" data-claire-element-id="335200">Eh ! Je viens de modifier la valeur de $vitesse pour voir. Je lui ai donné 5 comme valeur et j'obtiens ça :<br/><strong>Warning: assert() [function.assert]: Assertion &quot;$vitesse &gt; 10 AND $vitesse &lt; 150&quot; failed in [...] on line x</strong></p></aside><p id="r-335202" data-claire-element-id="335202">C'est une erreur qui nous avertit que l'affirmation de l'assertion n'est plus vraie ($vitesse n'est plus comprise entre 10 et 150). Nous allons justement voir comment gérer les erreurs d'assertion dans la prochaine partie. :p</p><h2 id="r-la-gestion-des-erreurs-1" data-claire-element-id="335244">La gestion des erreurs</h2><p id="r-335204" data-claire-element-id="335204">Lorsqu'une assertion n'est plus vraie, PHP renvoie une magnifique erreur de niveau E_WARNING. Nous allons voir comment personnaliser la gestion des erreurs en utilisant notre propre fonction ! :)</p><h3 id="r-personnalisations-de-la-gestion-des-erreurs" data-claire-element-id="335243">Personnalisations de la gestion des erreurs</h3><p id="r-335205" data-claire-element-id="335205">Nous avons vu auparavant que la fonction <a href="http://fr.php.net/assert_options">assert_options()</a> permet d'activer / désactiver les assertions. Mais cette fonction peut faire bien plus ! Une autre de ses utilisations est de <strong>définir une fonction de callback</strong>. Cette fonction spéciale sera appelée lorsqu'une assertion échouera.</p><p id="r-335206" data-claire-element-id="335206">Voici comment définir cette fonction :</p><pre id="r-335207" data-claire-element-id="335207"><code data-claire-semantic="html+php">&lt;?php
// Définition de la fonction à appeler en cas d'erreur.
assert_options(ASSERT_CALLBACK, 'nom_de_la_fonction');
?&gt;</code></pre><aside id="r-335209" data-claire-element-id="335209" data-claire-semantic="information"><p id="r-335208" data-claire-element-id="335208">Il est aussi possible de définir la fonction à utiliser directement dans le php.ini avec la directive assert.callback. Si vous préférez utiliser cette méthode, pensez bien à inclure votre fonction sur chaque page utilisant les assertions.</p></aside><p id="r-335210" data-claire-element-id="335210">Il ne reste plus qu'à créer votre fonction !</p><div id="r-335212" data-claire-element-id="335212" data-claire-semantic="question"><p id="r-335211" data-claire-element-id="335211">:o Mais comment je la crée, ma fonction de callback ?</p></div><p id="r-335213" data-claire-element-id="335213">Demandons à la doc. :magicien:</p><p id="r-335214" data-claire-element-id="335214"><cite>Citation : La super Doc</cite></p><blockquote id="r-335216" data-claire-element-id="335216"><p id="r-335215" data-claire-element-id="335215">La fonction de callback doit accepter trois arguments. Le premier contient le nom du fichier qui a vu l'assertion échouer. Le second contient le numéro de ligne dans le fichier précédent. Le troisième argument contient l'expression qui a échoué [...].</p></blockquote><p id="r-335217" data-claire-element-id="335217">Votre fonction doit donc accepter trois arguments :</p><ul id="r-335224" data-claire-element-id="335224"><li id="r-335219" data-claire-element-id="335219"><p id="r-335218" data-claire-element-id="335218">le nom du fichier,</p></li><li id="r-335221" data-claire-element-id="335221"><p id="r-335220" data-claire-element-id="335220">la ligne,</p></li><li id="r-335223" data-claire-element-id="335223"><p id="r-335222" data-claire-element-id="335222">l'assertion qui est fausse.</p></li></ul><p id="r-335225" data-claire-element-id="335225">Voici ce que pourrait être votre fonction :</p><pre id="r-335226" data-claire-element-id="335226"><code data-claire-semantic="html+php">&lt;?php
function gestion_assert($script, $ligne, $erreur) // Fonction qui gère les erreurs des assertions.
{
    echo &quot;&lt;p&gt;Une assertion est fausse :&lt;br /&gt;
        &lt;strong&gt;Script&lt;/strong&gt; : &lt;em&gt;$script&lt;/em&gt;&lt;br /&gt;
        &lt;strong&gt;Ligne&lt;/strong&gt; : &lt;em&gt;$ligne&lt;/em&gt;&lt;br /&gt;
        &lt;strong&gt;Assertion&lt;/strong&gt; : &lt;em&gt;$erreur&lt;/em&gt;&lt;/p&gt;&quot;;
}
?&gt;</code></pre><p id="r-335227" data-claire-element-id="335227">Maintenant, testons notre fonction !</p><pre id="r-335228" data-claire-element-id="335228"><code data-claire-semantic="html+php">&lt;?php
function gestion_assert($script, $ligne, $erreur) // Fonction qui gère les erreurs des assertions.
{
    echo &quot;&lt;p&gt;Une assertion est fausse :&lt;br /&gt;
        &lt;strong&gt;Script&lt;/strong&gt; : &lt;em&gt;$script&lt;/em&gt;&lt;br /&gt;
        &lt;strong&gt;Ligne&lt;/strong&gt; : &lt;em&gt;$ligne&lt;/em&gt;&lt;br /&gt;
        &lt;strong&gt;Assertion&lt;/strong&gt; : &lt;em&gt;$erreur&lt;/em&gt;&lt;/p&gt;&quot;;
}
 
 
// On active les assertions.
assert_options(ASSERT_ACTIVE, 1);
 
// Définition de la fonction à appeler en cas d'erreur.
assert_options(ASSERT_CALLBACK, 'gestion_assert');
 
// Création d'une assertion fausse.
$id_membre = -24;
assert('$id_membre &gt;= 0');
?&gt;</code></pre><p id="r-335229" data-claire-element-id="335229">Cela marche ! C'est vrai que c'est beaucoup plus joli. :D</p><aside id="r-335231" data-claire-element-id="335231" data-claire-semantic="warning"><p id="r-335230" data-claire-element-id="335230">Ah mais attends ! J'obtiens ceci :</p></aside><p id="r-335232" data-claire-element-id="335232"><cite>Citation : Ma page</cite></p><blockquote id="r-335235" data-claire-element-id="335235"><p id="r-335233" data-claire-element-id="335233">Une assertion est fausse :<br/> Script : C:\wamp\www\PHP\Dev\others\Sdz\Tuto\assertions.php<br/> Line : 19<br/> Assertion : $id_membre &gt;= 0</p><p id="r-335234" data-claire-element-id="335234">Warning: assert() [function.assert]: Assertion &quot;$id_membre &gt;= 0&quot; failed in C:\wamp\www\PHP\Dev\others\Sdz\Tuto\assertions.php on line 19</p></blockquote><p id="r-335236" data-claire-element-id="335236">Il y a encore l'affichage d'erreur par défaut. :waw: <br/> Pas de panique ! En fait, PHP est un peu égoïste : il ne veut pas nous laisser gérer les erreurs ! :-° <br/> Il faut désactiver le rapport d'erreur durant l'évaluation d'une assertion. Pour faire cela, nous allons (encore !) avoir besoin de la fonction <a href="http://fr.php.net/assert_options">assert_options()</a>.</p><aside id="r-335238" data-claire-element-id="335238" data-claire-semantic="information"><p id="r-335237" data-claire-element-id="335237">Il est aussi possible de définir ce comportement directement dans le php.ini en modifiant la directive assert.warning et la directive assert.quiet_eval.</p></aside><pre id="r-335239" data-claire-element-id="335239"><code data-claire-semantic="html+php">&lt;?php
// On désactive le rapport d'erreur durant l'évaluation d'une assertion.
assert_options(ASSERT_WARNING, 0);
assert_options(ASSERT_QUIET_EVAL, 1);
?&gt;</code></pre><p id="r-335240" data-claire-element-id="335240">Ce qui nous donne :</p><pre id="r-335241" data-claire-element-id="335241"><code data-claire-semantic="html+php">&lt;?php
function gestion_assert($script, $ligne, $erreur) // Fonction qui gère les erreurs des assertions.
{
    echo &quot;&lt;p&gt;Une assertion est fausse :&lt;br /&gt;
        &lt;strong&gt;Script&lt;/strong&gt; : &lt;em&gt;$script&lt;/em&gt;&lt;br /&gt;
        &lt;strong&gt;Ligne&lt;/strong&gt; : &lt;em&gt;$ligne&lt;/em&gt;&lt;br /&gt;
        &lt;strong&gt;Assertion&lt;/strong&gt; : &lt;em&gt;$erreur&lt;/em&gt;&lt;/p&gt;&quot;;
}
 
 
// On active les assertions.
assert_options(ASSERT_ACTIVE, 1);
 
// On désactive le rapport d'erreur durant l'évaluation d'une assertion.
assert_options(ASSERT_WARNING, 0);
assert_options(ASSERT_QUIET_EVAL, 1);
 
// Définition de la fonction à appeler en cas d'erreur.
assert_options(ASSERT_CALLBACK, 'gestion_assert');
 
// Création d'une assertion fausse.
$id_membre = -24;
assert('$id_membre &gt;= 0');
?&gt;</code></pre><p id="r-335242" data-claire-element-id="335242">Et cette fois, ça fonctionne parfaitement. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php">Les assertions en PHP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
Les assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
Activons les assertions
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
Utilisation d&#039;assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/petites-astuces">
Petites astuces
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
<span class="arrow"></span>
<span class="next">Activons les assertions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/petites-astuces">
<span class="next">Petites astuces</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Petitesastuces"></a><h2>Petites astuces</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
<span class="arrow"></span>
<span class="next">Utilisation d&#039;assertions</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h3 id="r-avoir-un-message-explicatif-lors-d-une-erreur" data-claire-element-id="335250">Avoir un message explicatif lors d'une erreur</h3><p id="r-335246" data-claire-element-id="335246">Lors d'une erreur, PHP ne fournit &quot;que&quot; l'assertion en cause et sa position. Il ne peut renvoyer un message expliquant pourquoi l'assertion est fausse.<br/> Pour faire cela, il existe une astuce permettant d'afficher des messages d'erreurs personnalisés. Cette astuce consiste à ajouter un commentaire dans l'affirmation. À l'affichage de l'assertion qui est fausse, le commentaire peut être utilisé comme un message explicatif.<br/> Si l'on reprend le code d'avant en utilisant cette astuce, cela donne :</p><pre id="r-335247" data-claire-element-id="335247"><code data-claire-semantic="html+php">&lt;?php
function gestion_assert($script, $ligne, $erreur) // Fonction qui gère les erreurs des assertions.
{
        $array = explode(&quot;//&quot;, $erreur); // On récupère le commentaire qui va faire office de message explicatif.
        list($erreur, $explication) = $array;
        echo &quot;&lt;p&gt;Une assertion est fausse :&lt;br /&gt;
       &lt;strong&gt;Script&lt;/strong&gt; : &lt;em&gt;$script&lt;/em&gt;&lt;br /&gt;
       &lt;strong&gt;Ligne&lt;/strong&gt; : &lt;em&gt;$ligne&lt;/em&gt;&lt;br /&gt;
       &lt;strong&gt;Assertion&lt;/strong&gt; : &lt;em&gt;$erreur&lt;/em&gt;&lt;br /&gt;
       &lt;strong&gt;Cause&lt;/strong&gt; : &lt;em&gt;$explication&lt;/em&gt;&lt;/p&gt;&quot;;
}
 
 
// On active les assertions.
assert_options(ASSERT_ACTIVE, 1);
 
// On désactive le rapport d'erreur durant l'évaluation d'une assertion.
assert_options(ASSERT_WARNING, 0);
assert_options(ASSERT_QUIET_EVAL, 1);
 
// Définition de la fonction à appeler en cas d'erreur.
assert_options(ASSERT_CALLBACK, 'gestion_assert');
 
// Création d'une assertion fausse.
$nombre_pages = -24;
assert('$nombre_pages &gt;= 0; //Le nombre de page est négatif');
?&gt;</code></pre><aside id="r-335249" data-claire-element-id="335249" data-claire-semantic="warning"><p id="r-335248" data-claire-element-id="335248">Si vous ajoutez un commentaire dans l'assertion, vous devez impérativement mettre un ; entre l'affirmation et le commentaire.</p></aside><h3 id="r-arreter-l-execution-du-script-en-cas-d-erreur" data-claire-element-id="335256">Arrêter l'exécution du script en cas d'erreur</h3><p id="r-335251" data-claire-element-id="335251">Par défaut, les erreurs d'assertion ont un niveau de type : E_WARNING.<br/> Ce type d'erreur n'arrête pas l'exécution du code. Si vous voulez que les erreurs d'assertion aient un niveau plus élevé, l'exécution s'arrêtera donc en cas d'assertion fausse, vous devez utiliser la fonction <a href="http://fr.php.net/assert_options">assert_options()</a> et la directive ASSERT_BAIL.</p><aside id="r-335253" data-claire-element-id="335253" data-claire-semantic="information"><p id="r-335252" data-claire-element-id="335252">Modifiable directement dans le php.ini : directive assert.bail.</p></aside><pre id="r-335254" data-claire-element-id="335254"><code data-claire-semantic="html+php">&lt;?php
// On active les assertions.
assert_options(ASSERT_ACTIVE, 1);
assert_options(ASSERT_BAIL, 0); // 0 -&gt; continue l'exécution même en cas d'erreur | 1-&gt; arrête l'exécution en cas d'erreur .
 
// Création d'une assertion fausse.
$id_membre = -24;
assert('$id_membre &gt;= 0');
 
echo &quot;Les assertions c'est bien !&quot;; // Message affiché.
?&gt;</code></pre><p id="r-335255" data-claire-element-id="335255">C'est la fin de ce tuto. Si vous avez des questions / critiques ou toute autre chose à dire : n'hésitez pas !<br/><em>Merci à <a href="http://www.siteduzero.com/membres-294-31940.html">Tortue Facile</a>, à <a href="http://www.siteduzero.com/membres-294-15080.html">Dentuk</a> et aux <a href="http://www.zcorrecteurs.fr/">zcorrecteurs</a> (surtout <a href="http://www.siteduzero.com/membres-294-7500.html">ptipilou</a>) pour leurs conseils, corrections et relectures. :) </em><br/>f</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php">Les assertions en PHP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/les-assertions-5">
Les assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/activons-les-assertions">
Activons les assertions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
Utilisation d&#039;assertions
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/petites-astuces">
Petites astuces
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-assertions-en-php/utilisation-d-assertions">
<span class="arrow"></span>
<span class="next">Utilisation d&#039;assertions</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/les-assertions-en-php.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 04:35:31 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-assertions-en-php.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:55:55 GMT -->
</html>