<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/maradns-comme-serveur-dns.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:47:49 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/maradns-comme-serveur-dns.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:34:22 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : MaraDNS comme serveur DNS</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/maradns-comme-serveur-dns.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : MaraDNS comme serveur DNS</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#MaraDNScommeserveurDNS">MaraDNS comme serveur DNS</a><br/><a href="#Qu039est-cequ039unserveurDNS">Qu&#039;est-ce qu&#039;un serveur DNS ?</a><br/><a href="#ConfigurationdeMaradns">Configuration de Maradns</a><br/><a href="#LeszonesDNS">Les zones DNS</a><br/><a href="#ZoneDNSfinaleetlancementduserveur">Zone DNS finale et lancement du serveur</a><br/></div>
<a name="MaraDNScommeserveurDNS"></a><h2>MaraDNS comme serveur DNS</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
<span class="next">Qu&#039;est-ce qu&#039;un serveur DNS ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-344237" data-claire-element-id="344237">À partir du moment qu'on gère un site avec un trafic considérable, on est confronté à la gestion de plusieurs noms de domaine. Posséder son propre serveur DNS peut apporter une solution à certains problèmes, mais attention, vous devez bien saisir son rôle et décider si oui ou non vous en avez besoin.</p><p id="r-344238" data-claire-element-id="344238">J'expliquerai donc d'abord le fonctionnement global des noms de domaine sur Internet, et par la suite, si vous êtes toujours des nôtres, on entamera l'installation et la configuration de Maradns.</p>
</div><a name="Qu039est-cequ039unserveurDNS"></a><h2>Qu&#039;est-ce qu&#039;un serveur DNS ?</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
<span class="next">Configuration de Maradns</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-344239" data-claire-element-id="344239">Une erreur fréquente en informatique, c'est de se lancer tête baissée dans l'installation et la configuration d'un logiciel sans même saisir pleinement sa raison d'être et son utilité (je plaide coupable ! ^^ ). Ici, pour savoir si vous avez besoin d'un serveur DNS et pour comprendre à quoi ça sert, vous devez vous approprier un minimum de vocabulaire et comprendre le processus de <em>résolution DNS</em>. Continuez de lire pour voir si, à tout hasard, ne j'expliquerais pas tout ça dans les prochaines lignes. :-°</p><h2 id="r-un-nom-de-domaine" data-claire-element-id="344242">Un nom de domaine</h2><p id="r-344240" data-claire-element-id="344240">Allons-y pour la définition très précise, de ma main : <em>Un nom de domaine désigne, en général, une adresse Internet composée de caractères alphanumériques à laquelle on peut attribuer un sens (en la composant de mots par exemple). Un nom de domaine peut être composé de toutes les vingt-six lettres de l'alphabet latin, des chiffres de 0 à 9 et du trait d'union. Les noms de domaine sont insensibles à la casse ; chaque lettre majuscule sera considérée comme son homologue minuscule.</em></p><p id="r-344241" data-claire-element-id="344241">Certains donnent la même signification à l'expression <em>nom de domaine</em> qu'au terme <em>DNS</em>. <em>DNS</em> est l'acronyme de <em>Domain Name System</em>, c'est-à-dire un ensemble de serveurs, de réseaux et de règles rendant un ou plusieurs noms de domaine opérationnels. Certains vont donner à l'acronyme <em>DNS</em> la signification <em>Domain Name Server</em>. Ce n'est pas nécessairement une erreur, cette définition est généralement bien acceptée dans le jargon. L'expression <em>serveur DNS</em>, bien qu'un peu répétitive si traduite ainsi, désigne, au sens large, tout logiciel ou serveur physique répondant à des requêtes DNS. Bref, DNS est utilisé un peu n'importe comment, mais généralement on comprend qu'on réfère à quelque chose en lien avec les noms de domaine. :)</p><h2 id="r-les-differents-niveaux-de-domaine" data-claire-element-id="344259">Les différents niveaux de domaine</h2><p id="r-344243" data-claire-element-id="344243">Il existe différents <em>niveaux de domaine</em>, qui suivis d'un point, forment un nom de domaine :</p><ul id="r-344250" data-claire-element-id="344250"><li id="r-344245" data-claire-element-id="344245"><p id="r-344244" data-claire-element-id="344244">Domaine de premier niveau (abrégé TLD) : c'est le domaine complètement à la fin du nom de domaine. Par exemple, dans le nom de domaine <em>exemple.com.</em>, le domaine de premier niveau est <em>com</em>.</p></li><li id="r-344247" data-claire-element-id="344247"><p id="r-344246" data-claire-element-id="344246">Domaine de second niveau (abrégé SLD) : c'est généralement le domaine que nous pouvons choisir lorsque nous enregistrons un nom de domaine. Par exemple, dans le nom de domaine <em>news.google.com</em>, le domaine de second niveau est <em>google.com.</em>)</p></li><li id="r-344249" data-claire-element-id="344249"><p id="r-344248" data-claire-element-id="344248">Et ainsi de suite.. on entend très rarement le terme <em>domaine de troisième niveau</em>, on préférera le terme <em>sous-domaine</em> par convention.</p></li></ul><p id="r-344251" data-claire-element-id="344251">Remarquez la présence d'un point chaque fois que l'on termine l'écriture d'un niveau de domaine, même pour le TLD. En effet, en théorie, chaque nom de domaine devrait se terminer par un point, dans toutes les circonstances. Cependant, toutes les applications client comprennent et acceptent l'omission de ce point. Ainsi, en théorie, on devrait visiter :</p><pre id="r-344252" data-claire-element-id="344252"><code>http://google.com./images</code></pre><p id="r-344253" data-claire-element-id="344253">plutôt que :</p><pre id="r-344254" data-claire-element-id="344254"><code>http://google.com/images</code></pre><p id="r-344255" data-claire-element-id="344255">Vous pouvez essayer de l'entrer dans votre navigateur, vous aboutirez à la même page, car votre navigateur, peu importe duquel il s'agit, comprendra la requête.</p><div id="r-344257" data-claire-element-id="344257" data-claire-semantic="question"><p id="r-344256" data-claire-element-id="344256"><strong>S'il est facultatif, pourquoi insister sur la présence de ce point à la fin ?</strong><br/> S'il est vrai que le point terminal est facultatif dans toutes les applications client tels les navigateurs Web, il en est autrement lorsque l'on parle d'un serveur DNS. Partout dans la configuration d'un serveur DNS, lorsque nous référerons à un nom de domaine, nous devrons nous assurer de le terminer par un point, comme il se doit.</p></div><p id="r-344258" data-claire-element-id="344258">Généralement, lorsque l'on parle <em>d'enregistrer un nom de domaine</em>, on réfère à la réservation d'un domaine de second niveau (SLD). Dans certains cas, on réfère à l'enregistrement d'un domaine de troisième niveau. Ce peut être le cas lorsque l'association régissant l'allocation du TLD décide de le diviser en plusieurs SLD. Par exemple, le TLD <em>ca.</em>, pour les enregistrements géographiques canadiens, peut être divisé en plusieurs SLD pour chacune de ses provinces. Ainsi, lorsque l'on veut enregistrer un nom de domaine se terminant par <em>qc.ca.</em>, on enregistrera un domaine de troisième niveau. Certains considéreront <em>qc.ca.</em> comme le TLD, mais c'est une erreur, il s'agit là bel et bien du SLD.</p><h2 id="r-domaines-geographiques-et-generiques" data-claire-element-id="344267">Domaines géographiques et génériques</h2><p id="r-344260" data-claire-element-id="344260">Les TLD peuvent être...</p><ul id="r-344265" data-claire-element-id="344265"><li id="r-344262" data-claire-element-id="344262"><p id="r-344261" data-claire-element-id="344261"><strong>génériques : </strong>le TLD est ouvert à tous et considéré comme <em>international</em>, c'est-à-dire qu'aucun état politique n'exerce de contrôle sur sa répartition. Ces domaines sont gérés par l'ICANN (Internet Corporation for Assigned Names and Numbers).</p></li><li id="r-344264" data-claire-element-id="344264"><p id="r-344263" data-claire-element-id="344263"><strong>géographiques : </strong>le TLD est géré par un organisme mandaté (généralement une société d'état) et l'enregistrement de SLD est soumis à quelques restrictions. Exemple d'organismes : CIRA (Canada) et AFNIC (France)</p></li></ul><p id="r-344266" data-claire-element-id="344266">Afin de bien comprendre le rôle de ces organismes et la façon dont ils interviennent au quotidien lorsque nous sollicitions des noms de domaine, nous devons définir un nouveau concept : la résolution DNS.</p><h2 id="r-la-resolution-dns" data-claire-element-id="344290">La résolution DNS</h2><p id="r-344268" data-claire-element-id="344268">La résolution DNS est un processus au cours duquel on désire obtenir, pour un domaine (peu importe le niveau), une adresse IP. Peu importe qu'il s'agisse du domaine <em>test.test2.example.qc.ca.</em> ou tout simplement de <em>com.</em>, l'objectif de la résolution DNS est le même : obtenir une adresse IP. Pour chaque niveau de domaine, en partant du TLD (premier niveau, à droite complètement), on devra solliciter un serveur DNS pour obtenir une adresse IP. Une fois que le premier serveur est sollicité, il nous fournira les informations nécessaires pour savoir quel serveur solliciter pour résoudre le SLD, et ainsi de suite. Le problème demeure : par où commencer ? Comment savoir quel serveur solliciter pour obtenir une adresse IP pour résoudre le TLD ? La réponse est simple : les serveurs racines du DNS.</p><h3 id="r-les-serveurs-racines-du-dns" data-claire-element-id="344289">Les serveurs racines du DNS</h3><p id="r-344269" data-claire-element-id="344269">Les serveurs racines du DNS représentent une poignée de serveurs de l'ICANN (environ une vingtaine) dont les adresses IP sont connues et <strong>fixes</strong>. L'adresse IP d'un serveur à la racine du DNS ne doit pas changer, ou alors très rarement. Ainsi, depuis plus de dix ans, ces serveurs ont conservé leur adresse IP et tous les autres serveurs DNS du monde utilisent ces adresses IP pour résoudre les domaines de premier niveau. Et voilà donc, notre problème est résolu. Avec les serveurs racines du DNS, nous connaissons l'adresse IP du serveur qui nous aidera à résoudre le TLD. Nous enverrons donc une requête DNS et le serveur DNS auquel cette adresse est attribuée nous transmettra une nouvelle adresse IP pour le TLD concerné. Si pour le TLD <em>com.</em> nous avons obtenu l'adresse IP <em>a.b.c.d</em>, nous enverrons donc une nouvelle requête à cette adresse pour résoudre le SLD (domaine de second niveau). Pour l'exemple, le SLD sera <em>exemple.com.</em></p><p id="r-344270" data-claire-element-id="344270">Généralement, une fois que le SLD est résolu, on obtient l'adresse IP d'un serveur à interroger, mais dans un autre objectif : on veut toujours obtenir une adresse IP, mais cette fois, pas nécessairement celle d'un serveur DNS, mais plutôt celle d'une machine pour laquelle le nom de domaine sera un alias de l'IP. Autrement dit, on veut enfin récupérer l'adresse IP qui répondra aux pings du nom de domaine.</p><p id="r-344271" data-claire-element-id="344271">Compliqué ? Pas tant que ça. Si on résume, <strong>la résolution DNS</strong> consiste, ultimement, en l'obtention d'une adresse IP pour un nom de domaine. Pour résoudre un nom de domaine, on doit d'abord résoudre tous les domaines des niveaux qui le précèdent : si on veut résoudre un domaine de second niveau, on doit d'abord résoudre le domaine de premier niveau. Pour débuter la résolution, on sollicite les serveurs à la racine du DNS, dont l'ip ne changent pas et permet de résoudre tous les domaines de premier niveau.</p><p id="r-344272" data-claire-element-id="344272">En résumé, pour résoudre le nom de domaine www.exemple.com., on procède ainsi :</p><ul id="r-344277" data-claire-element-id="344277"><li id="r-344274" data-claire-element-id="344274"><p id="r-344273" data-claire-element-id="344273">on demande une adresse IP aux serveurs à la racine du DNS nous permettant de résoudre <em>com.</em></p></li><li id="r-344276" data-claire-element-id="344276"><p id="r-344275" data-claire-element-id="344275">on sollicite cette nouvelle adresse IP pour obtenir l'adresse IP correspondant à <em>exemple.com.</em></p></li></ul><aside id="r-344279" data-claire-element-id="344279" data-claire-semantic="error"><p id="r-344278" data-claire-element-id="344278">Attention par contre, l'adresse IP obtenue ici pour <em>exemple.com</em> n'est pas nécessairement celle vers laquelle il &quot;pointe&quot;. Non, c'est l'adresse du prochain serveur DNS à interroger. Ça continue comme ça tant et aussi longtemps qu'on n'obtient pas une réponse dite <strong>autoritaire</strong> (la réponse finale qui met fin au processus de résolution DNS, je définis plus bas).</p></aside><p id="r-344280" data-claire-element-id="344280">Cette explication du processus est très sommaire et ne tient pas compte d'un facteur essentiel au bon fonctionnement du DNS : <strong>la mise en cache</strong>. De nombreux serveurs DNS intermédiaires peuvent intervenir dans le processus et mettre en cache les données qu'ils ont déjà sollicitées. Ainsi, les adresses IP correspondant au nom de domaine <em>google.com.</em> ne font pas l'objet d'une résolution DNS complète à chaque fois que l'on visite une page sur Google. Non, car :</p><ul id="r-344287" data-claire-element-id="344287"><li id="r-344282" data-claire-element-id="344282"><p id="r-344281" data-claire-element-id="344281">Votre ordinateur met en cache les adresses IP pour un temps déterminé (environ 1 heure).</p></li><li id="r-344284" data-claire-element-id="344284"><p id="r-344283" data-claire-element-id="344283">Votre FAI met également en cache les adresses IP pour un temps plus long (environ 24 heures).</p></li><li id="r-344286" data-claire-element-id="344286"><p id="r-344285" data-claire-element-id="344285">D'autres acteurs peuvent mettre en cache les données avant qu'elles ne parviennent à vous ou à votre FAI.</p></li></ul><p id="r-344288" data-claire-element-id="344288">Du coup, vous venez de comprendre le processus de <strong>propagation DNS</strong>. Si l'adresse IP associée à un nom de domaine venait à changer, il ne suffit pas de vider le cache DNS de son ordinateur : cela ne servira à rien tant et aussi longtemps que votre FAI ne rafraîchira pas son cache. Pour cette raison, lorsqu'un changement est apporté à un configuration DNS, il peut prendre de 24 à 48 heures pour être connu de tous les intermédiaires entre l'utilisateur final et le serveur dont provient la modification. ;)</p><h2 id="r-serveur-dns-autoritaire-et-serveur-dns-recursif" data-claire-element-id="344307">Serveur DNS autoritaire et serveur DNS récursif</h2><p id="r-344291" data-claire-element-id="344291">Il existe deux types de serveurs DNS :</p><ul id="r-344296" data-claire-element-id="344296"><li id="r-344293" data-claire-element-id="344293"><p id="r-344292" data-claire-element-id="344292">autoritaire : on dit du serveur <strong>autoritaire</strong> qu'il a autorité sur la zone DNS. C'est-à-dire que c'est ce serveur qui fournira, au final, toutes les adresses IP associées au nom de domaine et sous-domaines.</p></li><li id="r-344295" data-claire-element-id="344295"><p id="r-344294" data-claire-element-id="344294">récursif : le serveur sert uniquement de relais entre un serveur et un autre dans le processus de résolution DNS qui se terminera lorsque le serveur autoritaire aura été contacté.</p></li></ul><p id="r-344297" data-claire-element-id="344297">Un serveur peut agir à titre de serveur autoritaire pour certaines zones, et à titre de serveur récursif pour d'autres zones.</p><aside id="r-344299" data-claire-element-id="344299" data-claire-semantic="information"><p id="r-344298" data-claire-element-id="344298">Le terme <strong>zone DNS</strong> que j'ai commencé à utiliser désigne la configuration d'un nom de domaine au sein d'un serveur DNS. Lorsque l'on parle d'une zone DNS, on désigne souvent le <strong>fichier de configuration</strong> d'un nom de domaine desservi par le serveur, ou plus généralement, le nom de domaine directement.</p></aside><p id="r-344300" data-claire-element-id="344300">Nous apprendrons à configurer un serveur DNS autoritaire qui ne supporte pas la récursion. Les raisons de ce choix sont simples :</p><ul id="r-344305" data-claire-element-id="344305"><li id="r-344302" data-claire-element-id="344302"><p id="r-344301" data-claire-element-id="344301">L'objectif de ce tutoriel est de vous apprendre à configurer un serveur DNS qui répondra aux besoins du commun des administrateurs systèmes. Le serveur DNS récursif sert davantage à de gros acteurs du DNS (fournisseurs d'accès Internet notamment). Notre serveur DNS aura autorité sur les zones qu'il dessert.</p></li><li id="r-344304" data-claire-element-id="344304"><p id="r-344303" data-claire-element-id="344303">L'AFNIC, l'association en charge du TLD fr., ne valide pas les zones desservi par des serveurs acceptant la récursion (elle évoque des motifs de sécurité très discutables sur lesquels nous ne nous acharnerons pas :-° ).</p></li></ul><p id="r-344306" data-claire-element-id="344306">Nous sommes maintenant prêts à commencer la configuration d'un serveur DNS. Ne continuez pas si vous n'êtes pas capable de réciter par coeur la définition de la résolution DNS, parce que si vous ne comprenez pas ça, vous n'avez aucune raison d'installer un serveur DNS, croyez-moi. :D Prétentieux ? Non, juste faites pas les mêmes erreurs que moi. :-°</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns">MaraDNS comme serveur DNS</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
Qu&#039;est-ce qu&#039;un serveur DNS ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
Configuration de Maradns
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
Les zones DNS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/zone-dns-finale-et-lancement-du-serveur">
Zone DNS finale et lancement du serveur
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
<span class="next">Configuration de Maradns</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ConfigurationdeMaradns"></a><h2>Configuration de Maradns</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
<span class="arrow"></span>
<span class="next">Qu&#039;est-ce qu&#039;un serveur DNS ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
<span class="next">Les zones DNS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-344309" data-claire-element-id="344309">On ne parle généralement que d'un seul serveur DNS sur Debian, il s'agit de Bind9. La documentation sur le net est abondante pour ce serveur très performant. Personnellement, mon choix s'est arrêté sur Maradns pour la charmante simplicité de sa configuration (qui n'en demeure pas moins très malléable !). Mais détrompez-vous si vous pensez qu'il s'agit d'un nouveau serveur encore expérimental. Au contraire, Maradns est développé et maintenu très à jour depuis 2001 et les releases sont toujours extrêmement stables.</p><p id="r-344310" data-claire-element-id="344310">Si vous n'êtes pas sûr de comprendre le rôle de Maradns, relisez plusieurs fois la première partie qui explique tout le processus de résolution DNS. Le Maradns que l'on va configurer sera un <strong>serveur autoritaire</strong> et non un serveur récursif, c'est-à-dire qu'il sera le dernier de tous les serveurs DNS interrogés à donner l'IP finale recherchée par tout le processus.</p><h2 id="r-installation-de-maradns" data-claire-element-id="344316">Installation de Maradns</h2><p id="r-344311" data-claire-element-id="344311">Si vous êtes sous Debian, sachez que Maradns, dans sa dernière version stable, est présent sur les dépôts officiels. Par contre, pour profiter des derniers correctifs apportés, on va compiler la dernière version. C'est vraiment pas compliqué ! (J'ai inséré le lien pour télécharger la version 1.4.03, mais rendez-vous sur le <a href="http://www.maradns.org/">http://www.maradns.org</a> pour récupérer la dernière version).</p><pre id="r-344312" data-claire-element-id="344312"><code data-claire-semantic="console">wget http://www.maradns.org/download/1.4/1.4.03/maradns-1.4.03.tar.gz
tar -xf maradns-1.4.03.tar.gz
cd maradns-1.4.03.tar.gz
./configure
make
make install</code></pre><p id="r-344313" data-claire-element-id="344313">Le fichier principal de configuration de Maradns se crée automatiquement dans /etc/maradns/mararc, et bug éternel dans l'installation du logiciel (en fait le bug ne vient pas du logiciel, mais bien du <em>make install</em>). Tout ce que je vous demande, c'est de déplacer le fichier dans /etc/ ainsi :</p><pre id="r-344314" data-claire-element-id="344314"><code data-claire-semantic="console">mv /etc/maradns/mararc /etc/mararc</code></pre><p id="r-344315" data-claire-element-id="344315">Voilà pour l'installation. Pour lancer le serveur, il vous suffit de taper <em>maradns</em>ça va, tout le monde a essayé ? mais ça ne sert à rien de le faire maintenant, il n'est pas configuré. :)</p><h2 id="r-le-fichier-de-configuration-principal-etc-mararc" data-claire-element-id="344334">Le fichier de configuration principal /etc/mararc</h2><p id="r-344317" data-claire-element-id="344317">On n'aura que quelques lignes à modifier dans /etc/mararc.</p><p id="r-344318" data-claire-element-id="344318">D'abord, on définit l'adresse IP du serveur (l'adresse sur laquelle le serveur écoutera et recevra les requêtes). Si c'est un serveur sur un réseau local, vous entrez l'IP locale, sinon, l'IP sur Internet. Simplement :D Recherchez la ligne, ou créez-la si vous ne la trouvez pas :</p><pre id="r-344319" data-claire-element-id="344319"><code data-claire-semantic="console">ipv4_bind_addresses = &quot;x.x.x.x&quot;</code></pre><p id="r-344320" data-claire-element-id="344320">Le serveur pourrait écouter sur plusieurs adresses IP, il vous suffirait de les séparer par une virgule.</p><div id="r-344322" data-claire-element-id="344322" data-claire-semantic="question"><p id="r-344321" data-claire-element-id="344321"><strong>Ça veut dire quoi &quot;écouter&quot; ?</strong><br/> C'est simplement être attentif aux requêtes. Une machine peut être contactée de plusieurs façons, mais le serveur DNS Maradns ne recevra que les requêtes pour lesquelles la machine a été contactée par les IPs sur lesquelles il écoute. Ex : l'IP 127.0.0.1 pour la machine elle-même, une IP débutant par 192.168.x.x pour un autre ordinateur sur le réseau, et une autre IP pour identifier la machine sur Internet. Si le serveur est destiné à un réseau local mais tout de même connecté à Internet, alors il pourrait n'écouter que sur son IP locale. Il ne pourrait être contacté que par les autres ordinateurs du réseau.</p></div><p id="r-344323" data-claire-element-id="344323">Ensuite, on change la variable <em>chroot_dir</em> pour <em>/etc/maradns/</em> : c'est le dossier dans lequel se trouveront tous nos fichiers de zone pour les noms de domaine que le serveur sert :</p><pre id="r-344324" data-claire-element-id="344324"><code data-claire-semantic="console">chroot_dir = &quot;/etc/maradns/&quot;</code></pre><p id="r-344325" data-claire-element-id="344325">On pourrait aussi ne pas utiliser cette variable et définir un chemin absolu pour chacun de nos fichiers de zone par la suite.</p><p id="r-344326" data-claire-element-id="344326">Modifions maintenant un paramètre qui peut se révéler très utile. Dans des zones DNS, le * peut servir à désigner tous les sous-domaines d'un domaine (par exemple). Un joker, exactement :) Par défaut, cette option n'est pas activée. Activez-la ainsi si elle vous intéresse :</p><pre id="r-344327" data-claire-element-id="344327"><code data-claire-semantic="console">bind_star_handling = 1</code></pre><p id="r-344328" data-claire-element-id="344328">Finalement, on modifie une toute dernière option extrêmement importante. Mais avant, je dois apporter quelques précisions. je vais vous résumer la vie des frères TCP et UDP. :D</p><aside id="r-344330" data-claire-element-id="344330" data-claire-semantic="information"><p id="r-344329" data-claire-element-id="344329">UDP et TCP sont deux protocoles de communication servant à transmettre des données. À la différence de TCP, UDP envoie les paquets sans s'assurer qu'ils sont bien reçus, alors que TCP réenvoie les paquets tant qu'ils ne sont pas reçus exactement tels qu'envoyés. TCP est plus lourd et UDP est plus rapide. Mais à quoi peut bien servir un protocole qui ne transmet pas toujours l'information exacte ? Le meilleur exemple : des jeux vidéos, où la position d'un personnage est constamment modifiée et donc constamment renvoyée aux autres joueurs. Ce n'est pas grave si l'information est perdue 1 fois sur 20 (chiffre au pif), car une nouvelle information sera envoyée tout de suite après.</p></aside><p id="r-344331" data-claire-element-id="344331">Tout ça pour dire que Maradns fonctionne avec UDP et que pour qu'il accepte également les requêtes TCP, on doit utiliser un second logiciel qui est fourni avec (il a été installé en même temps que Maradns et tout, ne vous inquiétez pas ^^ ). Tout ce qu'on doit faire, c'est définir sur quelle IP ce serveur écoutera. La même que Maradns, normalement. Toujours dans /etc/mararc, modifiez les lignes (ou ajoutez si elles n'y sont pas) :</p><pre id="r-344332" data-claire-element-id="344332"><code data-claire-semantic="console">tcp_convert_server = &quot;213.251.161.162&quot;</code></pre><p id="r-344333" data-claire-element-id="344333">Voilà, et c'est tout pour la configuration de base. On va apprendre à lancer Maradns, et même à le lancer automatiquement au démarrage. Parce que non, contrairement à d'autres logiciels, il ne s'installe pas comme un démon. :diable: (gag de smiley, on a du choix et on en profite :D )</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns">MaraDNS comme serveur DNS</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
Qu&#039;est-ce qu&#039;un serveur DNS ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
Configuration de Maradns
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
Les zones DNS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/zone-dns-finale-et-lancement-du-serveur">
Zone DNS finale et lancement du serveur
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
<span class="arrow"></span>
<span class="next">Qu&#039;est-ce qu&#039;un serveur DNS ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
<span class="next">Les zones DNS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LeszonesDNS"></a><h2>Les zones DNS</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
<span class="arrow"></span>
<span class="next">Configuration de Maradns</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/zone-dns-finale-et-lancement-du-serveur">
<span class="next">Zone DNS finale et lancement du serveur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-344336" data-claire-element-id="344336">Wikipédia définit une zone DNS comme une portion du DNS dont la responsabilité administrative a été déléguée. C'est vrai, mais ce n'est pas très parlant.<br/><strong><br/> Dans notre cas, une zone DNS se résume à toutes les directives (adresses IP associées aux sous-domaines, serveur mail, email de l'administrateur) que l'on veut donner pour un domaine.</strong></p><p id="r-344337" data-claire-element-id="344337">Concrètement, on aura un fichier par zone DNS, donc un fichier pour chaque domaine. Simple, non ? :euh: Non ? Si j'ai trois domaines : exemple1.com, exemple2.com et exemple3.com, alors j'aurai un fichier pour chacun de ces domaines.</p><p id="r-344338" data-claire-element-id="344338">Ces directives que contiennent nos zones DNS sont appelées des <strong>entrées ou enregistrements</strong>. Chaque entrée correspond à une ligne dans le fichier, et chaque ligne qui s'y trouvent contient une entrée (sauf les lignes vides et les lignes de commentaires). Compliqué ? Continuez de lire et portez attention aux exemples, vous comprendrez.</p><p id="r-344339" data-claire-element-id="344339">Il existe plusieurs types d'entrées, je vous les énumère ici en vous donnant un exemple pour chaque. Par la suite, on pourra créer une zone DNS complète en guise d'exemple.</p><h3 id="r-enregistrement-soa-start-of-authority" data-claire-element-id="344357">Enregistrement SOA (Start Of Authority)</h3><p id="r-344340" data-claire-element-id="344340">Cet enregistrement est obligatoire au début de toutes les zones DNS. Il contient des informations qui vont notamment aider les autres serveurs DNS à faire leur mise en cache. Vous pouvez, entre autres, suggérer une fréquence de rafraîchissement. Un exemple, et on décortique ensuite :</p><pre id="r-344341" data-claire-element-id="344341"><code data-claire-semantic="console">exemple.com. SOA ns1.nameserver.com. <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="7b1a1f1612153b1c161a12175518141655">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script> 2010071801 7200 3600 604800 1800</code></pre><p id="r-344342" data-claire-element-id="344342">Les informations sont toutes séparées par un espace, dans l'ordre :</p><ul id="r-344355" data-claire-element-id="344355"><li id="r-344344" data-claire-element-id="344344"><p id="r-344343" data-claire-element-id="344343">Le nom de domaine auquel s'applique l'enregistrement (n'oubliez pas le point à la fin) ;</p></li><li id="r-344346" data-claire-element-id="344346"><p id="r-344345" data-claire-element-id="344345">Le type d'enregistrement (ici SOA) ;</p></li><li id="r-344348" data-claire-element-id="344348"><p id="r-344347" data-claire-element-id="344347">Le serveur DNS principal (le premier que vous avez défini chez votre registrar) ;</p></li><li id="r-344350" data-claire-element-id="344350"><p id="r-344349" data-claire-element-id="344349">L'adresse email du responsable de la zone. Évitez d'utiliser une email @exemple.com, ça peut poser des problèmes parfois étant donné que c'est cette même zone qui définira les enregistrements mails ;</p></li><li id="r-344352" data-claire-element-id="344352"><p id="r-344351" data-claire-element-id="344351">La date de la dernière modification d'un seul bout : 2010-07-18-01 (01 pour le numéro de la modification dans la journée) ;</p></li><li id="r-344354" data-claire-element-id="344354"><p id="r-344353" data-claire-element-id="344353">Quatre valeurs en seconde qui expriment, dans l'ordre : le nombre de secondes suggéré avant de remettre à jour la zone, avant de réessayer la requête en cas d'échec, avant que la zone soit expirée et le temps minimum entre deux requêtes.</p></li></ul><p id="r-344356" data-claire-element-id="344356">Je le répète, cet enregistrement est obligatoire, sans lequel vos noms de domaine pourraient ne pas être résolus par certains autres serveurs. ;) Contrairement aux autres enregistrements que nous allons voir, il ne doit y avoir qu'un seul et unique enregistrement SOA par zone.</p><h3 id="r-enregistrement-ns" data-claire-element-id="344370">Enregistrement NS</h3><p id="r-344358" data-claire-element-id="344358">Ces enregistrements servent à répéter quels sont les serveurs DNS pour le nom de domaine géré par la zone. Oui, à répéter pour confirmer aux autres serveurs qu'ils ont la bonne information.</p><pre id="r-344359" data-claire-element-id="344359"><code data-claire-semantic="console">exemple.com. +60 NS ns1.nameserver.com.
exemple.com. +60 NS ns2.nameserver.com.
#S'il y en avait d'autres, on les placerait à la suite</code></pre><p id="r-344360" data-claire-element-id="344360">Cette fois, on a quatre informations :</p><ul id="r-344369" data-claire-element-id="344369"><li id="r-344362" data-claire-element-id="344362"><p id="r-344361" data-claire-element-id="344361">Le nom de domaine que gère la zone ;</p></li><li id="r-344364" data-claire-element-id="344364"><p id="r-344363" data-claire-element-id="344363">Le TTL (time to live ou durée de vie, en secondes) de l'enregistrement. Cette valeur ne peut supplanter celle du SOA. En gros, si elle est plus petite, il sera mis à jour en même temps que le reste de la zone.</p></li><li id="r-344366" data-claire-element-id="344366"><p id="r-344365" data-claire-element-id="344365">Le type d'enregistrement (ici, NS) ;</p></li><li id="r-344368" data-claire-element-id="344368"><p id="r-344367" data-claire-element-id="344367">Les serveurs DNS tels que définis chez votre registrar.</p></li></ul><h3 id="r-enregistrement-a-de-type-ipv4" data-claire-element-id="344394">Enregistrement A de type IPv4</h3><p id="r-344371" data-claire-element-id="344371">Ah ! :D Sans doute le plus concret et le plus attendu. C'est enfin cet enregistrement qui nous dira vers quelle IP pointe quel nom de domaine/sous-domaine. Parce que jusqu'ici, toutes les IPS recherchées ne nous conduisaient qu'au prochain serveur DNS. Exemple :</p><pre id="r-344372" data-claire-element-id="344372"><code data-claire-semantic="console">exemple.com. +60 A x.x.x.x</code></pre><p id="r-344373" data-claire-element-id="344373">Quatre informations, dont une facultative en plus :</p><ul id="r-344382" data-claire-element-id="344382"><li id="r-344375" data-claire-element-id="344375"><p id="r-344374" data-claire-element-id="344374">Le nom de domaine ou sous-domaine que concerne l'enregistrement ;</p></li><li id="r-344377" data-claire-element-id="344377"><p id="r-344376" data-claire-element-id="344376">Le TTL de l'enregistrement (comme pour l'enregistrement NS) ;</p></li><li id="r-344379" data-claire-element-id="344379"><p id="r-344378" data-claire-element-id="344378">Le type d'enregistrement (ici A pour IPv4, Maradns supporte l'IPv6 mais pas l'auteur du tuto :-° ), notez qu'on peut omettre d'inscrire le A étant donné que c'est le type d'enregistrement par défaut ;</p></li><li id="r-344381" data-claire-element-id="344381"><p id="r-344380" data-claire-element-id="344380">L'IP associée au domaine/sous-domaine.</p></li></ul><p id="r-344383" data-claire-element-id="344383">Si je veux assigner une IP différente pour certains sous-domaines en particulier, je procède ainsi :</p><pre id="r-344384" data-claire-element-id="344384"><code data-claire-semantic="console">dev.exemple.com. +60 x.x.x.x</code></pre><p id="r-344385" data-claire-element-id="344385">J'ai omis le A, pour vous montrer que cet enregistrement est strictement équivalent à celui-ci :</p><pre id="r-344386" data-claire-element-id="344386"><code data-claire-semantic="console">dev.exemple.com. +60 A x.x.x.x</code></pre><p id="r-344387" data-claire-element-id="344387">Je vous ai parlé tout à l'heure du joker (*) qui nous permettrait de donner une directive pour tous les sous-domaines d'un nom de domaine. Si par exemple, je veux que par défaut, tous les sous-domaines de exemple.com pointent vers la même IP, je procède ainsi :</p><pre id="r-344388" data-claire-element-id="344388"><code data-claire-semantic="console">*.exemple.com. +60 x.x.x.x</code></pre><aside id="r-344390" data-claire-element-id="344390" data-claire-semantic="warning"><p id="r-344389" data-claire-element-id="344389">Cependant, <strong>la plupart des validateurs de zone DNS vous retourneront un avertissement</strong>. En effet, si par la suite, vous entrez une directive particulière pour le sous-domaine dev.exemple.com, alors qu'il était concerné par le joker, on se retrouve avec une double information pour le même sous-domaine. En théorie, on ne devrait qu'en retrouver une, mais en pratique, la dernière écrase toutes les autres. Ignorez cet avertissement.</p></aside><p id="r-344391" data-claire-element-id="344391">Bricolez vos enregistrements IPv4 comme vous l'entendez, après tout, c'est votre serveur. :D</p><aside id="r-344393" data-claire-element-id="344393" data-claire-semantic="error"><p id="r-344392" data-claire-element-id="344392">Ne précipitez pas les choses. Si vous voulez qu'un domaine pointe sur un répertoire en particulier de votre serveur Web, ce n'est pas la place pour improviser un x.x.x.x/alex/site/. Mais alors pas du tout, quoi. :p Cette manipulation ne relève pas du serveur DNS du tout, mais bien du serveur Web situé à l'adresse IP définie par le serveur DNS. Renseignez-vous sur les <em>Virtual Hosts</em> d'Apache.</p></aside><h3 id="r-enregistrement-cname" data-claire-element-id="344397">Enregistrement CNAME</h3><p id="r-344395" data-claire-element-id="344395">Très simple à comprendre : un enregistrement CNAME est un alias d'un hôte pour un autre. Par exemple, si je définis un alias dev2.exemple.com pour dev.exemple.com, alors toutes les directives qui concernent dev.exemple.com lui seront également appliquées. Pédagogie oblige, voici un exemple :-°</p><pre id="r-344396" data-claire-element-id="344396"><code data-claire-semantic="console">dev2.exemple.com. +60 CNAME dev.exemple.com.</code></pre><h3 id="r-enregistrement-mx" data-claire-element-id="344401">Enregistrement MX</h3><p id="r-344398" data-claire-element-id="344398">Les enregistrements MX définissent vers quels serveurs mail (MX = mail exchanger) les mails seront envoyés pour le domaine donné. Vous pouvez avoir plusieurs enregistrements pour le même domaine, et les classer par priorité. Si un serveur mail est saturé ou indisponible, on enverra au deuxième, au troisième et ainsi de suite. C'est comme ça que de gros fournisseurs d'emails fonctionnent (comme Gmail par exemple).</p><pre id="r-344399" data-claire-element-id="344399"><code data-claire-semantic="console">exemple.com. MX 10 mail.exemple.com.</code></pre><p id="r-344400" data-claire-element-id="344400">Ici, les mails envoyés aux adresses @exemple.com se dirigeront vers mail.exemple.com (dont l'IP est définie par notre enregistrement de type IPv4 plus haut). Le chiffre 10 indique la priorité. Ici je n'ai qu'un seul enregistrement, donc ça ne veut pas dire grand chose. Si j'en avais eu 15, j'aurais pu les ordonner par priorité, du plus petit au plus grand.</p><h3 id="r-enregistrement-txt" data-claire-element-id="344405">Enregistrement TXT</h3><p id="r-344402" data-claire-element-id="344402">C'est un enregistrement qui peut servir à ce que vous voulez. À faire un commentaire sur le domaine ou peu importe, libre à vous. On ne l'utilise que lorsque l'on en a besoin, il est facultatif.</p><p id="r-344403" data-claire-element-id="344403">C'est cet enregistrement qui peut servir, notamment, à appliquer des contrôles de sécurité antispam. Je vous invite à consulter le site <a href="http://www.openspf.org/">http://www.openspf.org</a> pour prendre connaissance de ce qu'est un enregistrement SPF et ce qu'il peut faire pour vous.</p><p id="r-344404" data-claire-element-id="344404">On a vu les enregistrements généralement essentiels au bon fonctionnement d'un serveur DNS. Il en existe d'autres, je vous réfère à <a href="http://www.maradns.org/tutorial/man.csv2.html">la documentation officielle de maradns</a>, au moins pour en prendre connaissance.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns">MaraDNS comme serveur DNS</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
Qu&#039;est-ce qu&#039;un serveur DNS ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
Configuration de Maradns
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
Les zones DNS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/zone-dns-finale-et-lancement-du-serveur">
Zone DNS finale et lancement du serveur
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
<span class="arrow"></span>
<span class="next">Configuration de Maradns</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/zone-dns-finale-et-lancement-du-serveur">
<span class="next">Zone DNS finale et lancement du serveur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ZoneDNSfinaleetlancementduserveur"></a><h2>Zone DNS finale et lancement du serveur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
<span class="arrow"></span>
<span class="next">Les zones DNS</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-344407" data-claire-element-id="344407">À la lumière de tous les exemples donnés pour chacun des enregistrements nécessaires, voici un exemple typique d'une zone DNS conforme :</p><pre id="r-344408" data-claire-element-id="344408"><code data-claire-semantic="console">exemple.com. SOA ns1.nameserver.com. <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="ea8b8e878384aa8d878b8386c4898587c4">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script> 2010071801 7200 3600 604800 1800
exemple.com. +60 NS ns1.nameserver.com.
exemple.com. +60 NS ns2.nameserver.com.
exemple.com. +60 x.x.x.x
*.exemple.com. +60 x.x.x.x
exemple.com. MX 10 mail.exemple.com.</code></pre><p id="r-344409" data-claire-element-id="344409">Il est possible que vous ayiez deux zones identiques pour deux domaines différents et que tout ce qui change, c'est le nom de domaine. Je vous présente donc une commodité fantastique : le symbole %, qui désigne &quot;le domaine en cours&quot;. Si la zone est ouverte pour &quot;exemple.com.&quot;, alors % vaudra &quot;exemple.com.&quot; et si la zone est ouverte pour exemple2.com, alors il vaudra &quot;exemple2.com.&quot;. Vous pourrez donc utiliser le même fichier de zone pour les deux !</p><pre id="r-344410" data-claire-element-id="344410"><code data-claire-semantic="console">% SOA ns1.nameserver.com. <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="1d7c797074735d7a707c7471337e727033">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script> 2010071801 7200 3600 604800 1800
% +60 NS ns1.nameserver.com.
% +60 NS ns2.nameserver.com.
% +60 x.x.x.x
*.% +60 x.x.x.x
% MX 10 mail.exemple.com.</code></pre><p id="r-344411" data-claire-element-id="344411">Maintenant que vous avez compris l'essentiel de ce fichier, vous pouvez le créer dans /etc/maradns/. S'il ne sert qu'un domaine, vous pouvez l'inclure dans le nom du fichier (ex. : exemple.com.zone), et s'il en sert plusieurs, un nom comme serveur1.zone. Notez que l'extension .zone est le fruit de mon imagination débordante, vous pouvez lui mettre un .txt ou même aucune extension, peu importe.</p><p id="r-344412" data-claire-element-id="344412">Une fois que le fichier pour la zone est créé, rendez-vous dans /etc/mararc et sous csv2 = {}, ajoutez une ligne pour chaque domaine avec le fichier correspondant :</p><pre id="r-344413" data-claire-element-id="344413"><code data-claire-semantic="console">csv2[&quot;exemple.com.&quot;] = &quot;exemple.com.zone&quot;
csv2[&quot;exemple2.com.&quot;] = &quot;exemple2.com.zone&quot;</code></pre><p id="r-344414" data-claire-element-id="344414">Et surtout on n'oublie pas le point à la fin du nom de domaine ! ^^</p><p id="r-344415" data-claire-element-id="344415">À partir de maintenant, si vous lancez votre serveur avec la commande <em>maradns</em>, il devrait répondre à la tâche correctement.</p><div id="r-344417" data-claire-element-id="344417" data-claire-semantic="question"><p id="r-344416" data-claire-element-id="344416"><strong>Oui, mais il occupe ma console quand il tourne, comment je peux le faire tourner en continu ?</strong><br/> C'est une bonne question. On va simplement le lancer dans un screen. Si vous ne savez pas ce qu'est un screen, c'est une console virtuelle que vous pouvez laisser tourner même si la console qui l'a lancée se ferme. Si screen n'est pas installé sur votre machine, faites-le avec <strong>apt-get install screen</strong></p></div><p id="r-344418" data-claire-element-id="344418">Pour le lancer, il vous suffit donc de lancer :</p><pre id="r-344419" data-claire-element-id="344419"><code data-claire-semantic="console">screen -dmS maradns maradns
screen -dmS zoneserver zoneserver</code></pre><p id="r-344420" data-claire-element-id="344420">J'ai lancé zoneserver, rappelez-vous, c'est le serveur qui permettra à maradns d'accepter les requêtes TCP.</p><p id="r-344421" data-claire-element-id="344421">Voilà, votre serveur tourne. Si vous voulez qu'il se lance automatiquement au démarrage, il vous suffit d'ajouter ces commandes à la séquence de boot.</p><p id="r-344422" data-claire-element-id="344422">Si vous avez des problèmes/questions, vous pouvez, au choix :</p><ul id="r-344431" data-claire-element-id="344431"><li id="r-344424" data-claire-element-id="344424"><p id="r-344423" data-claire-element-id="344423">utiliser les commentaires de ce tuto pour discuter ;</p></li><li id="r-344426" data-claire-element-id="344426"><p id="r-344425" data-claire-element-id="344425">utiliser les forums ;</p></li><li id="r-344428" data-claire-element-id="344428"><p id="r-344427" data-claire-element-id="344427">utiliser la mailing list de maradns (très efficace, en anglais) : <a href="http://maradns.org/index.html">instructions ici</a> ;</p></li><li id="r-344430" data-claire-element-id="344430"><p id="r-344429" data-claire-element-id="344429">m'envoyer un message privé.</p></li></ul><h2 id="r-valider-une-zone-dns" data-claire-element-id="344434">Valider une zone DNS</h2><p id="r-344432" data-claire-element-id="344432">Comme dans tout en informatique, il y a des choses qui se font et d'autres qui... ne se font pas. :p Pour valider une zone DNS et tester sa conformité avec les standards, il existe plusieurs outils. Certains sont payants, mais je vais vous recommander zonecheck qui est gratuit et opensource. Il est utilisé notamment par l'AFNIC pour le contrôle des zones DNS régissant tous les domaines .fr. Ne l'installez pas, utilisez carrément le démo en ligne : <a href="http://www.zonecheck.fr/demo/">http://www.zonecheck.fr/demo/</a>.</p><p id="r-344433" data-claire-element-id="344433">Maintenant, à vous de corriger les erreurs et avertissements qu'il vous récite ! :)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns">MaraDNS comme serveur DNS</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/qu-est-ce-qu-un-serveur-dns">
Qu&#039;est-ce qu&#039;un serveur DNS ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/configuration-de-maradns">
Configuration de Maradns
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
Les zones DNS
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/zone-dns-finale-et-lancement-du-serveur">
Zone DNS finale et lancement du serveur
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maradns-comme-serveur-dns/les-zones-dns">
<span class="arrow"></span>
<span class="next">Les zones DNS</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/maradns-comme-serveur-dns.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:47:49 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/maradns-comme-serveur-dns.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:34:22 GMT -->
</html>