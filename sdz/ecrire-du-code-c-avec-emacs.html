<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/ecrire-du-code-c-avec-emacs.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:32:14 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/ecrire-du-code-c-avec-emacs.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:32:03 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Écrire du code C avec Emacs</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/ecrire-du-code-c-avec-emacs.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Écrire du code C avec Emacs</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#crireducodeCavecEmacs">Écrire du code C avec Emacs</a><br/><a href="#ditionducodeaveclec-mode">Édition du code avec le c-mode</a><br/><a href="#Plusieursfichierssources">Plusieurs fichiers sources</a><br/><a href="#GestiondelhistoriquedesmodificationsavecVC">Gestion de l’historique des modifications avec VC</a><br/></div>
<a name="crireducodeCavecEmacs"></a><h2>Écrire du code C avec Emacs</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/edition-du-code-avec-le-c-mode">
<span class="next">Édition du code avec le c-mode</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-577685" data-claire-element-id="577685">Emacs est capable de beaucoup de choses telles que la gestion des fichiers, la messagerie électronique ou encore la lecture de musique, mais l’un des emplois premiers de l’Éditeur demeure la programmation.</p><p id="r-577686" data-claire-element-id="577686">Ce tutoriel est le premier d’une série de trois articles, au travers desquels nous allons apprendre à utiliser Emacs en tant qu’<em>environnement de développement</em> pour le langage C.</p><p id="r-577687" data-claire-element-id="577687">Cette série s’adresse tout particulièrement aux débutants puisqu’elle s’attache à expliquer au passage les mécanismes derrière chaque aspect du développement tels que la gestion des fichiers sources, la compilation séparée, ou la chasse aux bogues. De ce fait, elle peut être lue plus ou moins de manière autonome, sans nécessiter de grandes connaissances dans l’usage des outils de programmation (vous n’avez rien à faire, tout est dans Emacs ! ou presque…). Il vous faudra tout de même des bases à la fois en C et dans l’usage d’Emacs en tant qu’éditeur. Je recommande aussi de lire l’<a href="http://www.siteduzero.com/tuto-3-30529-1-votre-premier-emacs-la-configuration-d-emacs-pour-les-zeros.html">introduction à la configuration d'Emacs</a> que j’ai écrite, si vous n’avez encore jamais édité votre <code>.emacs</code>.</p><p id="r-577688" data-claire-element-id="577688">Mais avant de nous attaquer à Emacs, nous devons identifier nos besoins. Les trois tâches attribuées aux environnements intégrés tels que KDevelop ou Code::Blocks sont les suivantes :</p><ul id="r-577695" data-claire-element-id="577695"><li id="r-577690" data-claire-element-id="577690"><p id="r-577689" data-claire-element-id="577689"><em>Écrire</em> du code. Emacs et son <code>c-mode</code> seront parfaits pour cette tâche.</p></li><li id="r-577692" data-claire-element-id="577692"><p id="r-577691" data-claire-element-id="577691"><em>Compiler</em> et <em>lier</em> les différents fichiers sources entre eux. Pour cela nous ferons appel à l’outil <code>make</code> ainsi qu’à GCC, le tout depuis Emacs.</p></li><li id="r-577694" data-claire-element-id="577694"><p id="r-577693" data-claire-element-id="577693"><em>Traquer les bogues</em>. Nous utiliserons GUD l’interface à GDB d’Emacs, pour accomplir cette tâche.</p></li></ul><p id="r-577696" data-claire-element-id="577696">Ce premier volet s’intéresse à l’écriture du code en elle-même, et bien sûr, aux fonctionnalités d’Emacs qui vous y aideront !</p><aside id="r-577698" data-claire-element-id="577698" data-claire-semantic="information"><p id="r-577697" data-claire-element-id="577697">Ce tuto a été écrit avec <a href="http://rzpages.ovh.org/mdown.php5">mdown</a>. Il est disponible dans d'autres formats (<a href="http://rzpages.ovh.org/emacs/ecrire-code-c.php5">XHTML sémantique</a>, <a href="http://rzpages.ovh.org/emacs/files/ecrire-code-c.pdf">PDF</a> et <a href="http://rzpages.ovh.org/emacs/src/ecrire-code-c.text">texte</a>) sur mon site personnel.</p></aside>
</div><a name="ditionducodeaveclec-mode"></a><h2>Édition du code avec le c-mode</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
<span class="next">Plusieurs fichiers sources</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-577699" data-claire-element-id="577699">Le mode d’édition du code C dans Emacs se nomme très simplement le <code>c-mode</code> et est inclus par défaut avec l’éditeur ; vous pouvez aussi obtenir la dernière version du mode (qui est développé en dehors d’Emacs lui-même) sur le site du <a href="http://cc-mode.sourceforge.net/">cc-mode</a>. Le <code>c-mode</code> offre plusieurs fonctionnalités et commandes intéressantes.</p><h2 id="r-indentation-automatique" data-claire-element-id="577733">Indentation automatique</h2><p id="r-577700" data-claire-element-id="577700">Tout d’abord, comme tous les modes de programmation dans Emacs, le <code>c-mode</code> possède l’indentation automatique. Cela signifie que la touche <code>TAB</code> (ou, de manière équivalente, <code>C-i</code>) n’est pas utilisée pour insérer un caractère « tabulation » mais pour <em>indenter</em> la ligne actuelle, c’est-à-dire aligner le début de celle-ci sur la colonne adéquate, comme vous le feriez vous-même si Emacs n’était pas là. Il est important de remarquer que cette opération ne tient absolument pas compte de l’indentation actuelle de la ligne : qu’elle soit trop décalée à gauche ou à droite, Emacs la replacera au bon endroit.</p><p id="r-577701" data-claire-element-id="577701">Emacs indentera la ligne selon deux informations : le <em>contexte syntaxique</em> (si vous êtes au début d’une instruction, au milieu d’un appel de fonction, <em>etc.</em>) et le <em>style</em> sélectionné (par exemple, K&amp;R ou BSD ; voyez mon <a href="http://www.siteduzero.com/tuto-3-30529-1-votre-premier-emacs-la-configuration-d-emacs-pour-les-zeros.html">introduction à la configuration d'Emacs</a> pour plus d’informations).</p><p id="r-577702" data-claire-element-id="577702">Comme il peut devenir lassant de devoir appuyer (quoique ce ne soit qu’une seule fois) sur la touche <code>TAB</code> à chaque début de ligne, sachez que vous pouvez aller à la ligne et indenter en une seule commande : <code>C-j</code> (<code>newline-and-indent</code>).</p><p id="r-577703" data-claire-element-id="577703">Mais l’indentation d’Emacs ne se limite pas à la ligne actuelle ! Vous pouvez également lui demander d’indenter tout un bloc ou une fonction pour vous. Il s’agit respectivement des commandes <code>C-M-\</code> (<code>indent-region</code>) et <code>C-c C-q</code> (<code>c-indent-defun</code>), qui indentent la région actuelle (la zone de texte située entre la marque, usuellement apposée par <code>C-SPC</code>, et le curseur) et la fonction dans laquelle se trouve le curseur. En théorie, vous pourriez indenter tout le fichier ainsi, mais je vous le déconseille ; l’algorithme est lent et perd en précision si les constructions sont trop vilaines ou complexes. En revanche, si vous effectuez une modification au milieu d’un bloc, et que, par exemple, vous supprimez un niveau d’indentation, ces commandes peuvent s’avérer très utiles.</p><p id="r-577704" data-claire-element-id="577704">Parfois, en revanche, vous voulez aligner des éléments (comme le ferait la touche <code>TAB</code> en temps normal) sans qu’Emacs n’essaie d’indenter la ligne. Pour cela, vous pouvez utiliser la commande <code>M-i</code> (<code>tab-to-tab-stop</code>). C’est le cas, par exemple, si vous alignez vos déclarations ou vos instructions dans un <code>switch</code>.</p><p id="r-577705" data-claire-element-id="577705">Pour résumer, voici un tableau des commandes d’indentation et d’alignement :</p><table id="r-577732" data-claire-element-id="577732"><tbody id="r-577731" data-claire-element-id="577731"><tr id="r-577710" data-claire-element-id="577710"><td id="r-577707" data-claire-element-id="577707"><p id="r-577706" data-claire-element-id="577706"><code>TAB</code></p></td><td id="r-577709" data-claire-element-id="577709"><p id="r-577708" data-claire-element-id="577708">indente la ligne actuelle</p></td></tr><tr id="r-577715" data-claire-element-id="577715"><td id="r-577712" data-claire-element-id="577712"><p id="r-577711" data-claire-element-id="577711"><code>C-j</code></p></td><td id="r-577714" data-claire-element-id="577714"><p id="r-577713" data-claire-element-id="577713">retour à la ligne et indentation simultanés</p></td></tr><tr id="r-577720" data-claire-element-id="577720"><td id="r-577717" data-claire-element-id="577717"><p id="r-577716" data-claire-element-id="577716"><code>C-M-\</code></p></td><td id="r-577719" data-claire-element-id="577719"><p id="r-577718" data-claire-element-id="577718">indente la région actuelle</p></td></tr><tr id="r-577725" data-claire-element-id="577725"><td id="r-577722" data-claire-element-id="577722"><p id="r-577721" data-claire-element-id="577721"><code>C-c C-q</code></p></td><td id="r-577724" data-claire-element-id="577724"><p id="r-577723" data-claire-element-id="577723">indente la fonction actuelle</p></td></tr><tr id="r-577730" data-claire-element-id="577730"><td id="r-577727" data-claire-element-id="577727"><p id="r-577726" data-claire-element-id="577726"><code>M-i</code></p></td><td id="r-577729" data-claire-element-id="577729"><p id="r-577728" data-claire-element-id="577728">aligne le curseur sur la prochaine colonne de tabulation</p></td></tr></tbody></table><h2 id="r-gestion-des-commentaires" data-claire-element-id="577743">Gestion des commentaires</h2><p id="r-577734" data-claire-element-id="577734">De même qu’Emacs sait indenter le code automatiquement, il sait insérer des commentaires au bon endroit ; pour se faire, il vous suffit d’actionner la commande <code>M-;</code> (<code>comment-dwim</code>). Que vous soyez sur une ligne vide ou non, Emacs déterminera la syntaxe à adopter. C’est la commande idéale pour ceux qui trouvent les commentaires de type C (<code>/* ... */</code>) trop longs à taper.</p><p id="r-577735" data-claire-element-id="577735">De plus, Emacs dispose des commandes de traitement de régions suivantes : <code>comment-region</code> et <code>uncomment-region</code>. Elles sont accessibles par <code>M-x</code> et qui peuvent être associées à une combinaison de votre choix si vous en sentez le besoin. Je vous laisse deviner ce qu’elles font. Elles peuvent être utiles à ceux qui aiment isoler des morceaux de code avec des commentaires (personnellement, je préfère utiliser <code>#if 0</code>).</p><table id="r-577742" data-claire-element-id="577742"><tbody id="r-577741" data-claire-element-id="577741"><tr id="r-577740" data-claire-element-id="577740"><td id="r-577737" data-claire-element-id="577737"><p id="r-577736" data-claire-element-id="577736"><code>M-;</code></p></td><td id="r-577739" data-claire-element-id="577739"><p id="r-577738" data-claire-element-id="577738">insère un commentaire</p></td></tr></tbody></table><h2 id="r-deplacements-contextuels" data-claire-element-id="577767">Déplacements contextuels</h2><p id="r-577744" data-claire-element-id="577744">Enfin, le <code>c-mode</code> dispose de mécanismes de navigation contextuelle. La plupart des commandes utilisées sont communes à tous les modes d’édition mais leur fonctionnement a été adapté à la structure du code C.</p><p id="r-577745" data-claire-element-id="577745">Vous pouvez, comme toujours, vous déplacer de mot en mot avec les habituels <code>M-b</code> (<code>backward-word</code>) et <code>M-f</code> (<code>forward-word</code>).</p><p id="r-577746" data-claire-element-id="577746">Juste au niveau supérieur, les commandes <code>C-M-b</code> (<code>backward-sexp</code>) et <code>C-M-f</code> (<code>forward-sexp</code>) vous permettent de sauter d’un bout à l’autre d’expressions équilibrées (un groupe entre parenthèses, crochets ou accolades). En complément, <code>C-M-u</code> (<code>backward-up-list</code>) et <code>C-M-d</code> (<code>down-list</code>) naviguent à travers les niveaux de parenthésage : <code>C-M-u</code> vous amène au début du groupe dans lequel se situe le curseur et <code>C-M-d</code> vous transporte au début du prochain groupe à l’intérieur de l’expression actuelle. Le plus simple est encore de les essayer pour en voir les effets !</p><p id="r-577747" data-claire-element-id="577747">Vous pouvez également vous déplacer au début et à la fin des instructions avec <code>M-a</code> (<code>c-beginning-of-statement</code>) et <code>M-e</code> (<code>c-end-of-statement</code>), respectivement.</p><p id="r-577748" data-claire-element-id="577748">Enfin, les commandes <code>beginning-of-defun</code> et <code>end-of-defun</code> font, sans surprise, le voyage au début et à la fin d’une définition de fonction.</p><p id="r-577749" data-claire-element-id="577749">Récapitulons les commandes directement accessibles :</p><table id="r-577766" data-claire-element-id="577766"><tbody id="r-577765" data-claire-element-id="577765"><tr id="r-577754" data-claire-element-id="577754"><td id="r-577751" data-claire-element-id="577751"><p id="r-577750" data-claire-element-id="577750"><code>C-b</code>, <code>C-f</code></p></td><td id="r-577753" data-claire-element-id="577753"><p id="r-577752" data-claire-element-id="577752">déplacement au mot</p></td></tr><tr id="r-577759" data-claire-element-id="577759"><td id="r-577756" data-claire-element-id="577756"><p id="r-577755" data-claire-element-id="577755"><code>C-M-b</code>, <code>C-M-f</code>, <code>C-M-u</code>, <code>C-M-f</code></p></td><td id="r-577758" data-claire-element-id="577758"><p id="r-577757" data-claire-element-id="577757">déplacement à l’expression (équilibrée)</p></td></tr><tr id="r-577764" data-claire-element-id="577764"><td id="r-577761" data-claire-element-id="577761"><p id="r-577760" data-claire-element-id="577760"><code>M-a</code>, <code>M-e</code></p></td><td id="r-577763" data-claire-element-id="577763"><p id="r-577762" data-claire-element-id="577762">déplacement à l’instruction</p></td></tr></tbody></table>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs">Écrire du code C avec Emacs</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/edition-du-code-avec-le-c-mode">
Édition du code avec le c-mode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
Plusieurs fichiers sources
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/gestion-de-l-historique-des-modifications-avec-vc">
Gestion de l’historique des modifications avec VC
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
<span class="next">Plusieurs fichiers sources</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Plusieursfichierssources"></a><h2>Plusieurs fichiers sources</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/edition-du-code-avec-le-c-mode">
<span class="arrow"></span>
<span class="next">Édition du code avec le c-mode</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/gestion-de-l-historique-des-modifications-avec-vc">
<span class="next">Gestion de l’historique des modifications avec VC</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-577769" data-claire-element-id="577769">Avec ce que nous venons juste de voir, nous sommes maintenant capables d’éditer un fichier source C. Toutefois, la plupart des projets ne sont pas constitués d’un seul fichier, aussi, nous allons nous pencher sur la gestion de plusieurs fichiers dans Emacs. Cette section n’est pas directement liée à la programmation en C, mais la question revient fréquemment chez les novices, et c’est pourquoi j’ai décidé de la traiter ici.</p><h2 id="r-hierarchies-de-fichiers" data-claire-element-id="577816">Hiérarchies de fichiers</h2><p id="r-577770" data-claire-element-id="577770">Typiquement, le scénario est le suivant : vous possédez plusieurs fichiers sources regroupés dans un dossier. Quelque chose que beaucoup de gens aiment faire est pouvoir regarder la hiérarchie des fichiers et naviguer de fichier en fichier. Pour cela, Emacs offre deux mécanismes : <code>dired</code>, un explorateur de fichiers, et la <code>speedbar</code>, une barre latérale.</p><p id="r-577771" data-claire-element-id="577771">Selon vos goûts, vous préférerez sans doute l’un ou l’autre. Les différences sont multiples : <code>dired</code> possède plus de facilités pour la gestion des hiérarchies de fichiers et de dossiers, avec toutes les fonctions classiques que l’on pourrait attendre d’un explorateur de fichiers, et se présente comme une application Emacs à part entière, utilisant ses propres <em>buffers</em>. À l’opposé, la <code>speedbar</code> s’affiche dans un cadre (<em>frame</em>) à part, et son contenu est constamment recalculé de sorte que le dossier affiché dans la barre soit toujours celui du fichier actuel.</p><aside id="r-577773" data-claire-element-id="577773" data-claire-semantic="information"><p id="r-577772" data-claire-element-id="577772">Si vous n’êtes pas habitué à la terminologie emacsienne, sachez qu’une <em>fenêtre</em> correspond à une division de l’affichage d’Emacs (ce que vous obtenez avec <code>C-x 2</code> par exemple) tandis qu’un cadre est un ensemble de fenêtres indépendant, ce qui, en mode graphique, correspond, pour la plupart des gestionnaires de fenêtres, à ce qu’ils appellent une <em>fenêtre</em>. Sauf mention contraire, nous utiliserons ici le vocabulaire d’Emacs.</p></aside><p id="r-577774" data-claire-element-id="577774">À l’usage, l’un ou l’autre est assez naturel. Pour lancer <code>dired</code>, utilisez la commande <code>C-x d</code> (<code>dired</code>) ou <code>C-x C-f</code> (<code>find-file</code>) avec le chemin d’un dossier. Pour lancer la <code>speedbar</code>, tapez <code>M-x speedbar</code> ; un cadre devrait apparaître à côté de votre cadre principal.</p><p id="r-577775" data-claire-element-id="577775">Une fois à l’intérieur de l’un ou l’autre, placez-vous sur un fichier et tapez <code>RET</code> (<code>dired-advertised-find-file</code> ou <code>speedbar-edit-line</code>) pour le visiter. Sous <code>dired</code>, vous avez l’option de visiter le fichier dans une autre fenêtre avec <code>o</code> (<code>dired-find-file-other-window</code>).</p><p id="r-577776" data-claire-element-id="577776">Si vous voulez parcourir des sous-dossiers, sachez que <code>dired</code> prône une disposition plane tandis que la <code>speedbar</code> affiche les dossiers et les fichiers sous forme arborescente. Lorsque votre curseur est sur une ligne correspondant à un sous-dossier, tapez <code>i</code> sous <code>dired</code> ou <code>+</code> dans la <code>speedbar</code> (respectivement, <code>dired-maybe-insert-subdir</code> et <code>speedbar-expand-line</code>) pour insérer son listage dans le <em>buffer</em> actuel. Pour supprimer l’affichage d’un sous-dossier, placez-vous sur son en-tête (son chemin, juste au-dessus du listage, pour <code>dired</code>, ou son nom dans l’arborescence, pour la <code>speedbar</code>) et exécutez la commande <code>M-x dired-kill-subdir</code> ou <code>-</code> (<code>speedbar-contract-line</code>), pour <code>dired</code> et la <code>speedbar</code> respectivement. Au lieu de l’effacer complètement, <code>dired</code> vous propose aussi d’utiliser la commande <code>$</code> (<code>dired-hide-subdir</code>), qui, malgré son nom, permet de cacher <em>et</em> de découvrir le contenu du dossier.</p><aside id="r-577778" data-claire-element-id="577778" data-claire-semantic="information"><p id="r-577777" data-claire-element-id="577777">Si votre gestionnaire de fenêtres ne vous permet pas de déplacer facilement le focus au clavier, sachez qu’Emacs vous permet d’aller de cadre en cadre avec <code>C-x 5 o</code> (<code>other-frame</code>).</p></aside><p id="r-577779" data-claire-element-id="577779">Et comme précédemment, un petit récapitulatif :</p><table id="r-577815" data-claire-element-id="577815"><tbody id="r-577814" data-claire-element-id="577814"><tr id="r-577785" data-claire-element-id="577785"><td id="r-577780" data-claire-element-id="577780"></td><td id="r-577782" data-claire-element-id="577782"><p id="r-577781" data-claire-element-id="577781"><code>dired</code></p></td><td id="r-577784" data-claire-element-id="577784"><p id="r-577783" data-claire-element-id="577783"><code>speedbar</code></p></td></tr><tr id="r-577792" data-claire-element-id="577792"><td id="r-577787" data-claire-element-id="577787"><p id="r-577786" data-claire-element-id="577786">parcourir un dossier</p></td><td id="r-577789" data-claire-element-id="577789"><p id="r-577788" data-claire-element-id="577788"><code>C-x d</code></p></td><td id="r-577791" data-claire-element-id="577791"><p id="r-577790" data-claire-element-id="577790">automatique</p></td></tr><tr id="r-577799" data-claire-element-id="577799"><td id="r-577794" data-claire-element-id="577794"><p id="r-577793" data-claire-element-id="577793">visiter un fichier</p></td><td id="r-577796" data-claire-element-id="577796"><p id="r-577795" data-claire-element-id="577795"><code>RET</code></p></td><td id="r-577798" data-claire-element-id="577798"><p id="r-577797" data-claire-element-id="577797"><code>RET</code></p></td></tr><tr id="r-577806" data-claire-element-id="577806"><td id="r-577801" data-claire-element-id="577801"><p id="r-577800" data-claire-element-id="577800">insérer un sous-dossier</p></td><td id="r-577803" data-claire-element-id="577803"><p id="r-577802" data-claire-element-id="577802"><code>i</code></p></td><td id="r-577805" data-claire-element-id="577805"><p id="r-577804" data-claire-element-id="577804"><code>+</code></p></td></tr><tr id="r-577813" data-claire-element-id="577813"><td id="r-577808" data-claire-element-id="577808"><p id="r-577807" data-claire-element-id="577807">cacher un sous-dossier</p></td><td id="r-577810" data-claire-element-id="577810"><p id="r-577809" data-claire-element-id="577809"><code>$</code> ou <code>M-x dired-kill-subdir</code></p></td><td id="r-577812" data-claire-element-id="577812"><p id="r-577811" data-claire-element-id="577811"><code>-</code></p></td></tr></tbody></table><h2 id="r-plusieurs-fichiers-dans-emacs" data-claire-element-id="577847">Plusieurs fichiers dans Emacs</h2><p id="r-577817" data-claire-element-id="577817">Maintenant que vous savez accéder facilement à plusieurs fichiers de votre projet, vous risquez fort d’être vite submergé par le grand nombre de <em>buffers</em> ouverts. Emacs ne dispose pas de tabs (ce n’est pas comme si vous alliez vous servir de votre souris pour y accéder, de toute manière). En revanche, plusieurs modes sont disponibles pour gérer vos <em>buffers</em>. Je ne vais pas tous les passer en revue ici, je ne donnerai qu’une seule solution.</p><p id="r-577818" data-claire-element-id="577818">La première commande à connaître pour bien gérer vos multiples <em>buffers</em> est sans doute <code>C-x C-b</code> (<code>list-buffers</code>). Elle démarre le gestionnaire de <em>buffers</em>. Ce dernier se présente comme une simple liste des <em>buffers</em> ouverts. Vous pouvez y effectuer les opérations de navigation habituelles, dont la recherche (avec <code>C-s</code> (<code>isearch-forward</code>) pour les étourdis). <code>RET</code> (<code>Buffer-menu-this-window</code>) vous permet de visiter le <em>buffer</em> à la ligne actuelle. Une autre utilisation très pratique est de supprimer plusieurs <em>buffers</em> à la fois. Pour cela, marquez chaque <em>buffer</em> à détruire avec la commande <code>d</code> (<code>Buffer-menu-delete</code>). La lettre <code>'D'</code> apparaît alors à gauche du nom. La commande <code>x</code> (<code>Buffer-menu-execute</code>) effectue l’opération de nettoyage en elle-même. Ainsi, si vous vous êtes trompé dans votre marquage, vous pouvez revenir en arrière en utilisant la commande <code>u</code> (<code>Buffer-menu-unmark</code>) sur la même ligne.</p><p id="r-577819" data-claire-element-id="577819">Tout cela est bien utile pour faire le ménage mais ne vous aide guère pour votre besoin le plus simple : naviguer de <em>buffer</em> en <em>buffer</em>. Pour cela, il y a bien sûr la commande <code>C-x b</code> (<code>switch-to-buffer</code>) par défaut d’Emacs pour changer de <em>buffer</em>. Mais elle n’est pas très pratique ; en effet, elle demande d’entrer le début du nom pour accéder au <em>buffer</em>. Fort heureusement, il existe (au moins) un mode qui vous permet de changer de <em>buffer</em> en tapant quelques lettres n’importe où dans le nom. Je vous présente là l’<code>iswitchb-mode</code>. Pour l’essayer, il vous suffit d’effectuer la commande <code>M-x iswitchb-mode</code> ; de même pour le désactiver. Pour l’adopter définitivement, ajoutez à votre <code>.emacs</code> la ligne :</p><pre id="r-577820" data-claire-element-id="577820"><code data-claire-semantic="common-lisp">(iswitchb-mode t)</code></pre><p id="r-577821" data-claire-element-id="577821">La combinaison <code>C-x b</code> invoquera à présent <code>iswitchb-buffer</code>. Si vous l’essayez, vous remarquerez que la liste des <em>buffers</em> qui sont encore candidats à la sélection est maintenant affichée à côté de votre saisie. Dans ce mode, les commandes <code>C-r</code> (<code>iswitchb-prev-match</code>) et <code>C-s</code> (<code>iswitchb-next-match</code>) vous permettent de faire défiler les éléments de la liste de manière cyclique, et <code>RET</code> sélectionne le premier <em>buffer</em> de la liste. Ainsi, vous n’aurez plus à taper le début exact du nom que vous voulez, il vous suffira simplement d’entrer quelques lettres remarquables et, moyennant quelques rotations de la liste, vous arriverez rapidement à destination.</p><p id="r-577822" data-claire-element-id="577822">Vous pouvez aussi demander à utiliser des expressions régulières. La commande <code>C-t</code> (<code>iswitchb-toggle-regexp</code>), dans l’<code>iswitchb-mode</code>, vous permet cela. Par exemple, pour obtenir une liste des fichiers C ouverts, vous pourriez utiliser le motif <code>\.c$</code>. Veuillez cependant prendre note du fait que les expressions régulières d’Emacs diffèrent d’autres syntaxes, soyez donc averti et pensez à lire le manuel (avec <code>C-h i</code> (<code>info</code>), par exemple) si vous désirez en faire bon usage.</p><p id="r-577823" data-claire-element-id="577823">Avec l’habitude, ce système très flexible remplace avantageusement les tabs. Vous n’êtes plus lié à une liste prédéfinie ; vous avez la possibilité de fabriquer rapidement la vôtre, adaptée à votre requête. Du reste, il vous permettra de même d’aller de <em>buffer</em> en <em>buffer</em>. Et tout cela pour un encombrement nul dans vos autres actions !</p><p id="r-577824" data-claire-element-id="577824">Et pour les petits étourdis :</p><table id="r-577846" data-claire-element-id="577846"><tbody id="r-577845" data-claire-element-id="577845"><tr id="r-577829" data-claire-element-id="577829"><td id="r-577826" data-claire-element-id="577826"><p id="r-577825" data-claire-element-id="577825"><code>C-x C-b</code></p></td><td id="r-577828" data-claire-element-id="577828"><p id="r-577827" data-claire-element-id="577827">gestionnaire de <em>buffers</em></p></td></tr><tr id="r-577834" data-claire-element-id="577834"><td id="r-577831" data-claire-element-id="577831"><p id="r-577830" data-claire-element-id="577830"><code>C-x b</code></p></td><td id="r-577833" data-claire-element-id="577833"><p id="r-577832" data-claire-element-id="577832">change de <em>buffer</em></p></td></tr><tr id="r-577839" data-claire-element-id="577839"><td id="r-577836" data-claire-element-id="577836"><p id="r-577835" data-claire-element-id="577835"><code>C-r</code> et <code>C-s</code></p></td><td id="r-577838" data-claire-element-id="577838"><p id="r-577837" data-claire-element-id="577837">défilement de la liste (dans <code>iswitchb</code>)</p></td></tr><tr id="r-577844" data-claire-element-id="577844"><td id="r-577841" data-claire-element-id="577841"><p id="r-577840" data-claire-element-id="577840"><code>C-t</code></p></td><td id="r-577843" data-claire-element-id="577843"><p id="r-577842" data-claire-element-id="577842">activation des <em>regexps</em> (dans <code>iswitchb</code>)</p></td></tr></tbody></table><h2 id="r-edition-simultanee-de-plusieurs-fichiers" data-claire-element-id="577879">Édition simultanée de plusieurs fichiers</h2><p id="r-577848" data-claire-element-id="577848">Bien sûr, vous n’êtes pas encore capable de vous dédoubler pour éditer plusieurs fichiers à la fois, mais parfois, vous pourriez vouloir afficher deux fichiers (voire plus) côte à côte.</p><p id="r-577849" data-claire-element-id="577849">Pour se faire, rien de plus simple. Il vous suffit de partager votre affichage en deux : verticalement avec <code>C-x 2</code> (<code>split-window-vertically</code>) ou horizontalement avec <code>C-x 3</code> (<code>split-window-horizontally</code>). Pour passer d’une fenêtre à l’autre, utilisez <code>C-x o</code> (<code>other-window</code>). Enfin, <code>C-x 0</code> (<code>delete-window</code>) et <code>C-x 1</code> (<code>delete-other-windows</code>) vous permettent respectivement de supprimer la fenêtre sur laquelle se trouve le focus et de ne laisser qu’elle.</p><p id="r-577850" data-claire-element-id="577850">Ainsi, vous pourrez plus facilement comparer ou transférer du code d’un fichier à un autre.</p><p id="r-577851" data-claire-element-id="577851">Sachez également qu’il existe des commandes qui marient une action donnée à un changement de fenêtre, telles que<code>C-x 4 f</code> (<code>find-file-other-window</code>) et <code>C-x 4 b</code> (<code>switch-to-buffer-other-window</code>). La première ouvre un fichier, à l’instar de <code>C-x C-f</code> (<code>find-file</code>) mais l’affiche dans une fenêtre séparée. La seconde agit comme <code>C-x b</code> (<code>switch-to-buffer</code>) mais, de même, place le contenu dans une autre fenêtre. Si le cadre n’est constitué que d’une fenêtre, celui-ci est automatiquement scindé en deux.</p><table id="r-577878" data-claire-element-id="577878"><tbody id="r-577877" data-claire-element-id="577877"><tr id="r-577856" data-claire-element-id="577856"><td id="r-577853" data-claire-element-id="577853"><p id="r-577852" data-claire-element-id="577852"><code>C-x 2</code>, <code>C-x 3</code></p></td><td id="r-577855" data-claire-element-id="577855"><p id="r-577854" data-claire-element-id="577854">création de fenêtres</p></td></tr><tr id="r-577861" data-claire-element-id="577861"><td id="r-577858" data-claire-element-id="577858"><p id="r-577857" data-claire-element-id="577857"><code>C-x o</code></p></td><td id="r-577860" data-claire-element-id="577860"><p id="r-577859" data-claire-element-id="577859">déplacement de fenêtre à fenêtre</p></td></tr><tr id="r-577866" data-claire-element-id="577866"><td id="r-577863" data-claire-element-id="577863"><p id="r-577862" data-claire-element-id="577862"><code>C-x 0</code>, <code>C-x 1</code></p></td><td id="r-577865" data-claire-element-id="577865"><p id="r-577864" data-claire-element-id="577864">suppression de fenêtres</p></td></tr><tr id="r-577871" data-claire-element-id="577871"><td id="r-577868" data-claire-element-id="577868"><p id="r-577867" data-claire-element-id="577867"><code>C-x 4 f</code></p></td><td id="r-577870" data-claire-element-id="577870"><p id="r-577869" data-claire-element-id="577869">visite un fichier dans une autre fenêtre</p></td></tr><tr id="r-577876" data-claire-element-id="577876"><td id="r-577873" data-claire-element-id="577873"><p id="r-577872" data-claire-element-id="577872"><code>C-x 4 b</code></p></td><td id="r-577875" data-claire-element-id="577875"><p id="r-577874" data-claire-element-id="577874">affiche un <em>buffer</em> dans une autre fenêtre</p></td></tr></tbody></table>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs">Écrire du code C avec Emacs</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/edition-du-code-avec-le-c-mode">
Édition du code avec le c-mode
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
Plusieurs fichiers sources
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/gestion-de-l-historique-des-modifications-avec-vc">
Gestion de l’historique des modifications avec VC
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/edition-du-code-avec-le-c-mode">
<span class="arrow"></span>
<span class="next">Édition du code avec le c-mode</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/gestion-de-l-historique-des-modifications-avec-vc">
<span class="next">Gestion de l’historique des modifications avec VC</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="GestiondelhistoriquedesmodificationsavecVC"></a><h2>Gestion de l’historique des modifications avec VC</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
<span class="arrow"></span>
<span class="next">Plusieurs fichiers sources</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-577881" data-claire-element-id="577881">Le dernier outil essentiel à tout projet sérieux est un gestionnaire de versions. Si vous n’êtes pas familier avec ce concept, voici une brève introduction. Vos fichiers seront amenés à grandement évoluer avec les phases d’essai, de correction, d’essais publics, d’amélioration, <em>etc.</em> Il est donc primordial de contrôler ces changements sous forme de <em>versions</em>. Des logiciels spécialisés appelés « systèmes de contrôle de versions » (VCS en anglais) permettent de faire cela. Nous n’entrerons pas ici dans le détail du fonctionnement de ceux-ci, mais le principe général est le suivant : chaque fichier est associé à une copie <em>persistante</em>, qui représente tous ses états depuis le début, toutes ses <em>versions</em>, sous forme de différences. Cela signifie qu’une version n’est pas stockée en entier mais uniquement sous une forme <em>relative à une version voisine</em>. Dans sa réalisation la plus classique, par exemple, si vous ajoutez une ligne à un fichier, le fichier de contrôle, contenant la copie persistante, enregistrera une différence d’une ligne par rapport à la version précédente.</p><p id="r-577882" data-claire-element-id="577882">Emacs intègre un support de certains de ces systèmes, dont RCS, CVS, SVN et GNU Arch. Pour illustrer cette intégration, qui porte le petit nom de VC pour, vous l’aurez deviné, <em>Version Control</em>, nous allons nous intéresser au plus simple d’entre eux : RCS. Mais les commandes demeurent approximativement les mêmes quel que soit le programme de gestion de versions.</p><p id="r-577883" data-claire-element-id="577883">Traditionnellement, les fichiers de contrôle de RCS sont stockés localement dans un sous-dossier de celui où se situent vos fichiers sources, ce sous-dossier portant le nom <code>RCS</code>. Si vous ne le créez pas par vous-même, Emacs vous le proposera en temps voulu.</p><p id="r-577884" data-claire-element-id="577884">L’utilisation de VC repose sur la commande <code>C-x v v</code> (<code>vc-next-action</code>). Comme son nom l’indique, elle fait… des choses, selon l’état actuel du fichier. Avec RCS, un fichier peut avoir plusieurs états. Dans son utilisation classique, ce sont les suivants.</p><ol id="r-577891" data-claire-element-id="577891"><li id="r-577886" data-claire-element-id="577886"><p id="r-577885" data-claire-element-id="577885">Au départ, le fichier est inconnu de RCS. Lorsque vous l’enregistrez auprès de ce dernier (avec <code>C-x v v</code>), celui-ci s’approprie le contenu. Le fichier et la version la plus récente connue de RCS sont alors les mêmes.</p></li><li id="r-577888" data-claire-element-id="577888"><p id="r-577887" data-claire-element-id="577887">À ce stade, vous ne pouvez pas modifier le fichier à nouveau. Il vous faut prévenir RCS de votre intention, ceci afin d’empêcher que plusieurs personnes ne modifient le même fichier en même temps. Cette action s’appelle le verrouillage et s’effectue aussi par <code>C-x v v</code>. Une fois le fichier verrouillé, vous êtes sûr qu’il est la seule copie de travail existante.</p></li><li id="r-577890" data-claire-element-id="577890"><p id="r-577889" data-claire-element-id="577889">Une fois vos modifications effectuées, <code>C-x v v</code> synchronise votre brouillon avec la copie de contrôle. VC vous demande alors de fournir un commentaire décrivant les changements, commentaire qui sera inscrit dans une espèce de journal de bord du fichier. La fenêtre d’édition du message est tout à fait banale et la validation est obtenue par le traditionnel <code>C-c C-c</code>, valable pour la plupart des formulaires sous Emacs. Après cette étape, le fichier et la version la plus récente connue de RCS sont à nouveau les mêmes.</p></li></ol><p id="r-577892" data-claire-element-id="577892">Tout ceci est bien joli, mais à quoi serviraient un historique et un journal que l’on ne peut consulter ?</p><p id="r-577893" data-claire-element-id="577893">La commande <code>C-x v ~</code> (<code>vc-version-other-window</code>) vous permet d’accéder au contenu d’une version antérieure de votre fichier. Le numéro de la version vous sera demandé. Mais que faire si vous ne vous rappelez plus de la bonne version ? C’est à cela que servent les commentaires que vous avez pris soin d’entrer tout au long de votre travail ! Pour voir la liste des versions ainsi que les messages associés, tapez <code>C-x v l</code> (<code>vc-print-log</code>).</p><p id="r-577894" data-claire-element-id="577894">Une fois la version voulue récupérée dans un <em>buffer</em> secondaire, vous pouvez afficher les deux <em>buffers</em> en parallèle comme nous avons vu précédemment. Mais VC propose une commande intéressante pour vous aider à voir les différences entre vos versions : <code>C-x v =</code> (<code>vc-diff</code>). Elle vous propose une comparaison rapide de deux versions, avec la différence placée dans un <em>buffer</em> à part.</p><p id="r-577895" data-claire-element-id="577895">Cela peut sembler beaucoup de choses à enregistrer si vous n’avez jamais utilisé de VCS auparavant, mais j’ai moi-même débuté dans ce domaine avec VC qui est, à mon avis, un moyen simple de se familiariser avec le concept tout en restant bien au chaud dans son éditeur préféré. Et pour vous y aider, voici un… récapitulatif ! Avouez que vous ne vous y attendiez pas.</p><table id="r-577917" data-claire-element-id="577917"><tbody id="r-577916" data-claire-element-id="577916"><tr id="r-577900" data-claire-element-id="577900"><td id="r-577897" data-claire-element-id="577897"><p id="r-577896" data-claire-element-id="577896"><code>C-x v v</code></p></td><td id="r-577899" data-claire-element-id="577899"><p id="r-577898" data-claire-element-id="577898">change d’état</p></td></tr><tr id="r-577905" data-claire-element-id="577905"><td id="r-577902" data-claire-element-id="577902"><p id="r-577901" data-claire-element-id="577901"><code>C-x v ~</code></p></td><td id="r-577904" data-claire-element-id="577904"><p id="r-577903" data-claire-element-id="577903">ressuscite une version</p></td></tr><tr id="r-577910" data-claire-element-id="577910"><td id="r-577907" data-claire-element-id="577907"><p id="r-577906" data-claire-element-id="577906"><code>C-x v l</code></p></td><td id="r-577909" data-claire-element-id="577909"><p id="r-577908" data-claire-element-id="577908">invoque la liste des versions</p></td></tr><tr id="r-577915" data-claire-element-id="577915"><td id="r-577912" data-claire-element-id="577912"><p id="r-577911" data-claire-element-id="577911"><code>C-x v =</code></p></td><td id="r-577914" data-claire-element-id="577914"><p id="r-577913" data-claire-element-id="577913">compare deux versions</p></td></tr></tbody></table><p id="r-577918" data-claire-element-id="577918">Cette présentation de VC et de RCS achève ce premier article. Dans le prochain chapitre, nous parlerons de la compilation de fichiers et de projets écrits en C, à l’aide de <em>makefiles</em>, le tout depuis Emacs. Contrairement à ce premier tutoriel, il sera bien moins porté sur Emacs lui-même que sur les outils à mettre en œuvre pour compiler depuis Emacs, c’est-à-dire GCC et <code>make</code>.</p><aside id="r-577920" data-claire-element-id="577920" data-claire-semantic="information"><p id="r-577919" data-claire-element-id="577919">Je remercie Metzgermeister et nicofrand pour la relecture de cet article.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs">Écrire du code C avec Emacs</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/edition-du-code-avec-le-c-mode">
Édition du code avec le c-mode
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
Plusieurs fichiers sources
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/gestion-de-l-historique-des-modifications-avec-vc">
Gestion de l’historique des modifications avec VC
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ecrire-du-code-c-avec-emacs/plusieurs-fichiers-sources">
<span class="arrow"></span>
<span class="next">Plusieurs fichiers sources</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/ecrire-du-code-c-avec-emacs.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 08:32:14 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/ecrire-du-code-c-avec-emacs.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:32:03 GMT -->
</html>