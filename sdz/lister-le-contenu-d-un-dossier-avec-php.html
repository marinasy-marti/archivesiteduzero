<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/lister-le-contenu-d-un-dossier-avec-php.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 09:02:09 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/lister-le-contenu-d-un-dossier-avec-php.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:37:01 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Lister le contenu d&#039;un dossier avec PHP</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Lister le contenu d&#039;un dossier avec PHP</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Listerlecontenud039undossieravecPHP">Lister le contenu d&#039;un dossier avec PHP</a><br/><a href="#Commentallons-nousfaire">Comment allons-nous faire ?</a><br/><a href="#Listagedesfichiers">Listage des fichiers</a><br/><a href="#Idesd039amliorations">Idées d&#039;améliorations</a><br/></div>
<a name="Listerlecontenud039undossieravecPHP"></a><h2>Lister le contenu d&#039;un dossier avec PHP</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/comment-allons-nous-faire">
<span class="next">Comment allons-nous faire ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-413238" data-claire-element-id="413238">Bonjour chers Zéros.</p><p id="r-413239" data-claire-element-id="413239">Dans ce tutoriel, je vais vous apprendre à lister les fichiers qui sont contenus dans un dossier.<br/> Par exemple, si vous avez un script pour uploader des fichiers, vous aurez sûrement envie de pouvoir les lister pour les retrouver sans passer par votre FTP.</p><p id="r-413240" data-claire-element-id="413240">Nous allons donc voir ça ensemble ! ;)</p><p id="r-413241" data-claire-element-id="413241">Pour les prérequis, il faut au moins que vous sachiez utiliser les conditions et les boucles, c'est tout ce qu'il vous faut pour réaliser ce petit script.</p><p id="r-413242" data-claire-element-id="413242">Prêts ? On y va.</p>
</div><a name="Commentallons-nousfaire"></a><h2>Comment allons-nous faire ?</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
<span class="next">Listage des fichiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-413243" data-claire-element-id="413243">Pour commencer, nous allons ici poser les bases (simples) de ce que nous allons faire pour lister le contenu d'un dossier.</p><p id="r-413244" data-claire-element-id="413244">Pour faire simple, nous allons nous servir de deux fonctions que vous ne connaissez peut-être pas.<br/> Ce sont <a href="http://fr2.php.net/opendir">opendir()</a> et <a href="http://fr2.php.net/manual/fr/function.readdir.php">readdir()</a>.</p><p id="r-413245" data-claire-element-id="413245">Si vous avez ne serait-ce que quelques bases d'anglais, vous aurez sans doute reconnu <em>open</em> qui signifie <em>ouvrir</em>, et <em>read</em> qui signifie <em>lire</em>. Pour dir, c'est une abréviation de <em>directory</em>, qui signifie <em>dossier</em>.</p><p id="r-413246" data-claire-element-id="413246">Je vais vous expliquer leur fonctionnement :</p><ul id="r-413251" data-claire-element-id="413251"><li id="r-413248" data-claire-element-id="413248"><p id="r-413247" data-claire-element-id="413247"><strong>opendir() :</strong> cette fonction sert à ouvrir un dossier. Elle prend comme paramètre le nom du dossier qui doit être ouvert, celui justement dont on va lire le contenu ! ;)</p></li><li id="r-413250" data-claire-element-id="413250"><p id="r-413249" data-claire-element-id="413249"><strong>readdir() :</strong> cette fonction va s'utiliser après la fonction opendir(). Elle permet de lire le contenu du dossier précédemment ouvert.</p></li></ul><p id="r-413252" data-claire-element-id="413252">Et c'est tout... :D</p><p id="r-413253" data-claire-element-id="413253">Ce n'est pas plus dur !<br/> Bien sûr, il ne suffit pas de poser les deux fonctions l'une après l'autre, vous vous en doutez bien.</p><p id="r-413254" data-claire-element-id="413254">Comme il y a sûrement plusieurs fichiers dans votre dossier, il faudra utiliser une boucle...<br/> Nous allons faire tout cela dans la prochaine partie ! :)</p><p id="r-413255" data-claire-element-id="413255">Et puis, pour le plaisir (chacun son point de vue sur le plaisir :p ), nous allons faire un compteur qui va compter le nombre de fichiers contenus dans votre dossier.</p><p id="r-413256" data-claire-element-id="413256">Vous savez tout !</p><p id="r-413257" data-claire-element-id="413257">Nous pouvons passer à la pratique ! :pirate:</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php">Lister le contenu d&#039;un dossier avec PHP</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/comment-allons-nous-faire">
Comment allons-nous faire ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
Listage des fichiers
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/idees-d-ameliorations-3">
Idées d&#039;améliorations
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
<span class="next">Listage des fichiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Listagedesfichiers"></a><h2>Listage des fichiers</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/comment-allons-nous-faire">
<span class="arrow"></span>
<span class="next">Comment allons-nous faire ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/idees-d-ameliorations-3">
<span class="next">Idées d&#039;améliorations</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-413259" data-claire-element-id="413259">Nous voilà dans la partie pratique de ce tutoriel. <br/> Nous allons avoir, au terme de ce chapitre, une page qui liste le contenu du dossier souhaité ! ;)</p><p id="r-413260" data-claire-element-id="413260">Comme je vous l'ai annoncé dans la première partie, nous allons utiliser un compteur qui va nous donner le nombre de fichiers présents dans le dossier.<br/> Pour faire cela, nous allons simplement créer une variable <strong>$nb_fichier</strong> que l'on incrémentera à chaque nouveau fichier.</p><p id="r-413261" data-claire-element-id="413261">Nous allons donc déclarer cette variable.<br/> Les résultats seront affichés sous forme de liste. On va ouvrir notre balise &lt;ul&gt; ici :</p><pre id="r-413262" data-claire-element-id="413262"><code data-claire-semantic="html+php">&lt;?php
$nb_fichier = 0;
echo '&lt;ul&gt;';
?&gt;</code></pre><p id="r-413263" data-claire-element-id="413263">Rien de compliqué jusque-là.</p><p id="r-413264" data-claire-element-id="413264">Maintenant, il va falloir ouvrir le dossier souhaité avec la fonction opendir() que je vous ai décrite dans la première partie. On stockera le résultat de l'ouverture du dossier dans une variable <strong>$dossier</strong>, vous verrez ensuite pourquoi. ;)</p><pre id="r-413265" data-claire-element-id="413265"><code data-claire-semantic="html+php">&lt;?php
if($dossier = opendir('./mondossier'))
{
?&gt;</code></pre><div id="r-413267" data-claire-element-id="413267" data-claire-semantic="question"><p id="r-413266" data-claire-element-id="413266">Pourquoi avoir ouvert un if ? :o</p></div><p id="r-413268" data-claire-element-id="413268">Bonne question ! Quand j'ouvre le dossier avec opendir, je donne en paramètre le lien <strong>relatif</strong> (M@teo21 traite des liens relatifs dans son cours xHTML/CSS : <a href="http://www.siteduzero.com/tuto-3-28-1-creer-des-liens.html#ss_part_1">ici</a>). <br/> Si jamais le dossier en question n'existe pas, il ne sera pas ouvert, et par conséquent le script plantera !<br/> Pour éviter cela, on met une condition. Si elle est vérifiée, on continue l'exécution du script, sinon on affiche un message d'erreur.</p><p id="r-413269" data-claire-element-id="413269">Maintenant que cette question ne vous trotte plus dans la tête, nous allons continuer. :)</p><p id="r-413270" data-claire-element-id="413270">Nous allons lire les fichiers avec la fonction readdir() et commencer notre boucle.</p><p id="r-413271" data-claire-element-id="413271">Comme je vous l'ai dit plus haut, nous avons créé une variable $dossier qui contient le résultat de l'ouverture. C'est cette variable qui va être lue avec readdir().</p><pre id="r-413272" data-claire-element-id="413272"><code data-claire-semantic="html+php">&lt;?php
while(false !== ($fichier = readdir($dossier)))
{
?&gt;</code></pre><p id="r-413273" data-claire-element-id="413273">Encore une fois, des questions se posent.<br/> Que signifie ce « false !== » ? Il vérifie que la lecture du dossier n'a pas retourné d'erreur.</p><p id="r-413274" data-claire-element-id="413274">Si tout est bon, on entre dans la boucle.</p><pre id="r-413275" data-claire-element-id="413275"><code data-claire-semantic="html+php">&lt;?php
if($fichier != '.' &amp;&amp; $fichier != '..' &amp;&amp; $fichier != 'index.php')
{
?&gt;</code></pre><p id="r-413276" data-claire-element-id="413276">Ici, nous indiquons les fichiers <strong>à ne pas afficher dans les résultats</strong>. Je m'explique.</p><p id="r-413277" data-claire-element-id="413277">Si nous prenons l'exemple de la liste d'un dossier qui contient des images, cela ferait un peu « tache » de voir apparaître un index.php en plein milieu de notre liste... :( <br/> Pour cette raison, nous mettons une condition qui dit : « Si ce n'est ni '.', ni '..', ni 'index.php', affiche les fichiers... ».</p><aside id="r-413279" data-claire-element-id="413279" data-claire-semantic="information"><p id="r-413278" data-claire-element-id="413278">Le '.' et le '..' sont des liens relatifs pour le déplacement dans les dossiers.<br/> Un point seul '.' signifie 'dossier actuel' et deux points '..' signifient 'dossier parent', le dossier qui contient le dossier dans lequel vous êtes.<br/>readdir() les met dans les fichiers du dossier, donc nous faisons en sorte de ne pas les afficher dans notre condition.</p></aside><p id="r-413280" data-claire-element-id="413280">Maintenant, on affiche les résultats !</p><pre id="r-413281" data-claire-element-id="413281"><code data-claire-semantic="html+php">&lt;?php
$nb_fichier++; // On incrémente le compteur de 1
echo '&lt;li&gt;&lt;a href=&quot;./mondossier/' . $fichier . '&quot;&gt;' . $fichier . '&lt;/a&gt;&lt;/li&gt;';
} // On ferme le if (qui permet de ne pas afficher index.php, etc.)
 
} // On termine la boucle
?&gt;</code></pre><p id="r-413282" data-claire-element-id="413282">Le code est explicite, on incrémente le compteur.<br/> Puis on crée une nouvelle entrée dans la liste avec le nom du fichier en lien. Comme ça, on ouvre le fichier (par exemple une image) directement en cliquant dessus. :)</p><p id="r-413283" data-claire-element-id="413283">Maintenant, il ne nous reste plus qu'à afficher le nombre de fichiers, le message d'erreur au cas où le dossier n'aurait pas été ouvert et la fermeture de la liste.</p><p id="r-413284" data-claire-element-id="413284">Ah ! Au fait, quand on ouvre un dossier, il faut aussi le fermer (comme la connexion à MySQL) : donc nous allons utiliser closedir() pour le fermer à la fin du script !</p><p id="r-413285" data-claire-element-id="413285">Au travail ! ;)</p><pre id="r-413286" data-claire-element-id="413286"><code data-claire-semantic="html+php">&lt;?php
echo '&lt;/ul&gt;&lt;br /&gt;';
echo 'Il y a &lt;strong&gt;' . $nb_fichier .'&lt;/strong&gt; fichier(s) dans le dossier';
 
closedir($dossier);
 
}
 
else
     echo 'Le dossier n\' a pas pu être ouvert';
?&gt;</code></pre><p id="r-413287" data-claire-element-id="413287">Et voilà !<br/> Nous en avons fini avec notre script !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php">Lister le contenu d&#039;un dossier avec PHP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/comment-allons-nous-faire">
Comment allons-nous faire ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
Listage des fichiers
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/idees-d-ameliorations-3">
Idées d&#039;améliorations
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/comment-allons-nous-faire">
<span class="arrow"></span>
<span class="next">Comment allons-nous faire ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/idees-d-ameliorations-3">
<span class="next">Idées d&#039;améliorations</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Idesd039amliorations"></a><h2>Idées d&#039;améliorations</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
<span class="arrow"></span>
<span class="next">Listage des fichiers</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-413289" data-claire-element-id="413289">Pour les idées d'améliorations, voici ce que vous pourriez faire ! ;)</p><ul id="r-413300" data-claire-element-id="413300"><li id="r-413291" data-claire-element-id="413291"><p id="r-413290" data-claire-element-id="413290">Un petit design : sans CSS, ça ne casse pas trois pattes... :p</p></li><li id="r-413293" data-claire-element-id="413293"><p id="r-413292" data-claire-element-id="413292">Un sélecteur de dossiers avec un formulaire : effectivement, ce code ne permet que de lister le contenu du dossier que vous avez indiqué en paramètre à opendir() ; avec une variable $_GET dans l'adresse, vous pourriez faire varier le paramètre de opendir() (sécuriser votre variable, on ne sait jamais ;) ).</p></li><li id="r-413295" data-claire-element-id="413295"><p id="r-413294" data-claire-element-id="413294">Ajouter une distinction entre fichiers et dossiers avec la fonction <a href="http://fr3.php.net/manual/fr/function.is-dir.php">is_dir()</a>.</p></li><li id="r-413297" data-claire-element-id="413297"><p id="r-413296" data-claire-element-id="413296">Mettre le tout dans une seule fonction. Faire une fonction lire_dossier() qui prend en paramètre le chemin relatif du dossier que vous voulez lire. Cette fonction contiendra le script que vous devrez adapter en conséquence, et en retournera la liste des fichiers.</p></li><li id="r-413299" data-claire-element-id="413299"><p id="r-413298" data-claire-element-id="413298">Tout ce que votre esprit créatif vous indique de faire ! Essayez, testez, faites des expérimentations (plus ou moins louches :D ) et voyez ce que ça donne, c'est comme cela qu'on progresse ! ;)</p></li></ul><p id="r-413301" data-claire-element-id="413301">Voilà pour les idées que j'ai, si vous en avez d'autres à proposer, n'hésitez pas ! :)</p><p id="r-413302" data-claire-element-id="413302">Bon travail ! ;)</p><p id="r-413303" data-claire-element-id="413303">Voilà, ce tutoriel touche à sa fin. J'espère qu'il vous aura rendu service.</p><p id="r-413304" data-claire-element-id="413304">Si vous avez des questions ou des suggestions, <a href="http://www.siteduzero.com/mp-273-51446.html">envoyez moi un Message Privé</a> ou postez un commentaire ! :)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php">Lister le contenu d&#039;un dossier avec PHP</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/comment-allons-nous-faire">
Comment allons-nous faire ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
Listage des fichiers
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/idees-d-ameliorations-3">
Idées d&#039;améliorations
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/lister-le-contenu-d-un-dossier-avec-php/listage-des-fichiers">
<span class="arrow"></span>
<span class="next">Listage des fichiers</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/lister-le-contenu-d-un-dossier-avec-php.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 09:02:09 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/lister-le-contenu-d-un-dossier-avec-php.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 05:37:02 GMT -->
</html>