<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/decouvrez-ogre-3d.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 20:16:37 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/decouvrez-ogre-3d.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 03:49:44 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Découvrez Ogre 3D</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/decouvrez-ogre-3d.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Découvrez Ogre 3D</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#DcouvrezOgre3D">Découvrez Ogre 3D</a><br/><a href="#IntroductionOgre3D">Introduction à Ogre 3D</a><br/><a href="#Unmoteur3D">Un moteur 3D ?</a><br/><a href="#PourquoiOgreetpasunautre">Pourquoi Ogre et pas un autre ?</a><br/><a href="#Tlchargementetinstallation">Téléchargement et installation</a><br/><a href="#Votrepremireapplication">Votre première application</a><br/><a href="#Configurationd039unprojet">Configuration d&#039;un projet</a><br/><a href="#Lecodedebase">Le code de base</a><br/><a href="#Insrerdesobjetsdanslascne">Insérer des objets dans la scène</a><br/><a href="#Lesentits">Les entités</a><br/><a href="#Lesnoeudsdescne">Les noeuds de scène</a><br/><a href="#Crerunmesh">Créer un mesh</a><br/><a href="#Sereprerdansl039espace">Se repérer dans l&#039;espace</a><br/><a href="#Lesystmedecoordonnes">Le système de coordonnées</a><br/><a href="#Dplacerdesobjets">Déplacer des objets</a><br/><a href="#Lacamra">La caméra</a><br/><a href="#LeViewport">Le Viewport</a><br/><a href="#Allumezlalumire">Allumez la lumière !</a><br/><a href="#Leslumires">Les lumières</a><br/><a href="#Lesombres">Les ombres</a><br/><a href="#Lagestiondesentres">La gestion des entrées</a><br/><a href="#Lesframelisteners">Les frame listeners</a><br/><a href="#OIS">OIS</a><br/><a href="#Allons-ysansbuffer">Allons-y sans buffer</a><br/><a href="#Avecbufferc039estplussimple">Avec buffer, c&#039;est plus simple ?</a><br/><a href="#Gardezlespiedssurterre">Gardez les pieds sur terre !</a><br/><a href="#Crerunterrain">Créer un terrain</a><br/><a href="#Leplaquagedetexture">Le plaquage de texture</a><br/><a href="#Etsionenveutplus">Et si on en veut plus ?</a><br/><a href="#Uncielau-dessusdenosttes">Un ciel au-dessus de nos têtes</a><br/><a href="#Uneapplicationpartirdezro">Une application à partir de zéro</a><br/><a href="#Prparation">Préparation</a><br/><a href="#Audbutunefentre">Au début, une fenêtre</a><br/><a href="#AjoutduFrameListener">Ajout du Frame Listener</a><br/><a href="#ImplmenterOIS">Implémenter OIS</a><br/><a href="#Lesmatriaux">Les matériaux</a><br/><a href="#Prparationduprojet">Préparation du projet</a><br/><a href="#Lastructured039unmatriau">La structure d&#039;un matériau</a><br/><a href="#Choisirlescouleurs">Choisir les couleurs</a><br/><a href="#Lestextures">Les textures</a><br/><a href="#Copierunmatriaudansunautre">Copier un matériau dans un autre</a><br/><a href="#Lesshaders1_2">Les shaders (1/2)</a><br/><a href="#Introduction">Introduction</a><br/><a href="#Unshadersimple">Un shader simple</a><br/><a href="#Lestexturesvialesshaders">Les textures via les shaders</a><br/><a href="#Animerlesmeshes">Animer les meshes</a><br/><a href="#Utiliserlesquaternions">Utiliser les quaternions</a><br/><a href="#Grerlesanimationsd039unmesh">Gérer les animations d&#039;un mesh</a><br/><a href="#Suivezlechemin">Suivez le chemin !</a><br/><a href="#Leslancersderayon">Les lancers de rayon</a><br/><a href="#Qu039estcequ039unrayon">Qu&#039;est ce qu&#039;un rayon ?</a><br/><a href="#L039intersectionavecunterrain">L&#039;intersection avec un terrain</a><br/><a href="#Intersectionavecunmesh">Intersection avec un mesh</a><br/><a href="#L039interfaceavecCEGUI">L&#039;interface avec CEGUI</a><br/><a href="#Installation">Installation</a><br/><a href="#MiseenroutedeCEGUI">Mise en route de CEGUI</a><br/><a href="#Gestiondesentres">Gestion des entrées</a><br/><a href="#Leswidgets">Les widgets</a><br/></div>
<a name="DcouvrezOgre3D"></a><h2>Découvrez Ogre 3D</h2><div class="content" role="article">
<figure id="r-82319" data-claire-element-id="82320"><img id="r-82318" data-claire-element-id="82318" src="medias/uploads.siteduzero.com_files_239001_240000_239808.gif" alt="Image utilisateur"/></figure><p id="r-82321" data-claire-element-id="82321">Ah, les jeux vidéo... Si vous êtes là, j'imagine que vous avez sûrement à un moment ou un autre voulu vous essayer à en programmer un, ne serait-ce que pour savoir <em>comment</em> on fait. Quels outils utilisent les professionnels ? Par où commencer et avec quels logiciels ? J'ai souvent vu ces questions sur le web, et je me les suis moi-même posées.</p><p id="r-82322" data-claire-element-id="82322">Ce tutoriel a pour objectif de vous apporter un élément de réponse en vous initiant au moteur 3D Ogre, outil libre et gratuit très utilisé par les développeurs en herbe désireux de s'essayer à la 3D interactive, mais aussi par des équipes talentueuses voulant finaliser leur projet avec une solution puissante et gratuite.</p><p id="r-82323" data-claire-element-id="82323">Plusieurs projets commerciaux basés sur Ogre ont en effet déjà vu le jour, certains sont très réussis ! On peut citer par exemple <em>Pacific Storm</em>, <em>Ankh : Une aventure égyptienne</em>, <em>The Blob</em>...</p><p id="r-82324" data-claire-element-id="82324">Au programme, je vous propose une présentation des notions de base dans Ogre puis de son fonctionnement interne. À partir de ces connaissances, nous pourrons nous plonger dans des techniques avancées de rendu ainsi que dans quelques bibliothèques externes se couplant très bien avec Ogre.</p><p id="r-82325" data-claire-element-id="82333"><em><a href="medias/uploads.siteduzero.com_files_241001_242000_241763.jpg"><img id="r-82333" data-claire-element-id="82332" src="medias/uploads.siteduzero.com_thb_241001_242000_241763.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_241001_242000_241762.jpg"><img id="r-82332" data-claire-element-id="82331" src="medias/uploads.siteduzero.com_thb_241001_242000_241762.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_241001_242000_241761.jpg"><img id="r-82331" data-claire-element-id="82330" src="medias/uploads.siteduzero.com_thb_241001_242000_241761.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_241001_242000_241429.png"><img id="r-82330" data-claire-element-id="82329" src="medias/uploads.siteduzero.com_thb_241001_242000_241429.png" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_241001_242000_241428.jpg"><img id="r-82329" data-claire-element-id="82328" src="medias/uploads.siteduzero.com_thb_241001_242000_241428.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_239001_240000_239816.jpg"><img id="r-82328" data-claire-element-id="82327" src="medias/uploads.siteduzero.com_thb_239001_240000_239816.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_239001_240000_239815.jpg"><img id="r-82327" data-claire-element-id="82326" src="medias/uploads.siteduzero.com_thb_239001_240000_239815.jpg" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_239001_240000_239814.jpg"><img id="r-82326" data-claire-element-id="82325" src="medias/uploads.siteduzero.com_thb_239001_240000_239814.jpg" alt="Image utilisateur"/></a>Quelques images de jeux créés avec Ogre.</em></p><p id="r-82334" data-claire-element-id="82334">Vous en voulez plus ? Allez faire un tour dans la <a href="http://www.ogre3d.org/gallery/">galerie</a> !</p><aside id="r-82336" data-claire-element-id="82336" data-claire-semantic="warning"><p id="r-82335" data-claire-element-id="82335">La connaissance du C++ est indispensable pour pouvoir s'essayer à Ogre. Si vous ne connaissez pas ce langage, je vous invite à allez voir le <a href="http://www.siteduzero.com/tutoriel-3-11406-apprenez-a-programmer-en-c.html">tutoriel</a> disponible sur ce site et à pratiquer le langage avant de vous lancer.</p></aside>
</div>
<div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script>
</div><a name="IntroductionOgre3D"></a><h2>Introduction à Ogre 3D</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
<span class="next">Un moteur 3D ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-82338" data-claire-element-id="82338">Avant de commencer à plonger nos mains dans le code, je vous propose une petite introduction à Ogre, pour que vous fassiez un peu plus connaissance. :D</p>
</div><a name="Unmoteur3D"></a><h2>Un moteur 3D ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">
<span class="arrow"></span>
<span class="next">Introduction à Ogre 3D</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
<span class="next">Pourquoi Ogre et pas un autre ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-qu-est-ce-qu-un-moteur-3d" data-claire-element-id="82360">Qu'est-ce qu'un moteur 3D ?</h2><h3 id="r-utilisation-2" data-claire-element-id="82355">Utilisation</h3><p id="r-82339" data-claire-element-id="82339">Tout d'abord, il est important de cadrer précisément ce cours par rapport au sujet qu'il aborde. En effet, Ogre est un moteur 3D, je pense que vous l'avez compris. :D Mais qu'est-ce qu'un moteur 3D ? À quoi ça sert ?</p><p id="r-82340" data-claire-element-id="82340">Un moteur 3D est une API (i.e. il fournit un ensemble de fonctions) qui permet à son utilisateur, en l'occurrence vous, de représenter des objets dans un monde en trois dimensions. (On s'en serait douté en même temps. ^^ ) Le moteur 3D est un intermédiaire entre vous et les librairies graphiques de plus bas niveau comme DirectX ou OpenGL, qui permet donc de se passer des aspects les plus complexes de la gestion d'objets 3D. Le moteur gère lui-même les objets dans la scène et vous donne accès à des fonctions pour les manipuler et les afficher de façon optimale.</p><p id="r-82341" data-claire-element-id="82341">Généralement, un moteur 3D coûte très cher à développer, c'est pourquoi on ne crée pas un moteur 3D pour chaque jeu ! Le renouvellement d'un moteur sert généralement à prendre en compte de nouvelles fonctionnalités des librairies graphiques pour offrir plus de possibilités aux développeurs.</p><p id="r-82342" data-claire-element-id="82342">Cependant, il ne faut pas confondre moteur 3D (ou moteur graphique) et moteur de jeu, voire moteur physique par exemple. En effet, un moteur 3D ne contient pas de fonctions pour gérer les collisions entre les objets ni pour les entrées utilisateurs. Ceci sera fait à l'aide de bibliothèques différentes à intégrer au programme, mais ce n'est en aucun cas Ogre qui gérera ça.</p><p id="r-82343" data-claire-element-id="82343">Pour résumer, voici par exemple ce qu'Ogre nous permettra de faire :</p><ul id="r-82352" data-claire-element-id="82352"><li id="r-82345" data-claire-element-id="82345"><p id="r-82344" data-claire-element-id="82344">afficher des personnages, bâtiments, paysages en 3D ;</p></li><li id="r-82347" data-claire-element-id="82347"><p id="r-82346" data-claire-element-id="82346">gérer les lumières et les ombres ;</p></li><li id="r-82349" data-claire-element-id="82349"><p id="r-82348" data-claire-element-id="82348">utiliser une ou plusieurs caméras ;</p></li><li id="r-82351" data-claire-element-id="82351"><p id="r-82350" data-claire-element-id="82350">créer des effets de brouillards, flammes, fumées...</p></li></ul><p id="r-82353" data-claire-element-id="82353">En gros, cela concerne tout ce que l'on voit à l'écran, tout ce qui est en rapport avec le <em>rendu</em>.</p><p id="r-82354" data-claire-element-id="82354">Au-delà de ça, Ogre s'occupe aussi de gérer la fenêtre de l'application en elle-même, c'est-à-dire le cadre avec les boutons pour agrandir ou fermer la fenêtre, en haut à droite. Sachez que même si vous affichez votre application en plein écran, il faut s'occuper de cet aspect avec le système d'exploitation, et Ogre permet de gérer cela.</p><h3 id="r-les-connaissances-requises" data-claire-element-id="82359">Les connaissances requises</h3><p id="r-82356" data-claire-element-id="82356">Un moteur 3D, comme tout programme, peut être codé dans de nombreux langages différents. Les plus populaires sont cependant le C, le C++ et plus récemment le C#, le langage utilisé par le framework XNA de Microsoft. Ogre est programmé en C++, il est donc indispensable d'avoir de bonnes bases dans ce domaine avant de s'attaquer à ce moteur. Vous aurez en effet suffisamment à faire pour apprendre le fonctionnement d'Ogre sans avoir besoin de vous embarrasser d'apprendre le C++ en parallèle.</p><p id="r-82357" data-claire-element-id="82357">De plus, comme un moteur 3D, c'est beaucoup de géométrie dans l'espace, il est quasiment indispensable d'avoir des connaissances mathématiques d'un niveau de première / terminale scientifique pour assimiler plus rapidement les notions. Les mathématiques supérieures constituent un avantage indéniable, même s'il est possible d'assimiler les principes avec un peu de persévérance.</p><p id="r-82358" data-claire-element-id="82358">Ce tutoriel conserve bien sûr l'objectif de partir du plus faible niveau possible (après tout, on est des Zéros dans l'âme :lol: ) mais ces bases vous éviteront de tourner et retourner certains points dans tous les sens. Vous voilà prévenus !</p><h2 id="r-un-peu-d-histoire-2" data-claire-element-id="82364">Un peu d'histoire</h2><p id="r-82361" data-claire-element-id="82361">Le projet Ogre est né en 1999 de l'esprit d'un certain Steve Streeting, programmeur de talent connu sous le pseudonyme de <em>sinbad</em> et qui a eu l'idée de construire un moteur 3D indépendant de la plate-forme et de l'API utilisées (Direct3D ou OpenGL). Le projet est rapidement créé sur SourceForge au début de l'année 2000 et grossira progressivement sous la supervision de sinbad. Celui-ci se retire en avril 2010 pour des raisons de santé mais reste un contributeur actif.</p><p id="r-82362" data-claire-element-id="82362">La version 1.0.0 du moteur sort en février 2005 sous le nom de code AzaThot. Les versions 1.x se succèdent au fil des ans et de façon régulière, toujours avec un nom de code désignant une créature mystique. <br/> En avril 2010 est sortie la version 1.7.1, dénommée Cthugha, qui en profite pour changer de licence et passer en MIT en lieu et place de la LGPL utilisée jusqu'alors. Depuis novembre 2010, la révision 1.7.2 est disponible et c'est donc celle que nous utiliserons ici.</p><p id="r-82363" data-claire-element-id="82363">La communauté anglophone autour d'Ogre est plutôt active et le site officiel regorge de contributions diverses, tandis que la communauté francophone est plus restreinte.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">
<span class="arrow"></span>
<span class="next">Introduction à Ogre 3D</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
<span class="next">Pourquoi Ogre et pas un autre ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="PourquoiOgreetpasunautre"></a><h2>Pourquoi Ogre et pas un autre ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
<span class="arrow"></span>
<span class="next">Un moteur 3D ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
<span class="next">Téléchargement et installation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-82366" data-claire-element-id="82366">Ah, difficile question que celle-ci ! Je vais essayer d'y répondre de la façon la plus complète possible. :D</p><p id="r-82367" data-claire-element-id="82367">Tout d'abord, Ogre est un projet open source, ce qui signifie que vous pouvez avoir accès aux sources du moteur et regarder comment il a été codé (bon, je vous préviens, ce n'est pas évident :p ), mais aussi que vous pouvez vous le procurer gratuitement, ce qui est déjà une condition <em>sine qua non</em> lorsque l'on part de zéro.</p><p id="r-82368" data-claire-element-id="82368">Ensuite, il y a encore beaucoup de moteurs gratuits. Je ne peux pas vraiment parler en détails de ceux-ci, sachant que je n'ai testé qu'Ogre. Cependant je me suis beaucoup documenté afin de faire le meilleur choix possible, ce qui a fait ressortir deux moteurs principaux : Irrlicht et Ogre.</p><p id="r-82369" data-claire-element-id="82369">Voici ce qui ressort le plus souvent des communautés.</p><p id="r-82370" data-claire-element-id="82370">Irrlicht est plus rapide à prendre en main qu'Ogre, notamment au niveau de l'installation, pas forcément bien documentée pour ce dernier en plus d'être souvent tortueuse, mais aussi de l'utilisation, plus simple. En revanche, Ogre est beaucoup plus complet, sachant qu'il y a beaucoup plus de classes disponibles (je ne les ai pas comptées, mais il y en a environ trois fois plus).</p><p id="r-82371" data-claire-element-id="82371">Les deux moteurs ont chacun leur public, dépendant des goûts. En ce qui me concerne, j'ai vu beaucoup plus de projets commerciaux basés sur Ogre que sur Irrlicht.<br/> Ce qui est certain, c'est qu'Ogre n'est pas évident à apprendre, mais il est très bien documenté, et sa communauté est, comme je l'ai dit plus haut, très active. Sa panoplie de logiciels annexes est assez conséquente, on retrouve notamment des extensions pour l'export de fichier à partir de logiciels de modélisation ou bien un logiciel de création de scène plutôt bien fait par exemple, qui fera l'objet d'un chapitre de ce cours.</p><p id="r-82372" data-claire-element-id="82372">Voilà : je pense que si vous êtes motivés, Ogre est largement à votre portée. Le fonctionnement de base du moteur n'est pas si compliqué une fois qu'on l'on se penche vraiment dessus, et il est surtout très puissant. ^^</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
<span class="arrow"></span>
<span class="next">Un moteur 3D ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
<span class="next">Téléchargement et installation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Tlchargementetinstallation"></a><h2>Téléchargement et installation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
<span class="arrow"></span>
<span class="next">Pourquoi Ogre et pas un autre ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">
<span class="next">Votre première application</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-telechargement-3" data-claire-element-id="82383">Téléchargement</h2><p id="r-82374" data-claire-element-id="82374">Comme Ogre est un projet open source, il est disponible directement sur le site de SourceForge. Néanmoins, vous pouvez y accéder en passant par le <a href="http://www.ogre3d.org/download/sdk">site officiel</a>, sur lequel vous trouverez notamment la <a href="http://www.ogre3d.org/docs/api/html/">documentation</a> complète de cette (très) vaste bibliothèque.</p><figure id="r-82376" data-claire-element-id="82377"><img id="r-82375" data-claire-element-id="82375" src="medias/uploads.siteduzero.com_files_239001_240000_239817.gif" alt="Image utilisateur"/></figure><p id="r-82378" data-claire-element-id="82378">À l'heure où j'écris ces lignes, la dernière version stable est la 1.7.2, que vous pouvez télécharger en cliquant sur le lien correspondant à votre plate-forme : Visual Studio si vous êtes sous l'IDE de Microsoft, sinon vous trouverez les versions Mac OS X pour les possesseurs de machine Apple et MinGW si vous utilisez Code::Blocks par exemple.</p><aside id="r-82380" data-claire-element-id="82380" data-claire-semantic="warning"><p id="r-82379" data-claire-element-id="82379">Si vous utilisez Code::Blocks, il vous faudra mettre votre compilateur MinGW à jour avec la version 4.5 (non fournie avec C::B 10.05). Vous pouvez le télécharger sur <a href="http://sourceforge.net/projects/mingw/files/Installer/mingw-get-inst/mingw-get-inst-20101030/mingw-get-inst-20101030.exe/download">SourceForge</a> par exemple. La configuration de Code::Blocks pour votre nouveau compilateur se fait dans le prochain chapitre.</p></aside><p id="r-82381" data-claire-element-id="82381">Concernant Linux, la démarche d'installation au chapitre suivant inclut le téléchargement des paquets nécessaires, vous pouvez donc y passer directement.</p><p id="r-82382" data-claire-element-id="82382">Enfin, pour chaque plate-forme, si vous êtes des habitués de la méthode, il est possible de compiler vous-mêmes les sources après les avoir téléchargées <a href="http://www.ogre3d.org/download/source">ici</a>.</p><h2 id="r-installation-10" data-claire-element-id="82391">Installation</h2><h3 id="r-windows" data-claire-element-id="82386">Windows</h3><p id="r-82384" data-claire-element-id="82384">Une fois que vous avez téléchargé le fichier exécutable, exécutez-le et choisissez un répertoire d'extraction. En ce qui me concerne je le place généralement dans C:/OgreSDK, mais vous êtes libres de choisir un autre répertoire. Notez bien le chemin que vous aurez choisi puisque nous en aurons besoin pour configurer nos projets et copier les bibliothèques nécessaires.</p><p id="r-82385" data-claire-element-id="82385">Il est à noter que contrairement aux précédentes versions, la 1.7.2 n'a pas d'installation à proprement parler, elle ne fait que décompresser le dossier contenant les fichiers nécessaires au fonctionnement d'Ogre. Ne soyez donc pas surpris si la méthode est un peu inhabituelle.</p><h3 id="r-mac-os-x" data-claire-element-id="82390">Mac OS X</h3><p id="r-82387" data-claire-element-id="82387">Double-cliquez sur le fichier .dmg téléchargé, ce qui doit ouvrir une fenêtre avec un dossier OgreSDK. Il vous suffit de le placer à l'endroit où vous voulez installer Ogre, il est recommandé de choisir le dossier /Developer/SDKs/ qui est le plus approprié.</p><p id="r-82388" data-claire-element-id="82388">Vous avez finalement bel et bien décidé de vous attaquer à Ogre ? Téléchargé et décompressé vos fichiers ?</p><p id="r-82389" data-claire-element-id="82389">Parfait ! Passons tout de suite à la configuration de notre premier projet !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
<span class="arrow"></span>
<span class="next">Pourquoi Ogre et pas un autre ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">
<span class="next">Votre première application</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Votrepremireapplication"></a><h2>Votre première application</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
<span class="arrow"></span>
<span class="next">Téléchargement et installation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
<span class="next">Configuration d&#039;un projet</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-82394" data-claire-element-id="82394">Vous y voilà. Vous avez téléchargé et installé Ogre, lancé votre IDE favori, vous êtes prêts à afficher votre premier million de polygones. Bon, pas trop vite tout de même. Il va d'abord falloir configurer votre IDE pour qu'il trouve les librairies d'Ogre et vous permette de compiler tranquillement.</p><p id="r-82395" data-claire-element-id="82395">Si vous avez déjà essayeé d'utiliser Ogre, vous avez probablement eu des problèmes pour lancer une application sans avoir des myriades d'erreurs. La configuration manque en effet de documentation, c'est pour ça que je vais vous guider pas à pas.</p><aside id="r-82397" data-claire-element-id="82397" data-claire-semantic="warning"><p id="r-82396" data-claire-element-id="82396">J'utilise ici la version 1.7.2, qui diffère en plusieurs points des précédentes, notamment car certains nouveaux fichiers sont à inclure. La démarche fonctionne sous Windows pour les IDE évoqués, ainsi que sous Linux. Je n'ai en revanche pas eu l'occasion d'installer Ogre sur un Mac. Si vous rencontrez des problèmes, je tenterai de compléter au plus vite ce chapitre.</p></aside><p id="r-82398" data-claire-element-id="82398">À l'abordage ! :pirate:</p>
</div><a name="Configurationd039unprojet"></a><h2>Configuration d&#039;un projet</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">
<span class="arrow"></span>
<span class="next">Votre première application</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
<span class="next">Le code de base</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-configuration-de-l-ide" data-claire-element-id="82500">Configuration de l'IDE</h2><h3 id="r-visual-studio-2010" data-claire-element-id="82433">Visual Studio 2010</h3><p id="r-82399" data-claire-element-id="82399">Ouvrez Visual Studio et allez dans Fichier ? Nouveau ? Projet... et choisissez un projet vide auquel vous donnez un nom.</p><p id="r-82400" data-claire-element-id="82400">Une fois ce projet créé, faites un clic droit sur le nom du projet puis choisissez les propriétés.</p><figure id="r-82402" data-claire-element-id="82403"><img id="r-82401" data-claire-element-id="82401" src="medias/uploads.siteduzero.com_files_295001_296000_295559.jpg" alt="Image utilisateur"/></figure><p id="r-82404" data-claire-element-id="82404">Dans la fenêtre qui s'ouvre, commencez par modifier la configuration en haut à gauche et choisissez &quot;Toutes les configurations&quot;. Allez ensuite dans Propriétés de configuration ? Répertoires de VC++. Dans la fenêtre de droite, cliquez sur la liste correspondant aux fichiers <em>include</em>, choisissez <em>Modifier</em>, puis ajoutez ces trois chemins en cliquant sur l'icône de création.</p><ul id="r-82411" data-claire-element-id="82411"><li id="r-82406" data-claire-element-id="82406"><p id="r-82405" data-claire-element-id="82405">[Chemin vers Ogre]\boost_1_42</p></li><li id="r-82408" data-claire-element-id="82408"><p id="r-82407" data-claire-element-id="82407">[Chemin vers Ogre]\include</p></li><li id="r-82410" data-claire-element-id="82410"><p id="r-82409" data-claire-element-id="82409">[Chemin vers Ogre]\include\OGRE</p></li></ul><figure id="r-82413" data-claire-element-id="82414"><img id="r-82412" data-claire-element-id="82412" src="medias/uploads.siteduzero.com_files_295001_296000_295558.jpg" alt="Image utilisateur"/></figure><p id="r-82415" data-claire-element-id="82415">Faites de même pour les répertoires de bibliothèques bibliothèques, et ajoutez ces deux chemins :</p><ul id="r-82420" data-claire-element-id="82420"><li id="r-82417" data-claire-element-id="82417"><p id="r-82416" data-claire-element-id="82416">[Chemin vers Ogre]\boost_1_42\lib</p></li><li id="r-82419" data-claire-element-id="82419"><p id="r-82418" data-claire-element-id="82418">[Chemin vers Ogre]\lib\$(Configuration)</p></li></ul><figure id="r-82422" data-claire-element-id="82423"><img id="r-82421" data-claire-element-id="82421" src="medias/uploads.siteduzero.com_files_295001_296000_295566.jpg" alt="Image utilisateur"/></figure><p id="r-82424" data-claire-element-id="82424">Sélectionnez maintenant &quot;Débogage&quot; et complétez le répertoire de travail : $(SolutionDir)$(Configuration).</p><figure id="r-82426" data-claire-element-id="82427"><img id="r-82425" data-claire-element-id="82425" src="medias/uploads.siteduzero.com_files_295001_296000_295564.jpg" alt="Image utilisateur"/></figure><p id="r-82428" data-claire-element-id="82428">Enfin passez maintenant à la configuration &quot;Release&quot;, allez dans Éditeur de liens, Entrée et ajoutez deux dépendances supplémentaires : OgreMain.lib et OIS.lib. Faites de même pour la configuration Debug avec les dépendances OgreMain_d.lib et OIS_d.lib.</p><figure id="r-82430" data-claire-element-id="82431"><img id="r-82429" data-claire-element-id="82429" src="medias/uploads.siteduzero.com_files_295001_296000_295567.jpg" alt="Image utilisateur"/></figure><p id="r-82432" data-claire-element-id="82432">Voilà, votre projet est prêt à être compilé !</p><h3 id="r-code-blocks-1" data-claire-element-id="82477">Code::Blocks</h3><p id="r-82434" data-claire-element-id="82434">Ouvrez Code::Blocks et créez un nouveau projet vide, choisissez GNU GCC en tant que compilateur. Faites un clic droit sur le projet nouvellement créé, et allez dans &quot;Build Options...&quot;.</p><p id="r-82435" data-claire-element-id="82435">À gauche, ne choisissez ni &quot;Debug&quot; ni &quot;Release&quot;, mais le nom de votre projet pour modifier les deux configurations en même temps.</p><p id="r-82436" data-claire-element-id="82436">Allez dans &quot;Search directories&quot; et dans l'onglet &quot;Compiler&quot; ajoutez les chemins suivants :</p><ul id="r-82443" data-claire-element-id="82443"><li id="r-82438" data-claire-element-id="82438"><p id="r-82437" data-claire-element-id="82437">[Chemin vers Ogre]\boost_1_44</p></li><li id="r-82440" data-claire-element-id="82440"><p id="r-82439" data-claire-element-id="82439">[Chemin vers Ogre]\include</p></li><li id="r-82442" data-claire-element-id="82442"><p id="r-82441" data-claire-element-id="82441">[Chemin vers Ogre]\include\OGRE</p></li></ul><figure id="r-82445" data-claire-element-id="82446"><img id="r-82444" data-claire-element-id="82444" src="medias/uploads.siteduzero.com_files_239001_240000_239858.jpg" alt="Image utilisateur"/></figure><p id="r-82447" data-claire-element-id="82447">Puis dans &quot;Linker&quot;, ajoutez ceux-ci :</p><ul id="r-82452" data-claire-element-id="82452"><li id="r-82449" data-claire-element-id="82449"><p id="r-82448" data-claire-element-id="82448">[Chemin vers Ogre]\boost_1_44\lib</p></li><li id="r-82451" data-claire-element-id="82451"><p id="r-82450" data-claire-element-id="82450">[Chemin vers Ogre]\lib\$(TARGET_NAME)</p></li></ul><p id="r-82453" data-claire-element-id="82453">Ensuite, allez dans &quot;Linker Settings&quot;, et dans la case &quot;Other Linker Options&quot;, écrivez : -Wl,--enable-auto-import .</p><p id="r-82454" data-claire-element-id="82454">Toujours dans &quot;Linker Settings&quot;, choisissez cette fois la configuration debug et dans &quot;Link Libraries&quot; ajoutez les deux fichiers :</p><ul id="r-82459" data-claire-element-id="82459"><li id="r-82456" data-claire-element-id="82456"><p id="r-82455" data-claire-element-id="82455">OgreMain_d</p></li><li id="r-82458" data-claire-element-id="82458"><p id="r-82457" data-claire-element-id="82457">OIS_d</p></li></ul><p id="r-82460" data-claire-element-id="82460">Et pour le release :</p><ul id="r-82465" data-claire-element-id="82465"><li id="r-82462" data-claire-element-id="82462"><p id="r-82461" data-claire-element-id="82461">OgreMain</p></li><li id="r-82464" data-claire-element-id="82464"><p id="r-82463" data-claire-element-id="82463">OIS</p></li></ul><figure id="r-82467" data-claire-element-id="82468"><img id="r-82466" data-claire-element-id="82466" src="medias/uploads.siteduzero.com_files_239001_240000_239859.jpg" alt="Image utilisateur"/></figure><p id="r-82469" data-claire-element-id="82469">Fermez la fenêtre puis ouvrez les propriétés du projet (clic droit, Properties...), ouvrez l'onglet &quot;Build Targets&quot; et dans le champ &quot;Execution working dir&quot; entrez &quot;bin\Debug&quot; pour la configuration Debug (à choisir dans le menu de gauche) et &quot;bin\Release&quot; pour la configuration Release.</p><figure id="r-82471" data-claire-element-id="82472"><img id="r-82470" data-claire-element-id="82470" src="medias/uploads.siteduzero.com_files_250001_251000_250334.jpg" alt="Image utilisateur"/></figure><p id="r-82473" data-claire-element-id="82473">Pour terminer, aller dans Settings ? Compiler and Debugger... puis dans les paramètres de GNU choisissez le répertoire où vous avez installé MinGW 4.5.</p><figure id="r-82475" data-claire-element-id="82476"><img id="r-82474" data-claire-element-id="82474" src="medias/uploads.siteduzero.com_files_295001_296000_295572.jpg" alt="Image utilisateur"/></figure><h3 id="r-sous-linux-5" data-claire-element-id="82494">Sous Linux</h3><p id="r-82478" data-claire-element-id="82478">Beaucoup d'utilisateurs sous Linux préfèrent compiler les codes sources à la main, mais ce n'est pas le cas de tout le monde. Voici donc une méthode pour installer directement Ogre et compiler vos projets avec cmake.</p><p id="r-82479" data-claire-element-id="82479">Cette méthode est en grande partie inspirée de <a href="http://geenux.wordpress.com/tag/c/">cette page</a>, avec quelques ajouts.</p><p id="r-82480" data-claire-element-id="82480">Ajoutez au fichier /etc/apt/sources.list les lignes :</p><pre id="r-82481" data-claire-element-id="82481"><code data-claire-semantic="cpp">deb http://ppa.launchpad.net/ogre-team/ogre/ubuntu karmic main
deb-src http://ppa.launchpad.net/ogre-team/ogre/ubuntu karmic main</code></pre><p id="r-82482" data-claire-element-id="82482">Une fois que c'est fait, mettez votre liste de paquets à jour et installez les paquets suivants :</p><pre id="r-82483" data-claire-element-id="82483"><code data-claire-semantic="console">sudo aptitude update
sudo aptitude install libogre-dev ogre-samples-bin ogre-samples-source libois-dev cmake</code></pre><p id="r-82484" data-claire-element-id="82484">Maintenant, créez un répertoire pour votre projet. Ajoutez-y un fichier CMakeLists.txt avec pour contenu :</p><p id="r-82485" data-claire-element-id="82485"></p><div id="r-82487" data-claire-element-id="82487"><pre id="r-82486" data-claire-element-id="82486"><code data-claire-semantic="console">project(VotreProjet)
cmake_minimum_required(VERSION 2.6)
set(CMAKE_MODULE_PATH &quot;/usr/lib/OGRE/cmake/&quot;)
#set(CMAKE_CXX_FLAGS &quot;-Wall -W -Werror -ansi -pedantic -g&quot;)

# Il s'agit du tutoriel d'exemple, qui utilise quelques fichiers prédéfinis de Ogre. Il faut indiquer à cmake où se trouvent les includes en question
include_directories (&quot;/usr/share/OGRE/Samples/Common/include/&quot;)

# Bien sûr, pour compiler Ogre, il faut le chercher, et définir le répertoire contenant les includes.
find_package(OGRE REQUIRED)
include_directories (${OGRE_INCLUDE_DIRS})

# L'exemple dépend aussi de OIS, une lib pour gérer la souris, clavier, joystick...
find_package(OIS REQUIRED)

# On définit les sources qu'on veut compiler
SET(SOURCES
main.cpp)

# On les compile
add_executable (
   VotreProjet ${SOURCES}
)

target_link_libraries(VotreProjet ${OGRE_LIBRARY} ${OIS_LIBRARY})</code></pre></div><p id="r-82488" data-claire-element-id="82488">Remplacer &quot;VotreProjet&quot; par le nom à donner à votre projet. Vous aurez de plus à modifier la liste des sources lorsque vous ajouterez des fichiers.</p><p id="r-82489" data-claire-element-id="82489">Ensuite (une fois que vous aurez votre code), vous pourrez lancer les commandes suivantes depuis le répertoire du projet :</p><pre id="r-82490" data-claire-element-id="82490"><code data-claire-semantic="console">cmake .
make
./VotreProjet</code></pre><p id="r-82491" data-claire-element-id="82491">Enfin, vous aurez besoin de ces deux fichiers dans le répertoire de votre projet :</p><pre id="r-82492" data-claire-element-id="82492"><code data-claire-semantic="console">cp /usr/share/OGRE/resources.cfg .
cp /usr/share/OGRE/plugins.cfg .</code></pre><p id="r-82493" data-claire-element-id="82493">Pour terminer, je vous conseille de mettre vos drivers graphiques à jour si ce n'est pas fait, c'est une source d'erreur à l'exécution.</p><h3 id="r-sous-mac-osx" data-claire-element-id="82499">Sous Mac OSX</h3><p id="r-82495" data-claire-element-id="82495">Comme je le disais en introduction, je n'ai pas pu mettre la main sur un Mac pour tester l'installation. Cependant, je suppose que le dossier OgreSDK contient les librairies et includes nécessaires et que la configuration de l'IDE ressemble à celle de Windows. Il est à noter que Xcode est l'IDE qui revient le plus souvent pour utiliser Ogre ; un projet (au chemin OgreSDK/Samples/Samples.xcodeproj) étant normalement présent dans l'installation, il peut vous aider à configurer votre IDE.</p><p id="r-82496" data-claire-element-id="82496">N'hésitez pas à m'envoyer un MP si vous avez des précisions. :)</p><aside id="r-82498" data-claire-element-id="82498" data-claire-semantic="information"><p id="r-82497" data-claire-element-id="82497">La partie suivante concerne uniquement les utilisateurs de Windows.</p></aside><h2 id="r-les-fichiers-a-recuperer" data-claire-element-id="82527">Les fichiers à récupérer</h2><p id="r-82501" data-claire-element-id="82501">Une fois que votre projet sera compilé, il aura aussi besoin d'avoir des bibliothèques indispensables à son fonctionnement dans le dossier de compilation et des fichiers de configuration adaptés à votre installation.</p><p id="r-82502" data-claire-element-id="82502">Allez donc dans le dossier d'installation d'Ogre, puis dans bin, puis release (ou debug si vous voulez compiler en Debug). Ici, copiez tous les fichiers dans le répertoire de l'exécutable de votre programme (avec Visual Studio : [Nom Du Projet]/release/ , avec Code::Blocks : [Nom Du Projet]/bin/release/).</p><p id="r-82503" data-claire-element-id="82503">Notez que tous ne sont pas obligatoires (pas au début du moins) et que vous pouvez vous contenter de ceux-ci :</p><ul id="r-82520" data-claire-element-id="82520"><li id="r-82505" data-claire-element-id="82505"><p id="r-82504" data-claire-element-id="82504">plugins.cfg ;</p></li><li id="r-82507" data-claire-element-id="82507"><p id="r-82506" data-claire-element-id="82506">resources.cfg ;</p></li><li id="r-82509" data-claire-element-id="82509"><p id="r-82508" data-claire-element-id="82508">OgreMain.dll ;</p></li><li id="r-82511" data-claire-element-id="82511"><p id="r-82510" data-claire-element-id="82510">cg.dll ;</p></li><li id="r-82513" data-claire-element-id="82513"><p id="r-82512" data-claire-element-id="82512">OIS.dll ;</p></li><li id="r-82515" data-claire-element-id="82515"><p id="r-82514" data-claire-element-id="82514">Les fichiers Plugins_***.dll ;</p></li><li id="r-82517" data-claire-element-id="82517"><p id="r-82516" data-claire-element-id="82516">RenderSystem_Direct3D9.dll ;</p></li><li id="r-82519" data-claire-element-id="82519"><p id="r-82518" data-claire-element-id="82518">RenderSystem_GL.dll.</p></li></ul><p id="r-82521" data-claire-element-id="82521">Je vous conseille néanmoins de tout copier, ce sera fait. ^^</p><aside id="r-82523" data-claire-element-id="82523" data-claire-semantic="information"><p id="r-82522" data-claire-element-id="82522">Les fichiers pour la configuration Debug sont identiques mais possèdent le suffixe <em>_d</em> dans leur nom.</p></aside><p id="r-82524" data-claire-element-id="82524">Il faut maintenant éditer le fichier de configuration &quot;resources.cfg&quot; fraîchement copié. En l'ouvrant vous constatez qu'ils contient des chemins relatifs vers des sous-dossiers du dossier &quot;media&quot;, situé dans le répertoire d'Ogre. Il va donc falloir adapter les chemins indiqués pour qu'ils pointent sur le dossier où vous avez choisi d'extraire Ogre (les chemins absolus sont possibles).</p><p id="r-82525" data-claire-element-id="82525">Par exemple, voici comment j'ai édité la première ligne chez moi :</p><pre id="r-82526" data-claire-element-id="82526"><code>Zip=C:/OgreSDK/media/packs/SdkTrays.zip</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">
<span class="arrow"></span>
<span class="next">Votre première application</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
<span class="next">Le code de base</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lecodedebase"></a><h2>Le code de base</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
<span class="arrow"></span>
<span class="next">Configuration d&#039;un projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">
<span class="next">Insérer des objets dans la scène</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-82529" data-claire-element-id="82529">Bon, notre IDE est configuré, les fichiers nécessaires ont été copiés dans les bons répertoires, il est temps de tester notre premier code !</p><h2 id="r-la-fonction-main" data-claire-element-id="82538">La fonction main</h2><p id="r-82530" data-claire-element-id="82530">Nous allons commencer par regarder la fonction main de base, qui permettra par la suite de lancer notre application.</p><p id="r-82531" data-claire-element-id="82531">Voici le code de cette fonction.</p><pre id="r-82532" data-claire-element-id="82532"><code data-claire-semantic="cpp">#include &lt;Ogre.h&gt;

#if OGRE_PLATFORM == PLATFORM_WIN32 || OGRE_PLATFORM == OGRE_PLATFORM_WIN32
#define WIN32_LEAN_AND_MEAN
#include &quot;windows.h&quot;

INT WINAPI WinMain(HINSTANCE hInst, HINSTANCE, LPSTR strCmdLine, INT)
#else
int main(int argc, char **argv)
#endif
{
    try {
	} catch(Ogre::Exception&amp; e) {
#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
        MessageBoxA(NULL, e.getFullDescription().c_str(), &quot;An exception has occurred!&quot;, MB_OK | MB_ICONERROR | MB_TASKMODAL);
#else
        fprintf(stderr, &quot;An exception has occurred: %s\n&quot;,
            e.getFullDescription().c_str());
#endif
    }

    return 0;
}</code></pre><p id="r-82533" data-claire-element-id="82533">Comme vous pouvez le voir, il y a pas mal de lignes pour pas grand-chose au final. En effet, si vous exécutez cela, il ne se passe rien, ce qui est normal si vous avez jeté un œil au code : je n'ai rien mis dans mon bloc try{} ! C'est simplement le code minimal à avoir pour compiler.<br/> Vous voyez plusieurs instructions au préprocesseur qui ont pour but de permettre une plus grande compatibilité en fonction de la plate-forme sur laquelle vous vous trouvez.</p><p id="r-82534" data-claire-element-id="82534">Le bloc try{}catch{} nous permettra d'avoir des informations sur les exceptions levées par Ogre lors de l'exécution ; par exemple si un fichier demandé lors du fonctionnement n'est pas trouvé, vous aurez une boîte de dialogue vous indiquant la nature de l'erreur.</p><p id="r-82535" data-claire-element-id="82535">J'ai aussi inclus le fichier Ogre.h afin de pouvoir compiler, la classe Exception étant une classe d'Ogre.</p><p id="r-82536" data-claire-element-id="82536">J'en profite pour signaler que l'ensemble des classes et des types de données définis par Ogre se situe dans le <em>namespace</em> Ogre. Personnellement, j'utilise la ligne <code data-claire-semantic="cpp">using namespace Ogre;</code> dans mes projets si je n'ai pas de risque de conflits avec une autre librairie.</p><p id="r-82537" data-claire-element-id="82537">On va tout de suite créer notre première classe pour pouvoir ouvrir une fenêtre à l'écran.</p><h2 id="r-notre-premiere-classe" data-claire-element-id="82553">Notre première classe</h2><h3 id="r-la-classe-exampleapplication" data-claire-element-id="82543">La classe ExampleApplication</h3><p id="r-82539" data-claire-element-id="82539">Il faut savoir que j'ai beaucoup hésité en préparant ce début de cours, quant à la présentation que j'allais faire d'Ogre au début et des premiers codes que j'allais vous montrer.</p><p id="r-82540" data-claire-element-id="82540">Ogre nous fournit dans ses <em>include</em> une classe fort pratique pour les débutants qui veulent s'essayer à Ogre, et qui n'ont pas forcément la motivation de s'attarder sur les aspects techniques, notamment le démarrage du moteur, lorsqu'ils découvrent Ogre. Cette classe s'appelle ExampleApplication.h et contient un code de base pour lancer votre application dans de bonnes conditions.</p><p id="r-82541" data-claire-element-id="82541">Attention, cependant : cette classe peut être à utiliser au début pour découvrir rapidement les fonctionnalités d'Ogre, mais elle devra rapidement être oubliée au profit d'une architecture « maison » où vous créerez uniquement ce dont vous avez besoin. En effet, la classe ExampleApplication n'est pas optimisée pour la performance ni pour l'évolutivité ; c'est un exemple, comme son nom l'indique si bien. :lol:</p><p id="r-82542" data-claire-element-id="82542">Toujours est-il qu'après réflexion, j'ai décidé d'utiliser cette classe dans la première partie pour que vous puissiez manipuler rapidement vos premières scènes. Dès la seconde partie, je vous montrerai comment nous en affranchir en créant notre propre classe pour lancer Ogre.</p><h3 id="r-implementation-1" data-claire-element-id="82552">Implémentation</h3><p id="r-82544" data-claire-element-id="82544">Il est très simple de lancer un programme en utilisant la classe d'exemple. Celle-ci contient en effet de quoi créer les objets indispensables à Ogre, elle prévoit une gestion basique de la souris pour la caméra et vous propose même une fenêtre de démarrage pour choisir les paramètres de votre application, comme la taille de la fenêtre ou l'API de rendu.</p><p id="r-82545" data-claire-element-id="82545">Cependant, c'est une classe abstraite ; par conséquent, pour l'utiliser, il va falloir réimplémenter la méthode createScene() dans notre code, qui est la seule méthode virtuelle pure de la classe.</p><aside id="r-82547" data-claire-element-id="82547" data-claire-semantic="information"><p id="r-82546" data-claire-element-id="82546">La classe ExampleApplication utilise la directive using namespace, vous n'êtes donc pas forcés de la réécrire dans votre nouvelle classe.</p></aside><p id="r-82548" data-claire-element-id="82548">Créez donc un fichier PremiereApplication.h avec le code suivant :</p><pre id="r-82549" data-claire-element-id="82549"><code data-claire-semantic="cpp">#include &quot;ExampleApplication.h&quot;

class PremiereApplication : public ExampleApplication
{
public:
    void createScene()
    {
    }
};</code></pre><p id="r-82550" data-claire-element-id="82550">Faites un <em>include</em> de ce fichier dans main.cpp, et instanciez votre classe dans la fonction main, juste avant le bloc try{}catch{}. Enfin dans le bloc try, il suffit de lancer l'application avec la méthode go() définie dans la classe ExampleApplication.</p><pre id="r-82551" data-claire-element-id="82551"><code data-claire-semantic="cpp">//...
PremiereApplication app;

try {
    app.go();
} catch(Ogre::Exception&amp; e)
//...</code></pre><h2 id="r-execution" data-claire-element-id="82562">Exécution !</h2><p id="r-82554" data-claire-element-id="82554">Vous pouvez maintenant compiler votre code et l'exécuter.</p><p id="r-82555" data-claire-element-id="82555">Si tout se passe bien, une première fenêtre de configuration doit apparaitre à l'écran. Si la zone d'édition est vide, déroulez le menu et choisissez Direct3D ou OpenGL. <br/> Vous pouvez alors modifier entre autres la résolution, le mode plein écran ou la synchronisation verticale dans les options en dessous. Vérifiez que la carte graphique sélectionnée (&quot;Rendering Device&quot;) correspond bien à celle que vous avez, puis validez votre fenêtre.</p><figure id="r-82557" data-claire-element-id="82558"><img id="r-82556" data-claire-element-id="82556" src="medias/uploads.siteduzero.com_files_239001_240000_239036.jpg" alt="Image utilisateur"/></figure><p id="r-82559" data-claire-element-id="82559">Une nouvelle fenêtre noire s'affiche alors, que vous pouvez quitter en appuyant sur Echap.</p><p id="r-82560" data-claire-element-id="82560">Notez qu'un fichier ogre.cfg a été créé dans le dossier de l'exécutable. Il contient les informations entrées dans la fenêtre de configuration, vous n'aurez donc a priori pas à renseigner à nouveau ces valeurs lors d'une future exécution du projet.</p><p id="r-82561" data-claire-element-id="82561">Et voilà ! L'étape qui rebute le plus souvent les novices d'Ogre n'était finalement pas si difficile que ça, si on sait où aller. Vous pouvez maintenant passer à la suite sereinement pour afficher un modèle dans la scène.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
<span class="arrow"></span>
<span class="next">Configuration d&#039;un projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">
<span class="next">Insérer des objets dans la scène</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Insrerdesobjetsdanslascne"></a><h2>Insérer des objets dans la scène</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
<span class="arrow"></span>
<span class="next">Le code de base</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
<span class="next">Les entités</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-82565" data-claire-element-id="82565">Vous avez donc devant vous votre première fenêtre. Noire.</p><p id="r-82566" data-claire-element-id="82566">En fait elle n'est pas noire, c'est simplement que votre scène est complètement vide !</p><div id="r-82568" data-claire-element-id="82568" data-claire-semantic="question"><p id="r-82567" data-claire-element-id="82567">Où elle est la scène ? Je vois pas de rideau ni de planches, moi... :euh:</p></div><p id="r-82569" data-claire-element-id="82569">:lol: C'est normal : la scène, c'est la désignation de l'espace que vous visualisez dans votre fenêtre, c'est ce qui contient tout les objets que vous allez utiliser. La scène, c'est le monde que vous créez.</p><p id="r-82570" data-claire-element-id="82570">Donc, c'est bien gentil, mais vous la trouvez un peu terne, notre scène ? Qu'à cela ne tienne, nous allons égayer un peu tout ça !</p>
</div><a name="Lesentits"></a><h2>Les entités</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">
<span class="arrow"></span>
<span class="next">Insérer des objets dans la scène</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
<span class="next">Les noeuds de scène</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-une-entite-c-est-quoi" data-claire-element-id="82578">Une entité, c'est quoi ?</h2><p id="r-82571" data-claire-element-id="82571">Une entité, c'est la représentation dans la scène d'un modèle 3D, aussi appelé mesh (<em>mesh</em> signifie maillage en anglais).</p><p id="r-82572" data-claire-element-id="82572">Le mesh est l'ensemble des polygones élémentaires (des quadrilatères et des triangles, le plus souvent) que l'on crée dans un logiciel de modélisation, comme Blender ou Maya, et qui constituent votre modèle 3D complet. Tout ces polygones sont reliés entre eux par leurs sommets, aussi appelés <strong>vertices</strong> en anglais (un vertex, des vertices). Plus il y a de vertices, et donc de polygones, plus le mesh est précis. Généralement, le mesh possède aussi une ou plusieurs textures (une image plaquée sur les polygones) qui lui donnent un aspect plus réaliste qu'une couleur unie lors du rendu. Enfin, pour certains modèles comme les personnages, le mesh possède un squelette qui permet de créer des animations pour son mouvement.</p><figure id="r-82574" data-claire-element-id="82575"><img id="r-82573" data-claire-element-id="82573" src="medias/uploads.siteduzero.com_files_241001_242000_241564.png" alt="Image utilisateur"/></figure><p id="r-82576" data-claire-element-id="82576">Un mesh représentant une sphère. Les vertices sont les points bleus.</p><p id="r-82577" data-claire-element-id="82577">Afin de gérer ces différentes caractéristiques des modèles, Ogre enregistre toutes ces informations dans une entité. Tous les objets solides qui apparaissent à l'écran sont donc des entités et sont représentés par une seule et même classe dans Ogre : la classe Entity. Avant de nous pencher dessus, nous allons ouvrir une petite parenthèse pour me permettre d'introduire une classe centrale dans la gestion de la scène, le SceneManager.</p><h2 id="r-le-scenemanager-en-deux-mots" data-claire-element-id="82583">Le SceneManager en deux mots</h2><p id="r-82579" data-claire-element-id="82579">Afin de pouvoir gérer l'ensemble des objets de notre scène tout au long du déroulement du programme, Ogre introduit la classe SceneManager.</p><p id="r-82580" data-claire-element-id="82580">Concrètement, le SceneManager s'occupe de garder une trace de tous les modèles, lumières, caméra et autres objets que peut contenir la scène. C'est à lui que revient la tâche de créer tous ces objets et de nous permettre ensuite d'y accéder. Par conséquent, l'insertion d'objets dans la scène passe toujours par lui (ou par l'un des éléments déjà insérés) et par les méthodes qu'il propose pour cela.<br/> Il en existe diverses variantes en fonction de la scène que l'on veut réaliser ; selon que celle-ci sera en intérieur ou en extérieur, par exemple, on pourra utiliser un SceneManager différent.</p><p id="r-82581" data-claire-element-id="82581">Toutes les applications Ogre doivent donc avoir un SceneManager pour pouvoir fonctionner, puisque c'est lui qui s'occupe de tout ! La classe ExampleApplication ne fait pas exception et possède donc un attribut mSceneMgr, qui est un pointeur sur le SceneManager de l'application et qui nous permettra dans les parties suivantes d'agrémenter notre scène avec des objets.</p><p id="r-82582" data-claire-element-id="82582">Nous ne nous préoccuperons pas pour l'instant de sa création, nous verrons cela en ouvrant la boîte noire du démarrage de la machine Ogre, mais il est important de le connaître pour comprendre comment seront créés nos objets.</p><h2 id="r-creer-une-entite" data-claire-element-id="82591">Créer une entité</h2><p id="r-82584" data-claire-element-id="82584">L'entité, comme je l'ai dit, doit être créée par le SceneManager pour pouvoir être ajoutée à la scène. La méthode createEntity() permet justement de faire tout cela.</p><pre id="r-82585" data-claire-element-id="82585"><code data-claire-semantic="cpp">Entity *head= mSceneMgr-&gt;createEntity(&quot;Tete&quot;, &quot;ogrehead.mesh&quot;);</code></pre><p id="r-82586" data-claire-element-id="82586">Le premier paramètre est le nom que vous souhaitez donner au mesh, et qui permettra éventuellement par la suite de récupérer un pointeur sur votre entité si vous connaissez son nom. Pour cela on utilisera donc... Le SceneManager, oui !</p><aside id="r-82588" data-claire-element-id="82588" data-claire-semantic="warning"><p id="r-82587" data-claire-element-id="82587">Le nom que vous donnez à votre entité doit être unique !</p></aside><p id="r-82589" data-claire-element-id="82589">Le second paramètre est le nom du fichier que vous voulez charger. Notez l'extension .mesh, qui est le format de fichiers pour les modèles reconnu par Ogre. Le fichier que j'ai choisi se trouve, accompagné d'autres modèles d'exemples, dans le dossier OgreSDK/media/models, qui doit être correctement renseigné dans le fichier resources.cfg pour qu'Ogre puisse le trouver lors de l'exécution. Dans le cas contraire, une exception sera levée au démarrage, d'où un plantage si elle n'est pas traitée.</p><p id="r-82590" data-claire-element-id="82590">Voilà tout ce qu'il fallait faire pour ajouter un mesh dans la scène ! Attention cependant, il nous manque encore une chose avant de pouvoir l'afficher à l'écran...</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">
<span class="arrow"></span>
<span class="next">Insérer des objets dans la scène</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
<span class="next">Les noeuds de scène</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesnoeudsdescne"></a><h2>Les noeuds de scène</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
<span class="arrow"></span>
<span class="next">Les entités</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
<span class="next">Créer un mesh</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-l-utilite-des-noeuds" data-claire-element-id="82603">L'utilité des noeuds</h2><p id="r-82593" data-claire-element-id="82593">Dans Ogre, lorsque l'on souhaite manipuler une entité (un personnage, une lumière, une caméra...), on n'agit en fait jamais directement sur celle-ci. Tous les déplacements que l'on veut effectuer se font par l'intermédiaire d'un noeud de scène, ou SceneNode.</p><p id="r-82594" data-claire-element-id="82594">Un SceneNode est un objet invisible auquel on va pouvoir attacher un nombre indéfini d'entités, lesquelles deviennent solidaires de ce noeud et subissent donc les même transformations que lui. C'est donc une sorte de conteneur qui contient les informations de positionnement de chacune des entités de la scène qui lui sont rattachées.</p><div id="r-82596" data-claire-element-id="82596" data-claire-semantic="question"><p id="r-82595" data-claire-element-id="82595">Mais pourquoi on s'embête à créer un noeud alors qu'on pourrait déplacer nos entités directement ? Ogre doit bien savoir faire ça, quand même !</p></div><p id="r-82597" data-claire-element-id="82597">Si le système permettait de procéder de cette façon, en déplaçant nos entités une par une, on en arriverait vite à faire plusieurs fois les mêmes déplacements lors de la mise à jour de notre scène.</p><p id="r-82598" data-claire-element-id="82598">En effet, lorsque vous voyez un objet 3D à l'écran, celui-ci peut être constitué de plusieurs entités. Un personnage pourra par exemple avoir un corps (on l'espère pour lui :lol: ) mais aussi une arme, un chapeau, et puis il pourrait monter sur une moto aussi ! Tous ces objets seront probablement enregistrés dans des fichiers distincts par le graphiste 3D, pour être le plus souple possible.</p><p id="r-82599" data-claire-element-id="82599">Ainsi, lorsque l'on veut déplacer notre personnage vers l'avant, sans les noeuds il faudrait déplacer chaque petit élément un par un, ce qui deviendrait vite infernal.</p><p id="r-82600" data-claire-element-id="82600">Avec les noeuds, il me suffira d'enregistrer une fois chaque entité que je veux attacher à mon noeud, qui s'occupera de faire les déplacements nécessaires pour chaque entité lorsque j'aurai des transformations à effectuer.</p><aside id="r-82602" data-claire-element-id="82602" data-claire-semantic="information"><p id="r-82601" data-claire-element-id="82601">Quoi qu'il en soit, attacher chaque entité à un noeud est primordial, sans quoi elle ne s'affichera pas dans votre scène !</p></aside><h2 id="r-creer-un-noeud" data-claire-element-id="82624">Créer un noeud</h2><p id="r-82604" data-claire-element-id="82604">Comme pour les entités, on ne créera pas de noeud de scène en utilisant le constructeur de la classe. On devra passer par un noeud déjà existant, ce qui va nous permettre d'avoir des relations d'héritage entre nos noeuds. De la même manière que l'on va attacher les entités à nos noeuds, ceux-ci peuvent avoir un noeud parent, lui-même enfant d'un autre noeud, et ainsi de suite jusqu'au noeud appelé « racine » de la scène.</p><p id="r-82605" data-claire-element-id="82605">Pour cela, les noeuds de scène ont une méthode dédiée :</p><pre id="r-82606" data-claire-element-id="82606"><code data-claire-semantic="cpp">SceneNode *noeudEnfant = noeudParent-&gt;createChildSceneNode(&quot;enfant&quot;, Vector3::ZERO, Quaternion::IDENTITY);</code></pre><div id="r-82608" data-claire-element-id="82608" data-claire-semantic="question"><p id="r-82607" data-claire-element-id="82607">Mais comment fait-on pour le premier noeud qu'on va créer ? Il ne peut pas avoir de père si c'est le premier ! Je savais que j'aurais dû étudier le problème de l'oeuf ou de la poule avant de venir... :(</p></div><p id="r-82609" data-claire-element-id="82609">Sachez que le noeud « racine » que j'ai cité tout à l'heure existe dès que le SceneManager est créé, et que c'est un noeud comme un autre, avec les même méthodes.</p><p id="r-82610" data-claire-element-id="82610">Nous allons donc créer un noeud enfant du noeud racine de la scène que nous récupérons à l'aide du SceneManager :</p><pre id="r-82611" data-claire-element-id="82611"><code data-claire-semantic="cpp">SceneNode *node= mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode(&quot;nodeTete&quot;, Vector3::ZERO, Quaternion::IDENTITY);</code></pre><p id="r-82612" data-claire-element-id="82612">Ici la méthode getRootSceneNode() nous permet de récupérer un pointeur sur le noeud racine unique de la scène. On appelle ensuite sa méthode createChildSceneNode pour lui ajouter un nouveau noeud fils.</p><p id="r-82613" data-claire-element-id="82613">Notez qu'aucun des paramètres de la méthode n'est obligatoire, mais que je les ai écrits pour information. Le premier argument est le nom que vous voulez donner à votre noeud et qui pourra être utilisé pour récupérer un pointeur vers celui-ci, sur le même principe que les entités. Les deuxième et troisième arguments sont respectivement la position et le quaternion avec lesquels vous voulez initialiser votre noeud.</p><div id="r-82615" data-claire-element-id="82615" data-claire-semantic="question"><p id="r-82614" data-claire-element-id="82614">Le quart d'oignon ? On fait de la cuisine, maintenant ?</p></div><p id="r-82616" data-claire-element-id="82616">Oui, j'avoue que c'est un nom un peu barbare qui m'a aussi fait un peu peur au début. J'y reviendrai en détail ultérieurement pour vous expliquer de quoi il s'agit. Sachez pour le moment qu'un quaternion est un objet mathématique qui permet de faire faire aux objets des rotations dans l'espace, et que la valeur initiale que je lui ai donnée lui dit de ne pas faire de rotation, justement. ^^</p><p id="r-82617" data-claire-element-id="82617">Avec ce code en main, vous pouvez simplement attacher l'entité précédemment créée au noeud avec la ligne suivante :</p><pre id="r-82618" data-claire-element-id="82618"><code data-claire-semantic="cpp">node-&gt;attachObject(head);</code></pre><p id="r-82619" data-claire-element-id="82619">En compilant, vous devriez voir la tête d'un ogre au milieu de l'écran.</p><figure id="r-82621" data-claire-element-id="82622"><img id="r-82620" data-claire-element-id="82620" src="medias/uploads.siteduzero.com_files_239001_240000_239037.jpg" alt="Image utilisateur"/></figure><p id="r-82623" data-claire-element-id="82623">Vous pouvez déplacer la caméra avec Z, S, Q, D et la souris pour voir ce que ça donne de plus près.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
<span class="arrow"></span>
<span class="next">Les entités</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
<span class="next">Créer un mesh</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Crerunmesh"></a><h2>Créer un mesh</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
<span class="arrow"></span>
<span class="next">Les noeuds de scène</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">
<span class="next">Se repérer dans l&#039;espace</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-82626" data-claire-element-id="82626">Pour terminer, nous pouvons rajouter un sol à notre scène, pour éviter que notre tête d'Ogre se sente trop seule. :euh:</p><p id="r-82627" data-claire-element-id="82627">Nous allons pour cela créer nous-mêmes notre propre mesh, étant donné que nous n'avons besoin que d'un plan pour le sol. C'est un mesh que l'on peut créer très simplement dans le code de notre application.</p><h2 id="r-le-mesh" data-claire-element-id="82640">Le mesh</h2><p id="r-82628" data-claire-element-id="82628">Nous voulons un rectangle pour notre sol. Pour cela, nous pouvons utiliser la classe Plane, qui va nous permettre de générer... un plan ! Je vois que vous avez décidé de vous mettre à l'anglais. :p</p><aside id="r-82630" data-claire-element-id="82630" data-claire-semantic="information"><p id="r-82629" data-claire-element-id="82629">En plus de la classe Plane, vous trouverez aussi des classes Box (pour les cubes) et Sphere qui fonctionnent sur le même principe.</p></aside><p id="r-82631" data-claire-element-id="82631">Nous allons donc créer un plan, pour lequel nous allons définir son vecteur normal, c'est-à-dire le vecteur perpendiculaire au plan : ici l'axe Y pour que notre plan soit horizontal. Le second paramètre est la distance à l'origine de la scène dans le sens du vecteur normal : ici, je mets 0 pour que mon mesh plan soit centré. En mettant une valeur positive par exemple, mon plan se retrouverait plus haut.</p><pre id="r-82632" data-claire-element-id="82632"><code data-claire-semantic="cpp">Plane plan(Vector3::UNIT_Y, 0);</code></pre><p id="r-82633" data-claire-element-id="82633">Une fois le plan créé, il faut que l'on crée un mesh, c'est-à-dire l'objet 3D en lui-même, la représentation du plan qui sera visible dans la scène.</p><p id="r-82634" data-claire-element-id="82634">Pour cela, on utilise le Mesh Manager, qui va s'occuper de créer les faces de notre mesh.</p><pre id="r-82635" data-claire-element-id="82635"><code data-claire-semantic="cpp">MeshManager::getSingleton().createPlane(&quot;sol&quot;, ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME, plan, 500, 500, 1, 1, true, 1, 1, 1, Vector3::UNIT_Z);</code></pre><p id="r-82636" data-claire-element-id="82636">Quelques explications sur cette ligne s'imposent. Tout d'abord, la méthode statique getSingleton() est un peu particulière, j'y reviendrai lorsque l'on mettra un peu plus les mains dans le cambouis ; sachez pour l'instant qu'elle permet de récupérer un objet instancié de façon unique, donc ici notre MeshManager.</p><p id="r-82637" data-claire-element-id="82637">Ensuite, les paramètres de la méthode createPlane sont assez simples. Les deux premiers correspondent respectivement au nom que l'on veut donner à notre mesh et au nom du groupe auquel on veut qu'il appartienne. Suivent ensuite le nom du plan à modéliser, puis la largeur et la hauteur qu'il doit avoir, puis le nombre de subdivisions du plan dans ces deux sens. Plus il y a de subdivisions, plus il y a de polygones dans notre mesh. Le booléen suivant indique que les normales sont perpendiculaires au plan.<br/> Les trois paramètres suivants sont le nombre de textures que l'on va pouvoir assigner au plan, puis le nombre de fois que la texture sera répétée dans les deux directions. Enfin, le dernier paramètre est le vecteur indiquant la direction du haut du mesh. Attention : il ne faut pas le confondre avec la normale du plan, qui est différente.<br/> Il reste encore des paramètres par défaut que je n'ai pas modifiés, ce n'est pas du niveau du chapitre.</p><p id="r-82638" data-claire-element-id="82638">Enfin, nous allons revenir vers un code connu : nous allons créer l'entité qui représentera le plan. C'est le même principe que tout à l'heure : tout d'abord, on crée une entité à partir du Scene Manager en la nommant et en lui indiquant le mesh à utiliser. On crée ensuite un nouveau noeud à partir du noeud racine et on l'attache à notre entité.</p><pre id="r-82639" data-claire-element-id="82639"><code data-claire-semantic="cpp">Entity *ent= mSceneMgr-&gt;createEntity(&quot;EntiteSol&quot;, &quot;sol&quot;);
node = mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode();
node-&gt;attachObject(ent);</code></pre><h2 id="r-le-materiau" data-claire-element-id="82657">Le matériau</h2><p id="r-82641" data-claire-element-id="82641">Nous allons finir en ajoutant une texture au sol, sinon il risque de paraître un peu triste. ^^</p><p id="r-82642" data-claire-element-id="82642">Je vous propose de mettre de l'herbe par terre. Pour cela, il suffit de rajouter la ligne suivante après la création de l'entité :</p><pre id="r-82643" data-claire-element-id="82643"><code data-claire-semantic="cpp">ent-&gt;setMaterialName(&quot;Examples/GrassFloor&quot;);</code></pre><p id="r-82644" data-claire-element-id="82644">Si vous voulez connaître les matériaux fournis avec Ogre, il vous suffit d'aller dans le dossier media/materials/scripts. Ici, j'ai pris le matériau GrassFloor enregistré dans le fichier Examples.material. Les textures correspondantes se trouvent dans le dossier media/materials/textures, si vous voulez faire des essais. ;)</p><p id="r-82645" data-claire-element-id="82645">Je reviendrai plus tard en détail sur les matériaux, le sujet méritera que l'on s'y attarde. :)</p><p id="r-82646" data-claire-element-id="82646">Vous pouvez maintenant exécuter votre programme.</p><p id="r-82647" data-claire-element-id="82647">Lancez l'application et remontez la caméra avec la souris et les touches de déplacement, vous devriez voir quelque chose ressemblant à la capture suivante.</p><figure id="r-82649" data-claire-element-id="82650"><img id="r-82648" data-claire-element-id="82648" src="medias/uploads.siteduzero.com_files_239001_240000_239795.jpg" alt="Image utilisateur"/></figure><div id="r-82652" data-claire-element-id="82652" data-claire-semantic="question"><p id="r-82651" data-claire-element-id="82651">Euh... La tête d'Ogre est coupée par le sol en herbe...</p></div><p id="r-82653" data-claire-element-id="82653">En effet, notre plan est centré sur l'origine de la scène, et l'on a aussi placé notre tête à l'origine. Mais quelle partie de la tête est à l'altitude 0 ?</p><p id="r-82654" data-claire-element-id="82654">Ici, c'est donc un point au milieu de la tête, puisque le plan d'herbe passe par là.<br/> Cependant, ce point n'est pas nécessairement au milieu de l'objet que vous intégrez. Cela dépend de la personne qui a modélisé l'objet et qui a donc décidé par rapport à quel point on allait définir la position du mesh. Pour un personnage, on pourrait mettre ce point à ses pieds, pour que l'altitude 0 corresponde effectivement au moment où le personnage touche le sol avec ses pieds.</p><p id="r-82655" data-claire-element-id="82655">Pour corriger cela, il va falloir remonter notre noeud lié à notre entité. C'est l'objet du prochain chapitre.</p><p id="r-82656" data-claire-element-id="82656">Voilà : cette fois, vous avez vraiment mis les pieds dans Ogre3D en insérant un modèle dans la scène. Dans le prochain chapitre, nous allons apprendre à déplacer des nœuds et à nous déplacer au sein de l'environnement 3D.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
<span class="arrow"></span>
<span class="next">Les noeuds de scène</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">
<span class="next">Se repérer dans l&#039;espace</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Sereprerdansl039espace"></a><h2>Se repérer dans l&#039;espace</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
<span class="arrow"></span>
<span class="next">Créer un mesh</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
<span class="next">Le système de coordonnées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-82660" data-claire-element-id="82660">Bon : nous avons réussi à afficher une tête d'Ogre et un plan d'herbe dans le chapitre précédent.</p><p id="r-82661" data-claire-element-id="82661">Mais maintenant, il faudrait peut-être savoir comment on va bouger notre ogre, qu'il n'ait pas l'air d'avoir été enterré vivant... Enfin ça, ce sera après avoir jeté un oeil au système de coordonnées de l'espace, un peu de théorie ne fait pas de mal. ^^</p>
</div><a name="Lesystmedecoordonnes"></a><h2>Le système de coordonnées</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">
<span class="arrow"></span>
<span class="next">Se repérer dans l&#039;espace</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
<span class="next">Déplacer des objets</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-le-repere-main-droite" data-claire-element-id="82699">Le repère « main droite »</h2><p id="r-82662" data-claire-element-id="82662">Un repère est un ensemble de trois droites, appelées « axes », qui définissent la convention utilisée pour enregistrer l'état d'objets se trouvant dans l'espace. Afin de simplifier au maximum le repère, ces trois axes sont choisis pour que chacun soit orthogonal (perpendiculaire) aux deux autres : on l'appelle alors <em>repère orthogonal</em>.</p><p id="r-82663" data-claire-element-id="82663">On y ajoute une contrainte supplémentaire, disant que les vecteurs directeurs de ces axes sont de longueur 1, ce qui donne un <em>repère orthonormé</em>.</p><h3 id="r-pourquoi-main-droite" data-claire-element-id="82671">Pourquoi main droite ?</h3><p id="r-82664" data-claire-element-id="82664">Nous avons vu que les trois axes du repère étaient orthogonaux, mais dans quel sens sont-ils orientés ? En effet, comme les axes sont des droites, comment savoir si l'on doit aller dans un sens ou dans l'autre si l'on veut se déplacer le long d'un axe ? Nous avons donc besoin d'un sens, défini par la règle de la main droite.</p><aside id="r-82666" data-claire-element-id="82666" data-claire-semantic="warning"><p id="r-82665" data-claire-element-id="82665">Il est aussi possible d'utiliser la convention « main gauche » dans vos programmes ; cependant, notamment parce que les mathématiques sont impliquées dans tout ça, le repère main droite est le plus couramment utilisé, c'est le cas dans Ogre.</p></aside><p id="r-82667" data-claire-element-id="82667">Regardez votre main droite et placez-la comme sur l'image. Votre pouce représente l'axe X, votre index l'axe Y et votre majeur l'axe Z. La direction dans laquelle pointe chacun de vos doigts définit le sens de chaque axe.</p><figure id="r-82669" data-claire-element-id="82670"><img id="r-82668" data-claire-element-id="82668" src="medias/uploads.siteduzero.com_files_239001_240000_239756.png" alt="Image utilisateur"/></figure><h3 id="r-repere-local-repere-absolu" data-claire-element-id="82680">Repère local, repère absolu</h3><p id="r-82672" data-claire-element-id="82672">Pour l'instant, nous n'avons toujours pas défini comment le repère était placé dans la scène. En effet, quel axe pointe dans quelle direction ? Là encore, c'est une question de convention adoptée pour les applications 3D.</p><p id="r-82673" data-claire-element-id="82673">On prendra donc, pour le repère de la scène, l'axe Y dirigé vers le haut et les axes X et Z dans un plan horizontal.</p><p id="r-82674" data-claire-element-id="82674">Seulement, la scène n'est pas la seule à avoir son repère. En effet, chaque objet possède son propre repère appelé <em>repère local</em>. Lorsque l'objet se déplace ou tourne sur lui-même, le repère local fait de même. L'orientation du repère local est la suivante : l'axe Y est dirigé vers le haut de l'objet, pour la scène, tandis que l'axe X est dirigé vers sa droite et l'axe Z vers l'arrière de l'objet.</p><p id="r-82675" data-claire-element-id="82675">Ci-dessous, j'ai représenté en noir le repère de la scène, et en bleu le repère local de la voiture, en respectant la convention que j'ai donnée.</p><figure id="r-82677" data-claire-element-id="82678"><img id="r-82676" data-claire-element-id="82676" src="medias/uploads.siteduzero.com_files_239001_240000_239759.jpg" alt="Image utilisateur"/></figure><p id="r-82679" data-claire-element-id="82679">Nous verrons à quoi servent ces différents repères lorsque l'on commencera à déplacer nos objets.</p><h3 id="r-yaw-pitch-roll" data-claire-element-id="82698">Yaw, pitch, roll</h3><p id="r-82681" data-claire-element-id="82681">Le yaw pitch roll, ce n'est pas un nouveau genre de musique, non. Ce sont les désignations anglaises pour les rotations autour des axes Y, X et Z respectivement.<br/> On peut traduire ces termes par lacet (<em>yaw</em>), tangage (<em>pitch</em>) et roulis (<em>roll</em>), qui sont utilisés par exemple en aéronautique ou en navigation, mais je préfère que vous les reteniez en anglais.</p><div id="r-82683" data-claire-element-id="82683" data-claire-semantic="question"><p id="r-82682" data-claire-element-id="82682">Pourquoi cela ? L'anglais ne m'aime pas ! Je n'y peux rien ! :(</p></div><p id="r-82684" data-claire-element-id="82684">J'imagine qu'il y en a parmi vous qui sont anglophobes, mais comme on vous l'a sûrement déjà dit, pour programmer il est essentiel de connaître un minimum d'anglais. En l'occurrence, ces trois termes se retrouveront dans les noms qu'Ogre donne aux méthodes permettant d'effectuer des rotations. Autant donc vous familiariser tout de suite avec eux, vous serez plus à même de rechercher les méthodes qui vous intéresseront en temps voulu.</p><p id="r-82685" data-claire-element-id="82685">Voici tout de suite un schéma illustrant les rotations qui s'appliquent à chaque axe :</p><figure id="r-82687" data-claire-element-id="82688"><img id="r-82686" data-claire-element-id="82686" src="medias/uploads.siteduzero.com_files_239001_240000_239807.jpg" alt="Image utilisateur"/></figure><p id="r-82689" data-claire-element-id="82689">Comme vous pouvez le constater, il y a un sens donné aux flèches sur ce dessin. C'est parce que tout comme l'orientation des axes de notre repère, il y a un sens direct et un sens indirect pour les rotations ! Ainsi, en imaginant que vous vous teniez le long d'un axe, avec vos pieds à l'origine et votre tête au bout de la flèche, vous tournerez dans le sens direct si vous vous tournez vers la gauche.</p><p id="r-82690" data-claire-element-id="82690">Il est important de savoir si l'on doit ou non aller dans le sens direct pour une rotation, puisque c'est de cette manière que vous déterminerez si vous devez tourner d'un angle positif (sens direct) ou négatif (sens indirect).</p><p id="r-82691" data-claire-element-id="82691">Pour effectuer une rotation, on appelle la méthode correspondante pour le n?ud :</p><pre id="r-82692" data-claire-element-id="82692"><code data-claire-semantic="cpp">node-&gt;yaw(Radian(Math::PI));</code></pre><p id="r-82693" data-claire-element-id="82693">Ceci fera faire un demi-tour au n?ud par rapport à son axe vertical tandis que les méthodes pitch() et roll() s'utilisent de façon analogue pour les autres axes.<br/> La rotation se fait par défaut par rapport au repère local. Il faut renseigner le second paramètre si vous voulez qu'il en soit autrement (voir la section suivante).</p><aside id="r-82695" data-claire-element-id="82695" data-claire-semantic="warning"><p id="r-82694" data-claire-element-id="82694">Les angles doivent être entrés en <a href="http://fr.wikipedia.org/wiki/Radian">radians</a>.</p></aside><p id="r-82696" data-claire-element-id="82696">Si vous ne connaissez pas les radians, sachez que c'est l'unité de mesure d'angles la plus commune en mathématiques. Dans cette unité, la valeur PI (\pi) est équivalente à 180°, soit un demi-tour.<br/> Pour utiliser tout de même des degrés dans Ogre, vous devrez utiliser la classe <em>Degree</em>. La ligne de code précédente est équivalente à ceci :</p><pre id="r-82697" data-claire-element-id="82697"><code data-claire-semantic="cpp">node-&gt;yaw(Degree(180));</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">
<span class="arrow"></span>
<span class="next">Se repérer dans l&#039;espace</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
<span class="next">Déplacer des objets</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Dplacerdesobjets"></a><h2>Déplacer des objets</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
<span class="arrow"></span>
<span class="next">Le système de coordonnées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
<span class="next">La caméra</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-bouger-un-n-ud-de-scene" data-claire-element-id="82740">Bouger un n?ud de scène</h2><p id="r-82701" data-claire-element-id="82701">Nous allons maintenant déplacer notre tête d'ogre pour vérifier la théorie et enfin sortir notre tête de terre !</p><p id="r-82702" data-claire-element-id="82702">Pour cela, nous allons donc - si vous avez bien suivi - passer par le n?ud auquel est rattaché notre mesh. Celui-ci possède deux méthodes qui peuvent nous servir.</p><h3 id="r-setposition" data-claire-element-id="82708">setPosition()</h3><p id="r-82703" data-claire-element-id="82703">La première est la méthode setPosition(), prenant en paramètre les trois coordonnées X, Y et Z du point auquel on désire placer le n?ud. On peut aussi lui passer un Vector3, qui contiendra lui-même ces coordonnées.</p><p id="r-82704" data-claire-element-id="82704">Les deux codes suivants sont donc équivalents.</p><pre id="r-82705" data-claire-element-id="82705"><code data-claire-semantic="cpp">Vector3 position = Vector3(30.0, 50.0, 0.0);
node-&gt;setPosition(position);</code></pre><pre id="r-82706" data-claire-element-id="82706"><code data-claire-semantic="cpp">node-&gt;setPosition(30.0, 50.0, 0.0);</code></pre><p id="r-82707" data-claire-element-id="82707">La tête s'est maintenant déplacée vers la droite de 30 unités et de 50 unités vers le haut.</p><h3 id="r-translate" data-claire-element-id="82739">translate()</h3><p id="r-82709" data-claire-element-id="82709">La seconde méthode utilisable pour le déplacement est translate(), qui déplace le n?ud par rapport à sa position actuelle plutôt que par rapport à l'origine de la scène.<br/> Elle prend les mêmes paramètres que la méthode setPosition(), mais avec un paramètre supplémentaire, défini par défaut, indiquant le n?ud par rapport auquel on va se déplacer.</p><pre id="r-82710" data-claire-element-id="82710"><code data-claire-semantic="cpp">node-&gt;translate(-30.0, 50.0, 0.0);</code></pre><p id="r-82711" data-claire-element-id="82711">En ajoutant cette ligne après la précédente, notre objet se retrouve donc maintenant à la position (0, 100, 0) dans la scène, ce qui est suffisant pour qu'il surplombe son petit jardin. ;)</p><figure id="r-82713" data-claire-element-id="82714"><img id="r-82712" data-claire-element-id="82712" src="medias/uploads.siteduzero.com_files_241001_242000_241383.jpg" alt="Image utilisateur"/></figure><div id="r-82716" data-claire-element-id="82716" data-claire-semantic="question"><p id="r-82715" data-claire-element-id="82715">Tu as parlé d'un paramètre supplémentaire, qu'est-ce que c'est ?</p></div><p id="r-82717" data-claire-element-id="82717">C'est un paramètre pouvant prendre trois valeurs différentes qui définit par rapport à quel repère on va se déplacer. Voici les trois valeur qui sont acceptées :</p><ul id="r-82724" data-claire-element-id="82724"><li id="r-82719" data-claire-element-id="82719"><p id="r-82718" data-claire-element-id="82718">Node::TS_LOCAL</p></li><li id="r-82721" data-claire-element-id="82721"><p id="r-82720" data-claire-element-id="82720">Node::TS_PARENT</p></li><li id="r-82723" data-claire-element-id="82723"><p id="r-82722" data-claire-element-id="82722">Node::TS_WORLD</p></li></ul><p id="r-82725" data-claire-element-id="82725">La première va déplacer le nœud par rapport au repère local, la seconde par rapport au repère du nœud parent, et la troisième par rapport au repère de la scène, qui est le repère absolu.</p><div id="r-82727" data-claire-element-id="82727" data-claire-semantic="question"><p id="r-82726" data-claire-element-id="82726">Concrètement, ça veut dire quoi ?</p></div><p id="r-82728" data-claire-element-id="82728">Tout à l'heure, lorsque l'on a effectué une translation, on l'a fait par défaut par rapport au repère TS_WORLD, c'est-à-dire avec les axes tels que je vous les ai présentés précédemment. Maintenant, nous pouvons déplacer notre n?ud par rapport au repère local de son n?ud père par exemple, ou bien même par rapport à son propre repère local.</p><div id="r-82730" data-claire-element-id="82730" data-claire-semantic="question"><p id="r-82729" data-claire-element-id="82729">Mais à quoi ça sert de s'embêter avec ces paramètres ? On risque de faire des erreurs si l'on se place par rapport à un repère différent de la scène !</p></div><p id="r-82731" data-claire-element-id="82731">Prenons un exemple. Vous avez un vaisseau spatial qui peut se trouver dans n'importe quelles position et orientation de l'espace. Comment savoir facilement dans quelle direction je dois faire ma translation pour qu'on le voit aller en avant ?</p><p id="r-82732" data-claire-element-id="82732">Réponse : je n'ai pas à m'en occuper ! En effet, l'axe qui va de l'avant vers l'arrière du vaisseau est l'axe Z, dans son repère local. Par conséquent, je n'ai qu'à dire à mon vaisseau d'avancer le long de l'axe Z (dans le sens négatif pour aller à l'avant) <strong>par rapport à son repère local</strong>. Et Ogre s'occupera gentiment de faire les calculs pour placer mon vaisseau correctement dans la scène.</p><p id="r-82733" data-claire-element-id="82733">Allez, comme vous êtes sages, je vous mets un bon point et une image une petite illustration pour visualiser tout ça.</p><figure id="r-82735" data-claire-element-id="82736"><img id="r-82734" data-claire-element-id="82734" src="medias/uploads.siteduzero.com_files_241001_242000_241380.jpg" alt="Image utilisateur"/></figure><p id="r-82737" data-claire-element-id="82737">Si vous avez compris cela, le paramètre TS_PARENT devrait suivre tout seul. Reprenons notre engin spatial.<br/> Sur ce vaisseau, on trouve R2D2 en train de se déplacer vers la droite, correspondant donc à l'axe X local du n?ud du vaisseau. Pour effectuer cette translation, je n'ai qu'à demander à Ogre de déplacer mon robot le long de l'axe des abscisses <strong>par rapport au n?ud du vaisseau</strong> (qui serait logiquement le n?ud parent). Et le tour est joué. ^^</p><p id="r-82738" data-claire-element-id="82738">Vous commencez à comprendre l'intérêt des relations de parenté entre les n?uds ? Ceux qui répondent non, j'en fais mon affaire ! :pirate:</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
<span class="arrow"></span>
<span class="next">Le système de coordonnées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
<span class="next">La caméra</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lacamra"></a><h2>La caméra</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
<span class="arrow"></span>
<span class="next">Déplacer des objets</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
<span class="next">Le Viewport</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-82742" data-claire-element-id="82742">Après cet exemple haut en couleur, revenons à quelque chose de plus humble pour notre niveau de Zéro. :p</p><p id="r-82743" data-claire-element-id="82743">Maintenant que l'on a un peu déplacé notre tête d'Ogre, on va voir comment placer la caméra pour qu'elle la voie sous son meilleur jour dès que l'application démarre. La caméra, c'est l'élément qui définit la position de notre point de vue dans la scène, dans quelle direction on regarde, mais aussi jusqu'à quelle distance il est possible de voir s'afficher les objets éloignés.</p><p id="r-82744" data-claire-element-id="82744">Comme tous les éléments de base, un attribut caméra est présent dans la classe ExampleApplication. Sans elle nous n'aurions pas encore pu voir notre scène, vu que nous n'avons rien fait pour la créer !</p><h3 id="r-creation-3" data-claire-element-id="82749">Création</h3><p id="r-82745" data-claire-element-id="82745">La caméra est créée dans une méthode appelée createCamera() de la classe ExampleApplication, que nous allons tout de suite redéfinir pour partir sur des bases connues. L'attribut correspondant à la caméra est appelé mCamera, nous pouvons donc l'utiliser pour créer notre caméra.</p><p id="r-82746" data-claire-element-id="82746">Comme c'est un objet qui se trouve dans la scène, nous allons passer - je vous le donne en mille - par le SceneManager. Comme pour les n?uds ou les entités, vous pourrez donner un nom à votre caméra sous forme d'une chaîne de caractères.</p><p id="r-82747" data-claire-element-id="82747">Ajoutez la méthode createCamera() à votre classe PremiereApplication et ajoutez-y la ligne suivante.</p><pre id="r-82748" data-claire-element-id="82748"><code data-claire-semantic="cpp">mCamera = mSceneMgr-&gt;createCamera(&quot;Ma Camera&quot;);</code></pre><h3 id="r-placement" data-claire-element-id="82763">Placement</h3><p id="r-82750" data-claire-element-id="82750">Maintenant, il va nous falloir placer la caméra et l'orienter. Le placement se fait avec la méthode setPosition(), prenant des paramètres identiques à ceux de la méthode utilisée pour les n?uds de scène. La seconde méthode utilisée s'appelle lookAt() et, comme son nom l'indique, elle permet de déterminer le point de la scène que regarde notre caméra. On lui fournit un Vector3 ou bien trois réels correspondant aux coordonnées désirées.</p><pre id="r-82751" data-claire-element-id="82751"><code data-claire-semantic="cpp">mCamera-&gt;setPosition(Vector3(-100.0, 150.0, 200.0));
mCamera-&gt;lookAt(Vector3(0.0, 100.0, 0.0));</code></pre><p id="r-82752" data-claire-element-id="82752">En relançant l'application, on se retrouve donc directement à côté de notre tête.</p><figure id="r-82754" data-claire-element-id="82755"><img id="r-82753" data-claire-element-id="82753" src="medias/uploads.siteduzero.com_files_241001_242000_241381.jpg" alt="Image utilisateur"/></figure><p id="r-82756" data-claire-element-id="82756">Enfin, on peut aussi indiquer les distances de near clip et de far clip, qui sont les distances minimale et maximale auxquelles doit se trouver un objet pour être affiché à l'écran. Cela permet, notamment lorsqu'il y a beaucoup d'objets dans la scène (en extérieur, par exemple), de ne pas ralentir l'exécution du programme en n'affichant pas les objets les plus éloignés.</p><pre id="r-82757" data-claire-element-id="82757"><code data-claire-semantic="cpp">mCamera-&gt;setNearClipDistance(1);
mCamera-&gt;setFarClipDistance(1000);</code></pre><p id="r-82758" data-claire-element-id="82758">Si vous recule suffisammentz la caméra, vous verrez que la tête disparaît sous vos yeux : elle est trop loin de la caméra pour être affichée avec les paramètres que j'ai choisis.</p><figure id="r-82760" data-claire-element-id="82761"><img id="r-82759" data-claire-element-id="82759" src="medias/uploads.siteduzero.com_files_241001_242000_241385.jpg" alt="Image utilisateur"/></figure><p id="r-82762" data-claire-element-id="82762">Le même phénomène se produira si vous vous approchez suffisamment de la tête (une plus grosse distance de near clip permettra de mieux le voir).</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
<span class="arrow"></span>
<span class="next">Déplacer des objets</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
<span class="next">Le Viewport</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LeViewport"></a><h2>Le Viewport</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
<span class="arrow"></span>
<span class="next">La caméra</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">
<span class="next">Allumez la lumière !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-82765" data-claire-element-id="82765">La façon dont la caméra rend à l'écran ce qu'elle voit ne dépend pas que d'elle. En effet, la taille de votre zone de rendu et son format seront répercutés sur la portion de scène qu'il vous sera donné de voir. Si l'on ne tenait pas compte de ces paramètres, on pourrait obtenir une image aplatie si l'on élargit la zone de rendu, ou bien au contraire compressée si l'on diminue la largeur en laissant la hauteur constante.</p><p id="r-82766" data-claire-element-id="82766">La fenêtre de votre application est un objet distinct de la zone de rendu. En effet, dans une même fenêtre, vous pouvez afficher le rendu de plusieurs caméra dans la scène, voire des caméras de différents SceneManager. Lorsque vous jouez à un jeu multijoueur, c'est ce qui est réalisé : vous avez une seule fenêtre pour votre application, mais vous voyez plusieurs lieux de la scène, en fonction du placement des joueurs.</p><p id="r-82767" data-claire-element-id="82767">La gestion de l'affichage dans une zone de rendu est laissée à la classe Viewport, qui est simplement la partie de votre fenêtre où s'affiche ce que voit votre caméra. De ces deux liens découle la création du Viewport, appelée par la fenêtre et prenant en paramètre la caméra concernée.</p><p id="r-82768" data-claire-element-id="82768">Pour cela, nous allons redéfinir la méthode createViewports() qui s'occupait jusqu'alors de ce travail pour nous, et copier la ligne suivante.</p><pre id="r-82769" data-claire-element-id="82769"><code data-claire-semantic="cpp">Viewport *vue = mWindow-&gt;addViewport(mCamera);</code></pre><p id="r-82770" data-claire-element-id="82770">Ici, mWindow est la fenêtre de notre application Ogre, c'est une instance de la classe RenderWindow dont nous verrons les détails dans un prochain chapitre.</p><p id="r-82771" data-claire-element-id="82771">Grâce à ce Viewport nouvellement créé, nous allons faire coïncider le rapport largeur / hauteur de notre caméra avec celui du Viewport, pour avoir une image non déformée :</p><pre id="r-82772" data-claire-element-id="82772"><code data-claire-semantic="cpp">mCamera-&gt;setAspectRatio(Real(vue-&gt;getActualWidth()) / Real(vue-&gt;getActualHeight()));</code></pre><p id="r-82773" data-claire-element-id="82773">Les deux méthodes appelées grâce à la vue permettent de récupérer sa largeur et sa hauteur, auxquelles on applique un cast vers le format Ogre::Real pour obtenir un ratio décimal. Dans le cas contraire, le ratio serait tronqué pour être entier et la tête de notre ogre favori serait déformée.</p><p id="r-82774" data-claire-element-id="82774">Sachez aussi que c'est le Viewport qui définit la couleur de fond de la scène que vous voyez si aucun objet n'apparaît plus. Ici, nous avions du noir, mais il est tout à fait possible de mettre du bleu par exemple.</p><pre id="r-82775" data-claire-element-id="82775"><code data-claire-semantic="cpp">vue-&gt;setBackgroundColour(ColourValue(0.0, 0.0, 1.0));</code></pre><p id="r-82776" data-claire-element-id="82776">Voici donc ma méthode createViewports() au complet :</p><pre id="r-82777" data-claire-element-id="82777"><code data-claire-semantic="cpp">void PremiereApplication::createViewports()
{
    Viewport *vue = mWindow-&gt;addViewport(mCamera);
    mCamera-&gt;setAspectRatio(Real(vue-&gt;getActualWidth()) / Real(vue-&gt;getActualHeight()));
    vue-&gt;setBackgroundColour(ColourValue(0.0, 0.0, 1.0));
}</code></pre><p id="r-82778" data-claire-element-id="82778">Maintenant, notre scène possède un magnifique ciel fond bleu. :D</p><figure id="r-82780" data-claire-element-id="82781"><img id="r-82779" data-claire-element-id="82779" src="medias/uploads.siteduzero.com_files_241001_242000_241384.jpg" alt="Image utilisateur"/></figure><p id="r-82782" data-claire-element-id="82782">Il est important d'avoir bien compris ce chapitre, notamment le système de coordonnées et les relations de parenté entre les n?uds de scène pour pouvoir placer facilement ses objets dans la scène, sans avoir à faire plein de tentatives pour &quot;voir ce que ça donne&quot;. C'est du temps perdu !</p><p id="r-82783" data-claire-element-id="82783">Et n'oubliez pas : le repère main droite, c'est une façon rapide et facile de visualiser vos axes, plutôt que d'aller vérifier leur ordre sur un schéma !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
<span class="arrow"></span>
<span class="next">La caméra</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">
<span class="next">Allumez la lumière !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Allumezlalumire"></a><h2>Allumez la lumière !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
<span class="arrow"></span>
<span class="next">Le Viewport</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
<span class="next">Les lumières</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-82786" data-claire-element-id="82786">La gestion des lumières est souvent ce qui représente la moitié du travail pour créer l'ambiance dans un jeu. Un couloir sombre, des ombres mouvantes sur les murs... :o Rien de mieux pour une ambiance glauque par exemple. :p</p><p id="r-82787" data-claire-element-id="82787">Ogre permet bien sûr de créer ce genre d'ambiance, avec une panoplie de lumières et d'ombres pour s'adapter à tous les besoins.</p><p id="r-82788" data-claire-element-id="82788">Notre mesh est prêt à passer sous les feux des projecteurs. :soleil:</p>
</div><a name="Leslumires"></a><h2>Les lumières</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">
<span class="arrow"></span>
<span class="next">Allumez la lumière !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
<span class="next">Les ombres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-quelques-fonctions-de-base" data-claire-element-id="82812">Quelques fonctions de base</h2><p id="r-82789" data-claire-element-id="82789">Pour pouvoir voir quelque chose dans une scène, il est nécessaire d'avoir des lumières qui vont permettre de répartir l'éclairage et de donner un aspect plus vrai à votre environnement. Il faut savoir que lorsque vous initialisez votre scène, aucune lumière n'est présente, tous les modèles de la scène devraient donc rester noirs.</p><div id="r-82791" data-claire-element-id="82791" data-claire-semantic="question"><p id="r-82790" data-claire-element-id="82790">Comment a-t-on pu voir nos objets depuis le début de ce cours dans ce cas ?</p></div><p id="r-82792" data-claire-element-id="82792">En plus des lumières, il existe une propriété du Scene Manager qui est très pratique et qui permet de définir une lumière ambiante. Cela permet d'éclairer la scène de façon homogène avec une certaine luminosité. Par défaut, on a un éclairage à la lumière blanche qui permet de voir ce qui se passe dans la scène, mais pour la suite du tutoriel, afin de bien voir l'influence de nos lumières, nous allons retirer cet éclairage en lui appliquant la couleur noire. La ligne suivante peut être ajoutée au début de la méthode createScene().</p><pre id="r-82793" data-claire-element-id="82793"><code data-claire-semantic="cpp">mSceneMgr-&gt;setAmbientLight(ColourValue(0.0, 0.0, 0.0));</code></pre><p id="r-82794" data-claire-element-id="82794">La classe ColourValue permet de définir une couleur en entrant les quantités respectives de rouge, de vert puis de bleu dans un nombre compris entre 0 et 1. Il est aussi possible de définir une composante alpha (la transparence), utile pour des textures par exemple.</p><p id="r-82795" data-claire-element-id="82795">Pour créer une lumière, encore une fois c'est très simple. Comme c'est un objet de scène, je pense que vous avez déjà deviné que l'on va passer par une certaine classe pour l'instancier...</p><pre id="r-82796" data-claire-element-id="82796"><code data-claire-semantic="cpp">Light *light = mSceneMgr-&gt;createLight(&quot;lumiere1&quot;);</code></pre><p id="r-82797" data-claire-element-id="82797">Oui, à nouveau, c'est le Scene Manager qui va s'occuper de la création pour nous, toujours assez facilement vous l'aurez remarqué.</p><aside id="r-82799" data-claire-element-id="82799" data-claire-semantic="information"><p id="r-82798" data-claire-element-id="82798">Par défaut, la lumière créée est de type ponctuelle. Vous avez plus de détails sur les différents types de lumière un peu plus bas.</p></aside><p id="r-82800" data-claire-element-id="82800">Mettons tout de suite en place quelques paramètres de base : la couleur émise (diffuse et spéculaire, que nous détaillerons dans le chapitre sur les matériaux) et la position.</p><pre id="r-82801" data-claire-element-id="82801"><code data-claire-semantic="cpp">light-&gt;setDiffuseColour(1.0, 0.7, 1.0);
light-&gt;setSpecularColour(1.0, 0.7, 1.0);
light-&gt;setPosition(-100, 200, 100);</code></pre><p id="r-82802" data-claire-element-id="82802">En ajoutant ce code après la création de la lumière, on obtient un lumière positionnée sur le côté de notre mesh. En tournant autour, vous verrez que le côté opposé est plus sombre.</p><figure id="r-82804" data-claire-element-id="82805"><img id="r-82803" data-claire-element-id="82803" src="medias/uploads.siteduzero.com_files_241001_242000_241570.jpg" alt="Image utilisateur"/></figure><p id="r-82806" data-claire-element-id="82806">Les deux premiers paramètres sont les couleurs diffuses et spéculaires, au format RVB, avec des valeurs qui doivent être comprises entre 0 et 1. J'ai ici choisi une lumière proche de le lumière blanche avec une composante verte plus faible pour éviter de rendre notre scène trop flashy. ^^ Vous pouvez bien sûr changer les paramètres pour essayer des couleurs... inattendues. ;)</p><p id="r-82807" data-claire-element-id="82807">Ce point sera revu plus en détail dans un chapitre abordant les matériaux ; sachez seulement que la couleur diffuse est la couleur sous laquelle vont apparaître les objets non brillants, et que la couleur spéculaire est un paramètre supplémentaire pour les matériaux réfléchissants comme le métal ou le verre. Pour une lumière, on met généralement la même couleur pour ces deux paramètres.</p><p id="r-82808" data-claire-element-id="82808">Vient ensuite la méthode setPosition(), qui ne devrait pas vous poser de problèmes, et enfin une dernière ligne permettant d'amplifier ou de diminuer l'intensité lumineuse. Par défaut, ce coefficient est de 1, mais pour notre scène j'ai voulu l'augmenter pour qu'on y voie un peu plus clair : n'hésitez pas à jouer un peu avec pour faire des essais.</p><p id="r-82809" data-claire-element-id="82809">Enfin, sachez qu'il est possible d'attacher une lumière à un noeud de scène. Dans ce cas, la méthode Light::setPosition() définit la position relative de la lumière par rapport au noeud.</p><pre id="r-82810" data-claire-element-id="82810"><code data-claire-semantic="cpp">node-&gt;attachObject(light);</code></pre><p id="r-82811" data-claire-element-id="82811">Vous pouvez donc facilement placer une lumière à la position d'un mesh censé émettre de la lumière - par exemple les phares d'une voiture - et les déplacer en même temps grâce à une seule commande vers le noeud de scène !</p><h2 id="r-les-types-de-lumieres" data-claire-element-id="82851">Les types de lumières</h2><p id="r-82813" data-claire-element-id="82813">Je vous l'annonçais, Ogre peut gérer différents types de lumières selon l'effet désiré. Ils sont au nombre de 3 :</p><ul id="r-82820" data-claire-element-id="82820"><li id="r-82815" data-claire-element-id="82815"><p id="r-82814" data-claire-element-id="82814">la lumière ponctuelle : cette lumière émet dans toutes les directions à partir de sa position ;</p></li><li id="r-82817" data-claire-element-id="82817"><p id="r-82816" data-claire-element-id="82816">la lumière directionnelle, une lumière dont les rayons vont dans une direction unique et qui n'a pas de position. C'est le genre de lumière qui permet de reproduire l'éclairage du soleil par exemple ;</p></li><li id="r-82819" data-claire-element-id="82819"><p id="r-82818" data-claire-element-id="82818">le projecteur ou spot : c'est une lumière qui émet un cône lumineux à partir de sa position, à la façon d'une lampe-torche.</p></li></ul><h3 id="r-lumiere-ponctuelle" data-claire-element-id="82838">Lumière ponctuelle</h3><p id="r-82821" data-claire-element-id="82821">C'est le type de lumière créé par défaut que l'on a vu plus haut. Pour le modifier manuellement, il faut utiliser le type LT_POINT.</p><pre id="r-82822" data-claire-element-id="82822"><code data-claire-semantic="cpp">light-&gt;setType(Light::LT_POINT);</code></pre><p id="r-82823" data-claire-element-id="82823">Avec ce type de lumière, il existe une méthode nous permettant aussi de limiter la portée de notre éclairage.</p><pre id="r-82824" data-claire-element-id="82824"><code data-claire-semantic="cpp">light-&gt;setAttenuation(300, 1, 0.007, 0);</code></pre><p id="r-82825" data-claire-element-id="82825">Voici le prototype de la fonction :</p><pre id="r-82826" data-claire-element-id="82826"><code data-claire-semantic="cpp">Light::setAttenuation( Real range, Real constant, Real linear, Real quadratic )</code></pre><p id="r-82827" data-claire-element-id="82827">C'est plus délicat car les paramètres doivent être choisis avec soin. Le premier est la distance caractéristique d'atténuation, c'est-à-dire la distance à partir de laquelle la luminosité diminue. constant est une constante d'atténuation comprise entre 0 et 1. Plus elle est proche de 0, et plus le passage de la lumière à l'ombre est brutal. Enfin linear et quadratic sont les paramètres de la courbe d'atténuation, et doivent être assez faibles, sinon la lumière s'atténue trop rapidement. Vous pouvez jouer un peu avec les valeurs pour voir le comportement de l'atténuation, qui est assez subtil.</p><div id="r-82829" data-claire-element-id="82829" data-claire-semantic="question"><p id="r-82828" data-claire-element-id="82828">Ça ne marche pas ! L'ogre est bien éclairé mais le sol reste désespérément noir !</p></div><p id="r-82830" data-claire-element-id="82830">L'atténuation ajoute une caractéristique un peu différente pour la gestion de la lumière. En effet, l'éclairage des surfaces est calculé en fonction des vertices situés dans la zone d'éclairage. Lorsqu'un vertice est dans la zone d'éclairage du spot, la surface autour de lui est éclairée, sinon elle est dans l'ombre. Ogre se charge ensuite de faire les dégradés entre les vertices plus ou moins éclairés.</p><p id="r-82831" data-claire-element-id="82831">Mais ici, notre plan n'est constitué que de quatre vertices (les coins), dont aucun n'est éclairé par le spot. Le sol n'est donc pas éclairé. ^^</p><p id="r-82832" data-claire-element-id="82832">Pour régler ça, il suffit de modifier notre sol pour qu'il possède plus de vertices. Retrouvez la définition du plan et modifiez les paramètres de découpage pour obtenir 10 segments en largeur et en longueur (les deux paramètres avant le <code data-claire-semantic="cpp">true</code>).</p><pre id="r-82833" data-claire-element-id="82833"><code data-claire-semantic="cpp">Plane plan(Vector3::UNIT_Y, 0);
MeshManager::getSingleton().createPlane(&quot;sol&quot;, ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME, plan, 500, 500, 10, 10, true, 1, 1, 1, Vector3::UNIT_Z);</code></pre><figure id="r-82835" data-claire-element-id="82836"><img id="r-82834" data-claire-element-id="82834" src="medias/uploads.siteduzero.com_files_241001_242000_241571.jpg" alt="Image utilisateur"/></figure><p id="r-82837" data-claire-element-id="82837">Notez que plus il y aura de vertices sur le modèle, plus ce sera précis, mais ce sera un peu plus coûteux en ressources.</p><h3 id="r-lumiere-directionnelle" data-claire-element-id="82841">Lumière directionnelle</h3><p id="r-82839" data-claire-element-id="82839">Étant donné que cette lumière est de type « soleil » et qu'elle émet à l'infini, il n'est pas utile de renseigner sa position. En revanche, la méthode setDirection() permet de définir le vecteur directeur des rayons lumineux.</p><pre id="r-82840" data-claire-element-id="82840"><code data-claire-semantic="cpp">light-&gt;setType(Light::LT_DIRECTIONAL);
light-&gt;setDirection(10.0, -20.0, -5);</code></pre><h3 id="r-projecteur" data-claire-element-id="82850">Projecteur</h3><p id="r-82842" data-claire-element-id="82842">Le projecteur permet généralement de simuler un éclairage artificiel en proposant une lumière directionnelle définie dans un cône central et un cône extérieur, avec deux intensités différentes. Le cône central définit une lumière plus forte que le cône extérieur, où la lumière est quelque peu atténuée. Ces deux cônes sont définis par leur angle d'ouverture, ainsi que par un <em>falloff</em>, c'est-à-dire un coefficient indiquant si la transition entre les deux cônes doit être plus ou moins rapide :</p><pre id="r-82843" data-claire-element-id="82843"><code data-claire-semantic="cpp">light-&gt;setType(Light::LT_SPOTLIGHT);
light-&gt;setPosition(0, 150, -100);
light-&gt;setDirection(0, -1, 1);
light-&gt;setSpotlightRange(Degree(30), Degree(60), 1.0);</code></pre><p id="r-82844" data-claire-element-id="82844">Notez que l'éclairage du spot obéit aux mêmes règles que pour l'atténuation d'une lumière ponctuelle : il faut que les vertices soient éclairés pour que l'éclairage soit visible.</p><p id="r-82845" data-claire-element-id="82845">Notre spot devrait éclairer le sol d'une façon similaire à la lumière ponctuelle avec atténuation ; cependant, retenez bien que cela ne va que dans une seule direction :</p><figure id="r-82847" data-claire-element-id="82848"><img id="r-82846" data-claire-element-id="82846" src="medias/uploads.siteduzero.com_files_241001_242000_241527.jpg" alt="Image utilisateur"/></figure><p id="r-82849" data-claire-element-id="82849">De même que pour les lumières ponctuelles, vous pouvez ajouter une portée limitée à votre projecteur avec la méthode setAttenuation().</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">
<span class="arrow"></span>
<span class="next">Allumez la lumière !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
<span class="next">Les ombres</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesombres"></a><h2>Les ombres</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
<span class="arrow"></span>
<span class="next">Les lumières</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">
<span class="next">La gestion des entrées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-activer-les-ombres" data-claire-element-id="82861">Activer les ombres</h2><p id="r-82853" data-claire-element-id="82853">Tout d'abord, on doit paramétrer nos lumières et nos entités pour projeter (ou non) des ombres.</p><p id="r-82854" data-claire-element-id="82854">Que ce soit pour les lumières ou les entités, on utilise la même méthode pour choisir d'activer ou non la projection :</p><pre id="r-82855" data-claire-element-id="82855"><code data-claire-semantic="cpp">light-&gt;setCastShadows(true);
head-&gt;setCastShadows(true);</code></pre><p id="r-82856" data-claire-element-id="82856">Si vous voulez qu'une entité ne projette aucune ombre, il suffit de mettre le paramètre à <code data-claire-semantic="cpp">false</code>. De même si vous voulez qu'une lumière ne projette aucune ombre pour les entités (pour une lumière d'ambiance ou d'ajustement, par exemple).</p><p id="r-82857" data-claire-element-id="82857">N'oubliez pas de désactiver la projection d'ombres pour le sol. D'une part parce que celui-ci n'a pas besoin de projeter d'ombres, d'autre part parce que certaines techniques nécessitent d'avoir ce paramètre désactivé pour avoir une ombre sur le mesh.</p><p id="r-82858" data-claire-element-id="82858">Avant de pouvoir afficher les ombres, il faut les activer. Cela se fait dans le Scene Manager, par exemple :</p><pre id="r-82859" data-claire-element-id="82859"><code data-claire-semantic="cpp">mSceneMgr-&gt;setShadowTechnique(Ogre::SHADOWTYPE_STENCIL_ADDITIVE);</code></pre><p id="r-82860" data-claire-element-id="82860">On définit ici la technique de rendu qui sera utilisée pour les ombres dans la scène (voir ci-dessous).</p><h2 id="r-les-differents-types-d-ombres" data-claire-element-id="82898">Les différents types d'ombres</h2><p id="r-82862" data-claire-element-id="82862">Ogre permet de générer différents types d'ombres selon les besoins, qui dépendent généralement des modèles concernés par la projection d'ombres.</p><p id="r-82863" data-claire-element-id="82863">Il existe deux techniques pour la génération d'ombres :</p><ul id="r-82868" data-claire-element-id="82868"><li id="r-82865" data-claire-element-id="82865"><p id="r-82864" data-claire-element-id="82864">le type « Stencil » (pochoir en anglais) ;</p></li><li id="r-82867" data-claire-element-id="82867"><p id="r-82866" data-claire-element-id="82866">le type « Texture ».</p></li></ul><p id="r-82869" data-claire-element-id="82869">Les ombres de type Stencil sont très précises dans les contours et permettent une très bonne projection d'ombre lorsque l'on y regarde de près. En revanche, elles sont assez coûteuses en ressources, notamment lorsque les mesh sont animés. Enfin, elles ne prennent pas du tout en compte la transparence des textures, un cube de texture transparente projettera donc une ombre si ce paramètre est activé.<br/> Les ombres de type Texture permettent de gérer la transparence des textures et sont moins coûteuses en ressources, mais leur précision est plus faible.</p><p id="r-82870" data-claire-element-id="82870">Enfin, chacune de ces deux catégories est composée de deux techniques, l'une dite <em>modulative</em>, l'autre <em>additive</em>. On obtient ainsi quatre techniques possibles :</p><ul id="r-82879" data-claire-element-id="82879"><li id="r-82872" data-claire-element-id="82872"><p id="r-82871" data-claire-element-id="82871">SHADOWTYPE_TEXTURE_MODULATIVE</p></li><li id="r-82874" data-claire-element-id="82874"><p id="r-82873" data-claire-element-id="82873">SHADOWTYPE_TEXTURE_ADDITIVE</p></li><li id="r-82876" data-claire-element-id="82876"><p id="r-82875" data-claire-element-id="82875">SHADOWTYPE_STENCIL_MODULATIVE</p></li><li id="r-82878" data-claire-element-id="82878"><p id="r-82877" data-claire-element-id="82877">SHADOWTYPE_STENCIL_ADDITIVE</p></li></ul><p id="r-82880" data-claire-element-id="82880">Notez que dans chacun des cas, la technique additive est la meilleure, notamment pour une approche de type Stencil. La différence pour les techniques de type Texture est minime ; en revanche, la technique Stencil additive permet d'obtenir des ombres plus ou moins sombres en fonction de l'éclairage grâce à des passes successives, tandis que la méthode Stencil modulative ne fait que projeter le modèle au sol une seule fois pour chaque lumière.</p><p id="r-82881" data-claire-element-id="82881">C'est donc dans le Scene Manager que l'on s'occupe de déterminer la technique de rendu des ombres. Par défaut, celles-ci ne sont pas rendues.</p><pre id="r-82882" data-claire-element-id="82882"><code data-claire-semantic="cpp">mSceneMgr-&gt;setShadowTechnique(Ogre::SHADOWTYPE_STENCIL_MODULATIVE);</code></pre><aside id="r-82884" data-claire-element-id="82884" data-claire-semantic="warning"><p id="r-82883" data-claire-element-id="82883">Il n'est possible d'avoir qu'une seule technique enregistrée à la fois dans un Scene Manager. Il n'est pas possible de choisir les types d'ombres à générer pour chaque lumière de la scène. Il faut donc faire un choix pour l'ensemble de vos ombres.</p></aside><p id="r-82885" data-claire-element-id="82885">Ci-dessous, l'approche basée sur la texture, peu précise mais peu coûteuse en ressources :</p><figure id="r-82887" data-claire-element-id="82888"><img id="r-82886" data-claire-element-id="82886" src="medias/uploads.siteduzero.com_files_241001_242000_241467.jpg" alt="Image utilisateur"/></figure><p id="r-82889" data-claire-element-id="82889">Voici ce que l'on obtient avec la technique Stencil modulative (première image) et additive (deuxième image), si l'on met une lumière de chaque coté de la scène à des distances différentes :</p><figure id="r-82891" data-claire-element-id="82892"><img id="r-82890" data-claire-element-id="82890" src="medias/uploads.siteduzero.com_files_241001_242000_241469.jpg" alt="Technique stencil modulative"/></figure><figure id="r-82894" data-claire-element-id="82895"><img id="r-82893" data-claire-element-id="82893" src="medias/uploads.siteduzero.com_files_241001_242000_241466.jpg" alt="Technique stencil additive"/></figure><p id="r-82896" data-claire-element-id="82896">Entités, n?uds, caméras, lumières... Mine de rien, nous avons déjà parcouru un bon nombre d'objets de base que l'on peut insérer dans une scène. Hé vous êtes toujours là ?! On va pouvoir continuer, dans ce cas. ;)</p><p id="r-82897" data-claire-element-id="82897">Dans le prochain chapitre, nous allons notamment nous intéresser à la gestion des entrées clavier / souris et plus généralement à une façon de faire des traitements entre chaque image rendue par Ogre.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
<span class="arrow"></span>
<span class="next">Les lumières</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">
<span class="next">La gestion des entrées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lagestiondesentres"></a><h2>La gestion des entrées</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
<span class="arrow"></span>
<span class="next">Les ombres</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
<span class="next">Les frame listeners</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-82901" data-claire-element-id="82901">Jusqu'ici, nous avons surtout utilisé les objets de base d'Ogre que nous avons intégrés à notre scène petit à petit. On a pu ainsi insérer la tête d'un ogre, symbole du moteur, l'observer sous toutes les coutures en tournant autour...</p><div id="r-82903" data-claire-element-id="82903" data-claire-semantic="question"><p id="r-82902" data-claire-element-id="82902">D'ailleurs, je ne me souviens pas avoir écrit du code pour pouvoir déplacer la caméra. C'est génial Ogre, le clavier et la souris marchent tout seuls !</p></div><p id="r-82904" data-claire-element-id="82904">Chers lecteurs, il est maintenant temps d'apprendre à gérer nous-mêmes les entrées dans notre application, ce qui était jusqu'ici fait par les méthodes de la classe ExampleApplication.</p><p id="r-82905" data-claire-element-id="82905">À la fin de ce chapitre, vous serez aptes à configurer vous-mêmes les touches du clavier que vous souhaitez utiliser, les actions à effectuer lors de l'appui sur une touche, bref vous aurez la mainmise sur les possibilités offertes à l'utilisateur. :soleil:</p>
</div><a name="Lesframelisteners"></a><h2>Les frame listeners</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">
<span class="arrow"></span>
<span class="next">La gestion des entrées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
<span class="next">OIS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-des-ecouteurs-d-images" data-claire-element-id="82939">Des « écouteurs d'images » ?</h2><h3 id="r-utilite" data-claire-element-id="82912">Utilité</h3><p id="r-82906" data-claire-element-id="82906">Comme pour la télévision, tout ce que vous voyez sur l'écran de votre ordinateur n'est qu'une succession d'images affichées les unes après les autres de façon très rapide pour donner l'impression de mouvement à l'oeil. Ogre n'échappe pas à la règle et comme tout moteur graphique, il affiche une image de la scène telle qu'elle est à chaque instant, après avoir fait les éventuels calculs que vous lui aurez demandés.</p><div id="r-82908" data-claire-element-id="82908" data-claire-semantic="question"><p id="r-82907" data-claire-element-id="82907">Bon ok, j'ai bien compris ça, mais quel est le rapport avec la gestion des entrées ?</p></div><p id="r-82909" data-claire-element-id="82909">Lorsque vous gérez les entrées de l'utilisateur (et même pour faire des calculs divers durant l'exécution de votre programme), l'ordinateur effectue les instructions nécessaires entre deux images (ou <em>frames</em> en anglais), donc pendant un temps très court.</p><p id="r-82910" data-claire-element-id="82910">En pratique, le moteur fonctionne dans une boucle, qui ne fait qu'afficher une image, puis faire des calculs ; et ainsi de suite, sans s'arrêter. Il est donc possible pour le programmeur de donner ses instructions avant qu'une image soit rendue, ou bien après, ou bien même pendant que la carte graphique fait le rendu graphique.</p><p id="r-82911" data-claire-element-id="82911">Lorsque l'on aura vu comment créer cette boucle de rendu, nous serons à même de donner les instructions de la manière dont nous le désirons. En attendant, je vais vous présenter une classe qui a l'avantage de permettre de faire tout ce que je viens de vous expliquer de façon très simple : le frame listener.</p><h3 id="r-les-methodes-a-connaitre" data-claire-element-id="82929">Les méthodes à connaître</h3><p id="r-82913" data-claire-element-id="82913">Un frame listener est une classe interface qui possède trois méthodes, dont voici les prototypes :</p><ul id="r-82920" data-claire-element-id="82920"><li id="r-82915" data-claire-element-id="82915"><p id="r-82914" data-claire-element-id="82914"><code data-claire-semantic="cpp">virtual bool frameStarted(const FrameEvent&amp; evt);</code></p></li><li id="r-82917" data-claire-element-id="82917"><p id="r-82916" data-claire-element-id="82916"><code data-claire-semantic="cpp">virtual bool frameRenderingQueued(const FrameEvent&amp; evt);</code></p></li><li id="r-82919" data-claire-element-id="82919"><p id="r-82918" data-claire-element-id="82918"><code data-claire-semantic="cpp">virtual bool frameEnded(const FrameEvent&amp; evt);</code></p></li></ul><p id="r-82921" data-claire-element-id="82921">Chacune de ces méthodes est appelée à un moment précis de la boucle de rendu : avant que la frame ne soit rendue (frameStarted), après que la frame ait été rendue (frameEnded), ou bien juste après que le processeur graphique ait reçu les instructions pour le rendu (frameRenderingQueued).</p><p id="r-82922" data-claire-element-id="82922">En créant un objet dérivé de la classe frame listener dans votre application et en réimplémentant ces méthodes virtuelles, vous avez donc la possibilité de demander à Ogre d'effectuer les calculs dont vous avez besoin à chaque image.</p><div id="r-82924" data-claire-element-id="82924" data-claire-semantic="question"><p id="r-82923" data-claire-element-id="82923">Mais tu nous donnes trois méthodes : comment savoir laquelle choisir ?</p></div><p id="r-82925" data-claire-element-id="82925">Tout d'abord, frameStarted() et frameEnded() sont très similaires, étant donné qu'elles ont pour seule différence d'être appelées respectivement au début et à la fin de la boucle de rendu. Mais comme on est dans une boucle, en réalité il ne se passe quasiment rien entre l'appel à frameEnded() et celui à frameStarted(). La différence peut être utile par exemple si vous avez un calcul qu'il semble plus logique d'effectuer après que l'image soit rendue plutôt qu'avant, mais ce n'est qu'une question de lecture du code selon moi.</p><p id="r-82926" data-claire-element-id="82926">En revanche la dernière est plus subtile. Comme je l'ai dit, elle est appelée dès que la carte graphique reçoit les instructions nécessaires pour afficher l'image à rendre.</p><p id="r-82927" data-claire-element-id="82927">Vous le savez probablement, c'est une opération très coûteuse en ressources et c'est souvent ce qui ralentit les jeux vidéo mettant en jeu de nombreux effets graphiques. Pendant ce temps-là, le processeur central... Eh bien on peut dire qu'il attend que ça se passe. :lol: Par conséquent, si vous appelez la méthode frameRenderingQueued() pour faire des calculs, vous évitez d'avoir un processeur peu occupé pendant que la carte graphique fait son boulot !</p><p id="r-82928" data-claire-element-id="82928">De manière générale, on pourra utiliser cette méthode pour des opérations lourdes dont on sait qu'elles seront répétées à chaque image, afin de rentabiliser l'utilisation du processeur.</p><h3 id="r-controle-de-l-execution" data-claire-element-id="82932">Contrôle de l'exécution</h3><p id="r-82930" data-claire-element-id="82930">La valeur de retour des méthodes d'un frame listener est un booléen récupéré par Ogre pour savoir s'il doit continuer ou non l'exécution du programme.</p><p id="r-82931" data-claire-element-id="82931">Tant que cette valeur est <code data-claire-semantic="cpp">true</code>, le rendu continue. En revanche, si une des méthodes renvoie la valeur <code data-claire-semantic="cpp">false</code>, l'exécution s'interrompt et le programme se ferme.</p><h3 id="r-utiliser-plusieurs-frame-listeners" data-claire-element-id="82938">Utiliser plusieurs frame listeners</h3><p id="r-82933" data-claire-element-id="82933">Il est possible de créer autant de frame listeners que vous le désirez, pour effectuer des opérations diverses. En revanche, il est conseillé de ne pas en abuser pour éviter de trop segmenter votre application, il peut être intéressant d'appeler d'autres fonctions à partir d'un frame listener plutôt que d'en créer trop.</p><p id="r-82934" data-claire-element-id="82934">Enfin, et c'est là le plus important :</p><aside id="r-82936" data-claire-element-id="82936" data-claire-semantic="error"><p id="r-82935" data-claire-element-id="82935">L'ordre d'exécution des frame listeners est laissé aux soins du moteur. Vous n'avez AUCUN contrôle dessus !</p></aside><p id="r-82937" data-claire-element-id="82937">En d'autres termes, si vous avez besoin d'effectuer des opérations dans un ordre précis, ne les mettez pas dans des frame listeners différents, car vous ne pourrez pas décider de l'ordre d'exécution. Il faut alors laisser un seul frame listener gérer les opérations, ou ne pas passer par eux (ce sera possible lorsque nous attaquerons la boucle de rendu).</p><h2 id="r-le-frame-listener-en-pratique" data-claire-element-id="82953">Le frame listener en pratique</h2><p id="r-82940" data-claire-element-id="82940">Comme nous allons vouloir redéfinir les méthodes du frame listener, il faut en faire une classe dérivée. Vu que nous sommes dans la gestion des entrées, nous allons tout de suite préparer le terrain en créant une classe InputListener dérivant de ExampleFrameListener.</p><aside id="r-82942" data-claire-element-id="82942" data-claire-semantic="information"><p id="r-82941" data-claire-element-id="82941">Je dérive ici de la classe ExampleFrameListener, elle-même dérivée de FrameListener, car la classe ExampleApplication met déjà en place une gestion des entrées et attend un ExampleFrameListener. Cette classe s'occupe aussi de construire les objets nécessaires à l'écoute des entrées souris/clavier, ce que nous aborderons ultérieurement.<br/> Cependant, la méthode de traitement reste identique, nous allons juste devoir redéfinir frameRenderingQueued() pour implémenter notre propre gestion des entrées à la place de celle prévue par ExampleFrameListener.</p></aside><pre id="r-82943" data-claire-element-id="82943"><code data-claire-semantic="cpp">#include &quot;ExampleFrameListener.h&quot;

class InputListener : public ExampleFrameListener
{
public:
    InputListener(RenderWindow* win, Camera* cam, SceneManager *sceneMgr, bool bufferedKeys = false, bool bufferedMouse = false, bool bufferedJoy = false );
    virtual bool frameRenderingQueued(const FrameEvent&amp; evt);

private:
    Ogre::SceneManager *mSceneMgr;

    bool mToucheAppuyee;

    Ogre::Real mMouvement;
    Ogre::Real mVitesse;
    Ogre::Real mVitesseRotation;

    Ogre::Radian mRotationX;
    Ogre::Radian mRotationY;
};</code></pre><p id="r-82944" data-claire-element-id="82944">Concernant les attributs indiqués, j'ai tout d'abord inséré un pointeur sur le Scene Manager, qui servira à retrouver des objets dans la scène.</p><p id="r-82945" data-claire-element-id="82945">Le booléen nous sera utile lors de la création d'un interrupteur, pour garder une trace de l'état dans lequel se trouve une touche particulière.</p><p id="r-82946" data-claire-element-id="82946">Ensuite viennent des nombres qui contiendront la distance de déplacement de la caméra et sa vitesse, puis des angles de rotation.</p><p id="r-82947" data-claire-element-id="82947">Dans votre fichier InputListener.cpp, préparez le constructeur ainsi que l'implémentation des méthodes, avec un corps vide pour l'instant :</p><pre id="r-82948" data-claire-element-id="82948"><code data-claire-semantic="cpp">InputListener::InputListener(RenderWindow* win, Camera* cam, SceneManager *sceneMgr, bool bufferedKeys, bool bufferedMouse, bool bufferedJoy) 
       : ExampleFrameListener(win, cam, bufferedKeys, bufferedMouse, bufferedJoy)
{
    mSceneMgr = sceneMgr;
    mVitesse = 100;
    mVitesseRotation = 0.3;
    mToucheAppuyee = false;
}</code></pre><p id="r-82949" data-claire-element-id="82949">Revenons sur le constructeur que je vous propose. Sachez déjà qu'il n'y a pas de constructeur écrit pour les frame listeners, car c'est une classe interface, seules les trois méthodes que j'ai présentées plus haut importent. En revanche, la classe ExampleFrameListener possède un constructeur qui prépare le terrain pour l'utilisation des entrées, que j'appelle dans ma classe dérivée. Mon constructeur prend six paramètres, les trois premiers étant votre RenderWindow pour l'application, la caméra que vous utilisez et le Scene Manager.</p><p id="r-82950" data-claire-element-id="82950">Les trois booléens suivants indiquent si vous désirez utiliser le buffer respectivement pour le clavier, la souris et le joystick. Comme ce sera l'objet de la dernière partie de ce chapitre, je mets par défaut <code data-claire-semantic="cpp">false</code> (dans le .h).</p><p id="r-82951" data-claire-element-id="82951">Dans le corps du constructeur, j'initialise mes attributs mSceneMgr, mVitesse et mToucheAppuyee, qui nous serviront par la suite.</p><p id="r-82952" data-claire-element-id="82952">Il n'y a pas d'attribut à ajouter dans notre classe PremiereApplication, la classe ExampleApplication contient déjà un pointeur sur un ExampleFrameListener.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">
<span class="arrow"></span>
<span class="next">La gestion des entrées</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
<span class="next">OIS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="OIS"></a><h2>OIS</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
<span class="arrow"></span>
<span class="next">Les frame listeners</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
<span class="next">Allons-y sans buffer</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-82955" data-claire-element-id="82955">Pour gérer les entrées de l'utilisateur, nous allons utiliser la bibliothèque OIS (<em>Object Oriented Input System</em>, signifiant Système d'entrées orienté objet), qui est distribuée par défaut avec le SDK d'Ogre. Comme je l'ai dit en introduction de ce cours, un moteur 3D n'a pas de méthodes pour gérer autre chose que ce qui s'affiche sur votre écran, ce n'est pas son but. C'est pourquoi nous utiliserons cette bibliothèque qui s'intègre très bien dans Ogre pour récupérer les actions du joueur.</p><p id="r-82956" data-claire-element-id="82956">Pour ce faire, OIS représente les périphériques d'entrée par des objets, qui sont les suivants :</p><ul id="r-82963" data-claire-element-id="82963"><li id="r-82958" data-claire-element-id="82958"><p id="r-82957" data-claire-element-id="82957"><em>Mouse</em> pour la souris ;</p></li><li id="r-82960" data-claire-element-id="82960"><p id="r-82959" data-claire-element-id="82959"><em>Keyboard</em> pour le clavier ;</p></li><li id="r-82962" data-claire-element-id="82962"><p id="r-82961" data-claire-element-id="82961"><em>Joystick</em> pour les joysticks ou manettes de jeu.</p></li></ul><aside id="r-82965" data-claire-element-id="82965" data-claire-semantic="warning"><p id="r-82964" data-claire-element-id="82964">Qui dit nouvelle bibliothèque dit nouveau namespace ! Ces classes se trouvent donc dans l'espace de nom OIS.</p></aside><p id="r-82966" data-claire-element-id="82966">Les touches du clavier et les boutons de la souris sont des énumérations, définies comme ceci :</p><ul id="r-82971" data-claire-element-id="82971"><li id="r-82968" data-claire-element-id="82968"><p id="r-82967" data-claire-element-id="82967">OIS::KC_<em>NOMDELATOUCHE</em> pour le clavier ;</p></li><li id="r-82970" data-claire-element-id="82970"><p id="r-82969" data-claire-element-id="82969">OIS::MB_<em>NOMDUBOUTON</em> pour la souris.</p></li></ul><p id="r-82972" data-claire-element-id="82972">Ce qui donne par exemple OIS::KC_A pour la touche 'A', ou OIS::MC_Left pour le clic gauche.</p><aside id="r-82974" data-claire-element-id="82974" data-claire-semantic="information"><p id="r-82973" data-claire-element-id="82973">J'en profite pour préciser (si vous voulez expérimenter ensuite) que la touche 'Entrée' s'appelle 'Return' en anglais, ne cherchez donc pas OIS::KC_ENTER, vous ne trouverez pas. ;)</p></aside><aside id="r-82976" data-claire-element-id="82976" data-claire-semantic="warning"><p id="r-82975" data-claire-element-id="82975">Une dernière chose bonne à savoir : les codes de touches d'OIS correspondent aux touches physiques d'un clavier QWERTY. Ce qui signifie par exemple que OIS::KC_A correspond à la touche Q sur votre clavier AZERTY. Je n'ai pour l'instant pas trouvé de moyen de changer ça simplement (sans mapper les touches une par une), mais on s'y accommode, vous verrez. ^^</p></aside><p id="r-82977" data-claire-element-id="82977">Afin d'utiliser OIS, il faut inclure le header correspondant. Celui-ci se trouve dans le dossier OIS du dossier include, on ajoutera donc la ligne de préprocesseur suivante en tête du header de InputListener :</p><pre id="r-82978" data-claire-element-id="82978"><code data-claire-semantic="cpp">#include &lt;OIS/OIS.h&gt;</code></pre><p id="r-82979" data-claire-element-id="82979">Bien sûr, vous pouvez aussi ajouter le répertoire OIS à la liste des includes de votre IDE pour éviter d'avoir à le préciser dans le code.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
<span class="arrow"></span>
<span class="next">Les frame listeners</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
<span class="next">Allons-y sans buffer</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Allons-ysansbuffer"></a><h2>Allons-y sans buffer</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
<span class="arrow"></span>
<span class="next">OIS</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
<span class="next">Avec buffer, c&#039;est plus simple ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-explications-1" data-claire-element-id="82986">Explications</h2><p id="r-82981" data-claire-element-id="82981">Dans le constructeur de notre frame listener, je vous ai dit que l'on avait mis les paramètres concernant l'utilisation du buffer à <code data-claire-semantic="cpp">false</code>, car c'est l'objet de la dernière partie de ce chapitre. Mais que signifie le fait d'utiliser ou non le buffer ?</p><p id="r-82982" data-claire-element-id="82982">Lorsque vous appuyez sur une touche, le clavier envoie un signal à l'ordinateur pour lui dire qu'une touche est actuellement pressée, en précisant quelle touche est concernée. Ce signal est envoyé tant que la touche reste enfoncée.</p><p id="r-82983" data-claire-element-id="82983">De son coté, notre programme effectue sa boucle infinie, rendant les images et faisant les calculs demandés. Supposons que vous appuyez sur une touche à un instant donné. Lorsque l'ordinateur arrivera à l'instruction lui demandant de regarder ce qui se passe sur le clavier, il va voir qu'une touche est enfoncée et cherchera à effectuer les opérations demandées, et ceci tant que la touche reste enfoncée. C'est donc très pratique si l'on veut déplacer la caméra dans la scène par exemple : tant que la touche est enfoncée, on avance d'une certaine distance à chaque tour de boucle.</p><p id="r-82984" data-claire-element-id="82984">Mais imaginons que vous vouliez juste effectuer une action ponctuelle, comme ouvrir votre inventaire, ou bien actionner un interrupteur. En appuyant sur la touche, il y a très peu de chances pour que celle-ci ne reste enfoncée que pendant le temps d'affichage d'une seule image. Le programme va donc actionner une fois l'interrupteur, puis à l'image suivante, la touche étant toujours enfoncée, il va l'actionner à nouveau, et ainsi de suite... Il n'est pas possible pour l'ordinateur de faire seul la différence entre une touche enfoncée et une touche qui vient d'être enfoncée.</p><p id="r-82985" data-claire-element-id="82985">Nous allons donc voir comment régler ce problème « à la main », puis nous verrons l'utilisation du buffer, qui constitue une autre façon de traiter l'entrée.</p><h2 id="r-creation-du-frame-listener" data-claire-element-id="82990">Création du frame listener</h2><p id="r-82987" data-claire-element-id="82987">Avant de passer à la suite, réimplémentez la méthode createFrameListener() présente dans ExampleApplication dans la classe PremiereApplication en ajoutant le prototype et la définition :</p><pre id="r-82988" data-claire-element-id="82988"><code data-claire-semantic="cpp">void PremiereApplication::createFrameListener()
{
    mFrameListener= new InputListener(mWindow, mCamera, mSceneMgr, false, false, false);
    mRoot-&gt;addFrameListener(mFrameListener);
}</code></pre><p id="r-82989" data-claire-element-id="82989">La première ligne crée le frame listener en appelant le constructeur préparé plus tôt ; la seconde indique à l'objet root que nous avons un nouveau frame listener qu'il faudra penser à appeler. Le root est l'élément de base de l'application Ogre qui s'occupe notamment de gérer les frame listeners, nous le reverrons plus tard en approfondissant le fonctionnement du moteur.</p><h2 id="r-deplacer-la-camera" data-claire-element-id="83028">Déplacer la caméra</h2><p id="r-82991" data-claire-element-id="82991">Tout d'abord, nous allons considérer le déplacement de caméra, pour lequel nous n'avons pas besoin de savoir si la touche vient d'être appuyée : c'est simplement son état actuel qui compte.</p><p id="r-82992" data-claire-element-id="82992">Premièrement, il nous faut récupérer l'état actuel du clavier et de la souris. Localisez la méthode frameRenderingQueued() de votre InputListener et insérez-y ceci :</p><pre id="r-82993" data-claire-element-id="82993"><code data-claire-semantic="cpp">if(mMouse)
    mMouse-&gt;capture();
if(mKeyboard)
    mKeyboard-&gt;capture();</code></pre><p id="r-82994" data-claire-element-id="82994">Ces deux lignes permettent de mettre à jour nos objets pour obtenir le nom des touches enfoncées.</p><p id="r-82995" data-claire-element-id="82995">Vérifions d'abord si la touche Echap est utilisée, auquel cas nous quitterons l'application.</p><pre id="r-82996" data-claire-element-id="82996"><code data-claire-semantic="cpp">if(mKeyboard-&gt;isKeyDown(OIS::KC_ESCAPE))
    return false;</code></pre><p id="r-82997" data-claire-element-id="82997">Nous devons ensuite mettre à jour la valeur de mMouvement, qui sera la distance parcourue par la caméra si une direction est choisie. Comme le nombre d'images par seconde est variable, nous utilisons la propriété timeSinceLastFrame de l'événement, multiplié par la vitesse de la caméra. Le produit de la vitesse par le temps écoulé nous donne donc la distance parcourue.</p><p id="r-82998" data-claire-element-id="82998">J'ai aussi créé un vecteur dans lequel nous allons enregistrer les déplacement à effectuer. En effet, on peut utiliser plusieurs touches en même temps, il faut donc additionner les directions demandées, et les conserver pour déplacer la caméra en une seule fois.</p><pre id="r-82999" data-claire-element-id="82999"><code data-claire-semantic="cpp">Ogre::Vector3 deplacement = Ogre::Vector3::ZERO;
mMouvement = mVitesse * evt.timeSinceLastFrame;</code></pre><p id="r-83000" data-claire-element-id="83000">Nous allons utiliser les flèches du clavier et les touches Z, S, Q, D pour nous déplacer ; j'ai aussi implémenté les touches fléchées, qui sont une configuration alternative pour le déplacement. Il faut donc vérifier si les touches qui nous intéressent sont enfoncées :</p><pre id="r-83001" data-claire-element-id="83001"><code data-claire-semantic="cpp">if(mKeyboard-&gt;isKeyDown(OIS::KC_LEFT) || mKeyboard-&gt;isKeyDown(OIS::KC_A)) // La touche A d'un clavier QWERTY correspond au Q sur un AZERTY
    deplacement.x -= mMouvement;
if(mKeyboard-&gt;isKeyDown(OIS::KC_RIGHT) || mKeyboard-&gt;isKeyDown(OIS::KC_D))
    deplacement.x += mMouvement;
if(mKeyboard-&gt;isKeyDown(OIS::KC_UP) || mKeyboard-&gt;isKeyDown(OIS::KC_W)) // W correspond au Z du AZERTY
    deplacement.z -= mMouvement;
if(mKeyboard-&gt;isKeyDown(OIS::KC_DOWN) || mKeyboard-&gt;isKeyDown(OIS::KC_S))
    deplacement.z += mMouvement;</code></pre><aside id="r-83003" data-claire-element-id="83003" data-claire-semantic="warning"><p id="r-83002" data-claire-element-id="83002">Attention aux signes ! Vous devez respecter ce que nous avons vu dans le chapitre sur les déplacements !</p></aside><p id="r-83004" data-claire-element-id="83004">Le déplacement de la caméra fonctionne, il ne manque plus que la rotation de celle-ci. Il nous suffit pour cela de récupérer le déplacement relatif depuis la dernière fois que la souris a bougé (depuis le dernier appel à frameRenderingQueued() donc).</p><p id="r-83005" data-claire-element-id="83005">Pour retrouver cette valeur, on passe successivement par les attributs suivants :</p><ul id="r-83012" data-claire-element-id="83012"><li id="r-83007" data-claire-element-id="83007"><p id="r-83006" data-claire-element-id="83006">le mouseState contenu dans l'objet souris, contenant diverses informations sur l'état de la souris ;</p></li><li id="r-83009" data-claire-element-id="83009"><p id="r-83008" data-claire-element-id="83008">l'axe que l'on désire observer : ici, ce sera X ou Y pour le yaw ou le pitch ;</p></li><li id="r-83011" data-claire-element-id="83011"><p id="r-83010" data-claire-element-id="83010">le déplacement relatif de la souris suivant cet axe.</p></li></ul><p id="r-83013" data-claire-element-id="83013">Maintenant, occupons-nous du mouvement de la souris. Pour récupérer le déplacement de celle-ci, nous devons récupérer son état, comme indiqué dans le code suivant.</p><pre id="r-83014" data-claire-element-id="83014"><code data-claire-semantic="cpp">const OIS::MouseState &amp;mouseState = mMouse-&gt;getMouseState();</code></pre><p id="r-83015" data-claire-element-id="83015">À partir de cette référence on peut notamment récupérer le déplacement de la souris depuis la dernière image, en appelant l'axe X ou Y puis l'attribut rel.</p><pre id="r-83016" data-claire-element-id="83016"><code data-claire-semantic="cpp">mRotationX = Degree(-mouseState.Y.rel * mVitesseRotation);
mRotationY = Degree(-mouseState.X.rel * mVitesseRotation);</code></pre><p id="r-83017" data-claire-element-id="83017">Il faut particulièrement faire attention aux axes et aux signes ici. Je considère que mRotationX (respectivement mRotationY) correspond à la rotation autour de l'axe X (respectivement Y), c'est-à-dire lorsque je déplace ma souris en avant ou en arrière (respectivement à gauche ou à droite). Or, le déplacement vers l'avant ou l'arrière de la souris correspond à son axe Y, c'est pour ça que je demande l'axe Y de la souris pour trouver la rotation autour de X dans l'espace 3D.</p><p id="r-83018" data-claire-element-id="83018">On rajoute une multiplication par la vitesse de rotation voulue et on convertit le tout en degrés, sinon le mouvement est bien trop rapide.</p><p id="r-83019" data-claire-element-id="83019">Enfin, on appelle les méthodes de rotation et de déplacement de la caméra :</p><pre id="r-83020" data-claire-element-id="83020"><code data-claire-semantic="cpp">mCamera-&gt;yaw(mRotationY);
mCamera-&gt;pitch(mRotationX);
mCamera-&gt;moveRelative(deplacement);</code></pre><p id="r-83021" data-claire-element-id="83021">La dernière ligne, comme vous le remarquez, déplace la caméra par rapport à son repère local, ce qui évite de faire la transformation de la variable <em>deplacement</em> à la main. Il est aussi possible de demander un déplacement par rapport au repère absolu avec Camera::move().</p><h3 id="r-et-avec-un-noeud-de-scene" data-claire-element-id="83027">Et avec un noeud de scène ?</h3><p id="r-83022" data-claire-element-id="83022">J'en profite pour vous montrer comment on aurait procédé pour déplacer un noeud de scène par exemple, qui utilise la méthode translate().</p><p id="r-83023" data-claire-element-id="83023">Les deux lignes suivantes sont équivalentes :</p><pre id="r-83024" data-claire-element-id="83024"><code data-claire-semantic="cpp">node-&gt;translate(deplacement, TS_LOCAL);
node-&gt;translate(node-&gt;getOrientation() * deplacement, TS_PARENT);</code></pre><p id="r-83025" data-claire-element-id="83025">La première ligne est très similaire à celle utilisée pour la caméra, il suffit de préciser que l'on se déplace par rapport au repère local du noeud de scène.</p><p id="r-83026" data-claire-element-id="83026">La seconde solution indique un déplacement relatif au noeud parent, mais utilise le quaternion retourné par la méthode getOrientation() multiplié par le vecteur de déplacement pour obtenir la direction souhaitée dans ce repère. En pratique, on utilisera seulement la première ligne, plus courte et plus propre dans le code.</p><h2 id="r-mini-tp-creer-un-interrupteur" data-claire-element-id="83040">Mini-TP : créer un interrupteur</h2><p id="r-83029" data-claire-element-id="83029">Pour gérer un événement qui ne doit arriver qu'une fois lorsque la touche est appuyée, il y a une précaution supplémentaire à prendre. Je vous ai dit plus haut que votre ordinateur ne retenait pas l'état dans lequel se trouvait votre clavier ou votre souris à l'image précédente. Cependant, rien ne nous empêche de le faire nous-mêmes !</p><p id="r-83030" data-claire-element-id="83030">Je vous propose d'écrire ces lignes de code vous-mêmes, avec quelques indications.</p><p id="r-83031" data-claire-element-id="83031">Disons que l'on veut utiliser la touche T pour allumer et éteindre la lumière de notre scène. Il va donc falloir vérifier à chaque image si la touche T est enfoncée, et si en plus ce n'était pas déjà le cas à l'image précédente. Pour cela, on utilisera l'attribut mToucheAppuyee de notre classe InputListener.</p><p id="r-83032" data-claire-element-id="83032">Un indice : le SceneManager possède une méthode getLight() qui permet de récupérer un pointeur sur une lumière à partir du nom de celle-ci... :-°</p><p id="r-83033" data-claire-element-id="83033">À vos claviers ! La réponse se trouve juste après.</p><p id="r-83034" data-claire-element-id="83034"></p><div id="r-83036" data-claire-element-id="83036"><pre id="r-83035" data-claire-element-id="83035"><code data-claire-semantic="cpp">bool etatTouche = mKeyboard-&gt;isKeyDown(OIS::KC_T);

if(etatTouche &amp;&amp; !mToucheAppuyee)
{
    Ogre::Light *light = mSceneMgr-&gt;getLight(&quot;lumiere1&quot;);
    light-&gt;setVisible(!light-&gt;isVisible());
}
mToucheAppuyee = etatTouche;</code></pre></div><p id="r-83037" data-claire-element-id="83037">Vous avez réussi ? Si oui c'est très bien, si non, voyons ensemble le raisonnement.</p><p id="r-83038" data-claire-element-id="83038">Tout d'abord, je récupère l'état actuel de ma touche T dans une variable locale. Je vérifie si la touche est actuellement enfoncée et si elle ne l'était pas déjà à l'aide de l'attribut mToucheAppuyee. Si ma condition est vérifiée, je récupère ma lumière, et je change son état (visible ou non).</p><p id="r-83039" data-claire-element-id="83039">Enfin, j'enregistre l'état actuel de ma touche T dans mToucheAppuyee, en prévision de la prochaine image ! Si je ne faisais pas ça, j'aurais toujours la même valeur pour mon booléen, ce qui n'est pas très utile. :)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
<span class="arrow"></span>
<span class="next">OIS</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
<span class="next">Avec buffer, c&#039;est plus simple ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Avecbufferc039estplussimple"></a><h2>Avec buffer, c&#039;est plus simple ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
<span class="arrow"></span>
<span class="next">Allons-y sans buffer</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">
<span class="next">Gardez les pieds sur terre !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83042" data-claire-element-id="83042">C'est bien beau cette méthode pour retenir si les touches viennent ou non d'être appuyées, mais comment va-t-on faire si l'on veut surveiller l'état de quinze touches différentes ? Je ne sais pas vous, mais je n'ai pas envie de m'embêter à créer quinze variables pour garder une trace de tout ce beau monde, je suis un peu flemmard. :-°</p><p id="r-83043" data-claire-element-id="83043">Heureusement, OIS a pensé à tout, nous allons donc voir une autre façon de faire ce que l'on vient juste d'écrire. On va commencer comme précédemment par le déplacement de la caméra, puis on verra comment gérer notre interrupteur.</p><h2 id="r-mise-en-place-8" data-claire-element-id="83091">Mise en place</h2><p id="r-83044" data-claire-element-id="83044">Nous allons commencer par activer l'utilisation du buffer pour la souris et le clavier lors de la construction de notre frame listener. Il suffit donc de mettre les paramètres correspondants à <code data-claire-semantic="cpp">true</code>.</p><pre id="r-83045" data-claire-element-id="83045"><code data-claire-semantic="cpp">void PremiereApplication::createFrameListener()
{
    mFrameListener= new InputListener(mWindow, mCamera, mSceneMgr, true, true, false);
    mRoot-&gt;addFrameListener(mFrameListener);
}</code></pre><div id="r-83047" data-claire-element-id="83047" data-claire-semantic="question"><p id="r-83046" data-claire-element-id="83046">C'est tout ?</p></div><p id="r-83048" data-claire-element-id="83048">Quasiment, il va simplement falloir rajouter deux petites lignes dans le constructeur pour que tout soit prêt.</p><p id="r-83049" data-claire-element-id="83049">Afin d'utiliser le buffer, il faut fournir un objet (un « écouteur » dérivant d'une des classes OIS::***Listener selon le périphérique à écouter) qui sera celui qui recevra les événements du type <em>&quot;cette touche vient d'être appuyée, que dois-je faire ?&quot;</em>. Pour cela, OIS fournit une méthode pour chacun de trois périphériques d'entrée (clavier, souris, joystick) :</p><ul id="r-83056" data-claire-element-id="83056"><li id="r-83051" data-claire-element-id="83051"><p id="r-83050" data-claire-element-id="83050"><code data-claire-semantic="cpp">virtual void OIS::Mouse::setEventCallback(OIS::MouseListener* mouseListener);</code></p></li><li id="r-83053" data-claire-element-id="83053"><p id="r-83052" data-claire-element-id="83052"><code data-claire-semantic="cpp">virtual void OIS::Keyboard::setEventCallback(OIS::KeyListener* keyListener);</code></p></li><li id="r-83055" data-claire-element-id="83055"><p id="r-83054" data-claire-element-id="83054"><code data-claire-semantic="cpp">virtual void OIS::JoyStick::setEventCallback(OIS::JoyStickListener* joystickListener);</code></p></li></ul><p id="r-83057" data-claire-element-id="83057">Cette méthode prend donc en paramètre un pointeur sur un listener du périphérique que vous voulez utiliser. Nous allons donc rajouter deux classes mères de notre InputListener : OIS::MouseListener et OIS::KeyListener. Modifiez donc la déclaration de la classe InputListener :</p><pre id="r-83058" data-claire-element-id="83058"><code data-claire-semantic="cpp">class InputListener : public ExampleFrameListener, OIS::KeyListener, OIS::MouseListener</code></pre><p id="r-83059" data-claire-element-id="83059">Dans le constructeur, vous pouvez maintenant insérer les deux lignes suivantes (mMouse et mKeyboard sont déclarées dans ExampleFrameListener) :</p><pre id="r-83060" data-claire-element-id="83060"><code data-claire-semantic="cpp">mMouse-&gt;setEventCallback(this);
mKeyboard-&gt;setEventCallback(this);</code></pre><aside id="r-83062" data-claire-element-id="83062" data-claire-semantic="warning"><p id="r-83061" data-claire-element-id="83061">Vous ne pouvez enregistrer qu'un seul écouteur par périphérique d'entrée. En cas d'appels multiples à la méthode setEventCallback(), c'est le dernier appel qui définit l'écouteur à utiliser. Pour que différents objets reçoivent les événements, il faudra donc les redistribuer à partir de l'écouteur receveur.</p></aside><p id="r-83063" data-claire-element-id="83063">Au chapitre des modifications, supprimez les anciens attributs d'InputListener et mettez ceux-ci :</p><pre id="r-83064" data-claire-element-id="83064"><code data-claire-semantic="cpp">private:
    Ogre::SceneManager *mSceneMgr;
    bool mContinuer;

    Ogre::Vector3 mMouvement;
    Ogre::Real mVitesse;
    Ogre::Real mVitesseRotation;</code></pre><p id="r-83065" data-claire-element-id="83065">En initialisant ces attributs, votre constructeur devrait maintenant ressembler à ceci :</p><pre id="r-83066" data-claire-element-id="83066"><code data-claire-semantic="cpp">InputListener(RenderWindow* win, Camera* cam, SceneManager *sceneMgr, bool bufferedKeys = false, bool bufferedMouse = false, bool bufferedJoy = false ) 
   : ExampleFrameListener(win, cam, bufferedKeys, bufferedMouse, bufferedJoy)
{
    mSceneMgr = sceneMgr;
    mContinuer = true;

    mMouvement = Ogre::Vector3::ZERO;
    mVitesse = 100;
    mVitesseRotation = 0.2;

    mMouse-&gt;setEventCallback(this);
    mKeyboard-&gt;setEventCallback(this);
    
}</code></pre><p id="r-83067" data-claire-element-id="83067">L'attribut mContinuer permettra d'enregistrer l'appui sur la touche Echap, mMouvement sera le vecteur de la direction dans laquelle on doit se déplacer et mVitesseRotation un facteur multiplicatif permettant d'ajuster la vitesse de rotation de la caméra.</p><p id="r-83068" data-claire-element-id="83068">On met donc à jour la valeur de retour de la méthode frameRenderingQueued().</p><pre id="r-83069" data-claire-element-id="83069"><code data-claire-semantic="cpp">bool InputListener::frameRenderingQueued(const Ogre::FrameEvent&amp; evt)
{
    if(mMouse)
        mMouse-&gt;capture();
    if(mKeyboard)
        mKeyboard-&gt;capture();
    
    return mContinuer;
}</code></pre><p id="r-83070" data-claire-element-id="83070">Enfin, il y a des méthodes virtuelles pures à réimplémenter dans notre classe. Ces méthodes seront appelées lors de l'événement correspondant sur le clavier (touche enfoncée ou relâchée) ou sur la souris (bouton appuyé ou relâché, déplacement). De même que les méthodes des frame listeners d'Ogre, elles renvoient un booléen que l'on utilisera pour savoir si l'on doit interrompre le programme.</p><p id="r-83071" data-claire-element-id="83071">Ajoutons donc les prototypes dans notre header et un simple retour de valeur dans le corps des méthodes pour commencer.</p><aside id="r-83073" data-claire-element-id="83073" data-claire-semantic="information"><p id="r-83072" data-claire-element-id="83072">Contrairement aux méthodes des frame listeners, la valeur de retour ne détermine pas si l'on doit continuer ou non l'exécution. C'est pour cela que l'on devra passer par l'attribut mContinuer pour surveiller l'appui sur la touche Echap.</p></aside><pre id="r-83074" data-claire-element-id="83074"><code data-claire-semantic="cpp">bool InputListener::mouseMoved(const OIS::MouseEvent &amp;e)
{
    return true;
}
bool InputListener::mousePressed(const OIS::MouseEvent &amp;e, OIS::MouseButtonID id)
{
    return true; 
}
bool InputListener::mouseReleased(const OIS::MouseEvent &amp;e, OIS::MouseButtonID id)
{
    return true;
}
 
bool InputListener::keyPressed(const OIS::KeyEvent &amp;e)
{
    return true;
}
bool InputListener::keyReleased(const OIS::KeyEvent &amp;e)
{
    return true;
}</code></pre><p id="r-83075" data-claire-element-id="83075">On commence par implémenter la touche Echap. Si elle est appuyée, on passe simplement l'attribut mContinuer à <code data-claire-semantic="cpp">false</code>.</p><pre id="r-83076" data-claire-element-id="83076"><code data-claire-semantic="cpp">bool InputListener::keyPressed(const OIS::KeyEvent &amp;e)
{
    switch(e.key)
    {
    case OIS::KC_ESCAPE:
        mContinuer = false;
        break;
    }

    return mContinuer;
}</code></pre><p id="r-83077" data-claire-element-id="83077">On gère ensuite l'appui sur les touches de déplacement en modifiant les composantes de mMouvement en fonction de la touche. On va aussi multiplier la vitesse de déplacement par deux lorsque l'on appuie sur la touche majuscule gauche.</p><pre id="r-83078" data-claire-element-id="83078"><code data-claire-semantic="cpp">bool InputListener::keyPressed(const OIS::KeyEvent &amp;e)
{
    switch(e.key)
    {
    case OIS::KC_ESCAPE:
        mContinuer = false;
        break;
    case OIS::KC_W:
        mMouvement.z -= 1;
        break;
    case OIS::KC_S:
        mMouvement.z += 1;
        break;
    case OIS::KC_A:
        mMouvement.x -= 1;
        break;
    case OIS::KC_D:
        mMouvement.x += 1;
        break;
    case OIS::KC_LSHIFT:
        mVitesse *= 2;
        break;
    }

    return mContinuer;
}</code></pre><p id="r-83079" data-claire-element-id="83079">Enfin, dans la méthode keyReleased, on va « retirer » la composante que l'on ajoute lors de l'appui sur une touche. Le code est donc semblable, seuls les signes changent.</p><pre id="r-83080" data-claire-element-id="83080"><code data-claire-semantic="cpp">bool InputListener::keyReleased(const OIS::KeyEvent &amp;e)
{
    switch(e.key)
    {
    case OIS::KC_W:
        mMouvement.z += 1;
        break;
    case OIS::KC_S:
        mMouvement.z -= 1;
        break;
    case OIS::KC_A:
        mMouvement.x += 1;
        break;
    case OIS::KC_D:
        mMouvement.x -= 1;
        break;
    case OIS::KC_LSHIFT:
        mVitesse /= 2;
        break;
    }
    return true;
}</code></pre><p id="r-83081" data-claire-element-id="83081">Maintenant que l'on gère correctement l'évolution de nos variables de mouvement et de vitesse de déplacement, il faut écrire le déplacement de la caméra dans la méthode frameRenderingQueued().</p><pre id="r-83082" data-claire-element-id="83082"><code data-claire-semantic="cpp">virtual bool frameRenderingQueued(const FrameEvent&amp; evt)
{
    if(mMouse)
        mMouse-&gt;capture();
    if(mKeyboard)
        mKeyboard-&gt;capture();

    Ogre::Vector3 deplacement = Ogre::Vector3::ZERO;
    deplacement = mMouvement * mVitesse * evt.timeSinceLastFrame;
    mCamera-&gt;moveRelative(deplacement);

    return mContinuer;
}</code></pre><p id="r-83083" data-claire-element-id="83083">Pour la rotation de la caméra, tout se passe dans la méthode mouseMoved(), dont l'événement reçu en paramètre contient l'état de la souris, permettant comme précédemment de retrouver le déplacement relatif de la souris.</p><p id="r-83084" data-claire-element-id="83084">On multiplie cette valeur relative par la vitesse de rotation, on fait attention aux signes, et voici ce qu'on obtient :</p><pre id="r-83085" data-claire-element-id="83085"><code data-claire-semantic="cpp">bool InputListener::mouseMoved(const OIS::MouseEvent &amp;e)
{
    mCamera-&gt;yaw(Ogre::Degree(-mVitesseRotation * e.state.X.rel));
    mCamera-&gt;pitch(Ogre::Degree(-mVitesseRotation * e.state.Y.rel));
    return true;
}</code></pre><p id="r-83086" data-claire-element-id="83086">Vous pouvez maintenant compiler et exécuter votre application ; les commandes de déplacement sont maintenant gérées entièrement par notre classe InputListener, n'hésitez donc pas à adapter les variables initialisées dans le constructeur si vous voulez accélérer ou ralentir les mouvements par exemple.</p><p id="r-83087" data-claire-element-id="83087">Cette méthode de gestion des entrées permet donc de gérer plus facilement l'appui ponctuel sur une touche, tout en conservant une gestion simple des touches qui peuvent rester enfoncées (pour le déplacement ici).</p><p id="r-83088" data-claire-element-id="83088">Gardez cependant bien à l'esprit, comme je l'ai précisé au début, qu'il ne peut y avoir qu'un seul écouteur par périphérique d'entrée et qu'il faudra donc penser à rapporter l'appui sur les touches à des écouteurs annexes lorsque votre application grossira, sinon vous allez vite vous retrouver avec un code lourd et mal organisé.<br/> Mais vous êtes déjà des programmeurs avisés et bien organisés, vous n'aurez donc pas de problème pour appliquer ces quelques conseils, j'en suis certain. ;)</p><p id="r-83089" data-claire-element-id="83089">Dans ce chapitre, nous avons vu comment gérer nous-mêmes les entrées de l'utilisateur avec la bibliothèque OIS, ainsi que le principe des frame listeners, qui nous ont ici été bien utiles alors que nous n'avons pas encore vu le fonctionnement de la boucle de rendu.</p><p id="r-83090" data-claire-element-id="83090">Le prochain chapitre promet d'être intéressant : nous allons en effet utiliser le module de terrain d'Ogre qui a été refait dans la version 1.7 et qui offre une gestion beaucoup plus optimisée des terrains par rapport aux versions précédentes. Je n'en dis pas plus, on se retrouve de l'autre côté.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
<span class="arrow"></span>
<span class="next">Allons-y sans buffer</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">
<span class="next">Gardez les pieds sur terre !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gardezlespiedssurterre"></a><h2>Gardez les pieds sur terre !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
<span class="arrow"></span>
<span class="next">Avec buffer, c&#039;est plus simple ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
<span class="next">Créer un terrain</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-83094" data-claire-element-id="83094">Lorsque l'on réalise un environnement 3D, l'une des composantes récurrentes de la scène est sans aucun doute le terrain environnant accompagné du ciel au-dessus de nos têtes (pour les extérieurs, en tout cas).</p><p id="r-83095" data-claire-element-id="83095">Sans outil particulier, créer un terrain pourrait relever d'un travail de longue haleine si l'on devait créer le mesh dans les moindres détails pour l'insérer ensuite à la scène. La gestion d'une telle entité serait aussi relativement complexe, puisqu'il doit pouvoir interagir avec tous les objets susceptibles de se déplacer dans la scène.</p><p id="r-83096" data-claire-element-id="83096">Heureusement, plutôt que de placer notre terrain comme une simple entité dans la scène, Ogre propose de passer par une classe Terrain qui, comme son nom l'indique si bien, permet de gérer des terrains dans la scène.</p><p id="r-83097" data-claire-element-id="83097">Comme je le disais, le terrain n'est généralement pas seul et le ciel joue un rôle important pour le réalisme de la scène. Là encore, quelques outils bienvenus offrent différentes solutions pour obtenir un résultat convaincant.</p>
</div><a name="Crerunterrain"></a><h2>Créer un terrain</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">
<span class="arrow"></span>
<span class="next">Gardez les pieds sur terre !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
<span class="next">Le plaquage de texture</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-preparation-1" data-claire-element-id="83108">Préparation</h2><p id="r-83098" data-claire-element-id="83098">Avant de commencer, il va falloir modifier un peu notre projet avec de nouvelles dépendances pour que les terrains soient utilisables.</p><p id="r-83099" data-claire-element-id="83099">Dans l'éditeur de lien, ajoutez le fichier librairie <code>OgreTerrain.lib</code> (ou bien <code>OgreTerrain_d.lib</code> si vous compilez en debug).</p><p id="r-83100" data-claire-element-id="83100">Il faut maintenant ajouter un fichier en-tête dans notre classe :</p><pre id="r-83101" data-claire-element-id="83101"><code data-claire-semantic="cpp">#include &lt;Ogre/Terrain/OgreTerrain.h&gt;</code></pre><p id="r-83102" data-claire-element-id="83102">Enfin, si vous ne les avez pas déjà placées dans le répertoire de votre exécutable, copiez ces 2 DLL dans le dossier correspondant à votre configuration (les DLL de debug se terminent aussi par « _d ») :</p><ul id="r-83107" data-claire-element-id="83107"><li id="r-83104" data-claire-element-id="83104"><p id="r-83103" data-claire-element-id="83103">OgreTerrain.dll</p></li><li id="r-83106" data-claire-element-id="83106"><p id="r-83105" data-claire-element-id="83105">OgrePaging.dll</p></li></ul><h2 id="r-quelques-parametres-a-regler" data-claire-element-id="83129">Quelques paramètres à régler</h2><p id="r-83109" data-claire-element-id="83109">Commençons par ajouter deux attributs dans notre classe PremiereApplication. Un objet Terrain, qui gérera les propriétés de notre terrain, puis un objet TerrainGlobalOptions, qui définit des propriétés générales pour les terrains dans notre application, notamment l'éclairage.</p><aside id="r-83111" data-claire-element-id="83111" data-claire-semantic="warning"><p id="r-83110" data-claire-element-id="83110">La présence de cet objet TerrainGlobalOptions est obligatoire lorsque vous voulez utiliser les terrains dans votre scène, sous peine d'erreur à l'exécution.</p></aside><pre id="r-83112" data-claire-element-id="83112"><code data-claire-semantic="cpp">Ogre::Terrain *mTerrain;
Ogre::TerrainGlobalOptions *mGlobals;</code></pre><p id="r-83113" data-claire-element-id="83113">Au début de la méthode createScene(), nous allons régler quelques paramètres pour que notre terrain apparaisse sous son meilleur jour.</p><p id="r-83114" data-claire-element-id="83114">Premièrement, je vous conseille d'augmenter la distance de vue de la caméra et de la positionner en hauteur :</p><pre id="r-83115" data-claire-element-id="83115"><code data-claire-semantic="cpp">mCamera-&gt;setFarClipDistance(20000);
mCamera-&gt;setPosition(0, 500, 0);</code></pre><p id="r-83116" data-claire-element-id="83116">Il est aussi possible de régler la distance de vue à l'infini, en mettant 0 comme paramètre. Cependant, cela dépend de votre machine, il faut donc vérifier si vous pouvez vous le permettre avant de l'appliquer.</p><pre id="r-83117" data-claire-element-id="83117"><code data-claire-semantic="cpp">if (mRoot-&gt;getRenderSystem()-&gt;getCapabilities()-&gt;hasCapability(Ogre::RSC_INFINITE_FAR_PLANE))
    mCamera-&gt;setFarClipDistance(0);</code></pre><p id="r-83118" data-claire-element-id="83118">On peut ensuite définir un éclairage d'ambiance particulier pour le terrain dans Ogre, plutôt que de le gérer de façon distincte. Pour cela, il suffit de définir une lumière directionnelle avec les paramètres qui vous paraissent adaptés à votre environnement. J'ai ajouté cette lumière en tant qu'attribut de ma classe, car je l'utiliserai dans une autre fonction.</p><pre id="r-83119" data-claire-element-id="83119"><code data-claire-semantic="cpp">Ogre::Vector3 lightdir(0.55f, -0.3f, 0.75f);
mLight = mSceneMgr-&gt;createLight(&quot;terrainLight&quot;);
mLight-&gt;setType(Ogre::Light::LT_DIRECTIONAL);
mLight-&gt;setDirection(lightdir);
mLight-&gt;setDiffuseColour(Ogre::ColourValue::White);
mLight-&gt;setSpecularColour(Ogre::ColourValue(0.4f, 0.4f, 0.4f));</code></pre><p id="r-83120" data-claire-element-id="83120">Pour garder un peu d'ordre dans le code, nous allons définir une méthode createTerrain(), qui sera appelée dans createScene() et qui prendra en charge toute l'initialisation du terrain.</p><p id="r-83121" data-claire-element-id="83121">À l'intérieur de celle-ci, commencez par créer le TerrainGlobalOptions :</p><pre id="r-83122" data-claire-element-id="83122"><code data-claire-semantic="cpp">void PremiereApplication::createTerrain()
{
    mGlobals = OGRE_NEW Ogre::TerrainGlobalOptions();
    mGlobals-&gt;setMaxPixelError(8);
}</code></pre><div id="r-83124" data-claire-element-id="83124" data-claire-semantic="question"><p id="r-83123" data-claire-element-id="83123">Doucement, d'où il sort ce OGRE_NEW ? Pourquoi tu n'utilises pas tout simplement <code data-claire-semantic="cpp">new</code> pour créer ton objet ?</p></div><p id="r-83125" data-claire-element-id="83125">C'est en effet le premier objet d'Ogre que nous allons créer nous-mêmes, sans passer par l'intermédiaire du Scene Manager.<br/> Le moteur fournit différentes macros pour allouer l'espace en mémoire lorsque vous instanciez une classe d'Ogre. De façon générale, les développeurs conseillent d'utiliser ces macros lorsque vous devez faire de l'allocation dynamique sur les objets du moteur qui dérivent de Ogre::AllocatedObject. Vous pouvez voir la hiérarchie des classes dans <a href="http://www.ogre3d.org/docs/api/html/hierarchy.html">la documentation</a>.<br/> En ce qui concerne la destruction des objets, l'utilisation de l'opérateur OGRE_NEW implique l'utilisation de l'opérateur OGRE_DELETE pour libérer l'espace mémoire.</p><p id="r-83126" data-claire-element-id="83126">La seconde ligne appelle la méthode setMaxPixelError() qui donne la précision avec laquelle le terrain est rendu. La valeur indiquée est l'erreur tolérée, en pixels, pour l'affichage du terrain. Plus la valeur est faible, plus le terrain correspond au modèle donné, plus elle est forte et plus il sera imprécis, en donnant l'impression d'un terrain nivelé.</p><p id="r-83127" data-claire-element-id="83127">On applique maintenant les réglages concernant l'éclairage à nos options globales.</p><pre id="r-83128" data-claire-element-id="83128"><code data-claire-semantic="cpp">mGlobals-&gt;setLightMapDirection(mLight-&gt;getDerivedDirection());
mGlobals-&gt;setCompositeMapDistance(3000);
mGlobals-&gt;setCompositeMapAmbient(mSceneMgr-&gt;getAmbientLight());
mGlobals-&gt;setCompositeMapDiffuse(mLight-&gt;getDiffuseColour());</code></pre><h2 id="r-le-terrain" data-claire-element-id="83224">Le terrain</h2><p id="r-83130" data-claire-element-id="83130">Maintenant, passons à la création du terrain lui-même. Comme pour les options du terrain, nous ne passons pas par une méthode du Scene Manager pour créer le terrain, mais par le constructeur de la classe, qui prend tout de même en paramètre le Scene Manager de votre scène.</p><pre id="r-83131" data-claire-element-id="83131"><code data-claire-semantic="cpp">mTerrain = OGRE_NEW Ogre::Terrain(mSceneMgr);</code></pre><p id="r-83132" data-claire-element-id="83132">Il faut à présent définir précisément les paramètres de notre terrain : son relief, sa taille et ses textures.</p><div id="r-83134" data-claire-element-id="83134" data-claire-semantic="question"><p id="r-83133" data-claire-element-id="83133">Comment est-ce que je vais définir le relief de mon terrain ? Je veux bien le modéliser sous Blender, mais je suis pas très fort en modélisation... Et je ne me vois pas coder tout avec Ogre. Tu n'as pas une recette magique sous le coude ? :magicien:</p></div><p id="r-83135" data-claire-element-id="83135">Il suffit de demander ! Il est temps que je vous parle des heightmaps !</p><h3 id="r-les-heightmaps" data-claire-element-id="83153">Les heightmaps</h3><p id="r-83136" data-claire-element-id="83136">Une heightmap, qu'est-ce que c'est ?</p><p id="r-83137" data-claire-element-id="83137">En traduisant littéralement, ou pourrait appeler ça une « carte du relief » ou « carte de l'altitude ». En d'autre termes, c'est une image qui contient des informations de relief.</p><p id="r-83138" data-claire-element-id="83138">On les utilise pour stocker le relief d'un terrain, mais aussi pour connaitre le relief d'une texture, afin de donner l'impression de relief sur un mesh alors qu'en réalité il est plat ou simplement lisse (c'est le principe du <a href="http://fr.wikipedia.org/wiki/Placage_de_relief">bump mapping</a>).</p><p id="r-83139" data-claire-element-id="83139">Cette méthode a le principal avantage d'être très légère en terme de stockage, puisque l'on a simplement une image à la place d'un modèle 3D complet qui prendrait beaucoup plus d'espace à stocker.</p><div id="r-83141" data-claire-element-id="83141" data-claire-semantic="question"><p id="r-83140" data-claire-element-id="83140">Ok, ok. Mais à quoi elle ressemble, cette image ? :colere:</p></div><p id="r-83142" data-claire-element-id="83142">Voici l'image que nous allons utiliser pour notre terrain :</p><figure id="r-83144" data-claire-element-id="83145"><img id="r-83143" data-claire-element-id="83143" src="medias/uploads.siteduzero.com_files_248001_249000_248540.png" alt="Image utilisateur"/></figure><p id="r-83146" data-claire-element-id="83146">Comme vous le voyez c'est une simple image en noir et blanc, et pourtant cela suffit amplement !</p><p id="r-83147" data-claire-element-id="83147">En effet, si l'on utilise uniquement des niveaux de gris dans une image, chaque pixel peut prendre 256 valeurs, 0 correspondant au noir et à la hauteur la plus faible, 255 au blanc et à la plus forte altitude. On a donc 256 altitudes possibles pour notre terrain, ce qui est tout à fait honnête et suffit à la majorité des cas.</p><aside id="r-83149" data-claire-element-id="83149" data-claire-semantic="information"><p id="r-83148" data-claire-element-id="83148">J'ai un peu simplifié l'explication ici. En réalité, chaque pixel possède trois valeurs, correspondant à la quantité de rouge, de vert et de bleu, chacune de ces valeurs allant de 0 à 255. Or pour les niveaux de gris, ces trois valeurs doivent être identiques, ce qui laisse 255 triplets de valeurs : (0, 0, 0) pour le noir, puis les niveaux de gris et enfin (255, 255, 255) pour le blanc).</p></aside><p id="r-83150" data-claire-element-id="83150">Lors de la création d'un fichier heightmap, on fait en sorte que le point le plus haut de notre carte soit blanc et que le point le plus bas soit noir, afin d'utiliser toute la plage de valeurs disponibles dans la carte et éviter les dénivellations peu naturelles.</p><p id="r-83151" data-claire-element-id="83151">Pour charger un fichier heightmap, on passe par un objet Image qui va chercher le nom du fichier que vous voulez dans les ressources déjà chargées. J'utilise le fichier terrain.png, que vous pouvez trouver dans &quot;OgreSDK\media\materials extures&quot;.</p><pre id="r-83152" data-claire-element-id="83152"><code data-claire-semantic="cpp">Ogre::Image img;
img.load(&quot;terrain.png&quot;, Ogre::ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME);</code></pre><h3 id="r-les-parametres-geometriques" data-claire-element-id="83163">Les paramètres géométriques</h3><p id="r-83154" data-claire-element-id="83154">Pour fournir toutes les informations dont le terrain a besoin pour être généré, on utilise sa méthode prepare() qui prend en paramètre un Terrain::ImportData, qui est en gros une classe contenant l'ensemble des paramètres à fournir au terrain. On va donc commencer par créer cet objet :</p><pre id="r-83155" data-claire-element-id="83155"><code data-claire-semantic="cpp">Ogre::Terrain::ImportData imp;
imp.inputImage = &amp;img;
imp.terrainSize = img.getWidth();
imp.worldSize = 8000;
imp.inputScale = 600;
imp.minBatchSize = 33;
imp.maxBatchSize = 65;</code></pre><p id="r-83156" data-claire-element-id="83156">On commence par récupérer l'image et sa taille avec les lignes 2 et 3. Étant donné que les terrains sont carrés, votre image doit elle aussi être carrée, faites attention à cela.</p><p id="r-83157" data-claire-element-id="83157">Ensuite, le paramètre worldSize indique la taille du terrain, c'est-à-dire la longueur de ses côtés en unités de la scène. Plus ce nombre est grand, plus l'image est agrandie.</p><p id="r-83158" data-claire-element-id="83158">Le nombre suivant correspond à l'échelle adoptée pour l'altitude du terrain. C'est la hauteur qui sépare un point de la carte représenté par un pixel noir d'un point représenté par un pixel blanc. Il doit donc être choisi en parallèle avec la taille du monde, puisque s'il est trop élevé et que le monde est trop petit, vous aurez un relief très escarpé.</p><p id="r-83159" data-claire-element-id="83159">Les deux dernières valeurs renseignent les tailles minimale et maximale de batch pour notre terrain.</p><div id="r-83161" data-claire-element-id="83161" data-claire-semantic="question"><p id="r-83160" data-claire-element-id="83160">Tu pourrais articuler un peu plus, je ne comprends pas tout... :euh:</p></div><p id="r-83162" data-claire-element-id="83162">Oui, d'accord : ce point mérite un petit paragraphe théorique, au moins pour les plus curieux d'entre vous. :D</p><h3 id="r-la-batch-size" data-claire-element-id="83179">La Batch Size</h3><p id="r-83164" data-claire-element-id="83164">Le mot anglais <em>batch</em> signifie « lot » ou « paquet ». Dans notre cas, qu'est-ce que cela signifie ?</p><p id="r-83165" data-claire-element-id="83165">Vous savez probablement (et je vous l'ai rappelé, si vous avez suivi ;) ) que l'affichage de modèle 3D à l'écran consomme beaucoup de ressources. Dans le cas d'un paysage extérieur, si vous avez un champ de vision très dégagé, vous êtes censés pouvoir voir beaucoup d'éléments du paysage à l'écran, ce qui fait un travail colossal pour votre ordinateur, surtout s'il doit calculer la position de chaque brin d'herbe à l'horizon !</p><div id="r-83167" data-claire-element-id="83167" data-claire-semantic="question"><p id="r-83166" data-claire-element-id="83166">Tu sais, moi, les brins d'herbe qui sont à plus de 100 mètres, je ne les vois pas, alors je passerai l'éponge si mon ordinateur ne les affiche pas...</p></div><p id="r-83168" data-claire-element-id="83168">C'est précisément ce qui se passe dans de telles conditions. Plutôt que de chercher à calculer dans les moindres détails la façon dont apparaît la pelouse à l'autre bout du paysage, pour ensuite ne l'afficher que sur une toute petite surface de l'écran, le moteur va simplifier les choses et calculer de façon grossière l'affichage de ces objets.</p><p id="r-83169" data-claire-element-id="83169">Ainsi, les textures peuvent être simplifiées, mais aussi les meshs, dont l'ordinateur va réduire le nombre de vertices pour avoir moins de calculs à faire, vu que vous ne voyez pas les détails (on parle aussi de niveau de détail, ou LOD.</p><p id="r-83170" data-claire-element-id="83170">Pour un terrain, le maillage pourrait donc avoir un aspect similaire à celui-ci (image issue du <a href="http://www.ogre3d.org/tikiwiki/-LOD&amp;highlight=level of detail">wiki d'Ogre3D.org</a>) :</p><figure id="r-83172" data-claire-element-id="83173"><img id="r-83171" data-claire-element-id="83171" src="medias/uploads.siteduzero.com_files_248001_249000_248573.jpg" alt="Image utilisateur"/></figure><p id="r-83174" data-claire-element-id="83174">La zone où se situe la caméra est la plus détaillée, le reste est simplifié.</p><p id="r-83175" data-claire-element-id="83175">La taille de batch vous permet donc d'indiquer à quel degré cette simplification se fait.</p><p id="r-83176" data-claire-element-id="83176">Le terrain est divisé en lots, donc la taille varie en fonction de la distance de la caméra à ces lots. Plus on s'éloigne, plus le lot est simplifié par suppression de vertices. Lorsque plusieurs lots atteignent une taille minimale, ils sont regroupés en un seul lot, qui est à son tour simplifié progressivement si la caméra continue de reculer.</p><p id="r-83177" data-claire-element-id="83177">Si la taille minimum de batch est faible, les lots adjacents auront plus facilement un niveau de détail équivalent, mais il y aura plus de lots à gérer par l'ordinateur. En revanche, si elle est élevée, on regroupe plus rapidement les lots, mais les frontières entre ceux-ci sont plus facilement visibles, car le niveau de détail peut varier plus fortement.</p><p id="r-83178" data-claire-element-id="83178">Les valeurs que j'ai mises sont des valeurs courantes, sachez juste que la taille maximum est de 65 et qu'elles doivent obéir à la formule suivante :<br/>taille = 2^n + 1</p><h3 id="r-mise-en-place-des-textures" data-claire-element-id="83197">Mise en place des textures</h3><p id="r-83180" data-claire-element-id="83180">Pour gérer les textures, l'outil Terrain d'Ogre utilise des calques. Chacun de ces calques correspond à une texture, que vous pourrez ensuite appliquer où bon vous semblera.</p><p id="r-83181" data-claire-element-id="83181">Comme on parle de calques, autant vous dire tout de suite qu'il est possible de les superposer, de donner plus ou moins d'intensité à un calque, pour créer des effets élaborés.</p><p id="r-83182" data-claire-element-id="83182">Nous allons commencer avec une seule texture pour faire simple et assimiler le principe. Tout se fait à l'aide de notre importateur de données :</p><pre id="r-83183" data-claire-element-id="83183"><code data-claire-semantic="cpp">imp.layerList.resize(1);
imp.layerList[0].worldSize = 100;
imp.layerList[0].textureNames.push_back(&quot;grass_green-01_diffusespecular.dds&quot;);
imp.layerList[0].textureNames.push_back(&quot;grass_green-01_normalheight.dds&quot;);</code></pre><p id="r-83184" data-claire-element-id="83184">Ici les fonctions sont relativement explicites, pour les anglophones en tout cas. :p</p><p id="r-83185" data-claire-element-id="83185">La première ligne donne la taille de la liste de calques, ici je n'en ai mis qu'un seul. La seconde ligne donne la taille de la texture dans le monde. Plus le nombre est important, plus la texture sera zoomée, et inversement.</p><p id="r-83186" data-claire-element-id="83186">Les deux lignes suivantes insèrent chacune une texture dans notre calque (textureNames est un vector).</p><div id="r-83188" data-claire-element-id="83188" data-claire-semantic="question"><p id="r-83187" data-claire-element-id="83187">Deux textures ? Je croyais qu'on mettait les textures sur des calques différents ?</p></div><p id="r-83189" data-claire-element-id="83189">En fait, on devrait plutôt dire qu'un calque contient un matériau.</p><p id="r-83190" data-claire-element-id="83190">Les matériaux sont faits avec deux textures :</p><ul id="r-83195" data-claire-element-id="83195"><li id="r-83192" data-claire-element-id="83192"><p id="r-83191" data-claire-element-id="83191">une texture diffuse, qui contient les couleurs, les motifs du matériau ;</p></li><li id="r-83194" data-claire-element-id="83194"><p id="r-83193" data-claire-element-id="83193">une texture normale, contenant des informations sur le relief du matériau.</p></li></ul><p id="r-83196" data-claire-element-id="83196">La combinaison de ces deux textures permet d'avoir un matériau complet.</p><h3 id="r-filtrage-anisotrope" data-claire-element-id="83217">Filtrage anisotrope</h3><p id="r-83198" data-claire-element-id="83198">Pendant que je suis au point sur les textures, je vais revenir rapidement sur le niveau de détail, qui est réglable pour les matériaux via le filtrage de texture.</p><p id="r-83199" data-claire-element-id="83199">Vous pouvez donc régler la netteté du placage de textures sur vos meshs via un niveau de filtrage.</p><p id="r-83200" data-claire-element-id="83200">On peut distinguer quatre options de filtrages, de la plus grossière à la plus précise :</p><ul id="r-83209" data-claire-element-id="83209"><li id="r-83202" data-claire-element-id="83202"><p id="r-83201" data-claire-element-id="83201">aucun filtrage ;</p></li><li id="r-83204" data-claire-element-id="83204"><p id="r-83203" data-claire-element-id="83203">bilinéaire ;</p></li><li id="r-83206" data-claire-element-id="83206"><p id="r-83205" data-claire-element-id="83205">trilinéaire ;</p></li><li id="r-83208" data-claire-element-id="83208"><p id="r-83207" data-claire-element-id="83207">anisotrope.</p></li></ul><p id="r-83210" data-claire-element-id="83210">Voici la différence entre un filtrage anisotrope (à gauche) et une texture sans filtrage (à droite). La différence est relativement subtile ici mais visible tout de même.</p><p id="r-83211" data-claire-element-id="83212"><a href="medias/uploads.siteduzero.com_files_249001_250000_249264.jpg"><img id="r-83212" data-claire-element-id="83211" src="medias/uploads.siteduzero.com_thb_249001_250000_249264.jpg" alt="Image utilisateur"/></a></p><p id="r-83213" data-claire-element-id="83213">Je vous propose donc d'opter pour un filtrage anisotrope, avec une valeur de 8 (la valeur par défaut est 1 et équivaut à l'absence de filtrage). Vous devez donc rajouter ces deux lignes dans votre code, au début de la méthode createScene() par exemple.</p><pre id="r-83214" data-claire-element-id="83214"><code data-claire-semantic="cpp">Ogre::MaterialManager::getSingleton().setDefaultTextureFiltering(Ogre::TFO_ANISOTROPIC);
Ogre::MaterialManager::getSingleton().setDefaultAnisotropy(8);</code></pre><aside id="r-83216" data-claire-element-id="83216" data-claire-semantic="information"><p id="r-83215" data-claire-element-id="83215">Le filtrage de textures n'est pas propre uniquement aux terrains, mais affecte toutes les textures affichées par le moteur.</p></aside><h3 id="r-chargement-et-nettoyage" data-claire-element-id="83223">Chargement et nettoyage</h3><p id="r-83218" data-claire-element-id="83218">Une fois que les paramètres ont été définis dans l'ImportData, il ne reste qu'à préparer et charger le terrain :</p><pre id="r-83219" data-claire-element-id="83219"><code data-claire-semantic="cpp">mTerrain-&gt;prepare(imp);
mTerrain-&gt;load();</code></pre><p id="r-83220" data-claire-element-id="83220">Pour terminer et faire un peu de place en mémoire, il est conseillé d'appeler la méthode suivante qui se chargera de libérer la mémoire allouée temporairement pour la création de votre terrain. Placez donc cette ligne à la fin de la méthode createTerrain().</p><pre id="r-83221" data-claire-element-id="83221"><code data-claire-semantic="cpp">mTerrain-&gt;freeTemporaryResources();</code></pre><p id="r-83222" data-claire-element-id="83222">Compilez et lancez l'application pour obtenir un joli paysage !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">
<span class="arrow"></span>
<span class="next">Gardez les pieds sur terre !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
<span class="next">Le plaquage de texture</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Leplaquagedetexture"></a><h2>Le plaquage de texture</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
<span class="arrow"></span>
<span class="next">Créer un terrain</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
<span class="next">Et si on en veut plus ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83226" data-claire-element-id="83226">Je l'ai dit plus haut, Ogre nous permet d'utiliser différents calques pour nos matériaux. La bonne nouvelle dans tout cela, c'est qu'on va pouvoir faire comme à l'école : mettre les calques les uns sur les autres, modifier leur opacité pour avoir une texture plus ou moins visible, tout en décidant de la zone où l'on veut appliquer la texture.</p><p id="r-83227" data-claire-element-id="83227">La première étape consiste à rajouter des calques dans notre liste, avant de créer le terrain. Remplacez donc le bloc que vous aviez par le code suivant, afin d'ajouter deux nouveaux matériaux.</p><pre id="r-83228" data-claire-element-id="83228"><code data-claire-semantic="cpp">imp.layerList.resize(3);
imp.layerList[0].worldSize = 100;
imp.layerList[0].textureNames.push_back(&quot;grass_green-01_diffusespecular.dds&quot;);
imp.layerList[0].textureNames.push_back(&quot;grass_green-01_normalheight.dds&quot;);
imp.layerList[1].worldSize = 30;
imp.layerList[1].textureNames.push_back(&quot;growth_weirdfungus-03_diffusespecular.dds&quot;);
imp.layerList[1].textureNames.push_back(&quot;growth_weirdfungus-03_normalheight.dds&quot;);
imp.layerList[2].worldSize = 200;
imp.layerList[2].textureNames.push_back(&quot;dirt_grayrocky_diffusespecular.dds&quot;);
imp.layerList[2].textureNames.push_back(&quot;dirt_grayrocky_normalheight.dds&quot;);
mTerrain-&gt;prepare(imp);
mTerrain-&gt;load();</code></pre><p id="r-83229" data-claire-element-id="83229">Si vous exécutez le code maintenant, rien n'aura changé sur votre terrain. Par défaut, c'est uniquement le premier matériau qui est affiché. Il est donc nécessaire d'ajouter quelques lignes pour dire de quelle façon nous voulons faire notre plaquage de texture.</p><p id="r-83230" data-claire-element-id="83230">Le principe est assez simple à comprendre si on y va petit à petit. Chaque calque d'un terrain possède un objet TerrainLayerBlendMap (que j'appellerai dorénavant Blend Map) qui exprime la façon dont le calque est fusionné avec les calques inférieurs (le calque le plus bas est le calque 0).</p><p id="r-83231" data-claire-element-id="83231">Cette fusion est simplement une affaire de transparence. Les calques sont placés les uns sur les autres, et la composante transparente indique si la texture en dessous est plus ou moins visible. Il est de plus possible de faire varier la transparence du calque en chaque point de celui-ci, ce qui permet d'avoir un placage par zone.</p><p id="r-83232" data-claire-element-id="83232">À la suite du bloc de code précédent, commencez par récupérer les Blend Map correspondant au calque numéro 1, que nous venons d'ajouter (nous nous occuperons du second ensuite).</p><pre id="r-83233" data-claire-element-id="83233"><code data-claire-semantic="cpp">Ogre::TerrainLayerBlendMap* blendMap1 = mTerrain-&gt;getLayerBlendMap(1);</code></pre><p id="r-83234" data-claire-element-id="83234">Nous allons commencer par plaquer une seule texture au-dessus de l'herbe, sur toute la surface de notre terrain.</p><p id="r-83235" data-claire-element-id="83235">L'idée est de parcourir l'ensemble des points du calque avec deux boucles <code data-claire-semantic="cpp">for</code> (il y a autant de points qu'il y avait de pixels dans notre heightmap) et de leur attribuer la transparence désirée, entre 1 (totalement opaque) et 255 (transparent).</p><aside id="r-83237" data-claire-element-id="83237" data-claire-semantic="error"><p id="r-83236" data-claire-element-id="83236">La valeur la plus faible est bien 1 et non 0. Si vous mettez 0, la texture est transparente !</p></aside><pre id="r-83238" data-claire-element-id="83238"><code data-claire-semantic="cpp">float* pBlend1 = blendMap1-&gt;getBlendPointer();
for (Ogre::uint16 y = 0; y &lt; mTerrain-&gt;getLayerBlendMapSize(); ++y)
{
    for (Ogre::uint16 x = 0; x &lt; mTerrain-&gt;getLayerBlendMapSize(); ++x)
    {
        *pBlend1++ = 150; // opacité désirée pour le point courant
    }
}</code></pre><p id="r-83239" data-claire-element-id="83239">Pour terminer, il faut mettre à jour notre Blend Map en appelant les méthodes dirty() puis update(). La première sert à préciser que les données de la Blend map sont obsolètes et doivent être mises à jour, tandis que la seconde fait effectivement la mise à jour.</p><aside id="r-83241" data-claire-element-id="83241" data-claire-semantic="information"><p id="r-83240" data-claire-element-id="83240">Si vous n'appelez pas d'abord dirty(), update() n'aura aucun effet.</p></aside><pre id="r-83242" data-claire-element-id="83242"><code data-claire-semantic="cpp">blendMap1-&gt;dirty();
blendMap1-&gt;update();</code></pre><p id="r-83243" data-claire-element-id="83243">Je vous mets le code complet de la méthode createTerrain() si vous voulez vérifier que tout est en ordre :</p><p id="r-83244" data-claire-element-id="83244"></p><div id="r-83246" data-claire-element-id="83246"><pre id="r-83245" data-claire-element-id="83245"><code data-claire-semantic="cpp">mTerrain = OGRE_NEW Ogre::Terrain(mSceneMgr);

// options globales
mGlobals = OGRE_NEW Ogre::TerrainGlobalOptions();
mGlobals-&gt;setMaxPixelError(10);
mGlobals-&gt;setCompositeMapDistance(8000);
mGlobals-&gt;setLightMapDirection(mLight-&gt;getDerivedDirection());
mGlobals-&gt;setCompositeMapAmbient(mSceneMgr-&gt;getAmbientLight());
mGlobals-&gt;setCompositeMapDiffuse(mLight-&gt;getDiffuseColour());

Ogre::Image img;
img.load(&quot;terrain.png&quot;, Ogre::ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME);

// informations géométriques
Ogre::Terrain::ImportData imp;
imp.inputImage = &amp;img;
imp.terrainSize = img.getWidth();
imp.worldSize = 8000;
imp.inputScale = 600;
imp.minBatchSize = 33;
imp.maxBatchSize = 65;

// textures
imp.layerList.resize(3);
imp.layerList[0].worldSize = 100;
imp.layerList[0].textureNames.push_back(&quot;grass_green-01_diffusespecular.dds&quot;);
imp.layerList[0].textureNames.push_back(&quot;grass_green-01_normalheight.dds&quot;);
imp.layerList[1].worldSize = 30;
imp.layerList[1].textureNames.push_back(&quot;growth_weirdfungus-03_diffusespecular.dds&quot;);
imp.layerList[1].textureNames.push_back(&quot;growth_weirdfungus-03_normalheight.dds&quot;);
imp.layerList[2].worldSize = 200;
imp.layerList[2].textureNames.push_back(&quot;dirt_grayrocky_diffusespecular.dds&quot;);
imp.layerList[2].textureNames.push_back(&quot;dirt_grayrocky_normalheight.dds&quot;);
mTerrain-&gt;prepare(imp);
mTerrain-&gt;load();

// plaquage de texture
Ogre::TerrainLayerBlendMap* blendMap1 = mTerrain-&gt;getLayerBlendMap(1);
float* pBlend1 = blendMap1-&gt;getBlendPointer();

for (Ogre::uint16 y = 0; y &lt; mTerrain-&gt;getLayerBlendMapSize(); ++y)
{
    for (Ogre::uint16 x = 0; x &lt; mTerrain-&gt;getLayerBlendMapSize(); ++x)
    {
        *pBlend1++ = 150;
    }
}

blendMap1-&gt;dirty();
blendMap1-&gt;update();

mTerrain-&gt;freeTemporaryResources();</code></pre></div><p id="r-83247" data-claire-element-id="83247">Vous pouvez maintenant exécuter l'application ! Profitez-en pour vérifier en vous approchant du sol que l'on distingue bien l'herbe et par-dessus la terre. ^^</p><figure id="r-83249" data-claire-element-id="83250"><img id="r-83248" data-claire-element-id="83248" src="medias/uploads.siteduzero.com_files_248001_249000_248855.jpg" alt="Image utilisateur"/></figure><div id="r-83252" data-claire-element-id="83252" data-claire-semantic="question"><p id="r-83251" data-claire-element-id="83251">Mais c'est moche ! o_O</p></div><p id="r-83253" data-claire-element-id="83253">D'accord, la forme n'est pas terrible. Mais le principe y est, c'est un début.</p><p id="r-83254" data-claire-element-id="83254">On va tout de suite essayer de faire quelque chose de plus esthétique. ^^</p><p id="r-83255" data-claire-element-id="83255">Pour cela, maintenant que vous avez saisi les grandes étapes, je vous propose un mini-TP pour vous entraîner.</p><h2 id="r-au-boulot-1" data-claire-element-id="83278">Au boulot !</h2><h3 id="r-objectif-2" data-claire-element-id="83261">Objectif</h3><p id="r-83256" data-claire-element-id="83256">Une image vaut sûrement mieux qu'un long discours, voici donc ce que vous allez devoir obtenir :</p><figure id="r-83258" data-claire-element-id="83259"><img id="r-83257" data-claire-element-id="83257" src="medias/uploads.siteduzero.com_files_248001_249000_248854.jpg" alt="Image utilisateur"/></figure><p id="r-83260" data-claire-element-id="83260">L'idée est de texturer le terrain en fonction de l'altitude. Si l'on est en dessous d'un certain seuil, il n'y a que de la terre qui apparaît ; au-dessus, on a de l'herbe.</p><h3 id="r-indications" data-claire-element-id="83270">Indications</h3><p id="r-83262" data-claire-element-id="83262">Vous n'avez pas besoin de grand-chose pour faire cela, simplement quelques secondes de réflexion !</p><p id="r-83263" data-claire-element-id="83263">Je vous donne tout de même les méthodes qui sont utiles, notamment pour trouver l'altitude du terrain en fonction de la position :</p><pre id="r-83264" data-claire-element-id="83264"><code data-claire-semantic="cpp">float Ogre::Terrain::getHeightAtTerrainPosition(Ogre::Real x, Ogre::Real y)</code></pre><p id="r-83265" data-claire-element-id="83265">Cette fonction retourne l'altitude en fonction de la position, sachant que x et y sont compris entre 0 et 1.</p><p id="r-83266" data-claire-element-id="83266">Pour récupérer ces deux valeurs, on utilise une méthode de TerrainLayerBlendMap qui convertit les coordonnées de l'image en coordonnées du terrain (celles dont vous avez besoin) :</p><pre id="r-83267" data-claire-element-id="83267"><code data-claire-semantic="cpp">void Ogre::TerrainLayerBlendMap::convertImageToTerrainSpace(size_t x, size_t y, Ogre::Real * outX, Ogre::Real * outY)</code></pre><p id="r-83268" data-claire-element-id="83268">Enfin, je vous laisse choisir l'altitude limite entre l'herbe et la terre : si vous avez bien suivi la création du terrain, vous devriez trouver tout seuls une valeur opportune. ;)</p><p id="r-83269" data-claire-element-id="83269">Vous avez toutes les cartes en mains maintenant. Vous avez 10 minutes !</p><h3 id="r-correction-34" data-claire-element-id="83277">Correction</h3><p id="r-83271" data-claire-element-id="83271">Comme avez dû le deviner, tout se passe dans les deux boucles <code data-claire-semantic="cpp">for</code>.</p><p id="r-83272" data-claire-element-id="83272">Pour chaque point parcouru, on recherche ses coordonnées dans le repère du terrain, puis on récupère la hauteur, que l'on compare à notre hauteur limite. Si on est en dessous, on affiche la texture de terre avec une opacité maximum, sinon on ne fait qu'incrémenter le pointeur de la Blend map.</p><p id="r-83273" data-claire-element-id="83273">Voici donc le code modifié :</p><pre id="r-83274" data-claire-element-id="83274"><code data-claire-semantic="cpp">for (Ogre::uint16 y = 0; y &lt; mTerrain-&gt;getLayerBlendMapSize(); ++y)
{
    for (Ogre::uint16 x = 0; x &lt; mTerrain-&gt;getLayerBlendMapSize(); ++x)
    {
        Ogre::Real terrainX, terrainY;

        blendMap1-&gt;convertImageToTerrainSpace(x, y, &amp;terrainX, &amp;terrainY);
        Ogre::Real height = mTerrain-&gt;getHeightAtTerrainPosition(terrainX, terrainY);

        if(height &lt; 200)
            *pBlend1 = 1;

        pBlend1++;
    }
}</code></pre><aside id="r-83276" data-claire-element-id="83276" data-claire-semantic="information"><p id="r-83275" data-claire-element-id="83275">Vous pouvez aussi bien sûr récupérer la Blend map numéro 2 plus haut pour voir le résultat avec une autre texture, c'est ce que j'ai fait pour obtenir l'image référence pour le TP.</p></aside><h2 id="r-pour-aller-plus-loin-3" data-claire-element-id="83307">Pour aller plus loin</h2><p id="r-83279" data-claire-element-id="83279">Sur le même principe, nous allons voir comment appliquer deux textures différentes sur une petite largeur, à une altitude donnée.</p><p id="r-83280" data-claire-element-id="83280">Ceci peut être utile si vous voulez réaliser des étendues d'eau dans votre terrain : au bord de l'eau, il y a de la boue, un peu au-dessus, de la terre sèche, puis ensuite l'herbe reprend ses droits. C'est ce que nous allons faire, avec une opacité progressive, mais sans l'eau, ce sera pour plus tard. :D</p><p id="r-83281" data-claire-element-id="83281">Nous devons commencer par récupérer un pointeur sur notre seconde Blend Map pour pouvoir gérer la seconde texture en plus de la première. Il y a donc deux lignes à rajouter en conséquence avant les boucles.</p><pre id="r-83282" data-claire-element-id="83282"><code data-claire-semantic="cpp">Ogre::TerrainLayerBlendMap* blendMap1 = mTerrain-&gt;getLayerBlendMap(1);
Ogre::TerrainLayerBlendMap* blendMap2 = mTerrain-&gt;getLayerBlendMap(2);</code></pre><pre id="r-83283" data-claire-element-id="83283"><code data-claire-semantic="cpp">float* pBlend1 = blendMap1-&gt;getBlendPointer();
float* pBlend2 = blendMap2-&gt;getBlendPointer();</code></pre><p id="r-83284" data-claire-element-id="83284">Définissons aussi deux variables pour chacune des textures : la hauteur à laquelle se situe la texture et la largeur de la bande que l'on veut obtenir.</p><pre id="r-83285" data-claire-element-id="83285"><code data-claire-semantic="cpp">Ogre::Real minHeight1 = 70;
Ogre::Real fadeDist1 = 40;
Ogre::Real minHeight2 = 70;
Ogre::Real fadeDist2 = 15;</code></pre><p id="r-83286" data-claire-element-id="83286">Dans la boucle, on déclare trois variables : deux coordonnées du terrain et la transparence pour le point actuel.</p><pre id="r-83287" data-claire-element-id="83287"><code data-claire-semantic="cpp">Ogre::Real terrainX, terrainY, transparence;</code></pre><p id="r-83288" data-claire-element-id="83288">On récupère ensuite la hauteur du terrain comme précédemment.</p><pre id="r-83289" data-claire-element-id="83289"><code data-claire-semantic="cpp">blendMap1-&gt;convertImageToTerrainSpace(x, y, &amp;terrainX, &amp;terrainY);
Ogre::Real height = mTerrain-&gt;getHeightAtTerrainPosition(terrainX, terrainY);</code></pre><p id="r-83290" data-claire-element-id="83290">Ensuite, pour chaque texture, on calcule la différence entre la hauteur du point actuel et la hauteur que l'on veut pour la texture, divisée par la largeur de la bande. Si le point est censé être recouvert par la texture, ce nombre sera donc compris entre 0 et 1.</p><p id="r-83291" data-claire-element-id="83291">On utilise ensuite la méthode statique Clamp() qui a pour prototype :</p><pre id="r-83292" data-claire-element-id="83292"><code data-claire-semantic="cpp">static T Ogre::Math::Clamp(T val, T minval, T maxval)</code></pre><p id="r-83293" data-claire-element-id="83293">Si val est inférieure à minval, la fonction retourne minval ; si val est supérieure à maxval, on retourne maxval. Si val est dans l'intervalle, on la retourne directement.</p><p id="r-83294" data-claire-element-id="83294">Comme on ne veut afficher que les points donc la valeur calculée précédemment est comprise entre 0 et 1, on va utiliser cette méthode pour « couper » toutes les valeurs en dehors de l'intervalle.</p><pre id="r-83295" data-claire-element-id="83295"><code data-claire-semantic="cpp">transparence = (height - minHeight1) / fadeDist1;
transparence = Ogre::Math::Clamp(transparence, (Ogre::Real)0, (Ogre::Real)1);</code></pre><p id="r-83296" data-claire-element-id="83296">Pour terminer, on multiplie transparence par 255 pour avoir une valeur comprise entre 0 et 255.</p><pre id="r-83297" data-claire-element-id="83297"><code data-claire-semantic="cpp">*pBlend1++ = transparence * 255;</code></pre><aside id="r-83299" data-claire-element-id="83299" data-claire-semantic="information"><p id="r-83298" data-claire-element-id="83298">On observe que si transparence est à l'extérieur de l'intervalle [0 ; 1] après le premier calcul, Clamp retournera 0 ou 1. Quand on multiplie par 255, on obtient donc 0 ou 255, qui sont les deux valeurs pour lesquelles la texture est transparente. Mission accomplie !</p></aside><p id="r-83300" data-claire-element-id="83300">On copie ces trois lignes pour la seconde texture, et on obtient le code suivant dans nos boucles :</p><pre id="r-83301" data-claire-element-id="83301"><code data-claire-semantic="cpp">for (Ogre::uint16 y = 0; y &lt; mTerrain-&gt;getLayerBlendMapSize(); ++y)
{
    for (Ogre::uint16 x = 0; x &lt; mTerrain-&gt;getLayerBlendMapSize(); ++x)
    {
        Ogre::Real terrainX, terrainY, transparence;

        blendMap1-&gt;convertImageToTerrainSpace(x, y, &amp;terrainX, &amp;terrainY);
        Ogre::Real height = mTerrain-&gt;getHeightAtTerrainPosition(terrainX, terrainY);

        transparence = (height - minHeight1) / fadeDist1;
        transparence = Ogre::Math::Clamp(transparence, (Ogre::Real)0, (Ogre::Real)1);
        *pBlend1++ = transparence * 255;

        transparence = (height - minHeight2) / fadeDist2;
        transparence = Ogre::Math::Clamp(transparence, (Ogre::Real)0, (Ogre::Real)1);
        *pBlend2++ = transparence * 255;
    }
}</code></pre><p id="r-83302" data-claire-element-id="83302">Pensez à mettre à jour la seconde Blend Map une fois que les modifications sont terminées :</p><pre id="r-83303" data-claire-element-id="83303"><code data-claire-semantic="cpp">blendMap1-&gt;dirty();
blendMap2-&gt;dirty();
blendMap1-&gt;update();
blendMap2-&gt;update();</code></pre><figure id="r-83305" data-claire-element-id="83306"><img id="r-83304" data-claire-element-id="83304" src="medias/uploads.siteduzero.com_files_248001_249000_248857.jpg" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
<span class="arrow"></span>
<span class="next">Créer un terrain</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
<span class="next">Et si on en veut plus ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Etsionenveutplus"></a><h2>Et si on en veut plus ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
<span class="arrow"></span>
<span class="next">Le plaquage de texture</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
<span class="next">Un ciel au-dessus de nos têtes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-les-groupes-de-terrains" data-claire-element-id="83311">Les groupes de terrains</h2><p id="r-83309" data-claire-element-id="83309">Un groupe de terrains range les terrains comme dans un tableau à deux dimensions, on obtient donc un système de coordonnées du groupe de terrains pour retrouver chacun des terrains contenus dans celui-ci.</p><p id="r-83310" data-claire-element-id="83310">Dans le groupe, tous les terrains ont la même taille, afin de pouvoir les aligner dans une grille. Vous ne pouvez donc pas créer des terrains de tailles diverses pour les ranger dans un TerrainGroup.</p><h2 id="r-creation-4" data-claire-element-id="83335">Création</h2><p id="r-83312" data-claire-element-id="83312">On commence par ajouter un include au début de la classe puis on remplace notre instance de Terrain par un TerrainGroup, ensuite on l'initialisera dans notre méthode createTerrain() :</p><pre id="r-83313" data-claire-element-id="83313"><code data-claire-semantic="cpp">#include &lt;Ogre/Terrain/OgreTerrainGroup.h&gt;

//...

Ogre::TerrainGroup *mTerrainGroup;</code></pre><p id="r-83314" data-claire-element-id="83314">Après les lignes permettant de charger l'image heightmap dans la méthode createTerrain(), insérez les lignes suivantes.</p><pre id="r-83315" data-claire-element-id="83315"><code data-claire-semantic="cpp">mTerrainGroup = OGRE_NEW Ogre::TerrainGroup(mSceneMgr, Ogre::Terrain::ALIGN_X_Z, img.getWidth(), 8000);
mTerrainGroup-&gt;setOrigin(Ogre::Vector3::ZERO);
mTerrainGroup-&gt;setFilenameConvention(Ogre::String(&quot;TerrainDuZero&quot;), Ogre::String(&quot;dat&quot;));</code></pre><p id="r-83316" data-claire-element-id="83316">Les paramètres à fournir au TerrainGroup sont le Scene manager, l'alignement du terrain par rapport au repère global (vous pouvez créer un terrain vertical, par exemple), la taille des heightmaps utilisées et la taille d'un terrain.</p><p id="r-83317" data-claire-element-id="83317">On définit ensuite la position de l'origine du groupe de terrains, puis le nom (et l'extension) que l'on veut attribuer à nos fichiers qui seront créés pour sauvegarder les terrains par la suite.</p><p id="r-83318" data-claire-element-id="83318">Pour les données des terrains enregistrées dans un objet ImportData, nous allons modifier un peu le fonctionnement du programme. On récupère en fait directement une référence sur un ImportData fourni par le TerrainGroup, que l'on modifie directement et qui sera valable pour l'ensemble des terrains du groupe. À noter que la ligne de définition de la heightmap n'est plus utile ici, cela sera indiqué lors de la création des terrains.</p><pre id="r-83319" data-claire-element-id="83319"><code data-claire-semantic="cpp">Ogre::Terrain::ImportData&amp; imp = mTerrainGroup-&gt;getDefaultImportSettings();
imp.terrainSize = img.getWidth();
imp.worldSize = 8000;
imp.inputScale = 600;
imp.minBatchSize = 33;
imp.maxBatchSize = 65;</code></pre><p id="r-83320" data-claire-element-id="83320">Il est maintenant temps de créer les terrains du groupe. On définit la taille du groupe et pour chaque case, on appelle une méthode definirTerrain() définie plus bas qui s'occupera de créer chaque terrain indépendamment.</p><pre id="r-83321" data-claire-element-id="83321"><code data-claire-semantic="cpp">int largeur = 2, longueur = 2;
for(int x = 0; x &lt; largeur; x++)
{
    for(int y = 0; y &lt; longueur; y++)
    {
        definirTerrain(x, y);
    }
}

mTerrainGroup-&gt;loadAllTerrains(true);</code></pre><p id="r-83322" data-claire-element-id="83322">Le groupe se charge pour terminer d'appeler les méthodes load() de chaque terrain à travers la méthode loadAllTerrains(). Cette méthode prend un booléen en paramètre qui indique si le chargement doit être synchrone, c'est-à-dire exécuté dans un seul thread (le thread principal ici). Par défaut cette valeur est fausse, c'est-à-dire que les terrains sont chargés dans plusieurs threads si c'est possible.</p><aside id="r-83324" data-claire-element-id="83324" data-claire-semantic="warning"><p id="r-83323" data-claire-element-id="83323">Le chargement devient vite très lourd si l'on ajoute beaucoup de terrains aux groupes. Nous verrons plus bas comment accélérer le chargement.</p></aside><p id="r-83325" data-claire-element-id="83325">Maintenant, nous devons écrire la méthode definirTerrain() qui utilise la méthode defineTerrain() de TerrainGroup. Celle-ci va prendre 3 paramètres : les deux coordonnées du terrain dans le groupe de terrains (sa position sur la grille, donc) et l'image heightmap utilisée pour ce terrain. Les coordonnées du terrain au sein du groupe peuvent être négatives.</p><p id="r-83326" data-claire-element-id="83326">Juste avant d'appeler le terrain, on va faire une vérification sur les coordonnées : si l'abscisse du terrain est impaire, on inverse l'image suivant l'axe Y, si l'ordonnée est impaire, on inverse l'image cette fois-ci selon l'axe X. Cela permet aux terrains du groupe de ne pas avoir de différence d'altitude lors des jointures. Si vous utilisez des heightmaps différents sur les terrains du groupe (ce qui sera probablement le cas), vous devrez faire attention à ce que les altitudes des bords correspondent pour éviter les trous à ces endroits.</p><pre id="r-83327" data-claire-element-id="83327"><code data-claire-semantic="cpp">void PremiereApplication::definirTerrain(int x, int y)
{
    Ogre::Image img;
    img.load(&quot;terrain.png&quot;, Ogre::ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME);
    if(x % 2 != 0)
        img.flipAroundY();
    if(y % 2 != 0)
        img.flipAroundX();
    mTerrainGroup-&gt;defineTerrain(x, y, &amp;img);
}</code></pre><p id="r-83328" data-claire-element-id="83328">Une fois que les terrains sont chargés, il faut leur appliquer les textures définies. On utilise pour cela un itérateur sur le groupe de terrains et, pour chaque terrain, on appelle une méthode initBlendMaps() qui contient le code pour texturer les terrains.</p><pre id="r-83329" data-claire-element-id="83329"><code data-claire-semantic="cpp">Ogre::TerrainGroup::TerrainIterator ti = mTerrainGroup-&gt;getTerrainIterator();
while(ti.hasMoreElements())
{
    Ogre::Terrain* t = ti.getNext()-&gt;instance;
    initBlendMaps(t);
}</code></pre><p id="r-83330" data-claire-element-id="83330">La méthode initBlendMaps() contient uniquement du code que l'on a déjà vu mais que j'ai déplacé pour plus de clarté. Elle prend en paramètre le terrain dont on doit modifier les Blend maps.</p><pre id="r-83331" data-claire-element-id="83331"><code data-claire-semantic="cpp">void PremiereApplication::initBlendMaps(Ogre::Terrain *terrain)
{
    Ogre::TerrainLayerBlendMap* blendMap1 = terrain-&gt;getLayerBlendMap(1);
    Ogre::TerrainLayerBlendMap* blendMap2 = terrain-&gt;getLayerBlendMap(2);
    Ogre::Real minHeight1 = 70;
    Ogre::Real fadeDist1 = 40;
    Ogre::Real minHeight2 = 70;
    Ogre::Real fadeDist2 = 15;
    float* pBlend1 = blendMap1-&gt;getBlendPointer();
    float* pBlend2 = blendMap2-&gt;getBlendPointer();

    for (Ogre::uint16 y = 0; y &lt; terrain-&gt;getLayerBlendMapSize(); ++y)
    {
        for (Ogre::uint16 x = 0; x &lt; terrain-&gt;getLayerBlendMapSize(); ++x)
        {
            Ogre::Real terrainX, terrainY, transparence;

            blendMap1-&gt;convertImageToTerrainSpace(x, y, &amp;terrainX, &amp;terrainY);
            Ogre::Real height = terrain-&gt;getHeightAtTerrainPosition(terrainX, terrainY);

            transparence = (height - minHeight1) / fadeDist1;
            transparence = Ogre::Math::Clamp(transparence, (Ogre::Real)0, (Ogre::Real)1);
            *pBlend1++ = transparence * 255;

            transparence = (height - minHeight2) / fadeDist2;
            transparence = Ogre::Math::Clamp(transparence, (Ogre::Real)0, (Ogre::Real)1);
            *pBlend2++ = transparence * 255;
        }
    }
    blendMap1-&gt;dirty();
    blendMap2-&gt;dirty();
    blendMap1-&gt;update();
    blendMap2-&gt;update();
}</code></pre><p id="r-83332" data-claire-element-id="83332">Pour terminer, comme avec un terrain seul, on libère la mémoire utilisée par le TerrainGroup.</p><pre id="r-83333" data-claire-element-id="83333"><code data-claire-semantic="cpp">mTerrainGroup-&gt;freeTemporaryResources();</code></pre><p id="r-83334" data-claire-element-id="83334">Votre scène doit maintenant avoir une surface plus grande que la première fois (on a maintenant quatre terrains). Vous pouvez encore augmenter le nombre de terrains, mais attention, le temps de chargement augmente rapidement !</p><h2 id="r-optimiser-le-temps-de-chargement" data-claire-element-id="83353">Optimiser le temps de chargement</h2><p id="r-83336" data-claire-element-id="83336">Vous avez certainement remarqué que la génération du terrain prend un temps conséquent lorsque le groupe s'agrandit. La création du terrain à partir du fichier heightmap nécessite en effet de convertir les données de l'image en données exploitables par le moteur.</p><p id="r-83337" data-claire-element-id="83337">Afin de réduire le temps de chargement, il est possible d'enregistrer un fichier qui contient toutes les informations sur le terrain construit pour éviter de relire l'image à chaque lancement de l'application. L'inconvénient majeur est la place occupée par ces fichiers générés, qui contiennent beaucoup plus d'informations qu'une simple heightmap.</p><p id="r-83338" data-claire-element-id="83338">En regardant la création du groupe de terrains, vous voyez que l'on a défini une convention de nommage pour des fichiers, mais qui est pour l'instant inutilisée.</p><pre id="r-83339" data-claire-element-id="83339"><code data-claire-semantic="cpp">mTerrainGroup-&gt;setFilenameConvention(Ogre::String(&quot;TerrainDuZero&quot;), Ogre::String(&quot;dat&quot;));</code></pre><p id="r-83340" data-claire-element-id="83340">Cette ligne sert lors de la sauvegarde de fichiers de terrain : ceux-ci seront nommés en commençant par « TerrainDuZero » suivi d'un nombre permettant d'identifier le terrain, puis de l'extension de fichier « dat ».</p><p id="r-83341" data-claire-element-id="83341">Pour utiliser la sauvegarde des terrains, nous allons ajouter un attribut mTerrainCreated à la classe PremiereApplication qui permettra de savoir si l'on a généré le terrain à partir d'une image ou bien si l'on a lu un fichier terrain. Dans le premier cas, on saura qu'à la fin de la méthode createTerrain() il faut penser à sauvegarder les fichiers de terrain pour le prochain lancement de l'application.</p><pre id="r-83342" data-claire-element-id="83342"><code data-claire-semantic="cpp">bool mTerrainCreated;</code></pre><p id="r-83343" data-claire-element-id="83343">Initialisez sa valeur à <code data-claire-semantic="cpp">false</code> au début de la méthode createTerrain().</p><p id="r-83344" data-claire-element-id="83344">Maintenant, dans notre méthode definirTerrain(), il faut vérifier si le fichier terrain existe déjà ou bien s'il faut faire la génération depuis le heightmap comme le faisait jusqu'alors. Dans le second cas, on passe la variable mTerrainCreated à <code data-claire-semantic="cpp">true</code>.</p><pre id="r-83345" data-claire-element-id="83345"><code data-claire-semantic="cpp">void PremiereApplication::definirTerrain(int x, int y)
{
    if(Ogre::ResourceGroupManager::getSingleton().resourceExists(mTerrainGroup-&gt;getResourceGroup(), mTerrainGroup-&gt;generateFilename(x, y)))
    {
        mTerrainGroup-&gt;defineTerrain(x, y);
    }
    else
    {
        Ogre::Image img;
        img.load(&quot;terrain.png&quot;, Ogre::ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME);
        if(x % 2 != 0)
            img.flipAroundY();
        if(y % 2 != 0)
            img.flipAroundX();
        mTerrainGroup-&gt;defineTerrain(x, y, &amp;img);
        mTerrainCreated = true;
    }
}</code></pre><p id="r-83346" data-claire-element-id="83346">Revenons sur la condition à tester pour vérifier l'existence du fichier généré.</p><p id="r-83347" data-claire-element-id="83347">Grâce au Ogre::ResourceGroupManager, on peut vérifier s'il existe une ressource précise dans l'ensemble des ressources chargées au démarrage du programme. Les paramètres de la méthode sont le groupe de ressources dans lequel on veut chercher la ressource ainsi que le nom du fichier recherché. Vous voyez que le nom du fichier généré par le groupe de terrains dépend de ses coordonnées X et Y, ainsi que de la convention que l'on a définie au début.</p><p id="r-83348" data-claire-element-id="83348">Si le fichier est trouvé, on appelle la méthode definieTerrain() avec seulement les coordonnées en paramètres. Dans ce cas, Ogre va aller chercher directement le fichier correspondant à ces coordonnées. Dans le cas contraire, on exécute le bloc que l'on avait précédemment et qui charge le terrain à partir de l'image de heightmap.</p><p id="r-83349" data-claire-element-id="83349">Il ne reste plus qu'à demander la sauvegarde des fichiers si l'on a généré les terrains juste avant de libérer les ressources dans la méthode createTerrain() :</p><pre id="r-83350" data-claire-element-id="83350"><code data-claire-semantic="cpp">if(mTerrainCreated)
    mTerrainGroup-&gt;saveAllTerrains(true);</code></pre><p id="r-83351" data-claire-element-id="83351">Lancez l'application, le temps de chargement doit être un peu plus long qu'auparavant car l'ordinateur sauvegarde en même temps les fichiers générés sur le disque. Une fois que l'application est lancée, fermez-la puis relancez-la. Le temps de chargement doit normalement être meilleur.</p><p id="r-83352" data-claire-element-id="83352">Vous devriez trouver les fichiers générés dans le dossier OgreSDK\media. Pour information, les miens font chacun une taille de 12 Mo.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
<span class="arrow"></span>
<span class="next">Le plaquage de texture</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
<span class="next">Un ciel au-dessus de nos têtes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Uncielau-dessusdenosttes"></a><h2>Un ciel au-dessus de nos têtes</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
<span class="arrow"></span>
<span class="next">Et si on en veut plus ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">
<span class="next">Une application à partir de zéro</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83355" data-claire-element-id="83355">Pour réaliser un ciel réaliste, Ogre possède trois solutions similaires très simples à utiliser. Le principe est de créer un objet représentant le ciel au-dessus de votre tête (la caméra, donc) et de le déplacer en même temps que vous bougez. Cette astuce permet de vous donner l'impression que vous êtes très loin du ciel et des nuages, ce qui est la base d'un ciel réaliste.</p><h2 id="r-skybox" data-claire-element-id="83387">Skybox</h2><p id="r-83356" data-claire-element-id="83356">La skybox est une grande boîte texturée à l'intérieur qui permet d'afficher un ciel dans toutes les directions dans lesquelles vous regardez.</p><p id="r-83357" data-claire-element-id="83357">Pour en installer une, c'est très simple, il y a une méthode dédiée :</p><pre id="r-83358" data-claire-element-id="83358"><code data-claire-semantic="cpp">mSceneMgr-&gt;setSkyBox(true, &quot;Examples/EveningSkyBox&quot;);</code></pre><p id="r-83359" data-claire-element-id="83359">Le premier paramètre indique si vous désirez activez la skybox, le second précise la texture que vous voulez utiliser pour celle-ci.</p><figure id="r-83361" data-claire-element-id="83362"><img id="r-83360" data-claire-element-id="83360" src="medias/uploads.siteduzero.com_files_251001_252000_251045.jpg" alt="Image utilisateur"/></figure><p id="r-83363" data-claire-element-id="83363">On peut ensuite jouer sur des paramètres qui ont des valeurs par défaut qui permettent de modifier la façon dont la skybox est rendue :</p><pre id="r-83364" data-claire-element-id="83364"><code data-claire-semantic="cpp">mSceneMgr-&gt;setSkyBox(true, &quot;Examples/EveningSkyBox&quot;, 1000, false);</code></pre><p id="r-83365" data-claire-element-id="83365">Le troisième paramètre est la distance à laquelle se trouve le bord de la skybox par rapport à la caméra, et le quatrième indique si la skybox doit être rendue ou non avant les autres objets de la scène.</p><p id="r-83366" data-claire-element-id="83366">Si ce dernier paramètre est <code data-claire-semantic="cpp">true</code> (valeur par défaut), tous les objets de la scène seront dessinés par-dessus la skybox et apparaitront donc devant celle-ci. En revanche, s'il est <code data-claire-semantic="cpp">false</code>, les objets qui sont situés plus loin que la valeur du troisième paramètre ne seront pas affichés, car ils seront dessinés derrière la skybox !</p><p id="r-83367" data-claire-element-id="83367">Par exemple, avec une distance de 1000, voici ce que l'on voit :</p><figure id="r-83369" data-claire-element-id="83370"><img id="r-83368" data-claire-element-id="83368" src="medias/uploads.siteduzero.com_files_251001_252000_251046.jpg" alt="Image utilisateur"/></figure><aside id="r-83372" data-claire-element-id="83372" data-claire-semantic="information"><p id="r-83371" data-claire-element-id="83371">On voit ici nettement l'angle dans le terrain tronqué, preuve que l'on est bien dans une boîte.</p></aside><p id="r-83373" data-claire-element-id="83373">Le terrain est affiché sur une moins grande distance, puisque tout ce qui est à plus de 1000 unités de la caméra se trouve derrière la skybox.</p><p id="r-83374" data-claire-element-id="83374">La plupart du temps vous ne voudrez pas que cela se produise, c'est pourquoi ces deux derniers paramètres pourront être laissés par défaut.</p><p id="r-83375" data-claire-element-id="83375">Des matériaux d'exemple pour les skybox sont fournis avec votre installation d'Ogre, dans le fichier <code>OgreSDK\media\materials\scripts\Examples.material</code>. En voici quelques-uns que vous pouvez essayer pour avoir un aperçu.</p><ul id="r-83386" data-claire-element-id="83386"><li id="r-83377" data-claire-element-id="83377"><p id="r-83376" data-claire-element-id="83376">EarlyMorningSkyBox</p></li><li id="r-83379" data-claire-element-id="83379"><p id="r-83378" data-claire-element-id="83378">MorningSkyBox</p></li><li id="r-83381" data-claire-element-id="83381"><p id="r-83380" data-claire-element-id="83380">EveningSkyBox</p></li><li id="r-83383" data-claire-element-id="83383"><p id="r-83382" data-claire-element-id="83382">StormySkyBox</p></li><li id="r-83385" data-claire-element-id="83385"><p id="r-83384" data-claire-element-id="83384">SpaceSkyBox</p></li></ul><h2 id="r-skydome" data-claire-element-id="83404">Skydome</h2><p id="r-83388" data-claire-element-id="83388">Le principe du skydome est le même que pour la skybox ; cependant, la façon dont la texture est plaquée sur l'objet est différente. Vous êtes toujours dans une boîte, mais la texture est plaquée de manière sphérique, ce qui permet un peu plus de réalisme, mais laisse la face basse non texturée. On ne l'utilisera donc que si l'on a un sol pour masquer cette partie de la boîte.</p><p id="r-83389" data-claire-element-id="83389">De même que pour une skybox, le code est très simple, mais s'enrichit de deux paramètres.</p><pre id="r-83390" data-claire-element-id="83390"><code data-claire-semantic="cpp">mSceneMgr-&gt;setSkyDome(true, &quot;Examples/CloudySky&quot;, 2, 10.0);</code></pre><p id="r-83391" data-claire-element-id="83391">Cette fois, vous devriez voir un ciel nuageux au-dessus de votre terrain. En allant au bord, vous verrez que la face inférieure est vide, et que la partie basse de la boîte voit sa texture déformée par la méthode de plaquage.</p><figure id="r-83393" data-claire-element-id="83394"><img id="r-83392" data-claire-element-id="83392" src="medias/uploads.siteduzero.com_files_251001_252000_251053.jpg" alt="Image utilisateur"/></figure><p id="r-83395" data-claire-element-id="83395">Les deux premiers paramètres sont identiques que pour la skybox : activation du dôme et choix de la texture.</p><aside id="r-83397" data-claire-element-id="83397" data-claire-semantic="error"><p id="r-83396" data-claire-element-id="83396">Les textures spécialement créées pour les skybox ne sont pas adaptées aux dômes ! Étant donné que la texture n'est pas plaquée de la même façon, il n'y a généralement pas de compatibilité.</p></aside><p id="r-83398" data-claire-element-id="83398">Le paramètre suivant est la courbure du dôme, qui doit être comprise entre 2 et 65. Plus la valeur est faible, plus la courbure est faible et donc le ciel paraît sensiblement plus loin. En revanche, une valeur haute provoque moins de déformations, mais je trouve la différence minime, c'est pourquoi j'opte généralement une valeur faible.</p><p id="r-83399" data-claire-element-id="83399">En quatrième paramètre, vous précisez le nombre de fois (ce n'est pas forcément un nombre entier) que la texture doit être plaquée sur une surface donnée. Cela permet d'adapter l'échelle de la texture à l'échelle du terrain.<br/> Avec une valeur un peu trop élevée (ici 32), on comprend un peu mieux ce que cela donne :</p><figure id="r-83401" data-claire-element-id="83402"><img id="r-83400" data-claire-element-id="83400" src="medias/uploads.siteduzero.com_files_251001_252000_251054.jpg" alt="Image utilisateur"/></figure><p id="r-83403" data-claire-element-id="83403">Les paramètres 5 et 6, non précisés ici, correspondent à la distance du skydome et à l'ordre de rendu, que nous avions déjà dans le cas de la skybox.</p><h2 id="r-skyplane" data-claire-element-id="83420">Skyplane</h2><p id="r-83405" data-claire-element-id="83405">Ce dernier objet est un peu différent des deux premiers, puisque l'on n'utilise plus une boîte mais un simple plan pour définir le ciel. Cela implique d'ores et déjà qu'il sera préférable de l'utiliser lorsque l'horizon n'est pas visible.</p><p id="r-83406" data-claire-element-id="83406">Pour créer un skyplane, il faut commencer par créer un plan :</p><pre id="r-83407" data-claire-element-id="83407"><code data-claire-semantic="cpp">Ogre::Plane plane;
plane.d = 1000;
plane.normal = Ogre::Vector3::NEGATIVE_UNIT_Y;</code></pre><p id="r-83408" data-claire-element-id="83408">On appelle ensuite la méthode correspondante du Scene Manager pour créer le skyplane.</p><pre id="r-83409" data-claire-element-id="83409"><code data-claire-semantic="cpp">mSceneMgr-&gt;setSkyPlane(true, plane, &quot;Examples/SpaceSkyPlane&quot;, 1500, 75);</code></pre><p id="r-83410" data-claire-element-id="83410">Notez que l'on donne le plan que l'on vient de créer à la méthode, ainsi que sa taille et le nombre de fois que la texture doit être plaquée pour les deux derniers paramètres.</p><p id="r-83411" data-claire-element-id="83411">Comme précédemment, on a aussi quelques paramètres facultatifs pour notre ciel.</p><p id="r-83412" data-claire-element-id="83412">Le paramètre 6 détermine à nouveau l'ordre d'affichage du ciel par rapport aux autres objets.</p><p id="r-83413" data-claire-element-id="83413">Le suivant est un peu plus intéressant puisqu'il permet de corriger un peu l'inconvénient principal du skyplane, sa platitude.<br/> On peut donc ajouter une courbure au ciel, mais il faut alors définir le nombre de segments du plan dans ses deux dimensions (les deux derniers paramètres). Il n'est en effet pas possible de courber un plan qui n'est pas divisé par des segments. ^^</p><pre id="r-83414" data-claire-element-id="83414"><code data-claire-semantic="cpp">mSceneMgr-&gt;setSkyPlane(true, plane, &quot;Examples/SpaceSkyPlane&quot;, 1500, 50, true, 1.5f, 150, 150);</code></pre><p id="r-83415" data-claire-element-id="83415">Enfin, il est bon de savoir que le skyplane à l'avantage d'être très économe en ressources et qu'il cohabite très bien avec le brouillard, si vous décidez d'en mettre dans la scène.</p><div id="r-83417" data-claire-element-id="83417" data-claire-semantic="question"><p id="r-83416" data-claire-element-id="83416">Finalement, quel est le meilleur choix pour mon ciel ?</p></div><p id="r-83418" data-claire-element-id="83418">Tout dépend de la scène que vous avez. S'il est possible de voir le ciel dans toutes les directions, vous devrez passer par une skybox pour satisfaire cette contrainte. Sinon, un skydome fera très bien l'affaire, tout comme le skyplane si vous avez un terrain à fort relief ou bien que l'horizon n'est pas visible.</p><p id="r-83419" data-claire-element-id="83419">Vous êtes maintenant prêts à créer de beaux environnements extérieurs mélangeant des textures de sol, le tout avec un ciel azur ou encore un coucher de soleil... Laissez parler votre créativité, les possibilités sont nombreuses !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
<span class="arrow"></span>
<span class="next">Et si on en veut plus ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">
<span class="next">Une application à partir de zéro</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Uneapplicationpartirdezro"></a><h2>Une application à partir de zéro</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
<span class="arrow"></span>
<span class="next">Un ciel au-dessus de nos têtes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
<span class="next">Préparation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-83426" data-claire-element-id="83426">Maintenant que vous avez vu les manipulations basiques dans Ogre en utilisant les classes courantes, il va falloir s'attaquer au fonctionnement du moteur, plus précisément au squelette d'une application Ogre.</p><p id="r-83427" data-claire-element-id="83427">Vous avez probablement envie de vous passer une bonne fois pour toutes de la classe ExampleApplication, que je vous ai imposée dans la première partie afin de ne pas vous effrayer. Il est donc temps de coder nous-mêmes le démarrage du moteur pour avoir enfin un contrôle total sur ce qui s'y passe et pouvoir par la suite créer notre propre framework pour s'adapter à nos besoins.</p><p id="r-83428" data-claire-element-id="83428">Mettez vos gants, nous allons faire un tour dans la mécanique d'Ogre !</p>
</div><a name="Prparation"></a><h2>Préparation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">
<span class="arrow"></span>
<span class="next">Une application à partir de zéro</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
<span class="next">Au début, une fenêtre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-les-etapes" data-claire-element-id="83447">Les étapes</h2><p id="r-83429" data-claire-element-id="83429">Dégrossissons un peu ce qui se passe lorsque Ogre est initialisé afin d'être prêt à l'emploi. On peut observer 8 principaux points à retenir et à effectuer dans l'ordre.</p><ol id="r-83446" data-claire-element-id="83446"><li id="r-83431" data-claire-element-id="83431"><p id="r-83430" data-claire-element-id="83430">La création d'un objet Root</p></li><li id="r-83433" data-claire-element-id="83433"><p id="r-83432" data-claire-element-id="83432">La définition des ressources à utiliser</p></li><li id="r-83435" data-claire-element-id="83435"><p id="r-83434" data-claire-element-id="83434">La création du système et de la fenêtre de rendu (appelée <em>RenderWindow</em>)</p></li><li id="r-83437" data-claire-element-id="83437"><p id="r-83436" data-claire-element-id="83436">L'initialisation des ressources</p></li><li id="r-83439" data-claire-element-id="83439"><p id="r-83438" data-claire-element-id="83438">La création de la scène</p></li><li id="r-83441" data-claire-element-id="83441"><p id="r-83440" data-claire-element-id="83440">Le chargement éventuel de plugins additionnels</p></li><li id="r-83443" data-claire-element-id="83443"><p id="r-83442" data-claire-element-id="83442">La création des frame listeners</p></li><li id="r-83445" data-claire-element-id="83445"><p id="r-83444" data-claire-element-id="83444">Le lancement de la boucle infinie</p></li></ol><h2 id="r-vocabulaire" data-claire-element-id="83458">Vocabulaire</h2><h3 id="r-le-root" data-claire-element-id="83449">Le Root</h3><p id="r-83448" data-claire-element-id="83448">Le <em>Root</em> (&quot;racine&quot; en anglais) est l'objet de <strong>base</strong> du moteur Ogre. C'est autour de lui que tout se construit et c'est donc lui qui doit être créé en premier lieu. Sa création permet l'initialisation du moteur afin de préparer le terrain pour les autres objets qui vont venir graviter autour.</p><h3 id="r-les-ressources-1" data-claire-element-id="83452">Les ressources</h3><p id="r-83450" data-claire-element-id="83450">Lorsque je parle d'initialiser les ressources, certaines questions peuvent venir à l'esprit. Pourquoi faut-il définir les ressources à utiliser ? Pourquoi ne pas simplement demander d'ouvrir tel fichier lorsque l'on en a besoin dans le code, plutôt que de devoir utiliser un fichier listant les ressources et en plus s'embêter lors de l'initialisation du moteur ?</p><p id="r-83451" data-claire-element-id="83451">La réponse est simple : nous travaillons dans une application où la vitesse est primordiale une fois que le joueur a les commandes. Charger les ressources à la volée demande du temps à l'ordinateur, puisqu'il doit aller chercher la ressource sur le disque dur, lire le fichier et mettre l'objet en mémoire afin de pouvoir l'utiliser. Toutes ces opérations sont généralement faites lorsque l'on démarre le jeu ou bien que l'on charge un niveau, ce sont les fameux chargements sur lesquels vous avez l'habitude de pester lorsqu'ils n'en finissent plus :p . Mais une fois que c'est chargé, plus besoin d'y toucher, on n'a plus qu'à s'occuper des mécanismes du jeu, ce qui permet de ne pas ralentir l'exécution par ces opérations.</p><h3 id="r-la-renderwindow" data-claire-element-id="83454">La RenderWindow</h3><p id="r-83453" data-claire-element-id="83453">Un objet RenderWindow représente la fenêtre contenant la scène affichée à l'écran. Attention toutefois, la fenêtre dont je parle n'est pas la fenêtre avec la barre supérieure contenant les boutons &quot;fermer&quot;, &quot;agrandir&quot; et &quot;réduire&quot;, qui est la fenêtre du système d'exploitation. La RenderWindow est le &quot;cadre&quot; de la scène, qui est contenu dans la fenêtre du système d'exploitation. La différence est importante car si l'on programme un éditeur de scène par exemple, le fenêtre du programme contiendra non seulement la RenderWindow mais aussi des menus et des boites à outils qui n'ont rien à voir avec Ogre.</p><h3 id="r-la-boucle-infinie" data-claire-element-id="83457">La boucle infinie</h3><p id="r-83455" data-claire-element-id="83455">C'est ici que se passe la quasi totalité du temps d'exécution du programme, une fois que l'initialisation est faite. On utilise une boucle infinie tout simplement parce que le principe de l'application que l'on veut créer est de rendre des images les unes après les autres le plus rapidement possible, jusqu'à ce que l'on décide de fermer le programme. Dans ce cas, il suffit de d'arrêter la boucle infinie et d'exécuter le code qui suit consistant généralement à décharger la mémoire utilisée en détruisant les objets créés, etc.</p><p id="r-83456" data-claire-element-id="83456">Il existe une méthode de l'objet root qui permet de lancer automatiquement une boucle infinie prédéfinie, c'est la méthode Root::startRendering(). Cependant, il est aussi possible de définir une boucle infinie personnalisée et d'y mettre les instructions que l'on souhaite.</p><h2 id="r-le-projet" data-claire-element-id="83478">Le projet</h2><p id="r-83459" data-claire-element-id="83459">La création du projet se fait de la même façon que pour le premier projet que nous avions créé, les dossiers includes et les bibliothèques à ajouter sont les mêmes.</p><p id="r-83460" data-claire-element-id="83460">En ce qui concerne le dossier de l'exécutable, il faudra à nouveau copier les DLL fournies avec Ogre ainsi que les fichiers resources.cfg et plugins.cfg. Comme je l'ai précisé dans les premiers chapitres, ces deux fichiers de configuration contiennent respectivement les ressources et les plugins à charger dans l'application à son lancement. Il est maintenant temps de simplifier un peu tout cela.</p><p id="r-83461" data-claire-element-id="83461">Le fichier resources.cfg liste par défaut tous les répertoires contenus dans le dossier media fourni avec le SDK d'Ogre, ce qui signifie que depuis le début de ce tutoriel, nous avons à chaque fois chargé toutes les ressources disponibles dans ce répertoire.<br/> Pour cette application partant de zéro, nous allons choisir nous-mêmes les ressources à charger afin de ne pas mettre en mémoire de fichiers inutiles et de gagner en temps de chargement. Vous verrez en lançant le programme à la fin de ce chapitre que le temps de démarrage est incomparable avec ce qu'on avait jusqu'à maintenant. Vu que vous devriez commencer à vous familiariser avec les composants d'Ogre, il est bien temps de faire un peu d'optimisation. :-°</p><p id="r-83462" data-claire-element-id="83462">Créons donc un dossier intitulé <em>media</em> dans le répertoire de compilation du projet Ogre, et ajoutons les fichiers suivants :</p><ul id="r-83469" data-claire-element-id="83469"><li id="r-83464" data-claire-element-id="83464"><p id="r-83463" data-claire-element-id="83463">&quot;penguin.mesh&quot; contenu dans le dossier OgreSDK\media\models</p></li><li id="r-83466" data-claire-element-id="83466"><p id="r-83465" data-claire-element-id="83465">&quot;penguin.jpg&quot; qui se trouve à OgreSDK\media\materials extures</p></li><li id="r-83468" data-claire-element-id="83468"><p id="r-83467" data-claire-element-id="83467">&quot;Penguin.material&quot; dans OgreSDK\media\materials\scripts</p></li></ul><p id="r-83470" data-claire-element-id="83470">Il ne reste plus qu'à mettre une ligne unique (et supprimer tout le reste) dans notre fichier resources.cfg pour dire à Ogre d'aller chercher les ressources que nous venons de copier.</p><pre id="r-83471" data-claire-element-id="83471"><code>FileSystem=./media</code></pre><aside id="r-83473" data-claire-element-id="83473" data-claire-semantic="information"><p id="r-83472" data-claire-element-id="83472">Si vous voulez organiser vos fichiers de ressources avec des sous-dossiers, il faudra rajouter une ligne pour chacun des sous-dossiers, comme c'est fait dans le fichier resources.cfg par défaut. Ogre ne parcourt pas toute l'arborescence d'un dossier mais seulement les fichiers qui sont directement présents dans celui-ci !</p></aside><p id="r-83474" data-claire-element-id="83474">Maintenant que le fichier de ressources est simplifié, nous pouvons aussi alléger le fichier plugins.cfg en supprimant tout à l'exception des API graphiques que nous utiliserons (DirectX ou OpenGL donc). Il est possible de modifier l'emplacement des DLL listées dans ce fichier en éditant la ligne <em>PluginFolder</em> qui pointe par défaut sur le répertoire courant.</p><p id="r-83475" data-claire-element-id="83475">Voici donc mon fichier plugins.cfg après épuration :</p><pre id="r-83476" data-claire-element-id="83476"><code>PluginFolder=.

Plugin=RenderSystem_Direct3D9
Plugin=RenderSystem_GL</code></pre><p id="r-83477" data-claire-element-id="83477">Nous n'avons donc plus que trois binaires de bibliothèques à placer dans le répertoire de l'exécutable (sous windows) : OgreMain, RenderSystem_GL et RenderSystem_Direct3D9.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">
<span class="arrow"></span>
<span class="next">Une application à partir de zéro</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
<span class="next">Au début, une fenêtre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Audbutunefentre"></a><h2>Au début, une fenêtre</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
<span class="arrow"></span>
<span class="next">Préparation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
<span class="next">Ajout du Frame Listener</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-mise-en-place-9" data-claire-element-id="83488">Mise en place</h2><p id="r-83480" data-claire-element-id="83480">Créez un premier fichier main.cpp qui contiendra le code de la fonction main(), c'est le même que précédemment, mais cette fois j'ai appelé ma classe AppDemarrage, vu qu'on n'en est plus à notre premier coup d'essai !</p><pre id="r-83481" data-claire-element-id="83481"><code data-claire-semantic="cpp">#include &quot;AppDemarrage.h&quot;

#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
#define WIN32_LEAN_AND_MEAN
#include &quot;windows.h&quot;
#endif

#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
INT WINAPI WinMain( HINSTANCE hInst, HINSTANCE, LPSTR strCmdLine, INT )
#else
int main(int argc, char *argv[])
#endif
{
    AppDemarrage app;

    try {
        app.start();
    } catch( Ogre::Exception&amp; e ) {
#if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
        MessageBox( NULL, e.getFullDescription().c_str(), &quot;An exception has occured!&quot;, MB_OK | MB_ICONERROR | MB_TASKMODAL);
#else
        std::cerr &lt;&lt; &quot;An exception has occured: &quot; &lt;&lt;
            e.getFullDescription().c_str() &lt;&lt; std::endl;
#endif
    }

    return 0;
}</code></pre><p id="r-83482" data-claire-element-id="83482">On crée ensuite la classe AppDemarrage dans un header : constructeur, destructeur, la fonction start() qui est appelée par le main et un attribut Root pour commencer. Nous ajouterons les objets petit à petit.</p><pre id="r-83483" data-claire-element-id="83483"><code data-claire-semantic="cpp">#include &lt;Ogre.h&gt;

class AppDemarrage
{
public:
    AppDemarrage();
    ~AppDemarrage();

    bool start();

private:
    Ogre::Root *mRoot;
};</code></pre><p id="r-83484" data-claire-element-id="83484">Dans votre fichier AppDemarrage.cpp, initialisez le Root dans le constructeur et détruisez-le dans le destructeur. La fonction start() est vide pour l'instant.</p><pre id="r-83485" data-claire-element-id="83485"><code data-claire-semantic="cpp">AppDemarrage::AppDemarrage() : mRoot(0)
{
}
AppDemarrage::~AppDemarrage()
{
    delete mRoot;
}
bool AppDemarrage::start()
{
    return true;
}</code></pre><aside id="r-83487" data-claire-element-id="83487" data-claire-semantic="information"><p id="r-83486" data-claire-element-id="83486">Nous rajouterons plusieurs attributs à notre classe au cours de ce chapitre. Je ne reviendrai pas sur le constructeur par la suite, pensez donc à chaque fois à initialiser ces pointeurs avec la valeur 0 pour éviter d'avoir n'importe quoi dedans.</p></aside><h2 id="r-le-root-1" data-claire-element-id="83496">Le Root</h2><p id="r-83489" data-claire-element-id="83489">Si vous avez lu la première partie de ce chapitre, vous devez vous souvenir que la première chose à faire est de créer le Root avant toute autre chose. Celui-ci prend plusieurs paramètres :</p><pre id="r-83490" data-claire-element-id="83490"><code data-claire-semantic="cpp">Ogre::Root::Root(const String &amp;pluginFileName = &quot;plugins.cfg&quot;, const String &amp;configFileName = &quot;ogre.cfg&quot;, const String &amp;logFileName = &quot;Ogre.log&quot;)</code></pre><p id="r-83491" data-claire-element-id="83491">Le premier est le nom du fichier de plugins à charger, le second est le fichier de configuration d'Ogre, qui retient les préférences que vous entrez dans la boite de dialogue habituellement pour vous éviter de les retaper. Enfin, vous pouvez choisir le nom du fichier de log.</p><p id="r-83492" data-claire-element-id="83492">J'ai laissé les paramètres par défaut, voici donc la première ligne de ma fonction start().</p><pre id="r-83493" data-claire-element-id="83493"><code data-claire-semantic="cpp">mRoot = new Ogre::Root(&quot;plugins.cfg&quot;, &quot;ogre.cfg&quot;, &quot;Ogre.log&quot;);</code></pre><aside id="r-83495" data-claire-element-id="83495" data-claire-semantic="warning"><p id="r-83494" data-claire-element-id="83494">Afin de simplifier le code et les explications, je n'écris pas de directives de préprocesseur pour tenir compte des différentes configurations de compilation possibles. Le fichier plugins.cfg n'a par exemple pas le même nom en debug si vous utilisez les fichiers fournis avec Ogre, faites donc attention à ce que les noms correspondent aux fichiers que vous avez dans vos dossiers.</p></aside><h2 id="r-chargement-des-ressources" data-claire-element-id="83515">Chargement des ressources</h2><p id="r-83497" data-claire-element-id="83497">La prochaine étape consiste à charger les ressources à utiliser en lisant le fichier resources.cfg. On utilise pour cela la classe ConfigFile qui permet de s'occuper de la lecture du fichier de ressources avec la méthode load().</p><pre id="r-83498" data-claire-element-id="83498"><code data-claire-semantic="cpp">Ogre::ConfigFile configFile;
configFile.load(&quot;resources.cfg&quot;);</code></pre><p id="r-83499" data-claire-element-id="83499">Une fois le fichier de ressources chargé et lu, il faut ajouter les chemins indiqués dans le gestionnaire des groupes de ressources (ou <em>ResourceGroupManager</em>). Ceci se fait grâce à un itérateur de type SectionIterator conçu spécialement pour les fichiers de configuration et que le l'on récupère via la méthode getSectionIterator() de notre ConfigFile.</p><pre id="r-83500" data-claire-element-id="83500"><code data-claire-semantic="cpp">Ogre::ConfigFile::SectionIterator seci = configFile.getSectionIterator();</code></pre><p id="r-83501" data-claire-element-id="83501">On utilise ensuite cet itérateur pour parcourir les éléments du fichier de configuration ligne par ligne. Pour chaque ligne, on ajoute le dossier référencé à l'ensemble des dossiers de ressources pris en compte par l'application grâce à la méthode addResourceLocation().</p><pre id="r-83502" data-claire-element-id="83502"><code data-claire-semantic="cpp">Ogre::String secName, typeName, archName;
while (seci.hasMoreElements())
{
    secName = seci.peekNextKey();
    Ogre::ConfigFile::SettingsMultiMap *settings = seci.getNext();
    Ogre::ConfigFile::SettingsMultiMap::iterator i;
    for (i = settings-&gt;begin(); i != settings-&gt;end(); ++i)
    {
        typeName = i-&gt;first;
        archName = i-&gt;second;
        Ogre::ResourceGroupManager::getSingleton().addResourceLocation(
            archName, typeName, secName);
    }
}</code></pre><p id="r-83503" data-claire-element-id="83503">Il est maintenant temps de commencer le chargement du moteur en lui-même. Pour cela, on commence par vérifier si une configuration existante est écrite sur le disque, via la méthode restoreConfig() de l'objet root. Si elle retourne la valeur <code data-claire-semantic="cpp">false</code> (c'est-à-dire qu'aucun fichier de configuration n'existe ou bien que le chargement a échoué), on appelle la fenêtre de choix de configuration avec showConfigDialog(), qui renvoie <code data-claire-semantic="cpp">true</code> si l'utilisateur clique sur le bouton OK. Si ces deux méthodes retournent une valeur fausse, on quitte l'application.</p><pre id="r-83504" data-claire-element-id="83504"><code data-claire-semantic="cpp">if(!(mRoot-&gt;restoreConfig() || mRoot-&gt;showConfigDialog()))
{
    return false;
}</code></pre><h3 id="r-configuration-manuelle-du-rendersystem" data-claire-element-id="83514">Configuration manuelle du RenderSystem</h3><p id="r-83505" data-claire-element-id="83505">Il est aussi tout à fait possible de définir la configuration par vous-même, sans passer par la fenêtre de configuration fournie par Ogre ni par la restauration automatique des paramètres précédents. Ce n'est pas forcément plus simple, mais si vous voulez changer la fenêtre par défaut au lancement c'est la solution qu'il faudra adopter.<br/> Il faut pour cela récupérer le <em>RenderSystem</em>, qui est la bibliothèque graphique qui va s'occuper du rendu du moteur (DirectX ou bien OpenGL), puis le paramétrer, c'est-à-dire indiquer la bibliothèque graphique qui va s'occuper du rendu du moteur (DirectX ou bien OpenGL), de la résolution, de l'affichage (ou non) en plein écran...</p><p id="r-83506" data-claire-element-id="83506">Vous pouvez par exemple intégrer un code comme celui-ci pour utiliser DirectX en tant que RenderSystem, sans mode plein écran, avec une résolution définie et la synchronisation verticale :</p><pre id="r-83507" data-claire-element-id="83507"><code data-claire-semantic="cpp">// variante : configuration sans boite de dialogue
Ogre::RenderSystem *rs = mRoot-&gt;getRenderSystemByName(&quot;Direct3D9 Rendering Subsystem&quot;); // Pour OpenGL : &quot;OpenGL Rendering Subsystem&quot;
mRoot-&gt;setRenderSystem(rs);
rs-&gt;setConfigOption(&quot;Full Screen&quot;, &quot;No&quot;);
rs-&gt;setConfigOption(&quot;Video Mode&quot;, &quot;1280 x 800 @ 32-bit colour&quot;);
rs-&gt;setConfigOption(&quot;VSync&quot;, &quot;Yes&quot;);</code></pre><p id="r-83508" data-claire-element-id="83508">On peut bien sûr envisager de créer votre propre fenêtre de configuration en récupérant les différents RenderSystem disponibles sur notre machine et en listant les options qui leur sont associées. Deux méthodes nous sont fournies pour faire cette manipulation :</p><pre id="r-83509" data-claire-element-id="83509"><code data-claire-semantic="cpp">const RenderSystemList&amp; Ogre::Root::getAvailableRenderers(void)
virtual ConfigOptionMap&amp; Ogre::RenderSystem::getConfigOptions(void)</code></pre><p id="r-83510" data-claire-element-id="83510">Une fois les options de configuration récupérées, vous connaitrez les paires clé/valeur à entrer en paramètres de la méthode setConfigOption().</p><p id="r-83511" data-claire-element-id="83511">Voici un exemple sommaire de récupération des clés et des valeurs associées (on suppose que le RenderSystem a été récupéré juste avant) :</p><pre id="r-83512" data-claire-element-id="83512"><code data-claire-semantic="cpp">Ogre::ConfigOptionMap map = rs-&gt;getConfigOptions();
for(Ogre::ConfigOptionMap::const_iterator it = map.begin(); it != map.end(); it++)
{
    std::cout &lt;&lt; it-&gt;first &lt;&lt; std::endl; // affiche la clé, par exemple &quot;Full Screen&quot;
    for(int i = 0; i &lt; it-&gt;second.possibleValues.size(); i++)           // affiche les valeurs possible pour cette clé
        std::cout &lt;&lt; &quot;  &quot; &lt;&lt; it-&gt;second.possibleValues[i] &lt;&lt; std::endl; // par exemple : &quot;Yes&quot;, &quot;No&quot;
}</code></pre><p id="r-83513" data-claire-element-id="83513">Encore une fois, je vous invite à parcourir la <a href="http://www.ogre3d.org/docs/api/html/annotated.html">documentation</a> associée si vous voulez utiliser ces fonctions avec plus de détails.</p><h2 id="r-la-renderwindow-1" data-claire-element-id="83522">La RenderWindow</h2><p id="r-83516" data-claire-element-id="83516">Le système étant initialisé, on crée la fenêtre de l'application, c'est la RenderWindow. On la définit comme attribut de la classe AppDemarrage et on la crée grâce à la méthode initialise() de l'objet root.</p><pre id="r-83517" data-claire-element-id="83517"><code data-claire-semantic="cpp">Ogre::RenderWindow* mWindow;</code></pre><pre id="r-83518" data-claire-element-id="83518"><code data-claire-semantic="cpp">mWindow = mRoot-&gt;initialise(true, &quot;Une application de zér0&quot;);</code></pre><p id="r-83519" data-claire-element-id="83519">La méthode initialise() prend comme premier paramètre un booléen indiquant si Ogre doit créer lui-même la fenêtre dans laquelle le rendu sera fait. Ici, c'est ce que nous voulons, puisque nous n'avons que la scène à rendre. En revanche, si vous voulez utiliser un gestionnaire de fenêtres spécifique ou même embarquer votre rendu dans une application (un éditeur de scène par exemple), vous aurez besoin de créer vous-même la fenêtre.</p><p id="r-83520" data-claire-element-id="83520">Comme je décide de créer la fenêtre avec Ogre, je peux aussi indiquer le titre de celle-ci en second paramètre.</p><p id="r-83521" data-claire-element-id="83521">Dans le cas où vous désirez créer la fenêtre à la main, il faut alors appeler la méthode createRenderWindow() de la classe Root. La méthode dépendant notamment du système d'exploitation, je ne le détaillerai pas ici, je vous invite donc à regarder la <a href="http://www.ogre3d.org/docs/api/html/classOgre_1_1Root.html#a537b7d1d0937f799cfe4936f6b672620">documentation</a> si ce point vous intéresse.</p><h2 id="r-initialisation-des-ressources" data-claire-element-id="83533">Initialisation des ressources</h2><p id="r-83523" data-claire-element-id="83523">L'initialisation des ressources se fait de façon très simple depuis que le fichier de ressources a été parcouru, grâce à la méthode initialiseAllResourceGroups() du gestionnaire de ressources. Si l'on ne veut pas initialiser toutes nos ressources d'un coup, mais seulement un groupe, il existe la méthode initialiseResourceGroup() qui permet de ne charger qu'un nombre restreint de ressources et qui a la prototype suivant :</p><pre id="r-83524" data-claire-element-id="83524"><code data-claire-semantic="cpp">void initialiseResourceGroup (const String &amp;name)</code></pre><p id="r-83525" data-claire-element-id="83525">Cette méthode est utile dans de grosses applications dans lesquelles il n'est pas nécessaire d'avoir toutes les ressources à disposition à tout instant. Dans notre cas, nous allons tout charger au lancement de l'application.</p><pre id="r-83526" data-claire-element-id="83526"><code data-claire-semantic="cpp">Ogre::TextureManager::getSingleton().setDefaultNumMipmaps(5);
Ogre::ResourceGroupManager::getSingleton().initialiseAllResourceGroups();</code></pre><p id="r-83527" data-claire-element-id="83527">Comme vous le voyez, il est possible de définir le nombre de mipmaps par défaut pour les textures chargées. Cette méthode (si on veut l'appeler, ce n'est pas obligatoire) doit être appelée avant d'initialiser les ressources pour être prise en compte.</p><div id="r-83529" data-claire-element-id="83529" data-claire-semantic="question"><p id="r-83528" data-claire-element-id="83528">Doucement, qu'est-ce que c'est qu'une mipmap ? :euh:</p></div><p id="r-83530" data-claire-element-id="83530">Pour faire simple, disons que chaque texture d'une taille donnée peut être recopiée en une version allégée de taille plus faible, dans le but d'être affichée lorsque le niveau de détail demandé est faible (si un objet est loin de la caméra notamment). Plutôt que de calculer la texture réduite en temps réel à partir de l'original, le moteur va créer en même temps que les textures chargées des textures de taille moindre qui se substitueront à l'originale si le détail demandé est faible.</p><p id="r-83531" data-claire-element-id="83531">La taille des textures générées est à chaque fois d'un quart (en surface) de la précédente. Par exemple, pour une texture de 256x256 pixels, on pourra avoir 8 mipmaps de 128, 64, 32, 16, 8, 4, 2 et 1 pixels de coté. Si la texture affichée prend sur l'écran une taille de 100 pixels, le moteur fera une interpolation en les deux plus proches (128 et 64) pour obtenir un résultat convainquant.</p><p id="r-83532" data-claire-element-id="83532">La méthode setDefaultNumMipmaps() définit donc combien de mipmaps par texture on est censé avoir.</p><h2 id="r-la-scene" data-claire-element-id="83542">La scène</h2><p id="r-83534" data-claire-element-id="83534">On revient maintenant en terrain connu avec la création du scene manager, que nous avons utilisé dans toute la première partie de ce cours. Le premier paramètre est le type de scene manager que l'on veut utiliser (ici le type par défaut), puis le nom du scene manager peut être facultativement mis en second argument.</p><pre id="r-83535" data-claire-element-id="83535"><code data-claire-semantic="cpp">Ogre::SceneManager* mSceneMgr;</code></pre><pre id="r-83536" data-claire-element-id="83536"><code data-claire-semantic="cpp">mSceneMgr = mRoot-&gt;createSceneManager(&quot;DefaultSceneManager&quot;, &quot;Mon Scene Manager&quot;);
mSceneMgr-&gt;setAmbientLight(Ogre::ColourValue(1.0f, 1.0f, 1.0f));</code></pre><p id="r-83537" data-claire-element-id="83537">Afin de voir quelque chose au rendu, nous allons créer une scène basique qui permettra de vérifier que notre code fonctionne correctement. La démarche est la même que ce que nous avons fait dans la première partie : créer une caméra, un mesh et ajouter l'ensemble à la scène.</p><pre id="r-83538" data-claire-element-id="83538"><code data-claire-semantic="cpp">Ogre::Camera* mCamera;</code></pre><pre id="r-83539" data-claire-element-id="83539"><code data-claire-semantic="cpp">mCamera = mSceneMgr-&gt;createCamera(&quot;PlayerCam&quot;);
mCamera-&gt;setPosition(Ogre::Vector3(0,0,100));
mCamera-&gt;lookAt(Ogre::Vector3(0,0,0));
mCamera-&gt;setNearClipDistance(5);

Ogre::Viewport* vp = mWindow-&gt;addViewport(mCamera);
vp-&gt;setBackgroundColour(Ogre::ColourValue(0,0,0));
mCamera-&gt;setAspectRatio(Ogre::Real(vp-&gt;getActualWidth()) / Ogre::Real(vp-&gt;getActualHeight()));

Ogre::Entity *ent = mSceneMgr-&gt;createEntity(&quot;pinguin&quot;, &quot;penguin.mesh&quot;);
Ogre::SceneNode *node = mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode();
node-&gt;attachObject(ent);</code></pre><p id="r-83540" data-claire-element-id="83540">Une fois ce code écrit, la scène est construite, la fenêtre créée, tout est prêt. Pourtant si vous exécutez l'application, la fenêtre se fermera dès que tout sera chargé : la fonction start() se termine, donc repasse le contrôle au main() qui termine le programme.</p><p id="r-83541" data-claire-element-id="83541">Il manque donc une chose essentielle au programme, c'est la boucle de rendu.</p><h2 id="r-la-boucle-de-rendu" data-claire-element-id="83560">La boucle de rendu</h2><p id="r-83543" data-claire-element-id="83543">L'objet root implémente une méthode startRendering() qui s'occupe de faire tourner la boucle infinie dans laquelle se fait le rendu. Cette boucle infinie convient parfaitement à notre usage, vous pouvez d'ailleur l'ajouter à la fin de la méthode start().</p><pre id="r-83544" data-claire-element-id="83544"><code data-claire-semantic="cpp">mRoot-&gt;startRendering();</code></pre><p id="r-83545" data-claire-element-id="83545">Le mesh du pingouin doit alors s'afficher devant la caméra de la même manière que le faisait la tête d'ogre dans les chapitres précédents. Il n'est bien sûr pas possible de se déplacer vu que l'on ne s'est pas encore occupé de mettre en place OIS.</p><p id="r-83546" data-claire-element-id="83546">Tout fonctionne donc, mais pour voir un peu plus en détails comment nous pourrions faire quelque chose de fonctionnel à la main, nous allons créer notre propre boucle infinie.</p><aside id="r-83548" data-claire-element-id="83548" data-claire-semantic="information"><p id="r-83547" data-claire-element-id="83547">Dans le cas où l'on ne veut pas rafraichir l'écran rapidement, dans le cas d'un éditeur par exemple, on ne passera pas par une boucle infinie mais on se contentera de rafraichir l'écran lorsque l'on se déplace ou que la scène est modifiée.</p></aside><p id="r-83549" data-claire-element-id="83549">Pour faire la boucle infinie, commencez par coder une boucle while() ayant pour condition <code data-claire-semantic="cpp">true</code>. Dans cette boucle, l'objectif est de rendre une image à chaque tour de boucle, grâce à la méthode renderOneFrame() de l'objet root.</p><p id="r-83550" data-claire-element-id="83550">Cela suffit a priori pour rendre la scène, mais deux problèmes apparaissent au lancement de l'application.<br/> Premièrement, l'objet RenderWindow ne se met pas à jour, et le programme ne semble plus répondre (vous aurez un message de plantage sous windows).<br/> Deuxièmement, même si l'on ferme la fenêtre, le processus continue de tourner en arrière plan, c'est-à-dire que le programme ne s'arrête pas !</p><p id="r-83551" data-claire-element-id="83551">Pour contourner le premier problème, il faut appeler à chaque tour la méthode suivante qui prend en charge le rafraichissement de la fenêtre :</p><pre id="r-83552" data-claire-element-id="83552"><code data-claire-semantic="cpp">Ogre::WindowEventUtilities::messagePump();</code></pre><p id="r-83553" data-claire-element-id="83553">Ensuite, pour que l'application s'arrête lorsque l'on ferme la fenêtre, il suffit de vérifier si celle-ci est fermée, auquel cas on utilise la directive <code data-claire-semantic="cpp">return</code> pour quitter la méthode start() et a fortiori la boucle infinie.</p><p id="r-83554" data-claire-element-id="83554">Avec ces deux ajouts, votre boucle doit être codée comme dans l'exemple suivant.</p><pre id="r-83555" data-claire-element-id="83555"><code data-claire-semantic="cpp">while(true)
{
    Ogre::WindowEventUtilities::messagePump();
 
    if(mWindow-&gt;isClosed())
        return false;
 
    if(!mRoot-&gt;renderOneFrame())
        return false;
}</code></pre><p id="r-83556" data-claire-element-id="83556">Vous pouvez maintenant lancer l'application, qui devrait vous afficher un pingouin au centre de l'écran.</p><figure id="r-83558" data-claire-element-id="83559"><img id="r-83557" data-claire-element-id="83557" src="medias/uploads.siteduzero.com_files_275001_276000_275611.png" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
<span class="arrow"></span>
<span class="next">Préparation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
<span class="next">Ajout du Frame Listener</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="AjoutduFrameListener"></a><h2>Ajout du Frame Listener</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
<span class="arrow"></span>
<span class="next">Au début, une fenêtre</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
<span class="next">Implémenter OIS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83562" data-claire-element-id="83562">Nous allons mettre en place le Frame Listener qui nous permet entre autres de capturer les entrées du clavier et de la souris fournies par OIS, que nous démarrerons dans la partie suivante.</p><p id="r-83563" data-claire-element-id="83563">J'ai décidé de créer une classe InputListener qui hérite de FrameListener et dans laquelle nous allons mettre tout le code correspondant à la gestion des entrées.</p><pre id="r-83564" data-claire-element-id="83564"><code data-claire-semantic="cpp">#include &lt;Ogre.h&gt;
#include &lt;OIS/OIS.h&gt;

class InputListener : public Ogre::FrameListener
{
public:

private:
    Ogre::RenderWindow* mWindow;
    Ogre::Camera*       mCamera;

    OIS::InputManager*  mInputManager;
    OIS::Mouse*         mMouse;
    OIS::Keyboard*      mKeyboard;
};</code></pre><p id="r-83565" data-claire-element-id="83565">Nous devons bien penser à inclure le fichier OIS.h pour pouvoir utiliser les trois derniers attributs qui sont le gestionnaire d'entrées, la souris et le clavier lorsque nous lancerons OIS.</p><p id="r-83566" data-claire-element-id="83566">Le constructeur reçoit deux arguments qui sont la RenderWindow de l'application dont nous aurons besoin par la suite et la caméra créée dans AppDemarrage.</p><pre id="r-83567" data-claire-element-id="83567"><code data-claire-semantic="cpp">InputListener(Ogre::RenderWindow *wnd, Ogre::Camera *camera)
{
    mWindow = wnd;
    mCamera = camera;
}</code></pre><p id="r-83568" data-claire-element-id="83568">Ensuite, on réécrit la méthode frameRenderingQueued() qui est appelée, si vous vous souvenez bien, pendant que l'image en cours est rendue. Nous allons gérer ici uniquement la touche echap pur pouvoir quitter l'application facilement, mais rien ne vous empêche d'implémenter le déplacement de la caméra, cela vous permettra de vérifier si vous avez bien retenu le chapitre 6 !</p><pre id="r-83569" data-claire-element-id="83569"><code data-claire-semantic="cpp">bool InputListener::frameRenderingQueued(const Ogre::FrameEvent&amp; evt)
{
    if(mWindow-&gt;isClosed())
        return false;

    mKeyboard-&gt;capture();
    mMouse-&gt;capture();
 
    if(mKeyboard-&gt;isKeyDown(OIS::KC_ESCAPE))
        return false;
 
    return true;
}</code></pre><p id="r-83570" data-claire-element-id="83570">Enfin, après la création de la scène, on appelle une nouvelle méthode createFrameListener (à ajouter dans la classe AppDemarrage) qui va instancier notre Frame Listener personnalisé et l'ajouter en tant que FrameListener dans l'objet Root pour que les appels soient automatiques.</p><pre id="r-83571" data-claire-element-id="83571"><code data-claire-semantic="cpp">createScene();
createFrameListener();

// boucle de rendu
//...</code></pre><pre id="r-83572" data-claire-element-id="83572"><code data-claire-semantic="cpp">void AppDemarrage::createFrameListener()
{
    mInputListener = new InputListener(mWindow, mCamera);
    mRoot-&gt;addFrameListener(mInputListener);
}</code></pre><p id="r-83573" data-claire-element-id="83573">Nous devons maintenant passer au démarrage d'OIS dans lequel nous allons notamment créer les objets Mouse et Keyboard qui nous servent à récupérer les entrées utilisateur via la méthode capture().</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
<span class="arrow"></span>
<span class="next">Au début, une fenêtre</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
<span class="next">Implémenter OIS</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ImplmenterOIS"></a><h2>Implémenter OIS</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
<span class="arrow"></span>
<span class="next">Ajout du Frame Listener</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">
<span class="next">Les matériaux</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83575" data-claire-element-id="83575">Nous avons maintenant une application Ogre fonctionnelle de base dont nous connaissons tout le code source, puisque nous l'avons écrit nous-même. Vous avez donc probablement remarqué que nous n'avons pas encore créé d'objets Mouse ou Keyboard pour supporter les périphériques d'entrée et gérer les événements utilisateur via les Frame Listeners.</p><p id="r-83576" data-claire-element-id="83576">Avant que les codes que nous avons vus en première partie puissent être utilisés, il faut commencer par implémenter OIS dans notre application, chose qui était déjà faite dans la classe ExampleFrameListener que nous utilisions.</p><p id="r-83577" data-claire-element-id="83577">Si vous ne l'avez pas déjà fait, rajoutez la bibliothèque OIS (OIS_d en debug) dans l'éditeur de lien et copiez la DLL d'OIS dans le répertoire de votre exécutable.</p><h2 id="r-demarrer-ois" data-claire-element-id="83591">Démarrer OIS</h2><p id="r-83578" data-claire-element-id="83578">Tout le code qui va suivre est à mettre dans une méthode de type <code data-claire-semantic="cpp">void</code> nommée startOIS() de notre classe InputListener. Rajoutez le prototype de cette méthode dans le header de la classe et préparez-vous à en écrire le corps. Aussi, il faudra penser à l'appeler dans le constructeur du InputListener :</p><pre id="r-83579" data-claire-element-id="83579"><code data-claire-semantic="cpp">InputListener::InputListener(Ogre::RenderWindow *wnd, Ogre::Camera *camera)
{
    mWindow = wnd;
    mCamera = camera;
    startOIS();
}</code></pre><p id="r-83580" data-claire-element-id="83580">Pour ne pas vous dépayser si vous avez déjà regardé les logs d'une application Ogre, nous allons placer dans ce log une ligne indiquant que nous rentrons dans la phase d'initialisation d'OIS. Ce sera la première ligne de la méthode startOIS().</p><pre id="r-83581" data-claire-element-id="83581"><code data-claire-semantic="cpp">Ogre::LogManager::getSingletonPtr()-&gt;logMessage(&quot;*** Initializing OIS ***&quot;);</code></pre><p id="r-83582" data-claire-element-id="83582">Bien entendu, avec cette méthode vous pouvez placer tous les messages que vous désirez dans le log, ne vous en privez pas mais restez raisonnable, ce fichier doit rester lisible pour être utile !</p><p id="r-83583" data-claire-element-id="83583">La suite du code consiste à récupérer un identifiant de la RenderWindow utilisée par notre application afin de créer le gestionnaire d'entrées. On utilise pour cela une liste de type OIS::ParamList dans laquelle on insère une paire clé/valeur correspondant à l'identifiant récupéré plus haut avec la méthode RenderWindow::getCustomAttribute().</p><pre id="r-83584" data-claire-element-id="83584"><code data-claire-semantic="cpp">OIS::ParamList pl;
size_t windowHnd = 0;
std::ostringstream windowHndStr;
 
mWindow-&gt;getCustomAttribute(&quot;WINDOW&quot;, &amp;windowHnd);
windowHndStr &lt;&lt; windowHnd;
pl.insert(std::make_pair(std::string(&quot;WINDOW&quot;), windowHndStr.str()));</code></pre><p id="r-83585" data-claire-element-id="83585">Ce morceau de code sort un peu du cadre du cours mais il est utile d'en comprendre le principe si vous voulez pouvoir intégrer une RenderWindow dans une autre application dans le cadre d'un éditeur de niveau par exemple.</p><p id="r-83586" data-claire-element-id="83586">Une fois le paramètre caractéristique de la RenderWindow récupéré dans la liste, on est en mesure d'instancier le gestionnaire d'entrées.</p><pre id="r-83587" data-claire-element-id="83587"><code data-claire-semantic="cpp">mInputManager = OIS::InputManager::createInputSystem( pl );</code></pre><p id="r-83588" data-claire-element-id="83588">À partir du gestionnaire d'entrées, nous pouvons créer nos objets pour la gestion de la souris et du clavier par la méthode createInputObject(). Le premier paramètre de cette méthode est le type du périphérique à créer, le second vous permet de dire si vous souhaitez utiliser le buffer avec ce périphérique. Ici nous n'allons pas l'utiliser, j'ai donc mis l'argument correspondant.</p><p id="r-83589" data-claire-element-id="83589">Le type de retour de la méthode étant un pointeur sur un OIS::InputObject, il ne faut pas oublier de caster l'objet reçu en un OIS::Mouse ou OIS::Keyboard.</p><pre id="r-83590" data-claire-element-id="83590"><code data-claire-semantic="cpp">mMouse = static_cast&lt;OIS::Mouse*&gt;(mInputManager-&gt;createInputObject( OIS::OISMouse, false ));
mKeyboard = static_cast&lt;OIS::Keyboard*&gt;(mInputManager-&gt;createInputObject( OIS::OISKeyboard, false ));</code></pre><h2 id="r-lier-ois-a-la-fenetre" data-claire-element-id="83614">Lier OIS à la fenêtre</h2><p id="r-83592" data-claire-element-id="83592">L'étape suivante consiste à gérer la liaison entre la fenêtre qui contient notre application et l'application elle-même. Comme on l'a vu lors de l'initialisation, OIS interagit directement avec la fenêtre du système d'exploitation pour trouver notamment la position de la souris dans celle-ci. Les dimensions de la fenêtre doivent donc être connues pour pouvoir estimer la position relative de la souris à partir de ses coordonnées sur l'écran.</p><p id="r-83593" data-claire-element-id="83593">Pour que le moindre changement effectué sur la géométrie de la fenêtre soit transmis, il nous faut interfacer notre classe avec WindowEventListener, qui, à la manière d'un Frame Listener, appelle les méthodes adaptées lors de certains événements définis.</p><pre id="r-83594" data-claire-element-id="83594"><code data-claire-semantic="cpp">class InputListener: public Ogre::FrameListener, public Ogre::WindowEventListener</code></pre><p id="r-83595" data-claire-element-id="83595">La classe WindowEventListener possède deux méthodes virtuelles que nous allons réécrire : windowResized() et windowClosed(). Elles permettent de gérer les événements liés au redimensionnement de la fenêtre ainsi qu'à sa fermeture. Lorsque la fenêtre change de dimensions, nous avons vu qu'il est en effet nécessaire de fournir les nouvelles valeurs à OIS sinon la position de la souris sera erronée.</p><pre id="r-83596" data-claire-element-id="83596"><code data-claire-semantic="cpp">// Prototypes des méthodes
virtual void windowResized(Ogre::RenderWindow* rw);
virtual void windowClosed(Ogre::RenderWindow* rw);</code></pre><p id="r-83597" data-claire-element-id="83597">Pour la première méthode, le but est de récupérer la géométrie de la fenêtre redimensionnée via la méthode RenderWindow::getMetrics(). La largeur et la hauteur récupérées sont ensuite transmises à OIS par le MouseState de notre souris. Comme nous l'avions vu dans le chapitre 6, le MouseState permet entre autres de récupérer la position de la souris dans la fenêtre, calculée notamment grâce à la connaissance de la largeur et la hauteur de cette dernière.</p><pre id="r-83598" data-claire-element-id="83598"><code data-claire-semantic="cpp">void InputListener::windowResized(Ogre::RenderWindow* wnd)
{
    unsigned int width, height, depth;
    int left, top;
    wnd-&gt;getMetrics(width, height, depth, left, top);
 
    const OIS::MouseState &amp;ms = mMouse-&gt;getMouseState();
    ms.width = width;
    ms.height = height;
}</code></pre><p id="r-83599" data-claire-element-id="83599">Maintenant, la méthode windowClosed() va permettre de fermer OIS en détruisant les objets créés lorsque la fenêtre de l'application est fermée.</p><p id="r-83600" data-claire-element-id="83600">Étant donné que la fonction sera appelée à chaque fermeture de fenêtre, il faut commencer par vérifier si c'est bien notre attribut mWindow qui est concerné. Dans ce cas, on s'occupe de détruire les objets représentant la souris et le clavier via la méthode destroyInputObject(), puis le gestionnaire d'entrées avec destroyInputSystem().</p><pre id="r-83601" data-claire-element-id="83601"><code data-claire-semantic="cpp">void InputListener::windowClosed(Ogre::RenderWindow* wnd)
{
    if( wnd == mWindow )
    {
        if( mInputManager )
        {
            mInputManager-&gt;destroyInputObject( mMouse );
            mInputManager-&gt;destroyInputObject( mKeyboard );
 
            OIS::InputManager::destroyInputSystem(mInputManager);
            mInputManager = 0;
        }
    }
}</code></pre><p id="r-83602" data-claire-element-id="83602">Revenons maintenant à la méthode startOIS(), à la suite de la création des objets Mouse et Keyboard. On commence par appeler la méthode windowResized() qui va permettre à OIS de récupérer la taille de la fenêtre de notre application, puis un appel à addWindowEventListener() permet d'enregistrer notre objet InputListener en tant que WindowEventListener pour cette fenêtre. Ainsi, à l'avenir, lorsque la fenêtre sera redimensionnée ou fermée, les appels à nos fonctions seront faits automatiquement.</p><pre id="r-83603" data-claire-element-id="83603"><code data-claire-semantic="cpp">windowResized(mWindow);
Ogre::WindowEventUtilities::addWindowEventListener(mWindow, this);</code></pre><p id="r-83604" data-claire-element-id="83604">Voici donc la méthode startOIS() complète :</p><pre id="r-83605" data-claire-element-id="83605"><code data-claire-semantic="cpp">void InputListener::startOIS() 
{
    Ogre::LogManager::getSingletonPtr()-&gt;logMessage(&quot;*** Initializing OIS ***&quot;);

    OIS::ParamList pl;
    size_t windowHnd = 0;
    std::ostringstream windowHndStr;
 
    mWindow-&gt;getCustomAttribute(&quot;WINDOW&quot;, &amp;windowHnd);
    windowHndStr &lt;&lt; windowHnd;
    pl.insert(std::make_pair(std::string(&quot;WINDOW&quot;), windowHndStr.str()));
 
    mInputManager = OIS::InputManager::createInputSystem( pl );
    mMouse = static_cast&lt;OIS::Mouse*&gt;(mInputManager-&gt;createInputObject( OIS::OISMouse, false ));
    mKeyboard = static_cast&lt;OIS::Keyboard*&gt;(mInputManager-&gt;createInputObject( OIS::OISKeyboard, false ));

    windowResized(mWindow);
    Ogre::WindowEventUtilities::addWindowEventListener(mWindow, this);
}</code></pre><p id="r-83606" data-claire-element-id="83606">Enfin, dans le destructeur de la classe InputListener, il faut retirer notre application de la liste des écouteurs de la fenêtre puis appeler la méthode windowClosed() qui permet la fermeture d'OIS.</p><pre id="r-83607" data-claire-element-id="83607"><code data-claire-semantic="cpp">InputListener::~InputListener()
{
    Ogre::WindowEventUtilities::removeWindowEventListener(mWindow, this);
    windowClosed(mWindow);
}</code></pre><div id="r-83609" data-claire-element-id="83609" data-claire-semantic="question"><p id="r-83608" data-claire-element-id="83608">Pourquoi s'occupe-t-on d'appeler la méthode windowClosed() dans le destructeur ? Je pensais que l'appel était automatique. :o</p></div><p id="r-83610" data-claire-element-id="83610">Il faut en fait jeter un oeil à la documentation pour comprendre comment marche exactement cette fonction. Il est précisé que celle-ci n'est appelée que lorsque l'utilisateur clique sur la croix en haut à droite de sa fenêtre. Or rien ne nous dit que c'est ce qui arrivera pour notre application ! La plupart du temps, le joueur choisira une option &quot;quitter&quot; dans l'interface graphique ou bien appuiera simplement sur la touche <kbd>echap</kbd> comme nous le faisons depuis le début de ce tutoriel. Il est donc nécessaire d'appeler explicitement la méthode dans le destructeur pour s'assurer que le traitement sera fait.</p><p id="r-83611" data-claire-element-id="83611">Vous pouvez maintenant compiler et utiliser votre clavier en appuyant sur <kbd>echap</kbd> pour quitter l'application.</p><p id="r-83612" data-claire-element-id="83612">Vous êtes maintenant capables de lancer une application sans passer par la classe ExampleApplication !</p><p id="r-83613" data-claire-element-id="83613">Si le code n'est pas spécialement complexe, il reste important d'effectuer les étapes décrites dans l'ordre pour éviter les erreurs qui seront fatales au lancement de l'application. L'application créée est aussi très simpliste, mais nous commençons à avoir la plupart des clés en main pour créer des programmes Ogre d'importance.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
<span class="arrow"></span>
<span class="next">Ajout du Frame Listener</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">
<span class="next">Les matériaux</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesmatriaux"></a><h2>Les matériaux</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
<span class="arrow"></span>
<span class="next">Implémenter OIS</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
<span class="next">Préparation du projet</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-83617" data-claire-element-id="83617">Après avoir inséré des meshs dans la scène sans vraiment s'occuper de la façon dont les matériaux sont choisis ni appliqués, je vous propose justement d'aller explorer les fichiers qui définissent les matériaux utilisés par les objets 3D.</p><p id="r-83618" data-claire-element-id="83618">Il sera ici question de comprendre leur syntaxe pour pouvoir les modifier et même les créer en partant de zéro.</p>
</div><a name="Prparationduprojet"></a><h2>Préparation du projet</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">
<span class="arrow"></span>
<span class="next">Les matériaux</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
<span class="next">La structure d&#039;un matériau</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83619" data-claire-element-id="83619">Avant de commencer, nous allons créer un projet simple grâce auquel nous ferons des essais au cours du chapitre.</p><p id="r-83620" data-claire-element-id="83620">Créez un nouveau projet Ogre, soit en utilisant ExampleApplication soit à partir du chapitre &quot;Une application de zéro&quot;, cela n'a pas d'importance ici.</p><p id="r-83621" data-claire-element-id="83621">Éditez le fichier resources.cfg pour qu'il ne contienne qu'un lien vers un dossier &quot;media&quot; que vous placerez à côté de l'exécutable.</p><pre id="r-83622" data-claire-element-id="83622"><code>[General]
FileSystem=./media</code></pre><p id="r-83623" data-claire-element-id="83623">Dans le dossier media, copiez les fichiers cube.mesh et sphere.mesh présents dans OgreSDK/media/models/. Créez aussi un fichier tuto.material que vous laissez vide pour l'instant.</p><p id="r-83624" data-claire-element-id="83624">Dans votre méthode createScene(), insérez le code suivant qui vous met en place un mesh et une caméra.</p><pre id="r-83625" data-claire-element-id="83625"><code data-claire-semantic="cpp">void OgreMateriaux::createScene()
{
    mCamera = mSceneMgr-&gt;createCamera(&quot;Camera&quot;);
    mCamera-&gt;setPosition(Ogre::Vector3(200,200,200));
    mCamera-&gt;lookAt(Ogre::Vector3(0,0,0));
    mCamera-&gt;setNearClipDistance(5);

    Ogre::Viewport* vp = mWindow-&gt;addViewport(mCamera);
    vp-&gt;setBackgroundColour(Ogre::ColourValue(0,0,0));
     
    mCamera-&gt;setAspectRatio(Ogre::Real(vp-&gt;getActualWidth()) / Ogre::Real(vp-&gt;getActualHeight()));
        
    mSceneMgr-&gt;setAmbientLight(Ogre::ColourValue(1.0, 1.0, 1.0));

    Ogre::Entity* ent = mSceneMgr-&gt;createEntity(&quot;cube&quot;, &quot;cube.mesh&quot;);
    mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode()-&gt;attachObject(ent);
    ent-&gt;setMaterialName(&quot;cube&quot;);
}</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">
<span class="arrow"></span>
<span class="next">Les matériaux</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
<span class="next">La structure d&#039;un matériau</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lastructured039unmatriau"></a><h2>La structure d&#039;un matériau</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
<span class="arrow"></span>
<span class="next">Préparation du projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
<span class="next">Choisir les couleurs</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83627" data-claire-element-id="83627">Chaque matériau est déclaré dans un fichier .material qui peut contenir autant de matériaux que l'on veut, ce qui permet notamment de réunir des matériaux similaires par rapport à leur usage dans un même fichier.</p><p id="r-83628" data-claire-element-id="83628">La syntaxe n'est pas dépaysante pour les programmeurs : chaque niveau hiérarchique est ensuite délimité par des accolades et les commentaires sont indiqués par un double slash. Voici un extrait de fichier .material très simple que vous pouvez trouver dans OgreSDK/media/materials/scripts/ogre.material.</p><pre id="r-83629" data-claire-element-id="83629"><code>material Ogre/Eyes
{
        technique
        {
                pass
                {
                        ambient 1 0.4 0.4
                        diffuse 1 0.7 0
                        emissive 0.3 0.1 0
                }
        }
}</code></pre><p id="r-83630" data-claire-element-id="83630">Au sein du fichier, un matériau est déclaré avec le mot clé <em>material</em> suivi du nom du matériau. Comme vous le voyez dans l'exemple, le slash est autorisé et est couramment utilisé pour indiquer l'appartenance d'un matériau à un groupe, ici on montre que l'on écrit le matériau correspondant aux yeux d'un ogre par exemple.</p><aside id="r-83632" data-claire-element-id="83632" data-claire-semantic="warning"><p id="r-83631" data-claire-element-id="83631">Cette organisation hiérarchique est vue uniquement par le programmeur, Ogre ne tient pas compte des slashs et prend la chaîne de caractères comme un nom simple, le matériau a donc pour nom la chaîne complète &quot;Ogre/Eyes&quot;.</p></aside><p id="r-83633" data-claire-element-id="83633">Dans ce matériau, on peut définir une ou plusieurs techniques, elles-mêmes composées d'une ou plusieurs passes.</p><h2 id="r-les-techniques" data-claire-element-id="83636">Les techniques</h2><p id="r-83634" data-claire-element-id="83634">Une technique est une façon donnée de réaliser l'effet voulu pour le matériau. Une seule technique est utilisée pour rendre le matériau, c'est la première dans l'ordre de déclaration qui est supportée par le matériel de l'ordinateur. La présence de différentes techniques dans un même matériau s'explique donc par le besoin de fournir des techniques &quot;basiques&quot; dans le cas ou la technique principale n'est pas supportée par la machine.</p><p id="r-83635" data-claire-element-id="83635">Chaque technique doit avoir un nom unique fourni juste après le mot-clé <em>technique</em>. Si ce nom n'est pas fourni, le numéro de la technique dans l'ordre de déclaration est utilisé pour la nommer (la première technique s'appellera donc &quot;0&quot;).</p><h2 id="r-les-passes" data-claire-element-id="83639">Les passes</h2><p id="r-83637" data-claire-element-id="83637">Les passes d'une technique représentent chacune une couche de rendu du matériau sur la géométrie de l'objet cible. Il est possible d'utiliser jusqu'à 16 passes dans une technique, chacune d'elle ayant un coût en temps de rendu, il ne faut donc pas en abuser.</p><p id="r-83638" data-claire-element-id="83638">Tout comme les techniques, les passes ont un nom unique qui est par défaut le numéro d'index de la passe au sein de la technique dans laquelle elle est déclarée.</p><h2 id="r-votre-fichier-material" data-claire-element-id="83643">Votre fichier .material</h2><p id="r-83640" data-claire-element-id="83640">Ouvrez votre fichier tuto.material et insérez-y le code suivant pour obtenir la structure de base présentée ici.</p><pre id="r-83641" data-claire-element-id="83641"><code>material cube
{
        technique
        {
                pass
                {
                }
        }
}</code></pre><p id="r-83642" data-claire-element-id="83642">Nous compléterons ce fichier par la suite.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
<span class="arrow"></span>
<span class="next">Préparation du projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
<span class="next">Choisir les couleurs</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Choisirlescouleurs"></a><h2>Choisir les couleurs</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
<span class="arrow"></span>
<span class="next">La structure d&#039;un matériau</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
<span class="next">Les textures</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83645" data-claire-element-id="83645">Attachons-nous maintenant en détail à la gestion des couleurs dans un matériau. Il existe différents paramètres pour modifier l'apparence d'un matériau, dont 3 principaux qui concernent la couleur de celui-ci et la façon dont il réagit à la lumière.</p><h2 id="r-rappel-sur-le-format-rvb" data-claire-element-id="83656">Rappel sur le format RVB</h2><p id="r-83646" data-claire-element-id="83646">Pour un ordinateur, une couleur est composée de trois couleurs élémentaires qui sont le rouge, le vert et le bleu et qui permettent de définir toutes les couleurs du spectre lumineux. Ainsi, une lumière ou encore un matériau possèdent trois attributs de couleur dont la valeur est comprise entre 0 et 1.</p><p id="r-83647" data-claire-element-id="83647">Pour savoir comment un matériau réagit à la lumière, il faut faire le produit des composantes entre elles, le résultat donne alors la couleur résultante de la lumière sur le matériau.</p><p id="r-83648" data-claire-element-id="83648">Imaginons ainsi un matériau de couleur (1, 0, 0) (c'est-à-dire rouge) exposé à la lumière blanche (1, 1, 1). Si l'on fait le produit des composantes rouges, puis des vertes et des bleues, on obtient :</p><p id="r-83649" data-claire-element-id="83649">Rouge : 1 imes 1 = 1Vert: 1 imes 0 = 0Bleu: 1 imes 0 = 0</p><p id="r-83650" data-claire-element-id="83650">La couleur résultante est donc (1, 0, 0), on observe donc un objet rouge.</p><p id="r-83651" data-claire-element-id="83651">Si maintenant on prend un matériau de couleur (0.5, 1, 0) avec une lumière bleue (0, 0, 1), que se passe-t-il ?</p><p id="r-83652" data-claire-element-id="83652">Rouge : 0.5 imes 0 = 0Vert: 1 imes 0 = 0Bleu: 0 imes 1 = 0</p><p id="r-83653" data-claire-element-id="83653">La résultante est (0, 0, 0), c'est-à-dire noir ! Le matériau et la lumière n'ont pas de couleur en commun, il n'y a donc pas de couleur réfléchie vers la caméra.</p><p id="r-83654" data-claire-element-id="83654">Si vous avez compris ce principe de calcul des couleurs, la suite devrait bien se passer. :)</p><p id="r-83655" data-claire-element-id="83655">Voyons tout de suite les différents paramètres que peut avoir notre matériau vis-à-vis de la lumière.</p><h2 id="r-la-lumiere-ambiante" data-claire-element-id="83669">La lumière ambiante</h2><p id="r-83657" data-claire-element-id="83657">La lumière ambiante est celle qui est définie par le Scene Manager grâce à la méthode setAmbientLight().</p><pre id="r-83658" data-claire-element-id="83658"><code data-claire-semantic="cpp">mSceneMgr-&gt;setAmbientLight(1.0, 1.0, 1.0);</code></pre><p id="r-83659" data-claire-element-id="83659">La lumière ambiante n'est émise dans aucune direction particulière, c'est à dire que toutes les faces d'un objet la reçoivent, quelle que soit l'orientation de cette façe dans l'espace.<br/> Pour définir la couleur ambiante d'un matériau, c'est-à-dire la quantité de lumière ambiante réfléchie par le matériau, on utilise le mot <em>ambient</em> suivi des trois couleurs du matériau. Vous pouvez donc rajouter une ligne dans le fichier tuto.material pour définir la couleur ambiante du matériau, par exemple rouge.</p><pre id="r-83660" data-claire-element-id="83660"><code>material cube
{
    technique
    {
        pass
        {
            ambient 1.0 0.0 0.0
        }
    }
}</code></pre><p id="r-83661" data-claire-element-id="83661">Si vous exécutez le projet votre cube doit maintenant apparaître complètement rouge.</p><figure id="r-83663" data-claire-element-id="83664"><img id="r-83662" data-claire-element-id="83662" src="medias/uploads.siteduzero.com_files_306001_307000_306295.png" alt="Image utilisateur"/></figure><div id="r-83666" data-claire-element-id="83666" data-claire-semantic="question"><p id="r-83665" data-claire-element-id="83665">Pourquoi la couleur est-elle unie ? On ne distingue pas du tout les faces du cube !</p></div><p id="r-83667" data-claire-element-id="83667">Comme je vous l'ai précisé plus haut, la lumière ambiante est appliquée de la même façon sur les différentes faces, quelle que soit leur orientation. Il n'y a donc aucune raison pour que la couleur soit différente d'une face à l'autre !</p><p id="r-83668" data-claire-element-id="83668">En revanche, vous allez voir qu'avec la lumière diffuse, c'est une autre histoire.</p><h2 id="r-la-lumiere-diffuse" data-claire-element-id="83691">La lumière diffuse</h2><p id="r-83670" data-claire-element-id="83670">La lumière diffuse correspond à la lumière envoyée par les objets de type Ogre::Light. La lumière a donc une direction qui dépend du type de la lumière. Pour une lumière de type point que nous allons utiliser, les rayons lumineux partent de la lumière et s'en éloignent, donc ils arrivent sur les faces avec des angles différents.</p><p id="r-83671" data-claire-element-id="83671">Vous devriez vous souvenir que l'on peut définir leur couleur diffuse via la méthode setDiffuseColour(). Ajoutez-donc une lumière de couleur bleue dans la scène et coupez la lumière ambiante :</p><pre id="r-83672" data-claire-element-id="83672"><code data-claire-semantic="cpp">Ogre::Light* light = mSceneMgr-&gt;createLight(&quot;light1&quot;);
light-&gt;setPosition(100, 300, 200);
light-&gt;setDiffuseColour(0.0, 0.0, 1.0);

mSceneMgr-&gt;setAmbientLight(Ogre::ColourValue(0.0, 0.0, 0.0));</code></pre><p id="r-83673" data-claire-element-id="83673">Nous allons aussi choisir de donner une couleur diffuse blanche au cube pour voir comment celui-ci réagit à la lumière :</p><pre id="r-83674" data-claire-element-id="83674"><code>material cube
{
    technique
    {
        pass
        {
            ambient 1.0 0.0 0.0
            diffuse 1.0 1.0 1.0
        }
    }
}</code></pre><p id="r-83675" data-claire-element-id="83675">Votre cube doit maintenant apparaître en bleu et on distingue correctement les faces !</p><figure id="r-83677" data-claire-element-id="83678"><img id="r-83676" data-claire-element-id="83676" src="medias/uploads.siteduzero.com_files_306001_307000_306296.png" alt="Image utilisateur"/></figure><div id="r-83680" data-claire-element-id="83680" data-claire-semantic="question"><p id="r-83679" data-claire-element-id="83679">Que s'est-il passé ?</p></div><p id="r-83681" data-claire-element-id="83681">Premièrement, nous avons coupé la lumière ambiante, ce qui explique l'absence de rouge sur le cube. Si l'on remet une lumière ambiante blanche, soit (1, 1, 1), le cube apparaît dans une couleur violet/rose, c'est à dire un mélange du rouge (résultante ambiante) et du bleu (résultante diffuse).</p><figure id="r-83683" data-claire-element-id="83684"><img id="r-83682" data-claire-element-id="83682" src="medias/uploads.siteduzero.com_files_306001_307000_306299.png" alt="Image utilisateur"/></figure><p id="r-83685" data-claire-element-id="83685">Ensuite, vous voyez que cette fois, on appréhende correctement le volume du cube grâce à la couleur des faces. Comme je l'ai dit, chaque rayon lumineux a une direction précise et arrive sur une face avec un angle particulier, qui dépend à la fois de l'orientation de la face (c'est à dire de sa <em>normale</em>, la droite perpendiculaire à la face) et de sa direction.</p><p id="r-83686" data-claire-element-id="83686">Si la lumière arrive perpendiculairement à la face (donc le long de la normale), l'éclairement est maximum. Si la lumière arrive parallèlement à la face (donc de façon perpendiculaire à la normale) ou bien par l'arrière de la face, l'éclairement est nul. Si vous regardez la position de la lumière, vous verrez qu'elle est placée assez haut, donc qu'elle éclaire majoritairement la face supérieure du cube, d'où la couleur plus claire sur cette face.</p><p id="r-83687" data-claire-element-id="83687">Pour poser les choses mathématiquement, la valeur de chaque composante de couleur est calculée comme précédemment, par un produit entre la composante de chaque couleur de la lumière avec la composante correspondante sur le matériau, le tout étant multiplié par le cosinus de l'angle entre le rayon lumineux et la normale de la face.</p><p id="r-83688" data-claire-element-id="83688">La composante rouge de la couleur résultante sera donc calculée ainsi :</p><p id="r-83689" data-claire-element-id="83689">RougeTotal = RougeMateriau imes RougeLumiere imes \cos(\alpha)</p><p id="r-83690" data-claire-element-id="83690">Si l'angle vaut 0, c'est à dire que la lumière arrive perpendiculairement à la face, le cosinus est bien maximum est on a donc une luminosité forte.</p><h2 id="r-la-lumiere-speculaire" data-claire-element-id="83705">La lumière spéculaire</h2><p id="r-83692" data-claire-element-id="83692">Le dernier type de lumière est la lumière spéculaire, qui traduit le fait qu'un matériau soit plus ou moins brillant à la lumière.</p><p id="r-83693" data-claire-element-id="83693">La lumière spéculaire est aussi émise par les objets de type Ogre::Light et possède les trois composantes de la couleur. On la définit avec la méthode setSpecularColour().</p><pre id="r-83694" data-claire-element-id="83694"><code data-claire-semantic="cpp">light-&gt;setSpecularColour(0.0, 0.0, 1.0);</code></pre><p id="r-83695" data-claire-element-id="83695">Dans le matériau, on utilise le mot-clé <em>specular</em> pour indiquer que l'on définit le comportement du matériau pour la lumière spéculaire. On doit à nouveau indiquer les trois composantes de la couleur, ainsi qu'un paramètre de brillance positif. Cette brillance correspond à la tache lumineuse que l'on voit apparaître sur les matériaux comme le métal du coté où la lumière est la plus forte. Plus la brillance est élevée, plus la tâche lumineuse sera vive et nette.</p><p id="r-83696" data-claire-element-id="83696">Pour mieux se représenter l'effet de la lumière spéculaire, nous allons utiliser une sphère plutôt qu'un cube car sa géométrie permet de mieux voir les différences de rendu.</p><p id="r-83697" data-claire-element-id="83697">Il faut donc modifier le mesh choisi à la création de l'entité dans le code et créer un nouveau matériau dans le fichier tuto.material.</p><pre id="r-83698" data-claire-element-id="83698"><code data-claire-semantic="cpp">Ogre::Entity* ent = mSceneMgr-&gt;createEntity(&quot;sphere&quot;, &quot;sphere.mesh&quot;);
mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode()-&gt;attachObject(ent);
ent-&gt;setMaterialName(&quot;sphere&quot;);</code></pre><pre id="r-83699" data-claire-element-id="83699"><code>material sphere
{
    technique
    {
        pass
        {
            ambient 1.0 0.0 0.0
            diffuse 1.0 1.0 1.0
            specular 1.0 1.0 1.0 32.0
        }
    }
}</code></pre><p id="r-83700" data-claire-element-id="83700">Voici le résultat avec différentes valeurs de la brillance :</p><figure id="r-83702" data-claire-element-id="83703"><img id="r-83701" data-claire-element-id="83701" src="medias/uploads.siteduzero.com_files_306001_307000_306309.png" alt="Image utilisateur"/></figure><p id="r-83704" data-claire-element-id="83704"><em>Gauche : pas de lumière spéculaire, centre : brillance à 1, droite : brillance à 32</em></p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
<span class="arrow"></span>
<span class="next">La structure d&#039;un matériau</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
<span class="next">Les textures</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lestextures"></a><h2>Les textures</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
<span class="arrow"></span>
<span class="next">Choisir les couleurs</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
<span class="next">Copier un matériau dans un autre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83707" data-claire-element-id="83707">En plus des paramètres colorimétriques basiques d'un matériau, il est aussi possible (heureusement !) d'appliquer une ou plusieurs textures à celui-ci. La texture est une image appliquée sur la surface d'un mesh, éventuellement avec une mise à l'échelle, un positionnement ou une rotation pour qu'elle se colle parfaitement sur des meshs qui peuvent être complexes.</p><aside id="r-83709" data-claire-element-id="83709" data-claire-semantic="warning"><p id="r-83708" data-claire-element-id="83708">Il est préférable d'utiliser des textures carrées dont la taille est une puissance de 2, les tailles quelconques pouvant poser des problèmes lors de certaines manipulations que l'on effectuera plus bas.<br/> Les textures que je vous propose dans les exemples respectent ces critères.</p></aside><h2 id="r-ajouter-une-texture-au-materiau" data-claire-element-id="83721">Ajouter une texture au matériau</h2><p id="r-83710" data-claire-element-id="83710">Pour les textures, tout se fait aussi dans les passes. On utilise pour cela le mot-clé <em>texture_unit</em> qui permet de définir un ensemble de paramètres pour la texture.</p><pre id="r-83711" data-claire-element-id="83711"><code>material cube
{
    technique
    {
        pass
        {
            ambient 1.0 1.0 1.0
            diffuse 1.0 1.0 1.0
            
            texture_unit
            {
            }
        }
    }
}</code></pre><p id="r-83712" data-claire-element-id="83712">Ensuite, il faut insérer le mot clé <em>texture</em> suivi du nom de fichier de la texture à appliquer. Je vais ici utiliser le fichier grass_1024.jpg qui se trouve dans le dossier OgreSDK/media/materials/textures/ et que j'ai copié dans le répertoire media de mon projet.</p><pre id="r-83713" data-claire-element-id="83713"><code>material cube
{
    technique
    {
        pass
        {
            ambient 1.0 1.0 1.0
            diffuse 1.0 1.0 1.0
            
            texture_unit
            {
                texture grass_1024.jpg
            }
        }
    }
}</code></pre><figure id="r-83715" data-claire-element-id="83716"><img id="r-83714" data-claire-element-id="83714" src="medias/uploads.siteduzero.com_files_306001_307000_306807.png" alt="Image utilisateur"/></figure><p id="r-83717" data-claire-element-id="83717">Pensez à faire attention à vos paramètres de couleur ambiante et diffuse du matériau, puisque celles-ci se mélangent à la texture. Si je met une couleur violette (1, 0, 1) par exemple, la texture se mélange à la couleur violette définie pour le cube :</p><figure id="r-83719" data-claire-element-id="83720"><img id="r-83718" data-claire-element-id="83718" src="medias/uploads.siteduzero.com_files_306001_307000_306808.png" alt="Image utilisateur"/></figure><h2 id="r-les-parametres-de-texture" data-claire-element-id="83742">Les paramètres de texture</h2><h3 id="r-rotation" data-claire-element-id="83729">Rotation</h3><p id="r-83722" data-claire-element-id="83722">Vous pouvez faire effectuer une rotation fixe à votre texture, dans le but de faire un ajustement par exemple. On utilise pour cela le mot <em>rotate</em> suivi de l'angle de rotation en degré dans le sens trigonométrique.</p><p id="r-83723" data-claire-element-id="83723">Pour l'exemple j'ai changé de texture afin que l'on visualise mieux la rotation, vous pouvez la récupérer dans le dossier OgreSDK/media/materials/textures/.</p><pre id="r-83724" data-claire-element-id="83724"><code>texture_unit
{
    texture 10points.png
    rotate 45
}</code></pre><p id="r-83725" data-claire-element-id="83725">La texture est ainsi tournée de 45 degrés sur toutes les faces.</p><figure id="r-83727" data-claire-element-id="83728"><img id="r-83726" data-claire-element-id="83726" src="medias/uploads.siteduzero.com_files_307001_308000_307895.png" alt="Image utilisateur"/></figure><h3 id="r-animation" data-claire-element-id="83741">Animation</h3><p id="r-83730" data-claire-element-id="83730">Il est aussi possible d'animer vos textures de façon tout à fait automatique avec des paramètres très simples du matériau.</p><p id="r-83731" data-claire-element-id="83731">Pour faire tourner la texture sur elle-même, on utilise le mot clé <em>rotate_anim</em> suivi du nombre de révolutions que la texture doit faire par seconde.</p><pre id="r-83732" data-claire-element-id="83732"><code>texture_unit
{
    texture grass_1024.jpg
    rotate_anim 1
}</code></pre><p id="r-83733" data-claire-element-id="83733">La commande <em>scroll_anim</em> permet de faire se déplacer la texture sur la surface du mesh de façon continue. Les paramètres qui suivent sont respectivement la vitesse sur l'axe X et sur l'axe Y dans le repère local.</p><pre id="r-83734" data-claire-element-id="83734"><code>texture_unit
{
    texture grass_1024.jpg
    scroll_anim 0.5 0.0
}</code></pre><p id="r-83735" data-claire-element-id="83735">Enfin, on peut aussi avoir un ensemble de textures appliquées à tour de rôle sur le mesh avec le mot <em>anim_texture</em>. Il y a pour cela deux solutions différentes. La première est de nommer l'ensemble des textures à utiliser puis de spécifier la durée d'un cycle.</p><pre id="r-83736" data-claire-element-id="83736"><code>texture_unit
{
    anim_texture grass_1024.jpg Dirt.jpg dirt01.jpg 3.0
}</code></pre><p id="r-83737" data-claire-element-id="83737">Ici on passera successivement les trois images sur une période de 3 secondes, soit une seconde par image.</p><p id="r-83738" data-claire-element-id="83738">Dans le cas où vos fichiers sont nommés maTexture_0.jpg, maTexture_1.jpg, maTexture_2.jpg, maTexture_3.jpg... il vous suffit d'indiquer le préfixe de vos textures suivi du nombre d'images à utiliser et enfin de la durée. Avec l'exemple des fichiers maTexture_*.jpg on obtiendrait les paramètres suivants :</p><pre id="r-83739" data-claire-element-id="83739"><code>texture_unit
{
    anim_texture maTexture.jpg 4 3.0
}</code></pre><p id="r-83740" data-claire-element-id="83740">L'application va donc rechercher les 4 fichiers de textures et les alterner sur une période de 3 secondes.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
<span class="arrow"></span>
<span class="next">Choisir les couleurs</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
<span class="next">Copier un matériau dans un autre</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Copierunmatriaudansunautre"></a><h2>Copier un matériau dans un autre</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
<span class="arrow"></span>
<span class="next">Les textures</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">
<span class="next">Les shaders (1/2)</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-definition-7" data-claire-element-id="83753">Définition</h2><p id="r-83744" data-claire-element-id="83744">Lorsque deux scripts de matériaux sont très semblables et n'ont que très peu de paramètres qui changent, il est possible de faire ce qu'on appelle de l'<em>héritage de script</em>.</p><p id="r-83745" data-claire-element-id="83745">L'héritage de script consiste à prendre un matériau déjà existant et à le copier dans un matériau fils pour y appliquer ensuite des modifications sans affecter le père.</p><p id="r-83746" data-claire-element-id="83746">Il fait bien noter que cette copie s'effectue lorsque les fichiers de matériaux sont parsés, c'est-à-dire lorsque l'on charge les ressources dans l'application, ce qui implique que les deux matériaux évoluent ensuite indépendamment l'un de l'autre. Ainsi, si l'on décide de modifier le matériau parent au cours de l'exécution de l'application, le matériau fils n'est pas affecté.</p><p id="r-83747" data-claire-element-id="83747">Pour faire hériter un matériau d'un autre, on utilise les deux points lors de la définition du fils.</p><pre id="r-83748" data-claire-element-id="83748"><code>material Fils : Parent
{
}</code></pre><p id="r-83749" data-claire-element-id="83749">Aussi, lorsque le matériau fils est lu, il est nécessaire que le matériau parent ait déjà été lu par l'application. Il y a deux moyens pour faire cela. Le premier est de placer le matériau parent avant le matériau fils dans le même fichier .material. La seconde est d'utiliser la directive <em>import</em> qui force la lecture d'un matériau à un moment donné.</p><pre id="r-83750" data-claire-element-id="83750"><code>import Parent from &quot;parent.material&quot;
material Fils : Parent
{
}</code></pre><p id="r-83751" data-claire-element-id="83751">On peut aussi importer l'ensemble des matériaux présents dans le fichier parent.material en utilisant l'astérisque.</p><pre id="r-83752" data-claire-element-id="83752"><code>import * from &quot;parent.material&quot;</code></pre><h2 id="r-en-pratique-3" data-claire-element-id="83781">En pratique</h2><p id="r-83754" data-claire-element-id="83754">Reprenons notre matériau cube que nous allons renommer en <em>cubePere</em> avec le contenu suivant :</p><pre id="r-83755" data-claire-element-id="83755"><code>material cubePere
{
    technique
    {
        pass
        {
            ambient 1.0 1.0 1.0
            diffuse 1.0 1.0 1.0
            
            texture_unit
            {
                texture 10points.png
            }
        }
    }
}</code></pre><p id="r-83756" data-claire-element-id="83756">À la suite, recréez le matériau <em>cube</em> héritant de cubePere.</p><pre id="r-83757" data-claire-element-id="83757"><code>material cube : cubePere
{
}</code></pre><p id="r-83758" data-claire-element-id="83758">En exécutant l'application on observe bien que le matériau cubePere a été copié dans le matériau cube.</p><figure id="r-83760" data-claire-element-id="83761"><img id="r-83759" data-claire-element-id="83759" src="medias/uploads.siteduzero.com_files_307001_308000_307898.png" alt="Image utilisateur"/></figure><p id="r-83762" data-claire-element-id="83762">Essayons maintenant de modifier le matériau fils en changeant par exemple la couleur ambiante pour masquer celles qui sont définies dans la matériau parent. Pour cela, on ouvre la technique et la passe et on ajoute le paramètre à modifier.</p><pre id="r-83763" data-claire-element-id="83763"><code>material cube : cubePere
{
    technique
    {
        pass
        {
            ambient 1.0 0.0 0.0
        }
    }
}</code></pre><aside id="r-83765" data-claire-element-id="83765" data-claire-semantic="warning"><p id="r-83764" data-claire-element-id="83764">Vérifiez bien que vous avez défini une lumière ambiante dans votre scène pour voir la différence !</p></aside><p id="r-83766" data-claire-element-id="83766">Le cube doit paraître semblable, mais des teintes de rouges ont fait leur apparition.</p><figure id="r-83768" data-claire-element-id="83769"><img id="r-83767" data-claire-element-id="83767" src="medias/uploads.siteduzero.com_files_307001_308000_307905.png" alt="Image utilisateur"/></figure><p id="r-83770" data-claire-element-id="83770">Comme vous pouvez le voir, l'intérêt de l'héritage de script est que l'on n'a à réécrire que ce que l'on veut modifier, tout le reste du matériau est inchangé !</p><p id="r-83771" data-claire-element-id="83771">On peut donc sans problème rajouter une animation à la texture sans avoir à préciser à nouveau le nom de celle-ci :</p><pre id="r-83772" data-claire-element-id="83772"><code>material cube : cubePere
{
    technique
    {
        pass
        {
            ambient 1.0 0.0 0.0

            texture_unit
            {
                rotate_anim 1
            }
        }
    }
}</code></pre><div id="r-83774" data-claire-element-id="83774" data-claire-semantic="question"><p id="r-83773" data-claire-element-id="83773">Et dans le cas où on utilise plusieurs passes ou techniques, comment fait-on pour en modifier une en particulier ?</p></div><p id="r-83775" data-claire-element-id="83775">C'est là que le nom des techniques et des passes devient utile. Il suffit d'utiliser le nom de la technique et/ou de la passe à modifier pour lever toute ambiguïté. De plus, avec le nommage automatique, on peut directement utiliser le nom généré.</p><p id="r-83776" data-claire-element-id="83776">Le dernier script sera donc équivalent au suivant, dans lequel j'ai indiqué que je voulais modifier la passe d'index 0 dans la technique d'index 0.</p><pre id="r-83777" data-claire-element-id="83777"><code>material cube : cubePere
{
    technique 0
    {
        pass 0
        {
            ambient 1.0 0.0 0.0

            texture_unit
            {
                rotate_anim 1
            }
        }
    }
}</code></pre><p id="r-83778" data-claire-element-id="83778">Ce n'est pas utile dans ce cas précis, mais cela le devient si vous avez un script comprenant différentes techniques et passes pour un même matériau.</p><p id="r-83779" data-claire-element-id="83779">Vous êtes maintenant capables de comprendre comment fonctionnent des matériaux simples, mais nous n'allons pas nous arrêter en si bon chemin !</p><p id="r-83780" data-claire-element-id="83780">L'objectif est de rester dans le thème des matériaux et de complexifier les méthodes de rendu en nous attelant à un sujet de taille : les shaders.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
<span class="arrow"></span>
<span class="next">Les textures</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">
<span class="next">Les shaders (1/2)</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesshaders1_2"></a><h2>Les shaders (1/2)</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
<span class="arrow"></span>
<span class="next">Copier un matériau dans un autre</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
<span class="next">Introduction</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-83784" data-claire-element-id="83784">Nous avons vu dans le chapitre précédent comment appliquer des couleurs et des textures à un matériau donné.</p><p id="r-83785" data-claire-element-id="83785">Mais l'application de ces paramètres se fait de façon totalement transparente pour nous et nulle part nous n'avons eu à indiquer la couleur de chaque pixel de notre objet ni à indiquer la façon dont la texture doit être plaquée sur les faces du mesh.</p><p id="r-83786" data-claire-element-id="83786">L'objectif de ce chapitre est de présenter les shaders, qui remplaceront le mécanisme automatique d'Ogre et permettent d'avoir un grand contrôle sur le rendu des matériaux afin d'obtenir des effets très élaborés.</p><aside id="r-83788" data-claire-element-id="83788" data-claire-semantic="information"><p id="r-83787" data-claire-element-id="83787">Dans ce chapitre, nous reprennons le même projet que dans le chapitre précédent. Aucun changement dans le code n'est nécessaire, nous allons uniquement travailler sur les fichiers de ressources.</p></aside>
</div><a name="Introduction"></a><h2>Introduction</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">
<span class="arrow"></span>
<span class="next">Les shaders (1/2)</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
<span class="next">Un shader simple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-qu-est-ce-qu-un-shader" data-claire-element-id="83791">Qu'est-ce qu'un shader ?</h2><p id="r-83789" data-claire-element-id="83789">Un shader est un programme qui s'exécute au moment du rendu graphique pour paramétrer la façon dont la carte graphique va représenter à l'écran des meshs soumis à une certaine texture, à des conditions d'éclairage particulières et à toute influence extérieure susceptible de modifier l'apparence d'un matériau.</p><p id="r-83790" data-claire-element-id="83790">Ce sont les shaders qui permettent d'avoir un rendu réaliste d'une image de synthèse en complexifiant le rendu de meshs simples pour générer un matériau complexe. On peut ainsi donner du relief à un plan simple en jouant sur la couleur que l'on va donner à sa texture pour simuler des différences d'éclairage.</p><h2 id="r-les-differents-langages" data-claire-element-id="83799">Les différents langages</h2><p id="r-83792" data-claire-element-id="83792">Les shaders ne sont pas écrits en C++ mais dans un langage dédié qui facilite leur écriture. À l'origine on utilisait l'assembleur mais sa complexité rendait les programmes difficiles à écrire, c'est pourquoi il existe aujourd'hui 3 principaux langages de shaders qui sont assez proches du C.</p><h3 id="r-hlsl" data-claire-element-id="83794">HLSL</h3><p id="r-83793" data-claire-element-id="83793">HLSL signifie <em>High Level Shading Language</em> et il est à mon avis celui que vous avez le plus de chances de connaître (au moins de nom) puisqu'il bénéficie du soutient direct de Microsoft. La sortie de DirectX 8 (développé par la firme de Bill Gates) a été l'occasion pour la société de sortir la première version du HLSL qui est donc compatible uniquement avec cette API. Ce langage de shaders étant le premier à proposer une syntaxe proche du C, en opposition avec l'assembleur utilisé jusqu'alors, il a rapidement gagné en popularité.</p><h3 id="r-glsl" data-claire-element-id="83796">GLSL</h3><p id="r-83795" data-claire-element-id="83795">DirectX ayant son propre langage de shaders, il en fallait un pour son concurrent, OpenGL. GLSL, pour <em>Open GL Shading Language</em>, est ce langage dédié à l'API OpenGL, il a été développé par l'OpenGL Architecture Review Board et sa syntaxe est aussi similaire au C.</p><h3 id="r-cg" data-claire-element-id="83798">Cg</h3><p id="r-83797" data-claire-element-id="83797">Cg est un langage de shaders développé par nVidia, lui aussi proche du langage C comme le dit son nom : <em>C for Graphics</em>. Un grand avantage de ce langage est qu'il est compatible avec OpenGL et avec DirectX, il n'est donc pas nécessaire d'écrire vos programmes de shaders en double si vous voulez la compatibilité pour DirectX et OpenGL. Comme tout le monde n'est pas forcément sous Windows, c'est ce langage que je vais utiliser dans ce chapitre.</p><h2 id="r-trois-types-de-shaders" data-claire-element-id="83807">Trois types de shaders</h2><p id="r-83800" data-claire-element-id="83800">Il existe au niveau du rendu trois type différents de shaders qui sont appelés successivement et qui ont chacun un rôle dédié dans le traitement de l'image.</p><h3 id="r-vertex-shader" data-claire-element-id="83802">Vertex Shader</h3><p id="r-83801" data-claire-element-id="83801">Le vertex shader est celui qui est utilisé en premier, il s'exécute pour chaque vertex du mesh (ou de la partie d'un mesh) auquel s'applique le matériau concerné. La tâche de base du vertex shader est de transformer les coordonnées 3D d'un vertex en coordonnées 2D, c'est-à-dire qu'il fait la projection du monde 3D sur votre écran. Il est aussi en mesure d'effectuer des calculs sur les textures à appliquer ou sur la lumière arrivant sur le vertex afin de passer un maximum d'informations au pixel shader.</p><h3 id="r-geometry-shader" data-claire-element-id="83804">Geometry Shader</h3><p id="r-83803" data-claire-element-id="83803">C'est le type de shader le plus récent, apparu avec DirectX 10. Il s'exécute après le vertex shader et permet de modifier la géométrie d'un polygone ou d'en créer de nouveaux. Nous ne l'utiliserons pas dans ce cours, je ne m'y attarde donc pas.</p><h3 id="r-fragment-shader-ou-pixel-shader" data-claire-element-id="83806">Fragment Shader ou Pixel Shader</h3><p id="r-83805" data-claire-element-id="83805">Ce shader est le dernier qui est appelé et s'exécute pour chaque pixel du rendu d'un objet donné. À partir des informations données par le vertex shader, il détermine la couleur du pixel en train d'être rendu en fonction de sa position, de la texture censée s'appliquer au mesh, de la lumière...</p><h2 id="r-les-plugins" data-claire-element-id="83813">Les plugins</h2><p id="r-83808" data-claire-element-id="83808">Pour utiliser Cg, il faut que votre fichier plugins.cfg contienne la ligne suivante :</p><pre id="r-83809" data-claire-element-id="83809"><code>Plugin=Plugin_CgProgramManager</code></pre><p id="r-83810" data-claire-element-id="83810">Elle est écrite dans le fichier fourni par défaut avec Ogre.</p><p id="r-83811" data-claire-element-id="83811">Par ailleurs, vous devrez avoir les DLL <em>cg.dll</em> et <em>Plugin_CgProgramManager.dll</em> copiées dans le répertoire de votre exécutable.</p><p id="r-83812" data-claire-element-id="83812">Une fois que c'est fait, votre projet est prêt à utiliser les shaders.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">
<span class="arrow"></span>
<span class="next">Les shaders (1/2)</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
<span class="next">Un shader simple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Unshadersimple"></a><h2>Un shader simple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
<span class="arrow"></span>
<span class="next">Introduction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
<span class="next">Les textures via les shaders</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83815" data-claire-element-id="83815">Pour commencer, nous allons faire un premier shader très simple. L'objectif est de faire apparaitre un cube d'une couleur donnée et uniforme, ce qui reviendra à avoir un éclairage de type ambiant uniquement, comme on l'a vu dans le chapitre précédent, mais sans aucune lumière ambiante ni de définition de couleur dans notre matériau.</p><div id="r-83817" data-claire-element-id="83817" data-claire-semantic="question"><p id="r-83816" data-claire-element-id="83816">De quoi a-t-on besoin ?</p></div><p id="r-83818" data-claire-element-id="83818">Étant donné que nous voulons donner une couleur opaque à notre cube, nous n'aurons besoin que d'écrire un pixel shader pour que chaque pixel du cube soit affiché de la couleur que nous demandons.</p><h2 id="r-le-pixel-shader" data-claire-element-id="83849">Le pixel shader</h2><h3 id="r-definition-du-programme" data-claire-element-id="83840">Définition du programme</h3><p id="r-83819" data-claire-element-id="83819">Ouvrez votre fichier tuto.material et ajoutez les lignes suivantes avant la définition du matériau du cube.</p><pre id="r-83820" data-claire-element-id="83820"><code>fragment_program Green_PS cg
{
    source myshader.cg
    entry_point main_fp
    profiles ps_1_1 arbfp1
}</code></pre><p id="r-83821" data-claire-element-id="83821">Le première ligne indique que l'on définit un pixel shader (ou fragment shader) de nom Green_PS et qui utilise le langage cg. Pour définir un vertex shader en HLSL par exemple, on aurait écrit cette ligne :</p><pre id="r-83822" data-claire-element-id="83822"><code>vertex_program Green_VS hlsl</code></pre><aside id="r-83824" data-claire-element-id="83824" data-claire-semantic="information"><p id="r-83823" data-claire-element-id="83823">On essayera de nommer les shaders de façon reconnaissable, par exemple avec un suffixe qui indique son type : VS (vertex shader) ou PS (pixel shader)</p></aside><p id="r-83825" data-claire-element-id="83825">Dans le corps, le mot clé <em>source</em> indique le nom du fichier dans lequel se trouve le programme du shader. Ce fichier doit se trouver dans les ressources chargées par Ogre. Ensuite on renseigne le point d'entrée, c'est à dire le nom de la fonction à exécuter dans le fichier source.</p><p id="r-83826" data-claire-element-id="83826">Enfin, on peut définir un ou plusieurs profils pour le shader. Chaque profil correspond à une façon de compiler le programme, notamment vis-à-vis de l'API graphique (DirectX ou OpenGL) et de la version de shaders utilisés. Le premier profil compatible trouvé dans la liste sera utilisé, si aucun n'est compatible le shader n'est pas exécuté et la texture apparaît blanche. Ici, <em>ps_1_1</em> demande de compiler avec un ancien pixel shader de DirectX tandis que <em>arbfp1</em> utilisera OpenGL. Si vous avez choisi d'utiliser OpenGL dans la configuration de votre application, c'est donc ce second profil qui sera utilisé.</p><p id="r-83827" data-claire-element-id="83827">Il faut maintenant appeler le pixel shader dans la définition du matériau. Ceci se fait dans une passe, en écrivant le type de programme demandé (ici fragment_program) avec le suffixe &quot;_ref&quot; puis le nom du programme.</p><pre id="r-83828" data-claire-element-id="83828"><code>material cube
{
    technique
    {
        pass
        {
            fragment_program_ref Green_PS
            {
            }
        }
    }
}</code></pre><p id="r-83829" data-claire-element-id="83829">Ainsi, lorsque le matériau sera lu, l'application verra qu'il lui faut utiliser le pixel shader nommé Green_PS. En lisant le programme, elle analysera notamment les profils et déterminera à partir de ceux-ci si elle peut les compiler et s'il faut donc lire la suite du shader.</p><div id="r-83831" data-claire-element-id="83831" data-claire-semantic="question"><p id="r-83830" data-claire-element-id="83830">La suite ? On n'a pas encore fini ?</p></div><p id="r-83832" data-claire-element-id="83832">Non ! Nous n'avons fait que définir le shader, nous n'avons encore rien écrit pour définir la façon dont sera rendu le matériau !</p><p id="r-83833" data-claire-element-id="83833">Il faut donc maintenant créer le fichier myshader.cg qui est défini comme la source contenant le code du shader. Dans celui-ci, nous devons écrire la fonction main_fp qui constitue le point d'entrée du programme.</p><pre id="r-83834" data-claire-element-id="83834"><code data-claire-semantic="c">void main_fp(out float4 oColor : COLOR)
{
}</code></pre><p id="r-83835" data-claire-element-id="83835">J'ai défini une fonction de type <code data-claire-semantic="c">void</code> avec un seul paramètre d'entrée nommé oColor. Son type est un float4, c'est-à-dire que c'est un vecteur (un conteneur) ayant 4 composantes de type float, qui nous servirons à donner la couleur des pixels. Le mot <em>out</em> quant à lui permet de dire que oColor est un paramètre de sortie, il se comporte un peu comme un pointeur : il continuera d'exister à la fin de la fonction et sera récupéré pour trouver la couleur du matériau. Le mot COLOR à la fin séparé par les deux points indique au programme que ce paramètre est une couleur. Il est facultatif car la couleur est le seul argument de sortie d'un pixel shader mais je conseille de le placer par rigueur.</p><div id="r-83837" data-claire-element-id="83837" data-claire-semantic="question"><p id="r-83836" data-claire-element-id="83836">Pourquoi n'a-t-on pas de paramètre d'entrée ?</p></div><p id="r-83838" data-claire-element-id="83838">Dans notre cas, nous donnons la même couleur à tous les pixels de notre mesh, nous n'avons donc pas besoin de savoir sur quel pixel on travaille : ils seront tous rendus de la même façon.</p><p id="r-83839" data-claire-element-id="83839">Ceci étant dit, généralement les paramètres d'entrée d'un pixel shader sont les paramètres de sortie du vertex shader associé, qui sont choisis par le programmeur en fonction de ses besoins. La complémentarité des calculs de ces deux entités est essentielle dans le fonctionnement des shaders, il n'est pas possible de réaliser d'effets complexes sans cette relation.</p><h3 id="r-choix-de-la-couleur-des-pixels" data-claire-element-id="83848">Choix de la couleur des pixels</h3><p id="r-83841" data-claire-element-id="83841">On peut accéder aux 4 éléments d'un float4 en appelant les composantes r, g, b, a ou bien x, y, z, w. J'utilise ici la première solution pour un souci de lisibilité, puisque l'on traite des couleurs. La composante &quot;a&quot;, pour <em>alpha</em>, est utilisée pour définir la transparence du matériau, nous ne nous en servirons pas dans cet exemple.</p><p id="r-83842" data-claire-element-id="83842">Je vais donc remplir mes composantes pour donner la couleur verte à mon matériau, je met donc le vert à une valeur de 1 et le reste à 0.</p><pre id="r-83843" data-claire-element-id="83843"><code data-claire-semantic="c">void main_fp(out float4 oColor : COLOR)
{
    oColor.r = 0.0;
    oColor.g = 1.0;
    oColor.b = 0.0;
    oColor.a = 0.0;
}</code></pre><p id="r-83844" data-claire-element-id="83844">Enregistrez le fichier et exécutez votre application, vous devriez voir apparaître votre cube sous une couleur verte.</p><figure id="r-83846" data-claire-element-id="83847"><img id="r-83845" data-claire-element-id="83845" src="medias/uploads.siteduzero.com_files_308001_309000_308259.png" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
<span class="arrow"></span>
<span class="next">Introduction</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
<span class="next">Les textures via les shaders</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lestexturesvialesshaders"></a><h2>Les textures via les shaders</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
<span class="arrow"></span>
<span class="next">Un shader simple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">
<span class="next">Animer les meshes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83851" data-claire-element-id="83851">Nous avons appris dans la partie précédente à colorer un objet grâce au pixel shader. Cette partie va être l'occasion de plaquer une texture sur un objet en utilisant un programme Cg et de la modifier un peu dans les shaders.</p><p id="r-83852" data-claire-element-id="83852">Avant de passer au code, voyons comment les textures sont plaquées sur le meshs.</p><h2 id="r-le-placage-de-textures" data-claire-element-id="83866">Le placage de textures</h2><h3 id="r-le-systeme-de-coordonnees-1" data-claire-element-id="83858">Le système de coordonnées</h3><p id="r-83853" data-claire-element-id="83853">Lorsque l'on considère une texture, celle-ci possède un système de coordonnées qui permet de repérer un point dans l'image. C'est un système en deux dimensions avec l'axe X orienté vers la droite et l'axe Y vers le bas. L'origine du repère se trouve en haut à gauche et le point (1, 1) est le coin inférieur droit.</p><figure id="r-83855" data-claire-element-id="83856"><img id="r-83854" data-claire-element-id="83854" src="medias/uploads.siteduzero.com_files_308001_309000_308349.jpg" alt="Image utilisateur"/></figure><p id="r-83857" data-claire-element-id="83857">Tout point de l'image peut donc être identifié par ses coordonnées (x, y), x et y étant compris entre 0 et 1.</p><h3 id="r-placage-sur-mesh" data-claire-element-id="83865">Placage sur mesh</h3><p id="r-83859" data-claire-element-id="83859">Lorsque l'on veut plaquer la texture sur une face d'un mesh, il faut savoir comment placer la texture. En effet, comment l'image doit-elle être orientée ? Doit-elle occuper toute la surface ou bien doit-elle être réduite et copiée plusieurs fois pour éviter d'être trop élargie ? Ceci n'est pas évident et doit être précisé lors du collage de la texture.</p><p id="r-83860" data-claire-element-id="83860">Ainsi, considérons la face carrée d'un cube sur laquelle nous voulons plaquer une texture. Chacun de ses vertex va se voir attribuer des coordonnées dans le repère de la texture, qui permettront de déterminer quelle partie de l'image doit être collé à cet endroit donné.</p><figure id="r-83862" data-claire-element-id="83863"><img id="r-83861" data-claire-element-id="83861" src="medias/uploads.siteduzero.com_files_308001_309000_308415.png" alt="Image utilisateur"/></figure><p id="r-83864" data-claire-element-id="83864">Une fois que chaque vertex a reçu ses coordonnées de texture, l'ordinateur effectue une interpolation linéaire des valeurs entre les vertex pour déterminer les coordonnées de texture de chaque point de la face. Ainsi, le point situé à mi-chemin des vertex ayant pour coordonnées de texture (0, 0) et (1, 0) aura les coordonnées (0.5, 0).</p><h2 id="r-le-vertex-shader" data-claire-element-id="83892">Le vertex shader</h2><p id="r-83867" data-claire-element-id="83867">Modifions le matériau pour avoir un appel à un vertex shader et un appel à un pixel shader nommés respectivement Texture_VS et Texture_PS. Il faut aussi choisir la texture que nous allons utiliser de la même manière qu'on le faisait jusqu'alors dans le bloc texture_unit.</p><pre id="r-83868" data-claire-element-id="83868"><code>material cube
{
    technique                    
    {
        pass                    
        {
            vertex_program_ref Texture_VS    
            {
            }
            fragment_program_ref Texture_PS    
            {
            }
            texture_unit
            {
                texture 10points.png
            }
        }
    }
}</code></pre><p id="r-83869" data-claire-element-id="83869">La définition du vertex shader est basée sur le même principe que le pixel shader : on définit un fichier source, un point d'entrée et les profils à utiliser. Pour ces derniers, vs_1_1 correspond à un vertex shader DirectX tandis que arbvp1 est pour OpenGL.</p><pre id="r-83870" data-claire-element-id="83870"><code>vertex_program Texture_VS cg            
{
    source myshader.cg           
    entry_point main_texture_vp  
    profiles vs_1_1 arbvp1
}

fragment_program Texture_PS cg            
{
    source myshader.cg          
    entry_point main_texture_fp    
    profiles ps_1_1 arbfp1
}</code></pre><p id="r-83871" data-claire-element-id="83871">Dans votre fichier myshader.cg, il faut écrire le code du vertex shader, dont voici les arguments.</p><pre id="r-83872" data-claire-element-id="83872"><code>void main_texture_vp(
        float4 position     : POSITION,
        float2 texCoord0    : TEXCOORD0,

        out float4 oPosition  : POSITION,
        out float2 uv0        : TEXCOORD0,

        uniform float4x4 worldViewProj)
{
}</code></pre><p id="r-83873" data-claire-element-id="83873">Comme vous le voyez, il y a plus de monde que tout à l'heure !</p><p id="r-83874" data-claire-element-id="83874">Les deux premiers paramètres sont les paramètres d'entrée, qui sont donnés pour chaque vertex du modèle qui reçoit le matériau. Nous avons la position du vertex dans le repère du modèle et la coordonnée du vertex par rapport à la texture, de type TEXCOORD0.</p><p id="r-83875" data-claire-element-id="83875">En sortie, on a la position du vertex par rapport à la fenêtre de l'application et la coordonnée de texture qui a pu être modifiée.</p><p id="r-83876" data-claire-element-id="83876">Enfin, on a un dernier argument de type float4x4, qui représente une matrice servant à la transformation de la position du vertex dans le repère du modèle en une position sur l'écran. Le calcul de cette matrice est un peu complexe et nous allons donc laisser Ogre s'en charger, grâce au mot-clé <em>uniform</em>.</p><p id="r-83877" data-claire-element-id="83877">Ce mot indique que l'argument en question a été déclaré dans le fichier .material et qu'il faut aller voir dedans quelle est sa valeur.</p><div id="r-83879" data-claire-element-id="83879" data-claire-semantic="question"><p id="r-83878" data-claire-element-id="83878">Mais on n'a pas écrit à quoi correspond worldViewProj dans le fichier tuto.material !</p></div><p id="r-83880" data-claire-element-id="83880">C'est exact, nous allons donc corriger cela tout de suite. Retrouvez la définition du programme Texture_VS et rajoutez le bloc de code manquant.</p><pre id="r-83881" data-claire-element-id="83881"><code>vertex_program Texture_VS cg            
{
    source myshader.cg           
    entry_point main_texture_vp  
    profiles vs_1_1 arbvp1

    default_params                    
    {
        param_named_auto worldViewProj worldviewproj_matrix        
    }
}</code></pre><p id="r-83882" data-claire-element-id="83882">On a définit un bloc qui permet de créer des paramètres par défaut pour notre programme. Ces paramètres peuvent être calculés automatiquement par Ogre, auquel cas on les spécifie en tant que <em>param_named_auto</em>, ou bien être écrits à la main, ils seront alors précédés de <em>param_named</em>.</p><p id="r-83883" data-claire-element-id="83883">Dans ce cas précis, on définit le paramètre worldViewProj qu'Ogre va remplacer automatiquement par la valeur de worldviewproj_matrix, qu'il calcule lui-même (c'est un mot réservé).</p><aside id="r-83885" data-claire-element-id="83885" data-claire-semantic="information"><p id="r-83884" data-claire-element-id="83884">Vous pouvez trouver l'ensemble des valeurs possible pour un paramètre de type param_named_auto sur <a href="http://www.ogre3d.org/docs/manual/manual_23.html">cette page</a> du manuel d'Ogre 3d.</p></aside><p id="r-83886" data-claire-element-id="83886">Revenons à notre vertex shader. Nous voulons faire le calcul de nos deux paramètres de sortie pour qu'ils contiennent les valeurs attendues par Ogre.</p><p id="r-83887" data-claire-element-id="83887">J'ai dit plus haut que la position du vertex dans le repère de l'écran était calculée grâce à la matrice worldViewProj. C'est en fait une simple multiplication de cette matrice avec la position d'entrée qui suffit à obtenir le résultat. Attention toutefois, la multiplication se fait à l'aide de la fonction mul() conçue pour multiplier des matrices.</p><pre id="r-83888" data-claire-element-id="83888"><code>oPosition = mul(worldViewProj, position);</code></pre><p id="r-83889" data-claire-element-id="83889">Pour la texture, nous n'allons pas faire de modification dans un premier temps et recopier la valeur de texCoord0 dans uv0.</p><p id="r-83890" data-claire-element-id="83890">La fonction main_texture_vp() doit donc finalement être celle-ci :</p><pre id="r-83891" data-claire-element-id="83891"><code>void main_texture_vp(
        float4 position     : POSITION,
        float2 texCoord0    : TEXCOORD0,

        out float4 oPosition  : POSITION,
        out float2 uv0        : TEXCOORD0,

        uniform float4x4 worldViewProj)
{
    oPosition = mul(worldViewProj, position);

    uv0 = texCoord0;
}</code></pre><h2 id="r-le-pixel-shader-1" data-claire-element-id="83904">Le pixel shader</h2><p id="r-83893" data-claire-element-id="83893">Occupons-nous à présent du pixel shader représenté par la fonction main_texture_fp() suivante :</p><pre id="r-83894" data-claire-element-id="83894"><code>void main_texture_fp(
        float2 uv0          : TEXCOORD0,
        out float4 color    : COLOR,
        uniform sampler2D texture)
{
}</code></pre><p id="r-83895" data-claire-element-id="83895">En entrée on trouve le paramètre uv0 qui est calculé à partir du paramètre équivalent issu du vertex shader que nous avons créé plus haut. En sortie nous avons toujours la couleur du pixel que nous sommes en train de traiter. On a aussi un paramètre de type uniform qui est la texture choisie pour le matériau indiquée dans le bloc texture_unit de la définition du matériau.</p><p id="r-83896" data-claire-element-id="83896">Tandis que dans le premier exemple nous avions simplement attribué une couleur identique à tous les pixels de l'objet, ici nous allons choisir la couleur du pixel en fonction de l'endroit de la texture qu'il est censé représenter.</p><p id="r-83897" data-claire-element-id="83897">Pour cela, nous avons besoin de la texture elle-même d'une part et de la coordonnée du pixel dans la texture d'autre part. Pour combiner ces deux paramètres nous utilisons la fonction tex2D qui renvoie la couleur du point de coordonnée uv0 dans la texture. Cette couleur est ensuite appliquée au pixel actuellement rendu.</p><p id="r-83898" data-claire-element-id="83898">Nous n'avons donc qu'une seule ligne à placer dans la fonction :</p><pre id="r-83899" data-claire-element-id="83899"><code>color = tex2D(texture, uv0);</code></pre><p id="r-83900" data-claire-element-id="83900">Au rendu, nous avons bien une belle texture plaquée sur chaque face du cube.</p><figure id="r-83902" data-claire-element-id="83903"><img id="r-83901" data-claire-element-id="83901" src="medias/uploads.siteduzero.com_files_308001_309000_308335.png" alt="Image utilisateur"/></figure><h2 id="r-jouons-avec-les-coordonnees-de-texture" data-claire-element-id="83925">Jouons avec les coordonnées de texture</h2><p id="r-83905" data-claire-element-id="83905">Reprenons le code de notre vertex shader, notamment la partie où nous recopions la valeur de texCoord0 dans uv0.</p><pre id="r-83906" data-claire-element-id="83906"><code>uv0 = texCoord0;</code></pre><p id="r-83907" data-claire-element-id="83907">Supposons que nous voulions effectuer un décalage de la texture vers la gauche et vers le haut, plutôt que de la plaquer directement de façon centrée sur le cube. Il suffit de ne faire qu'une seul chose : modifier la valeur du paramètre uv0 pour que celui-ci prenne en compte le décalage.</p><p id="r-83908" data-claire-element-id="83908">Ainsi, nous allons décaler l'image de 20% à gauche et en haut. Le point ayant les coordonnées de texture (0, 0) devra donc avoir les coordonnées (0.2, 0.2). Il suffit par conséquent de rajouter la valeur (0.2, 0.2) au paramètre uv0 pour appliquer la modification.</p><pre id="r-83909" data-claire-element-id="83909"><code>uv0 = texCoord0 + float2(0.2, 0.2);</code></pre><p id="r-83910" data-claire-element-id="83910">Avec ce changement, la texture est bien appliquée différemment sur le cube, avec le décalage prévu.</p><figure id="r-83912" data-claire-element-id="83913"><img id="r-83911" data-claire-element-id="83911" src="medias/uploads.siteduzero.com_files_308001_309000_308336.png" alt="Image utilisateur"/></figure><p id="r-83914" data-claire-element-id="83914">On peut aussi choisir de réduire la taille de la texture pour en plaquer plusieurs sur une même face. Il suffit pour cela d'ajouter un facteur multiplicatif aux coordonnées.</p><pre id="r-83915" data-claire-element-id="83915"><code>uv0 = texCoord0 * 2;</code></pre><figure id="r-83917" data-claire-element-id="83918"><img id="r-83916" data-claire-element-id="83916" src="medias/uploads.siteduzero.com_files_308001_309000_308420.png" alt="Image utilisateur"/></figure><p id="r-83919" data-claire-element-id="83919">Nous ne sommes d'ailleurs pas obligés de conserver la format carré de la texture et on peut décider de réduire sa largeur par exemple.</p><pre id="r-83920" data-claire-element-id="83920"><code>uv0.x = texCoord0.x * 2;
uv0.y = texCoord0.y;</code></pre><figure id="r-83922" data-claire-element-id="83923"><img id="r-83921" data-claire-element-id="83921" src="medias/uploads.siteduzero.com_files_308001_309000_308421.png" alt="Image utilisateur"/></figure><p id="r-83924" data-claire-element-id="83924">Cette première partie sur les shaders touche déjà à sa fin mais a permis de vous introduire à cet outil pas forcément évident à prendre en main avec les notions de base. La seconde partie sera l'occasion de prendre en compte les lumières de la scène, que nous avons jusqu'ici ignorées.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
<span class="arrow"></span>
<span class="next">Un shader simple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">
<span class="next">Animer les meshes</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Animerlesmeshes"></a><h2>Animer les meshes</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
<span class="arrow"></span>
<span class="next">Les textures via les shaders</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
<span class="next">Utiliser les quaternions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-83929" data-claire-element-id="83929">Nous savons ajouter des meshes dans une scène, les positionner en déplaçant le noeud auquel il sont rattachés voire même les faire bouger en temps réel si l'on décide de lier leur mouvement aux entrées clavier par exemple. Mais qu'en est-il si l'on veut animer un mesh ? Un personnage qui se déplace ne peut assurément pas le faire de façon réalise s'il reste droit comme un piquet !</p><p id="r-83930" data-claire-element-id="83930">L'objet de ce chapitre est l'animation de meshes et leur déplacement suivant un chemin prédéfini constitué de points de passage multiples. Nous avons suffisamment observé nos meshes sous toutes les coutures, il est temps de faire bouger les objets tout seuls !</p>
</div><a name="Utiliserlesquaternions"></a><h2>Utiliser les quaternions</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">
<span class="arrow"></span>
<span class="next">Animer les meshes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
<span class="next">Gérer les animations d&#039;un mesh</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-presentation-24" data-claire-element-id="83933">Présentation</h2><p id="r-83931" data-claire-element-id="83931">Un quaternion est un objet mathématique qui représente des transformations dans l'espace. Il est semblable aux matrices que l'on étudie dans l'enseignement supérieur à cela près qu'il se limite à la représentation des rotations uniquement.</p><p id="r-83932" data-claire-element-id="83932">Un quaternion sera donc utilisé si l'on souhaite connaître ou définir l'orientation d'un objet dans l'espace, ou bien pour ajouter une rotation à l'orientation existante de l'objet. Il est par exemple très simple avec un quaternion de dire &quot;je veux que cet objet tourne de 20 degrés par rapport à son axe Y et de 10 degrés par rapport à l'axe X&quot; ou encore &quot;le personnage doit regarder dans la direction de l'axe Z de l'espace&quot;.</p><h2 id="r-utilisation-3" data-claire-element-id="83955">Utilisation</h2><h3 id="r-travailler-sur-les-noeuds" data-claire-element-id="83940">Travailler sur les noeuds</h3><p id="r-83934" data-claire-element-id="83934">De même que pour le déplacement des objets, leur rotation passe par la manipulation du noeud de scène correspondant. Il est donc logique de retrouver quelques méthodes liées aux quaternions dans la classe SceneNode.</p><p id="r-83935" data-claire-element-id="83935">Pour récupérer le quaternion représentant l'orientation actuelle d'un noeud, on utilisera la méthode getOrientation() de notre classe. Dans l'autre sens, setOrientation() permet de définir le quaternion à utiliser pour orienter un noeud.</p><pre id="r-83936" data-claire-element-id="83936"><code data-claire-semantic="cpp">virtual const Quaternion&amp; Ogre::Node::getOrientation() const
virtual void Ogre::Node::setOrientation(const Quaternion &amp; q)</code></pre><p id="r-83937" data-claire-element-id="83937">Il n'est pas obligatoire de passer par la méthode setOrientation() pour modifier l'orientation d'un objet. Pour effectuer une modification par rapport à une orientation connue, la méthode rotate() est toute trouvée.</p><pre id="r-83938" data-claire-element-id="83938"><code data-claire-semantic="cpp">virtual void Ogre::Node::rotate(const Quaternion &amp; q, TransformSpace relativeTo = TS_LOCAL);</code></pre><p id="r-83939" data-claire-element-id="83939">Le premier argument est le quaternion représentant la modification que l'on souhaite apporter à l'orientation du noeud, comme une rotation de quelques degrés suivant un axe précis. Cette rotation sera alors ajoutée à l'orientation précédente. En second on donne le repère dans lequel la rotation doit avoir lieu, par défaut c'est le repère local de l'objet, correspondant à la plupart des cas d'utilisation de cette fonction (on désire le plus souvent faire tourner un objet sur lui-même pour le faire regarder dans une certaine direction).</p><h3 id="r-construction-d-un-quaternion" data-claire-element-id="83950">Construction d'un quaternion</h3><p id="r-83941" data-claire-element-id="83941">La question qui se pose maintenant est de savoir comment construire le quaternion qui va permettre d'orienter le mesh dans la direction que vous désirez.</p><p id="r-83942" data-claire-element-id="83942">Si la rotation à effectuer est simple et ne dépend que d'un seul axe, vous pouvez construire le quaternion à partir de cet axe et de l'angle désiré de la rotation.</p><pre id="r-83943" data-claire-element-id="83943"><code data-claire-semantic="cpp">Ogre::Quaternion::Quaternion (const Radian &amp; rfAngle, const Vector3 &amp; rkAxis);</code></pre><p id="r-83944" data-claire-element-id="83944">Une autre méthode possible est de calculer la rotation a effectuer entre deux vecteurs connus orthogonaux à cet axe de rotation.</p><p id="r-83945" data-claire-element-id="83945">Par exemple, votre mesh est une voiture qui évolue sur un terrain plat. Les rotations qu'elle effectue seront des rotations par rapport à l'axe vertical Y uniquement. Les deux vecteurs qui permettent de définir la rotation seraient d'une part celui qui est orienté dans le sens de la marche de la voiture avant d'entamer la rotation, et d'autre part celui qui sera orienté dans le sens de la marche à la fin de la rotation.</p><p id="r-83946" data-claire-element-id="83946">Dans un tel cas, la récupération du quaternion de rotation se fait via la méthode getRotationTo() de la classe Ogre::Vector3.</p><pre id="r-83947" data-claire-element-id="83947"><code data-claire-semantic="cpp">Ogre::Vector3 oldDirection, newDirection;
//...
Ogre::Quaternion quat = oldDirection.getRotationTo(newDirection);</code></pre><p id="r-83948" data-claire-element-id="83948">Il suffit ainsi de donner ce quaternion en paramètre de la méthode rotate() pour que le mesh subisse une rotation de l'angle désiré.</p><p id="r-83949" data-claire-element-id="83949">Obtenir la direction dans laquelle on désire aller est relativement simple puisqu'il suffit de connaître la position de notre objet et un point dans la direction de laquelle on désire aller. Mais comment allons-nous savoir quelle est la direction dans laquelle regarde actuellement notre mesh ?</p><h3 id="r-multiplication-d-un-vecteur-avec-un-quaternion" data-claire-element-id="83954">Multiplication d'un vecteur avec un quaternion</h3><p id="r-83951" data-claire-element-id="83951">Supposons que vous désirez connaître, dans le repère de la scène, les coordonnées d'un vecteur que vous connaissez dans le repère local du mesh. Par exemple, vous savez que dans son repère local, votre personnage regarde dans le sens de l'axe Z. Comment pouvez-vous récupérer cette même direction dans le repère global ?<br/> La solution est simple : il suffit de multiplier le quaternion d'orientation du noeud avec le vecteur qui représente l'axe Z !</p><pre id="r-83952" data-claire-element-id="83952"><code data-claire-semantic="cpp">Ogre::Vector3 globalDirection = node-&gt;getOrientation() * Ogre::Vector3::UNIT_Z;</code></pre><p id="r-83953" data-claire-element-id="83953">Ceci permet de récupérer le vecteur d'origine de la rotation afin d'avoir le quaternion servant à nous orienter dans une nouvelle direction grâce à la méthode getRotationTo().</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">
<span class="arrow"></span>
<span class="next">Animer les meshes</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
<span class="next">Gérer les animations d&#039;un mesh</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Grerlesanimationsd039unmesh"></a><h2>Gérer les animations d&#039;un mesh</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
<span class="arrow"></span>
<span class="next">Utiliser les quaternions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
<span class="next">Suivez le chemin !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-definition-8" data-claire-element-id="83961">Définition</h2><p id="r-83957" data-claire-element-id="83957">Qu'entend-on par le terme &quot;animation&quot; pour un mesh ?</p><p id="r-83958" data-claire-element-id="83958">Vous n'êtes pas sans savoir qu'un mesh est constitué de polygones qui, juxtaposés les uns aux autres, constituent un modèle 3D visible dans l'espace par la caméra. Le positionnement de ces polygones permet de constituer une forme pour le modèle, qui peut être déplacé ou bien voir son allure se transformer. On peut en effet déplacer un modèle dans sa totalité, ou bien réorganiser les polygones les uns par rapport aux autres pour afin de changer l'attitude d'un personnage par exemple.</p><p id="r-83959" data-claire-element-id="83959">La simulation du mouvement réaliste d'un modèle dans un environnement 3D consiste à combiner ces deux aspects : animer le mesh pour qu'il se déforme et agisse de façon réaliste (le personnage bouge ses jambes par rapport à son corps), puis le déplacer et l'orienter par rapport au mouvement que l'on simule (le personnage est déplacé dans la direction donnée).</p><p id="r-83960" data-claire-element-id="83960">Le deuxième aspect a d'ores et déjà été abordé auparavant, nous savons déplacer et orienter un noeud de scène dans l'espace et ainsi le mesh auquel il est rattaché. C'est le premier point que nous allons ici apprendre a gérer.</p><h2 id="r-preparation-3" data-claire-element-id="83967">Préparation</h2><p id="r-83962" data-claire-element-id="83962">Pour tester les différentes animations, nous allons utiliser un nouveau mesh qui comporte quelques animations de bases à essayer. Le fichier de ce mesh est &quot;robot.mesh&quot;, il est bien sûr fourni dans votre dossier media.</p><p id="r-83963" data-claire-element-id="83963">Créez un nouveau programme ou modifiez-en un existant et dans votre classe gérant l'application, ajoutez ces 3 lignes au header.</p><pre id="r-83964" data-claire-element-id="83964"><code data-claire-semantic="cpp">Ogre::SceneNode* mRobotNode;
Ogre::Entity* mRobot;
Ogre::AnimationState* mAnimationState;</code></pre><p id="r-83965" data-claire-element-id="83965">Dans la méthode createScene(), créez le mesh du robot ainsi qu'un nœud de scène auquel le rattacher. Vérifiez que vous pouvez afficher correctement la scène avant de continuer.</p><pre id="r-83966" data-claire-element-id="83966"><code data-claire-semantic="cpp">mRobot = mSceneMgr-&gt;createEntity(&quot;Robot&quot;, &quot;robot.mesh&quot;);

mRobotNode = mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode(&quot;RobotNode&quot;);
mRobotNode-&gt;attachObject(mRobot);</code></pre><h2 id="r-les-methodes-a-utiliser" data-claire-element-id="83979">Les méthodes à utiliser</h2><h3 id="r-recuperer-une-animation-du-mesh" data-claire-element-id="83971">Récupérer une animation du mesh</h3><p id="r-83968" data-claire-element-id="83968">La manipulation des animations passe par une classe particulière du moteur qui est AnimationState. Cette classe permet de gérer le déroulement d'une animation associée à un mesh. La première des choses à faire est de récupérer l'objet AnimationState associé à l'entité que l'on désire animer via la méthode Entity::getAnimationState().</p><pre id="r-83969" data-claire-element-id="83969"><code data-claire-semantic="cpp">Ogre::AnimationState *animationState = entity-&gt;getAnimationState(&quot;animationName&quot;);</code></pre><p id="r-83970" data-claire-element-id="83970">Cette méthode prend en paramètre le nom de l'animation que l'on souhaite utiliser et retourne un pointeur sur l'animation.</p><h3 id="r-activer-l-animation" data-claire-element-id="83978">Activer l'animation</h3><p id="r-83972" data-claire-element-id="83972">Deux méthodes sont particulièrement utilisées pour gérer le déroulement de l'animation. Tout d'abord la fonction setEnabled() qui stipule simplement si l'animation peut être jouée ou non. Si cet attribut est défini à <code data-claire-semantic="cpp">false</code> l'animation sera bloquée quoi que l'on fasse. Cela permet de geler l'animation par un unique appel de fonction sans plus de manipulation. La méthode setLoop() permet quant à elle de faire tourner une animation en boucle, c'est-à-dire que celle-ci recommencera au début une fois terminée. C'est typiquement le comportement que l'on souhaite pour un personnage qui marche en continu pour lequel on voudra avoir une démarche fluide. Il faut bien entendu que l'animation soit bien conçue et que la fin coïncide avec le début pour que l'enchaînement soit correct, c'est à dire que la position du mesh dans l'état initial est la même que dans l'état final. Ceci doit être fait lors de la création du modèle avec un logiciel de 3D et ne nous intéressera pas ici, mais je le mentionne pour que ce soit clair.</p><pre id="r-83973" data-claire-element-id="83973"><code data-claire-semantic="cpp">animationState-&gt;setLoop(true);
animationState-&gt;setEnabled(true);</code></pre><p id="r-83974" data-claire-element-id="83974">Enfin, pour que l'animation évolue effectivement dans le temps, il est nécessaire de lui dire, à chaque frame, dans quel état elle se trouve. La méthode setTimePosition() permet de réaliser ceci, mais il est obligatoire de placer le curseur du temps au moment exact auquel on désire avoir l'animation. Cela peut s'avérer utile pour réinitialiser l'animation à son état d'origine mais on préférera la plupart du temps simplement additionner la durée qui s'est écoulée depuis la dernière mise à jour afin qu'il soit ajouté à l'animation. On réalise ceci par la méthode addTime().</p><pre id="r-83975" data-claire-element-id="83975"><code data-claire-semantic="cpp">animationState-&gt;setTimePosition(time);
animationState-&gt;addTime(timeToAdd);</code></pre><p id="r-83976" data-claire-element-id="83976">On peut noter que si l'on ajoute un temps qui dépasse la durée totale de l'animation, le curseur temporel de l'animation revient automatiquement au début (si l'animation est définie pour jouer en boucle). Par exemple, pour une animation qui dure 4 secondes et sur laquelle on se trouve à 3,5 secondes, l'ajout d'une seconde par la méthode addTime() nous amènera à 0,5 seconde. Il est donc inutile de se préoccuper de l'état actuel de l'animation.</p><p id="r-83977" data-claire-element-id="83977">Il est possible de savoir si une animation est terminée via la méthode hasEnded(), qui renvoie <code data-claire-semantic="cpp">true</code> dans le cas où l'animation n'est pas jouée en boucle et qu'elle est arrivée à son état final.</p><h2 id="r-mise-en-pratique-8" data-claire-element-id="83990">Mise en pratique</h2><p id="r-83980" data-claire-element-id="83980">Nous allons utiliser ce que nous venons de voir afin d'animer notre robot qui est pour l'instant statique.</p><p id="r-83981" data-claire-element-id="83981">La première animation que nous allons utiliser s'appelle &quot;Idle&quot;, soit &quot;en attente&quot; en anglais. Commençons par récupérer l'objet AnimationState dans la méthode createFrameListener() puis activons l'animation afin qu'elle tourne en boucle.</p><pre id="r-83982" data-claire-element-id="83982"><code data-claire-semantic="cpp">mAnimationState = mRobot-&gt;getAnimationState(&quot;Idle&quot;);
mAnimationState-&gt;setLoop(true);
mAnimationState-&gt;setEnabled(true);</code></pre><p id="r-83983" data-claire-element-id="83983">L'animation est prête à être jouée, il ne reste plus qu'à appeler régulièrement la méthode addTime() pour mettre à jour son état. Ceci se fait dans la méthode frameRenderingQueued(), qui nous donne accès au temps écoulé depuis son dernier appel.</p><pre id="r-83984" data-claire-element-id="83984"><code data-claire-semantic="cpp">mAnimationState-&gt;addTime(evt.timeSinceLastFrame);</code></pre><p id="r-83985" data-claire-element-id="83985">Et cela suffit ! Nous pouvons compiler tester ce code pour voir le robot s'animer sur place.</p><figure id="r-83987" data-claire-element-id="83988"><img id="r-83986" data-claire-element-id="83986" src="medias/uploads.siteduzero.com_files_377001_378000_377299.jpg" alt="Image utilisateur"/></figure><p id="r-83989" data-claire-element-id="83989">Vous pouvez aussi tester les animations &quot;Die&quot; (le robot meurt, à ne pas utiliser en boucle) et &quot;Walk&quot; qui fera, comme son nom le laisse penser, marcher le robot.<br/> Avec celle-ci cependant, il faudra penser à déplacer le robot pour l'impression qu'il se déplace dans l'espace plutôt que de marcher sur un tapis roulant invisible. Nous allons tout de suite voir une petite application pour cela !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
<span class="arrow"></span>
<span class="next">Utiliser les quaternions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
<span class="next">Suivez le chemin !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Suivezlechemin"></a><h2>Suivez le chemin !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
<span class="arrow"></span>
<span class="next">Gérer les animations d&#039;un mesh</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">
<span class="next">Les lancers de rayon</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-83992" data-claire-element-id="83992">Il est temps d'utiliser les nouveaux outils que l'on a appris à manipuler pour les mettre en œuvre ensemble afin de faire parcourir un chemin à notre robot.</p><p id="r-83993" data-claire-element-id="83993">Le principe sera de déplacer celui-ci suivant un parcours constitué de 3 points, en l'animant et en le conservant orienté dans la direction dans laquelle il marche. Vous êtes maintenant capables de commencer à vous attacher à du réalisme. ;)</p><h2 id="r-placer-les-checkpoints" data-claire-element-id="84005">Placer les checkpoints</h2><p id="r-83994" data-claire-element-id="83994">Les points de passage seront représentés par des objets Vector3 qui contiendront les coordonnées à atteindre par notre robot et nous allons stocker ces vecteurs dans un objet queue de la STL. Cette classe représente une liste de type FIFO qui va donc permettre d'utiliser nos points de passage en boucle, c'est-à-dire que lorsque le robot arrivera à un point de passage, nous irons chercher le point qui sera en tête de notre liste, puis nous le réinsérerons en fin de liste. Ainsi tant que le programme tournera le robot continuera de suivre son parcours en boucle.</p><p id="r-83995" data-claire-element-id="83995">Il va aussi nous falloir quelques attributs de classe pour stocker certaines informations lors de l'exécution de l'application : la destination en cours du robot ainsi que la direction dans laquelle il doit marcher pour l'atteindre, la vitesse de déplacement et la distance restante avant d'atteindre le point de passage.</p><pre id="r-83996" data-claire-element-id="83996"><code data-claire-semantic="cpp">private:
    Ogre::SceneNode* mRobotNode;
    Ogre::Entity* mRobot;
    Ogre::AnimationState* mAnimationState;
    
    std::queue&lt;Ogre::Vector3&gt; mCheckpointList;
    Ogre::Vector3 mDestination;
    Ogre::Vector3 mDirection;
    
    Ogre::Real mSpeed;
    Ogre::Real mDistance;</code></pre><p id="r-83997" data-claire-element-id="83997">Nous initialisons ces quelques attributs dans le constructeur de l'application :</p><pre id="r-83998" data-claire-element-id="83998"><code data-claire-semantic="cpp">TutorialAnimation::TutorialAnimation(void)
{
    mSpeed = 50.0f;
    mDestination = Ogre::Vector3::ZERO;
    mDistance = 0.0f;
}</code></pre><p id="r-83999" data-claire-element-id="83999">Dans la méthode createScene(), nous allons ajouter 3 points de passage dans la liste pour que notre mesh puisse se dégourdir un peu les jambes. ;)</p><pre id="r-84000" data-claire-element-id="84000"><code data-claire-semantic="cpp">mCheckpointList.push(Ogre::Vector3(300, 0, 600));
mCheckpointList.push(Ogre::Vector3(100, 0, -200));
mCheckpointList.push(Ogre::Vector3(-400, 0, 100));</code></pre><p id="r-84001" data-claire-element-id="84001">Nous pensons bien entendu à créer le mesh du robot et son noeud de scène, ainsi qu'une lumière ambiante au minimum pour éclairer l'espace devant nous.</p><pre id="r-84002" data-claire-element-id="84002"><code data-claire-semantic="cpp">mSceneMgr-&gt;setAmbientLight(Ogre::ColourValue(0.5f, 0.5f, 0.5f));

mRobot = mSceneMgr-&gt;createEntity(&quot;Robot&quot;, &quot;robot.mesh&quot;);
mRobotNode = mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode(&quot;RobotNode&quot;);
mRobotNode-&gt;attachObject(mRobot);</code></pre><p id="r-84003" data-claire-element-id="84003">Au chapitre des initialisations, nous avons aussi besoin de récupérer l'animation et de l'activer. Je vous propose de placer ce code à la fin de la méthode createFrameListener().</p><pre id="r-84004" data-claire-element-id="84004"><code data-claire-semantic="cpp">void TutorialAnimation::createFrameListener(void)
{
    //...
    mAnimationState = mRobot-&gt;getAnimationState(&quot;Walk&quot;);
    mAnimationState-&gt;setLoop(true);
    mAnimationState-&gt;setEnabled(true);
}</code></pre><h2 id="r-determiner-la-direction-a-suivre" data-claire-element-id="84033">Déterminer la direction à suivre</h2><p id="r-84006" data-claire-element-id="84006">À partir de ces points de passage rangés dans une file, il ne nous reste qu'à récupérer la direction dans laquelle doit avancer le robot à un moment donné et gérer l'alignement du robot avec la direction dans laquelle il marche.</p><p id="r-84007" data-claire-element-id="84007">Pour récupérer le prochain point de passage et la direction dans laquelle nous devons avancer, le plus simple est d'utiliser une méthode qui s'occupera de récupérer ces informations pour nous et de gérer notre liste de vecteurs.</p><p id="r-84008" data-claire-element-id="84008">Voici son contenu :</p><pre id="r-84009" data-claire-element-id="84009"><code data-claire-semantic="cpp">bool TutorialAnimation::nextDestination()
{
    if (mCheckpointList.empty())
        return false;
    
    mDestination = mCheckpointList.front();
    mCheckpointList.pop();
    mCheckpointList.push(mDestination);
    
    mDirection = mDestination - mRobotNode-&gt;getPosition();
    mDistance = mDirection.normalise();
    
    return true;
}</code></pre><p id="r-84010" data-claire-element-id="84010">Nous commençons par tester si la liste est vide, auquel cas nous abandonnons le traitement et indiquons par la valeur <code data-claire-semantic="cpp">false</code> qu'aucune destination n'est disponible. En revanche si la liste contient au moins un élément, on le récupère dans la variable mDestination, on le retire de la liste puis on le réinsère à la fin, ce qui permet d'avoir un cycle dans les points de passage.</p><p id="r-84011" data-claire-element-id="84011">Enfin, la différence dans laquelle le robot doit avancer est donnée par la différence entre les coordonnées du point de passage et celles du robot. Ce nouveau vecteur est ensuite normalisé (sa distance devient 1) et sa longueur avant normalisation est stockée dans la variable mDistance, c'est la distance à parcourir entre la position du robot et le point de passage.</p><p id="r-84012" data-claire-element-id="84012">Cette méthode sera appelée à chaque fois que l'on cherche une nouvelle destination : cela sera le cas lors du démarrage du programme puis lorsqu'un point de passage sera atteint par l'objet. Pour indiquer une telle situation, nous mettrons un vecteur nul dans mDestination (il faut donc le faire dans le constructeur ou bien dans la méthode createScene() par exemple).</p><pre id="r-84013" data-claire-element-id="84013"><code data-claire-semantic="cpp">if (mDestination == Ogre::Vector3::ZERO) {
    nextDestination();
} else {
    // le déplacement est déjà en cours
}</code></pre><p id="r-84014" data-claire-element-id="84014">Si le déplacement est déjà en cours, il y a deux choses à faire. La première est de déplacer le robot dans la direction voulue, stockée dans mDirection, et de diminuer la distance restante avant l'arrivée de la distance que l'on vient tout juste de parcourir.</p><pre id="r-84015" data-claire-element-id="84015"><code data-claire-semantic="cpp">Ogre::Real move = evt.timeSinceLastFrame * mSpeed;
mRobotNode-&gt;translate(mDirection * move);
mDistance -= move;</code></pre><p id="r-84016" data-claire-element-id="84016">Enfin, il faut vérifier si le point de passage est atteint, c'est-à-dire que la distance restante est nulle (ou négative).</p><pre id="r-84017" data-claire-element-id="84017"><code data-claire-semantic="cpp">if (mDistance &lt; 0.001) {
    mRobotNode-&gt;setPosition(mDestination);
    mDestination = Ogre::Vector3::ZERO;
}</code></pre><p id="r-84018" data-claire-element-id="84018">Jusqu'ici votre code devrait donc ressembler à ceci :</p><pre id="r-84019" data-claire-element-id="84019"><code data-claire-semantic="cpp">if (mDestination == Ogre::Vector3::ZERO) {
    nextDestination();
} else {
    Ogre::Real move = evt.timeSinceLastFrame * mSpeed;
    mRobotNode-&gt;translate(mDirection * move);
    mDistance -= move;
        
    if (mDistance &lt; 0.001) {
        mRobotNode-&gt;setPosition(mDestination);
        mDestination = Ogre::Vector3::ZERO;
    }
}
mAnimationState-&gt;addTime(evt.timeSinceLastFrame);</code></pre><p id="r-84020" data-claire-element-id="84020">Vous pouvez tout de suite le compiler et lancer le programme.</p><figure id="r-84022" data-claire-element-id="84023"><img id="r-84021" data-claire-element-id="84021" src="medias/uploads.siteduzero.com_files_377001_378000_377301.jpg" alt="Image utilisateur"/></figure><div id="r-84025" data-claire-element-id="84025" data-claire-semantic="question"><p id="r-84024" data-claire-element-id="84024">Le robot ne s'oriente pas dans la direction dans laquelle il avance !</p></div><p id="r-84026" data-claire-element-id="84026">Effectivement, nous n'avons pas encore réglé ce détail. Étant donné que les points de passages ne seront pas modifiés pendant le déplacement, nous n'allons modifier l'orientation du robot que lorsque nous récupérerons une nouvelle destination.</p><p id="r-84027" data-claire-element-id="84027">Il suffit pour cela de récupérer, comme présenté dans la sous-partie sur les quaternions, l'ancienne direction dans laquelle est orienté le robot et celle dans laquelle nous voulons aller, puis de construire le quaternion avec la méthode getRotationTo().</p><pre id="r-84028" data-claire-element-id="84028"><code data-claire-semantic="cpp">if (mDestination == Ogre::Vector3::ZERO) {
    if (nextDestination()) {
        Ogre::Vector3 baseDirection = mRobotNode-&gt;getOrientation() * Ogre::Vector3::UNIT_X;
        Ogre::Quaternion rotation = baseDirection.getRotationTo(mDirection);
        mRobotNode-&gt;rotate(rotation);
    }
} else {</code></pre><p id="r-84029" data-claire-element-id="84029">Vous remarquez l'ajout d'une condition sur la valeur de retour de nextDestination(). On prévoit en effet le cas où la file de points de passage serait vide et qu'il n'y a donc pas de direction à prendre.</p><p id="r-84030" data-claire-element-id="84030">Voici finalement le code complet que nous avons ajouté dans la méthode frameRenderingQueued().</p><pre id="r-84031" data-claire-element-id="84031"><code data-claire-semantic="cpp">if (mDestination == Ogre::Vector3::ZERO) {
    if (nextDestination()) {
        Ogre::Vector3 baseDirection = mRobotNode-&gt;getOrientation() * Ogre::Vector3::UNIT_X;
        Ogre::Quaternion rotation = baseDirection.getRotationTo(mDirection);
        mRobotNode-&gt;rotate(rotation);
    }
} else {
    Ogre::Real move = evt.timeSinceLastFrame * mSpeed;
    mRobotNode-&gt;translate(mDirection * move);
    mDistance -= move;
        
    if (mDistance &lt; 0.001) {
        mRobotNode-&gt;setPosition(mDestination);
        mDestination = Ogre::Vector3::ZERO;
    }
}
mAnimationState-&gt;addTime(evt.timeSinceLastFrame);</code></pre><p id="r-84032" data-claire-element-id="84032">Voici la fin de ce chapitre relativement simple qui vous aura présenté comment utiliser les animations des modèles 3D. La majeure partie du travail doit être effectuée en amont lors de la création des modèles, mais il est important de savoir se servir des outils à disposition pour que notre application utilise ce travail à bon escient.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
<span class="arrow"></span>
<span class="next">Gérer les animations d&#039;un mesh</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">
<span class="next">Les lancers de rayon</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Leslancersderayon"></a><h2>Les lancers de rayon</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
<span class="arrow"></span>
<span class="next">Suivez le chemin !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
<span class="next">Qu&#039;est ce qu&#039;un rayon ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-84036" data-claire-element-id="84036">Contrairement à ce que vous avez peut-être pensé en voyant le titre de ce chapitre, nous n'allons pas voir d'effet graphique dans les lignes qui suivent. Le lancer de rayon est un outil qui permet de calculer facilement des intersections entre une droite dans l'espace et un objet 3D. Cela reste très rudimentaire par rapport à ce que peut offrir un vrai moteur physique, le but n'est pas d'ailleurs pas de les concurrencer sur ce terrain, pourtant vous verrez que les cas d'utilisations sont aussi variés qu’intéressants.</p><aside id="r-84038" data-claire-element-id="84038" data-claire-semantic="information"><p id="r-84037" data-claire-element-id="84037">Dans ce chapitre, nous allons utiliser le curseur de la souris pour certains exemples, il est donc nécessaire de pouvoir l'afficher en utilisant par exemple la bibliothèque CEGUI. Je vous conseille donc d'avoir lu le chapitre en annexe avant d'entamer celui-ci.</p></aside>
</div><a name="Qu039estcequ039unrayon"></a><h2>Qu&#039;est ce qu&#039;un rayon ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">
<span class="arrow"></span>
<span class="next">Les lancers de rayon</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
<span class="next">L&#039;intersection avec un terrain</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-la-classe-ray" data-claire-element-id="84043">La classe Ray</h2><p id="r-84039" data-claire-element-id="84039">Un rayon est un objet relativement simple en lui-même, puisque l'on peut le considérer comme une demi-droite dans l'espace. Il possède donc une origine et une direction qui suffisent à le définir. Le rayon sera ensuite utilisé pour détecter des intersections entre lui et des objets de la scène que l'on souhaite positionner. Il peut donc permettre de déterminer la hauteur d'un terrain à des coordonnées données ou de détecter si un clic de la souris touche ou non un mesh, ce qui serait utile dans un jeu de tir ou pour un éditeur de carte par exemple.</p><p id="r-84040" data-claire-element-id="84040">Le constructeur prend en paramètres deux Vector3, le premier pour donner le point d'origine et le second pour la direction du rayon.</p><pre id="r-84041" data-claire-element-id="84041"><code data-claire-semantic="cpp">Ogre::Ray::Ray( const Vector3 &amp; origin, const Vector3 &amp; direction )</code></pre><p id="r-84042" data-claire-element-id="84042">Cette classe présente quelques méthodes utiles utilisables à partir du simple rayon, notamment getPoint() et intersects().<br/> La première permet de récupérer les coordonnées du point situé à une distance donnée de l'origine sur le rayon, la seconde (dont il existe plusieurs prototypes) renvoie le point d'intersection du rayon avec une sphère, un plan ou encore un cube donné. Je vous laisse vous référer à la documentation pour plus de détails sur ces points.</p><h2 id="r-un-rayon-en-un-seul-clic" data-claire-element-id="84051">Un rayon en un seul clic</h2><p id="r-84044" data-claire-element-id="84044">Sachez qu'il est tout à fait possible de créer un rayon qui pointe dans la direction de la souris sans se compliquer la vie. C'est même relativement simple en utilisant les possibilités d'Ogre et de la caméra !<br/> La première chose à faire est de récupérer les coordonnées de la souris dans la fenêtre de l'application à l'aide de CEGUI.</p><pre id="r-84045" data-claire-element-id="84045"><code data-claire-semantic="cpp">CEGUI::Point mousePos = CEGUI::MouseCursor::getSingleton().getPosition();</code></pre><p id="r-84046" data-claire-element-id="84046">A l'aide de ces coordonnées, on peut créer un rayon partant de la caméra et allant dans le direction où pointe notre souris dans le monde 3D. Ceci se fait avec la méthode getCameraToViewportRay() qui prend deux paramètres, qui sont l'abscisse et l'ordonnée de la souris sur l'écran comprises entre 0 et 1. Pour avoir ces deux paramètres, il suffit donc de diviser les coordonnées que nous avons récupérées précédemment respectivement par la largeur et la hauteur de la fenêtre.</p><pre id="r-84047" data-claire-element-id="84047"><code data-claire-semantic="cpp">Ogre::Ray mouseRay = mCamera-&gt;getCameraToViewportRay(mousePos.d_x/float(arg.state.width), mousePos.d_y/float(arg.state.height));</code></pre><p id="r-84048" data-claire-element-id="84048">Et le tour est joué ! Vous avez maintenant un rayon qui part de la caméra et qui va à l'endroit où la souris est pointée !</p><p id="r-84049" data-claire-element-id="84049">Bien entendu, il n'y a aucune obligation de passer par la souris pour créer un rayon de cette façon. Si vous voulez créer un rayon qui pointe vers l'endroit affiché dans le coin en haut à gauche de la fenêtre par exemple, il suffit de donner les coordonnées (0, 0) :</p><pre id="r-84050" data-claire-element-id="84050"><code data-claire-semantic="cpp">Ogre::Ray topLeftRay = mCamera-&gt;getCameraToViewportRay(0, 0);</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">
<span class="arrow"></span>
<span class="next">Les lancers de rayon</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
<span class="next">L&#039;intersection avec un terrain</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="L039intersectionavecunterrain"></a><h2>L&#039;intersection avec un terrain</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
<span class="arrow"></span>
<span class="next">Qu&#039;est ce qu&#039;un rayon ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
<span class="next">Intersection avec un mesh</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-les-rayons-avec-les-terrains" data-claire-element-id="84059">Les rayons avec les terrains</h2><p id="r-84053" data-claire-element-id="84053">Une utilisation probablement plus concrète à mon avis est la détection de la collision du rayon avec un terrain, dans le but d'en trouver l'intersection avec une droite comme j'en parlais plus haut.</p><p id="r-84054" data-claire-element-id="84054">Le terrain lui-même propose une méthode pour connaître son point d'intersection avec un rayon donné, la méthode rayIntersects().</p><pre id="r-84055" data-claire-element-id="84055"><code data-claire-semantic="cpp">std::pair&lt;bool, Vector3&gt; Ogre::Terrain::rayIntersects(const Ray &amp; ray, bool cascadeToNeighbours = false, Real distanceLimit = 0 )</code></pre><p id="r-84056" data-claire-element-id="84056">Le premier argument à fournir à cette méthode est un rayon créé auparavant avec lequel on désire déterminer une intersection. Le second est un booléen permettant de propager ou non la détection d'intersection aux terrains voisins et le troisième limite la détection à une distance donnée en partant de l'origine du rayon (la valeur 0 signifie qu'il n'y a pas de limite).</p><p id="r-84057" data-claire-element-id="84057">Le retour de cette méthode est un objet de type std::pair composé d'un booléen et d'un Vector3. Le booléen indique si une intersection a été détectée et si c'est le cas, alors les coordonnées de ce point se trouvent dans le Vector3. L'accès à ces résultats se fait par les attributs first et second de l'objet. Je vous donne ci-dessous une idée de l'utilisation typique que vous pouvez avoir de ces deux informations.</p><pre id="r-84058" data-claire-element-id="84058"><code data-claire-semantic="cpp">Ogre::Terrain* terrain;
Ogre::Ray ray;
// ...
std::pair&lt;bool, Ogre::Vector3&gt; result = terrain-&gt;rayIntersects(ray);
if (result.first) {
    Ogre::Vector3 intersection = result.second;
    // traitement
}</code></pre><h2 id="r-travailler-avec-les-groupes-de-terrains" data-claire-element-id="84066">Travailler avec les groupes de terrains</h2><p id="r-84060" data-claire-element-id="84060">Il est à noter que sur de grands espaces, vous utiliserez probablement des groupes de terrains dans votre application. La méthode rayIntersects() existe aussi dans la classe TerrainGroup et propose un résultat similaire à celle que nous avons vue précédemment, si ce n'est que son retour contient aussi un pointeur sur l'objet Terrain avec lequel il y a eu intersection.</p><pre id="r-84061" data-claire-element-id="84061"><code data-claire-semantic="cpp">RayResult Ogre::TerrainGroup::rayIntersects(const Ray &amp; ray, Real distanceLimit = 0) const</code></pre><p id="r-84062" data-claire-element-id="84062">Les arguments sont les mêmes que précédemment (sans la propagation puisque l'on travaille déjà sur un groupe de terrains) mais le résultat est une structure de type RayResult.</p><p id="r-84063" data-claire-element-id="84063">Un tour dans la <a href="http://www.ogre3d.org/docs/api/html/structOgre_1_1TerrainGroup_1_1RayResult.html">documentation</a> nous apprend que celle-ci contient seulement trois attributs publics (hit, terrain et position) qui nous permettent de nous retrouver dans le même cas d'analyse qu'auparavant :</p><pre id="r-84064" data-claire-element-id="84064"><code data-claire-semantic="cpp">Ogre::TerrainGroup* terrainGroup;
Ogre::Ray ray;
// ...
RayResult result = terrainGroup-&gt;rayIntersects(ray);
if (result.hit) {
    result.terrain;  // un pointeur sur le terrain avec lequel a eu lieu l'intersection
    result.position; // les coordonnées de l'intersection
}</code></pre><p id="r-84065" data-claire-element-id="84065">Le fonctionnement est donc identique, mis à part l'information du terrain concerné qui nous est remontée en supplément.</p><h2 id="r-exemples-2" data-claire-element-id="84093">Exemples</h2><p id="r-84067" data-claire-element-id="84067">Pour les exemples suivants, vous allez devoir créer un projet dans lequel un terrain est généré. Je vous invite à revoir le chapitre correspondant pour avoir tous les détails.</p><h3 id="r-avoir-une-camera-a-hauteur-constante-du-sol" data-claire-element-id="84075">Avoir une caméra à hauteur constante du sol</h3><aside id="r-84070" data-claire-element-id="84070" data-claire-semantic="information"><p id="r-84068" data-claire-element-id="84068">Je présente ici un exemple simple d'utilisation des rayons sur un terrain, mais n'oubliez pas qu'il est possible (et plus rapide) de réaliser la même chose grâce à une méthode fournie par les terrains :</p><pre id="r-84069" data-claire-element-id="84069"><code data-claire-semantic="cpp">float Ogre::Terrain::getHeightAtTerrainPosition(Ogre::Real x, Ogre::Real y)</code></pre></aside><p id="r-84071" data-claire-element-id="84071">En utilisant les outils à notre disposition, il est relativement simple de conserver notre caméra à une hauteur constante au-dessus du sol, pour réaliser une vue à la première personne. Pour cela, il nous faut déterminer la hauteur du sol à l'emplacement de la caméra et placer cette dernière légèrement au-dessus.</p><p id="r-84072" data-claire-element-id="84072">Nous construisons notre rayon en nous basant sur les coordonnées en X et en Z de la caméra et en choisissant pour l'origine une hauteur importante (j'ai ici choisi une valeur de 1000). Cette hauteur doit être choisie avec attention, car l'intersection ne peut être détectée que sur la trajectoire du rayon et pas avant l'origine. C'est-à-dire que si l'origine se trouve en dessous du terrain et que nous choisissons d'orienter le rayon vers le bas, celui-ci ne croisera jamais le terrain. Ici il est donc important d'être certain de se trouver au-dessus du terrain en tout point.</p><p id="r-84073" data-claire-element-id="84073">Après avoir appelé la méthode rayIntersects() du terrain, il suffit d'analyser son résultat et de déplacer la caméra quelques unités au-dessus du sol, c'est-à-dire de mettre à jour la coordonnée de l'axe Y.</p><pre id="r-84074" data-claire-element-id="84074"><code data-claire-semantic="cpp">Ogre::Ray ray = Ogre::Ray(Ogre::Vector3(cameraPosition.x, 1000.0f, cameraPosition.z), Ogre::Vector3::NEGATIVE_UNIT_Y);
std::pair&lt;bool, Ogre::Vector3&gt; result = terrain-&gt;rayIntersects(ray);

if (result.first) {
    mCamera-&gt;setY(result.second.y + 10);
}</code></pre><h3 id="r-placer-des-meshes-sur-le-sol" data-claire-element-id="84092">Placer des meshes sur le sol</h3><p id="r-84076" data-claire-element-id="84076">Ce deuxième exemple consiste à jouer à un éditeur de niveaux très basique. Le but de l'application sera en effet de placer un mesh à l'endroit où l'utilisateur a cliqué sur le terrain, nous allons donc devoir créer un rayon à partir de la position de la souris comme je vous l'ai montré au début du chapitre.</p><p id="r-84077" data-claire-element-id="84077">Pour cela nous allons créer une méthode manageLeftClick() qui sera appelée lors d'un clic gauche de la souris.</p><pre id="r-84078" data-claire-element-id="84078"><code data-claire-semantic="cpp">bool TutorialApplication::mousePressed( const OIS::MouseEvent &amp;arg, OIS::MouseButtonID id )
{
    if (id == OIS::MB_Right) {
        mRightPress = true;
    } else if (id == OIS::MB_Left) {
        manageLeftClick(arg);
    }
    CEGUI::System::getSingleton().injectMouseButtonDown(convertButton(id));
    return true;
}</code></pre><aside id="r-84081" data-claire-element-id="84081" data-claire-semantic="information"><p id="r-84079" data-claire-element-id="84079">Vous voyez que j'utilise ici un attribut mRightPress dont je n'ai pas parlé avant. Celui-ci me permet de conserver l'état du bouton droit de la souris dans le but d'alterner entre rotation de la caméra et déplacement du curseur. S'il est appuyé, je passe en mode rotation, sinon je contrôle le curseur. Il suffit pour cela de lui donner la valeur <code data-claire-semantic="cpp">false</code> dans mouseReleased() et de commencer la méthode mouseMoved() ainsi :</p><pre id="r-84080" data-claire-element-id="84080"><code data-claire-semantic="cpp">bool TutorialApplication::mouseMoved(const OIS::MouseEvent &amp;arg)
{
    if (mRightPress) {
        return BaseApplication::mouseMoved(arg); // cette méthode gère le déplacement de la souris comme vu dans un chapitre précédent
    }//...
}</code></pre></aside><p id="r-84082" data-claire-element-id="84082">Commencez la méthode manageLeftClick() par la récupération de la position de la souris, puis la création et le lancer du rayon sur le terrain.</p><pre id="r-84083" data-claire-element-id="84083"><code data-claire-semantic="cpp">CEGUI::Point mousePos = CEGUI::MouseCursor::getSingleton().getPosition();
Ogre::Ray mouseRay = mCamera-&gt;getCameraToViewportRay(mousePos.d_x/float(arg.state.width), mousePos.d_y/float(arg.state.height));
std::pair&lt;bool, Ogre::Vector3&gt; result = terrain-&gt;rayIntersects(mouseRay);</code></pre><p id="r-84084" data-claire-element-id="84084">Nous connaissons à présent le point d'intersection du rayon avec le terrain (s'il existe). Il nous suffit donc de placer un nouveau mesh à l'endroit déterminé.</p><pre id="r-84085" data-claire-element-id="84085"><code data-claire-semantic="cpp">if (result.first)
{
    char name[16];
    sprintf( name, &quot;Robot%d&quot;, mCount++ );
    Ogre::Entity *ent = mSceneMgr-&gt;createEntity(name, &quot;robot.mesh&quot;);
    Ogre::SceneNode* node = mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode(std::string(name) + &quot;Node&quot;, result.second);
    node-&gt;attachObject(ent);
    node-&gt;setScale(0.5f, 0.5f, 0.5f);
}</code></pre><p id="r-84086" data-claire-element-id="84086">Le code de ce bloc est plutôt simple donc je vous laisse le lire rapidement. Pensez simplement à bien ajouter l'attribut mCount et à l'initialiser à 0 dans le constructeur.</p><aside id="r-84088" data-claire-element-id="84088" data-claire-semantic="information"><p id="r-84087" data-claire-element-id="84087">La fonction sprintf utilisée avec la variable mCount nous permet ici de générer un nom unique pour chaque entité nouvellement créée.</p></aside><figure id="r-84090" data-claire-element-id="84091"><img id="r-84089" data-claire-element-id="84089" src="medias/uploads.siteduzero.com_files_391001_392000_391500.jpg" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
<span class="arrow"></span>
<span class="next">Qu&#039;est ce qu&#039;un rayon ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
<span class="next">Intersection avec un mesh</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Intersectionavecunmesh"></a><h2>Intersection avec un mesh</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
<span class="arrow"></span>
<span class="next">L&#039;intersection avec un terrain</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">
<span class="next">L&#039;interface avec CEGUI</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-l-objet-rayscenequery" data-claire-element-id="84116">L'objet RaySceneQuery</h2><p id="r-84095" data-claire-element-id="84095">Un nouvel objet doit être utilisé pour connaître le résultat de l'intersection d'un rayon avec une entité. Cet objet, c'est un RaySceneQuery, une requête à laquelle on associe un rayon et qui nous donnera la liste des objets croisés sur son chemin.</p><p id="r-84096" data-claire-element-id="84096">Pour créer un RaySceneQuery, on passe une nouvelle fois par le Scene Manager avec la méthode createRayQuery().</p><pre id="r-84097" data-claire-element-id="84097"><code data-claire-semantic="cpp">virtual RaySceneQuery* Ogre::SceneManager::createRayQuery(const Ray &amp; ray, unsigned long mask = 0xFFFFFFFF)</code></pre><p id="r-84098" data-claire-element-id="84098">Comme vous le voyez, le seul paramètre obligatoire est le rayon que doit utiliser la requête, qui est toutefois modifiable par la suite. Le second paramètre est un masque de requête qui permet de filtrer des résultats, nous ne verrons pas leur fonctionnement pour l'instant.</p><p id="r-84099" data-claire-element-id="84099">Une fois que l'objet est créé, trois méthodes nous seront utiles pour en tirer profit :</p><pre id="r-84100" data-claire-element-id="84100"><code data-claire-semantic="cpp">virtual void Ogre::RaySceneQuery::setRay(const Ray &amp; ray)
virtual void Ogre::RaySceneQuery::setSortByDistance(bool sort, ushort maxresults = 0)
virtual RaySceneQueryResult&amp; Ogre::RaySceneQuery::execute(void)</code></pre><p id="r-84101" data-claire-element-id="84101">La méthode setRay() définit le nouveau rayon utilisé pour faire une requête d'intersection, setSortByDistance() permet d'ordonner les résultats par distance, ce qui est utile si vous voulez obtenir rapidement l'objet le plus proche qui soit touché. Enfin, on appelle execute() pour lancer la requête et récupérer le résultat dans un RaySceneQueryResult.</p><div id="r-84103" data-claire-element-id="84103" data-claire-semantic="question"><p id="r-84102" data-claire-element-id="84102">Un RaySceneQueryResult, qu'est-ce que c'est ?</p></div><p id="r-84104" data-claire-element-id="84104">De la même façon que pour le résultat d'une intersection avec un terrain, nous ne récupérons pas un objet Ogre mais un vector de RaySceneQueryResultEntry, une structure définie comme suit :</p><pre id="r-84105" data-claire-element-id="84105"><code data-claire-semantic="cpp">struct _OgreExport RaySceneQueryResultEntry
{
    Real distance;
    MovableObject* movable;
    SceneQuery::WorldFragment* worldFragment;
    bool operator &lt; (const RaySceneQueryResultEntry&amp; rhs) const
    {
        return this-&gt;distance &lt; rhs.distance;
    }
};
typedef vector&lt;RaySceneQueryResultEntry&gt;::type Ogre::RaySceneQueryResult;</code></pre><p id="r-84106" data-claire-element-id="84106">Grâce à l'utilisation du vector, nous avons accès à un itérateur pour parcourir la liste des résultats via une boucle <code data-claire-semantic="cpp">for</code> :</p><pre id="r-84107" data-claire-element-id="84107"><code data-claire-semantic="cpp">RaySceneQuery* myRaySceneQuery;
//...
RaySceneQueryResult&amp; result = myRaySceneQuery-&gt;execute();
RaySceneQueryResult::iterator it;
for ( it = result.begin(); it != result.end(); it++ )
{
    // traitement de l'élément
}</code></pre><p id="r-84108" data-claire-element-id="84108">Vous le voyez dans la structure, l'itérateur donne accès à la distance qui sépare le départ du rayon de l'objet touché ainsi qu'à deux autres attributs, dont l'un au moins vaut <code data-claire-semantic="cpp">NULL</code>. L'attribut worldFragment était utilisé dans les anciennes versions d'Ogre ayant une gestion différente des terrains (toujours disponible aujourd'hui, mais obsolète). Nous aurons donc uniquement besoin de l'attribut movable qui est un pointeur sur un MovableObject, la classe parente d'Ogre::Entity.</p><pre id="r-84109" data-claire-element-id="84109"><code data-claire-semantic="cpp">RaySceneQueryResult::iterator it;
//...
if (it-&gt;movable)
{
    // on peut récupérer le noeud de scène associé
    Ogre::SceneNode* node = it-&gt;movable-&gt;getParentSceneNode();
    // ou bien le nom
    String name = it-&gt;movable-&gt;getName();
    // on a aussi accès à la distance parcourue par le rayon
    Ogre::Real distance = it-&gt;distance;
    //...
}</code></pre><p id="r-84110" data-claire-element-id="84110">Attention toutefois, il est important de savoir que la classe Entity n'est pas la seule à hériter de MovableObject, c'est aussi le cas de Light, ManualObject et même d'une classe liée aux terrains ! (Vous pouvez voir le détail dans la <a href="http://www.ogre3d.org/docs/api/html/classOgre_1_1MovableObject.html">documentation</a>). Une petite vérification supplémentaire s'impose donc si l'on ne veut pas sélectionner n'importe quoi.</p><p id="r-84111" data-claire-element-id="84111">Pour être certain de ne sélectionner que les entités, on vérifie le type d'objet récupéré via la méthode MovableObject::getMovableType() :</p><pre id="r-84112" data-claire-element-id="84112"><code data-claire-semantic="cpp">if (it-&gt;movable &amp;&amp; it-&gt;movable-&gt;getMovableType() == &quot;Entity&quot;)
{
//...
}</code></pre><p id="r-84113" data-claire-element-id="84113">Il est donc facile de parcourir l'ensemble des entités touchées par le rayon et de les traiter d'une façon ou d'un autre.</p><aside id="r-84115" data-claire-element-id="84115" data-claire-semantic="warning"><p id="r-84114" data-claire-element-id="84114">Cette méthode ne permet pas de vérifier l'intersection du rayon avec le mesh, mais avec sa <em>Bounding Box</em>, qui est la boîte contenant le mesh. Selon la façon dont le rayon touche cette boîte, il est tout à fait possible d'avoir une collision détectée sans que le rayon ait touché les polygones eux-mêmes.</p></aside><h2 id="r-exercice-12" data-claire-element-id="84170">Exercice</h2><p id="r-84117" data-claire-element-id="84117">Voici un petit exercice que je vous propose afin de pratiquer un peu l'utilisation de RaySceneQuery pour la sélection d'entités. Nous partirons du code précédent qui permet la création de robots à la volée pour l'améliorer sensiblement.</p><h3 id="r-consignes" data-claire-element-id="84126">Consignes</h3><p id="r-84118" data-claire-element-id="84118">Dans un premier temps, il va falloir faire en sorte que si l'on clique sur un robot, il n'y en ai pas un nouveau qui soit créé, mais que ce dernier soit juste sélectionné. Nous matérialiserons cette sélection par l'affichage de la Bounding Box en passant par la méthode suivante :</p><pre id="r-84119" data-claire-element-id="84119"><code data-claire-semantic="cpp">virtual void Ogre::SceneNode::showBoundingBox(bool bShow)</code></pre><p id="r-84120" data-claire-element-id="84120">Vous devriez obtenir un résultat comme celui-ci :</p><figure id="r-84122" data-claire-element-id="84123"><img id="r-84121" data-claire-element-id="84121" src="medias/uploads.siteduzero.com_files_402001_403000_402603.jpg" alt="Image utilisateur"/></figure><p id="r-84124" data-claire-element-id="84124">Une fois ceci réalisé, il serait intéressant de pouvoir déplacer le mesh sélectionné sur le terrain en faisant un glisser-déposer avec la souris. Ainsi, tant que le clic gauche est maintenu, le robot en surbrillance (qu'il vienne d'être créé ou simplement sélectionné) devra se déplacer sur le sol du terrain.</p><p id="r-84125" data-claire-element-id="84125">Voilà pour les consignes, à vos claviers !</p><h3 id="r-quelques-indications" data-claire-element-id="84137">Quelques indications</h3><p id="r-84127" data-claire-element-id="84127">Si vous ne savez vraiment pas par où démarrer, voici les étapes principales à effectuer pour que le programme corresponde aux attentes.</p><p id="r-84128" data-claire-element-id="84128"></p><div id="r-84136" data-claire-element-id="84136"><ul id="r-84135" data-claire-element-id="84135"><li id="r-84130" data-claire-element-id="84130"><p id="r-84129" data-claire-element-id="84129">Pour conserver une trace du noeud attaché à l'entité sélectionnée, le plus simple est d'utiliser un attribut de classe qui pointera en permanence sur le dernier SceneNode sélectionné (ou créé).</p></li><li id="r-84132" data-claire-element-id="84132"><p id="r-84131" data-claire-element-id="84131">Afin de ne pas créer un robot si l'on clique sur un existant, il faut bien vérifier si le rayon touche une entité ou non avant de s'occuper de l'intersection avec le terrain, qui n'intervient qu'ensuite.</p></li><li id="r-84134" data-claire-element-id="84134"><p id="r-84133" data-claire-element-id="84133">Le déplacement du robot consiste simplement à repositionner le noeud correspondant à l'emplacement du terrain pointé par la souris.</p></li></ul></div><h3 id="r-solution-1" data-claire-element-id="84158">Solution</h3><p id="r-84138" data-claire-element-id="84138">Vous avez bien cherché ? J'espère que vous avez pu parvenir à bout de ce petit exercice. Dans le cas contraire, voici une solution qui permet d'arriver au résultat.</p><p id="r-84139" data-claire-element-id="84139"></p><div id="r-84157" data-claire-element-id="84157"><p id="r-84140" data-claire-element-id="84140">Nous commençons par ajouter quelques attributs de classe dont nous avons besoin : un pointeur sur la RaySceneQuery, un autre pour le noeud en cours de sélection et un booléen pour conserver l'état du bouton gauche de la souris.</p><pre id="r-84141" data-claire-element-id="84141"><code data-claire-semantic="cpp">Ogre::RaySceneQuery* mRaySceneQuery;
Ogre::SceneNode* mSelection;

bool mLeftPress;</code></pre><p id="r-84142" data-claire-element-id="84142">Bien entendu, on n'oublie pas d'initialiser mSelection avec la valeur 0 et de créer l'objet mRaySceneQuery, à la fin de la méthode createScene() par exemple :</p><pre id="r-84143" data-claire-element-id="84143"><code data-claire-semantic="cpp">void TutorialApplication::createScene(void)
{
    //...
    mRaySceneQuery = mSceneMgr-&gt;createRayQuery(Ogre::Ray());</code></pre><p id="r-84144" data-claire-element-id="84144">}<br/> &lt;/code&gt;</p><p id="r-84145" data-claire-element-id="84145">Attaquons-nous directement à la méthode manageLeftClick() dans laquelle nous allons gérer la sélection d'un mesh.</p><p id="r-84146" data-claire-element-id="84146">Premièrement, nous vérifions si un mesh était précédemment sélectionné (le pointeur mSelection est donc nul) et l'on masque sa bounding box.</p><pre id="r-84147" data-claire-element-id="84147"><code data-claire-semantic="cpp">void TutorialApplication::manageLeftClick( const OIS::MouseEvent &amp;arg)
{
    if (mSelection) {
        mSelection-&gt;showBoundingBox(false);
    }

    CEGUI::Point mousePos = CEGUI::MouseCursor::getSingleton().getPosition();
    Ogre::Ray mouseRay = mCamera-&gt;getCameraToViewportRay(mousePos.d_x/float(arg.state.width), mousePos.d_y/float(arg.state.height));</code></pre><p id="r-84148" data-claire-element-id="84148">Nous avons maintenant besoin de vérifier si nous avons touché un mesh. Nous insérons donc notre rayon dans l'objet RaySceneQuery et nous l’exécutons puis parcourons le résultat à la recherche d'une entité.</p><pre id="r-84149" data-claire-element-id="84149"><code data-claire-semantic="cpp">mRaySceneQuery-&gt;setRay(mouseRay);
Ogre::RaySceneQueryResult&amp; queryResult = mRaySceneQuery-&gt;execute();
Ogre::RaySceneQueryResult::iterator it;

bool hitMesh = false;
for (it = queryResult.begin(); it != queryResult.end(); it++)
{
    if (it-&gt;movable &amp;&amp; it-&gt;movable-&gt;getMovableType() == &quot;Entity&quot;)
    {
        mSelection = it-&gt;movable-&gt;getParentSceneNode();
        hitMesh = true;
        break;
    }
}</code></pre><p id="r-84150" data-claire-element-id="84150">Si nous avons touché une entité, mSelection pointe maintenant sur le noeud correspondant et il suffit simplement d'afficher la bounding box. Dans le cas contraire, nous créons un nouveau robot et nous faisons pointer mSelection sur le noeud de scène créé alors.</p><pre id="r-84151" data-claire-element-id="84151"><code data-claire-semantic="cpp">if (!hitMesh) {
        std::pair&lt;bool, Ogre::Vector3&gt; result = mTerrain-&gt;rayIntersects(mouseRay);
        if (result.first)
        {
            char name[16];
            sprintf( name, &quot;Robot%d&quot;, mCount++ );

            Ogre::Entity *ent = mSceneMgr-&gt;createEntity(name, &quot;robot.mesh&quot;);
            mSelection = mSceneMgr-&gt;getRootSceneNode()-&gt;createChildSceneNode(std::string(name) + &quot;Node&quot;, result.second);
            mSelection-&gt;attachObject(ent);
            mSelection-&gt;setScale(0.5f, 0.5f, 0.5f);
        }
    }
    if (mSelection) {
        mSelection-&gt;showBoundingBox(true);
    }
}</code></pre><p id="r-84152" data-claire-element-id="84152">On peut dès à présent essayer de cliquer par dessus un robot existant, personne ne viendra lui voler sa place ! ;)</p><p id="r-84153" data-claire-element-id="84153">Pour terminer l'exercice, nous devons gérer le glisser-déposer. Nous allons donc avant tout garder la trace du bouton gauche de la souris pour savoir s'il est appuyé ou non.</p><pre id="r-84154" data-claire-element-id="84154"><code data-claire-semantic="cpp">bool TutorialApplication::mousePressed( const OIS::MouseEvent &amp;arg, OIS::MouseButtonID id )
{
    if (id == OIS::MB_Right) {
        mRightPress = true;
    } else if (id == OIS::MB_Left) {
        manageLeftClick(arg);
        mLeftPress = true;
    }
    CEGUI::System::getSingleton().injectMouseButtonDown(convertButton(id));
    return true;
}

bool TutorialApplication::mouseReleased( const OIS::MouseEvent &amp;arg, OIS::MouseButtonID id )
{
    if (id == OIS::MB_Right) {
        mRightPress = false;
    } else if (id == OIS::MB_Left) {
        mLeftPress = false;
    }
    CEGUI::System::getSingleton().injectMouseButtonUp(convertButton(id));
    return true;
}</code></pre><p id="r-84155" data-claire-element-id="84155">La logique maintenant se trouve dans la méthode mouseMoved() : si le clic gauche est actif, nous devons lancer un rayon pour savoir à quel endroit du terrain on pointe, puis déplacer le noeud déjà sélectionné à la position donnée, et le tour est joué.</p><pre id="r-84156" data-claire-element-id="84156"><code data-claire-semantic="cpp">bool TutorialApplication::mouseMoved(const OIS::MouseEvent &amp;arg)
{
    if (mRightPress) {                           // si le bouton droit est appuyé, on peut faire tourner la caméra
        return BaseApplication::mouseMoved(arg); // cette méthode gère la rotation de la caméra comme vu dans un chapitre précédent
    }
    if (mLeftPress &amp;&amp; mSelection != 0) {
        CEGUI::Point mousePos = CEGUI::MouseCursor::getSingleton().getPosition();
        Ogre::Ray mouseRay = mCamera-&gt;getCameraToViewportRay(mousePos.d_x/float(arg.state.width), mousePos.d_y/float(arg.state.height));

        std::pair&lt;bool, Ogre::Vector3&gt; result = mTerrain-&gt;rayIntersects(mouseRay);

        if (result.first)
        {
            mSelection-&gt;setPosition(result.second);
        }
    }
    CEGUI::System::getSingleton().injectMouseMove(arg.state.X.rel, arg.state.Y.rel);
    return true;
}</code></pre></div><h3 id="r-idees-d-ameliorations-1" data-claire-element-id="84169">Idées d'améliorations</h3><p id="r-84159" data-claire-element-id="84159">Afin de pratiquer un peu plus sur Ogre, voici en plus quelques idées d'amélioration pour compléter un peu notre programme.</p><ul id="r-84166" data-claire-element-id="84166"><li id="r-84161" data-claire-element-id="84161"><p id="r-84160" data-claire-element-id="84160">Possibilité d'alterner la création entre différents types de mesh en appuyant sur une touche.</p></li><li id="r-84163" data-claire-element-id="84163"><p id="r-84162" data-claire-element-id="84162">Possibilité de passer en mode &quot;rotation&quot; ou &quot;échelle&quot; plutôt que &quot;déplacement&quot;.</p></li><li id="r-84165" data-claire-element-id="84165"><p id="r-84164" data-claire-element-id="84164">Possibilité de passer en mode &quot;suppression&quot; : un clic sur une entité existante la supprime de la scène.</p></li></ul><p id="r-84167" data-claire-element-id="84167">N'hésitez pas à essayer d'implémenter d'autres idées si vous en avez qui vous passent par la tête, vous vous familiariserez plus rapidement au lancer de rayons !</p><p id="r-84168" data-claire-element-id="84168">Je vous l'avais promis, les rayons donnent un moyen très pratique de détecter des objets sous un clic souris ou bien par rapport à une droite de votre choix dans l'espace. J’espère que ces quelques applications vous auront convaincu de leur utilité !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
<span class="arrow"></span>
<span class="next">L&#039;intersection avec un terrain</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">
<span class="next">L&#039;interface avec CEGUI</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="L039interfaceavecCEGUI"></a><h2>L&#039;interface avec CEGUI</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
<span class="arrow"></span>
<span class="next">Intersection avec un mesh</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
<span class="next">Installation</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-84174" data-claire-element-id="84174">Ce chapitre s'annonce un peu particulier puisqu'il ne traitera pas à proprement parler d'Ogre 3D mais d'un moyen d'y implémenter une interface graphique (GUI), brique quasiment impérative pour la réalisation d'un jeu vidéo. La GUI permet en effet de créer les menus, de gérer l'affichage de la souris, de donner des informations au joueur quant à l'état de sa partie. En bref, elle sert à afficher tout ce qui n'est pas de l'environnement 3D.</p><p id="r-84175" data-claire-element-id="84175">Ogre 3D n'étant qu'un moteur 3D, il ne permet pas d'implémenter ces fonctionnalités dans notre application, il nous faut une bibliothèque supplémentaire. CEGUI est une bibliothèque qui était auparavant intégrée au SDK d'Ogre mais qui a été retirée dans les dernières versions, il sera donc nécessaire de la télécharger et de l'installer séparément pour pouvoir l'utiliser.</p>
</div><a name="Installation"></a><h2>Installation</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">
<span class="arrow"></span>
<span class="next">L&#039;interface avec CEGUI</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
<span class="next">Mise en route de CEGUI</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-telechargement-4" data-claire-element-id="84178">Téléchargement</h2><p id="r-84176" data-claire-element-id="84176">Allez sur la page de <a href="http://www.cegui.org.uk/wiki/index.php/Downloads">téléchargement</a> de CEGUI et prenez les sources de la dernière version stable disponible. Extrayez l'archive obtenue dans un dossier et placez-le au même niveau que votre dossier OgreSDK.</p><p id="r-84177" data-claire-element-id="84177">En plus des sources de CEGUI, vous aurez aussi besoin de quelques dépendances pour pouvoir compiler la bibliothèque. Ces dépendances sont aussi à récupérer sur la page de téléchargement (rubrique <em>Binary Dependencies</em>), vous devez prendre celles qui correspondent à votre compilateur. L'archive téléchargée contient un dossier &quot;dependencies&quot; que vous devez placer dans le dossier des sources CEGUI (à côté des dossiers bin, cegui, datafiles...).</p><h2 id="r-compilation-2" data-claire-element-id="84205">Compilation</h2><p id="r-84179" data-claire-element-id="84179">Pour utiliser CEGUI avec Ogre il est nécessaire de le compiler vous-même avec le compilateur que vous utilisez avec Ogre. Vous générerez ainsi les bibliothèques nécessaires pour que ces deux entités puissent communiquer dans le programme.</p><p id="r-84180" data-claire-element-id="84180">La compilation de CEGUI est relativement simplifiée et automatisée pour être rapide. Les sources sont pour cela fournies avec un script qui permettra de générer un projet Visual Studio prêt à compiler différentes bibliothèques.</p><p id="r-84181" data-claire-element-id="84181">Ouvrez pour cela le fichier CEGUI/projects/premake/config.lua qui contient les paramètres de génération du projet.<br/> Cherchez les deux lignes indiquant les chemins d'Ogre et OIS et éditez-les comme ceci, en adaptant le premier chemin de chaque ligne à votre installation :</p><pre id="r-84182" data-claire-element-id="84182"><code data-claire-semantic="lua">OGRE_PATHS = { &quot;C:/OgreSDK&quot;, &quot;include/OGRE&quot;, &quot;lib&quot; }
OIS_PATHS = { &quot;C:/OgreSDK&quot;, &quot;include/OIS&quot;, &quot;lib&quot; }</code></pre><aside id="r-84184" data-claire-element-id="84184" data-claire-semantic="warning"><p id="r-84183" data-claire-element-id="84183">Faites bien attention à utiliser des slashes et non des antislashes ou bien les chemins seront incorrects.</p></aside><p id="r-84185" data-claire-element-id="84185">Il vous faudra aussi ajouter un peu plus bas le chemin vers boost qui est utilisé depuis la version 1.7 d'Ogre.</p><pre id="r-84186" data-claire-element-id="84186"><code data-claire-semantic="lua">CEGUI_EXTRA_PATHS = { 
    { &quot;C:/OgreSDK/boost&quot;, &quot;&quot;, &quot;lib&quot;, &quot;CEGUIOgreRenderer&quot; }
}</code></pre><p id="r-84187" data-claire-element-id="84187">Enfin, vous trouvez plus bas la liste des <em>renderers</em> qui doivent être générés. Vous aurez besoin de celui qui est spécifique à Ogre, il faut donc l'activer.</p><pre id="r-84188" data-claire-element-id="84188"><code data-claire-semantic="lua">OGRE_RENDERER = true</code></pre><aside id="r-84190" data-claire-element-id="84190" data-claire-semantic="information"><p id="r-84189" data-claire-element-id="84189">Vous voyez au passage que CEGUI peut aussi être compilé pour une utilisation avec Irrlicht ou directement avec OpenGL et Direct3D.</p></aside><p id="r-84191" data-claire-element-id="84191">Sauvegardez maintenant le fichier exécutez build_vs2008.bat en double cliquant dessus. Ce script vous générère un fichier CEGUI.sln directement utilisable par Visual Studio 2008 et 2010. Avec VS2010 il faudra simplement accepter la conversion du projet lors de son ouverture.</p><p id="r-84192" data-claire-element-id="84192">Une fois le fichier ouvert dans Visual Studio, vous voyez qu'un certain nombre de projets sont ouverts dans la liste de gauche. Commencez par ouvrir les propriétés du projet CEGUIOgreRenderer et dans <em>Répertoires VC++</em>, ajoutez le répertoire C:\OgreSDK\lib\$(Configuration) dans les chemins de bibliothèques additionnelles (pensez à sélectionner toutes les configurations dans la liste déroulante).</p><p id="r-84193" data-claire-element-id="84193">Le reste des répertoires doit normalement être configuré correctement pour chaque projet.</p><p id="r-84194" data-claire-element-id="84194">Vous pouvez maintenant compiler les projets suivants, en debug et en release pour avoir les deux à disposition :</p><ul id="r-84203" data-claire-element-id="84203"><li id="r-84196" data-claire-element-id="84196"><p id="r-84195" data-claire-element-id="84195">CEGUIBase</p></li><li id="r-84198" data-claire-element-id="84198"><p id="r-84197" data-claire-element-id="84197">CEGUIOgreRenderer</p></li><li id="r-84200" data-claire-element-id="84200"><p id="r-84199" data-claire-element-id="84199">CEGUIExpatParser</p></li><li id="r-84202" data-claire-element-id="84202"><p id="r-84201" data-claire-element-id="84201">CEGUIFalagardWRBase</p></li></ul><p id="r-84204" data-claire-element-id="84204">Vous trouverez les fichiers générés *.dll dans CEGUI/bin et les *.lib dans CEGUI/lib.</p><h2 id="r-configuration-du-projet" data-claire-element-id="84235">Configuration du projet</h2><p id="r-84206" data-claire-element-id="84206">Comme lors de la création d'un projet Ogre, il est nécessaire d'ajouter de nouveaux répertoires de recherche dans la section Répertoires VC++ :</p><p id="r-84207" data-claire-element-id="84207">Répertoires d'include :</p><ul id="r-84212" data-claire-element-id="84212"><li id="r-84209" data-claire-element-id="84209"><p id="r-84208" data-claire-element-id="84208">CEGUI_HOME/include</p></li><li id="r-84211" data-claire-element-id="84211"><p id="r-84210" data-claire-element-id="84210">CEGUI_HOME/include/CEGUI</p></li></ul><p id="r-84213" data-claire-element-id="84213">Répertoires de bibliothèques :</p><ul id="r-84216" data-claire-element-id="84216"><li id="r-84215" data-claire-element-id="84215"><p id="r-84214" data-claire-element-id="84214">CEGUI_HOME/lib</p></li></ul><p id="r-84217" data-claire-element-id="84217">Et deux nouvelles entrées dans l'éditeur de liens :</p><ul id="r-84222" data-claire-element-id="84222"><li id="r-84219" data-claire-element-id="84219"><p id="r-84218" data-claire-element-id="84218">CEGUIBase.lib</p></li><li id="r-84221" data-claire-element-id="84221"><p id="r-84220" data-claire-element-id="84220">CEGUIOgreRenderer.lib</p></li></ul><p id="r-84223" data-claire-element-id="84223">Les dlls de CEGUI fraîchement générées doivent être ajoutées dans le dossier release du projet (ou debug suivant votre configuration) pour l'exécution du programme.</p><ul id="r-84232" data-claire-element-id="84232"><li id="r-84225" data-claire-element-id="84225"><p id="r-84224" data-claire-element-id="84224">CEGUIBase.dll</p></li><li id="r-84227" data-claire-element-id="84227"><p id="r-84226" data-claire-element-id="84226">CEGUIFalagardWRBase.dll</p></li><li id="r-84229" data-claire-element-id="84229"><p id="r-84228" data-claire-element-id="84228">CEGUIOgreRenderer.dll</p></li><li id="r-84231" data-claire-element-id="84231"><p id="r-84230" data-claire-element-id="84230">CEGUIExpatParser.dll</p></li></ul><p id="r-84233" data-claire-element-id="84233">Dans le fichier resources.cfg, il faut ajouter les ressources de CEGUI (présentes dans le dossier datafiles) afin que l'on puisse les charger dans l'application.</p><pre id="r-84234" data-claire-element-id="84234"><code>[Imagesets]
FileSystem=C:/CEGUI-0.7.7/datafiles/imagesets
[Fonts]
FileSystem=C:/CEGUI-0.7.7/datafiles/fonts
[Schemes]
FileSystem=C:/CEGUI-0.7.7/datafiles/schemes
[LookNFeel]
FileSystem=C:/CEGUI-0.7.7/datafiles/looknfeel
[Layouts]
FileSystem=C:/CEGUI-0.7.7/datafiles/layouts</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">
<span class="arrow"></span>
<span class="next">L&#039;interface avec CEGUI</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
<span class="next">Mise en route de CEGUI</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="MiseenroutedeCEGUI"></a><h2>Mise en route de CEGUI</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
<span class="arrow"></span>
<span class="next">Installation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
<span class="next">Gestion des entrées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-initialisation" data-claire-element-id="84258">Initialisation</h2><p id="r-84237" data-claire-element-id="84237">Tout d'abord, appelons deux fichiers d'includes dans le header de notre classe principale :</p><pre id="r-84238" data-claire-element-id="84238"><code data-claire-semantic="cpp">#include &lt;CEGUI.h&gt;
#include &lt;RendererModules\Ogre\CEGUIOgreRenderer.h&gt;</code></pre><p id="r-84239" data-claire-element-id="84239">Ajoutons ensuite le Renderer de CEGUI en attribut protégé dans la classe de l'application.</p><pre id="r-84240" data-claire-element-id="84240"><code data-claire-semantic="cpp">protected:
    CEGUI::OgreRenderer* mRenderer;</code></pre><p id="r-84241" data-claire-element-id="84241">L'instance se récupère grâce à la méthode statique bootstrapSystem() qui initialise et nous renvoie le renderer.</p><pre id="r-84242" data-claire-element-id="84242"><code data-claire-semantic="cpp">void TutorialApplication::createScene()
{
    mRenderer = &amp;CEGUI::OgreRenderer::bootstrapSystem();
    //...
}</code></pre><p id="r-84243" data-claire-element-id="84243">Une fois CEGUI initialisé nous devons passer au chargement des ressources dont nous aurons besoin. On peut ainsi charger les images, polices, schémas et widgets fournis, il est aussi possible d'en rajouter ou d'en créer pour avoir une interface d'aspect différent. Nous définissons donc pour chaque type de ressource le nom du <em>resource group</em> indiqué dans le fichier resources.cfg (ce sont les noms entre crochets que nous avons ajoutés en dernier).</p><pre id="r-84244" data-claire-element-id="84244"><code data-claire-semantic="cpp">CEGUI::Imageset::setDefaultResourceGroup(&quot;Imagesets&quot;);
CEGUI::Font::setDefaultResourceGroup(&quot;Fonts&quot;);
CEGUI::Scheme::setDefaultResourceGroup(&quot;Schemes&quot;);
CEGUI::WidgetLookManager::setDefaultResourceGroup(&quot;LookNFeel&quot;);
CEGUI::WindowManager::setDefaultResourceGroup(&quot;Layouts&quot;);</code></pre><p id="r-84245" data-claire-element-id="84245">Maintenant que les ressources sont chargées, nous pouvons créer un SchemeManager, c'est-à-dire le gestionnaire d'apparence. Ici nous allons utiliser le thème OgreTray décrit dans le fichier OgreTray.scheme.</p><pre id="r-84246" data-claire-element-id="84246"><code data-claire-semantic="cpp">CEGUI::SchemeManager::getSingleton().create(&quot;OgreTray.scheme&quot;);</code></pre><p id="r-84247" data-claire-element-id="84247">Il est maintenant possible de commencer à créer des objets d'interface, à commencer par la souris par exemple. Les deux lignes de code suivantes définissent le curseur de souris par défaut pour l'application, qui est celui contenu dans le <em>imageset</em> nommé OgreTrayImages, lui-même décrit dans le fichier OgreTray.imageset, puis on indique que l'on veut utiliser ce curseur par défaut sur la souris.</p><pre id="r-84248" data-claire-element-id="84248"><code data-claire-semantic="cpp">CEGUI::System::getSingleton().setDefaultMouseCursor(&quot;OgreTrayImages&quot;, &quot;MouseArrow&quot;);
CEGUI::MouseCursor::getSingleton().setImage( CEGUI::System::getSingleton().getDefaultMouseCursor());</code></pre><aside id="r-84250" data-claire-element-id="84250" data-claire-semantic="information"><p id="r-84249" data-claire-element-id="84249">Notez que la seconde ligne n'est pas toujours obligatoire. Vous pouvez vous en abstenir lorsqu'un objet <em>window</em> de CEGUI est affiché par dessus le rendu d'Ogre. Nous verrons cela plus bas.</p></aside><p id="r-84251" data-claire-element-id="84251">Vous pouvez compiler l'application et vous aurez maintenant un curseur visible au centre de l'écran.</p><figure id="r-84253" data-claire-element-id="84254"><img id="r-84252" data-claire-element-id="84252" src="medias/uploads.siteduzero.com_files_391001_392000_391497.jpg" alt="Image utilisateur"/></figure><div id="r-84256" data-claire-element-id="84256" data-claire-semantic="question"><p id="r-84255" data-claire-element-id="84255">Le curseur ne bouge pas !</p></div><p id="r-84257" data-claire-element-id="84257">C'est exact, pour l'instant nous n'avons nulle part spécifié de déplacer le curseur lorsque la souris se déplace. Celle-ci est donc toujours liée au déplacement de la caméra !<br/> Pour remédier à cela, il faut que CEGUI soit informé des déplacements de la souris pour les répercuter en conséquence sur le curseur.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
<span class="arrow"></span>
<span class="next">Installation</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
<span class="next">Gestion des entrées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Gestiondesentres"></a><h2>Gestion des entrées</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
<span class="arrow"></span>
<span class="next">Mise en route de CEGUI</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
<span class="next">Les widgets</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-injection-des-evenements-de-la-souris" data-claire-element-id="84268">Injection des événements de la souris</h2><p id="r-84260" data-claire-element-id="84260">Afin d'injecter les mouvements de la souris dans CEGUI, nous allons surcharger la méthode mouseMoved() pour renvoyer le déplacement de la souris dans le système. Nous utilisons pour cela la méthode injectMouseMoved() qui prend en paramètre le déplacement de la souris suivant les axes X et Y. Ces valeurs sont bien entendu disponibles via la paramètre de type OIS::MouseEvent.</p><pre id="r-84261" data-claire-element-id="84261"><code data-claire-semantic="cpp">bool TutorialApplication::mouseMoved(const OIS::MouseEvent &amp;arg)
{
    CEGUI::System::getSingleton().injectMouseMove(arg.state.X.rel, arg.state.Y.rel);
    return true;
}</code></pre><p id="r-84262" data-claire-element-id="84262">Pendant que nous en somme à informer CEGUI des mouvements de la souris, signalons-lui les clics effectués par cette dernière grâce aux deux méthodes injectMouseButtonDown() et injectMouseButtonUp().</p><pre id="r-84263" data-claire-element-id="84263"><code data-claire-semantic="cpp">bool TutorialApplication::mousePressed( const OIS::MouseEvent &amp;arg, OIS::MouseButtonID id )
{
    CEGUI::System::getSingleton().injectMouseButtonDown(convertButton(id));
    return true;
}
bool TutorialApplication::mouseReleased( const OIS::MouseEvent &amp;arg, OIS::MouseButtonID id )
{
    CEGUI::System::getSingleton().injectMouseButtonUp(convertButton(id));
    return true;
}</code></pre><p id="r-84264" data-claire-element-id="84264">La méthode convertButton() permet de faciliter la conversion de la valeur du bouton pour OIS vers CEGUI. Voici son contenu :</p><pre id="r-84265" data-claire-element-id="84265"><code data-claire-semantic="cpp">CEGUI::MouseButton TutorialApplication::convertButton(OIS::MouseButtonID buttonID)
{
    switch (buttonID)
    {
    case OIS::MB_Left:
        return CEGUI::LeftButton;
 
    case OIS::MB_Right:
        return CEGUI::RightButton;
 
    case OIS::MB_Middle:
        return CEGUI::MiddleButton;
 
    default:
        return CEGUI::LeftButton;
    }
}</code></pre><p id="r-84266" data-claire-element-id="84266">Elle est simpliste comme vous le voyez et ne fait que renvoyer la valeur CEGUI d'un bouton dont le code reçu est celui correspondant à OIS.</p><p id="r-84267" data-claire-element-id="84267">Dorénavant, CEGUI est conscient du déplacement de la souris ainsi que de ses clics, nous allons donc pouvoir créer des boutons !</p><h2 id="r-injection-des-evenements-clavier" data-claire-element-id="84274">Injection des événements clavier</h2><p id="r-84269" data-claire-element-id="84269">Un dernier point intéressant est la récupération des touches appuyées sur le clavier et leur injection dans CEGUI. Le système est le même que pour la souris, à cela près qu'il faut aussi penser à injecter la valeur de la touche tapée sur le clavier (le caractère) si l'on désire taper du texte dans CEGUI.</p><p id="r-84270" data-claire-element-id="84270">Etant donné que je ne fais qu'une présentation rapide de CEGUI, nous n'utiliserons pas ces fonctionnalités ici, mais voici la méthode à appliquer en cas de besoin :</p><pre id="r-84271" data-claire-element-id="84271"><code data-claire-semantic="cpp">bool TutorialApplication::keyPressed( const OIS::KeyEvent &amp;arg )
{
    CEGUI::System &amp;sys = CEGUI::System::getSingleton();
    sys.injectKeyDown(arg.key);
    sys.injectChar(arg.text);
    return true;
}</code></pre><pre id="r-84272" data-claire-element-id="84272"><code data-claire-semantic="cpp">bool TutorialApplication::keyReleased( const OIS::KeyEvent &amp;arg )
{
    CEGUI::System::getSingleton().injectKeyUp(arg.key);
    return true;
}</code></pre><p id="r-84273" data-claire-element-id="84273">CEGUI est maintenant conscient de tout ce que nous faisons avec le clavier et la souris !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
<span class="arrow"></span>
<span class="next">Mise en route de CEGUI</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
<span class="next">Les widgets</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Leswidgets"></a><h2>Les widgets</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
<span class="arrow"></span>
<span class="next">Gestion des entrées</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-84276" data-claire-element-id="84276">Dans CEGUI, tous les éléments affichés sont des objets dérivés de la classe CEGUI::Window. Un objet Window peut être visible ou non et peut en contenir un nombre illimité d'autres, ce qui permet de regrouper les éléments affichés par thèmes.</p><h2 id="r-ajout-d-un-bouton-a-l-interface" data-claire-element-id="84294">Ajout d'un bouton à l'interface</h2><p id="r-84277" data-claire-element-id="84277">La création d'un objet Window passe par l'utilisation du WindowManager, qui se charge d'instancier les différents objets affichables. C'est un singleton récupérable à l'aide d'une méthode statique.</p><pre id="r-84278" data-claire-element-id="84278"><code data-claire-semantic="cpp">CEGUI::WindowManager &amp;wmgr = CEGUI::WindowManager::getSingleton();</code></pre><p id="r-84279" data-claire-element-id="84279">Une fois le WindowManager récupéré, nous pouvons créer un premier objet. Avant de créer un bouton en lui-même, nous allons instancier un conteneur pour celui-ci dans lequel nous pourrons mettre plusieurs boutons ou autres widgets.</p><pre id="r-84280" data-claire-element-id="84280"><code data-claire-semantic="cpp">CEGUI::Window *sheet = wmgr.createWindow(&quot;DefaultWindow&quot;, &quot;CEGUIDemo/Sheet&quot;);</code></pre><p id="r-84281" data-claire-element-id="84281">Le premier argument de la méthode createWindow() est le type de Window que nous voulons créer (ici nous choisissons le type le plus générique), tandis que le second est le nom unique à donner à l'objet nouvellement créé.</p><p id="r-84282" data-claire-element-id="84282">Créons maintenant de la même façon un objet Window auquel nous donnerons une apparence, un texte à afficher et une taille.</p><pre id="r-84283" data-claire-element-id="84283"><code data-claire-semantic="cpp">CEGUI::Window *quit = wmgr.createWindow(&quot;TaharezLook/Button&quot;, &quot;CEGUIDemo/QuitButton&quot;);
quit-&gt;setText(&quot;Quit&quot;);
quit-&gt;setSize(CEGUI::UVector2(CEGUI::UDim(0.15, 0), CEGUI::UDim(0.05, 0)));</code></pre><p id="r-84284" data-claire-element-id="84284">Le type de cet objet est &quot;TaharezLook/Button&quot;, c'est-à-dire que nous regardons dans le style TaharezLook et choisissons l'apparence nommée &quot;Button&quot; pour obtenir un bouton.<br/> La méthode setSize() prend un argument de type CEGUI::UVector2 qui prend lui même deux paramètres de type CEGUI::UDim. Le premier de ces deux paramètres définit la largeur du bouton et le second la hauteur.</p><div id="r-84286" data-claire-element-id="84286" data-claire-semantic="question"><p id="r-84285" data-claire-element-id="84285">Je ne comprends pas comment on construit ces objets CEGUI::UDim...</p></div><p id="r-84287" data-claire-element-id="84287">Un UDim prend deux arguments, dont l'un doit être à zéro. Si le premier argument n'est pas nul, cela signifie que vous choisissez la largeur (ou la hauteur) relativement à la taille de l'objet parent, ce sera l'objet sheet en ce qui nous concerne. Si vous choisissez le second argument, vous définissez la taille en pixels de l'objet.<br/> Dans l'exemple au-dessus, j'ai donc choisi un bouton ayant une largeur de 15% de l'objet parent une hauteur de 5%.</p><p id="r-84288" data-claire-element-id="84288">Il nous reste à associer ce bouton au conteneur créé plus tôt, lui-même étant l'objet Window principal de CEGUI et fera pour sa part la taille de la fenêtre de l'application et sera invisible.</p><pre id="r-84289" data-claire-element-id="84289"><code data-claire-semantic="cpp">sheet-&gt;addChildWindow(quit);
CEGUI::System::getSingleton().setGUISheet(sheet);</code></pre><p id="r-84290" data-claire-element-id="84290">Vous pouvez compiler et lancer l'application pour survoler le bouton et le cliquer. Mais pour l'instant, celui-ci n'a encore aucune action associée, il va donc falloir remédier à cela !</p><figure id="r-84292" data-claire-element-id="84293"><img id="r-84291" data-claire-element-id="84291" src="medias/uploads.siteduzero.com_files_391001_392000_391499.jpg" alt="Image utilisateur"/></figure><h2 id="r-recuperation-d-evenements" data-claire-element-id="84307">Récupération d'événements</h2><p id="r-84295" data-claire-element-id="84295">Notre bouton et la souris sont maintenant visibles et actifs, mais un clic sur le bouton n'a aucune incidence sur le programme puisque rien n'indique ce qui doit se passer dans un tel cas. Nous devons donc dire au bouton ce qui doit se passer lors d'un clic de la souris.</p><p id="r-84296" data-claire-element-id="84296">La classe CEGUI::Window hérite de Event::Connection qui possède une méthode subscribeEvent() prévue à cet effet. Le premier paramètre est le nom de l'événement à observer et le second renseigne l'action à effectuer lorsque l'événement est déclenché.</p><pre id="r-84297" data-claire-element-id="84297"><code data-claire-semantic="cpp">virtual Event::Connection CEGUI::EventSet::subscribeEvent ( const String &amp; name, Event::Subscriber  subscriber )</code></pre><p id="r-84298" data-claire-element-id="84298">La constante CEGUI::PushButton::EventClicked est le nom de l'événement correspondant au clic sur un bouton.<br/> L'action à effectuer, de type Event::Subscriber, se construit en donnant un pointeur sur la fonction à appeler et un pointeur sur l'objet dans lequel appeler cette fonction.</p><p id="r-84299" data-claire-element-id="84299">Comme notre bouton porte la mention &quot;Quitter&quot;, je propose de créer une méthode qui va... quitter l'application. Ainsi, la récupération de l'événement s'écrit de la façon suivante :</p><pre id="r-84300" data-claire-element-id="84300"><code data-claire-semantic="cpp">quit-&gt;subscribeEvent(CEGUI::PushButton::EventClicked, CEGUI::Event::Subscriber(&amp;TutorialApplication::quit, this));</code></pre><p id="r-84301" data-claire-element-id="84301">La méthode quit() se contente de mettre un attribut mStop à <code data-claire-semantic="cpp">true</code> ; la valeur de cet attribut sera testée au début de la méthode frameRenderingQueued() par exemple pour savoir si l'on doit arrêter l'application.</p><pre id="r-84302" data-claire-element-id="84302"><code data-claire-semantic="cpp">void TutorialApplication::quit()
{
    mStop = true;
}</code></pre><p id="r-84303" data-claire-element-id="84303">Vous pouvez maintenant cliquer sur le bouton et l'application se terminera, de la même façon que si vous appuyez sur la touche <kbd>echap</kbd>.</p><p id="r-84304" data-claire-element-id="84304">Cette introduction à CEGUI vous aura permis d'apercevoir quelques concepts utilisés par cette bibliothèque de GUI. Vous avez maintenant les connaissances pour utiliser le curseur de la souris et des boutons, mais rien ne vous empêche d'aller plus loin en allant sur le <a href="http://www.cegui.org.uk/">site officiel</a> de CEGUI ou même de jeter directement un oeil dans les fichiers de ressources pour trouver de nouveaux widgets utilisables.</p><p id="r-84305" data-claire-element-id="84305">Ce cours n'est pas terminé !</p><p id="r-84306" data-claire-element-id="84306">Si vous avez des questions, des problèmes avec le code, postez votre question sur le forum pour que tout le monde puisse profiter des réponses.<br/> Pour toute suggestion à propos du cours, n'hésitez pas à m'envoyer un MP.</p><h2 id="r-liens-utiles-2" data-claire-element-id="84315">Liens utiles</h2><ul id="r-84314" data-claire-element-id="84314"><li id="r-84309" data-claire-element-id="84309"><p id="r-84308" data-claire-element-id="84308"><a href="http://www.ogre3d.org/docs/api/html/">La documentation officielle</a> de la bibliothèque</p></li><li id="r-84311" data-claire-element-id="84311"><p id="r-84310" data-claire-element-id="84310"><a href="http://www.ogre3d.org/docs/manual/">Le manuel</a>, qui précise le fonctionnement de mécanismes comme les matériaux, les animations...</p></li><li id="r-84313" data-claire-element-id="84313"><p id="r-84312" data-claire-element-id="84312"><a href="http://www.ogre3d.org/tikiwiki/">Le wiki officiel</a> compilant des tutoriels ainsi que de nombreux articles sur Ogre 3D</p></li></ul>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d">Découvrez Ogre 3D</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 1</span>
Les bases
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-a-ogre-3d">Introduction à Ogre 3D</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-moteur-3d">
Un moteur 3D ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/pourquoi-ogre-et-pas-un-autre">
Pourquoi Ogre et pas un autre ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/telechargement-et-installation-2">
Téléchargement et installation
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/votre-premiere-application">Votre première application</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/configuration-d-un-projet">
Configuration d&#039;un projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-code-de-base-1">
Le code de base
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/inserer-des-objets-dans-la-scene">Insérer des objets dans la scène</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-entites">
Les entités
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-noeuds-de-scene">
Les noeuds de scène
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-mesh">
Créer un mesh
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/se-reperer-dans-l-espace">Se repérer dans l&#039;espace</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-systeme-de-coordonnees">
Le système de coordonnées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/deplacer-des-objets">
Déplacer des objets
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-camera">
La caméra
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-viewport">
Le Viewport
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allumez-la-lumiere">Allumez la lumière !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lumieres">
Les lumières
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-ombres-1">
Les ombres
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-gestion-des-entrees">La gestion des entrées</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-frame-listeners">
Les frame listeners
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ois">
OIS
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/allons-y-sans-buffer">
Allons-y sans buffer
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/avec-buffer-c-est-plus-simple">
Avec buffer, c&#039;est plus simple ?
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gardez-les-pieds-sur-terre">Gardez les pieds sur terre !</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/creer-un-terrain">
Créer un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/le-plaquage-de-texture">
Le plaquage de texture
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/et-si-on-en-veut-plus">
Et si on en veut plus ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-ciel-au-dessus-de-nos-tetes">
Un ciel au-dessus de nos têtes
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 2</span>
Au coeur de la bête
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/une-application-a-partir-de-zero">Une application à partir de zéro</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-2">
Préparation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/au-debut-une-fenetre">
Au début, une fenêtre
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/ajout-du-frame-listener">
Ajout du Frame Listener
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/implementer-ois">
Implémenter OIS
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-materiaux">Les matériaux</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/preparation-du-projet-2">
Préparation du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/la-structure-d-un-materiau">
La structure d&#039;un matériau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/choisir-les-couleurs">
Choisir les couleurs
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures">
Les textures
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/copier-un-materiau-dans-un-autre">
Copier un matériau dans un autre
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-shaders-1-2">Les shaders (1/2)</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/introduction-4">
Introduction
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/un-shader-simple">
Un shader simple
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-textures-via-les-shaders">
Les textures via les shaders
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 3</span>
Du mouvement dans la scène
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/animer-les-meshes">Animer les meshes</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/utiliser-les-quaternions">
Utiliser les quaternions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gerer-les-animations-d-un-mesh">
Gérer les animations d&#039;un mesh
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/suivez-le-chemin">
Suivez le chemin !
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-lancers-de-rayon">Les lancers de rayon</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/qu-est-ce-qu-un-rayon">
Qu&#039;est ce qu&#039;un rayon ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-intersection-avec-un-terrain">
L&#039;intersection avec un terrain
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/intersection-avec-un-mesh">
Intersection avec un mesh
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass('box-shadow-summary').next().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').next().removeClass('box-shadow-summary');">
<span>Partie 4</span>
Annexes
</a>
<a class="chapterOpen" href="#" onmouseover="$(this).addClass('box-shadow-summary').prev().addClass('box-shadow-summary');" onmouseout="$(this).removeClass('box-shadow-summary').prev().removeClass('box-shadow-summary');">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/l-interface-avec-cegui">L&#039;interface avec CEGUI</a>
<a class="subchapterOpen" href="#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/installation-11">
Installation
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/mise-en-route-de-cegui">
Mise en route de CEGUI
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
Gestion des entrées
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/les-widgets">
Les widgets
</a>
</li>
</ul>
</li>
</ul>
</li>
</li>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/decouvrez-ogre-3d/gestion-des-entrees">
<span class="arrow"></span>
<span class="next">Gestion des entrées</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/decouvrez-ogre-3d.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 20:19:20 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/decouvrez-ogre-3d.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 03:50:02 GMT -->
</html>