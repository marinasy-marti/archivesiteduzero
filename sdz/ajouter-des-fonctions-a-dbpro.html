<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/ajouter-des-fonctions-a-dbpro.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 03:05:24 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/ajouter-des-fonctions-a-dbpro.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:41:09 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Ajouter des fonctions à DBPro</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/ajouter-des-fonctions-a-dbpro.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Ajouter des fonctions à DBPro</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#AjouterdesfonctionsDBPro">Ajouter des fonctions à DBPro</a><br/><a href="#Baseduprojet">Base du projet</a><br/><a href="#Ajoutdesfonctions">Ajout des fonctions</a><br/><a href="#DLLStringTable">DLL String Table</a><br/><a href="#TestonsmaintenantdansDarkBasic">Testons maintenant dans DarkBasic</a><br/></div>
<a name="AjouterdesfonctionsDBPro"></a><h2>Ajouter des fonctions à DBPro</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
<span class="next">Base du projet</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-350918" data-claire-element-id="350918">Vous avez toujours voulu savoir comment ajouter des fonctions à DBPro sans jamais oser le demander ?<br/> Eh bien je vais vous le dire.</p><aside id="r-350920" data-claire-element-id="350920" data-claire-semantic="warning"><p id="r-350919" data-claire-element-id="350919">Pour ce tuto, il faut Visual Studio .NET 2003.</p></aside>
</div><a name="Baseduprojet"></a><h2>Base du projet</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
<span class="next">Ajout des fonctions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-350921" data-claire-element-id="350921">Lancez Visual Studio, faites &quot;Nouveau projet &gt; projet Win32 &gt; dans paramètre de l'application (cochez &quot;DLL&quot;) &gt; Valider&quot;.</p><p id="r-350922" data-claire-element-id="350922">Tout le code sera à mettre dans le fichier <em>nombre_de_votre_projet</em>.cpp après la fonction <code>DllMain()</code>.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro">Ajouter des fonctions à DBPro</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
Base du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
Ajout des fonctions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
DLL String Table
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/testons-maintenant-dans-darkbasic">
Testons maintenant dans DarkBasic
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
<span class="next">Ajout des fonctions</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Ajoutdesfonctions"></a><h2>Ajout des fonctions</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
<span class="arrow"></span>
<span class="next">Base du projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
<span class="next">DLL String Table</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-350924" data-claire-element-id="350924">Les fonctions que vous voudrez ajouter devront être de la forme :</p><pre id="r-350925" data-claire-element-id="350925"><code data-claire-semantic="c">__declspec(dllexport) type_de_retour nom_de_la_fonction(parametres)
{ 
        corps de la fonction
}</code></pre><p id="r-350926" data-claire-element-id="350926">En fait, ce sont de simples <a href="http://www.siteduzero.com/tuto-3-2842-1-les-fonctions.html">fonctions</a> précédées de <code>__declspec(dllexport)</code><strong>__declspec(dllexport).</strong></p><p id="r-350927" data-claire-element-id="350927">Pour ce tutoriel, je vais utiliser ces deux fonctions :</p><pre id="r-350928" data-claire-element-id="350928"><code data-claire-semantic="c">// fonction BoiteDialogue, affiche une boîte de dialogue
__declspec(dllexport) void BoiteDialogue(LPCTSTR titre,LPCTSTR message)
{
        if(titre &amp;&amp; message) // si le titre et le message ne sont pas vides
                MessageBox(NULL,message,titre,MB_OK | MB_ICONINFORMATION); // on affiche une boîte de dialogue
}

// fonction cube, retourne le cube de la valeur passé en paramètre
__declspec(dllexport) int Cube(int val)
{
        return (val*val*val);
}</code></pre><p id="r-350929" data-claire-element-id="350929">Copiez ce code après la fonction <code>DllMain()</code> puis lancez la compilation.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro">Ajouter des fonctions à DBPro</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
Base du projet
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
Ajout des fonctions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
DLL String Table
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/testons-maintenant-dans-darkbasic">
Testons maintenant dans DarkBasic
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
<span class="arrow"></span>
<span class="next">Base du projet</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
<span class="next">DLL String Table</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="DLLStringTable"></a><h2>DLL String Table</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
<span class="arrow"></span>
<span class="next">Ajout des fonctions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/testons-maintenant-dans-darkbasic">
<span class="next">Testons maintenant dans DarkBasic</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-350931" data-claire-element-id="350931">La &quot;String Table&quot; permet à DBPro de savoir quelles fonctions il peut utiliser.</p><p id="r-350932" data-claire-element-id="350932">Clic droit dans l'explorateur de solution &gt; Ajouter &gt; Ajouter une ressource.</p><figure id="r-350934" data-claire-element-id="350935"><img id="r-350933" data-claire-element-id="350933" src="medias/uploads.siteduzero.com_files_11001_12000_11520.png" alt="Image utilisateur"/></figure><p id="r-350936" data-claire-element-id="350936">Choisissez &quot;String Table&quot; dans le menu et cliquez sur &quot;nouveau&quot;.</p><figure id="r-350938" data-claire-element-id="350939"><img id="r-350937" data-claire-element-id="350937" src="medias/uploads.siteduzero.com_files_11001_12000_11521.png" alt="Image utilisateur"/></figure><p id="r-350940" data-claire-element-id="350940">Le fichier .rc créé s'ouvre avec une valeur <code>IDS_STRING101</code> et ayant 101 comme valeur.<br/> Cliquez sur cette ligne dans la colonne &quot;légende&quot;, ce que vous entrerez dans le champ apparu doit avoir une syntaxe très stricte.</p><p id="r-350941" data-claire-element-id="350941">Voici la syntaxe :</p><pre id="r-350942" data-claire-element-id="350942"><code>nom([%retour)(%paramètres)%fonction dans la DLL%commentaires</code></pre><aside id="r-350944" data-claire-element-id="350944" data-claire-semantic="information"><p id="r-350943" data-claire-element-id="350943">Il ne faut pas de % entre <em>retour</em> et <em>paramètres</em>.</p></aside><ul id="r-350955" data-claire-element-id="350955"><li id="r-350946" data-claire-element-id="350946"><p id="r-350945" data-claire-element-id="350945">nom : nom de la commande sous DBPro (en majuscules)</p></li><li id="r-350948" data-claire-element-id="350948"><p id="r-350947" data-claire-element-id="350947">retour : type de la fonction de retour comme &quot;paramètres&quot;</p></li><li id="r-350950" data-claire-element-id="350950"><p id="r-350949" data-claire-element-id="350949">paramètres : liste des paramètres dans l'ordre (S = string, L = entier, F = réel, D = dword)</p></li><li id="r-350952" data-claire-element-id="350952"><p id="r-350951" data-claire-element-id="350951">fonction dans la DLL : voir plus bas</p></li><li id="r-350954" data-claire-element-id="350954"><p id="r-350953" data-claire-element-id="350953">commentaires (facultatif) : ce que vous voulez</p></li></ul><aside id="r-350957" data-claire-element-id="350957" data-claire-semantic="information"><p id="r-350956" data-claire-element-id="350956">Pour avoir la fonction dans la DLL, ouvrez votre DLL générée et recherchez votre fonction et vous devrez tomber sur quelque chose comme : ?BoiteDialogue@@YAXPBD0@Z et c'est ce texte qu'il faut récupérer.</p></aside><p id="r-350958" data-claire-element-id="350958">Pour la fonction &quot;BoiteDialogue&quot;, j'obtiens ceci :</p><pre id="r-350959" data-claire-element-id="350959"><code>BOITE DIALOGUE%SS%?BoiteDialogue@@YAXPBD0@Z%boite de dialogue</code></pre><ul id="r-350968" data-claire-element-id="350968"><li id="r-350961" data-claire-element-id="350961"><p id="r-350960" data-claire-element-id="350960">BOITE DIALOGUE : nom de votre fonction sous DBPro</p></li><li id="r-350963" data-claire-element-id="350963"><p id="r-350962" data-claire-element-id="350962">SS : paramètres de votre fonction (ici deux chaînes de caractères)</p></li><li id="r-350965" data-claire-element-id="350965"><p id="r-350964" data-claire-element-id="350964">?BoiteDialogue@@YAXPBD0@Z : votre fonction dans la DLL</p></li><li id="r-350967" data-claire-element-id="350967"><p id="r-350966" data-claire-element-id="350966">boite de dialogue : commentaire</p></li></ul><p id="r-350969" data-claire-element-id="350969">Passons à la fonction &quot;Cube&quot; :</p><ul id="r-350978" data-claire-element-id="350978"><li id="r-350971" data-claire-element-id="350971"><p id="r-350970" data-claire-element-id="350970">nous allons lui donner un nom très original : CUBE ;</p></li><li id="r-350973" data-claire-element-id="350973"><p id="r-350972" data-claire-element-id="350972">comme elle retourne une valeur, il faut faire suivre son nom de [ ;</p></li><li id="r-350975" data-claire-element-id="350975"><p id="r-350974" data-claire-element-id="350974">ensuite vient le type de retour suivi du paramètre : LL (entier,entier) ;</p></li><li id="r-350977" data-claire-element-id="350977"><p id="r-350976" data-claire-element-id="350976">enfin la fonction dans la DLL, on prendra &quot;?Cube@@YAHH@Z&quot; pour l'exemple.</p></li></ul><p id="r-350979" data-claire-element-id="350979">Essayez de trouver vous-mêmes.</p><div id="r-350982" data-claire-element-id="350982"><div id="r-350981" data-claire-element-id="350981"><p id="r-350980" data-claire-element-id="350980">CUBE[%LL%?Cube@@YAHH@Z</p></div></div>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro">Ajouter des fonctions à DBPro</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
Base du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
Ajout des fonctions
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
DLL String Table
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/testons-maintenant-dans-darkbasic">
Testons maintenant dans DarkBasic
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
<span class="arrow"></span>
<span class="next">Ajout des fonctions</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/testons-maintenant-dans-darkbasic">
<span class="next">Testons maintenant dans DarkBasic</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="TestonsmaintenantdansDarkBasic"></a><h2>Testons maintenant dans DarkBasic</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
<span class="arrow"></span>
<span class="next">DLL String Table</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-350984" data-claire-element-id="350984">Première chose à faire, récupérer la DLL générée qui doit se trouver dans :</p><p id="r-350985" data-claire-element-id="350985"><cite>Citation : PC</cite></p><blockquote id="r-350987" data-claire-element-id="350987"><p id="r-350986" data-claire-element-id="350986">C:\Documents and Settings\****\Mes documents\Visual Studio Projects\***\(Debug ou Release)</p></blockquote><p id="r-350988" data-claire-element-id="350988">et la déplacer dans le dossier plugins-user de DarkBasic :</p><p id="r-350989" data-claire-element-id="350989"><cite>Citation : PC</cite></p><blockquote id="r-350991" data-claire-element-id="350991"><p id="r-350990" data-claire-element-id="350990">C:\Program Files\Dark Basic Software\Dark Basic Professional\Compiler\plugins-user</p></blockquote><p id="r-350992" data-claire-element-id="350992">C'est fait ? Alors lancez DarkBasic, puis créez un nouveau projet et mettez-y le code suivant :</p><pre id="r-350993" data-claire-element-id="350993"><code>A = CUBE(5)
BOITE DIALOGUE &quot;Cube de A&quot;,&quot;Le cube de A=5 est : &quot;+str$(A)</code></pre><p id="r-350994" data-claire-element-id="350994">Appuyez sur F5 et voyez le résultat !</p><p id="r-350995" data-claire-element-id="350996"><em><a href="medias/uploads.siteduzero.com_files_12001_13000_12202.png"><img id="r-350996" data-claire-element-id="350995" src="medias/uploads.siteduzero.com_thb_12001_13000_12202.png" alt="Image utilisateur"/></a>Cliquez sur l'image</em></p><p id="r-350997" data-claire-element-id="350997"><a href="http://minirop.free.fr/dialogs.zip">DLL de test et projet VC++</a></p><p id="r-350998" data-claire-element-id="350998">Maintenant vous pouvez vous ajouter des fonctions à DBPro, amusez-vous bien. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro">Ajouter des fonctions à DBPro</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/base-du-projet">
Base du projet
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/ajout-des-fonctions">
Ajout des fonctions
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
DLL String Table
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/testons-maintenant-dans-darkbasic">
Testons maintenant dans DarkBasic
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/ajouter-des-fonctions-a-dbpro/dll-string-table">
<span class="arrow"></span>
<span class="next">DLL String Table</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/ajouter-des-fonctions-a-dbpro.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 03:05:25 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/ajouter-des-fonctions-a-dbpro.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:41:10 GMT -->
</html>