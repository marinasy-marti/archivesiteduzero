<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/creez-votre-propre-package.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:21:19 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creez-votre-propre-package.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:21:39 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Créez votre propre package</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/creez-votre-propre-package.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Créez votre propre package</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Crezvotreproprepackage">Créez votre propre package</a><br/><a href="#Structuredebase">Structure de base</a><br/><a href="#L039astucebabel">L&#039;astuce babel</a><br/><a href="#ConditionsTeXconditionsLaTeX">Conditions TeX, conditions LaTeX</a><br/><a href="#Utilisationdevotreextension">Utilisation de votre extension</a><br/></div>
<a name="Crezvotreproprepackage"></a><h2>Créez votre propre package</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
<span class="next">Structure de base</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-585316" data-claire-element-id="585316">Bonjour chers amis ZérOs !</p><p id="r-585317" data-claire-element-id="585317">Utilisateurs du système de composition typographique \LaTeX{}, vous en avez assez de saisir toujours les mêmes lignes dans le préambule de votre document ? Sachez qu'il est possible de créer votre propre package (ou dans un langage plus français : extension) dans lequel vous chargerez vos extensions, commandes et environnements favoris, afin de vous rendre la vie beaucoup plus facile !</p><p id="r-585318" data-claire-element-id="585318">Prêts à franchir un nouveau pas dans votre utilisation du merveilleux système qu'est \TeX{} (et sa <em>surcouche</em>\LaTeX{}) ?</p><p id="r-585319" data-claire-element-id="585319">Suivez le guide...</p><aside id="r-585321" data-claire-element-id="585321" data-claire-semantic="information"><p id="r-585320" data-claire-element-id="585320">Dans la suite du tutoriel, par pure fainéantise, j'écrirai TeX et LaTeX, respectivement à la place de \TeX{} et \LaTeX{}.</p></aside>
</div><a name="Structuredebase"></a><h2>Structure de base</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
<span class="next">L&#039;astuce babel</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-le-code-minimal-2" data-claire-element-id="585324">Le code minimal</h2><p id="r-585322" data-claire-element-id="585322">Tout d'abord, commençons par la structure minimale de toute extension \LaTeX{}2_{\epsilon} (pour les novices, prononcez la tek 2 epsilon) :</p><pre id="r-585323" data-claire-element-id="585323"><code data-claire-semantic="tex">\NeedsTeXFormat{LaTeX2e}[1999/01/01]
\ProvidesPackage{nomPackage}[2007/11/26]
 
%chargement des extensions requises au bon fonctionnement de l'extension et des documents
 
%déclaration des options de l'extension
\ProcessOptions
 
%commandes et/ou environnements personnalisés
 
\endinput</code></pre><h2 id="r-analyse-du-code-minimal" data-claire-element-id="585379">Analyse du code minimal</h2><p id="r-585325" data-claire-element-id="585325">Afin de mieux comprendre, je vous propose une étude ligne par ligne du code.</p><h3 id="r-specifications-de-base" data-claire-element-id="585333">Spécifications de base</h3><pre id="r-585326" data-claire-element-id="585326"><code data-claire-semantic="tex">\NeedsTeXFormat{LaTeX2e}[1999/01/01]</code></pre><p id="r-585327" data-claire-element-id="585327">On spécifie tout d'abord la version de LaTeX nécessaire au fonctionnement de l'extension. Dans ce cas, on demande la version 2e soit 2_{\epsilon}. L'argument optionnel (entre crochets) précise la date minimale de sortie du moteur TeX (ou des macros LaTeX permettant l'utilisation de l'extension créée). Ceci n'est nécessaire que si vous souhaitez utiliser des commandes seulement présentes dans des versions bien précises des moteurs TeX ou LaTeX.</p><aside id="r-585329" data-claire-element-id="585329" data-claire-semantic="warning"><p id="r-585328" data-claire-element-id="585328">Aux utilisateurs de \LaTeX{} 2.09 :<br/> il est actuellement fortement déconseillé d'utiliser cette version du système de macros LaTeX, car de plus en plus d'extensions sont inaccessibles et l'utilisation est bien moins confortable pour de nombreuses actions.</p></aside><pre id="r-585330" data-claire-element-id="585330"><code data-claire-semantic="tex">\ProvidesPackage{monPackage}[2007/11/26]</code></pre><p id="r-585331" data-claire-element-id="585331">Ceci est une ligne essentielle. En effet, c'est elle qui détermine le nom de l'extension que vous créez. Dans ce cas, le nom est très original : <em>monPackage</em>. Une fois de plus, l'argument optionnel permet de préciser la date de création de l'extension.<br/> Ainsi, pour utiliser votre extension dans votre document, vous écrirez :</p><pre id="r-585332" data-claire-element-id="585332"><code data-claire-semantic="tex">\usepackage{monPackage}</code></pre><h3 id="r-chargement-des-extensions" data-claire-element-id="585342">Chargement des extensions</h3><pre id="r-585334" data-claire-element-id="585334"><code data-claire-semantic="tex">%chargement des extensions requises au bon fonctionnement de l'extension et des documents</code></pre><div id="r-585336" data-claire-element-id="585336" data-claire-semantic="question"><p id="r-585335" data-claire-element-id="585335">Eh ! C'est quoi cette ligne en commentaire ? Tu crois vraiment que le compilateur va la lire ?</p></div><p id="r-585337" data-claire-element-id="585337">Bien sûr que non ! Les marqueurs de commentaires ne varient pas entre les fichiers sources et les fichiers d'extensions. Je ne voulais simplement pas vous donner d'exemple et donner directement la commande sans argument n'aurait pas été très explicite.<br/> Je vous propose maintenant la syntaxe correcte à utiliser :</p><pre id="r-585338" data-claire-element-id="585338"><code data-claire-semantic="tex">\RequirePackage[&lt;options]{&lt;package&gt;}</code></pre><p id="r-585339" data-claire-element-id="585339">Comme on peut aisément le remarquer, <em>\RequirePackage[]{}</em> possède la même syntaxe que <em>\usepackage[]{}</em> que l'on utilise dans les fichiers sources &quot;classiques&quot;.</p><aside id="r-585341" data-claire-element-id="585341" data-claire-semantic="warning"><p id="r-585340" data-claire-element-id="585340">Veillez à bien charger <strong>toutes</strong> les extensions nécessaires au fonctionnement de votre extension. Je pense notamment aux extensions du type <em>amsmath</em> si vous définissez dans votre extension une commande utilisant la famille <em>\mathbb{}</em>.</p></aside><h3 id="r-options-8" data-claire-element-id="585368">Options</h3><pre id="r-585343" data-claire-element-id="585343"><code data-claire-semantic="tex">%déclaration des options de l'extension</code></pre><p id="r-585344" data-claire-element-id="585344">Afin de déclarer les options que vous comptez utiliser, on procède comme suit.</p><p id="r-585345" data-claire-element-id="585345">1. <strong>Options définies</strong></p><pre id="r-585346" data-claire-element-id="585346"><code data-claire-semantic="tex">\DeclareOption{&lt;nom de l'option&gt;}{&lt;action&gt;}</code></pre><p id="r-585347" data-claire-element-id="585347">Dans <em>&lt;nom de l'option&gt;</em>, on met le mot clef à indiquer dans les arguments optionnels de la commande <em>\usepackage[]{}</em>.<br/> Dans <em>&lt;action&gt;</em>, on indique l'action à réaliser si l'option est demandée.</p><div id="r-585349" data-claire-element-id="585349" data-claire-semantic="question"><p id="r-585348" data-claire-element-id="585348">C'est bien beau tout ça, mais cela ne m'indique pas ce qu'il faut mettre dans <em>&lt;action&gt;</em>.</p></div><p id="r-585350" data-claire-element-id="585350">En fait, on met bien souvent (voire toujours) un changement de valeur de booléen. Je m'explique : imaginons que je veuille rendre l'utilisation de l'extension <em>hyperref</em> (pour créer des liens hypertextes et bien d'autres choses dans mon document) optionnelle. Je crée alors un booléen auquel j'affecte la valeur <em>false</em> :</p><pre id="r-585351" data-claire-element-id="585351"><code data-claire-semantic="tex">\RequirePackage{ifthen}%pour utiliser les booléens, à mettre avec les autres RequirePackage's
 
\newboolean{booleenH}%création du booléen
\setboolean{booleenH}{false}%affectation de la valeur false</code></pre><p id="r-585352" data-claire-element-id="585352">Ensuite, lorsque je déclare mon option, j'écris :</p><pre id="r-585353" data-claire-element-id="585353"><code data-claire-semantic="tex">\DeclareOption{optionH}{\setboolean{booleenH}{true}}</code></pre><p id="r-585354" data-claire-element-id="585354">Donc, si l'option est demandée, on affecte à mon booleenH la valeur <em>true</em>.</p><p id="r-585355" data-claire-element-id="585355">Enfin, après le <em>\ProcessOptions</em>, je charge l'extension <em>hyperref</em>, uniquement si l'option <em>optionH</em> est demandée :</p><pre id="r-585356" data-claire-element-id="585356"><code data-claire-semantic="tex">\ifthenelse{\boolean{booleenH}%
}{\RequirePackage{hyperref}%
}{}</code></pre><p id="r-585357" data-claire-element-id="585357">Remarque : une autre solution est présentée dans la suite du tutoriel.</p><p id="r-585358" data-claire-element-id="585358">2. <strong>Options indéfinies</strong></p><p id="r-585359" data-claire-element-id="585359">Imaginons à présent que vous êtes polyglottes. Vous aurez donc besoin de charger des options de <em>babel</em> différentes (eh oui, même <em>babel</em> est chargé par votre extension personnelle ! ). Dans ce cas, on ne peut pas déclarer les options comme indiqué ci-dessus. On utilise donc un joker : l'étoile (*).</p><pre id="r-585360" data-claire-element-id="585360"><code data-claire-semantic="tex">\DeclareOption*{action}</code></pre><p id="r-585361" data-claire-element-id="585361">Évidemment, il n'y a pas de champ <em>&lt;nom de l'option&gt;</em> à compléter ! <br/> Dans le champ <em>&lt;action&gt;</em>, on utilise bien souvent la ligne suivante :</p><pre id="r-585362" data-claire-element-id="585362"><code data-claire-semantic="tex">\DeclareOption*{\PassOptionToPackage{\CurrentOption}{&lt;package&gt;}}</code></pre><p id="r-585363" data-claire-element-id="585363">Ce qui permet de passer l'ensemble des options non déclarées explicitement à l'extension <em>&lt;package&gt;</em> souhaitée.</p><aside id="r-585365" data-claire-element-id="585365" data-claire-semantic="warning"><p id="r-585364" data-claire-element-id="585364">L'extension voulue doit être chargée avec un <em>(\RequirePackage[]{}) <strong>après</strong> la commande <em>\DeclareOption*{}</em></em>.</p></aside><p id="r-585366" data-claire-element-id="585366">Puis vient la validation des options avec :</p><pre id="r-585367" data-claire-element-id="585367"><code data-claire-semantic="tex">\ProcessOptions</code></pre><h3 id="r-commandes-et-environnements-personnalises" data-claire-element-id="585374">Commandes et environnements personnalisés</h3><p id="r-585369" data-claire-element-id="585369">La dernière partie de votre extension est consacrée à la définition de vos propres commandes et environnements. On utilise pour ce faire les deux commandes suivantes, respectivement pour les commandes et les environnements :</p><pre id="r-585370" data-claire-element-id="585370"><code data-claire-semantic="tex">\newcommand{&lt;\nomCommande&gt;}[&lt;nombreArguments]{&lt;code&gt;}</code></pre><p id="r-585371" data-claire-element-id="585371">et :</p><pre id="r-585372" data-claire-element-id="585372"><code data-claire-semantic="tex">\newenvironnment{&lt;nomEnvironnement&gt;}{&lt;clausesDébut&gt;}{&lt;clausesFin&gt;}</code></pre><p id="r-585373" data-claire-element-id="585373">La création de commandes et d'environnements n'étant pas le sujet de ce tutoriel, je ne m'étendrai pas d'avantage.</p><h3 id="r-et-pour-finir-2" data-claire-element-id="585378">Et pour finir...</h3><p id="r-585375" data-claire-element-id="585375">Eh bien, on indique au compilateur que c'est fini avec :</p><pre id="r-585376" data-claire-element-id="585376"><code data-claire-semantic="tex">\endinput</code></pre><p id="r-585377" data-claire-element-id="585377">Et voilà !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package">Créez votre propre package</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
Structure de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
L&#039;astuce babel
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
Conditions TeX, conditions LaTeX
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/utilisation-de-votre-extension">
Utilisation de votre extension
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
<span class="next">L&#039;astuce babel</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="L039astucebabel"></a><h2>L&#039;astuce babel</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
<span class="arrow"></span>
<span class="next">Structure de base</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
<span class="next">Conditions TeX, conditions LaTeX</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-585381" data-claire-element-id="585381">Comme nous l'avons vu dans la sous-partie précédente, il faut recourir au joker étoilé pour optimiser le chargement de l'extension <em>babel</em>. Je vous propose ici d'étudier plus en détail ce que j'ai baptisé &quot;l'astuce babel&quot;, afin d'en maîtriser toutes les facettes.</p><h2 id="r-gestion-des-langues-ce-qu-il-faut-savoir" data-claire-element-id="585404">Gestion des langues : ce qu'il faut savoir</h2><p id="r-585382" data-claire-element-id="585382">Vous le savez peut-être : l'extension <em>babel</em>, habituellement chargée pour nous francophones, est représentée par l'un des codes suivants :</p><pre id="r-585383" data-claire-element-id="585383"><code data-claire-semantic="tex">\usepackage[francais]{babel}
%ou
\usepackage[frenchb]{babel}
%ou encore
\usepackage[frenchle]{babelfr}
%liste non exhaustive</code></pre><p id="r-585384" data-claire-element-id="585384">Elle permet d'adapter différents paramètres (traduction des titres, gestion de la typographie, etc.) à la langue choisie. Cependant, <em>babel</em> ne se contente pas de gérer une seule langue à la fois. En effet, il est possible d'utiliser plusieurs langues dans un même document. <br/> Imaginons, par exemple, que je veuille écrire en français, en anglais et en allemand. Dans une source normale, j'écrirai :</p><pre id="r-585385" data-claire-element-id="585385"><code data-claire-semantic="tex">\usepackage[deutsch,english,français]{babel}</code></pre><p id="r-585386" data-claire-element-id="585386">Ce qui aura pour effet de charger les modules de traduction en anglais, en allemand et en français.</p><div id="r-585388" data-claire-element-id="585388" data-claire-semantic="question"><p id="r-585387" data-claire-element-id="585387">Mais il y a un problème. Pour les chapitres par exemple, il sera marqué ceci : Kapitel, Chapter, Chapitre 1 ?</p></div><p id="r-585389" data-claire-element-id="585389">Euh non ! Ce serait d'ailleurs bien embêtant ! En fait, c'est la dernière langue demandée (ici <em>français</em>) qui est appliquée par défaut. Il sera donc marqué, si je ne précise rien : Chapitre 1. Ouf !</p><h3 id="r-changement-de-langue" data-claire-element-id="585403">Changement de langue</h3><p id="r-585390" data-claire-element-id="585390">Pour changer de langue, <em>babel</em> offre plusieurs possibilités :</p><ul id="r-585400" data-claire-element-id="585400"><li id="r-585393" data-claire-element-id="585393"><p id="r-585391" data-claire-element-id="585391">un environnement :</p><pre id="r-585392" data-claire-element-id="585392"><code data-claire-semantic="tex">\begin{otherlanguage}{&lt;langue&gt;}
\end{otherlanguage}</code></pre></li><li id="r-585396" data-claire-element-id="585396"><p id="r-585394" data-claire-element-id="585394">une commande :</p><pre id="r-585395" data-claire-element-id="585395"><code data-claire-semantic="tex">\foreignlanguage{&lt;langue&gt;}{&lt;texte dans la langue &lt;langue&gt;&gt;}</code></pre></li><li id="r-585399" data-claire-element-id="585399"><p id="r-585397" data-claire-element-id="585397">une déclaration :</p><pre id="r-585398" data-claire-element-id="585398"><code data-claire-semantic="tex">\selectlanguage{&lt;langue&gt;}</code></pre></li></ul><aside id="r-585402" data-claire-element-id="585402" data-claire-semantic="warning"><p id="r-585401" data-claire-element-id="585401">Dans tous les cas, la langue <em>(&lt;langue&gt;)</em> indiquée en argument doit avoir été chargée par <em>babel</em>.</p></aside><h2 id="r-utilisation-de-declareoption" data-claire-element-id="585420">Utilisation de <em>\DeclareOption*{}</em></h2><p id="r-585405" data-claire-element-id="585405">Nous allons à présent voir comment on peut utiliser intelligemment la commande <em>\DeclareOption*{}</em>.<br/> Je vous propose le code suivant que je commenterai brièvement ensuite :</p><pre id="r-585406" data-claire-element-id="585406"><code data-claire-semantic="tex">%tout ce qui doit être là...
\DeclareOption*{\PassOptionsToPackage{\CurrentOption}{babel}}
\ProcessOptions
%ligne vide pour y voir plus clair
\RequirePackage{babel}</code></pre><p id="r-585407" data-claire-element-id="585407">Comme je l'avais déjà proposé précédemment, on demande à passer l'ensemble des options non déclarées explicitement, c'est-à-dire avec une commande <em>\DeclareOption{}{}</em>, au package <em>babel</em>. Celui-ci doit donc être chargé <strong>après</strong>, comme indiqué sur le code ci-dessus et <strong>sans aucune option</strong>.</p><aside id="r-585413" data-claire-element-id="585413" data-claire-semantic="error"><p id="r-585408" data-claire-element-id="585408">J'insiste bien sur le fait qu'il ne faut surtout pas indiquer d'options à l'extension <em>babel</em> dans la ligne :</p><pre id="r-585409" data-claire-element-id="585409"><code data-claire-semantic="tex">\RequirePackage{babel}</code></pre><p id="r-585410" data-claire-element-id="585410">Sinon, vous risquez d'avoir un superbe message d'erreur :</p><pre id="r-585411" data-claire-element-id="585411"><code data-claire-semantic="console">! LaTeX Error : Option clash for package babel</code></pre><p id="r-585412" data-claire-element-id="585412">Ce qui signifie que vous avez tenté de charger l'extension <em>babel</em> avec des options différentes, à deux moments différents. Et bien sûr, la compilation plante !</p></aside><h3 id="r-remarques-concernant-l-utilisation-de-l-astuce-babel" data-claire-element-id="585419">Remarques concernant l'utilisation de &quot;l'astuce babel&quot;.</h3><p id="r-585414" data-claire-element-id="585414">Il existe cependant un désavantage majeur à l'utilisation de cette astuce qui est néanmoins très utile. En effet, vous êtes obligés de donner une option de langage à votre extension. De plus, n'oubliez pas que c'est la dernière langue entrée qui est utilisée par défaut dans votre document. D'autre part, il est ensuite impossible de passer d'autres options non déclarées explicitement à d'autres packages que <em>babel</em>. <br/> Exemple : vous voulez utiliser les options non déclarées explicitement pour les extensions <em>hyperref</em> et <em>babel</em>. Dans la source de votre document, vous écrivez alors :</p><pre id="r-585415" data-claire-element-id="585415"><code data-claire-semantic="tex">\usepackage[francais,colorlinks=true]{mon_package}</code></pre><p id="r-585416" data-claire-element-id="585416">Et, lors de la compilation, vous obtenez :</p><pre id="r-585417" data-claire-element-id="585417"><code data-claire-semantic="console">! Package babel Error : Language definition file colorlinks.ldf not found</code></pre><p id="r-585418" data-claire-element-id="585418">Autrement dit, si vous ne voulez pas avoir d'erreur de compilation, il ne vous reste plus qu'à inventer la langue <em>colorlinks</em> :lol: !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package">Créez votre propre package</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
Structure de base
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
L&#039;astuce babel
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
Conditions TeX, conditions LaTeX
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/utilisation-de-votre-extension">
Utilisation de votre extension
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
<span class="arrow"></span>
<span class="next">Structure de base</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
<span class="next">Conditions TeX, conditions LaTeX</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="ConditionsTeXconditionsLaTeX"></a><h2>Conditions TeX, conditions LaTeX</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
<span class="arrow"></span>
<span class="next">L&#039;astuce babel</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/utilisation-de-votre-extension">
<span class="next">Utilisation de votre extension</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-585422" data-claire-element-id="585422">Nous allons, pour finir, aborder un point un peu plus technique, mais pas de quoi s'arracher les cheveux, rassurez-vous. Il s'agit simplement d'approfondir un point essentiel de la création d'extensions, que j'ai auparavant quelque peu estompé : les conditions.</p><h2 id="r-les-conditions-en-tex" data-claire-element-id="585442">Les conditions en TeX</h2><p id="r-585423" data-claire-element-id="585423">Le système TeX de base utilise le système de conditions suivant :</p><pre id="r-585424" data-claire-element-id="585424"><code data-claire-semantic="tex">\newif \if@ca \@ifcatrue
%
%
\if@ca
%commandes
\fi</code></pre><p id="r-585425" data-claire-element-id="585425">Explications<br/> On commence par créer une variable de type <em>if</em> avec la commande :</p><pre id="r-585426" data-claire-element-id="585426"><code data-claire-semantic="tex">\newif</code></pre><p id="r-585427" data-claire-element-id="585427">Cette variable possède pour nom :</p><pre id="r-585428" data-claire-element-id="585428"><code data-claire-semantic="tex">\if@ca</code></pre><p id="r-585429" data-claire-element-id="585429">Soit en français :</p><pre id="r-585430" data-claire-element-id="585430"><code>si &quot;ça&quot; est ...</code></pre><p id="r-585431" data-claire-element-id="585431">Ben oui, il faut encore assigner une valeur à notre variable :</p><pre id="r-585432" data-claire-element-id="585432"><code data-claire-semantic="tex">\@ifcatrue</code></pre><p id="r-585433" data-claire-element-id="585433">Dans notre cas, on assigne à notre variable la valeur <em>true</em>, soit <em>vrai</em>.</p><aside id="r-585435" data-claire-element-id="585435" data-claire-semantic="information"><p id="r-585434" data-claire-element-id="585434">Les programmeurs, tous langages confondus, reconnaîtront ici un booléen. La logique booléenne est à la base de tous les langages de programmation, mais également de la logique en général. C'est cette logique que l'on utilise lorsqu'on effectue des associations de conditions avec les opérateurs logiques AND (&quot;et&quot;), OR (&quot;ou&quot;), XOR (&quot;ou&quot; exclusif) et NOT (négation).<br/> Sa formalisation est appelée <a href="http://fr.wikipedia.org/wiki/Algèbre_de_Boole_(logique)">algèbre de Boole</a>.</p></aside><p id="r-585436" data-claire-element-id="585436">Enfin, le code devant s'exécuter lorsque la condition est vraie est dans le bloc :</p><pre id="r-585437" data-claire-element-id="585437"><code data-claire-semantic="tex">\if@ca
\fi</code></pre><h3 id="r-application-aux-extensions" data-claire-element-id="585441">Application aux extensions</h3><p id="r-585438" data-claire-element-id="585438">Il est possible d'utiliser ce système de conditions dans les extensions, notamment dans la gestion des options. <br/> Exemple :</p><pre id="r-585439" data-claire-element-id="585439"><code data-claire-semantic="tex">\newif \if@couleur \@couleurfalse
\DeclareOption{color}{\@couleurtrue}
%...
\if@couleur
\RequirePackage{xcolor}
\fi</code></pre><p id="r-585440" data-claire-element-id="585440">On charge l'extension <em>xcolor</em> si l'option <em>color</em> est envoyée à l'extension personnelle.</p><h2 id="r-les-conditions-en-latex" data-claire-element-id="585456">Les conditions en LaTeX</h2><p id="r-585443" data-claire-element-id="585443">Les conditions en LaTeX utilisent une syntaxe beaucoup plus familière.<br/> Pour commencer, il faut charger l'extension <em>ifthen</em> :</p><pre id="r-585444" data-claire-element-id="585444"><code data-claire-semantic="tex">\RequirePackage{ifthen}</code></pre><p id="r-585445" data-claire-element-id="585445">Ensuite, on applique le code suivant :</p><pre id="r-585446" data-claire-element-id="585446"><code data-claire-semantic="tex">\newboolean{couleur}
\setboolean{couleur}{false}
\DeclareOption{color}{\setboolean{couleur}{true}}
%...
\ifthenelse{\boolean{couleur}}{%
\RequirePackage{xcolor}}{}</code></pre><p id="r-585447" data-claire-element-id="585447">J'utilise ici le même exemple que précédemment : on charge l'extension <em>xcolor</em> si l'option <em>color</em> est envoyée à l'extension personnelle.<br/> En LaTeX, <em>surcouche</em> de TeX, l'utilisation de booléens est beaucoup plus évidente. En effet, le booléen est créé par la commande :</p><pre id="r-585448" data-claire-element-id="585448"><code data-claire-semantic="tex">\newboolean{&lt;nom&gt;}</code></pre><p id="r-585449" data-claire-element-id="585449">On lui affecte une valeur avec :</p><pre id="r-585450" data-claire-element-id="585450"><code data-claire-semantic="tex">\setboolean{&lt;nom&gt;}{&lt;valeur&gt;}</code></pre><p id="r-585451" data-claire-element-id="585451">Et pour finir, on teste sa valeur avec :</p><pre id="r-585452" data-claire-element-id="585452"><code data-claire-semantic="tex">\boolean{&lt;nom&gt;}</code></pre><p id="r-585453" data-claire-element-id="585453">Dans une grosse commande :</p><pre id="r-585454" data-claire-element-id="585454"><code data-claire-semantic="tex">\ifthenelse{&lt;condition&gt;}{&lt;code si vrai&gt;}{&lt;code si faux&gt;}</code></pre><p id="r-585455" data-claire-element-id="585455">On pourrait reprocher à la syntaxe LaTeX d'être très lourde (ceci est visible notamment dans la comparaison des deux codes donnant le même résultat présentés ci-dessus), mais il est bon de connaître les deux syntaxes. La syntaxe TeX est majoritairement utilisée dans les squelettes des extensions et des classes, la syntaxe LaTeX l'est beaucoup plus dans les environnements, notamment car elle permet d'y voir plus clair. Enfin, chacun choisit celle qu'il préfère.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package">Créez votre propre package</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
Structure de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
L&#039;astuce babel
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
Conditions TeX, conditions LaTeX
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/utilisation-de-votre-extension">
Utilisation de votre extension
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
<span class="arrow"></span>
<span class="next">L&#039;astuce babel</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/utilisation-de-votre-extension">
<span class="next">Utilisation de votre extension</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Utilisationdevotreextension"></a><h2>Utilisation de votre extension</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
<span class="arrow"></span>
<span class="next">Conditions TeX, conditions LaTeX</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-585458" data-claire-element-id="585458">C'est bien beau de coder une extension, encore faudrait-il pouvoir l'utiliser ! Pour cela, suivez le guide.</p><h3 id="r-enregistrement-8" data-claire-element-id="585465">Enregistrement</h3><p id="r-585459" data-claire-element-id="585459">En suivant une architecture TeX classique, on enregistre les extensions personnelles dans le répertoire suivant (ici sous Windows avec une distribution TeXlive 2007) :</p><pre id="r-585460" data-claire-element-id="585460"><code data-claire-semantic="console">C:\TeXLive2007\texmf\tex\latex\perso</code></pre><p id="r-585461" data-claire-element-id="585461">Pour les détenteurs d'autres distributions, je pense notamment à nos amis linuxiens, veillez à utiliser un répertoire similaire (le nom <em>perso</em> n'est pas obligatoire, vous pouvez choisir autre chose, mais sans espace de préférence). Vous trouverez quelques informations complémentaires pour l'utilisation sous Linux plus bas.</p><div id="r-585463" data-claire-element-id="585463" data-claire-semantic="question"><p id="r-585462" data-claire-element-id="585462">Et quelle extension dois-je mettre ?</p></div><p id="r-585464" data-claire-element-id="585464">J'allais l'oublier ! Effectivement, il ne faut pas enregistrer l'extension en <em>*.tex</em> qui est réservée aux sources de documents. L'extension étant un ensemble de paramètres stylistiques, on met l'extension <em>*.sty</em> (de l'anglais <em>style</em>).</p><h3 id="r-mise-a-jour-de-la-base-is-r" data-claire-element-id="585479">Mise à jour de la base Is-R</h3><p id="r-585466" data-claire-element-id="585466">Seconde et donc dernière étape, il s'agit de mettre à jour la base de données Is-R. Pour faire très simple, cette base de données regroupe tous les chemins d'accès aux extensions, aux classes et aux polices (entres autres) de votre distribution. Ainsi, si vous voulez que le compilateur connaisse votre extension, il faut qu'elle soit répertoriée dans Is-R.<br/> Voici comment procéder (sous TeXLive 2007) :</p><ul id="r-585477" data-claire-element-id="585477"><li id="r-585468" data-claire-element-id="585468"><p id="r-585467" data-claire-element-id="585467">ouvrez TeXlive Manager ;</p></li><li id="r-585470" data-claire-element-id="585470"><p id="r-585469" data-claire-element-id="585469">allez dans l'onglet &quot;Gestion de l'installation&quot; ;</p></li><li id="r-585472" data-claire-element-id="585472"><p id="r-585471" data-claire-element-id="585471">cliquez sur &quot;Mettre à jour&quot;, dans le champ &quot;Mettre à jour la base de donnée Is-R&quot; ;</p></li><li id="r-585474" data-claire-element-id="585474"><p id="r-585473" data-claire-element-id="585473">patientez...</p></li><li id="r-585476" data-claire-element-id="585476"><p id="r-585475" data-claire-element-id="585475">c'est fini, vous pouvez fermer TeXlive Manager.</p></li></ul><p id="r-585478" data-claire-element-id="585478">Pour les autres distributions, une démarche similaire est à effectuer.</p><h3 id="r-pour-les-utilisateurs-de-linux-1" data-claire-element-id="585486">Pour les utilisateurs de Linux</h3><p id="r-585480" data-claire-element-id="585480">La distribution LaTeX traditionnellement utilisée sous Linux est teTeX. Cependant, elle l'est de moins en moins et cède peu à peu la main à TeXLive du fait que cette dernière est bien plus maintenue (<a href="http://doc.ubuntu-fr.org/latex">source</a>). Je vous recommande donc, si vous ne disposez pas encore de distribution LaTeX sous Linux, d'installer le paquet texlive (utilisateurs d'Ubuntu, c'est par <a href="apt://texlive">ici</a>).</p><p id="r-585481" data-claire-element-id="585481">La distribution installée, vous devez enregistrer votre extension personnelle dans le répertoire suivant (le <em>perso</em> n'est à nouveau pas obligatoire) :</p><pre id="r-585482" data-claire-element-id="585482"><code data-claire-semantic="console">/usr/share/texmf-texlive/tex/latex/perso/</code></pre><p id="r-585483" data-claire-element-id="585483">Il s'agit ensuite, comme sous Windows, de mettre à jour la base de données Is-R. Pour cela, ouvrez votre émulateur de console favori et tapez :</p><pre id="r-585484" data-claire-element-id="585484"><code data-claire-semantic="console">sudo texhash</code></pre><p id="r-585485" data-claire-element-id="585485">Et voilà, votre extension personnelle est utilisable !</p><h3 id="r-utilisation-dans-un-document" data-claire-element-id="585494">Utilisation dans un document</h3><p id="r-585487" data-claire-element-id="585487">Votre extension personnelle s'utilise à présent de la même manière que toute autre extension. On la charge dans le préambule de la source, avec un :</p><pre id="r-585488" data-claire-element-id="585488"><code data-claire-semantic="tex">\usepackage[]{}</code></pre><p id="r-585489" data-claire-element-id="585489">Tout ce qu'il y a de plus normal.</p><aside id="r-585491" data-claire-element-id="585491" data-claire-semantic="error"><p id="r-585490" data-claire-element-id="585490">Un fichier <em>*.sty</em> ne se compile pas. Ce n'est pas grave si vous le faites : vous aurez simplement droit à une belle erreur ! Pour enregistrer les modifications de votre extension, enregistrez-le simplement.</p></aside><p id="r-585492" data-claire-element-id="585492">Ce tutoriel s'achève ici. J'espère avoir été suffisamment clair dans l'explication de toutes les étapes de la création d'une extension personnalisée, et bien sûr, que cela vous soit utile !<br/> Pour tous renseignements complémentaires, merci de vous tourner vers les commentaires.</p><p id="r-585493" data-claire-element-id="585493">sp.conductos</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package">Créez votre propre package</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/structure-de-base-2">
Structure de base
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/l-astuce-babel">
L&#039;astuce babel
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
Conditions TeX, conditions LaTeX
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/utilisation-de-votre-extension">
Utilisation de votre extension
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/creez-votre-propre-package/conditions-tex-conditions-latex">
<span class="arrow"></span>
<span class="next">Conditions TeX, conditions LaTeX</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/creez-votre-propre-package.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:21:19 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/creez-votre-propre-package.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:21:40 GMT -->
</html>