<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/maitrisez-mysqli-sans-poo.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:48:02 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/maitrisez-mysqli-sans-poo.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:28:35 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Maîtrisez MySQLi sans POO !</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/maitrisez-mysqli-sans-poo.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Maîtrisez MySQLi sans POO !</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#MatrisezMySQLisansPOO">Maîtrisez MySQLi sans POO !</a><br/><a href="#Seconnecterlabasededonnes">Se connecter à la base de données</a><br/><a href="#Lesrequtessimples">Les requêtes simples</a><br/><a href="#Lesrequtesprpares">Les requêtes préparées</a><br/><a href="#Quelquesfonctionssupplmentaires...">Quelques fonctions supplémentaires...</a><br/></div>
<a name="MatrisezMySQLisansPOO"></a><h2>Maîtrisez MySQLi sans POO !</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
<span class="next">Se connecter à la base de données</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-528870" data-claire-element-id="528870">Dans ce tutoriel, qui est mon premier, nous allons apprendre à utiliser une extension de PHP, qui est MySQLi.</p><div id="r-528872" data-claire-element-id="528872" data-claire-semantic="question"><p id="r-528871" data-claire-element-id="528871">D'accord, mais c'est quoi, MySQLi ?</p></div><p id="r-528873" data-claire-element-id="528873">MySQLi permet de communiquer avec une base de données MySQL.</p><div id="r-528875" data-claire-element-id="528875" data-claire-semantic="question"><p id="r-528874" data-claire-element-id="528874">Mais pourquoi utiliser MySQLi ?</p></div><p id="r-528876" data-claire-element-id="528876">Je dirais que c'est juste une histoire de goûts. <br/> On peut utiliser MySQLi sans passer par la programmation orientée objet, ce qui peut être un avantage pour ceux qui ne connaissent rien à la POO en PHP (comme moi ;) ). <br/> Peut-être que par la suite, certains trouveront que MySQLi est plus simple à utiliser que la technique enseignée par M@teo21 dans son <a href="http://www.siteduzero.com/tutoriel-3-14668-concevez-votre-site-web-avec-php-et-mysql.html#part_14671">tutoriel PHP</a>.</p><aside id="r-528878" data-claire-element-id="528878" data-claire-semantic="warning"><p id="r-528877" data-claire-element-id="528877">Pour suivre ce tutoriel, vous devez avoir lu <a href="http://www.siteduzero.com/tutoriel-3-14668-concevez-votre-site-web-avec-php-et-mysql.html">le tutoriel PHP officiel du site</a>, même la partie avec MySQL.</p></aside><p id="r-528879" data-claire-element-id="528879">Nous allons donc apprendre à nous servir de MySQLi. <br/> Ah ! Au passage, vous remarquerez que toute les fonctions de MySQLi commencent par… <strong>mysqli_</strong> !</p>
</div><a name="Seconnecterlabasededonnes"></a><h2>Se connecter à la base de données</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
<span class="next">Les requêtes simples</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-528880" data-claire-element-id="528880">Pour se connecter à MySQL, on va utiliser cette fonction :</p><pre id="r-528881" data-claire-element-id="528881"><code data-claire-semantic="html+php">&lt;?php
$bdd = mysqli_connect('serveur', 'utilisateur', 'mot_de_passe', 'base');
?&gt;</code></pre><ul id="r-528892" data-claire-element-id="528892"><li id="r-528883" data-claire-element-id="528883"><p id="r-528882" data-claire-element-id="528882"><strong>$bdd</strong> correspond à une variable où seront stockées les informations de la base de données. On s'en servira souvent.</p></li><li id="r-528885" data-claire-element-id="528885"><p id="r-528884" data-claire-element-id="528884"><strong>serveur</strong> correspond au serveur SQL.</p></li><li id="r-528887" data-claire-element-id="528887"><p id="r-528886" data-claire-element-id="528886"><strong>utilisateur</strong> correspond au nom d'utilisateur pour se connecter au serveur SQL.</p></li><li id="r-528889" data-claire-element-id="528889"><p id="r-528888" data-claire-element-id="528888"><strong>mot_de_passe</strong> correspond au mot de passe pour le serveur SQL !</p></li><li id="r-528891" data-claire-element-id="528891"><p id="r-528890" data-claire-element-id="528890"><strong>base</strong> correspond à votre base de données du serveur SQL.</p></li></ul><p id="r-528893" data-claire-element-id="528893">On peut tester si la connexion a réussi ou non :</p><pre id="r-528894" data-claire-element-id="528894"><code data-claire-semantic="html+php">&lt;?php
if($bdd = mysqli_connect('localhost', 'root', '', 'base'))
{
	// Si la connexion a réussi, rien ne se passe.
}
else // Mais si elle rate…
{
	echo 'Erreur'; // On affiche un message d'erreur.
}
?&gt;</code></pre><p id="r-528895" data-claire-element-id="528895">Dans cet exemple, MySQLi se connecte au serveur local.</p><aside id="r-528897" data-claire-element-id="528897" data-claire-semantic="warning"><p id="r-528896" data-claire-element-id="528896">Je vous conseille de mettre ce code dans un fichier <em>connexion_sql.php</em>, que vous insérerez ensuite dans chaque fichier qui travaille avec SQL.<br/> D'ailleurs, j'espère que vous faisiez déjà comme ça !</p></aside><p id="r-528898" data-claire-element-id="528898">Une fois que la connexion est établie, nous pouvons passer à nos premières requêtes...</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo">Maîtrisez MySQLi sans POO !</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
Se connecter à la base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
Les requêtes simples
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
Les requêtes préparées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/quelques-fonctions-supplementaires-1">
Quelques fonctions supplémentaires...
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
<span class="next">Les requêtes simples</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesrequtessimples"></a><h2>Les requêtes simples</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
<span class="arrow"></span>
<span class="next">Se connecter à la base de données</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
<span class="next">Les requêtes préparées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-528900" data-claire-element-id="528900">Nous allons apprendre à gérer les requêtes simples.</p><div id="r-528902" data-claire-element-id="528902" data-claire-semantic="question"><p id="r-528901" data-claire-element-id="528901">Qu'appelles-tu <em>requêtes simples</em> ?</p></div><p id="r-528903" data-claire-element-id="528903">Ce sont les requêtes qui ne sont pas préparées, car ces dernières sont un peu plus complexes.</p><h2 id="r-le-code-de-la-requete" data-claire-element-id="528919">Le code de la requête</h2><p id="r-528904" data-claire-element-id="528904">Le code de la requête est le suivant :</p><pre id="r-528905" data-claire-element-id="528905"><code data-claire-semantic="html+php">&lt;?php
$resultat = mysqli_query($bdd, 'requete');
?&gt;</code></pre><ul id="r-528912" data-claire-element-id="528912"><li id="r-528907" data-claire-element-id="528907"><p id="r-528906" data-claire-element-id="528906"><strong>$resultat</strong> est la variable où seront stockées les données.</p></li><li id="r-528909" data-claire-element-id="528909"><p id="r-528908" data-claire-element-id="528908"><strong>$bdd</strong> est la variable retournée par la fonction de connexion à la base de données, voir plus haut.</p></li><li id="r-528911" data-claire-element-id="528911"><p id="r-528910" data-claire-element-id="528910"><strong>'requete'</strong> est une requête SQL.</p></li></ul><p id="r-528913" data-claire-element-id="528913">Exemple :</p><pre id="r-528914" data-claire-element-id="528914"><code data-claire-semantic="html+php">&lt;?php
$resultat = mysqli_query($bdd, 'SELECT * FROM membres LIMIT 0, 10');
?&gt;</code></pre><p id="r-528915" data-claire-element-id="528915">Voilà, <strong>requete</strong> était une simple requête SQL !</p><div id="r-528917" data-claire-element-id="528917" data-claire-semantic="question"><p id="r-528916" data-claire-element-id="528916">Mais maintenant, comment afficher ces résultats ?</p></div><p id="r-528918" data-claire-element-id="528918">C'est ce que nous allons voir…</p><h2 id="r-afficher-le-resultat-d-une-requete-simple" data-claire-element-id="528928">Afficher le résultat d'une requête simple</h2><p id="r-528920" data-claire-element-id="528920">Pour afficher le résultat de ce type de requêtes, il suffit de <em>fetcher</em> dans une boucle <em>while</em>.</p><pre id="r-528921" data-claire-element-id="528921"><code data-claire-semantic="html+php">&lt;?php
while($donnees = mysqli_fetch_assoc($resultat))
{
	echo $donnees['id'];
	echo &quot;\n&quot;;
	echo $donnees['pseudo'];
}
?&gt;</code></pre><p id="r-528922" data-claire-element-id="528922">Que se passe-t-il ? En réalité, c'est relativement simple : <em>$donnees</em> est transformé en un tableau avec les noms des colonnes demandées dans la requête. Cette transformation est réalisée grâce à la fonction <em>mysqli_fetch_assoc($resultat)</em>, <em> $resultat</em> étant le résultat brut de la requête. Cette fonction sert aussi et surtout à passer au résultat suivant, d'où l'utilisation de la boucle <em>while</em>.</p><p id="r-528923" data-claire-element-id="528923">Oups ! J'ai oublié quelque chose ! :-°</p><pre id="r-528924" data-claire-element-id="528924"><code data-claire-semantic="html+php">&lt;?php
while($donnees = mysqli_fetch_assoc($resultat))
{
	echo $donnees['id'];
	echo &quot;\n&quot;;
	echo $donnees['pseudo'];
}
mysqli_free_result($resultat);
?&gt;</code></pre><p id="r-528925" data-claire-element-id="528925">C'est mieux comme ça ! :lol: <br/> Eh oui, il ne faut pas oublier de fermer le curseur avec la fonction suivante :</p><pre id="r-528926" data-claire-element-id="528926"><code data-claire-semantic="html+php">&lt;?php
mysqli_free_result($resultat);
?&gt;</code></pre><p id="r-528927" data-claire-element-id="528927">Fermer le curseur permet de libérer les données récupérées lors d'une requête SQL.</p><h2 id="r-resume-26" data-claire-element-id="528930">Résumé</h2><pre id="r-528929" data-claire-element-id="528929"><code data-claire-semantic="html+php">&lt;?php
// include du fichier de connexion à SQL.

$resultat = mysqli_query($bdd, 'SELECT * FROM membres LIMIT 0, 10');
while($donnees = mysqli_fetch_assoc($resultat))
{
	echo $donnees['id'];
	echo &quot;\n&quot;;
	echo $donnees['pseudo'];
}
mysqli_free_result($resultat);
?&gt;</code></pre>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo">Maîtrisez MySQLi sans POO !</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
Se connecter à la base de données
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
Les requêtes simples
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
Les requêtes préparées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/quelques-fonctions-supplementaires-1">
Quelques fonctions supplémentaires...
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
<span class="arrow"></span>
<span class="next">Se connecter à la base de données</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
<span class="next">Les requêtes préparées</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Lesrequtesprpares"></a><h2>Les requêtes préparées</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
<span class="arrow"></span>
<span class="next">Les requêtes simples</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/quelques-fonctions-supplementaires-1">
<span class="next">Quelques fonctions supplémentaires...</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-528932" data-claire-element-id="528932">Pour travailler avec les requêtes préparées, il y a un certain ordre à suivre :</p><ol id="r-528943" data-claire-element-id="528943"><li id="r-528934" data-claire-element-id="528934"><p id="r-528933" data-claire-element-id="528933">préparer la requête ;</p></li><li id="r-528936" data-claire-element-id="528936"><p id="r-528935" data-claire-element-id="528935">lier les variables à la requête ;</p></li><li id="r-528938" data-claire-element-id="528938"><p id="r-528937" data-claire-element-id="528937">exécuter la requête ;</p></li><li id="r-528940" data-claire-element-id="528940"><p id="r-528939" data-claire-element-id="528939">si la requête renvoie un résultat, on continue : lier le résultat à des variables ;</p></li><li id="r-528942" data-claire-element-id="528942"><p id="r-528941" data-claire-element-id="528941"><em>fetcher</em> le résultat.</p></li></ol><p id="r-528944" data-claire-element-id="528944">Quasiment toutes les fonctions concernant les requêtes préparées commenceront par <em>mysqli_stmt_</em>.</p><h2 id="r-preparer-la-requete" data-claire-element-id="528948">Préparer la requête</h2><p id="r-528945" data-claire-element-id="528945">On prépare la requête avec cette fonction :</p><pre id="r-528946" data-claire-element-id="528946"><code data-claire-semantic="html+php">&lt;?php
$req_pre = mysqli_prepare($bdd, 'SELECT * FROM membres WHERE id = ?');
?&gt;</code></pre><p id="r-528947" data-claire-element-id="528947"><em>$req_pre</em> est une variable qui contient la requête préparée. À part ça, vous n'avez pas vraiment besoin d'explications. :lol:</p><h2 id="r-lier-les-variables-a-la-requete-preparee" data-claire-element-id="528978">Lier les variables à la requête préparée</h2><p id="r-528949" data-claire-element-id="528949">On les lie avec cette fonction un peu plus complexe :</p><pre id="r-528950" data-claire-element-id="528950"><code data-claire-semantic="html+php">&lt;?php
mysqli_stmt_bind_param($req_pre, &quot;i&quot;, $id);
?&gt;</code></pre><p id="r-528951" data-claire-element-id="528951">Cette fonction est en effet un peu particulière.<br/><em>$req_pre</em> est la variable de la requête préparée. <em>i</em> est le type de la variable qui suit. La variable coorespond à ce qui va remplacer le point d'interrogation dans la requête.<br/> Concernant les types de variables possibles, voici un petit tableau :</p><table id="r-528974" data-claire-element-id="528974"><thead id="r-528957" data-claire-element-id="528957"><tr id="r-528956" data-claire-element-id="528956"><th id="r-528953" data-claire-element-id="528953"><p id="r-528952" data-claire-element-id="528952">Lettre</p></th><th id="r-528955" data-claire-element-id="528955"><p id="r-528954" data-claire-element-id="528954">Correspond à</p></th></tr></thead><tbody id="r-528973" data-claire-element-id="528973"><tr id="r-528962" data-claire-element-id="528962"><td id="r-528959" data-claire-element-id="528959"><p id="r-528958" data-claire-element-id="528958"><em>i</em></p></td><td id="r-528961" data-claire-element-id="528961"><p id="r-528960" data-claire-element-id="528960">un nombre entier</p></td></tr><tr id="r-528967" data-claire-element-id="528967"><td id="r-528964" data-claire-element-id="528964"><p id="r-528963" data-claire-element-id="528963"><em>d</em></p></td><td id="r-528966" data-claire-element-id="528966"><p id="r-528965" data-claire-element-id="528965">un nombre décimal</p></td></tr><tr id="r-528972" data-claire-element-id="528972"><td id="r-528969" data-claire-element-id="528969"><p id="r-528968" data-claire-element-id="528968"><em>s</em></p></td><td id="r-528971" data-claire-element-id="528971"><p id="r-528970" data-claire-element-id="528970">une chaîne de caractères</p></td></tr></tbody></table><p id="r-528975" data-claire-element-id="528975">Ces lettres doivent être placées selon l’ordre dans lequel apparaissent les variables après, tel que les variables doivent apparaître dans l'ordre des points d'interrogation dans la requête. Les lettres doivent être dans le même paramètre.<br/> Un exemple vaut mieux qu'un long discours :</p><pre id="r-528976" data-claire-element-id="528976"><code data-claire-semantic="html+php">&lt;?php
$req_pre = mysqli_prepare($bdd, 'INSERT INTO membres (pseudo, age, poids) VALUES ( ?, ?, ?)');
mysqli_stmt_bind_param($req_pre, &quot;sid&quot;, $pseudo, $age, $poids);
?&gt;</code></pre><p id="r-528977" data-claire-element-id="528977">Disons que <em>$pseudo</em> vaut <em>quelquun</em>, que <em>$age</em> vaut <em>23</em> et que <em>$poid</em> vaut <em>52,357</em> (par exemple, hein :lol: ).</p><h2 id="r-executer-la-requete-1" data-claire-element-id="528983">Exécuter la requête</h2><p id="r-528979" data-claire-element-id="528979">Rien de bien sorcier :</p><pre id="r-528980" data-claire-element-id="528980"><code data-claire-semantic="html+php">&lt;?php
mysqli_stmt_execute($req_pre); 
?&gt;</code></pre><p id="r-528981" data-claire-element-id="528981">(Sans commentaires.)</p><p id="r-528982" data-claire-element-id="528982">Si la requête ne renvoie pas de résultat (les requêtes d'insertion, de mise à jour, de suppression), on s'arrête là. Sinon, il faut lier le résultat de l'exécution à des variables.</p><h2 id="r-lier-le-resultat-a-des-variables" data-claire-element-id="528987">Lier le résultat à des variables</h2><p id="r-528984" data-claire-element-id="528984">Personnellement, je lie le résultat d'une requête préparée à un tableau dont chacun aura le nom de la colonne du résultat. Vous allez vite comprendre :</p><pre id="r-528985" data-claire-element-id="528985"><code data-claire-semantic="html+php">&lt;?php
mysqli_stmt_bind_result($req_pre, $donnees['pseudo'], $donnees['age'], $donnees['email']);
?&gt;</code></pre><p id="r-528986" data-claire-element-id="528986">Voilà, si vous choisissez de tout sélectionner dans la requête, vous aurez une variable par colonne de la base. Si vous avez sélectionné les colonnes que vous souhaitez obtenir dans la requête, il faudra une variable par colonne demandée.</p><h2 id="r-fetcher-le-resultat" data-claire-element-id="528993">Fetcher le résultat</h2><p id="r-528988" data-claire-element-id="528988">Si vous savez qu'il n'y aura qu'un résultat, il faut <em>fetcher</em> de cette façon :</p><pre id="r-528989" data-claire-element-id="528989"><code data-claire-semantic="html+php">&lt;?php
mysqli_stmt_fetch($req_pre);
?&gt;</code></pre><p id="r-528990" data-claire-element-id="528990">Et seulement ensuite vous pourrez utiliser le tableau <em>$donnees</em>.</p><p id="r-528991" data-claire-element-id="528991">S'il y aura plusieurs résultats, il faut faire une boucle :</p><pre id="r-528992" data-claire-element-id="528992"><code data-claire-semantic="html+php">&lt;?php
while(mysqli_stmt_fetch($req_pre))
{
      echo $donnees['pseudo'] . &quot;, &quot; . $donnees['age'] . &quot; ans,&quot; . $donnees['email'];
}
?&gt;</code></pre><h2 id="r-exemples-29" data-claire-element-id="529000">Exemples</h2><h3 id="r-avec-une-requete-qui-ne-renvoie-pas-de-resultat" data-claire-element-id="528995">Avec une requête qui ne renvoie pas de résultat</h3><pre id="r-528994" data-claire-element-id="528994"><code data-claire-semantic="html+php">&lt;?php
// include de la connexion SQL.

$req_pre = mysqli_prepare($bdd, 'INSERT INTO membres (pseudo, age, email) VALUES (?, ?, ?)');
mysqli_stmt_bind_param($req_pre, &quot;sis&quot;, $pseudo, $age, $email);
mysqli_stmt_execute($req_pre);
?&gt;</code></pre><h3 id="r-avec-une-requete-qui-renvoie-des-resultats" data-claire-element-id="528999">Avec une requête qui renvoie des résultats</h3><pre id="r-528996" data-claire-element-id="528996"><code data-claire-semantic="html+php">&lt;?php
// include de la connexion SQL.

$req_pre = mysqli_prepare($bdd, 'SELECT * FROM membres WHERE age = ? LIMIT 0, ?');
mysqli_stmt_bind_param($req_pre, &quot;ii&quot;, $age, $nombre_resultat);
mysqli_stmt_execute($req_pre);
mysqli_stmt_bind_result($req_pre, $donnees['pseudo'], $donnees['age'], $donnees['email']);
while(mysqli_stmt_fetch($req_pre))
{
	echo $donnees['pseudo'] . &quot;, &quot; . $donnees['age'] . &quot; ans, &quot; . $donnees['email'];
}
?&gt;</code></pre><aside id="r-528998" data-claire-element-id="528998" data-claire-semantic="warning"><p id="r-528997" data-claire-element-id="528997">Dans l'exemple ci-dessus, <em>pseudo</em>, <em>age</em> et <em>email</em> sont les seules colonnes de ma table.<br/> Si j'avais demandé dans la requête SQL seulement <em>pseudo</em> et <em>email</em> j'aurais lié le résultat seulement à <em>$donnees['pseudo']</em> et <em>$donnees['email']</em>, dans l'ordre que je les ai indiqués dans la requête.</p></aside>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo">Maîtrisez MySQLi sans POO !</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
Se connecter à la base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
Les requêtes simples
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
Les requêtes préparées
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/quelques-fonctions-supplementaires-1">
Quelques fonctions supplémentaires...
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
<span class="arrow"></span>
<span class="next">Les requêtes simples</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/quelques-fonctions-supplementaires-1">
<span class="next">Quelques fonctions supplémentaires...</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Quelquesfonctionssupplmentaires..."></a><h2>Quelques fonctions supplémentaires...</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
<span class="arrow"></span>
<span class="next">Les requêtes préparées</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-529002" data-claire-element-id="529002">Même si vous les trouverez toutes dans <a href="http://www.php.net/manual/fr/mysqli.summary.php">la doc' de MySQLi</a>, je vais vous montrer quelques fonctions, que je pense vous aurez besoin de temps en temps.</p><h2 id="r-connaitre-le-nombre-d-entrees-retournees" data-claire-element-id="529022">Connaître le nombre d'entrées retournées</h2><p id="r-529003" data-claire-element-id="529003">Connaître le nombre d'entrées dans une table peut parfois être utile: donner le nombre de commentaires dans un blog, le nombres de réponse dans un forum... Nous allons voir ça en détail avec des requêtes simples et préparées.</p><h3 id="r-avec-une-requete-simple" data-claire-element-id="529009">Avec une requête simple</h3><p id="r-529004" data-claire-element-id="529004">Vous devez utiliser la fonction suivante:</p><pre id="r-529005" data-claire-element-id="529005"><code data-claire-semantic="html+php">&lt;?php
mysqli_num_rows($requete);
?&gt;</code></pre><p id="r-529006" data-claire-element-id="529006">La fonction vous retournera le nombre d'entrées dans la table qu'elle a obtenu selon la requête SQL.</p><p id="r-529007" data-claire-element-id="529007">Exemple:</p><pre id="r-529008" data-claire-element-id="529008"><code data-claire-semantic="html+php">&lt;?php
// include de la connexion à la BDD.
$req = mysqli_query($bdd, 'SELECT * FROM commentaires');
$nb = mysqli_num_rows($req);

echo 'Il y a ' . $nb . ' commentaire(s).';
?&gt;</code></pre><h3 id="r-avec-des-requetes-preparees" data-claire-element-id="529021">Avec des requêtes préparées</h3><p id="r-529010" data-claire-element-id="529010">Là, c'est un peu plus compliqué. En réalité, vous devez d'abord stocker (je n'sais trop où...) le résultat de la requête préparée et seulement ensuite demander le nombre d'entrées retournées par la requête.<br/> Après avoir exécuté la requête préparée, utilisez cette fonction qui stocke les informations:</p><pre id="r-529011" data-claire-element-id="529011"><code data-claire-semantic="html+php">&lt;?php
mysqli_stmt_store_result($stmt);
?&gt;</code></pre><p id="r-529012" data-claire-element-id="529012">Ensuite, vous pouvez gentiment demander combien d'entrées ont été retournées par la requête:</p><pre id="r-529013" data-claire-element-id="529013"><code data-claire-semantic="html+php">&lt;?php
$nb = mysqli_stmt_num_rows($stmt);</code></pre><p id="r-529014" data-claire-element-id="529014">Un petit exemple qui retourne les commentaires d'un article (tiré de mon site) et ensuite le nombre de commentaires:</p><pre id="r-529015" data-claire-element-id="529015"><code data-claire-semantic="html+php">&lt;?php
// include de la connexion à la BDD.
$stmt = mysqli_prepare($bdd, 'SELECT contenu, auteur, date_post FROM commentaires WHERE id_article = ? AND ok = 1 ORDER BY date_post');
mysqli_stmt_bind_param($stmt, &quot;i&quot;, $_GET['id']);
mysqli_stmt_execute($stmt);
mysqli_stmt_store_result($stmt);
$nb = mysqli_stmt_num_rows($stmt);
?&gt;</code></pre><p id="r-529016" data-claire-element-id="529016">(Vous vous doutez bien qu'ensuite j'affiche ce nombre, et les commentaires à la suite ! :p )</p><aside id="r-529018" data-claire-element-id="529018" data-claire-semantic="information"><p id="r-529017" data-claire-element-id="529017">Si vous rencontrez un jour un problème que vous n'arrivez pas à résoudre, ajoutez le fichier de la connexion à MySQL juste avant la requête. C'est parfois une solution.<br/> Pensez-y. ;)</p></aside><p id="r-529019" data-claire-element-id="529019">Non, non, ne vous inquiétez pas, je vais vous la donner, l'adresse de la <strong>DOC</strong> ! Attention, la voici, la voilà :<br/><a href="http://www.php.net/manual/fr/mysqli.summary.php">http://www.php.net/manual/fr/mysqli.summary.php</a></p><p id="r-529020" data-claire-element-id="529020">Voilà, le tutoriel touche à sa fin. N'hésitez pas à laisser des commentaires ! :) <br/> Si vous avez un souci, si vous souhaitez proposer une amélioration ou autre, n'hésitez pas à me contacter par MP !</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo">Maîtrisez MySQLi sans POO !</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/se-connecter-a-la-base-de-donnees-1">
Se connecter à la base de données
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-simples">
Les requêtes simples
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
Les requêtes préparées
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/quelques-fonctions-supplementaires-1">
Quelques fonctions supplémentaires...
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/maitrisez-mysqli-sans-poo/les-requetes-preparees-4">
<span class="arrow"></span>
<span class="next">Les requêtes préparées</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/maitrisez-mysqli-sans-poo.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 01:48:02 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/maitrisez-mysqli-sans-poo.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:28:36 GMT -->
</html>