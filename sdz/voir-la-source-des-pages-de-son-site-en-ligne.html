<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/voir-la-source-des-pages-de-son-site-en-ligne.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 04:33:12 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/voir-la-source-des-pages-de-son-site-en-ligne.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:54:38 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Voir la source des pages de son site en ligne</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Voir la source des pages de son site en ligne</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Voirlasourcedespagesdesonsiteenligne">Voir la source des pages de son site en ligne</a><br/><a href="#Listagedesdossiers">Listage des dossiers</a><br/><a href="#Listagedessous-dossiers">Listage des sous-dossiers</a><br/><a href="#Affichagedesfichiers">Affichage des fichiers</a><br/></div>
<a name="Voirlasourcedespagesdesonsiteenligne"></a><h2>Voir la source des pages de son site en ligne</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-dossiers">
<span class="next">Listage des dossiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-587286" data-claire-element-id="587286">Vous apprendrez dans ce tutoriel à voir la source de tous vos fichiers (quels que soient les formats).<br/> Cela peut être utile quand l'on travaille en équipe par exemple, à plusieurs sur un même fichier.</p><aside id="r-587288" data-claire-element-id="587288" data-claire-semantic="warning"><p id="r-587287" data-claire-element-id="587287">Prenez garde ! Ce script ne doit pas être accessible au public sur votre site !</p></aside>
</div><a name="Listagedesdossiers"></a><h2>Listage des dossiers</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
<span class="next">Listage des sous-dossiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-587289" data-claire-element-id="587289">Pour commencer, nous allons afficher le contenu du dossier courant.<br/> Quand vous cliquerez sur un dossier, son contenu s'affichera.</p><p id="r-587290" data-claire-element-id="587290">Côté PHP, ça donnera ceci :</p><pre id="r-587291" data-claire-element-id="587291"><code data-claire-semantic="html+php">&lt;?php
$handle = opendir(getcwd());
// On initialise les variables.
$fichiers = '';
$dossiers = '';
while (false !== ($file = readdir($handle))) {
  if(substr(strrchr($file, '.') ,1)) { // C'est un fichier car il a une extension.
        $extension = substr(strrchr($file, '.') ,1);
        $fichiers .=  &quot;&lt;li&gt;&lt;a href='voirfichier.php?f=&quot;.$file.&quot;&amp;amp;langage=&quot;.$extension.&quot;'&gt;&quot;.$file.&quot;&lt;/a&gt;&lt;/li&gt;&quot;;
  } else { // C'est un dossier.
        $dossiers .= '&lt;li id=&quot;'.$file.'&quot;&gt;&lt;img src=&quot;folder.png&quot;&gt; &lt;a href=&quot;#'.$file.'&quot; onClick=&quot;javascript:voirDossier(\''.$file.'\');&quot;&gt;'.$file.'&lt;/a&gt;&lt;/li&gt;';
   }
}
echo $dossiers;
echo $fichiers;
closedir($handle); 
?&gt;</code></pre><p id="r-587292" data-claire-element-id="587292">Voici une explication détaillée du code :</p><pre id="r-587293" data-claire-element-id="587293"><code data-claire-semantic="html+php">&lt;?php
$handle = opendir(getcwd());</code></pre><p id="r-587294" data-claire-element-id="587294">Ici, on ouvre un répertoire grâce à la fonction opendir(). La fonction getcwd() retourne le répertoire courant. Vous pouvez donc changer le répertoire en mettant : opendir(&quot;votre_repertoire&quot;);</p><pre id="r-587295" data-claire-element-id="587295"><code data-claire-semantic="html+php">&lt;?php
while (false !== ($file = readdir($handle))) {</code></pre><p id="r-587296" data-claire-element-id="587296">On lit le contenu du dossier aussi longtemps qu'il reste des fichiers/dossiers à lister.</p><pre id="r-587297" data-claire-element-id="587297"><code data-claire-semantic="html+php">&lt;?php
$extension = substr(strrchr($file, '.') ,1);</code></pre><p id="r-587298" data-claire-element-id="587298">On récupère l'extension du fichier ($file).</p><p id="r-587299" data-claire-element-id="587299">Pour le reste, je pense que c'est facilement compréhensible. ^^</p><p id="r-587300" data-claire-element-id="587300">Voilà : maintenant, nous avons le contenu de notre dossier sous les yeux.<br/> Il nous faut à présent pouvoir afficher les sous-dossiers et ouvrir les fichiers.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne">Voir la source des pages de son site en ligne</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-dossiers">
Listage des dossiers
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
Listage des sous-dossiers
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/affichage-des-fichiers">
Affichage des fichiers
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
<span class="next">Listage des sous-dossiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Listagedessous-dossiers"></a><h2>Listage des sous-dossiers</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-dossiers">
<span class="arrow"></span>
<span class="next">Listage des dossiers</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/affichage-des-fichiers">
<span class="next">Affichage des fichiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-587302" data-claire-element-id="587302">Nous allons ici faire appel à AJAX.<br/> En effet, nous allons exécuter un script PHP, mais sans recharger la page.</p><p id="r-587303" data-claire-element-id="587303">Je vous présente le script JS :</p><pre id="r-587304" data-claire-element-id="587304"><code data-claire-semantic="javascript">function voirDossier(dossier) {
        if(dejaOuvert == 'non') { // Aucun sous-dossier n'est déjà ouvert.
                var id = dossier;
                var xhr;
                
                if (window.XMLHttpRequest) {
                        xhr = new XMLHttpRequest();
                } else if (window.ActiveXObject) {
                        xhr = new ActiveXObject('Microsoft.XMLHTTP');
                } else {
                        alert('JavaScript : votre navigateur ne supporte pas les objets XMLHttpRequest...');
                        return;
                }
                xhr.open('POST','voirdossier.php',true);
                xhr.onreadystatechange = function() {
                        if (xhr.readyState == 4) {
                                if (document.getElementById) document.getElementById(id).innerHTML += xhr.responseText;
                                }
                        }
                xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');
                var data = 'dossier='+escape(dossier);
                xhr.send(data);
                dejaOuvert = 'oui'; // On a ouvert un sous-dossier, la valeur de dejaOuvert est donc &quot;oui&quot;.
        } else {
                dejaOuvert = 'non'; // Vu qu'on ferme le dossier, on remet la valeur de dejaOuvert à &quot;non&quot;.
                var id = dossier;
                if (document.getElementById) document.getElementById(id).innerHTML =  '&lt;li id=&quot;'+id+'&quot;&gt;&lt;img src=&quot;./style/icons/folder.png&quot;&gt; &lt;a href=&quot;#'+id+'&quot; onClick=&quot;javascript:voirDossier(&quot;'+id+'&quot;);&quot;&gt;'+id+'&lt;/a&gt;&lt;/li&gt;';     
                dejaOuvert = 'non';
        }
}</code></pre><p id="r-587305" data-claire-element-id="587305">Pour comprendre ce code, suivez <a href="http://www.siteduzero.com/tuto-3-3804-1-les-objets-xmlhttprequest.html">ce tutoriel</a>.</p><p id="r-587306" data-claire-element-id="587306">Il ne reste maintenant plus qu'à faire le fichier PHP qui parsera les données. Le fichier sera nommé voirdossier.php.</p><p id="r-587307" data-claire-element-id="587307">Voici le code :</p><pre id="r-587308" data-claire-element-id="587308"><code data-claire-semantic="html+php">&lt;?php
header('Content-type: text/html; charset=iso-8859-1'); 
 
$dossier = $_POST['dossier'];
$handle = opendir('./'.$dossier);
$fichiers = '';
$dossiers = '';
echo '&lt;ul&gt;';
while (false !== ($file = readdir($handle))) {
        if(substr(strrchr($file, '.') ,1)) {
                $extension = substr(strrchr($file, '.') ,1);
                $fichiers .=  &quot;&lt;li&gt;&lt;a href='voirfichier.php?f=./&quot;.$dossier.&quot;/&quot;.$file.&quot;&amp;amp;langage=&quot;.$extension.&quot;'&gt;&quot;.$file.&quot;&lt;/a&gt;&lt;/li&gt;&quot;;
        } else {
                $dossiers .= '&lt;li id=&quot;'.$file.'&quot;&gt;&lt;img src=&quot;folder.png&quot;&gt; &lt;a href=&quot;#'.$file.'&quot; onClick=&quot;javascript:voirDossier(\''.$file.'\');&quot;&gt;'.$file.'&lt;/a&gt;&lt;/li&gt;';
        }
}
 
echo $dossiers;
echo $fichiers;
echo '&lt;/ul&gt;';
closedir($handle); 
 
?&gt;</code></pre><p id="r-587309" data-claire-element-id="587309">Il est à peu près similaire au premier, sauf qu'on parse les données reçues de JavaScript...</p><p id="r-587310" data-claire-element-id="587310">Maintenant, la partie pour l'affichage est terminée.<br/> Il ne reste plus qu'à afficher vos fichiers. ^^</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne">Voir la source des pages de son site en ligne</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-dossiers">
Listage des dossiers
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
Listage des sous-dossiers
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/affichage-des-fichiers">
Affichage des fichiers
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-dossiers">
<span class="arrow"></span>
<span class="next">Listage des dossiers</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/affichage-des-fichiers">
<span class="next">Affichage des fichiers</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Affichagedesfichiers"></a><h2>Affichage des fichiers</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
<span class="arrow"></span>
<span class="next">Listage des sous-dossiers</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-587312" data-claire-element-id="587312">Nous allons voir à présent comment afficher les fichiers en colorant selon le langage.<br/> Nous utiliserons dans cette partie « GeShi » qui est un <strong>colorant</strong> de script.<br/> Pour installer GeShi, suivez la <a href="http://62.4.17.167/tutoriel-3-38905-geshi-colorer-son-code.html">première partie de ce tutoriel</a>.</p><p id="r-587313" data-claire-element-id="587313">Une fois que vous l'aurez installé, nous pourrons passer au script de la page <strong>voirfichier.php</strong>.</p><p id="r-587314" data-claire-element-id="587314">On crée d'abord la fonction qui va afficher les couleurs de votre script en utilisant GeShi :</p><pre id="r-587315" data-claire-element-id="587315"><code data-claire-semantic="html+php">&lt;?php
function color($file,$langage) {
        include_once('./includes/geshi/geshi.php');
        $arrayExtension = array(&quot;js&quot; =&gt; &quot;javascript&quot;); // Ajouter tous les langages nécessaires.
        foreach($arrayExtension as $cle =&gt; $element) {
                $langage = str_replace($cle, $element, $langage);
        }
        $geshi = new GeSHi($file, $langage);
        return $geshi-&gt;parse_code();
}
?&gt;</code></pre><p id="r-587316" data-claire-element-id="587316">Maintenant que la fonction est déclarée, on va passer à la base du fichier.<br/> Voici le script :</p><pre id="r-587317" data-claire-element-id="587317"><code data-claire-semantic="html+php">&lt;?php
$fichier = $_GET['f'];
$langage = $_GET['langage'];
 
$handle = fopen($fichier, 'a+') ;
$fichierValue = '';
while($ligne=fgets($handle)) {
      $fichierValue .= $ligne;
}
echo color($fichierValue,$langage);
?&gt;</code></pre><p id="r-587318" data-claire-element-id="587318">Voilà, c'est fini... ^^</p><p id="r-587319" data-claire-element-id="587319">Vous avez donc maintenant trois fichiers :</p><ul id="r-587326" data-claire-element-id="587326"><li id="r-587321" data-claire-element-id="587321"><p id="r-587320" data-claire-element-id="587320">un qui affichera toute <strong>l'arborescence</strong> du site,</p></li><li id="r-587323" data-claire-element-id="587323"><p id="r-587322" data-claire-element-id="587322">un qui affichera <strong>les sous-dossiers,</strong></p></li><li id="r-587325" data-claire-element-id="587325"><p id="r-587324" data-claire-element-id="587324">un autre qui affichera <strong>la source</strong> des fichiers choisis.</p></li></ul><p id="r-587327" data-claire-element-id="587327">Pour des questions, des demandes d'améliorations : me contacter par <a href="http://www.siteduzero.com/mp-273-22402.html">MP</a>, merci.</p><p id="r-587328" data-claire-element-id="587328">Bon surf sur le Site du Zér0. ;)</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne">Voir la source des pages de son site en ligne</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-dossiers">
Listage des dossiers
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
Listage des sous-dossiers
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/affichage-des-fichiers">
Affichage des fichiers
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/voir-la-source-des-pages-de-son-site-en-ligne/listage-des-sous-dossiers">
<span class="arrow"></span>
<span class="next">Listage des sous-dossiers</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/voir-la-source-des-pages-de-son-site-en-ligne.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 04:33:12 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/voir-la-source-des-pages-de-son-site-en-ligne.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:54:38 GMT -->
</html>