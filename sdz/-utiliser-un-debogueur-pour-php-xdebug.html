<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/-utiliser-un-debogueur-pour-php-xdebug.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 00:30:07 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/-utiliser-un-debogueur-pour-php-xdebug.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:18:44 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : [PHP] Utiliser un débogueur pour PHP : Xdebug</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : [PHP] Utiliser un débogueur pour PHP : Xdebug</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#PHPUtiliserundbogueurpourPHPXdebug">[PHP] Utiliser un débogueur pour PHP : Xdebug</a><br/><a href="#Undbogueurl039outildel039efficacit">Un débogueur, l&#039;outil de l&#039;efficacité</a><br/><a href="#Sonutilisationbasique">Son utilisation basique</a><br/><a href="#Letraage">Le traçage</a><br/><a href="#Leprofiling">Le profiling</a><br/></div>
<a name="PHPUtiliserundbogueurpourPHPXdebug"></a><h2>[PHP] Utiliser un débogueur pour PHP : Xdebug</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
<span class="next">Un débogueur, l&#039;outil de l&#039;efficacité</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-392267" data-claire-element-id="392267">Les débogueurs (ou outils de débogage) sont assez méconnus du grand public ou mal utilisés.<br/> Xdebug en est un et son utilisation permet d'accélérer et de simplifier efficacement les cycles de déboguage d'une application PHP.<br/> Comment l'installer, le configurer et l'utiliser ? Qu'apporte-t-il ?<br/> Voilà ce que tentera d'expliquer ce tutoriel.</p><p id="r-392268" data-claire-element-id="392268"><strong>Historique du tutoriel :</strong></p><ul id="r-392277" data-claire-element-id="392277"><li id="r-392270" data-claire-element-id="392270"><p id="r-392269" data-claire-element-id="392269">19/12/2008 : Démarrage de la rédaction du tutoriel.</p></li><li id="r-392272" data-claire-element-id="392272"><p id="r-392271" data-claire-element-id="392271">07/02/2009 : Validation du tutoriel.</p></li><li id="r-392274" data-claire-element-id="392274"><p id="r-392273" data-claire-element-id="392273">08/05/2009 : Première mise à jour: ajout d'informations pour l'installation.</p></li><li id="r-392276" data-claire-element-id="392276"><p id="r-392275" data-claire-element-id="392275">À venir : Intégration dans un IDE.</p></li></ul>
</div><a name="Undbogueurl039outildel039efficacit"></a><h2>Un débogueur, l&#039;outil de l&#039;efficacité</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
<span class="next">Son utilisation basique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-presentation-rapide" data-claire-element-id="392288">Présentation rapide</h2><p id="r-392278" data-claire-element-id="392278">Xdebug est une extension initialement apparue pour PHP4 et dans sa version 2.0.x n'est compatible que pour PHP 4.4.x et supérieur. Elle est disponible sur PECL et est donc codée en C (contrairement aux extensions présentes sur le dépôt PEAR qui elles sont codées en PHP).</p><aside id="r-392280" data-claire-element-id="392280" data-claire-semantic="information"><p id="r-392279" data-claire-element-id="392279">Une extension écrite en C sera toujours plus rapide que si elle était écrite en PHP.</p></aside><p id="r-392281" data-claire-element-id="392281">Xdebug permet de déboguer facilement son script, mais génère aussi des fichiers de trace et surtout gère le <em>profiling</em>. Ces derniers interviennent dans la phase d'optimisation d'une application plutôt que dans le débogage pur (le <em>profiling</em> ne se fait que si le script fonctionne). Un bien joli programme pour un outil qui accélèrera vos développements ;) .</p><p id="r-392282" data-claire-element-id="392282">Cette extension personnalise les messages d'erreur en y ajoutant toute la pile des appels de fonctions et de classes. De plus elle permet d'y ajouter des informations sur la mémoire ou sur l'état des variables :p ...<br/> Exemple :</p><p id="r-392283" data-claire-element-id="392284"><a href="medias/uploads.siteduzero.com_files_149001_150000_149618.jpg"><img id="r-392284" data-claire-element-id="392283" src="medias/uploads.siteduzero.com_thb_149001_150000_149618.jpg" alt="Image utilisateur"/></a>Devient :</p><p id="r-392285" data-claire-element-id="392286"><a href="medias/uploads.siteduzero.com_files_149001_150000_149619.jpg"><img id="r-392286" data-claire-element-id="392285" src="medias/uploads.siteduzero.com_thb_149001_150000_149619.jpg" alt="Image utilisateur"/></a></p><p id="r-392287" data-claire-element-id="392287">Avant tout sachez que Xdebug n'est pas le seul outil de débogage pour PHP : il existe aussi <a href="http://www.php.net/apd">APD</a>, <a href="http://www.php-debugger.com/dbg/">DBG</a>...</p><h2 id="r-l-installation-1" data-claire-element-id="392317">L'installation</h2><h3 id="r-pour-les-systemes-unix" data-claire-element-id="392298">Pour les systèmes UNIX :</h3><p id="r-392289" data-claire-element-id="392289">Pour les systèmes UNIX il faut installer PEAR. Cette installation diffère selon les distributions, renseignez-vous sur le site de PEAR : <a href="http://pear.php.net/">http://pear.php.net/</a>.</p><p id="r-392290" data-claire-element-id="392290">Pour la plupart des distributions, faites :</p><pre id="r-392291" data-claire-element-id="392291"><code data-claire-semantic="console">sudo apt-get install php-pear</code></pre><p id="r-392292" data-claire-element-id="392292">Et <code data-claire-semantic="console">sudo apt-get install php5-dev</code>, si le paquet n'est pas déjà installé.</p><p id="r-392293" data-claire-element-id="392293">Puis lancez la commande suivante :</p><pre id="r-392294" data-claire-element-id="392294"><code data-claire-semantic="console">sudo pecl install xdebug</code></pre><p id="r-392295" data-claire-element-id="392295">Et laissez PECL faire le reste. ;)</p><aside id="r-392297" data-claire-element-id="392297" data-claire-semantic="information"><p id="r-392296" data-claire-element-id="392296">Si l'installation depuis PECL ne fonctionne pas il vous faudra compiler Xdebug manuellement. Reportez-vous à la <a href="http://www.xdebug.org/docs/install">documentation de Xdebug</a>.</p></aside><h3 id="r-pour-windows-3" data-claire-element-id="392300">Pour Windows :</h3><p id="r-392299" data-claire-element-id="392299">Pour Windows il faut récupérer la DLL ici : <a href="http://www.xdebug.org/download.php">http://www.xdebug.org/download.php</a>.<br/> Prenez la version de Xdebug correspondant à votre version de PHP et la plus récente possible de préférence.<br/> Puis mettez la DLL dans le répertoire d'extension de votre serveur (généralement appelé &quot;ext&quot;).</p><h3 id="r-le-demarrage" data-claire-element-id="392316">Le démarrage</h3><p id="r-392301" data-claire-element-id="392301">Pour faire démarrer Xdebug avec le serveur, ajoutez ceci à votre fichier <strong>php.ini</strong> :</p><pre id="r-392302" data-claire-element-id="392302"><code data-claire-semantic="ini">zend_extension=/chemin/vers/xdebug.so</code></pre><p id="r-392303" data-claire-element-id="392304">Le chemin correspond à celui des extensions, il est indiqué lors de l'installation par Pecl:<a href="medias/uploads.siteduzero.com_files_168001_169000_168848.jpg"><img id="r-392304" data-claire-element-id="392303" src="medias/uploads.siteduzero.com_thb_168001_169000_168848.jpg" alt="Image utilisateur"/></a></p><p id="r-392305" data-claire-element-id="392305">Vous pouvez aussi trouver le chemin en faisant <code data-claire-semantic="console">find -name 'xdebug.so'</code>.</p><p id="r-392306" data-claire-element-id="392306">Ou pour Windows :</p><pre id="r-392307" data-claire-element-id="392307"><code data-claire-semantic="ini">zend_extension_ts=/chemin/vers/xdebug.dll</code></pre><p id="r-392308" data-claire-element-id="392308">Puis <strong>redémarrez</strong> le serveur.</p><aside id="r-392310" data-claire-element-id="392310" data-claire-semantic="error"><p id="r-392309" data-claire-element-id="392309">Si vous avez une erreur avec <strong>zend_extension(_ts)</strong> utilisez seulement <strong>extension</strong> mais Xdebug n'est plus alors chargé en tant qu'extension Zend.</p></aside><p id="r-392311" data-claire-element-id="392311">C'est-à-dire qu'il n'est pas directement intégré dans le Zend Engine (moteur de PHP) et certaines fonctionnalités peuvent ne pas fonctionner.<br/> Par exemple sous Wamp faites comme ceci :</p><pre id="r-392312" data-claire-element-id="392312"><code data-claire-semantic="ini">zend_extension_ts=C:\wamp\bin\php\php5.2.8\ext\php_xdebug.dll</code></pre><p id="r-392313" data-claire-element-id="392313">Si vous faites un <code data-claire-semantic="html+php">phpinfo() </code> vous devriez voir ceci (notez que Xdebug s'active par défaut) :</p><p id="r-392314" data-claire-element-id="392315"><a href="medias/uploads.siteduzero.com_files_149001_150000_149624.jpg"><img id="r-392315" data-claire-element-id="392314" src="medias/uploads.siteduzero.com_thb_149001_150000_149624.jpg" alt="Image utilisateur"/></a></p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug">[PHP] Utiliser un débogueur pour PHP : Xdebug</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
Un débogueur, l&#039;outil de l&#039;efficacité
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
Son utilisation basique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
Le traçage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-profiling-1">
Le profiling
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
<span class="next">Son utilisation basique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Sonutilisationbasique"></a><h2>Son utilisation basique</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
<span class="arrow"></span>
<span class="next">Un débogueur, l&#039;outil de l&#039;efficacité</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
<span class="next">Le traçage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-encore-et-toujours-de-la-configuration" data-claire-element-id="392340">Encore et toujours de la configuration</h2><h3 id="r-quelques-parametres-de-configuration" data-claire-element-id="392339">Quelques paramètres de configuration</h3><p id="r-392319" data-claire-element-id="392319">Vous pouvez configurer Xdebug depuis le <strong>php.ini</strong> ou depuis votre script (personnellement je préfère la première solution ;) ).<br/> Ajoutez-y par exemple ceci :</p><pre id="r-392320" data-claire-element-id="392320"><code data-claire-semantic="ini">[Xdebug]
;xdebug.default_enable=Off
xdebug.show_local_vars=1</code></pre><aside id="r-392322" data-claire-element-id="392322" data-claire-semantic="information"><p id="r-392321" data-claire-element-id="392321">N'oubliez pas de redémarrer le serveur après chaque modification du <strong>php.ini</strong>.</p></aside><p id="r-392323" data-claire-element-id="392323">Par défaut, Xdebug est activé automatiquement (<code data-claire-semantic="ini">xdebug.default_enable=On </code>), la directive <code data-claire-semantic="ini">xdebug.show_local_vars=1 </code> permet de visualiser les variables locales de la partie du code qui provoque l'erreur.<br/> Testez cela avec ce code des plus basiques (je crois qu'il se passe d'explication :-° ) :</p><pre id="r-392324" data-claire-element-id="392324"><code data-claire-semantic="html+php">&lt;?php
$a = 25;
$b = &quot;25&quot;;
$c = array(25);
$d = array('25');

// Et une notice, une ...
echo $var;

$e =(string) $a.$b;
// Encore une notice.
echo $var;
?&gt;</code></pre><p id="r-392325" data-claire-element-id="392326">Ceci donne cela (là aussi je vous dispense d'explications) :<a href="medias/uploads.siteduzero.com_files_149001_150000_149628.jpg"><img id="r-392326" data-claire-element-id="392325" src="medias/uploads.siteduzero.com_thb_149001_150000_149628.jpg" alt="Image utilisateur"/></a></p><aside id="r-392328" data-claire-element-id="392328" data-claire-semantic="warning"><p id="r-392327" data-claire-element-id="392327">Si vous n'obtenez pas de notice, vérifiez votre niveau de rapport d'erreur qui doit intégrer les notices. En développement utiliser E_ALL ou E_STRICT (PHP 5) est nettement recommandé. Pour ce faire fixez-le dans le <a href="http://fr2.php.net/manual/fr/errorfunc.configuration.php#ini.error-reporting">php.ini</a> ou à la volée avec <code data-claire-semantic="html+php"><a href="http://fr2.php.net/error_reporting">error_reporting() </a></code>.</p></aside><p id="r-392329" data-claire-element-id="392329">Si pour une raison quelconque vous n'avez pas accès au fichier <strong>php.ini</strong>, vous pouvez soit utiliser la fonction correspondante au paramètre voulu si elle existe (par exemple : <code data-claire-semantic="html+php">xdebug_enable() </code> ) soit utiliser la fonction <code data-claire-semantic="html+php">ini_set() </code>.</p><p id="r-392330" data-claire-element-id="392330">Pour démarrer Xdebug vous pouvez utiliser la fonction <code data-claire-semantic="html+php">xdebug_enable() </code> ainsi que <code data-claire-semantic="html+php">xdebug_is_enabled() </code> pour savoir si Xdebug est démarré.<br/> Vous pouvez activer <strong>xdebug.show_local_vars</strong> avec ini_set :</p><p id="r-392331" data-claire-element-id="392331"><cite>Citation : Documentation</cite></p><blockquote id="r-392333" data-claire-element-id="392333"><p id="r-392332" data-claire-element-id="392332">string ini_set ( string $varname , string $newvalue )</p></blockquote><p id="r-392334" data-claire-element-id="392334">Donc :</p><pre id="r-392335" data-claire-element-id="392335"><code data-claire-semantic="html+php">&lt;?php
ini_set('xdebug.show_local_vars', 1);
?&gt;</code></pre><p id="r-392336" data-claire-element-id="392336">Avec le code plus haut, <code data-claire-semantic="html+php">ini_set('xdebug.show_local_vars', 1) </code> ne fonctionnera pas. <br/> Ceci est dû au fonctionnement de PHP : lorsque le client fait une requête au serveur pour une page PHP, le Zend Engine parse et compile le code en <a href="http://fr.wikipedia.org/wiki/Opcode">opcodes</a> (compilation qui peut être coûteuse en ressources d'où l'intérêt des outils de cache d'opcodes, cherchez APC, APD...). Or Xdebug est intégré au Zend Engine donc même si la compilation échoue il s'exécute. Mais ici avant l'exécution du main du code PHP qui configure <code data-claire-semantic="ini">xdebug.show_local_vars=1 </code> ce paramètre est assigné à 0 et la Notice est générée donc l'affichage des variables ne se fait pas.</p><p id="r-392337" data-claire-element-id="392337">Testez avec ce code :</p><pre id="r-392338" data-claire-element-id="392338"><code data-claire-semantic="html+php">&lt;?php
ini_set('xdebug.show_local_vars', 1); // Code compilé en opcodes avant cet appel.
set_time_limit(1);

function foo($a){
while($a &gt; 0)
	$a++; // Boucle infinie, erreur ici donc Xdebug indique seulement cette variable.
}	
$a = 25;
$b = &quot;25&quot;;
$c = array(25);
$d = array('25');
$e = foo($a);
?&gt;</code></pre><h2 id="r-les-variables-23" data-claire-element-id="392368">Les variables</h2><h3 id="r-la-fonction-var-dump" data-claire-element-id="392356">La fonction var_dump()...</h3><p id="r-392341" data-claire-element-id="392341">La fonction var_dump() est très utile pour le débogage car elle donne beaucoup d'informations sur l'état d'une variable. Mais Xdebug permet de modifier la sortie de var_dump().<br/> Testons pour voir un exemple modifié de la <a href="http://php.net/var_dump">documentation</a> :</p><pre id="r-392342" data-claire-element-id="392342"><code data-claire-semantic="html+php">&lt;?php
if(function_exists('xdebug_enable'))
        xdebug_disable( );

$a = array(1, 2, array(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;));
$b = 3.1;
$c = true;
var_dump($a);
var_dump($b, $c);

echo '&lt;hr /&gt;';

xdebug_enable( );
var_dump($a);
var_dump($b, $c);
?&gt;</code></pre><p id="r-392343" data-claire-element-id="392343">À priori aucun changement notable... J'ai bien dit à priori parce que si vous testiez en désactivant le chargement de l'extension depuis le <strong>php.ini</strong> vous verriez la différence ^^ . Donc Xdebug modifie bien la sortie de var_dump().</p><p id="r-392344" data-claire-element-id="392344">Illustrations :<br/> Avec Xdebug chargé dans le php.ini :</p><figure id="r-392346" data-claire-element-id="392347"><img id="r-392345" data-claire-element-id="392345" src="medias/uploads.siteduzero.com_files_149001_150000_149635.jpg" alt="Image utilisateur"/></figure><p id="r-392348" data-claire-element-id="392348">Et sans :</p><figure id="r-392350" data-claire-element-id="392351"><img id="r-392349" data-claire-element-id="392349" src="medias/uploads.siteduzero.com_files_149001_150000_149637.jpg" alt="Image utilisateur"/></figure><p id="r-392352" data-claire-element-id="392352">Bien sûr, utiliser les balises &lt;pre&gt;&lt;/pre&gt; permettrait un meilleur affichage mais c'était juste pour contraster ;) .</p><div id="r-392354" data-claire-element-id="392354" data-claire-semantic="question"><p id="r-392353" data-claire-element-id="392353">Mais, il ne fait que modifier la sortie pour la rendre plus lisible ?</p></div><p id="r-392355" data-claire-element-id="392355">Non, Xdebug permet aussi de modifier le nombre d'enfants, de valeurs et de niveaux affichés pour un array ou un objet (pour plus de détails consultez <a href="http://xdebug.org/docs/display">la doc</a>).</p><h3 id="r-et-un-dump-fort-utile" data-claire-element-id="392367">...et un dump fort utile</h3><p id="r-392357" data-claire-element-id="392357">Xdebug permet aussi d'afficher l'état des variables superglobales ce qui est quand même pratique dans le cadre du débogage.<br/> Pour cela il faut modifier le <strong>php.ini</strong> avec <code data-claire-semantic="ini">xdebug.dump.VARIABLE=[* ou NOM VARIABLE] </code>. Par exemple pour afficher toutes les variables GET, l'adresse IP de l'utilisateur et le nom du serveur, on fait comme ceci :</p><pre id="r-392358" data-claire-element-id="392358"><code data-claire-semantic="ini">xdebug.dump.GET=*
xdebug.dump.SERVER=REMOTE_ADDR, SERVER_NAME</code></pre><p id="r-392359" data-claire-element-id="392359">Les autres superglobales possibles sont, en plus de GET et SERVER, POST, COOKIE, FILES, REQUEST et SESSION.</p><aside id="r-392361" data-claire-element-id="392361" data-claire-semantic="warning"><p id="r-392360" data-claire-element-id="392360">Plus on ajoute de paramètres à Xdebug plus le rapport d'erreur sera long, il faut donc y faire attention si on ne veut pas se retrouver avec des valeurs inutiles. C'est pourquoi le symbole <strong>*</strong> est à utiliser avec précaution.</p></aside><p id="r-392362" data-claire-element-id="392362">Les variables SERVER ne sont affichées que si elles sont utilisées dans le code (ceci est le cas depuis 2.0.2 bug ou non ?). En appelant le code suivant avec &quot;test=string&amp;amp;test2=2&quot; comme paramètres, on obtient l'image qui le suit :</p><pre id="r-392363" data-claire-element-id="392363"><code data-claire-semantic="html+php">&lt;?php
$a = array(1, 2, array(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;));
$b = 3.1;
$c = true;

$_SERVER['SERVER_NAME']; // Intervention d'une variable serveur dans le code.

var_dump($a);
var_dump($b, $c);

echo $var; // Notice
?&gt;</code></pre><figure id="r-392365" data-claire-element-id="392366"><img id="r-392364" data-claire-element-id="392364" src="medias/uploads.siteduzero.com_files_149001_150000_149661.jpg" alt="Image utilisateur"/></figure>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug">[PHP] Utiliser un débogueur pour PHP : Xdebug</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
Un débogueur, l&#039;outil de l&#039;efficacité
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
Son utilisation basique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
Le traçage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-profiling-1">
Le profiling
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
<span class="arrow"></span>
<span class="next">Un débogueur, l&#039;outil de l&#039;efficacité</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
<span class="next">Le traçage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Letraage"></a><h2>Le traçage</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
<span class="arrow"></span>
<span class="next">Son utilisation basique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-profiling-1">
<span class="next">Le profiling</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<h2 id="r-la-pile-d-appel" data-claire-element-id="392401">La pile d'appel</h2><p id="r-392370" data-claire-element-id="392370">Rentrons maintenant dans le vif du sujet avec une fonction de Xdebug qui se révèle très utile : j'ai nommé la pile d'appel. Cette pile indique tous les appels de fonctions et de classes.<br/> Prenons par exemple le code suivant :</p><pre id="r-392371" data-claire-element-id="392371"><code data-claire-semantic="html+php">&lt;?php
set_time_limit(5);

function error($var){
        $buffer = 0;
        while($var = 1){
                $buffer += $var;
               $var--;
        }
     return $buffer;
}
error(5);
?&gt;</code></pre><p id="r-392372" data-claire-element-id="392372">Le code va produire une boucle infinie du fait d'une erreur courante qui est l'utilisation du égal '=' d'assignation au lieu du égal '==' de comparaison.<br/> Or désormais plus besoin de venir poster sur le bien-aimé forum PHP du Site du Zéro avec en titre &quot;Alerte PHP ne m'aime pas&quot; :p , car si vous utilisez Xdebug l'erreur sera des plus claires.<br/> Voyons le tout en images !</p><ul id="r-392383" data-claire-element-id="392383"><li id="r-392378" data-claire-element-id="392378"><p id="r-392373" data-claire-element-id="392373">Si Xdebug n'est pas activé PHP retourne l'erreur :</p><p id="r-392374" data-claire-element-id="392374"><cite>Citation</cite></p><blockquote id="r-392376" data-claire-element-id="392376"><p id="r-392375" data-claire-element-id="392375">Fatal error: Maximum execution time of 5 seconds exceeded in C:\wamp\www utos\xdebug\erreur.php on line 42</p></blockquote><p id="r-392377" data-claire-element-id="392377">(Eh oui j'ai limité le temps à 5 sec pour vous éviter le long délai d'attente de 30 secondes.)</p></li><li id="r-392382" data-claire-element-id="392382"><p id="r-392379" data-claire-element-id="392379">Si Xdebug est activé on obtient ceci :</p><p id="r-392380" data-claire-element-id="392381"><a href="medias/uploads.siteduzero.com_files_149001_150000_149704.jpg"><img id="r-392381" data-claire-element-id="392380" src="medias/uploads.siteduzero.com_thb_149001_150000_149704.jpg" alt="Image utilisateur"/></a></p></li></ul><p id="r-392384" data-claire-element-id="392384">Xdebug renvoie la même erreur que PHP mais si on regarde la pile des appels, on remarque que le script est resté sur error() jusqu'à la fin du script qui a duré trop longtemps. De plus on peut voir la valeur astronomique qu'a prise la variable $buffer.</p><p id="r-392385" data-claire-element-id="392385">Un cas plus concret de la pile d'appel est celui des premières images du tutoriel où elle nous permet de savoir d'un seul coup où l'exception a été lancée :</p><p id="r-392386" data-claire-element-id="392387"><a href="medias/uploads.siteduzero.com_files_149001_150000_149618.jpg"><img id="r-392387" data-claire-element-id="392386" src="medias/uploads.siteduzero.com_thb_149001_150000_149618.jpg" alt="Image utilisateur"/></a>Devient :</p><p id="r-392388" data-claire-element-id="392389"><a href="medias/uploads.siteduzero.com_files_149001_150000_149619.jpg"><img id="r-392389" data-claire-element-id="392388" src="medias/uploads.siteduzero.com_thb_149001_150000_149619.jpg" alt="Image utilisateur"/></a></p><p id="r-392390" data-claire-element-id="392390">Un autre exemple :<br/> Le cas d'une fonction récursive dont l'algorithme est mal conçu (dans notre cas très mal conçu ^^ ). La voici donc :</p><pre id="r-392391" data-claire-element-id="392391"><code data-claire-semantic="html+php">&lt;?php
set_time_limit(5);
function recursive_error($param){
        if(!$param) return 1;
        return $param * recursive_error($param + 1);  //au lieu de $param - 1
}
recursive_error(10);
?&gt;</code></pre><ul id="r-392399" data-claire-element-id="392399"><li id="r-392393" data-claire-element-id="392393"><p id="r-392392" data-claire-element-id="392392">Sans Xdebug le script est instable et produit une erreur.</p></li><li id="r-392398" data-claire-element-id="392398"><p id="r-392394" data-claire-element-id="392394">Avec Xdebug activé on obtient l'erreur ci-dessous :</p><p id="r-392395" data-claire-element-id="392396"><a href="medias/uploads.siteduzero.com_files_149001_150000_149706.jpg"><img id="r-392396" data-claire-element-id="392395" src="medias/uploads.siteduzero.com_thb_149001_150000_149706.jpg" alt="Image utilisateur"/></a></p><p id="r-392397" data-claire-element-id="392397">La pile d'appel est des plus claires, la fonction recursive_error() s'appelle indéfiniment.</p></li></ul><p id="r-392400" data-claire-element-id="392400">Cet exemple me permet de parler d'une autre particularité de Xdebug : les traces...</p><h2 id="r-quand-on-parle-de-traces" data-claire-element-id="392544">Quand on parle de traces</h2><p id="r-392402" data-claire-element-id="392402">Il est rare que l'on obtienne une fonction récursive qui s'appelle indéfiniment mais il peut arriver par exemple qu'elle accomplisse des occurrences non voulues. C'est pour ce genre de raison que l'on peut se servir des traces lorsque l'on veut suivre, <strong>tracer</strong>, une fonction.</p><h3 id="r-activer-les-traces" data-claire-element-id="392414">Activer les traces</h3><p id="r-392403" data-claire-element-id="392403">Activons tout d'abord les traces et paramétrons-les, voici ce que vous pouvez ajouter au <strong>php.ini</strong> :</p><pre id="r-392404" data-claire-element-id="392404"><code data-claire-semantic="ini">xdebug.auto_trace=1
xdebug.trace_output_dir=&quot;chemin\vers\dossier\trace\&quot;</code></pre><p id="r-392405" data-claire-element-id="392405">En ajoutant ces quelques lignes (et bien sûr en redémarrant le serveur) les traces seront activées automatiquement et ces fichiers s'enregistreront dans le répertoire spécifié.</p><aside id="r-392407" data-claire-element-id="392407" data-claire-semantic="information"><p id="r-392406" data-claire-element-id="392406">Dans ce cas-ci <code data-claire-semantic="html+php">ini_set() </code> ne fonctionne pas car l'exécution automatique doit être faite avant l'appel du script principal (main). C'est pourquoi il faut utiliser la fonction <code data-claire-semantic="html+php">xdebug_start_trace() </code>, expliquée plus bas, qui combine <code data-claire-semantic="ini">xdebug.auto_trace=1 </code> et <code data-claire-semantic="ini">xdebug.trace_output_dir=&quot;chemin\vers\dossier race\&quot; </code>.</p></aside><p id="r-392408" data-claire-element-id="392408">Exécutons de nouveau notre fonction récursive, nous obtenons le fichier log de trace suivant :</p><p id="r-392409" data-claire-element-id="392409"></p><div id="r-392411" data-claire-element-id="392411"><pre id="r-392410" data-claire-element-id="392410"><code>TRACE START [2008-12-23 11:08:09]
    0.0007      64152   -&gt; {main}() C:\wamp\www\tutos\xdebug\erreur.php:0
    0.0009      64152     -&gt; set_time_limit() C:\wamp\www\tutos\xdebug\erreur.php:50
    0.0010      64216     -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:56
    0.0011      64400       -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0011      64664         -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0012      64976           -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0013      65288             -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0015      65600               -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0016      65912                 -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0016      66224                   -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0017      66536                     -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0018      66848                       -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0018      67160                         -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0019      67472                           -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0019      67784                             -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0020      68096                               -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0020      68408                                 -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0021      68728                                   -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0021      69040                                     -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0022      69352                                       -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0022      69664                                         -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0023      69976                                           -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    0.0024      70288                                             -&gt; recursive_error() C:\wamp\www\tutos\xdebug\erreur.php:54
    ..........................................................................................................................
TRACE END   [2008-12-23 11:08:10]</code></pre></div><p id="r-392412" data-claire-element-id="392412">Nous pouvons voir que la fonction ne fait que s'appeler indéfiniment...</p><p id="r-392413" data-claire-element-id="392413">Si vous ajoutiez <code data-claire-semantic="ini">xdebug.show_mem_delta=On </code> le log indiquerait la mémoire que prend en plus chaque occurrence.</p><h3 id="r-tracer-c-est-bien-tracer-astucieusement-c-est-mieux" data-claire-element-id="392437">Tracer c'est bien, tracer astucieusement c'est mieux</h3><p id="r-392415" data-claire-element-id="392415">L'intérêt des traces est, lors d'un code fort complexe (et non pas nécessairement long), de situer l'origine et les conséquences des erreurs. Or utiliser le traçage automatique peut créer des logs de traces extrêmement volumineux. Car contrairement à la pile d'appel qui indique le suivi de l'erreur, les traces indiquent <strong>tous</strong> les appels, qu'il y ait erreur ou non. Et c'est bel et bien là son point fort : repérer les erreurs de conception dans un algorithme ou dans une séquence de code.</p><p id="r-392416" data-claire-element-id="392416">C'est pourquoi on utilise en général les fonctions <code data-claire-semantic="html+php">xdebug_start_trace() </code> et <code data-claire-semantic="html+php">xdebug_stop_trace() </code> au lieu de mettre <code data-claire-semantic="ini">xdebug.auto_trace=1 </code>.</p><p id="r-392417" data-claire-element-id="392417">Supprimez la ligne <code data-claire-semantic="ini">xdebug.auto_trace=1 </code> ou mettez un point-virgule devant pour la mettre en commentaire. Puis testons le code suivant :</p><pre id="r-392418" data-claire-element-id="392418"><code data-claire-semantic="html+php">&lt;?php
xdebug_start_trace(null,XDEBUG_TRACE_HTML);

class A{
        private $_text;
        
        public function __construct($text = ''){
                $this-&gt;_text = $text;
        }
        
        public function setText($text){
                $this-&gt;_text = $text;
        }
        
        public function getText(){ 
                return $this-&gt;_text;
        }
}

class B{
        static function say(A $object){
                return 'Le contenu de A est :&quot;'. $object-&gt;getText().'&quot;';
        }
}
$a = new A('Hello world !');
 
echo B::say($a);
xdebug_stop_trace( );

echo $var;
?&gt;</code></pre><p id="r-392419" data-claire-element-id="392419">La fonction <code data-claire-semantic="html+php">void xdebug_start_trace( string trace_file [, integer options] ) </code> peut recevoir 2 paramètres dont 1 optionnel :</p><ol id="r-392424" data-claire-element-id="392424"><li id="r-392421" data-claire-element-id="392421"><p id="r-392420" data-claire-element-id="392420">Le premier est le chemin et le nom du fichier trace qui sera généré. Si le paramètre est null, c'est la valeur de <code data-claire-semantic="ini">xdebug.trace_output_dir=&quot;chemin\vers\dossier race\&quot; </code> (nous verrons plus tard comment changer dans le <strong>php.ini</strong> le nom du fichier).</p></li><li id="r-392423" data-claire-element-id="392423"><p id="r-392422" data-claire-element-id="392422">Le deuxième est une constante. Il y a 3 valeurs possibles :</p></li></ol><ul id="r-392431" data-claire-element-id="392431"><li id="r-392426" data-claire-element-id="392426"><p id="r-392425" data-claire-element-id="392425"><strong>XDEBUG_TRACE_APPEND :</strong> ajoute les traces à la fin du log de traces au lieu d'écraser le fichier. Équivalent à mettre <code data-claire-semantic="ini">xdebug.trace_options=1 </code> ;</p></li><li id="r-392428" data-claire-element-id="392428"><p id="r-392427" data-claire-element-id="392427"><strong>XDEBUG_TRACE_COMPUTERIZED :</strong> génère un log de traces lisible par un ordinateur. Équivalent à mettre <code data-claire-semantic="ini">xdebug.trace_format=1 </code> ;</p></li><li id="r-392430" data-claire-element-id="392430"><p id="r-392429" data-claire-element-id="392429"><strong>XDEBUG_TRACE_HTML :</strong> génère un log de traces sous forme de tableau en HTML (il suffit juste de l'ouvrir avec un navigateur Internet).</p></li></ul><p id="r-392432" data-claire-element-id="392432">Si l'on regarde le log de traces obtenu on peut voir ceci :</p><figure id="r-392434" data-claire-element-id="392435"><img id="r-392433" data-claire-element-id="392433" src="medias/uploads.siteduzero.com_files_153001_154000_153478.png" alt="Image utilisateur"/></figure><p id="r-392436" data-claire-element-id="392436">Ce qui est bien plus détaillé que la pile d'erreur qui elle ne donne aucune information. S'il y avait une erreur de conception sans trace, on n'aurait pas pu la voir.</p><h3 id="r-un-peu-de-personnalisation" data-claire-element-id="392543">Un peu de personnalisation</h3><p id="r-392438" data-claire-element-id="392438">Xdebug permet d'ajouter dans le log de traces les valeurs retournées par les fonctions ou méthodes de classes ( <strong>return</strong> :p ). Pour ce faire il suffit de mettre :</p><pre id="r-392439" data-claire-element-id="392439"><code data-claire-semantic="ini">xdebug.collect_return=1</code></pre><p id="r-392440" data-claire-element-id="392440">Ainsi avec la fonction récursive corrigée que voici :</p><pre id="r-392441" data-claire-element-id="392441"><code data-claire-semantic="html+php">&lt;?php
function recursive ($param){
        if (!$param) return 1;
        return $param * recursive($param - 1); 
}
echo recursive(10);
?&gt;</code></pre><p id="r-392442" data-claire-element-id="392442">Après avoir réactivé les traces automatiques on obtient le log de traces suivant (avec les indications de mémoire) :</p><p id="r-392443" data-claire-element-id="392444"><a href="medias/uploads.siteduzero.com_files_153001_154000_153640.png"><img id="r-392444" data-claire-element-id="392443" src="medias/uploads.siteduzero.com_thb_153001_154000_153640.png" alt="log de traces"/></a></p><p id="r-392445" data-claire-element-id="392445">Enfin Xdebug permet de modifier aussi le nom du log de traces par le biais du php.ini, la configuration par défaut est :</p><pre id="r-392446" data-claire-element-id="392446"><code data-claire-semantic="ini">xdebug.trace_output_name=trace.%c</code></pre><p id="r-392447" data-claire-element-id="392447">Les options possibles sont récapitulées dans le tableau suivant (copié de la documentation) :</p><table id="r-392540" data-claire-element-id="392540"><thead id="r-392457" data-claire-element-id="392457"><tr id="r-392456" data-claire-element-id="392456"><th id="r-392449" data-claire-element-id="392449"><p id="r-392448" data-claire-element-id="392448">Spécificateur</p></th><th id="r-392451" data-claire-element-id="392451"><p id="r-392450" data-claire-element-id="392450">Sens</p></th><th id="r-392453" data-claire-element-id="392453"><p id="r-392452" data-claire-element-id="392452">Exemple de forme</p></th><th id="r-392455" data-claire-element-id="392455"><p id="r-392454" data-claire-element-id="392454">Exemple de nom de fichier</p></th></tr></thead><tbody id="r-392539" data-claire-element-id="392539"><tr id="r-392466" data-claire-element-id="392466"><td id="r-392459" data-claire-element-id="392459"><p id="r-392458" data-claire-element-id="392458">%c</p></td><td id="r-392461" data-claire-element-id="392461"><p id="r-392460" data-claire-element-id="392460"><a href="http://fr.wikipedia.org/wiki/Contrôle_de_redondance_cyclique">crc32</a> du répertoire courant</p></td><td id="r-392463" data-claire-element-id="392463"><p id="r-392462" data-claire-element-id="392462">trace.%c</p></td><td id="r-392465" data-claire-element-id="392465"><p id="r-392464" data-claire-element-id="392464">trace.1258863198.xt</p></td></tr><tr id="r-392475" data-claire-element-id="392475"><td id="r-392468" data-claire-element-id="392468"><p id="r-392467" data-claire-element-id="392467">%p</p></td><td id="r-392470" data-claire-element-id="392470"><p id="r-392469" data-claire-element-id="392469"><a href="http://fr.wikipedia.org/wiki/Identifiant_de_processus">pid</a> (identifiant du processus)</p></td><td id="r-392472" data-claire-element-id="392472"><p id="r-392471" data-claire-element-id="392471">trace.%p</p></td><td id="r-392474" data-claire-element-id="392474"><p id="r-392473" data-claire-element-id="392473">trace.5174.xt</p></td></tr><tr id="r-392484" data-claire-element-id="392484"><td id="r-392477" data-claire-element-id="392477"><p id="r-392476" data-claire-element-id="392476">%r</p></td><td id="r-392479" data-claire-element-id="392479"><p id="r-392478" data-claire-element-id="392478">nombre aléatoire</p></td><td id="r-392481" data-claire-element-id="392481"><p id="r-392480" data-claire-element-id="392480">trace.%r</p></td><td id="r-392483" data-claire-element-id="392483"><p id="r-392482" data-claire-element-id="392482">trace.072db0.xt</p></td></tr><tr id="r-392493" data-claire-element-id="392493"><td id="r-392486" data-claire-element-id="392486"><p id="r-392485" data-claire-element-id="392485">%t</p></td><td id="r-392488" data-claire-element-id="392488"><p id="r-392487" data-claire-element-id="392487">timestamp (secondes)</p></td><td id="r-392490" data-claire-element-id="392490"><p id="r-392489" data-claire-element-id="392489">trace.%t</p></td><td id="r-392492" data-claire-element-id="392492"><p id="r-392491" data-claire-element-id="392491">trace.1179434742.xt</p></td></tr><tr id="r-392502" data-claire-element-id="392502"><td id="r-392495" data-claire-element-id="392495"><p id="r-392494" data-claire-element-id="392494">%u</p></td><td id="r-392497" data-claire-element-id="392497"><p id="r-392496" data-claire-element-id="392496">timestamp (microsecondes)</p></td><td id="r-392499" data-claire-element-id="392499"><p id="r-392498" data-claire-element-id="392498">trace.%u</p></td><td id="r-392501" data-claire-element-id="392501"><p id="r-392500" data-claire-element-id="392500">trace.1179434749_642382.xt</p></td></tr><tr id="r-392511" data-claire-element-id="392511"><td id="r-392504" data-claire-element-id="392504"><p id="r-392503" data-claire-element-id="392503">%H</p></td><td id="r-392506" data-claire-element-id="392506"><p id="r-392505" data-claire-element-id="392505">$_SERVER['HTTP_HOST']</p></td><td id="r-392508" data-claire-element-id="392508"><p id="r-392507" data-claire-element-id="392507">trace.%H</p></td><td id="r-392510" data-claire-element-id="392510"><p id="r-392509" data-claire-element-id="392509">trace.kossu.xt</p></td></tr><tr id="r-392520" data-claire-element-id="392520"><td id="r-392513" data-claire-element-id="392513"><p id="r-392512" data-claire-element-id="392512">%R</p></td><td id="r-392515" data-claire-element-id="392515"><p id="r-392514" data-claire-element-id="392514">$_SERVER['REQUEST_URI']</p></td><td id="r-392517" data-claire-element-id="392517"><p id="r-392516" data-claire-element-id="392516">trace.%R</p></td><td id="r-392519" data-claire-element-id="392519"><p id="r-392518" data-claire-element-id="392518">trace._test_xdebug_test_php_var=1_var2=2.xt</p></td></tr><tr id="r-392529" data-claire-element-id="392529"><td id="r-392522" data-claire-element-id="392522"><p id="r-392521" data-claire-element-id="392521">%S</p></td><td id="r-392524" data-claire-element-id="392524"><p id="r-392523" data-claire-element-id="392523">session_id (celui de $_COOKIE si défini)</p></td><td id="r-392526" data-claire-element-id="392526"><p id="r-392525" data-claire-element-id="392525">trace.%S</p></td><td id="r-392528" data-claire-element-id="392528"><p id="r-392527" data-claire-element-id="392527">trace.c70c1ec2375af58f74b390bbdd2a679d.xt</p></td></tr><tr id="r-392538" data-claire-element-id="392538"><td id="r-392531" data-claire-element-id="392531"><p id="r-392530" data-claire-element-id="392530">%%</p></td><td id="r-392533" data-claire-element-id="392533"><p id="r-392532" data-claire-element-id="392532">symbole %</p></td><td id="r-392535" data-claire-element-id="392535"><p id="r-392534" data-claire-element-id="392534">trace.%%</p></td><td id="r-392537" data-claire-element-id="392537"><p id="r-392536" data-claire-element-id="392536">trace.%.xt</p></td></tr></tbody></table><p id="r-392541" data-claire-element-id="392541">Vous pouvez dans un script récupérer ce nom de fichier avec <code data-claire-semantic="html+php">xdebug_get_tracefile_name() </code>.</p><p id="r-392542" data-claire-element-id="392542">Voilà c'est fini pour les traces ;) .</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug">[PHP] Utiliser un débogueur pour PHP : Xdebug</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
Un débogueur, l&#039;outil de l&#039;efficacité
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
Son utilisation basique
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
Le traçage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-profiling-1">
Le profiling
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
<span class="arrow"></span>
<span class="next">Son utilisation basique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-profiling-1">
<span class="next">Le profiling</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="Leprofiling"></a><h2>Le profiling</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
<span class="arrow"></span>
<span class="next">Le traçage</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-392546" data-claire-element-id="392546">Vous croyez connaître Xdebug ? Eh bien vous n'avez encore rien vu, si Xdebug est si puissant c'est parce qu'il génère des fichiers de <em>profiling</em>...</p><h2 id="r-le-profiling" data-claire-element-id="392550">Le profiling</h2><p id="r-392547" data-claire-element-id="392547">Au fur à mesure de vos développements vos codes s'alourdissent, se complexifient et ralentissent le serveur. Et ce en raison d'algorithmes mal optimisés, un code qui est répété inutilement trop de fois ou une REGEX trop lourde...<br/> Et c'est pour corriger ces parties de code que l'on appelle &quot;goulets d'étranglement&quot; (<em>bottleneck</em>) que l'on profile une application afin de déceler où modifier le code ;) .</p><p id="r-392548" data-claire-element-id="392548">Donc profiler c'est une analyse qui consiste à identifier les opérations (ou portions de code) coûteuses en ressources, à repérer les doublons et à les corriger (on parle alors de <em><strong>refactoring</strong></em> ou remaniement).</p><p id="r-392549" data-claire-element-id="392549">Or Xdebug est capable de générer un fichier de <em>profiling</em> utilisable par un <em>profiler</em>, un logiciel qui permettra l'analyse d'un code donné.</p><h2 id="r-generer-des-fichiers-de-profiling" data-claire-element-id="392557">Générer des fichiers de profiling</h2><h3 id="r-activation-du-profiler" data-claire-element-id="392556">Activation du profiler</h3><p id="r-392551" data-claire-element-id="392551">Pour profiler il faut tout d'abord activer la génération des fichiers de <em>profiling</em> sous Xdebug.<br/> Entrez ceci dans le <strong>php.ini</strong> :</p><pre id="r-392552" data-claire-element-id="392552"><code data-claire-semantic="ini">xdebug.profiler_enable=1
xdebug.profiler_output_dir=&quot;C:\wamp\profiling&quot;
xdebug.profiler_output_name=&quot;cachegrind.out.%s&quot;</code></pre><p id="r-392553" data-claire-element-id="392553">Comme vous pouvez le constater, les paramètres de configuration ressemblent fortement à ceux des traces mis à part l'ajout de l'option pour les noms du fichier de sortie de <code data-claire-semantic="ini">xdebug.profiler_output_name=&quot;cachegrind.out.%parametre&quot; </code>.</p><p id="r-392554" data-claire-element-id="392554">Si vous ne voulez pas profiler tous les fichiers mais seulement certains vous pouvez utiliser le paramètre <code data-claire-semantic="ini">xdebug.profiler_enable_trigger=1 </code> et profiler seulement lors de l'utilisation de <strong>XDEBUG_PROFILE</strong> en paramètre GET ou POST.</p><p id="r-392555" data-claire-element-id="392555">Enfin, par défaut Xdebug réécrit le fichier de profiling à chaque appel de la même page. Si vous voulez que ce ne soit pas le cas mettez <code data-claire-semantic="ini">xdebug.profiler_append=1 </code>.</p><h2 id="r-quelques-outils-de-profiling" data-claire-element-id="392575">Quelques outils de profiling</h2><p id="r-392558" data-claire-element-id="392558">Ceci est une petite annexe où je vais présenter brièvement les outils de <em>profiling</em>, leur utilisation n'étant pas l'objet de ce tutoriel.</p><h3 id="r-le-profiler-par-excellence" data-claire-element-id="392564">Le profiler par excellence...</h3><p id="r-392559" data-claire-element-id="392559">...se nomme KCacheGrind. Malheureusement pour certains, il n'est disponible que sur les systèmes Linux. Cette application KDE dépendante de Valgrind et GraphViz est le parfait outil du développeur une fois installée ^^ ... Si l'application ne fonctionne pas malgré l'installation des dépendances, compilez-la <a href="http://kcachegrind.sourceforge.net/">manuellement</a>.</p><p id="r-392560" data-claire-element-id="392560">Cet outil est très complet et permet un profiling intuitif.<br/> Voici 2 images vous illustrant rapidement son fonctionnement et notamment la génération d'un <em>graph</em> :</p><p id="r-392561" data-claire-element-id="392563"><a href="medias/uploads.siteduzero.com_files_150001_151000_150365.png"><img id="r-392562" data-claire-element-id="392561" src="medias/uploads.siteduzero.com_thb_150001_151000_150365.png" alt="Image utilisateur"/></a><a href="medias/uploads.siteduzero.com_files_150001_151000_150366.png"><img id="r-392563" data-claire-element-id="392562" src="medias/uploads.siteduzero.com_thb_150001_151000_150366.png" alt="Image utilisateur"/></a></p><h3 id="r-son-homologue-windowsien" data-claire-element-id="392570">Son homologue &quot;Windowsien&quot;</h3><p id="r-392565" data-claire-element-id="392565">Pardonnez-moi le néologisme mais c'est exactement ce qu'est <a href="http://sourceforge.net/projects/wincachegrind/">WinCacheGrind</a>. Malheureusement ce logiciel a beau être simple d'accès, il n'est pas aussi intuitif que KCacheGrind, ni capable de générer des graphiques.</p><p id="r-392566" data-claire-element-id="392566">Son interface simple et claire permet de profiler dans de bonnes conditions.</p><p id="r-392567" data-claire-element-id="392567">Voici une image du même fichier de profiling que ci-dessus avec WinCacheGrind :</p><p id="r-392568" data-claire-element-id="392569"><a href="medias/uploads.siteduzero.com_files_150001_151000_150367.png"><img id="r-392569" data-claire-element-id="392568" src="medias/uploads.siteduzero.com_thb_150001_151000_150367.png" alt="Image utilisateur"/></a></p><h3 id="r-conclusion-36" data-claire-element-id="392574">Conclusion</h3><p id="r-392571" data-claire-element-id="392571">Pour Mac il existe <a href="http://www.maccallgrind.com/">MacCallGrind</a> mais je ne le connais pas...</p><p id="r-392572" data-claire-element-id="392572">En conclusion : profiler est une tâche essentielle pour l'optimisation de son code, et malheureusement parfois méconnue dans le milieu amateur de PHP (comprendre par là non-professionnel), tout comme l'utilisation d'un outil de débogage. ;)</p><p id="r-392573" data-claire-element-id="392573">Voilà c'est fini, j'espère que ce tutoriel vous a plu et que vous en êtes satisfaits. En cas de coquille ou d'erreur merci de me contacter par MP ;) .<br/> Notez qu'une sous-partie paraîtra plus tard pour vous expliquer comment déboguer directement depuis un EDI qui le permet, l'exemple qui sera pris sera sans doute Eclipse PDT. La partie sur var_dump() sera complétée dès que je trouverai du temps.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug">[PHP] Utiliser un débogueur pour PHP : Xdebug</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/un-debogueur-l-outil-de-l-efficacite">
Un débogueur, l&#039;outil de l&#039;efficacité
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/son-utilisation-basique">
Son utilisation basique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
Le traçage
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-profiling-1">
Le profiling
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/php-utiliser-un-debogueur-pour-php-xdebug/le-tracage">
<span class="arrow"></span>
<span class="next">Le traçage</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/-utiliser-un-debogueur-pour-php-xdebug.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 00:31:30 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/-utiliser-un-debogueur-pour-php-xdebug.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:18:49 GMT -->
</html>