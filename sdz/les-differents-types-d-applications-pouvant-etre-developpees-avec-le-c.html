<html>

<!-- Mirrored from 62.4.17.167/sdz/sdz/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 22:50:07 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:02:04 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tutoriel : Les différents types d&#039;applications pouvant être développées avec le C#</title>
<link href="medias/sdz_main.css" type="text/css" rel="stylesheet" media="all"/>
</head>
        <body>
<a href="../www.siteduzero.com/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c.html" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Les différents types d&#039;applications pouvant être développées avec le C#</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="#Lesdiffrentstypesd039applicationspouvanttredveloppesavecleC">Les différents types d&#039;applications pouvant être développées avec le C#</a><br/><a href="#CreruneapplicationWindowsavecWPF">Créer une application Windows avec WPF</a><br/><a href="#CreruneapplicationwebavecASP.NET">Créer une application web avec ASP.NET</a><br/><a href="#CreruneapplicationclientricheavecSilverlight">Créer une application client riche avec Silverlight</a><br/><a href="#LegraphismeetlesjeuxavecXNA">Le graphisme et les jeux avec XNA</a><br/><a href="#CreruneapplicationmobileavecWindowsPhone7">Créer une application mobile avec Windows Phone 7</a><br/><a href="#CrerunservicewebavecWCF">Créer un service web avec WCF</a><br/></div>
<a name="Lesdiffrentstypesd039applicationspouvanttredveloppesavecleC"></a><h2>Les différents types d&#039;applications pouvant être développées avec le C#</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
<span class="next">Créer une application Windows avec WPF</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div class="content">
<p id="r-432105" data-claire-element-id="432105">Vous savez quoi ? Avec le C# on peut créer autre chose que des applications consoles !! Dingue non ? Des applications avec des boutons et des menus, ou des sites web et même des jeux.<br/> Ces bonnes nouvelles sonnent la fin de nos applications console toutes noires et toutes tristes… mais grâce à ça, c’est le début d’une toute nouvelle aventure.<br/> Dans ce chapitre, je vais vous présenter rapidement ce qu’on peut faire d’autre avec le C#. Chaque paragraphe de ce chapitre nécessite un livre entier pour être correctement traité. Aussi, je vais simplement vous montrer ce que l’on peut faire, histoire d’avoir un premier point de départ et de pouvoir décider vers quoi orienter vos prochaines lectures.</p><p id="r-432106" data-claire-element-id="432106">J’espère que vous me pardonnerez par avance de ce trop bref aperçu mais je souhaite néanmoins piquer votre curiosité pour vous donner envie d’aller explorer tous ces nouveaux mondes qui s’ouvrent à vous.<br/> Il y aura sûrement des notions que vous ne comprendrez pas complètement en fonction des thèmes abordés. Il faudra aller jeter un œil complémentaire sur internet ou attendre un prochaine tutoriel ;) .</p>
</div><a name="CreruneapplicationWindowsavecWPF"></a><h2>Créer une application Windows avec WPF</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
<span class="next">Créer une application web avec ASP.NET</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-432107" data-claire-element-id="432107">Les applications Windows sont ce qu’on appelle des applications clients lourds. Elles s’exécutent directement depuis notre système d’exploitation. Nous pouvons créer toutes sortes d’applications, comme un traitement de texte, une calculatrice, etc.</p><p id="r-432108" data-claire-element-id="432108">Nous avons déjà créé une application Windows à travers notre projet console, sauf que nous étions rapidement limités. Avec WPF, nous allons pouvoir créer des applications graphiques avec des boutons, des menus, … Bref, tout ce qui compose une application habituelle.<br/> WPF signifie <strong>Windows Presentation Foundation</strong>. Il s’agit d’une bibliothèque permettant de réaliser des applications graphiques. Ces applications sont dites événementielles car elles réagissent à des événements (clic sur un bouton, redimensionnement de la fenêtre, saisie de texte, etc.)</p><p id="r-432109" data-claire-element-id="432109">Pour créer une application WPF, il faut commencer par choisir le type de projet adéquat. Dans Visual C# Express, nous choisissons le modèle « Application WPF » :</p><figure id="r-432111" data-claire-element-id="432112"><img id="r-432110" data-claire-element-id="432110" src="medias/uploads.siteduzero.com_files_356001_357000_356718.png" alt="Image utilisateur"/></figure><p id="r-432113" data-claire-element-id="432113">La première chose à savoir dans une application WPF est qu’elle se construit grâce à deux langages. Un langage de présentation qui va permettre de décrire le contenu de notre fenêtre : le <strong>XAML</strong> (prononcez xamelle) et du C# qui va permettre de faire tout le code métier. <br/> Une application WPF est décomposée en fenêtres qui sont affichées à partir de l’application principale. Chaque fenêtre est composée d’un fichier .xaml qui contient la description de la fenêtre (l’emplacement des boutons, des images, …) et d’un fichier de code .xaml.cs qui contient le code associé à cette fenêtre. On appelle ce fichier le « code behind ».<br/> Nous pouvons voir ceci après avoir créé notre projet car Visual C# Express créé automatiquement une fenêtre par défaut qui s’appelle MainWindow. Ce fichier est d’ailleurs ouvert automatiquement. Si nous déplions ce fichier dans l’explorateur de solutions, nous pouvons voir un autre fichier dessous qui possède l’extension .xaml.cs, le fichier de code behind.</p><p id="r-432114" data-claire-element-id="432114">Le XAML est une espèce de fichier XML qui va nous permettre de décrire le contenu de notre fenêtre. Cette fenêtre est composée de « contrôles », qui sont des éléments graphiques unitaires comme un bouton, une case à cocher, etc. Nous pouvons soit remplir ce fichier XAML à la main si nous connaissons la syntaxe, soit utiliser le designer pour y glisser les contrôles disponibles dans la boite à outils :</p><figure id="r-432116" data-claire-element-id="432117"><img id="r-432115" data-claire-element-id="432115" src="medias/uploads.siteduzero.com_files_356001_357000_356719.png" alt="Image utilisateur"/></figure><p id="r-432118" data-claire-element-id="432118">Positionnons un bouton par exemple grâce au glisser-déplacer. Nous obtenons :</p><figure id="r-432120" data-claire-element-id="432121"><img id="r-432119" data-claire-element-id="432119" src="medias/uploads.siteduzero.com_files_356001_357000_356720.png" alt="Image utilisateur"/></figure><p id="r-432122" data-claire-element-id="432122">Nous pouvons voir trois choses :</p><ul id="r-432129" data-claire-element-id="432129"><li id="r-432124" data-claire-element-id="432124"><p id="r-432123" data-claire-element-id="432123">La première est le rendu de notre fenêtre dans la partie haute du fichier MainWindows.xaml. C’est ça qui sera affiché lors du lancement de notre application.</p></li><li id="r-432126" data-claire-element-id="432126"><p id="r-432125" data-claire-element-id="432125">La deuxième est le descriptif de cette fenêtre dans le code XAML, c'est-à-dire le langage permettant de décrire la fenêtre. Ce XAML est modifié si nous ajoutons des contrôles avec le designer. Inversement, si nous modifions le code XAML, le designer se met à jour avec les modifications.</p></li><li id="r-432128" data-claire-element-id="432128"><p id="r-432127" data-claire-element-id="432127">La troisième est que nous pouvons voir et modifier les propriétés du contrôle dans la fenêtre de propriétés. Ici par exemple, j’ai changé la propriété Content de mon bouton pour y mettre la phrase « Cliquez-moi », ce qui a pour effet de changer le texte du bouton et le code XAML.</p></li></ul><p id="r-432130" data-claire-element-id="432130">Il y a beaucoup de contrôles dans la boite à outils. Rajoutons un Label, qui est une zone de texte non modifiable, ainsi qu’un Textbox, qui est une zone de texte modifiable, au-dessus du bouton.<br/> Rajoutons également un autre Label en dessous du bouton.<br/> Modifiez la propriété Content du premier label pour y saisir « Saisir votre nom : ». Dessinez le TextBox de manière à ce qu’il soit suffisamment grand pour accueillir un prénom et modifiez le nom du contrôle, en haut de la fenêtre de propriété, pour l’appeler « nom ». Enfin, dans le deuxième label, changez la propriété Foreground pour mettre du rouge et videz la propriété Content pour avoir une chaine vide.</p><p id="r-432131" data-claire-element-id="432131">Votre designer devrait ressembler à :</p><figure id="r-432133" data-claire-element-id="432134"><img id="r-432132" data-claire-element-id="432132" src="medias/uploads.siteduzero.com_files_356001_357000_356721.png" alt="Image utilisateur"/></figure><p id="r-432135" data-claire-element-id="432135">Et votre XAML à :</p><pre id="r-432136" data-claire-element-id="432136"><code data-claire-semantic="xml">&lt;Window x:Class=&quot;DemoWPF.MainWindow&quot;
        xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
        xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
        Title=&quot;MainWindow&quot; Height=&quot;350&quot; Width=&quot;525&quot;&gt;
    &lt;Grid&gt;
        &lt;Button Content=&quot;Cliquez-moi&quot; Height=&quot;23&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;214,86,0,0&quot; Name=&quot;button1&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;75&quot; /&gt;
        &lt;Label Content=&quot;Saisir votre nom :&quot; Height=&quot;28&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;34,42,0,0&quot; Name=&quot;label1&quot; VerticalAlignment=&quot;Top&quot; /&gt;
        &lt;TextBox Height=&quot;23&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;155,44,0,0&quot; Name=&quot;nom&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;295&quot; /&gt;
        &lt;Label Height=&quot;28&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;94,132,0,0&quot; Name=&quot;label2&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;309&quot; Foreground=&quot;Red&quot; /&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;</code></pre><p id="r-432137" data-claire-element-id="432137">A noter que les valeurs des propriétés Margin ou Height seront sans doute différentes, vu qu’elles reflètent la façon dont j’ai dessiné les contrôles sur le designer.<br/> Sélectionnez désormais le bouton dans le designer et cliquez sur le petit éclair dans la fenêtre des propriétés pour accéder à l’onglet des événements :</p><figure id="r-432139" data-claire-element-id="432140"><img id="r-432138" data-claire-element-id="432138" src="medias/uploads.siteduzero.com_files_356001_357000_356722.png" alt="Image utilisateur"/></figure><p id="r-432141" data-claire-element-id="432141">Dans l’événement Click, saisir un nom de méthode, par exemple OnClickBouton. A la validation, Visual C# Express nous génère une méthode dans le code behind :</p><pre id="r-432142" data-claire-element-id="432142"><code data-claire-semantic="csharp">private void OnClickBouton(object sender, RoutedEventArgs e)
{

}</code></pre><p id="r-432143" data-claire-element-id="432143">C’est cette méthode qui va être appelée lorsque nous cliquerons sur le bouton. <br/> En complément, le XAML se met à jour pour devenir :</p><pre id="r-432144" data-claire-element-id="432144"><code data-claire-semantic="xml">&lt;Button Content=&quot;Cliquez-moi&quot; Height=&quot;23&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;214,86,0,0&quot; Name=&quot;button1&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;75&quot; Click=&quot;OnClickBouton&quot; /&gt;</code></pre><p id="r-432145" data-claire-element-id="432145">Nous pouvons y voir que la propriété Click (qui est un événement) est associée au nom de la méthode qui sera appelée lors du clic sur le bouton.</p><p id="r-432146" data-claire-element-id="432146">Le but de cette petite démo est de pouvoir saisir du texte dans le contrôle TextBox et d’afficher un message dans le label sous le bouton en fonction du nom saisi, par exemple « Bonjour [prénom] ». Pour accéder aux informations qui ont été saisies dans le champ, on utilise des variables qui ont été générées par Visual C# Express à partir du code XAML de description de la fenêtre. Il y a une variable générée par contrôle, sachant qu’elles possèdent le nom donné au contrôle. En l’occurrence, notre contrôle TextBox s’appelle « nom ». Nous allons pouvoir accéder à la valeur saisie grâce à la propriété Text de l’objet nom. A noter que la variable nom est du type <a href="http://msdn.microsoft.com/fr-fr/library/system.windows.controls.textbox.aspx">TextBox</a> qui est un contrôle de WPF. C’est la même chose pour le label, que nous n’avons pas renommé. Nous pouvons le modifier en utilisant sa propriété Content, ce qui donne :</p><pre id="r-432147" data-claire-element-id="432147"><code data-claire-semantic="csharp">private void OnClickBouton(object sender, RoutedEventArgs e)
{
    label2.Content = &quot;Bonjour &quot; + nom.Text + &quot; !!&quot;;
}</code></pre><p id="r-432148" data-claire-element-id="432148">Lançons notre application avec <kbd>F5</kbd>, nous pouvons voir une fenêtre qui s’ouvre avec nos contrôles. Si nous saisissons un nom dans la zone de texte et que nous cliquons sur le bouton, nous pouvons voir :</p><figure id="r-432150" data-claire-element-id="432151"><img id="r-432149" data-claire-element-id="432149" src="medias/uploads.siteduzero.com_files_356001_357000_356723.png" alt="Image utilisateur"/></figure><p id="r-432152" data-claire-element-id="432152">Superbe !! Notre première application WPF fonctionnelle :) .<br/> Regardons d’un peu plus près le code behind :</p><pre id="r-432153" data-claire-element-id="432153"><code data-claire-semantic="csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace DemoWPF
{
    /// &lt;summary&gt;
    /// Logique d'interaction pour MainWindow.xaml
    /// &lt;/summary&gt;
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void OnClickBouton(object sender, RoutedEventArgs e)
        {
            label2.Content = &quot;Bonjour &quot; + nom.Text + &quot; !!&quot;;
        }
    }
}</code></pre><p id="r-432154" data-claire-element-id="432154">Nous pouvons voir que Visual C# Express nous a inclus plein d’espace de noms qui nous serviront surement plus tard, mais aussi que la classe s’appelle du même nom que la fenêtre : MainWindow. Ce n’est pas un hasard, en fait la fenêtre est un objet qui hérite des fonctionnalités de base d’une fenêtre, en dérivant de <a href="http://msdn.microsoft.com/fr-fr/library/system.windows.window.aspx">la classe Window</a>. WPF est composée de toute une hiérarchie de classes représentant les fenêtres, les contrôles et plein d’autres choses dans une approche orientée objet. Ces classes sont fortement réutilisables pour nos besoins.<br/> En l’occurrence, notre fenêtre va hériter de plein de propriétés, comme sa taille, son titre, etc. A ces propriétés vont être rajoutées des variables membres qui servent à accéder aux contrôles que nous avons décrits dans le XAML. <br/> En fait, le XAML a été transformé en code permettant de créer la fenêtre et ses composants. C’est ainsi que les label et le textbox ont été construits puis ajoutés au contenu de la fenêtre. Ce code généré est appelé depuis la méthode InitalizeComponent qui se trouve dans le constructeur de la classe. Une fois les contrôles initialisés, nous pouvons les utiliser grâce aux variables membres dont le nom est le même que celui des contrôles. <br/> Nous retrouvons ici l’intérêt de la classe partielle. Le code automatique est généré dans la classe partielle et nous augmentons ses fonctionnalités, comme le traitement de l’événement de clic sur le bouton, dans un autre fichier sans risque d’écrasement des modifications.</p><p id="r-432155" data-claire-element-id="432155">Voilà ! Notre première application WPF est terminée. Plutôt pas mal non ? Il y aurait beaucoup de choses à dire encore, de contrôles à décrire, mais je vais terminer cet aperçu en vous parlant d’une fonctionnalité très pratique : le binding.</p><p id="r-432156" data-claire-element-id="432156">Le binding (ou liaison de données) est un moyen de lier des données à un contrôle. Cela permet de positionner automatiquement des valeurs aux propriétés des contrôles en fonction du contenu de la source de données. En effet, il est très fréquent de mettre des valeurs dans des TextBox ou dans des Label comme nous l’avons fait. Le binding est là pour faciliter tout ce qui peut être automatisable et risque d’erreurs. De plus, si la source de données change, il est possible de faire en sorte que le contrôle soit automatiquement mis à jour. Inversement, si des modifications sont faites depuis l’interface, alors on peut être notifié automatiquement des changements. <br/> Pour illustrer son fonctionnement le plus simple, nous allons ajouter un contrôle de type ListBox à notre fenêtre de manière à ce que notre fenêtre contienne une ListBox et un label.<br/> Puis nous allons modifier le code behind de la fenêtre pour avoir :</p><pre id="r-432157" data-claire-element-id="432157"><code data-claire-semantic="csharp">public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        listBox1.ItemsSource = new List&lt;string&gt; { &quot;Nicolas&quot;, &quot;Jérémie&quot;, &quot;Delphine&quot; };
    }
}</code></pre><p id="r-432158" data-claire-element-id="432158">Lorsque nous démarrons l’application, nous pouvons voir que la ListBox s’est alimentée avec les valeurs de notre liste. Ici, c’est la propriété ItemsSource du contrôle qui va permettre la liaison de données. En fait, la propriété ItemsSource peut recevoir n’importe qu’elle source de données tant qu’elle implémente IEnumerable ou sa version générique. Cela peut être une requête Linq, issue d’une base de données ou non, ou simplement une liste comme ci-dessus. Cela donne :</p><figure id="r-432160" data-claire-element-id="432161"><img id="r-432159" data-claire-element-id="432159" src="medias/uploads.siteduzero.com_files_356001_357000_356724.png" alt="Image utilisateur"/></figure><p id="r-432162" data-claire-element-id="432162">Ici, nous lions les données à une source de données grâce au code behind. Il n’y a rien d’autre à faire, c’est le contrôle qui se charge tout seul d’afficher les données.<br/> Ce genre de binding peut également se faire directement depuis le XAML et de manière plus ou moins complexe. <br/> Illustrons ce fonctionnement en changeant le XAML du contrôle Label pour que sa propriété Content ressemble à :</p><pre id="r-432163" data-claire-element-id="432163"><code data-claire-semantic="xml">&lt;Label Content=&quot;{Binding ElementName=listBox1, Path=SelectedItem}&quot; Height=&quot;28&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;261,71,0,0&quot; Name=&quot;label2&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;230&quot; Foreground=&quot;Red&quot; /&gt;</code></pre><p id="r-432164" data-claire-element-id="432164">C'est-à-dire modifier Content de cette façon :</p><pre id="r-432165" data-claire-element-id="432165"><code data-claire-semantic="xml">Content=&quot;{Binding ElementName=listBox1, Path=SelectedItem}&quot;</code></pre><p id="r-432166" data-claire-element-id="432166">Cette syntaxe permet d’indiquer ici que nous souhaitons lier l’élément sélectionné de la listbox au contenu du label. Nous utilisons les accolades pour indiquer la liaison de données. Ici, la liaison se produit sur la propriété SelectedItem de la ListBox « listBox1 ».<br/> Cela veut dire que lorsque nous allons démarrer l’application et sélectionner un élément de la ListBox, sa valeur va automatiquement s’afficher dans le label :</p><figure id="r-432168" data-claire-element-id="432169"><img id="r-432167" data-claire-element-id="432167" src="medias/uploads.siteduzero.com_files_356001_357000_356725.png" alt="Image utilisateur"/></figure><p id="r-432170" data-claire-element-id="432170">Plutôt pratique non ?<br/> Le binding est une très vaste notion absolument indispensable pour toute application qui se respecte. A noter qu’il y a plusieurs modes de liaison :</p><table id="r-432198" data-claire-element-id="432198"><thead id="r-432176" data-claire-element-id="432176"><tr id="r-432175" data-claire-element-id="432175"><th id="r-432172" data-claire-element-id="432172"><p id="r-432171" data-claire-element-id="432171">Binding</p></th><th id="r-432174" data-claire-element-id="432174"><p id="r-432173" data-claire-element-id="432173">Description</p></th></tr></thead><tbody id="r-432197" data-claire-element-id="432197"><tr id="r-432181" data-claire-element-id="432181"><td id="r-432178" data-claire-element-id="432178"><p id="r-432177" data-claire-element-id="432177">OneTime</p></td><td id="r-432180" data-claire-element-id="432180"><p id="r-432179" data-claire-element-id="432179">La liaison se fait une unique fois au début. Si un changement se fait sur la source de données, on ne voit pas les modifications</p></td></tr><tr id="r-432186" data-claire-element-id="432186"><td id="r-432183" data-claire-element-id="432183"><p id="r-432182" data-claire-element-id="432182">One-way</p></td><td id="r-432185" data-claire-element-id="432185"><p id="r-432184" data-claire-element-id="432184">La liaison ne se fait que dans un sens, de la source de données vers le contrôle. C’est celui que nous avons vu plus haut.</p></td></tr><tr id="r-432191" data-claire-element-id="432191"><td id="r-432188" data-claire-element-id="432188"><p id="r-432187" data-claire-element-id="432187">Two-way</p></td><td id="r-432190" data-claire-element-id="432190"><p id="r-432189" data-claire-element-id="432189">La liaison se fait dans les deux sens. Cela veut dire qu’une modification dans l’interface se répercute automatiquement sur la source de données.</p></td></tr><tr id="r-432196" data-claire-element-id="432196"><td id="r-432193" data-claire-element-id="432193"><p id="r-432192" data-claire-element-id="432192">One-way-to-source</p></td><td id="r-432195" data-claire-element-id="432195"><p id="r-432194" data-claire-element-id="432194">C’est le contraire du one-way, si la valeur du contrôle change, la source est mise à jour.</p></td></tr></tbody></table><p id="r-432199" data-claire-element-id="432199">Il y a beaucoup de binding différents. Nous avons vu ici comment se lier à une liste à partir du code behind et comme lier une propriété d’un contrôle à la propriété d’un autre. Si vous étudiez en détail les différents bindinds de WPF, vous pourrez voir toute la puissance de la liaison de données à travers de multiples exemples.</p><p id="r-432200" data-claire-element-id="432200">Voilà pour ce petit tour de WPF. Il y aurait énormément d’autres choses à dire mais j’espère vous avoir donné envie de vous y plonger encore plus. Vous pouvez faire tout ce qu’une application de gestion fait habituellement en tirant parti de toute la puissance de WPF.<br/> Notez qu’avant WPF existaient les applications Winforms. Il s’agissait de bibliothèques permettant de construire également des applications Windows graphiques. Winforms était une bibliothèque imparfaite créé rapidement pour permettre de créer des applications Windows avec .NET. WPF est son remplaçant et a tiré parti des erreurs de jeunesses des Winforms afin de proposer un framework puissant et mature.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c">Les différents types d&#039;applications pouvant être développées avec le C#</a>
</li>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
Créer une application Windows avec WPF
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
Créer une application web avec ASP.NET
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
Créer une application client riche avec Silverlight
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
Le graphisme et les jeux avec XNA
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
Créer une application mobile avec Windows Phone 7
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
Créer un service web avec WCF
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
<span class="next">Créer une application web avec ASP.NET</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="CreruneapplicationwebavecASP.NET"></a><h2>Créer une application web avec ASP.NET</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
<span class="arrow"></span>
<span class="next">Créer une application Windows avec WPF</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
<span class="next">Créer une application client riche avec Silverlight</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-432202" data-claire-element-id="432202">ASP.NET c’est la plateforme de Microsoft pour réaliser des applications web. C’est un peu comme PHP, sauf que, vous vous en doutez, ASP.NET s’appuie massivement sur le framework .NET. Et tout comme WPF, il s’agit de bibliothèques qui vont permettre de réaliser facilement son site web.</p><p id="r-432203" data-claire-element-id="432203">La première chose à savoir est qu’il est possible de réaliser son site web avec du C#. Forcément, sinon je n’en parlerai pas ici. <br/> La deuxième chose à savoir est qu’il existe 2 ASP.NET : l’ASP.NET WebForms et l’ASP.NET MVC. Je vais vous parler rapidement des deux, mais il faut savoir que ces deux versions se basent sur un socle commun qui offre toute la puissance de création d’applications web.</p><p id="r-432204" data-claire-element-id="432204">ASP.NET WebForms c’est tout un mécanisme qui permet de faciliter la création d’une application web en faisant comme si c’était une application Windows. C'est-à-dire que le framework s’occupe de gérer toute la persistance d’informations entre les différents états des pages alors que le protocole http est sans état. Il permet aussi de travailler avec une approche événementielle, comme une application Windows. Le premier but d’ASP.NET WebForms était de faire en sorte que les personnes qui avaient déjà fait du développement Windows (avec des langages comme le Visual Basic ou autre) puisse facilement faire du développement web, dans un contexte qui leur serait familier.</p><p id="r-432205" data-claire-element-id="432205">ASP.NET MVC est plus récent et offre une approche où le développeur doit bien connaitre tous les mécanismes du web. Il offre également une plus grande maitrise sur le rendu du site web. Enfin, il intègre par défaut tous les mécanismes éprouvés du fameux patron de conception (design pattern) MVC.<br/> On ne peut pas dire qu’ASP.NET WebForms soit mieux ou moins bien qu’ASP.NET MVC. Il s’agit de deux façons différentes de créer des sites web. Chacune a ses avantages et ses inconvénients. Par contre, les deux se basent sur un socle commun qui est le cœur d’ASP.NET.</p><p id="r-432206" data-claire-element-id="432206">Je vais vous présenter rapidement ici comment créer une petite application web avec ces deux ASP.NET.<br/> Mais tout d’abord, vous avez besoin d’un nouvel outil. C’est le Visual C# Express dédié au développement web. Il s’appelle Visual Web Developper Express que vous pouvez <a href="http://msdn.microsoft.com/fr-fr/gg699328">télécharger ici</a>. L’installation ne pose pas de problèmes particuliers. Il va vous demander d’utiliser le plateform installer et d’installer le SP1 de Visual Web Developper Express. L’outil installé, vous pouvez le démarrer et vous rendre compte qu’il ressemble beaucoup à Visual C# Express. C’est normal, c’est la version express de Visual Studio, dédiée au développement web.</p><h3 id="r-asp-net-webforms" data-claire-element-id="432269">ASP.NET WebForms</h3><p id="r-432207" data-claire-element-id="432207">Pour réaliser une application WebForms, il va falloir créer un nouveau projet grâce à Visual Web Developper Express, à savoir un projet « Application Web ASP.NET vide » :</p><figure id="r-432209" data-claire-element-id="432210"><img id="r-432208" data-claire-element-id="432208" src="medias/uploads.siteduzero.com_files_356001_357000_356726.png" alt="Image utilisateur"/></figure><p id="r-432211" data-claire-element-id="432211">Comme nous avons choisi l’application vide, Visual Web Developper Express ne nous ajoute qu’un fichier Web.config. C’est le fichier de configuration de l’application web. C’est comme le fichier app.config que nous avons déjà vu, sauf qu’il fonctionne pour les applications web.</p><p id="r-432212" data-claire-element-id="432212">La première chose à faire est de rajouter une page. Cliquez droit sur le projet et faites « Ajouter » puis « Nouvel élément ». Vous obtenez la liste de tout ce qu’on peut rajouter dans une application web. Choisissez le modèle « Web Form » et appelez le fichier MaPage.aspx. La webform est l’élément de base d’une application ASP.NET. Elle correspond à une page :</p><figure id="r-432214" data-claire-element-id="432215"><img id="r-432213" data-claire-element-id="432213" src="medias/uploads.siteduzero.com_files_356001_357000_356727.png" alt="Image utilisateur"/></figure><p id="r-432216" data-claire-element-id="432216">Cette page est représentée par plusieurs fichiers. Un premier fichier possède l’extension .aspx, c’est le fichier de description de la page. Sous ce fichier, il y a un autre fichier possédant l’extension .aspx.cs, c’est le fichier contenant le code behind de la page. Si vous avez compris le chapitre sur WPF, vous pouvez vous dire qu’ASP.NET fonctionne quasiment pareil. Enfin, il y a un dernier fichier aspx.desginer.cs dont nous parlerons plus tard.<br/> Le fichier ASPX va contenir toutes les balises nous permettant de construire notre page. Cette page sera un mélange de langage web (HTML, css, javascript) et de balises spécifiques à ASP.NET.<br/> Nous pouvons le constater lorsque cette page s’ouvre sur notre IDE, elle est composée de :</p><pre id="r-432217" data-claire-element-id="432217"><code data-claire-semantic="html">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;MaPage.aspx.cs&quot; Inherits=&quot;MonApplicationWeb.MaPage&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div&gt;
    
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-432218" data-claire-element-id="432218">Nous retrouvons les balises classiques d’une page HTML, par exemple la balise <code data-claire-semantic="html">&lt;html&gt;</code> ou encore la balise <code data-claire-semantic="html">&lt;body&gt;</code>.<br/> Comme pour une application Windows, une page ASP.NET est composée de contrôles. Parmi les contrôles basiques, on retrouve tous les contrôles classiques d’une page web, à savoir une zone de texte, un bouton, etc. <br/> Pour ajouter un contrôle, cliquez sur l’onglet « design » qui se trouve en bas de la fenêtre :</p><figure id="r-432220" data-claire-element-id="432221"><img id="r-432219" data-claire-element-id="432219" src="medias/uploads.siteduzero.com_files_356001_357000_356728.png" alt="Image utilisateur"/></figure><p id="r-432222" data-claire-element-id="432222">Nous retrouvons l’aperçu de notre page ainsi que la fameuse boite à outils. Faisons glisser un contrôle TextBox, un contrôle Button et un contrôle Label sur notre page, en passant à la ligne entre chaque, pour avoir :</p><figure id="r-432224" data-claire-element-id="432225"><img id="r-432223" data-claire-element-id="432223" src="medias/uploads.siteduzero.com_files_356001_357000_356729.png" alt="Image utilisateur"/></figure><p id="r-432226" data-claire-element-id="432226">Si nous rebasculons sur le code source en cliquant sur l’onglet « Source » en bas du designer, nous pouvons voir que la page ASPX s’est enrichie :</p><pre id="r-432227" data-claire-element-id="432227"><code data-claire-semantic="html">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;MaPage.aspx.cs&quot; Inherits=&quot;MonApplicationWeb.MaPage&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div&gt;
    
    &lt;/div&gt;
    &lt;asp:TextBox ID=&quot;TextBox1&quot; runat=&quot;server&quot;&gt;&lt;/asp:TextBox&gt;
    &lt;br /&gt;
    &lt;asp:Button ID=&quot;Button1&quot; runat=&quot;server&quot; Text=&quot;Button&quot; /&gt;
    &lt;br /&gt;
    &lt;asp:Label ID=&quot;Label1&quot; runat=&quot;server&quot; Text=&quot;Label&quot;&gt;&lt;/asp:Label&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-432228" data-claire-element-id="432228">Elle possède des balises supplémentaires préfixées par « asp: » et qui possèdent un attribut spécifique, l’attribut runat=&quot;server&quot;. Cela veut dire que tous les contrôles qui possèdent cet attribut sont gérés par ASP.NET. Cela veut aussi dire que dans le fichier designer.cs va être généré du code permettant de manipuler ces contrôles grâce à une variable du même nom que l’attribut ID de la balise, comme avec WPF. Retournons dans le designer et sélectionnons le bouton pour aller voir ses propriétés dans la fenêtre du même nom. On retrouve l’onglet événement accessible via un petit éclair et notamment l’événement Click :</p><figure id="r-432230" data-claire-element-id="432231"><img id="r-432229" data-claire-element-id="432229" src="medias/uploads.siteduzero.com_files_356001_357000_356730.png" alt="Image utilisateur"/></figure><p id="r-432232" data-claire-element-id="432232">Vous vous en doutez, grâce à ça, nous pourrons gérer le clic sur le bouton.<br/> Après avoir saisi un nom de méthode, l’IDE nous génère le prototype de la méthode qui sera appelée lors de ce fameux clic sur le bouton :</p><pre id="r-432233" data-claire-element-id="432233"><code data-claire-semantic="csharp">protected void OnClickBouton(object sender, EventArgs e)
{

}</code></pre><p id="r-432234" data-claire-element-id="432234">Retournons dans l’onglet « Source » du fichier ASPX. Comme c’est un mélange d’HTML et de code ASP.NET, il est possible de rajouter des balises HTML classique. Rajoutons par exemple un titre et un message pour avoir :</p><pre id="r-432235" data-claire-element-id="432235"><code data-claire-semantic="html">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;MaPage.aspx.cs&quot; Inherits=&quot;MonApplicationWeb.MaPage&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;h2&gt;Bienvenue dans ma première page&lt;/h2&gt;
    &lt;p&gt;Veuillez saisir votre nom :&lt;/p&gt;
    &lt;asp:TextBox ID=&quot;TextBox1&quot; runat=&quot;server&quot;&gt;&lt;/asp:TextBox&gt;
    &lt;br /&gt;
    &lt;asp:Button ID=&quot;Button1&quot; runat=&quot;server&quot; Text=&quot;Button&quot; onclick=&quot;OnClickBouton&quot; /&gt;
    &lt;br /&gt;
    &lt;asp:Label ID=&quot;Label1&quot; runat=&quot;server&quot; Text=&quot;Label&quot;&gt;&lt;/asp:Label&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-432236" data-claire-element-id="432236">Notons au passage le nouvel attribut onclick qui a été rajouté dans la balise &lt;asp:Button&gt;. Il correspond bien sûr à ce que nous avons fait plus haut dans le designer. Profitez-en pour changer l’attribut Text pour le remplacer par quelque chose de plus explicite, par exemple « Cliquez-moi » :</p><pre id="r-432237" data-claire-element-id="432237"><code data-claire-semantic="html">&lt;asp:Button ID=&quot;Button1&quot; runat=&quot;server&quot; Text=&quot;Cliquez-moi&quot; onclick=&quot;OnClickBouton&quot; /&gt;</code></pre><p id="r-432238" data-claire-element-id="432238">A noter que nous aurions pu changer cette propriété en utilisant la fenêtre de propriétés. C'est comme avec WPF, il est tout à fait possible de modifier le contenu directement dans la page ainsi que dans le designer. A chaque fois, les modifications sont répercutées dans l'autre mode.</p><p id="r-432239" data-claire-element-id="432239">Ouvrons à présent le code behind, nous voyons le code suivant :</p><pre id="r-432240" data-claire-element-id="432240"><code data-claire-semantic="csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace MonApplicationWeb
{
    public partial class MaPage : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void OnClickBouton(object sender, EventArgs e)
        {

        }
    }
}</code></pre><p id="r-432241" data-claire-element-id="432241">Nous pouvons voir que Visual Web Developper Express nous a généré une classe partielle du même nom que notre page ASPX qui hérite de l’objet Page. Ici, c’est comme avec WPF. Les bibliothèques d’ASP.NET proposent toute une hiérarchie d’objets et de contrôles dont hérite notre page. Les variables représentant les contrôles sont générés par l’IDE et sont visibles dans le fichier .designer.aspx. Nous allons pouvoir les utiliser.<br/> Remarquons qu’une méthode Page_Load a été générée. Elle sera exécutée lors du chargement de la page. Pour faire simple, lorsqu’on demande au serveur web d’afficher la page ASP.NET, elle va passer par tout un cycle de vie (initialisation, chargement, événements, etc.). Ici, le chargement de la page est le moment opportun pour faire les initialisations de contrôles.</p><p id="r-432242" data-claire-element-id="432242">Ce que nous voulons faire, c’est afficher un petit message lorsque l’utilisateur a saisi son nom dans la zone de texte et a cliqué sur le bouton. Donc, dans la méthode OnClickBouton, rajoutez :</p><pre id="r-432243" data-claire-element-id="432243"><code data-claire-semantic="csharp">protected void OnClickBouton(object sender, EventArgs e)
{
    Label1.Text = &quot;Bienvenue &quot; + TextBox1.Text;
}</code></pre><p id="r-432244" data-claire-element-id="432244">La variable Label1 correspond au contrôle <a href="http://msdn.microsoft.com/fr-fr/library/system.web.ui.webcontrols.label.aspx">Label</a> que nous avons positionné dans la page. Sa propriété ID donne le nom de la variable générée par Visual Web Developper Express représentant ce label. Si nous utilisons sa propriété Text, nous allons pouvoir modifier son contenu.</p><p id="r-432245" data-claire-element-id="432245">Si vous démarrez notre application web en appuyant sur <kbd>F5</kbd>, nous pouvons voir 2 choses. La première est que Visual Web Developper Express démarre un serveur web de développement qui est à l’écoute sur un certain port (ici 49161) :</p><figure id="r-432247" data-claire-element-id="432248"><img id="r-432246" data-claire-element-id="432246" src="medias/uploads.siteduzero.com_files_356001_357000_356731.png" alt="Image utilisateur"/></figure><p id="r-432249" data-claire-element-id="432249">C’est ce serveur web qui va recevoir les requêtes provenant du navigateur souhaitant afficher nos pages. <br/> La deuxième chose que nous observons est qu’il lance le navigateur par défaut et affiche notre page :</p><figure id="r-432251" data-claire-element-id="432252"><img id="r-432250" data-claire-element-id="432250" src="medias/uploads.siteduzero.com_files_356001_357000_356732.png" alt="Image utilisateur"/></figure><p id="r-432253" data-claire-element-id="432253">Waouh ! Notre première page ASP.NET. Bon, OK, il y a un petit défaut, un mot « Label » qui traine. Mais bon, nous allons y remédier :) .<br/> En attendant, saisissez votre nom et cliquez sur le bouton, nous obtenons :</p><figure id="r-432255" data-claire-element-id="432256"><img id="r-432254" data-claire-element-id="432254" src="medias/uploads.siteduzero.com_files_356001_357000_356733.png" alt="Image utilisateur"/></figure><p id="r-432257" data-claire-element-id="432257">Joli non ?<br/> Allons corriger le léger défaut que nous avons vu, pour cela plusieurs possibilités. Vous pouvez par exemple vider la propriété Text dans le designer ou directement dans le code ASPX. Sinon, nous pouvons utiliser l’événement Page_Load pour nous occuper d’initialiser cette propriété :</p><pre id="r-432258" data-claire-element-id="432258"><code data-claire-semantic="csharp">protected void Page_Load(object sender, EventArgs e)
{
    Label1.Text = string.Empty;
    Label1.ForeColor = System.Drawing.Color.Red;
}</code></pre><p id="r-432259" data-claire-element-id="432259">Vous aurez deviné que nous en profitons pour changer la couleur du label. Ainsi désormais, la page commence par s’afficher sans le détestable mot label, puis lorsque nous cliquons sur le bouton nous pouvons voir notre magnifique message en rouge :</p><figure id="r-432261" data-claire-element-id="432262"><img id="r-432260" data-claire-element-id="432260" src="medias/uploads.siteduzero.com_files_356001_357000_356734.png" alt="Image utilisateur"/></figure><p id="r-432263" data-claire-element-id="432263">Il y a plusieurs choses à constater ici.<br/> La première est que le navigateur s’est automatiquement mis à naviguer sur l’adresse <a href="http://localhost:49161/MaPage.aspx">http://localhost:49161/MaPage.aspx</a>. Localhost correspond, comme son nom le suggère, à l’adresse locale de notre serveur web de développement. Le port est ensuite précisé, 49161, on le retrouve dans les propriétés du projet (il est fortement probable qu’il soit différent chez vous). Enfin, nous affichons la page MaPage.aspx. Ici, le serveur web de développement est capable d’interpréter le contenu des pages ASPX, d’exécuter le code C# associé et de renvoyer du HTML.</p><p id="r-432264" data-claire-element-id="432264">Oui oui, du HTML, et c’est la deuxième chose à observer ici. Si vous affichez le code source de la page ainsi obtenue, vous aurez quelque chose du genre :</p><pre id="r-432265" data-claire-element-id="432265"><code data-claire-semantic="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
 
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head&gt;&lt;title&gt;
 
&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
    &lt;form method=&quot;post&quot; action=&quot;MaPage.aspx&quot; id=&quot;form1&quot;&gt;
&lt;div class=&quot;aspNetHidden&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;__VIEWSTATE&quot; id=&quot;__VIEWSTATE&quot; value=&quot;/wEPDwUKMjA3NjE4MDczNg9kFgICAw9kFgICBQ8PFgYeBFRleHQFDkJpZW52ZW51ZSBOaWNvHglGb3JlQ29sb3IKjQEeBF8hU0ICBGRkZOm2UWxQmTYP9JIwj/9vFRKLkD/KqzB9Coji6Z0mPGMH&quot; /&gt;
&lt;/div&gt;
 
&lt;div class=&quot;aspNetHidden&quot;&gt;
 
	&lt;input type=&quot;hidden&quot; name=&quot;__EVENTVALIDATION&quot; id=&quot;__EVENTVALIDATION&quot; value=&quot;/wEWAwKExaeOAwLs0bLrBgKM54rGBoVmaA4q8yMfbdrCcYzsO9mF4pSEGUXoCox5Mfs0s9wv&quot; /&gt;
&lt;/div&gt;
    &lt;h2&gt;Bienvenue dans ma première page&lt;/h2&gt;
    &lt;p&gt;Veuillez saisir votre nom :&lt;/p&gt;
    &lt;input name=&quot;TextBox1&quot; type=&quot;text&quot; value=&quot;Nico&quot; id=&quot;TextBox1&quot; /&gt;
    &lt;br /&gt;
    &lt;input type=&quot;submit&quot; name=&quot;Button1&quot; value=&quot;Cliquez-moi&quot; id=&quot;Button1&quot; /&gt;
    &lt;br /&gt;
    &lt;span id=&quot;Label1&quot; style=&quot;color:Red;&quot;&gt;Bienvenue Nico&lt;/span&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-432266" data-claire-element-id="432266">Ce qui est bel et bien du HTML. Les contrôles serveurs ont été transformés en HTML avec en complément, les éventuelles valeurs que nous avons mises à jour. Par exemple le TextBox a été transformé en balise <code data-claire-semantic="html">&lt;input type=&quot;text&quot; …/&gt;</code> (il y a aussi des valeurs bizarres, comme le viewstate, que je n’expliquerai pas dans cette introduction).</p><p id="r-432267" data-claire-element-id="432267">La troisième chose à constater est que lorsque nous avons cliqué sur le bouton, nous avons pu voir que la page s’était rechargée. On appelle cela un « postback », c’est l’action d’envoyer les informations de la page au serveur afin qu’il nous mette à jour la page. Les informations envoyées sont les éléments du formulaire HTML (comme la valeur de la TextBox). Ainsi, ASP.NET est capable de traiter la valeur du TextBox envoyée (le prénom) et de la réafficher dans une autre zone, le Label.</p><p id="r-432268" data-claire-element-id="432268">On va s’arrêter là pour ce petit tour d’ASP.NET WebForms. A noter que tout est fait pour faire en sorte que le développeur ait l’impression qu’il développe une application événementielle, comme sous Windows. Avec ASP.NET, les mécanismes de binding évolués sont également présents ainsi que la possibilité de facilement faire de l’AJAX, très à la mode. Bref, nous avons ici tout un lot de fonctionnalités permettant de construire des applications web professionnelles.</p><h3 id="r-asp-net-mvc" data-claire-element-id="432354">ASP.NET MVC</h3><p id="r-432270" data-claire-element-id="432270">ASP.NET MVC n’est pas le remplaçant d’ASP.NET WebForms, malgré sa plus récente mise en place et les nombreux efforts fait par Microsoft pour que cette plateforme soit rapidement mature. Il s’agit bel et bien d’une autre façon de réaliser des applications web, dans un cadre plus structuré et laissant la place à plus de maitrise sur le rendu html. <br/> Plus structuré car bénéficiant nativement du support du patron de conception MVC, qui signifie <strong>Model View Controler</strong>. Il s’agit d’une modélisation ayant fait ses preuves depuis de nombreuses années qui permet d’architecturer une application web en séparant les données (Model) de leur rendu (View) et de la logique métier (Controler). C’est une façon efficace d’architecturer son application web permettant de limiter les interactions entre ces différentes couches, évitant les fameux plats de spaghetti où la moindre modification entraine des modifications en chaines à plusieurs endroits.<br/> Le rendu HTML est mieux maitrisé également mais nécessitant plus de connaissances HTML. Ici, nous travaillons directement avec le code HTML et non pas avec des contrôles comme avec ASP.NET WebForms. Le code ASPX contient non seulement du HTML mais aussi directement du code C#.</p><p id="r-432271" data-claire-element-id="432271">Pour commencer, nous avons besoin de créer un nouveau projet de type « Application web ASP.NET MVC 3 » :</p><figure id="r-432273" data-claire-element-id="432274"><img id="r-432272" data-claire-element-id="432272" src="medias/uploads.siteduzero.com_files_356001_357000_356735.png" alt="Image utilisateur"/></figure><p id="r-432275" data-claire-element-id="432275">Un assistant apparait pour nous aider au paramétrage de notre projet :</p><figure id="r-432277" data-claire-element-id="432278"><img id="r-432276" data-claire-element-id="432276" src="medias/uploads.siteduzero.com_files_356001_357000_356736.png" alt="Image utilisateur"/></figure><p id="r-432279" data-claire-element-id="432279">Partons sur un modèle vide et sur un moteur de vue ASPX. Ici, le choix est important. ASP.NET MVC propose différents moteurs permettant d’interpréter le code des vues, c'est-à-dire le code des pages. Nous pourrions donc écrire la même page avec deux « langages » différents. Razor est un moteur de vue plutôt pratique à utiliser, optimisé pour ASP.NET MVC, mais nécessitant un apprentissage de sa syntaxe particulière. Nous allons utiliser ici le moteur de vue ASPX pour que cela soit plus simple.</p><p id="r-432280" data-claire-element-id="432280">L’IDE nous génère donc notre solution avec plusieurs choses dedans. Ce qui nous intéresse surtout c’est de constater qu’il y a une arborescence avec un répertoire « Controllers », un répertoire « Models » et un répertoire « Views ». Vous l’aurez deviné, c’est ici que nous devrons mettre nos contrôleurs, nos modèles et nos vues. Le fait de mettre directement les bons éléments aux bons endroits permet d’éviter de la configuration supplémentaire car un des mots d’ordre de ce framework est de préférer les conventions à la configuration. Donc si le moteur ASP.NET MVC sait où chercher les infos, ça sera plus simple pour tout le monde ;) .</p><aside id="r-432282" data-claire-element-id="432282" data-claire-semantic="information"><p id="r-432281" data-claire-element-id="432281">A noter que dans les grosses applications, nous aurons intérêt à ne pas suivre cette convention et à regrouper les contrôleurs ou vues dans des assemblys différentes. A ce moment-là, de la configuration sera nécessaire.</p></aside><p id="r-432283" data-claire-element-id="432283">D’autres répertoires sont créés, comme le répertoire scripts qui permet de regrouper tous les bibliothèques javascript, comme JQuery. Le répertoire Content permet de mettre les images, les css, etc.</p><p id="r-432284" data-claire-element-id="432284">Commençons par créer un modèle archi-basique. Pour rappel, il s’agit de tout ce qui va permettre d’accéder aux données de notre application, typiquement ce qui est généré par Entity Framework et notre couche d’accès aux données. Pour les besoins de cette démo, je vais simplement créer une classe Personne dans le répertoire Models :</p><pre id="r-432285" data-claire-element-id="432285"><code data-claire-semantic="csharp">namespace MonApplicationWebMvc.Models
{
    public class Personne
    {
        public int Id { get; set; }
        public string Nom { get; set; }
        public int Age { get; set; }
    }
}</code></pre><p id="r-432286" data-claire-element-id="432286">Nous avons besoin ensuite d’un contrôleur. Les contrôleurs s’occupent de traiter les requêtes faites au serveur web. Dans une application classique les requêtes correspondent en général à un fichier sur le serveur. Nous avons par exemple vu dans l’exemple précédent utilisant ASP.NET WebForms que nous avons créé un fichier MaPage.aspx et que nous y accédons avec l’url <a href="http://localhost:49161/MaPage.aspx">http://localhost:49161/MaPage.aspx</a>. Avec ASP.NET MVC, ce n’est pas le cas. Les urls font référence à des méthodes de classes : les classes contrôleurs. <br/> Créons donc un nouveau contrôleur. Pour cela, créez un répertoire « Bonjour » dans le répertoire Controllers (je vais vous expliquer dans un instant pourquoi), puis faites un clic-droit sur ce répertoire Bonjour et choisissez « Ajouter », « Contrôleur » :</p><figure id="r-432288" data-claire-element-id="432289"><img id="r-432287" data-claire-element-id="432287" src="medias/uploads.siteduzero.com_files_356001_357000_356737.png" alt="Image utilisateur"/></figure><p id="r-432290" data-claire-element-id="432290">Nommez ce contrôleur BonjourController et choisissez pour modèle un contrôleur vide :</p><figure id="r-432292" data-claire-element-id="432293"><img id="r-432291" data-claire-element-id="432291" src="medias/uploads.siteduzero.com_files_356001_357000_356738.png" alt="Image utilisateur"/></figure><p id="r-432294" data-claire-element-id="432294">Visual Web Developper Express nous génère la classe suivante :</p><pre id="r-432295" data-claire-element-id="432295"><code data-claire-semantic="csharp">public class BonjourController : Controller
{
    //
    // GET: /Index/

    public ActionResult Index()
    {
        return View();
    }
}</code></pre><p id="r-432296" data-claire-element-id="432296">Ce contrôleur hérite des fonctionnalités de la classe <a href="http://msdn.microsoft.com/fr-fr/library/system.web.mvc.controller.aspx">Controller</a> du framework ASP.NET MVC et défini une action Index, sous la forme d’une méthode retournant un objet de type ActionResult.<br/> Cela veut dire que nous pourrons accéder à cette action grâce à l’url <a href="http://localhost:port/Bonjour/Index">http://localhost:port/Bonjour/Index</a>.<br/> Pourquoi cette url ? Grâce au mécanisme de routage d’ASP.NET MVC. Ce mécanisme s’occupe d’interpréter l’url et d’exécuter l’action correspondante. Ce moteur de routage est complètement configurable, mais l’IDE nous a généré une règle par défaut que nous pouvons retrouver dans le fichier global.asax.cs et notamment la méthode RegisterRoutes :</p><pre id="r-432297" data-claire-element-id="432297"><code data-claire-semantic="csharp">public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute(&quot;{resource}.axd/{*pathInfo}&quot;);

    routes.MapRoute(
        &quot;Default&quot;, // Nom d'itinéraire
        &quot;{controller}/{action}/{id}&quot;, // URL avec des paramètres
        new { controller = &quot;Home&quot;, action = &quot;Index&quot;, id = UrlParameter.Optional } // Paramètres par défaut
    );
}</code></pre><p id="r-432298" data-claire-element-id="432298">Ici ce qu’il est intéressant de voir, c’est que la route par défaut fait en sorte qu’une url sous la forme {contrôleur}/{action}/{id} est automatiquement associée à l’instanciation d’un contrôleur dont le nom est {contrôleur} et à l’appel de la méthode {action} avec éventuellement un paramètre.<br/> Ce qui fait que lorsque nous souhaitons appeler notre méthode Index de la classe BonjourController, nous allons devoir utiliser la route <a href="http://localhost:port/Bonjour/Index">http://localhost:port/Bonjour/Index</a>.<br/> A noter qu’il est inutile de suffixer le nom dans l’url du contrôleur par le mot Controller. En effet, la convention de nommage fait qu’un contrôleur doit être suffixé par Controller. Pour être trouvé convenablement, ce contrôleur doit se trouver dans un sous-répertoire du même nom.<br/> Ici, la méthode Index sera appelée lorsque nous allons faire des requêtes de type GET. Cette méthode va renvoyer une vue par défaut, grâce à la méthode View(). En fait, cette méthode va renvoyer la vue qui porte le nom par défaut Index et qui sera située dans le répertoire du même nom que le contrôleur. Pour le vérifier, vous pouvez démarrer notre projet en appuyant sur <kbd>F5</kbd> et en naviguant sur <a href="http://localhost:49203/Bonjour/Index/">http://localhost:49203/Bonjour/Index/</a> (chez moi le port attribué à mon projet est 49203). Vous obtenez une exception indiquant :</p><p id="r-432299" data-claire-element-id="432299"><cite>Citation : Page erreur</cite></p><blockquote id="r-432301" data-claire-element-id="432301"><p id="r-432300" data-claire-element-id="432300">La vue 'Index' ou son maître est introuvable, ou aucun moteur de vue ne prend en charge les emplacements où est effectuée la recherche. La recherche a porté sur les emplacements suivants : <br/> ~/Views/Bonjour/Index.aspx<br/> ~/Views/Bonjour/Index.ascx<br/> ~/Views/Shared/Index.aspx<br/> ~/Views/Shared/Index.ascx<br/> ~/Views/Bonjour/Index.cshtml<br/> ~/Views/Bonjour/Index.vbhtml<br/> ~/Views/Shared/Index.cshtml<br/> ~/Views/Shared/Index.vbhtml</p></blockquote><p id="r-432302" data-claire-element-id="432302">C’est même un peu plus compliqué. Il commence par chercher dans ce répertoire, puis ensuite il va vérifier dans le répertoire partagé (Shared) s’il trouve quelque chose, etc. <br/> Nous avons donc besoin de créer une vue à cet emplacement. <br/> Si vous n’avez pas démarré le projet, il faut maintenant que vous compiliez l’application. En effet, pour la suite nous allons avoir besoin que la classe Personne soit compilée.<br/> C’est le moment d’ajouter une vue. La vue est liée au modèle et pour simplifier les développements, il est possible de la lier directement à un modèle déjà présent dans l’application.<br/> Retournez dans le code du contrôleur et faites un clic-droit dans le code de la méthode Index(). Visual Web Developper nous propose d’ajouter une vue :</p><figure id="r-432304" data-claire-element-id="432305"><img id="r-432303" data-claire-element-id="432303" src="medias/uploads.siteduzero.com_files_356001_357000_356739.png" alt="Image utilisateur"/></figure><p id="r-432306" data-claire-element-id="432306">Gardez le nom Index ainsi que le moteur de vue « ASPX ». Puis cochez « Créer une vue fortement typée » et allez choisir dans la liste déroulante le nom de notre classe de modèle. Décochez également l’utilisation de la page maître :</p><figure id="r-432308" data-claire-element-id="432309"><img id="r-432307" data-claire-element-id="432307" src="medias/uploads.siteduzero.com_files_356001_357000_356740.png" alt="Image utilisateur"/></figure><p id="r-432310" data-claire-element-id="432310">Visual Web Developper Express nous crée donc une vue vide associée à notre modèle. Il s’agit d’un fichier portant l’extension .aspx automatiquement situé dans le répertoire Views/Bonjour et qui s’appelle Index.aspx. On a vu que c’était cette vue dont on avait besoin, ça tombe bien. Cette page ASPX ressemble énormément à une page HTML :</p><pre id="r-432311" data-claire-element-id="432311"><code data-claire-semantic="html">&lt;%@ Page Language=&quot;C#&quot; Inherits=&quot;System.Web.Mvc.ViewPage&lt;MonApplicationWebMvc.Models.Personne&gt;&quot; %&gt;

&lt;!DOCTYPE html&gt;

&lt;html&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;Index&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div&gt;
        
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p id="r-432312" data-claire-element-id="432312">On voit seulement que la vue est liée à la classe personne grâce au type dont elle hérite : System.Web.Mvc.ViewPage&lt;MonApplicationWebMvc.Models.Personne&gt;. Il s’agit d’une classe générique du framework ASP.NET MVC typée avec notre classe de modèle.<br/> Nous allons maintenant garnir un peu notre page. Cela se fait en utilisant les balises HTML mais aussi avec des helper HTML qui permettent de générer le code du contrôle HTML. Par exemple, ajoutons dans la balise <code data-claire-semantic="html">&lt;body&gt;</code> :</p><pre id="r-432313" data-claire-element-id="432313"><code data-claire-semantic="html">&lt;body&gt;
    &lt;%using (Html.BeginForm())
    {
    %&gt;
        &lt;h2&gt;Bienvenue dans ma première page&lt;/h2&gt;
        &lt;p&gt;Veuillez saisir votre nom :&lt;/p&gt;
        &lt;% =Html.TextBox(&quot;NomPersonne&quot;, Model.Nom) %&gt;
        &lt;br /&gt;
        &lt;input type=&quot;submit&quot; value=&quot;click&quot; /&gt;
    &lt;%
    } %&gt;
    &lt;br /&gt;
    &lt;span style=&quot;color:red&quot;&gt;&lt;%=ViewData[&quot;MessageBienvenue&quot;]%&gt;&lt;/span&gt;
&lt;/body&gt;</code></pre><p id="r-432314" data-claire-element-id="432314">Nous utilisons les scriptlets &lt;% et %&gt; pour ajouter du code C#. En l’occurrence ici nous commençons par faire de notre page un formulaire HTML grâce au code &lt;%using (Html.BeginForm()).<br/> Grâce à ce helper, il va générer la balise <code data-claire-semantic="html">&lt;form&gt;</code> ainsi que les attributs qui vont bien pour notre vue. Nous ajoutons ensuite du HTML classique pour afficher le message de bienvenue.<br/> Ensuite, le helper Html.TextBox va permettre de générer une zone de texte qui portera le nom NomPersonne et qui sera associée à la propriété Nom de notre classe de modèle, représentée ici par la variable propriété Model. Ensuite nous rajoutons une balise de type input submit pour valider notre formulaire.<br/> Enfin, nous ajoutons une balise <code data-claire-semantic="html">&lt;span&gt;</code> qui va contenir un message. Nous allons voir plus tard comment positionner ce message.</p><p id="r-432315" data-claire-element-id="432315">Nous avons donc pu constater que la vue possédait une propriété Model qui était du type de notre classe Personne. De plus, la complétion automatique est là pour nous aider :</p><figure id="r-432317" data-claire-element-id="432318"><img id="r-432316" data-claire-element-id="432316" src="medias/uploads.siteduzero.com_files_356001_357000_356741.png" alt="Image utilisateur"/></figure><p id="r-432319" data-claire-element-id="432319">Comment la vue obtient-elle le modèle adéquat ?</p><p id="r-432320" data-claire-element-id="432320">En fait, c’est tout simple. Le model est passé en paramètre à la vue lorsqu’on renvoi le résultat de l’action du contrôleur. Pour l’instant, notre action retourne :</p><pre id="r-432321" data-claire-element-id="432321"><code data-claire-semantic="csharp">public ActionResult Index()
{
    return View();
}</code></pre><p id="r-432322" data-claire-element-id="432322">C'est-à-dire la vue par défaut, sans modèle. Nous pouvons utiliser une surcharge de cette méthode pour lui passer le modèle qui nous intéresse. En l’occurrence, nous allons renvoyer un objet vide car nous n’avons aucun modèle à retourner dans la mesure où c’est la première fois que nous affichons la page :</p><pre id="r-432323" data-claire-element-id="432323"><code data-claire-semantic="csharp">public ActionResult Index()
{
    return View(new Personne());
}</code></pre><p id="r-432324" data-claire-element-id="432324">Démarrons notre application web en appuyant sur <kbd>F5</kbd>. Comme pour ASP.NET WebForms, un serveur web de développement démarre pour héberger notre application ainsi que notre navigateur par défaut. Le navigateur essaie d’afficher la page qui se trouve à l’emplacement : <a href="http://localhost:49203/">http://localhost:49203/</a>, sachant que le port choisi par Visual Web Developper Express chez moi est le 49203. Le navigateur nous affiche une page d’erreur indiquant que la page est introuvable :</p><figure id="r-432326" data-claire-element-id="432327"><img id="r-432325" data-claire-element-id="432325" src="medias/uploads.siteduzero.com_files_356001_357000_356742.png" alt="Image utilisateur"/></figure><p id="r-432328" data-claire-element-id="432328">En effet, nous n’avons pas indiqué la route qui correspond à une action de notre contrôleur. Rappelez-vous, nous devons taper l’url suivante : <a href="http://localhost:49203/Bonjour/Index">http://localhost:49203/Bonjour/Index</a> pour pouvoir appeler la méthode Index du contrôleur BonjourController. Nous obtenons la page suivante qui correspond à la vue que nous avons créé :</p><figure id="r-432330" data-claire-element-id="432331"><img id="r-432329" data-claire-element-id="432329" src="medias/uploads.siteduzero.com_files_356001_357000_356743.png" alt="Image utilisateur"/></figure><p id="r-432332" data-claire-element-id="432332">Si je saisi mon nom et que je clique sur le bouton, ma vue se réaffiche, par contre la zone de texte est vide. Pour pouvoir la remplir, il faut faire plusieurs choses.<br/> La première est d’exécuter une nouvelle action de notre contrôleur pour répondre au click. Pour cela, nous allons créer une action qui sera appelée lors de la soumission du formulaire, c'est-à-dire lorsque l’on poste la page. La seconde chose à faire est de récupérer la valeur saisie dans la zone de texte et la troisième sera de construire notre modèle avec cette valeur. Cela donne :</p><pre id="r-432333" data-claire-element-id="432333"><code data-claire-semantic="csharp">public class BonjourController : Controller
{
    //
    // GET: /Bonjour/
    public ActionResult Index()
    {
        return View(new Personne());
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Index(Personne personne)
    {
        string prenom = Request.Form[&quot;NomPersonne&quot;];

        return View(&quot;Index&quot;, new Personne { Nom = prenom });
    }
}</code></pre><p id="r-432334" data-claire-element-id="432334">Ici, nous avons rajouté une surcharge de la méthode Index, prenant une personne en paramètre (que nous n’utiliserons pas ici). Cette méthode est décorée de l’attribut AcceptVerbs contenant la méthode POST. C’est grâce à cela que nous indiquons à ASP.NET MVC d’exécuter cette méthode lors de la soumission du formulaire. Ensuite, nous récupérons la valeur saisie dans la zone de texte grâce à l’objet Request.Form en lui passant en paramètre le nom de la zone de texte ; rappelez-vous, cela correspond à ce que nous avons mis dans la vue :</p><pre id="r-432335" data-claire-element-id="432335"><code data-claire-semantic="html">&lt;% =Html.TextBox(&quot;NomPersonne&quot;, Model.Nom) %&gt;</code></pre><p id="r-432336" data-claire-element-id="432336">Une fois ce prénom récupéré, nous pouvons le passer dans notre modèle. Ce qui fait que si nous ré-exécutons notre application web en appuyant sur <kbd>F5</kbd>, et que nous saisissons un nom et que nous soumettons le formulaire, nous pouvons voir que la zone de texte est remplie une fois que la page est réaffichée :</p><figure id="r-432338" data-claire-element-id="432339"><img id="r-432337" data-claire-element-id="432337" src="medias/uploads.siteduzero.com_files_356001_357000_356744.png" alt="Image utilisateur"/></figure><p id="r-432340" data-claire-element-id="432340">Notre modèle est donc bien pris en compte.</p><div id="r-432342" data-claire-element-id="432342" data-claire-semantic="question"><p id="r-432341" data-claire-element-id="432341">C’est bien, mais n’est-ce pas un peu compliqué ? Avec ASP.NET WebForms il n’y avait rien à faire, tout était pris en charge par le framework. Je ne vois pas trop l’intérêt d’ASP.NET MVC.</p></div><p id="r-432343" data-claire-element-id="432343">Le premier intérêt est vraiment la séparation des intentions en différentes couches, le modèle, la vue et le contrôleur. La vue ne s’occupe que d’afficher des données, c'est-à-dire qu’elle ne doit jamais aller chercher des informations, ni faire de règles métiers. Juste de la présentation. Aller chercher le modèle, exécuter les règles métiers, ça c’est le rôle du contrôleur. Cela veut dire qu’il faut un moyen pour passer des informations du contrôleur à la vue. <br/> Nous avons vu que le contrôleur fournissait déjà un accès au modèle, c’est déjà ça. Mais nous avons besoin de plus. C’est le rôle du dictionnaire « ViewData ». C’est une propriété du contrôleur qui est accessible depuis la vue. On peut mettre des informations accessibles via une clé, que l’on peut récupérer dans la vue pour les mettre en forme.</p><p id="r-432344" data-claire-element-id="432344">Par exemple, pour rajouter un petit message de bienvenue, nous pouvons utiliser une propriété de ce dictionnaire, « MessageBienvenue », où je mets un message accompagné du prénom récupéré :</p><pre id="r-432345" data-claire-element-id="432345"><code data-claire-semantic="csharp">[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(Personne personne)
{
    string prenom = Request.Form[&quot;NomPersonne&quot;];

    ViewData[&quot;MessageBienvenue&quot;] = &quot;Bienvenue &quot; + prenom;
    return View(&quot;Index&quot;, new Personne { Nom = prenom });
}</code></pre><p id="r-432346" data-claire-element-id="432346">Pour récupérer ce message depuis la vue, rien de plus simple. Il suffit d’accéder à cette propriété, avec par exemple :</p><pre id="r-432347" data-claire-element-id="432347"><code data-claire-semantic="html">&lt;span style=&quot;color:red&quot;&gt;&lt;%=ViewData[&quot;MessageBienvenue&quot;]%&gt;&lt;/span&gt;</code></pre><p id="r-432348" data-claire-element-id="432348">Nous constatons qu’ici j’affiche le message à l’intérieur d’une balise <code data-claire-semantic="html">&lt;span&gt;</code>. Relançons notre application web et cette fois-ci, lorsque nous soumettons le formulaire, nous pouvons constater l’apparition du message tant attendu :</p><figure id="r-432350" data-claire-element-id="432351"><img id="r-432349" data-claire-element-id="432349" src="medias/uploads.siteduzero.com_files_356001_357000_356745.png" alt="Image utilisateur"/></figure><p id="r-432352" data-claire-element-id="432352">Et voilà, ça déchire non ? :D</p><p id="r-432353" data-claire-element-id="432353">Nous en avons fini avec ce premier aperçu d’ASP.NET MVC. ASP.NET MVC fourni un cadre structuré permettant la réalisation d’applications web. La séparation stricte des intentions dès la création de l’application permet d’éviter de se retrouver par mégarde avec du code spaghetti et facilite les opérations de maintenance du code. Cette séparation force le développeur à correctement architecturer son application et l’incite à ne pas faire n’importe quoi. De plus, cela lui permet de faire des tests automatiques de ses contrôleurs.<br/> Vous avez pu constater qu’ASP.NET WebForms et ASP.NET MVC permettaient tous les deux de réaliser des applications web. Chacun a une philosophie différente et nous avons commencé à voir quelles en étaient les subtilités. A vous de choisir celui qui vous convient le mieux.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c">Les différents types d&#039;applications pouvant être développées avec le C#</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
Créer une application Windows avec WPF
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
Créer une application web avec ASP.NET
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
Créer une application client riche avec Silverlight
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
Le graphisme et les jeux avec XNA
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
Créer une application mobile avec Windows Phone 7
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
Créer un service web avec WCF
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
<span class="arrow"></span>
<span class="next">Créer une application Windows avec WPF</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
<span class="next">Créer une application client riche avec Silverlight</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="CreruneapplicationclientricheavecSilverlight"></a><h2>Créer une application client riche avec Silverlight</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
<span class="arrow"></span>
<span class="next">Créer une application web avec ASP.NET</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
<span class="next">Le graphisme et les jeux avec XNA</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-432356" data-claire-element-id="432356">Nous avons vu les applications clientes lourdes, comme les applications console ou les applications WPF. Nous avons également vu les applications web, avec ASP. NET WebForms ou ASP.NET MVC. Il existe quelque chose entre les deux, ce sont les applications dites « client riche ». Ce sont des applications qui ressemblent à des applications lourdes, mais qui s’exécutent à l’intérieur d’un navigateur internet plutôt que directement au niveau du système d’exploitation.<br/> Vous connaissez surement le très célèbre « flash », très populaire grâce à la multitude de jeux disponibles sur internet. Microsoft possède également des bibliothèques permettant de réaliser des applications clients riches : <strong>Silverlight</strong>.</p><p id="r-432357" data-claire-element-id="432357">Une application cliente riche s’exécute donc directement dans un navigateur internet, comme internet explorer, firefox ou chrome. Ces applications s’exécutent dans un plugin du navigateur. Pour exécuter des applications flash ou des applications Silverlight, le navigateur devra posséder le plugin adéquat. Du fait qu’elles s’exécutent dans un navigateur, ces applications ont quelques restrictions. Elles ne peuvent par défaut pas accéder au contenu du disque dur de l’utilisateur, ce qui est finalement plutôt pas mal pour une application disponible directement sur internet. Elles s’exécutent uniquement dans la zone mémoire du navigateur, une espèce de bac à sable dont on ne peut pas s’échapper et où il est impossible d’accéder aux ressources directes de l’ordinateur sur lequel s’exécute l’application, au contraire des applications WPF par exemple.<br/> Ces applications clientes riches ressemblent énormément aux applications clientes lourdes avec quelques restrictions. Silverlight est donc une espèce de WPF allégé qui ne garde que l’essentiel de l’essentiel. Nous serons donc capables de réaliser des applications s’exécutant dans notre navigateur grâce au C# et au XAML.</p><p id="r-432358" data-claire-element-id="432358">Pour commencer, nous devons démarrer Visual Web Developper Express et choisir un modèle de projet « Application Silverlight », que nous nommons MonApplicationSilverlight :</p><figure id="r-432360" data-claire-element-id="432361"><img id="r-432359" data-claire-element-id="432359" src="medias/uploads.siteduzero.com_files_356001_357000_356746.png" alt="Image utilisateur"/></figure><p id="r-432362" data-claire-element-id="432362">L’assistant s’ouvre et nous propose d’héberger notre application Silverlight dans un site web ASP.NET :</p><figure id="r-432364" data-claire-element-id="432365"><img id="r-432363" data-claire-element-id="432363" src="medias/uploads.siteduzero.com_files_356001_357000_356747.png" alt="Image utilisateur"/></figure><p id="r-432366" data-claire-element-id="432366">Gardons ces paramètres et cliquons sur OK. Visual Web Developper Express génère alors notre projet. En fait, il crée 2 projets :</p><ul id="r-432371" data-claire-element-id="432371"><li id="r-432368" data-claire-element-id="432368"><p id="r-432367" data-claire-element-id="432367">Un projet Silverlight, qui s’appelle MonApplicationSilverlight</p></li><li id="r-432370" data-claire-element-id="432370"><p id="r-432369" data-claire-element-id="432369">Un projet ASP.NET qui s’appelle MonApplicationSilverlight.Web</p></li></ul><p id="r-432372" data-claire-element-id="432372">Le projet ASP.NET n’est pas réellement obligatoire, il contient juste une page ASPX et une page HTML qui hébergent chacune l’application Silverlight. C’est juste le point d’entrée de notre application Silverlight.<br/> Tout le cœur de l’application se trouve dans le projet Silverlight. On y reconnait d’ailleurs quelques fichiers et notamment le fichier app.xaml et le fichier MainPage.xaml, comme pour une application WPF (à ceci près que le fichier généré lors de la création d’une application WPF s’appelle MainWindow).<br/> Tout comme WPF, on utilise du XAML et du C# pour réaliser notre application. Si vous n’avez pas tout à fait compris l’initiation vue dans le chapitre sur les applications lourdes, n’hésitez pas à revenir y jeter un œil.<br/> Visual Web Developper Express nous ouvre le fichier MainPage.xaml avec les deux parties de l’écran, en haut le designer et en bas le code XAML. Profitons-en pour manipuler directement le XAML car c’est un langage très puissant et savoir le manipuler sans passer par le designer est un atout non négligeable.</p><p id="r-432373" data-claire-element-id="432373">Rajoutons alors un contrôle TextBlock (qui est globalement l’équivalent du Label) pour afficher un petit message :</p><pre id="r-432374" data-claire-element-id="432374"><code data-claire-semantic="xml">&lt;TextBlock Text=&quot;Veuillez saisir votre nom&quot; /&gt;</code></pre><p id="r-432375" data-claire-element-id="432375">On constate que l’auto-complétion nous aide pour écrire cette balise. Elle propose dans un premier temps de compléter le nom de la balise (TextBlock) et une fois qu’elle l’a identifié, elle nous propose ses propriétés, comme la propriété Text.<br/> Ajoutons également un TextBox pour avoir une zone de texte modifiable, identifié par un nom. En Silverlight, pour donner un nom à un contrôle on utilise l’attribut x :Name. Profitons-en également pour lui donner une largeur et une hauteur :</p><pre id="r-432376" data-claire-element-id="432376"><code data-claire-semantic="xml">&lt;TextBox x:Name=&quot;nom&quot; Width=&quot;200&quot; Height=&quot;30&quot;/&gt;</code></pre><p id="r-432377" data-claire-element-id="432377">Le designer nous affiche le contenu de notre page telle qu’elle sera rendue :</p><figure id="r-432379" data-claire-element-id="432380"><img id="r-432378" data-claire-element-id="432378" src="medias/uploads.siteduzero.com_files_356001_357000_356748.png" alt="Image utilisateur"/></figure><p id="r-432381" data-claire-element-id="432381">Un truc en haut, un truc centré au milieu … pas vraiment ce à quoi on s’attendait.<br/> Si vous vous rappelez bien, lorsque nous avions utilisé le designer pour placer nos contrôles, c’est lui qui avait géré tout ça. Il avait positionné des marges entre les contrôles et des alignements. Il existe plusieurs façons de gérer l’alignement et nous allons en voir ici une autre grâce au contrôle StackPanel. Comme son nom le suggère, c’est un panneau qui permet d’empiler tous nos contrôles. Il les restitue les uns sous les autres. Encapsulons nos deux contrôles dans un StackPanel :</p><pre id="r-432382" data-claire-element-id="432382"><code data-claire-semantic="xml">&lt;StackPanel&gt;
    &lt;TextBlock Text=&quot;Veuillez saisir votre nom&quot; /&gt;
    &lt;TextBox x:Name=&quot;nom&quot; Width=&quot;200&quot; Height=&quot;30&quot; HorizontalAlignment=&quot;Left&quot;/&gt;
&lt;/StackPanel&gt;</code></pre><p id="r-432383" data-claire-element-id="432383">Vous remarquez que j’en ai profité pour rajouter la propriété HorizontalAlignment à Left qui permet d’aligner le contrôle à gauche. Ce qui donne :</p><figure id="r-432385" data-claire-element-id="432386"><img id="r-432384" data-claire-element-id="432384" src="medias/uploads.siteduzero.com_files_356001_357000_356749.png" alt="Image utilisateur"/></figure><p id="r-432387" data-claire-element-id="432387">Nous pouvons même empiler les StackPanel, sachant qu’il a une propriété permettant de préciser le type d’alignement que l’on souhaite. Ce qui permet, avec le code suivant :</p><pre id="r-432388" data-claire-element-id="432388"><code data-claire-semantic="xml">&lt;Grid x:Name=&quot;LayoutRoot&quot; Background=&quot;White&quot;&gt;
    &lt;StackPanel&gt;
        &lt;StackPanel Orientation=&quot;Horizontal&quot;&gt;
            &lt;TextBlock Text=&quot;Veuillez saisir votre nom&quot; /&gt;
            &lt;TextBox x:Name=&quot;nom&quot; Width=&quot;200&quot; Height=&quot;30&quot; HorizontalAlignment=&quot;Left&quot;/&gt;
        &lt;/StackPanel&gt;
        &lt;Button Content=&quot;Cliquez-moi&quot; Width=&quot;100&quot; /&gt;
    &lt;/StackPanel&gt;
&lt;/Grid&gt;</code></pre><p id="r-432389" data-claire-element-id="432389">d'avoir :</p><figure id="r-432391" data-claire-element-id="432392"><img id="r-432390" data-claire-element-id="432390" src="medias/uploads.siteduzero.com_files_356001_357000_356750.png" alt="Image utilisateur"/></figure><p id="r-432393" data-claire-element-id="432393">Pas trop mal, mais les contrôles sont un peu serrés. Il manque des espacements entre eux. C’est le rôle de la propriété Margin :</p><pre id="r-432394" data-claire-element-id="432394"><code data-claire-semantic="xml">&lt;Grid x:Name=&quot;LayoutRoot&quot; Background=&quot;White&quot;&gt;
    &lt;StackPanel&gt;
        &lt;StackPanel Orientation=&quot;Horizontal&quot;&gt;
            &lt;TextBlock Text=&quot;Veuillez saisir votre nom&quot; Margin=&quot;10&quot; /&gt;
            &lt;TextBox x:Name=&quot;nom&quot; Width=&quot;200&quot; Height=&quot;30&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;10 0 0 0&quot;/&gt;
        &lt;/StackPanel&gt;
        &lt;Button Content=&quot;Cliquez-moi&quot; Width=&quot;100&quot; Margin=&quot;20&quot; /&gt;
    &lt;/StackPanel&gt;
&lt;/Grid&gt;</code></pre><p id="r-432395" data-claire-element-id="432395">Et nous avons :</p><figure id="r-432397" data-claire-element-id="432398"><img id="r-432396" data-claire-element-id="432396" src="medias/uploads.siteduzero.com_files_356001_357000_356751.png" alt="Image utilisateur"/></figure><p id="r-432399" data-claire-element-id="432399">Arrêtons-nous là avec le positionnement. Vous vous rendrez compte que celui-ci est très puissant et permet de faire beaucoup de choses. <br/> Finissons notre petit exemple, il faut désormais rajouter un événement lors du clic sur le bouton et un TextBlock pour indiquer le résultat. Commençons à taper la propriété Click du bouton, l’auto-complétion nous propose d’ajouter un nouveau gestionnaire d’événement :</p><figure id="r-432401" data-claire-element-id="432402"><img id="r-432400" data-claire-element-id="432400" src="medias/uploads.siteduzero.com_files_356001_357000_356752.png" alt="Image utilisateur"/></figure><p id="r-432403" data-claire-element-id="432403">Validez avec la touche entrée, il complète avec un nom de méthode :</p><pre id="r-432404" data-claire-element-id="432404"><code data-claire-semantic="xml">&lt;Button Content=&quot;Cliquez-moi&quot; Width=&quot;100&quot; Margin=&quot;20&quot; Click=&quot;Button_Click&quot; /&gt;</code></pre><p id="r-432405" data-claire-element-id="432405">et il génère même la méthode adéquate dans le code behind :</p><pre id="r-432406" data-claire-element-id="432406"><code data-claire-semantic="csharp">private void Button_Click(object sender, RoutedEventArgs e)
{

}</code></pre><p id="r-432407" data-claire-element-id="432407">Il ne reste plus qu’à rajouter un TextBlock de résultat :</p><pre id="r-432408" data-claire-element-id="432408"><code data-claire-semantic="xml">&lt;TextBlock x:Name=&quot;resultat&quot; Foreground=&quot;Red&quot; /&gt;</code></pre><p id="r-432409" data-claire-element-id="432409">Et à modifier sa propriété dans l’événement :</p><pre id="r-432410" data-claire-element-id="432410"><code data-claire-semantic="csharp">private void Button_Click(object sender, RoutedEventArgs e)
{
    resultat.Text = &quot;Bonjour &quot; + nom.Text;
}</code></pre><p id="r-432411" data-claire-element-id="432411">Nous pouvons désormais démarrer notre application en appuyant sur <kbd>F5</kbd>. L’application ASP.NET qui héberge notre application Silverlight démarre. Il y a donc le serveur web de développement qui démarre sur son port ainsi que le navigateur par défaut. On obtient une page web qui possède ce rendu :</p><figure id="r-432413" data-claire-element-id="432414"><img id="r-432412" data-claire-element-id="432412" src="medias/uploads.siteduzero.com_files_356001_357000_356753.png" alt="Image utilisateur"/></figure><p id="r-432415" data-claire-element-id="432415">Si on renseigne notre nom et que l’on clique, on peut constater l’affichage du message résultat :</p><figure id="r-432417" data-claire-element-id="432418"><img id="r-432416" data-claire-element-id="432416" src="medias/uploads.siteduzero.com_files_356001_357000_356754.png" alt="Image utilisateur"/></figure><p id="r-432419" data-claire-element-id="432419">Et ceci, sans rechargement de la page. Ce n’est donc pas une application qui est transformée en HTML, mais bien une application exécutée par le plugin du navigateur. D’ailleurs, si l’on regarde la source de la page, nous avons notamment :</p><pre id="r-432420" data-claire-element-id="432420"><code data-claire-semantic="html">&lt;object data=&quot;data:application/x-silverlight-2,&quot; type=&quot;application/x-silverlight-2&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;
  &lt;param name=&quot;source&quot; value=&quot;ClientBin/MonApplicationSilverlight.xap&quot;/&gt;
  &lt;param name=&quot;onError&quot; value=&quot;onSilverlightError&quot; /&gt;
  &lt;param name=&quot;background&quot; value=&quot;white&quot; /&gt;
  &lt;param name=&quot;minRuntimeVersion&quot; value=&quot;4.0.50826.0&quot; /&gt;
  &lt;param name=&quot;autoUpgrade&quot; value=&quot;true&quot; /&gt;
  &lt;a href=&quot;http://go.microsoft.com/fwlink/?LinkID=149156&amp;v=4.0.50826.0&quot; style=&quot;text-decoration:none&quot;&gt;
	  &lt;img src=&quot;http://go.microsoft.com/fwlink/?LinkId=161376&quot; alt=&quot;Télécharger Microsoft Silverlight&quot; style=&quot;border-style:none&quot;/&gt;
  &lt;/a&gt;
&lt;/object&gt;</code></pre><p id="r-432421" data-claire-element-id="432421">La balise <code data-claire-semantic="html">&lt;object&gt;</code> est justement ce qui permet d’indiquer au navigateur que nous avons besoin de l’intervention d’un plugin. Il possède notamment un paramètre « source » lui indiquant le chemin de l’application à exécuter. C’est un fichier qui possède l’extension .xap et qui est le résultat de la compilation de notre application Silverlight. Ce fichier est en fait un fichier compressé qui possède toutes les assemblys dont notre application a besoin.</p><p id="r-432422" data-claire-element-id="432422">Vous aurez également remarqué que dans notre application, le bouton est centré sur la page. Et ceci, même si on redimensionne le navigateur. C’est une des forces du système de positionnement du XAML.<br/> Voilà pour ce petit aperçu de Silverlight. Nous pouvons réaliser des applications client riches, quasiment aussi évoluées que des applications WPF. Elles fonctionnent directement dans le navigateur grâce à un plugin dédié. A noter qu’il est également possible d’interagir entre une application Sliverlight hébergée dans une page et le contenu de la page HTML ainsi que du javascript.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c">Les différents types d&#039;applications pouvant être développées avec le C#</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
Créer une application Windows avec WPF
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
Créer une application web avec ASP.NET
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
Créer une application client riche avec Silverlight
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
Le graphisme et les jeux avec XNA
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
Créer une application mobile avec Windows Phone 7
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
Créer un service web avec WCF
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
<span class="arrow"></span>
<span class="next">Créer une application web avec ASP.NET</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
<span class="next">Le graphisme et les jeux avec XNA</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="LegraphismeetlesjeuxavecXNA"></a><h2>Le graphisme et les jeux avec XNA</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
<span class="arrow"></span>
<span class="next">Créer une application client riche avec Silverlight</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
<span class="next">Créer une application mobile avec Windows Phone 7</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-432424" data-claire-element-id="432424">Et oui, il est aussi possible de réaliser des jeux avec le C#. Même si tout ce qu’on a vu auparavant permet la réalisation d’applications de gestions, Microsoft dispose aussi de tout ce qu’il faut pour réaliser des jeux, grâce à XNA.<br/> XNA est un ensemble de bibliothèques permettant de créer des applications graphiques mais c’est également un outil permettant d’intégrer des contenus facilement dans des jeux (comme des images ou des musiques). Avec XNA, il est possible de faire des jeux qui fonctionnent sous Windows (ce que nous allons voir ici) mais également sous Xbox ou sur les téléphones Windows. Voyons rapidement comment fonctionne XNA.</p><p id="r-432425" data-claire-element-id="432425">Pour utiliser ce framework, il faut posséder Visual C# Express, ca tombe bien, nous l’avons déjà. A cela, il faut également rajouter le Microsoft XNA Game Studio 4.0 que nous pouvons <a href="http://www.microsoft.com/download/en/details.aspx?id=23714">télécharger à cet emplacement</a>. L’installation ne pose pas de problèmes. Démarrez à présent Visual C# Express, nous pouvons constater qu’il y a des nouveaux modèles de projets que nous pouvons créer, comme notamment un projet de type Windows Game (4.0). Choisissons celui-là et appelons le MonApplicationXNA.</p><figure id="r-432427" data-claire-element-id="432428"><img id="r-432426" data-claire-element-id="432426" src="medias/uploads.siteduzero.com_files_357001_358000_357040.png" alt="Image utilisateur"/></figure><p id="r-432429" data-claire-element-id="432429">Fidèle à son habitude, Visual C# Express nous génère plein de choses et notamment deux projets. Le premier (MonApplicationXNA) est le jeu en lui-même tandis que le second (MonApplicationXNAContent) est le projet permettant de gérer le contenu du jeu. <br/> Si nous ouvrons le code du fichier program.cs, nous pouvons constater qu’il possède une méthode Main() qui va servir de point d’entrée à notre application. Nous pouvons voir qu’il instancie une classe Game1 et qu’il appelle sa méthode Run() :</p><pre id="r-432430" data-claire-element-id="432430"><code data-claire-semantic="csharp">static void Main(string[] args)
{
    using (Game1 game = new Game1())
    {
        game.Run();
    }
}</code></pre><p id="r-432431" data-claire-element-id="432431">Allons donc voir ce qu’il se passe dans cette classe Game1.</p><p id="r-432432" data-claire-element-id="432432">La première chose à voir est qu’elle dérive de la classe Game qui fait partie du framework de Microsoft. Nous pouvons voir également un constructeur qui instancie un objet de type <a href="msdn.microsoft.com/fr-fr/library/microsoft.xna.framework.graphicsdevicemanager.html">GraphicsDeviceManager</a>. C’est cet objet qui permet de gérer le graphisme. Nous voyons ensuite plusieurs méthodes, comme la méthode Initialize(), la méthode LoadContent() et la méthode UnloadContent(). Ces méthodes servent respectivement à initialiser les variables , à charger le contenu et à décharger le contenu. Les deux autres méthodes restantes sont les plus importantes, il s’agit des méthodes Update() et Draw().<br/> La méthode Draw(), comme son nom l’indique, permet de réaliser toutes les opérations d’affichages (comme l’affichage des images ou du texte). La méthode Update() est l’endroit où on réalise tous les calculs qui doivent être fait en amont avant les opérations d’affichage. C’est l’endroit propice où l’on va faire bouger les images ou bien où on va tester si l’utilisateur a appuyé sur des touches, gérer la logique du jeu, etc …</p><p id="r-432433" data-claire-element-id="432433">Ces méthodes sont appelées en boucle régulièrement de manière à ce que la méthode Draw puisse afficher 60 images par secondes, c’est ce qu’on appelle le frame rate.</p><p id="r-432434" data-claire-element-id="432434">Démarrons l’application qui a été générée, on voit une fenêtre peinte en bleu qui s’affiche :</p><figure id="r-432436" data-claire-element-id="432437"><img id="r-432435" data-claire-element-id="432435" src="medias/uploads.siteduzero.com_files_356001_357000_356755.png" alt="Image utilisateur"/></figure><p id="r-432438" data-claire-element-id="432438">Ce bleu vient de la méthode Draw où est appelée la méthode :</p><pre id="r-432439" data-claire-element-id="432439"><code data-claire-semantic="csharp">GraphicsDevice.Clear(Color.CornflowerBlue);</code></pre><p id="r-432440" data-claire-element-id="432440">Cela permet de remplir l’écran avec la couleur CornFlowerBlue.</p><p id="r-432441" data-claire-element-id="432441">Nous allons désormais créer un sprite. Un sprite est un élément graphique d’un jeu vidéo qui peut se déplacer sur l’écran. En général, il est formé de plusieurs images afin de pouvoir gérer un mouvement et est dessiné sur un fond transparent.<br/> Ici, nous allons juste afficher un sprite en forme de balle composé d’une seule image.<br/> Pour avoir une balle sur fond transparent, je vais utiliser <a href="http://www.getpaint.net/download.html">Paint.Net</a> où je créé une image de 50x50, j’efface le fond blanc et je dessine une balle rouge à l’intérieur. A noter que le format doit être png pour gérer la transparence.</p><p id="r-432442" data-claire-element-id="432442">Vous pouvez récupérer <a href="medias/uploads.siteduzero.com_files_356001_357000_356756.png">cette image ci-dessous</a> :</p><figure id="r-432444" data-claire-element-id="432445"><img id="r-432443" data-claire-element-id="432443" src="medias/uploads.siteduzero.com_files_356001_357000_356756.png" alt="Image utilisateur"/></figure><p id="r-432446" data-claire-element-id="432446">Renommez-là en balle.png. Maintenant, il faut l’ajouter au pipeline de gestion de contenu. Pour cela, faites un clic droit sur le projet MonApplicationXNAContent et choisissez « Ajouter », « Element existant » et allez choisir le fichier représentant notre balle. Ici, c’est Visual C# Express qui travaille pour nous. Lorsque nous compilerons l’application, il va transformer le fichier PNG en fichier exploitable par l’application. Nous n’avons pas besoin ici de savoir exactement comment cela fonctionne.</p><p id="r-432447" data-claire-element-id="432447">Retour dans le code de notre application, nous allons devoir créer une variable de type <a href="msdn.microsoft.com/fr-fr/library/microsoft.xna.framework.graphics.texture2d.html">Texture2D</a>, c’est cette variable qui va nous permettre de charger ce sprite :</p><pre id="r-432448" data-claire-element-id="432448"><code data-claire-semantic="csharp">private Texture2D balle;</code></pre><p id="r-432449" data-claire-element-id="432449">On fait ça en toute logique dans la méthode LoadContent, grâce à la méthode Content.Load :</p><pre id="r-432450" data-claire-element-id="432450"><code data-claire-semantic="csharp">protected override void LoadContent()
{
    // Créer un SpriteBatch, qui peut être utilisé pour dessiner des textures.
    spriteBatch = new SpriteBatch(GraphicsDevice);

    balle = Content.Load&lt;Texture2D&gt;(&quot;balle&quot;);
}</code></pre><p id="r-432451" data-claire-element-id="432451">A noter qu’il faut lui passer en paramètre le nom du fichier ajouté dans le projet Content. Puis nous affichons ce sprite dans la méthode Draw() :</p><pre id="r-432452" data-claire-element-id="432452"><code data-claire-semantic="csharp">protected override void Draw(GameTime gameTime)
{
    GraphicsDevice.Clear(Color.CornflowerBlue);

    spriteBatch.Begin();
    spriteBatch.Draw(balle, emplacement, Color.White);
    spriteBatch.End();

    base.Draw(gameTime);
}</code></pre><p id="r-432453" data-claire-element-id="432453">Pour ce faire, on utilise l’objet spriteBatch qui a été initialisé dans la méthode LoadContent. On commence par appeler la méthode Begin pour indiquer que l’on va commencer à dessiner, puis on appelle la méthode Draw pour afficher la balle et enfin on appelle la méthode End pour indiquer qu’on a fini de dessiner.<br/> La méthode Draw de l’objet spriteBatch prend en paramètre l’objet Texture2D à afficher, ici notre balle ainsi que l’emplacement où l’on souhaite l’afficher. Enfin, elle prend une couleur pour teinter le sprite, ici blanc pour ne rien teinter.</p><p id="r-432454" data-claire-element-id="432454">L’emplacement est un objet Rectangle permettant d’indiquer la position (x et y) ainsi que la largeur du sprite. Nous souhaitons centrer la balle, cela peut se faire dans la méthode Initialize :</p><pre id="r-432455" data-claire-element-id="432455"><code data-claire-semantic="csharp">protected override void Initialize()
{
    base.Initialize();

    emplacement = new Rectangle(GraphicsDevice.Viewport.Width / 2 - 25, GraphicsDevice.Viewport.Height / 2 - 25, 50, 50);
}</code></pre><p id="r-432456" data-claire-element-id="432456">Vous n’aurez bien sûr pas oublié de rajouter la déclaration de la variable emplacement en membre privé de la classe …<br/> La propriété GraphicsDevice.ViewPort permet d’obtenir la largueur et la hauteur de la fenêtre de notre jeu.</p><p id="r-432457" data-claire-element-id="432457">Nous obtenons :</p><figure id="r-432459" data-claire-element-id="432460"><img id="r-432458" data-claire-element-id="432458" src="medias/uploads.siteduzero.com_files_356001_357000_356757.png" alt="Image utilisateur"/></figure><p id="r-432461" data-claire-element-id="432461">Que c’est bôôôôô :p .</p><p id="r-432462" data-claire-element-id="432462">Il est temps de faire bouger notre balle grâce au clavier. Toute cette logique doit être faite dans la méthode Update(). Il s’agira de faire varier les valeurs du rectangle en fonction des différents appuis sur les touches.<br/> Créons donc deux variables x et y permettant de stocker la position de la balle :</p><pre id="r-432463" data-claire-element-id="432463"><code data-claire-semantic="csharp">private double x;
private double y;</code></pre><p id="r-432464" data-claire-element-id="432464">puis initialisons les avec les bonnes valeurs :</p><pre id="r-432465" data-claire-element-id="432465"><code data-claire-semantic="csharp">protected override void Initialize()
{
    base.Initialize();

    x = GraphicsDevice.Viewport.Width / 2 - 25;
    y = GraphicsDevice.Viewport.Height / 2 - 25; 
    emplacement = new Rectangle((int)x, (int)y, 50, 50);
}</code></pre><p id="r-432466" data-claire-element-id="432466">Dans la méthode Update(), il ne reste qu’à lire le clavier et à modifier les valeurs de x et de y :</p><pre id="r-432467" data-claire-element-id="432467"><code data-claire-semantic="csharp">protected override void Update(GameTime gameTime)
{
    // Permet au jeu de se fermer
    if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
        this.Exit();

    int vitesse = 2;
    KeyboardState etatClavier = Keyboard.GetState();
    if (etatClavier.IsKeyDown(Keys.Up))
    {
        y -= vitesse;
    }
    if (etatClavier.IsKeyDown(Keys.Down))
    {
        y += vitesse;
    }
    if (etatClavier.IsKeyDown(Keys.Left))
    {
        x -= vitesse;
    }
    if (etatClavier.IsKeyDown(Keys.Right))
    {
        x += vitesse;
    }

    emplacement = new Rectangle((int)x, (int)y, 50, 50);

    base.Update(gameTime);
}</code></pre><p id="r-432468" data-claire-element-id="432468">Cela se fait en appelant la méthode <a href="http://msdn.microsoft.com/fr-fr/library/bb197232.aspx">Keyboard.GetState()</a> qui permet de récupérer l’état du clavier. Ensuite, en fonction de l’état des touches, on change les valeurs de x et de y. Vous aurez compris que l’énumération Keys contient les différentes touches de notre clavier et notamment le pavé directionnel avec la flèche vers le haut (Keys.Up), la flèche vers le bas (Keys.Down), la flèche vers la droite (Keys.Right) et la flèche vers la gauche (Keys.Left).</p><p id="r-432469" data-claire-element-id="432469">Vous pouvez tester, notre balle se déplace :</p><figure id="r-432471" data-claire-element-id="432472"><img id="r-432470" data-claire-element-id="432470" src="medias/uploads.siteduzero.com_files_356001_357000_356758.png" alt="Image utilisateur"/></figure><p id="r-432473" data-claire-element-id="432473">Dans l’idéal, il faudrait gérer les situations limites car vous vous rendrez compte qu’il est possible de faire sortir la balle de l’écran … Pas mal pour un début, non ? :)</p><p id="r-432474" data-claire-element-id="432474">Nous en avons terminé avec ce petit aperçu de XNA. Vous avez pu voir qu’il était plutôt facile d’afficher des sprites à l’écran. XNA est également utilisable pour développer des jeux sur Xbox et possède de la même façon des éléments pour lire l’état des manettes, pour gérer le réseau, etc.<br/> Nous pouvons également l’utiliser sur les smartphones possédant le système d’exploitation Windows Phone 7.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c">Les différents types d&#039;applications pouvant être développées avec le C#</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
Créer une application Windows avec WPF
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
Créer une application web avec ASP.NET
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
Créer une application client riche avec Silverlight
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
Le graphisme et les jeux avec XNA
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
Créer une application mobile avec Windows Phone 7
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
Créer un service web avec WCF
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
<span class="arrow"></span>
<span class="next">Créer une application client riche avec Silverlight</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
<span class="next">Créer une application mobile avec Windows Phone 7</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="CreruneapplicationmobileavecWindowsPhone7"></a><h2>Créer une application mobile avec Windows Phone 7</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
<span class="arrow"></span>
<span class="next">Le graphisme et les jeux avec XNA</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
<span class="next">Créer un service web avec WCF</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-432476" data-claire-element-id="432476">Puisque nous parlons de smartphones, il faut savoir que le C# nous permet également de développer des applications pour téléphones mobiles équipés du système d’exploitation Windows Phone. C’est un point très important car il est possible de mutualiser beaucoup de choses que nous avons apprises pour les transposer dans le monde en plein essor des smartphones.<br/> Pour cela, il faut commencer par installer Visual Studio 2010 Express for Windows Phone que l’on peut <a href="http://msdn.microsoft.com/fr-fr/gg699329">trouver à cet emplacement</a>. <br/> L’installation est un peu longue et peut, si besoin, demander d’appliquer le service pack 1. Il suffit de se laisser guider.<br/> En échange, nous obtenons des nouveaux modèles de création de projets, dont notamment deux qui nous intéressent particulièrement :</p><ul id="r-432481" data-claire-element-id="432481"><li id="r-432478" data-claire-element-id="432478"><p id="r-432477" data-claire-element-id="432477">Application Windows Phone</p></li><li id="r-432480" data-claire-element-id="432480"><p id="r-432479" data-claire-element-id="432479">Windows Phone Game</p></li></ul><p id="r-432482" data-claire-element-id="432482">Ce qui est intéressant avec les applications Windows Phone c’est que nous réutilisons le savoir que nous avons pu acquérir dans les autres types d’applications C#, car pour réaliser le premier type d’application, nous allons utiliser Silverlight et pour réaliser le deuxième type d’application, nous utiliserons XNA.<br/> Le premier type permet de réaliser des applications de gestions et le deuxième des jeux. Il n’est pas possible d’utiliser XNA avec une application Silverlight ou inversement, une fois qu’on a choisi son type d’application, c’est pour la vie (de l’application :) ).</p><p id="r-432483" data-claire-element-id="432483">Les smartphones sont des terminaux qui ont plein de moyen de communication évolués. On utilise notamment les doigts pour manipuler le téléphone et même potentiellement plusieurs. Ils possèdent des GPS pour nous localiser, des accéléromètres pour détecter leurs positions dans l’espace et leurs mouvements, etc. Ce sont autant de périphériques dont nous tirerons parti dans nos applications pour offrir un maximum d’expérience utilisateur.<br/> Je ne vous présenterai pas ici comment les utiliser car cela mériterait un livre entier. Je ne vous présenterai pas non plus brièvement les différents modes de développement car nous avons déjà vu un aperçu de Silverlight et de XNA.<br/> Pour réaliser une application Silverlight pour Windows Phone, il faudra utiliser le modèle Application Windows Phone :</p><figure id="r-432485" data-claire-element-id="432486"><img id="r-432484" data-claire-element-id="432484" src="medias/uploads.siteduzero.com_files_356001_357000_356759.png" alt="Image utilisateur"/></figure><p id="r-432487" data-claire-element-id="432487">Vous pouvez voir que le contenu du projet ressemble énormément à une application Silverlight. C’est cependant une version de Silverlight pour Windows Phone et pour l’instant il manque encore des choses par rapport au Silverlight complet. Une conséquence de cela est que les bibliothèques, contrôles ou autres qui ont été développées pour Silverlight ne fonctionneront pas forcément avec Silverlight pour Windows Phone. Il n’est donc pas forcément immédiat de pouvoir migrer une application Silverlight sur Windows Phone, surtout que celle-ci doit répondre à un look particulier et à une interface adaptée au smartphone. Microsoft conseille fortement aux développeurs de se rapprocher du look qu’ils ont choisi, à savoir le look « Metro ».</p><p id="r-432488" data-claire-element-id="432488">Vous me direz, comment développer sur un smartphone ? On ne va pas installer un Visual Studio Express sur notre téléphone ...</p><p id="r-432489" data-claire-element-id="432489">Et bien c’est facile, Microsoft a tout prévu en intégrant un émulateur à l’IDE. L’application peut donc s’exécuter comme si elle s’exécutait sur un téléphone. Il est cependant limité, par exemple pas de GPS ni d’accéléromètre dans cet émulateur. Mais que ça ne vous effraie pas, il est possible de les simuler ou de les bouchonner …<br/> L’émulateur répond à un bon nombre de besoin de développement mais rien ne remplace le test final sur un vrai téléphone et pour cela c’est également très simple grâce à l’IDE qui s'occupe de tout le déploiement.</p><p id="r-432490" data-claire-element-id="432490">Écrivons rapidement un petit programme en Silverlight pour Windows Phone afin d'illustrer cela. En fait, je ne vais pas faire grand-chose, juste modifier légèrement le fichier MainPage.xaml généré pour changer la propriété Text du TextBlock « MON APPLICATION » en « Bienvenue sur Windows Phone ».</p><p id="r-432491" data-claire-element-id="432491">Dans les déclarations en haut du fichier, je vais changer :</p><pre id="r-432492" data-claire-element-id="432492"><code data-claire-semantic="xml">SupportedOrientations=&quot;Portrait&quot;</code></pre><p id="r-432493" data-claire-element-id="432493">en</p><pre id="r-432494" data-claire-element-id="432494"><code data-claire-semantic="xml">SupportedOrientations=&quot;PortraitOrLandscape&quot;</code></pre><p id="r-432495" data-claire-element-id="432495">Enfin, je vais aller changer la ligne suivante dans le App.xaml.cs :</p><pre id="r-432496" data-claire-element-id="432496"><code data-claire-semantic="csharp">Application.Current.Host.Settings.EnableFrameRateCounter = true;</code></pre><p id="r-432497" data-claire-element-id="432497">en</p><pre id="r-432498" data-claire-element-id="432498"><code data-claire-semantic="csharp">Application.Current.Host.Settings.EnableFrameRateCounter = false;</code></pre><p id="r-432499" data-claire-element-id="432499">(ce dernier point permet de désactiver les informations de débogage de nombre de frames à l'écran)</p><p id="r-432500" data-claire-element-id="432500">Et puis je vais démarrer l’application en appuyant sur <kbd>F5</kbd>. L’émulateur se lance et se connecte à notre application. Nous pouvons voir notre page d’accueil :</p><figure id="r-432502" data-claire-element-id="432503"><img id="r-432501" data-claire-element-id="432501" src="medias/uploads.siteduzero.com_files_356001_357000_356760.png" alt="Image utilisateur"/></figure><p id="r-432504" data-claire-element-id="432504">Pas mal non ? <br/> Nous avons également modifié la propriété SupportedOrientations. Vous l’avez peut-être compris, nous avons indiqué que notre application allait gérer la position du téléphone en mode portrait et en mode paysage, c'est-à-dire pivoté de 90°, alors qu’au départ notre application ne supportait que le mode portrait.<br/> Pour le constater, nous pouvons faire pivoter l’émulateur en cliquant dans la barre en haut à droite :</p><figure id="r-432506" data-claire-element-id="432507"><img id="r-432505" data-claire-element-id="432505" src="medias/uploads.siteduzero.com_files_356001_357000_356761.png" alt="Image utilisateur"/></figure><p id="r-432508" data-claire-element-id="432508">Et hop, notre application s’est automatiquement tournée. Ici, le rendu s’est automatiquement adapté :</p><figure id="r-432510" data-claire-element-id="432511"><img id="r-432509" data-claire-element-id="432509" src="medias/uploads.siteduzero.com_files_356001_357000_356762.png" alt="Image utilisateur"/></figure><p id="r-432512" data-claire-element-id="432512">Notez qu’il est possible de s’abonner à un événement levé lors d’un changement d’orientation de notre application nous permettant par exemple de réorganiser notre rendu.</p><p id="r-432513" data-claire-element-id="432513">Je m’arrête là pour cet aperçu de Silverlight pour Windows Phone mais sachez également qu’il existe des contrôles spécifiques dédiés à la gestion de l’écran d’accueil des applications (le contrôle panorama) ainsi qu’à l’affichage d’informations sur plusieurs pages (le contrôle pivot) que l’on peut chacun bouger avec le doigt. A ce propos, il existe également des bibliothèques permettant de gérer les gestes réalisés avec les doigts.</p><p id="r-432514" data-claire-element-id="432514">Passons à présent à XNA pour Windows Phone. <br/> Il suffit de choisir le modèle de projet Windows Phone Game :</p><figure id="r-432516" data-claire-element-id="432517"><img id="r-432515" data-claire-element-id="432515" src="medias/uploads.siteduzero.com_files_356001_357000_356764.png" alt="Image utilisateur"/></figure><p id="r-432518" data-claire-element-id="432518">L’IDE nous génère les deux projets classiques d’une application XNA. Remarquons que dans le fichier Game1.cs, il nous a rajouté une instruction pour fixer le taux de rafraichissement du téléphone qui est de 30 images par seconde :</p><pre id="r-432519" data-claire-element-id="432519"><code data-claire-semantic="csharp">TargetElapsedTime = TimeSpan.FromTicks(333333);</code></pre><p id="r-432520" data-claire-element-id="432520">A noter que nous avions vu précédemment qu’il était à 60 images par secondes par défaut. Ici, ce changement est là afin de répondre au mieux aux caractéristiques du téléphone.</p><p id="r-432521" data-claire-element-id="432521">Cette fois-ci, plutôt que d’afficher une balle, nous allons afficher du texte. <br/> La première chose à faire est de rajouter une police de sprite, que l’on appelle également « font ». Cela se fait en cliquant droit sur le projet de contenu et en ajoutant un nouvel élément :</p><figure id="r-432523" data-claire-element-id="432524"><img id="r-432522" data-claire-element-id="432522" src="medias/uploads.siteduzero.com_files_356001_357000_356765.png" alt="Image utilisateur"/></figure><p id="r-432525" data-claire-element-id="432525">Choisissez Police Sprite et donnez-lui un petit nom, par exemple MaFonte (conservez l’extension .spritefont).<br/> Un fichier XML de configuration de la fonte s’ouvre et nous permet de changer éventuellement ses caractéristiques, comme la police, la taille, etc. Changeons lui juste sa taille avec :</p><pre id="r-432526" data-claire-element-id="432526"><code data-claire-semantic="xml">&lt;Size&gt;25&lt;/Size&gt;</code></pre><p id="r-432527" data-claire-element-id="432527">Nous avons ensuite besoin de rajouter une variable de type SpriteFont :</p><pre id="r-432528" data-claire-element-id="432528"><code data-claire-semantic="csharp">private SpriteFont maFonte;</code></pre><p id="r-432529" data-claire-element-id="432529">qui sera chargée dans la méthode LoadContent avec :</p><pre id="r-432530" data-claire-element-id="432530"><code data-claire-semantic="csharp">protected override void LoadContent()
{
    spriteBatch = new SpriteBatch(GraphicsDevice);

    maFonte = Content.Load&lt;SpriteFont&gt;(&quot;MaFonte&quot;);
}</code></pre><p id="r-432531" data-claire-element-id="432531">Notons qu’on utilise le nom du fichier de police comme paramètre de la méthode Content.Load permettant de charger la fonte.<br/> Profitons-en pour rajouter une variable de type Vector2 qui est un vecteur à deux dimensions pour stocker la position où nous allons afficher notre texte :</p><pre id="r-432532" data-claire-element-id="432532"><code data-claire-semantic="csharp">private Vector2 position;</code></pre><p id="r-432533" data-claire-element-id="432533">Pour cet exemple, affichons l’heure. Nous allons également rafraichir la position du texte toutes les deux secondes pour faire un effet sympathique, pour cela nous allons comparer avec la variable gameTime passée en paramètre de la méthode Update qui fournit des informations sur le temps total écoulé depuis le début du jeu ou depuis le dernier passage dans la méthode Update.<br/> Nous avons besoin de plusieurs variables :</p><pre id="r-432534" data-claire-element-id="432534"><code data-claire-semantic="csharp">private string date;
private TimeSpan dernierCalcul;
private Vector2 centre;
private Random random;</code></pre><p id="r-432535" data-claire-element-id="432535">La variable random sera initialisée dans la méthode Initialize :</p><pre id="r-432536" data-claire-element-id="432536"><code data-claire-semantic="csharp">protected override void Initialize()
{
    random = new Random();
    base.Initialize();
}</code></pre><p id="r-432537" data-claire-element-id="432537">Ensuite la méthode Update calculera une nouvelle position aléatoire uniquement toutes les deux secondes :</p><pre id="r-432538" data-claire-element-id="432538"><code data-claire-semantic="csharp">protected override void Update(GameTime gameTime)
{
    // Allows the game to exit
    if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
        this.Exit();

    date = DateTime.Now.ToLongTimeString();

    if (gameTime.TotalGameTime - dernierCalcul &gt; TimeSpan.FromSeconds(2))
    {
        dernierCalcul = gameTime.TotalGameTime;
        centre = maFonte.MeasureString(date) / 2;

        int x = random.Next((int)centre.X, GraphicsDevice.Viewport.Width - (int)centre.X);
        int y = random.Next((int)centre.Y, GraphicsDevice.Viewport.Height - (int)centre.Y);

        position = new Vector2(x, y);
    }

    base.Update(gameTime);
}</code></pre><p id="r-432539" data-claire-element-id="432539">Le code parle de lui-même. Le seul truc un peu spécial vient du calcul du centre du texte, obtenu via la méthode MeasureString.<br/> Ensuite, il faudra afficher la chaine dans la méthode Draw() :</p><pre id="r-432540" data-claire-element-id="432540"><code data-claire-semantic="csharp">protected override void Draw(GameTime gameTime)
{
    GraphicsDevice.Clear(Color.CornflowerBlue);

    spriteBatch.Begin();
    spriteBatch.DrawString(maFonte, date, position, Color.Red, 0, centre, 1, SpriteEffects.None, 0);
    spriteBatch.End();

    base.Draw(gameTime);
}</code></pre><p id="r-432541" data-claire-element-id="432541">Nous utilisons pour cela la méthode DrawString de l’objet SpriteBatch.<br/> Reste à démarrer notre application en appuyant sur <kbd>F5</kbd>. Le principe est le même, nous disposons d’un émulateur qui permet de simuler un téléphone simplifié (sans GPS, sans accéléromètre, etc.). Ce qui donne :</p><figure id="r-432543" data-claire-element-id="432544"><img id="r-432542" data-claire-element-id="432542" src="medias/uploads.siteduzero.com_files_356001_357000_356763.png" alt="Image utilisateur"/></figure><p id="r-432545" data-claire-element-id="432545">XNA possède tout ce qu’il faut pour gérer la gestuelle en natif. Il devient alors très facile de réaliser des jeux très sympas.</p><p id="r-432546" data-claire-element-id="432546">Voilà pour cet aperçu rapide du développement d’application pour smartphones équipés de Windows Phone. Ce qui est très intéressant c’est qu’un développeur .NET qui a déjà des compétences en C#, Silverlight ou XNA sera très rapidement capable de réaliser des applications pour Windows Phone. Il aura juste besoin de se familiariser aux diverses méthodes permettant de gérer les divers capteurs du téléphone. Et tout ça grâce à notre langage préféré :) .</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c">Les différents types d&#039;applications pouvant être développées avec le C#</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
Créer une application Windows avec WPF
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
Créer une application web avec ASP.NET
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
Créer une application client riche avec Silverlight
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
Le graphisme et les jeux avec XNA
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
Créer une application mobile avec Windows Phone 7
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
Créer un service web avec WCF
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
<span class="arrow"></span>
<span class="next">Le graphisme et les jeux avec XNA</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
<span class="next">Créer un service web avec WCF</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div><a name="CrerunservicewebavecWCF"></a><h2>Créer un service web avec WCF</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
<span class="arrow"></span>
<span class="next">Créer une application mobile avec Windows Phone 7</span>
</a>
</div>
<hr class="top"/>
<div class="clear"></div> <div id="content" role="article">
<p id="r-432548" data-claire-element-id="432548">Avec le C# il est également très facile de créer des services web. Un service web permet en général d’accéder à des fonctionnalités depuis n’importe où, à travers internet. Citons par exemple les services web d’Amazon qui nous permettent de récupérer des informations sur des livres, ou encore des services web qui permettent d’obtenir la météo du jour. Bref, c’est un moyen de communication entre applications hétérogènes potentiellement situées à des emplacements physiques très éloignés.<br/> En imaginant que nous ayons également besoin d’exposer des méthodes à l’extérieur, pour qu’un fournisseur vienne consulter l’état de nos commandes ou qu’un client puisse suivre l’avancée de la sienne …, nous allons devoir créer un service web. <br/> Le framework .NET dispose de tout un framework pour cela qui s’appelle WCF : <strong>Windows Communication Foundation</strong>.</p><p id="r-432549" data-claire-element-id="432549">Un service web est une espèce d’application web qui répond à des requêtes permettant d’appeler une méthode avec des paramètres et de recevoir en réponse le retour de la méthode. L’intérêt d’un service web est qu’il est indépendant de la technologie. Même si on écrit un service web avec du C#, il doit être appelable par du java ou du PHP.</p><p id="r-432550" data-claire-element-id="432550">Mais comment appeler un service web ? Quelle adresse ? Comment connait-on le nom des méthodes à appeler ? Comment indiquer les paramètres et les valeurs que l’on souhaite passer ?</p><p id="r-432551" data-claire-element-id="432551">Et oui, il faut une syntaxe définie, sinon on peut faire ce que l’on veut. C’est là qu’interviennent les organismes de standardisation. Ils ont définies plusieurs normes permettant de décrire le format des échanges. C’est le cas par exemple du <a href="http://fr.wikipedia.org/wiki/SOAP">protocole SOAP</a> qui est basé sur du XML. Il est associé <a href="http://fr.wikipedia.org/wiki/Web_Services_Description_Language">au WSDL</a> qui permet de décrire le service web.<br/> Nous avons à notre disposition également <a href="http://fr.wikipedia.org/wiki/Representational_State_Transfer">les services web de type REST</a> qui exposent les fonctionnalités comme des URL.</p><p id="r-432552" data-claire-element-id="432552">Pour réaliser un petit service web, nous allons avoir besoin de Visual Web Developper Express ainsi que du projet de type « Application du service WCF » :</p><figure id="r-432554" data-claire-element-id="432555"><img id="r-432553" data-claire-element-id="432553" src="medias/uploads.siteduzero.com_files_356001_357000_356766.png" alt="Image utilisateur"/></figure><p id="r-432556" data-claire-element-id="432556">Visual Web Developper Express nous génère le projet. Il s’agit bien d’une application web possédant son fichier de configuration web.config.<br/> Si nous démarrons notre service web en appuyant sur <kbd>F5</kbd>, nous pouvons voir que le serveur web de développement est démarré. Par contre, ce n’est pas le navigateur par défaut qui s’ouvre mais une application de test qui s’appelle WcfTestClient, disponible avec le framework.NET.<br/> Que cela ne nous empêche pas d’ouvrir notre navigateur en local sur le bon port et de cliquer sur le lien Service1.svc, il nous affiche un message permettant de constater que notre service web est à l’écoute :</p><figure id="r-432558" data-claire-element-id="432559"><img id="r-432557" data-claire-element-id="432557" src="medias/uploads.siteduzero.com_files_356001_357000_356767.png" alt="Image utilisateur"/></figure><p id="r-432560" data-claire-element-id="432560">Remarquons que si l’on clique sur le lien proposé <a href="http://localhost:49172/Service1.svc?wsdl">http://localhost:49172/Service1.svc?wsdl</a>, il nous affiche le WSDL de notre service web, c'est-à-dire les informations de descriptions de celui-ci :</p><figure id="r-432562" data-claire-element-id="432563"><img id="r-432561" data-claire-element-id="432561" src="medias/uploads.siteduzero.com_files_356001_357000_356768.png" alt="Image utilisateur"/></figure><p id="r-432564" data-claire-element-id="432564">Nous n’allons pas détailler son contenu mais sachez qu’il possède tout ce qu’il faut pour décrire le service web, ses méthodes et ses paramètres. En fait, l’application WcfTestClient qui a démarré lorsque nous avons appuyé sur <kbd>F5</kbd> se sert de ce WSDL pour lire le contenu du service web :</p><figure id="r-432566" data-claire-element-id="432567"><img id="r-432565" data-claire-element-id="432565" src="medias/uploads.siteduzero.com_files_356001_357000_356769.png" alt="Image utilisateur"/></figure><p id="r-432568" data-claire-element-id="432568">Nous pouvons d’ailleurs voir que ce service web possède deux méthodes, GetData et GetDataUsingDataContract(). D’où viennent ces méthodes ? <br/> Vous vous en doutez, du fichier qui a été généré par Visual Web Developper Express. Il contient le code suivant :</p><pre id="r-432569" data-claire-element-id="432569"><code data-claire-semantic="csharp">public class Service1 : IService1
{
    public string GetData(int value)
    {
        return string.Format(&quot;You entered: {0}&quot;, value);
    }

    public CompositeType GetDataUsingDataContract(CompositeType composite)
    {
        [code abrégé]
    }
}</code></pre><p id="r-432570" data-claire-element-id="432570">Ce qu'il est important de constater c’est que la classe Service1 implémente l’interface IService1, qui contient :</p><pre id="r-432571" data-claire-element-id="432571"><code data-claire-semantic="csharp">[ServiceContract]
public interface IService1
{

    [OperationContract]
    string GetData(int value);

    [OperationContract]
    CompositeType GetDataUsingDataContract(CompositeType composite);
}</code></pre><p id="r-432572" data-claire-element-id="432572">C’est grâce aux attributs ServiceContract et OperationContract que l’application sait ce qu’elle doit exposer en tant que service web.<br/> Nous allons donc créer notre service web à nous. Ajoutez un nouvel élément au projet de type Service WCF que nous appelons ServiceBonjour :</p><figure id="r-432574" data-claire-element-id="432575"><img id="r-432573" data-claire-element-id="432573" src="medias/uploads.siteduzero.com_files_356001_357000_356770.png" alt="Image utilisateur"/></figure><p id="r-432576" data-claire-element-id="432576">Remarquons que l’extension du fichier est .svc. L’IDE nous a généré 3 fichiers. Le premier est l’interface IServiceBonjour, le second est le fichier ServiceBonjour.svc et le troisième son code behind ServiceBonjour.svc.cs. Ici, le fichier ServiceBonjour.svc ne nous intéresse pas, il permet d’indiquer quelle classe est associée au service web. Nous gardons la configuration par défaut.<br/> Il ne reste qu’à modifier le code généré pour avoir dans l’interface :</p><pre id="r-432577" data-claire-element-id="432577"><code data-claire-semantic="csharp">[ServiceContract]
public interface IServiceBonjour
{
    [OperationContract]
    string DireBonjour(string qui);
}</code></pre><p id="r-432578" data-claire-element-id="432578">Bien sûr, le code behind devra être cohérent vu que la classe ServiceBonjour implémente l’interface :</p><pre id="r-432579" data-claire-element-id="432579"><code data-claire-semantic="csharp">public class ServiceBonjour : IServiceBonjour
{
    public string DireBonjour(string qui)
    {
        return &quot;Bonjour &quot; + qui + &quot; depuis le service web&quot;;
    }
}</code></pre><p id="r-432580" data-claire-element-id="432580">Il ne reste qu’à supprimer les fichiers Service1 qui ne nous sont plus utile. Démarrons le projet en appuyant sur <kbd>F5</kbd>. Le client de test de services WCF s’ouvre et charge automatiquement les informations de descriptions de notre service web. Nous pouvons voir notre service web ainsi que sa méthode. Si nous double-cliquons sur la méthode DireBonjour, nous pouvons voir que l’outil nous propose de saisir une valeur pour la variable « qui ». Saisissons un prénom et cliquons sur Appeler. L’outil invoque notre service web et nous retourne le résultat :</p><figure id="r-432582" data-claire-element-id="432583"><img id="r-432581" data-claire-element-id="432581" src="medias/uploads.siteduzero.com_files_356001_357000_356771.png" alt="Image utilisateur"/></figure><p id="r-432584" data-claire-element-id="432584">Et voilà :) . Nous avons invoqué notre service web sans trop de soucis …</p><p id="r-432585" data-claire-element-id="432585">Cet outil WCF c’est bien, mais il nous cache un peu tout. Nous allons appeler le service web avec du C# désormais.<br/> Première chose à faire, il ne faut pas quitter pas Visual Web Developper Express. En effet, le serveur web de développement est démarré et héberge notre service web. Si jamais il n’est pas démarré, il va falloir le faire. Nous en avons besoin pour appeler notre service web.</p><p id="r-432586" data-claire-element-id="432586">Démarrez ensuite un autre Visual C# Express et créez une application cliente lourde de votre choix (console ou WPF). Je vais créer ici une application console car cela sera plus simple.<br/> Ici, par défaut nous avons créé un service web SOAP. L’intérêt c’est que les applications C# peuvent très facilement appeler ce service web en nous mâchant tout le travail. Pour cela, il faut faire ce qu’on appelle une référence de service.<br/> Faites un clic droit sur les références et choisissez d’ajouter une référence de service :</p><figure id="r-432588" data-claire-element-id="432589"><img id="r-432587" data-claire-element-id="432587" src="medias/uploads.siteduzero.com_files_356001_357000_356772.png" alt="Image utilisateur"/></figure><p id="r-432590" data-claire-element-id="432590">Saisissez l’adresse de notre service web <a href="http://localhost:49172/ServiceBonjour.svc">http://localhost:49172/ServiceBonjour.svc</a> et cliquez sur « aller à » :</p><figure id="r-432592" data-claire-element-id="432593"><img id="r-432591" data-claire-element-id="432591" src="medias/uploads.siteduzero.com_files_356001_357000_356773.png" alt="Image utilisateur"/></figure><p id="r-432594" data-claire-element-id="432594">Visual C# Express découvre alors le service web ainsi que les méthodes qui le composent. Profitions-en pour indiquer un espace de nom cohérent, par exemple « BonjourWebService ».<br/> En fait, à la fermeture de cette boite de dialogue, Visual C# Express va générer ce qu’on appelle un proxy. Il s’agit d’une classe qui permet de faire l’intermédiaire entre notre application et le service web. Il y a également des classes qui correspondent aux objets manipulés par le service web et d’autres qui encapsulent toute la logique d’appel du service web. Pour nous, c’est transparent, c’est comme si nous faisions une référence classique au service. Toute la logique est masquée.<br/> Vous retrouverez ces classes générées dans le fichier située sous la référence service :</p><figure id="r-432596" data-claire-element-id="432597"><img id="r-432595" data-claire-element-id="432595" src="medias/uploads.siteduzero.com_files_356001_357000_356774.png" alt="Image utilisateur"/></figure><p id="r-432598" data-claire-element-id="432598">Notez qu’il aura fallu au passage appuyer sur le bouton permettant d’afficher tous les fichiers dans la solution.<br/> Ouvrons le fichier de configuration. Nous pouvons voir que des choses ont été générées dedans, c’est ce qu’on appelle l’ABC de la communication.</p><p id="r-432599" data-claire-element-id="432599">A pour adresse : on peut voir que l’url du service web est indiquée dans le fichier de configuration :</p><pre id="r-432600" data-claire-element-id="432600"><code data-claire-semantic="xml">&lt;endpoint address=&quot;http://localhost:49172/ServiceBonjour.svc&quot;
    binding=&quot;basicHttpBinding&quot; bindingConfiguration=&quot;BasicHttpBinding_IServiceBonjour&quot;
    contract=&quot;BonjourWebService.IServiceBonjour&quot; name=&quot;BasicHttpBinding_IServiceBonjour&quot; /&gt;</code></pre><p id="r-432601" data-claire-element-id="432601">B pour binding : il s’agit de la façon dont on va accéder aux données, ici le basicHttpBinding indique que c’est du SOAP.<br/> C pour contrat : précise quel contrat le service web respecte.</p><p id="r-432602" data-claire-element-id="432602">Il ne reste plus qu’à invoquer le service web, pour cela on pourra écrire :</p><pre id="r-432603" data-claire-element-id="432603"><code data-claire-semantic="csharp">BonjourWebService.ServiceBonjourClient client = new BonjourWebService.ServiceBonjourClient();
string reponse = client.DireBonjour(&quot;Nicolas&quot;);
Console.WriteLine(reponse);</code></pre><p id="r-432604" data-claire-element-id="432604">Très simple non ?<br/> Après exécution nous obtenons :</p><pre id="r-432605" data-claire-element-id="432605"><code data-claire-semantic="console">Bonjour Nicolas depuis le service web</code></pre><p id="r-432606" data-claire-element-id="432606">Déroutant de simplicité. C’est tellement simple et Visual C# Express a tellement fait à notre place qu’on ne sait plus ce qu’il se passe. Y a-t-il vraiment eu un appel de service web ?<br/> Pour le vérifier, installons un analyseur de requêtes internet, fiddler, que l’on peut <a href="http://www.fiddler2.com/fiddler2/version.asp">télécharger gratuitement ici</a>. Il vaut mieux parler un peu l’anglais pour utiliser ce logiciel. Si ce n’est pas le cas, ce n’est pas trop grave, regardez juste le résultat sans le reproduire chez vous.<br/> Fiddler capture toutes les requêtes qui vont sur internet, par contre il ignore les requêtes locales. Pour le feinter, nous allons rajouter un point après localhost dans le fichier de configuration :</p><pre id="r-432607" data-claire-element-id="432607"><code data-claire-semantic="xml">&lt;endpoint address=&quot;http://localhost.:49172/ServiceBonjour.svc&quot;
    binding=&quot;basicHttpBinding&quot; bindingConfiguration=&quot;BasicHttpBinding_IServiceBonjour&quot;
    contract=&quot;BonjourWebService.IServiceBonjour&quot; name=&quot;BasicHttpBinding_IServiceBonjour&quot; /&gt;</code></pre><p id="r-432608" data-claire-element-id="432608">Et démarrons notre application de test.<br/> Nous pouvons voir que Fiddler capte bien l’appel du service web. Si nous cliquons sur la requête interceptée, nous pouvons voir à droite le message envoyé pour invoquer le service web ainsi que le message de retour :</p><figure id="r-432610" data-claire-element-id="432611"><img id="r-432609" data-claire-element-id="432609" src="medias/uploads.siteduzero.com_files_356001_357000_356775.png" alt="Image utilisateur"/></figure><p id="r-432612" data-claire-element-id="432612">Ce qui donne en XML pour le message d’appel :</p><pre id="r-432613" data-claire-element-id="432613"><code data-claire-semantic="xml">&lt;s:Envelope xmlns:s=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;s:Body&gt;&lt;DireBonjour xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;qui&gt;Nicolas&lt;/qui&gt;&lt;/DireBonjour&gt;&lt;/s:Body&gt;&lt;/s:Envelope&gt;</code></pre><p id="r-432614" data-claire-element-id="432614">Et pour le message de retour :</p><pre id="r-432615" data-claire-element-id="432615"><code data-claire-semantic="xml">&lt;s:Envelope xmlns:s=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;s:Body&gt;&lt;DireBonjourResponse xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;DireBonjourResult&gt;Bonjour Nicolas depuis le service web&lt;/DireBonjourResult&gt;&lt;/DireBonjourResponse&gt;&lt;/s:Body&gt;&lt;/s:Envelope&gt;</code></pre><p id="r-432616" data-claire-element-id="432616">C’est notre proxy qui a fait tout ça à notre place. Il a transformé notre appel C# en message XML (on appelle cette action la sérialisation). Ce XML est transmis au service web qui l’interprète et le retransforme en C# (on appelle cette action la désérialisation). Le service web traite l’appel de la méthode avec ses paramètres et renvoi la réponse sous forme sérialisée. Puis notre programme C# désérialise la réponse pour nous permettre d’afficher la chaine de caractère résultat.</p><p id="r-432617" data-claire-element-id="432617">Nous en avons terminé avec cette introduction aux services web. Très à la mode, ils garantissent la communication entre des environnements de toutes sortes pouvant être situés à divers endroits, grâce à internet. Ils améliorent l’interopérabilité entre les différentes applications. Nous avons vu comment créer et consommer rapidement un service web SOAP. Pour le transformer en REST par exemple, il faut changer essentiellement de la configuration. Le code métier ne change pas. WCF c’est en réalité beaucoup plus que les services web. Il nous simplifie énormément la tâche et est une brique importante du framework .NET permettant la communication entre les différentes couches applicatives.</p><p id="r-432618" data-claire-element-id="432618">Allez, je m’arrête là pour ce petit aperçu de ce que l’on peut réaliser avec le C# et le framework .NET. Nous avons démarré avec les applications clients lourds que l’on peut réaliser grâce à WPF. Puis nous avons continué avec les applications web utilisant ASP.NET WebForms ou ASP.NET MVC. Le mix de tout ça, ce sont les applications clients riches que l’on peut réaliser avec Silverlight. Le développement de jeux n’est pas en reste non plus, car Microsoft propose tout un framework pour réaliser des jeux, XNA, utilisable pour le développement de jeux sous Windows ou sous Xbox et Kinect. Il est possible de rajouter des briques à XNA, notamment tout ce qui est 3D avec DirectX que nous n’avons pas vu ici. Nous avons par contre vu comment réaliser des applications pour smartphones équipés de Windows Phone grâce à Silverlight pour Windows Phone et XNA. Puis nous avons terminé en présentant la communication via services web en utilisant WCF.</p><p id="r-432619" data-claire-element-id="432619">Nous n’avons pas tout vu, tellement il y a de choses que l’on peut faire avec le C#. Citons encore la gestion des workflow avec WF (Windows Workflow Foundation) ou le développement sur le cloud avec Windows Azure. Il y a également d’autres éléments que l’on peut faire avec les applications Windows, comme des services Windows, ...</p><p id="r-432620" data-claire-element-id="432620">J’espère que cette petite présentation vous a permis de voir les possibilités qui vous sont offertes grâce à ce fantastique langage et vous a donné envie d’en savoir plus sur les différentes technologies associées.</p>
<aside class="aside-menu">
<ul class="content-menu subchapter" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c">Les différents types d&#039;applications pouvant être développées avec le C#</a>
</li>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-windows-avec-wpf">
Créer une application Windows avec WPF
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-web-avec-asp-net">
Créer une application web avec ASP.NET
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-client-riche-avec-silverlight">
Créer une application client riche avec Silverlight
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/le-graphisme-et-les-jeux-avec-xna">
Le graphisme et les jeux avec XNA
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
Créer une application mobile avec Windows Phone 7
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-un-service-web-avec-wcf">
Créer un service web avec WCF
</a>
</li>
</ul>
</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr/>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c/creer-une-application-mobile-avec-windows-phone-7">
<span class="arrow"></span>
<span class="next">Créer une application mobile avec Windows Phone 7</span>
</a>
</div>
<hr class="bottom"/>
<div class="clear"></div> <div class="adBan">
<script type='text/javascript'>
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script>
</div>
<div class="clear"></div>
</body>
<!-- Mirrored from 62.4.17.167/sdz/sdz/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c.html by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 26 Oct 2013 22:51:01 GMT -->

<!-- Mirrored from sdz.tdct.org/sdz/les-differents-types-d-applications-pouvant-etre-developpees-avec-le-c.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Nov 2015 04:02:18 GMT -->
</html>